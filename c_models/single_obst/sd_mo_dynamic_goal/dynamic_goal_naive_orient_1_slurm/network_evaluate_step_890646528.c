#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3763178586959839,-0.22310569882392883,0.3697103261947632,0.14699403941631317,-0.42246580123901367,0.11905661970376968,0.011511798948049545,-0.20788031816482544,0.10502395778894424,0.45436784625053406,0.08296140283346176,-0.007444633636623621,0.16509653627872467,-0.13182756304740906,0.41336336731910706,-0.11962515860795975},{-0.3719332218170166,-0.18879491090774536,0.2830394208431244,0.14557680487632751,-0.2733044922351837,-0.0038707549683749676,-0.36918261647224426,0.06502525508403778,-0.1680588722229004,-0.11503255367279053,0.11947785317897797,-0.14517223834991455,0.17800690233707428,-0.3314594030380249,-0.25769826769828796,0.0933045744895935},{0.16112791001796722,-0.23864330351352692,-0.23785001039505005,0.015749173238873482,0.11248265206813812,0.15783965587615967,-0.06889747828245163,-0.0054797339253127575,-0.0789138674736023,-0.20534728467464447,-0.20732587575912476,0.4004741311073303,0.017502913251519203,-0.15393787622451782,-0.33271098136901855,0.21999089419841766},{0.19966569542884827,0.20879052579402924,0.29707056283950806,-0.09291326254606247,-0.3365776240825653,0.0005145333125256002,0.1287945806980133,0.10295502096414566,0.5200490951538086,-0.3724590837955475,0.019098732620477676,0.10930655896663666,-0.2585674226284027,-0.08023097366094589,0.3051442503929138,-0.3734254240989685},{-0.05790248513221741,0.12932492792606354,0.22083261609077454,-0.10343549400568008,0.23376618325710297,0.26373013854026794,0.2436826527118683,-0.05160130560398102,-0.08652468025684357,0.2370261251926422,0.3078799247741699,-0.09467233717441559,-0.07352819293737411,-0.37001222372055054,0.3293721675872803,0.1179727092385292},{-0.05688175931572914,-0.1791415810585022,-0.16875922679901123,-0.2942962646484375,0.1048058345913887,0.035445213317871094,-0.05182625353336334,-0.1609715223312378,0.23428548872470856,-0.23218019306659698,-0.32265838980674744,0.1908208131790161,0.3713357150554657,-0.0384405180811882,-0.09697083383798599,0.20473268628120422},{-0.10457094758749008,0.08597921580076218,0.0644766315817833,-0.2401321679353714,0.25329700112342834,0.014168760739266872,0.08117471635341644,0.36613401770591736,0.2596863806247711,-0.022709006443619728,-0.37157854437828064,0.2851254940032959,-0.045789554715156555,0.16313256323337555,-0.1694604605436325,-0.13871514797210693},{0.026473674923181534,-0.1064104363322258,0.20264604687690735,0.22843345999717712,-0.3410279452800751,0.003541755024343729,0.27864062786102295,0.3306829631328583,-0.00867660902440548,0.19230864942073822,-0.42307811975479126,-0.26915642619132996,0.23796346783638,0.2303474247455597,0.21958208084106445,0.13912950456142426},{0.35088154673576355,-0.17539291083812714,0.36759740114212036,-0.04290208965539932,0.10989376157522202,0.11871861666440964,-0.24015897512435913,-0.25348007678985596,0.20224414765834808,-0.26455461978912354,0.01701091229915619,-0.26741835474967957,-0.18990209698677063,0.30992597341537476,0.16783536970615387,-0.09881991893053055},{0.0532391332089901,-0.1678297221660614,-0.43934789299964905,-0.059956975281238556,-0.3242855966091156,0.21926245093345642,0.39704856276512146,0.17217141389846802,0.4373023509979248,0.4074922502040863,-0.003703364171087742,-0.32486891746520996,0.08514010161161423,0.3000723123550415,-0.13294446468353271,-0.4015691578388214},{0.030513443052768707,0.28200069069862366,0.35462284088134766,-0.25090813636779785,-0.29243364930152893,0.19669653475284576,0.22839650511741638,0.31503593921661377,-0.28281259536743164,-0.034916769713163376,-0.016537562012672424,0.17059814929962158,-0.27284854650497437,-0.20425832271575928,0.3439420461654663,-0.37777456641197205},{-0.0102609908208251,-0.1651727855205536,0.0026741772890090942,0.17934034764766693,0.3433535695075989,0.32483282685279846,0.4003320336341858,-0.04448693245649338,0.02959180250763893,-0.07184221595525742,0.30360740423202515,-0.1726563721895218,0.020692793652415276,-0.24849440157413483,0.31598490476608276,0.28451821208000183},{-0.08851049095392227,0.2396939992904663,0.09410484880208969,-0.3256297707557678,0.08809064328670502,0.10764750093221664,0.3492158055305481,-0.031247297301888466,0.09070071578025818,0.012468799017369747,-0.10340865701436996,0.16849906742572784,0.133921280503273,0.261318564414978,0.13184265792369843,-0.3099561929702759},{-0.23561041057109833,-0.2438543736934662,-0.2479182332754135,0.008309023454785347,-0.17362046241760254,0.08039750903844833,-0.27682170271873474,0.07865675538778305,0.011447894386947155,-0.0413992740213871,-0.2675328552722931,-0.025189552456140518,-0.35688289999961853,0.07177964597940445,0.2060730755329132,0.0842449888586998},{-0.26201605796813965,-0.29743123054504395,-0.27872586250305176,0.32085365056991577,0.11792267113924026,-0.3771301209926605,0.269909530878067,-0.12990494072437286,0.09628242254257202,0.2965424954891205,0.097959965467453,0.1922069638967514,0.18882399797439575,-0.021236097440123558,-0.215811088681221,0.2634698748588562},{0.407667338848114,-0.06799615919589996,-0.24578478932380676,-0.38611987233161926,-0.6047648787498474,0.2933754026889801,0.4883817136287689,-0.292186439037323,0.13812273740768433,0.07523784041404724,-0.2848377525806427,0.11149109899997711,-0.4971957802772522,0.5678967833518982,-0.276915043592453,-0.00044017413165420294},{-0.3781484067440033,-0.3865487277507782,0.39873170852661133,0.3359633982181549,-0.2763589918613434,0.26271599531173706,-0.0717298686504364,-0.2465408444404602,0.2782970070838928,-0.4158029854297638,-0.3001399338245392,-0.6583144664764404,-0.321872740983963,-0.43027737736701965,0.07525753974914551,-0.19747227430343628},{-0.3464941382408142,0.2785171568393707,-0.5406078100204468,-0.03446115553379059,-0.008321452885866165,0.3455643355846405,-0.3804493546485901,-0.41518914699554443,0.22892479598522186,0.16404560208320618,0.3810431957244873,-0.024638589471578598,-0.2462613731622696,0.24122266471385956,0.15666614472866058,-0.48018938302993774}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05308220535516739,-0.10262858122587204,-0.20770762860774994,-0.41824397444725037,0.35043954849243164,0.2884504795074463,0.053719766438007355,0.06665927916765213,-0.19566237926483154,-0.11266210675239563,-0.07954894006252289,0.06967049092054367,0.20754025876522064,0.4305952489376068,0.07558491826057434,0.09699375182390213},{-0.16355057060718536,-0.23058652877807617,-0.030215509235858917,0.14244306087493896,0.3097081780433655,-0.23090170323848724,0.1332268863916397,0.05128852650523186,-0.048240628093481064,0.25995105504989624,-0.13285426795482635,0.3341721296310425,-0.34418007731437683,0.1858864426612854,-0.33514073491096497,-0.2575337886810303},{0.1163443773984909,0.18503814935684204,-0.3117954134941101,-0.6102314591407776,0.16733485460281372,0.4203258454799652,-0.08049863576889038,0.11915633082389832,-0.25026142597198486,-0.21867477893829346,-0.012087290175259113,0.27100828289985657,-0.23662154376506805,-0.2288479208946228,0.09048531949520111,-0.023750824853777885},{0.18478573858737946,-0.02977069839835167,0.03487376123666763,0.1508456915616989,-0.4918450117111206,0.005579461809247732,0.05855908617377281,-0.2708621621131897,0.3174477219581604,0.3311077952384949,-0.12028297036886215,-0.19767369329929352,-0.42697468400001526,-0.344788134098053,0.1882253885269165,0.2338304966688156},{-0.07658293098211288,0.07475566864013672,0.03853735700249672,0.3394637703895569,-0.2413843870162964,0.0067037660628557205,-0.02825748920440674,0.21680623292922974,0.21343474090099335,-0.29300087690353394,0.01778413914144039,0.365985244512558,0.1149124950170517,-0.4300616979598999,-0.06735031306743622,-0.13737888634204865},{0.1546609103679657,0.12561874091625214,-0.012082340195775032,0.16415172815322876,-0.34416723251342773,-0.4059394598007202,0.18134695291519165,0.2719844877719879,0.14312972128391266,0.4082830250263214,0.222460076212883,-0.25803524255752563,0.031084410846233368,-0.17350317537784576,-0.0900549367070198,0.29649463295936584},{-0.0395466648042202,0.13452303409576416,0.3532922565937042,-0.34726446866989136,-0.1470680981874466,0.07817421853542328,-0.28753647208213806,-0.06238076090812683,0.143852099776268,0.06897487491369247,-0.1026630848646164,-0.2876029908657074,-0.21684543788433075,0.0009517750586383045,0.1464516520500183,0.08656909316778183},{-0.14527982473373413,-0.1577366590499878,-0.34221258759498596,0.29543060064315796,-0.22430123388767242,-0.3148634731769562,-0.14883410930633545,-0.3241231143474579,0.045851778239011765,-0.12901724874973297,-0.11768519133329391,0.14314503967761993,-0.1836547702550888,0.40953996777534485,-0.09441481530666351,-0.37230104207992554},{-0.17703436315059662,0.28084099292755127,-0.013040078803896904,-0.033242374658584595,0.30706897377967834,-0.2008206993341446,0.38702550530433655,0.11190972477197647,0.2288232445716858,0.38491111993789673,0.20892716944217682,0.322918176651001,0.24627837538719177,-0.03054741583764553,0.24388514459133148,0.12069517374038696},{0.10080600529909134,-0.28452321887016296,-0.02476080320775509,-0.12961432337760925,0.3193613290786743,-0.04879603162407875,-0.30699214339256287,-0.22878603637218475,0.06233328580856323,-0.43918320536613464,-0.13734722137451172,0.19504627585411072,0.12500421702861786,0.16994798183441162,-0.29199057817459106,0.3084225058555603},{-0.09414801746606827,-0.32795315980911255,0.44070136547088623,0.24188335239887238,0.22688139975070953,0.14477692544460297,0.07207661867141724,-0.14495833218097687,0.112127386033535,-0.1893870085477829,0.006196982227265835,0.4015258848667145,0.24513615667819977,0.14352525770664215,-0.20093244314193726,-0.020801423117518425},{-0.006301991641521454,-0.11245834082365036,0.27164724469184875,0.001203489606268704,-0.1447325497865677,-0.22463306784629822,0.46518808603286743,0.3059549927711487,-0.2651408314704895,-0.35557156801223755,-0.099509596824646,-0.33350956439971924,0.04259185120463371,-0.35552650690078735,-0.3479995131492615,0.0006639641942456365},{-0.05927985534071922,-0.29132357239723206,0.2905590534210205,-0.20551156997680664,0.3130020201206207,-0.3107813000679016,-0.3343389928340912,0.1699235737323761,0.06549181789159775,-0.059081293642520905,-0.27081266045570374,0.05830725282430649,0.0767248272895813,-0.23154142498970032,-0.32237881422042847,0.017700325697660446},{0.3031289279460907,-0.27598321437835693,0.43170365691185,0.16462111473083496,0.034545209258794785,0.30551406741142273,-0.06635010242462158,-0.2132592648267746,-0.5026743412017822,0.12867584824562073,0.05085528641939163,-0.36861881613731384,0.0009223384549841285,0.20629514753818512,0.3463582992553711,0.04665721580386162},{-0.2451939433813095,0.1356705129146576,0.12430281192064285,-0.3097435534000397,-0.19144882261753082,0.02741035260260105,0.2111499160528183,-0.1106802374124527,0.17150577902793884,-0.3417798578739166,-0.016166891902685165,0.05933999642729759,-0.00381209678016603,0.04388606548309326,-0.12117691338062286,0.023552769795060158},{-0.22174544632434845,0.288614958524704,-0.29962390661239624,0.3611091375350952,0.13317856192588806,-0.36823770403862,-0.08160684257745743,-0.09780161827802658,-0.35661691427230835,0.26260659098625183,-0.31094464659690857,0.3109292685985565,-0.06373614817857742,-0.19245243072509766,-0.2645513713359833,-0.5184893608093262}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.13004036247730255,0.006882300600409508,-0.05455369874835014,-0.04701995104551315,-0.12199481576681137,0.026960719376802444,0.27721455693244934,0.06690478324890137,-0.13377422094345093,-0.2169489860534668,0.13104763627052307,-0.2717598080635071,-0.17370016872882843,0.22347164154052734,0.2257988601922989,0.288680762052536,-0.23225834965705872,-0.3259013593196869,-0.1733851283788681,0.05679329112172127,-0.04122980684041977,-0.3494451940059662,-0.242381289601326,-0.272031307220459,-0.29601845145225525,0.19839242100715637,-0.21050585806369781,-0.029038021340966225,-0.014639805071055889,0.022121964022517204,0.24252210557460785,-0.17227387428283691},{0.29007747769355774,0.21251718699932098,0.1616891473531723,-0.0651727020740509,0.0987628623843193,-0.0979936420917511,0.2716924846172333,0.14382468163967133,-0.1863356977701187,-0.17612344026565552,-0.05177006870508194,-0.2339829057455063,-0.16344422101974487,0.170065239071846,-0.1984802782535553,-0.3150474429130554,-0.05657453462481499,0.13084128499031067,-0.2748069763183594,-0.27403292059898376,0.02462058886885643,0.22552140057086945,0.09745648503303528,-0.11556190252304077,0.1556527018547058,-0.28382056951522827,0.04273729398846626,0.06846372038125992,0.22893007099628448,-0.10088721662759781,-0.031157080084085464,0.2769930064678192},{0.22474420070648193,0.08846239000558853,-0.04056273028254509,0.10354634374380112,-0.15406867861747742,-0.14105643332004547,-0.21485024690628052,0.12921342253684998,-0.12581612169742584,0.3551337420940399,-0.2949157655239105,-0.22083695232868195,0.1631402224302292,-0.33249127864837646,-0.1786174774169922,0.13276098668575287,-0.08346376568078995,-0.09478186070919037,0.22227132320404053,-0.022379668429493904,0.18072178959846497,0.28989070653915405,-0.26262930035591125,0.0647258460521698,-0.16997171938419342,-0.10487344861030579,0.11644639819860458,-0.03884445130825043,-0.0861470177769661,-0.16667506098747253,-0.04087743163108826,-0.15450510382652283},{0.3203987777233124,0.046601638197898865,0.09272532910108566,-0.13843011856079102,-0.2554125189781189,-0.09106133878231049,-0.12353985756635666,0.2079170048236847,0.24180392920970917,-0.190641388297081,-0.1299218386411667,0.24909274280071259,0.12614262104034424,-0.09135635197162628,-0.24127411842346191,0.32104209065437317,-0.3129359185695648,0.27394407987594604,-0.05574815347790718,0.04589318484067917,-0.06643949449062347,-0.10615231841802597,0.2698744237422943,0.16970013082027435,0.1604655236005783,-0.31740695238113403,0.2881484031677246,-0.20083126425743103,-0.0420205295085907,0.002185209421440959,-0.31981161236763,0.14314278960227966},{-0.027324289083480835,-0.023016635328531265,-0.08778561651706696,0.041823603212833405,0.20636680722236633,-0.1444454938173294,-0.37414318323135376,0.01656373403966427,-0.14542438089847565,-0.20560671389102936,0.16655166447162628,0.2229778915643692,-0.0977320522069931,-0.08762838691473007,-0.07485315948724747,0.22351773083209991,-0.03291557356715202,0.009194381535053253,-0.33123430609703064,-0.038074102252721786,-0.19335737824440002,-0.32012099027633667,0.1744748204946518,0.23252257704734802,-0.05589190125465393,0.2703436315059662,-0.16249239444732666,0.2571738064289093,0.27564123272895813,0.35110992193222046,0.015971628949046135,0.2841184437274933},{-0.19837825000286102,-0.1145646721124649,-0.11570300161838531,-0.09105322510004044,-0.10494944453239441,0.2197374701499939,0.2184416949748993,0.056695062667131424,0.334838330745697,0.11706394702196121,0.2743019461631775,-0.21782657504081726,-0.13499046862125397,0.2531077265739441,0.23893789947032928,-0.3338361978530884,-0.07392121851444244,-0.24083644151687622,0.2385798543691635,0.17701300978660583,0.06281571835279465,0.13140322268009186,-0.0243961364030838,-0.004889679607003927,-0.3282766044139862,0.2944827973842621,-0.20273666083812714,0.15453338623046875,0.3078596591949463,0.23050248622894287,0.1075197383761406,0.03634920343756676},{0.15496404469013214,-0.13098125159740448,-0.1377001851797104,-0.32895627617836,0.011138624511659145,0.23577506840229034,0.2792513370513916,0.11787528544664383,0.10338739305734634,0.2950705289840698,-0.0011183968745172024,0.004135927185416222,-0.4457250237464905,-0.1268695741891861,-0.1381528079509735,0.02836095169186592,-0.27002573013305664,-0.2165997326374054,0.17674829065799713,-0.0928749218583107,-0.11834421753883362,-0.1387072503566742,-0.2211112380027771,-0.2575587034225464,0.17889313399791718,-0.2584287226200104,-0.12311793863773346,-0.20710553228855133,0.33468878269195557,0.11896048486232758,-0.18107837438583374,-0.27101194858551025},{0.07040557265281677,0.19036900997161865,0.05611491575837135,-0.11001341789960861,0.14520671963691711,-0.28141939640045166,-0.05621741712093353,-0.1451139897108078,0.007930615916848183,-0.3050622045993805,-0.29141125082969666,-0.07857441902160645,-0.13326847553253174,0.04642914608120918,-0.10966382920742035,0.3882024884223938,0.009169075638055801,-0.1502508521080017,0.14006619155406952,0.32109323143959045,-0.16842021048069,-0.2005820870399475,0.2793872654438019,0.0793788880109787,-0.0057821618393063545,-0.3391469717025757,-0.31758084893226624,-0.2237001657485962,-0.3544432818889618,-0.2484239786863327,0.10556650161743164,-0.35815808176994324},{0.039427198469638824,0.3746490776538849,-0.3468713164329529,-0.3562833368778229,-0.251526415348053,0.05619044601917267,0.08750837296247482,0.0873601883649826,0.14015524089336395,-0.21571260690689087,-0.23025351762771606,0.26999223232269287,-0.31301698088645935,-0.1570378690958023,0.17145080864429474,-0.2284652441740036,0.21701861917972565,0.11702428013086319,0.2743530869483948,0.063369520008564,0.21552464365959167,0.09530764073133469,0.30230072140693665,-0.11416713893413544,0.4551572799682617,-0.16944371163845062,0.1648561656475067,0.3032190799713135,-0.19228720664978027,0.11418142914772034,-0.0005268038948997855,0.09109409153461456},{-0.1762457638978958,0.09700646996498108,-0.30335113406181335,-0.17187121510505676,0.10840016603469849,-0.17969085276126862,0.08265351504087448,0.018858255818486214,0.15421605110168457,0.001853176741860807,-0.23757532238960266,-0.30629369616508484,-0.3876912593841553,-0.12602758407592773,-0.22087633609771729,0.07726982980966568,0.0018965326016768813,-0.24872025847434998,0.2501384913921356,0.08000853657722473,0.0748177096247673,-0.020201528444886208,0.3483981490135193,-0.23764397203922272,0.32368817925453186,0.13684333860874176,-0.20966340601444244,0.0758410394191742,0.025752581655979156,0.08514877408742905,-0.15309551358222961,0.14741523563861847},{0.060520533472299576,-0.05263156071305275,0.19071057438850403,-0.26205572485923767,-0.22498877346515656,-0.22441962361335754,-0.24845640361309052,-0.10839993506669998,-0.14944671094417572,0.31363338232040405,0.10554672032594681,-0.28435781598091125,-0.3347543179988861,0.0036168121732771397,-0.21615637838840485,-0.2127409428358078,0.26990020275115967,-0.15328504145145416,0.26349523663520813,-0.21944740414619446,-0.19026385247707367,-0.0001752760581439361,0.14732085168361664,0.1732805371284485,0.16154733300209045,-0.12902772426605225,-0.0778842493891716,-0.07732130587100983,-0.06196285039186478,0.02152032032608986,-0.07901468873023987,0.1681247502565384},{-0.216585174202919,-0.03889899328351021,0.24422672390937805,0.33925843238830566,0.27027520537376404,-0.01642182655632496,0.0475698746740818,-0.2165156453847885,-0.08501243591308594,-0.18375438451766968,0.27935630083084106,-0.2452453076839447,-0.21494808793067932,-0.203222393989563,0.2834222614765167,0.005811582785099745,-0.024559108540415764,0.02158033847808838,0.3227840065956116,0.08073718100786209,-0.16683611273765564,0.21171219646930695,0.11039609462022781,-0.10770721733570099,0.1899227648973465,-0.09812340885400772,-0.14533330500125885,0.21017546951770782,0.20584671199321747,-0.022162659093737602,-0.27630865573883057,-0.2462824136018753},{0.22081254422664642,-0.23069168627262115,0.0035785608924925327,-0.3368709683418274,0.14470143616199493,-0.03900450840592384,0.17574504017829895,0.07713553309440613,0.23784291744232178,0.0411628782749176,0.15365704894065857,0.18460501730442047,-0.3668023347854614,-0.2105732262134552,-0.052235234528779984,-0.22422601282596588,-0.1092577651143074,-0.20365309715270996,0.25518518686294556,-0.22925417125225067,0.25366002321243286,0.017156630754470825,-0.01531903725117445,0.1850154995918274,0.11972875893115997,-0.06876768171787262,0.12617826461791992,0.16240763664245605,0.13051731884479523,-0.06872628629207611,-0.18894855678081512,-0.09787251800298691},{0.219349205493927,-0.035199519246816635,-0.05641281604766846,0.4115928113460541,-0.10544294863939285,-0.18243072926998138,-0.07503236085176468,0.1085931807756424,0.16095249354839325,0.2930077910423279,0.1288246065378189,-0.15220136940479279,0.016623834148049355,0.1936298906803131,-0.09625807404518127,0.06119859963655472,0.21016936004161835,-0.2302558422088623,0.059275493025779724,-0.3175865411758423,0.30658867955207825,0.16670450568199158,-0.05560317263007164,0.18374373018741608,0.19145627319812775,0.07613193988800049,0.09829610586166382,0.07352817803621292,0.05238918215036392,-0.1585928052663803,-0.030738908797502518,0.39112988114356995},{0.03615535795688629,-0.27850207686424255,-0.07929739356040955,0.11196564137935638,-0.2475869506597519,-0.009294447489082813,0.05901883915066719,-0.26450350880622864,-0.160859614610672,-0.0666877031326294,0.1868203729391098,0.1496032476425171,0.09011215716600418,0.2640014588832855,-0.057319048792123795,-0.10296328365802765,-0.22341382503509521,0.25611430406570435,-0.0849439725279808,-0.26365068554878235,-0.18873706459999084,-0.07834875583648682,0.16772618889808655,-0.01168772391974926,-0.03823612257838249,-0.08274391293525696,-0.19784173369407654,0.22366558015346527,0.06320582330226898,-0.16884513199329376,0.22245511412620544,0.19591203331947327},{0.13424625992774963,-0.2219068855047226,-0.07518192380666733,-0.17920541763305664,-0.08870864659547806,0.17339849472045898,0.03237762302160263,0.2382294237613678,-0.08809799700975418,-0.016692694276571274,0.26969313621520996,0.1237068772315979,-0.03441337123513222,-0.10965162515640259,0.05630740895867348,0.13680784404277802,-0.3877949118614197,-0.29515954852104187,-0.045315150171518326,0.045130643993616104,0.11051806807518005,0.23306290805339813,0.26858529448509216,0.1455114632844925,0.046648088842630386,0.23738369345664978,0.02256128191947937,-0.06651369482278824,0.19959867000579834,-0.10149987787008286,-0.22957241535186768,0.36658355593681335},{0.21122944355010986,-0.03693418949842453,-0.2328241467475891,0.15064048767089844,0.08194465935230255,-0.0646289810538292,0.2763611972332001,0.12402039021253586,0.1159079372882843,-0.20714887976646423,0.20310306549072266,-0.1686670333147049,-0.33078283071517944,0.24292665719985962,0.06106391176581383,0.06212485209107399,0.06260675191879272,-0.04239964485168457,-0.1387733370065689,0.09107223153114319,-0.07619970291852951,0.17510850727558136,0.0446653813123703,-0.12379487603902817,0.05283809453248978,-0.33606016635894775,0.030773868784308434,0.39443597197532654,0.19140928983688354,-0.13206741213798523,0.21002252399921417,0.16678613424301147},{-0.10039375722408295,-0.03907892107963562,-0.10820629447698593,-0.04141698032617569,-0.2528136968612671,-0.042648795992136,0.20847895741462708,0.1449480503797531,0.14418232440948486,0.02669847011566162,0.24135534465312958,-0.0004974320181645453,0.20152488350868225,0.1688811033964157,0.17337338626384735,-0.11326582729816437,0.11253431439399719,0.15557312965393066,0.22585377097129822,0.052261848002672195,0.18184217810630798,0.23634886741638184,0.06640202552080154,0.13345421850681305,-0.03123372048139572,-0.08706459403038025,-0.10445117205381393,-0.26372358202934265,0.16602399945259094,-0.24671775102615356,-0.015361535362899303,-0.020669585093855858},{-0.2667161226272583,0.10791372507810593,-0.25853201746940613,-0.3390650153160095,-0.023377953097224236,0.07428453117609024,0.09858756512403488,-0.07748910039663315,-0.017211774364113808,0.2803526520729065,0.06554263085126877,-0.19129648804664612,0.1183018833398819,-0.20218367874622345,-0.30313071608543396,-0.033630214631557465,-0.1748187392950058,0.16131292283535004,-0.0059292674995958805,-0.03414297103881836,-0.3083580434322357,0.16137288510799408,0.10829988121986389,0.022726774215698242,-0.008779138326644897,0.23755843937397003,0.03273286670446396,-0.13176871836185455,-0.1781684011220932,0.04635043069720268,-0.10224944353103638,-0.23584900796413422},{0.009179106913506985,-0.21244634687900543,-0.2136370688676834,-0.017344733700156212,-0.35896313190460205,-0.13565845787525177,0.1590157151222229,-0.2929375171661377,-0.19835224747657776,0.18200832605361938,0.1520647406578064,0.1254117339849472,0.14362575113773346,-0.11996453255414963,0.3118935227394104,-0.3179795742034912,0.08937518298625946,0.2505214512348175,0.06143428012728691,0.24003303050994873,0.04239153489470482,-0.10124704241752625,-0.28410062193870544,0.1870567351579666,-0.17740271985530853,-0.1826934814453125,0.10218477994203568,0.05042894929647446,-0.1177431270480156,-0.2900559604167938,-0.01278556790202856,-0.14365297555923462},{0.23985634744167328,0.20573411881923676,-0.06595272570848465,0.17319631576538086,-0.2821710407733917,0.18187379837036133,-0.0654008537530899,-0.12639161944389343,-0.1864340901374817,0.18209640681743622,-0.2555502951145172,-0.1593727469444275,-0.02976294793188572,-0.19420847296714783,-0.36205387115478516,-0.11178802698850632,-0.0703762099146843,-0.2612641751766205,-0.23811061680316925,0.26650235056877136,0.09229608625173569,0.12644852697849274,-0.3336256146430969,0.3302701711654663,0.1861032247543335,0.24607841670513153,-0.2852339744567871,-0.016320858150720596,0.0703282281756401,-0.2521081864833832,0.14163295924663544,0.09750685095787048},{-0.011822608299553394,-0.3242534101009369,0.01636585034430027,-0.24977006018161774,-0.09275995194911957,0.2722342610359192,0.1485864520072937,0.009422961622476578,-0.04469916224479675,-0.0008878879598341882,-0.19199009239673615,0.19329790771007538,0.1530293971300125,0.0927506685256958,0.1797274500131607,-0.03421498462557793,-0.07981143146753311,0.09172090142965317,-0.07643632590770721,0.15779103338718414,0.24009166657924652,0.21814528107643127,-0.05933072790503502,-0.27362197637557983,0.06488688290119171,0.10410656780004501,0.28415969014167786,0.1218900978565216,-0.015182769857347012,0.2122768610715866,0.02810393087565899,-0.09556759893894196},{0.020349880680441856,-0.17063607275485992,0.22416600584983826,0.013118926435709,0.3004026412963867,-0.037711579352617264,-0.11549007147550583,-0.1608157753944397,0.13117314875125885,-0.06836745887994766,0.07302960008382797,0.0001734460238367319,-0.3114313781261444,0.018273279070854187,-0.0956108570098877,-0.23293867707252502,-0.05677643045783043,-0.05728733539581299,0.21448616683483124,0.23753778636455536,0.041234567761421204,0.038767773658037186,0.1819266378879547,0.3418869376182556,-0.15192262828350067,-0.03351343050599098,0.20762775838375092,-0.11592644453048706,-0.19282610714435577,-0.24550248682498932,0.2904592454433441,-0.0023307001683861017},{0.17739693820476532,-0.0795099139213562,0.014210770837962627,0.14869846403598785,-0.030430004000663757,0.0497833788394928,-0.2669873833656311,0.2492094188928604,-0.053809478878974915,-0.024358225986361504,0.10153824090957642,-0.2816523313522339,-0.025975652039051056,-0.014314352534711361,-0.10444031655788422,0.26374736428260803,-0.09236960113048553,-0.20255108177661896,0.023930687457323074,-0.032075829803943634,-0.17071178555488586,0.20425142347812653,0.227166548371315,0.20873744785785675,-0.2945122718811035,0.1282959133386612,-0.06770852953195572,0.0802580714225769,-0.2816864848136902,0.2579953074455261,-0.04594604671001434,0.05138121545314789}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.15835407376289368,-0.0857512503862381,0.0514756515622139,-0.1073804423213005},{0.18130216002464294,-0.2907952070236206,0.23383402824401855,0.20503367483615875},{-0.17470766603946686,0.08933429419994354,0.0317736491560936,-0.014130843803286552},{0.2786296606063843,0.41989830136299133,0.30823686718940735,0.03467748686671257},{-0.23318229615688324,0.10947013646364212,-0.2609073221683502,0.07134276628494263},{-0.030097808688879013,-0.0262792706489563,0.050702352076768875,0.2952096164226532},{-0.11615502089262009,-0.07807662338018417,-0.2741740643978119,-0.011920110322535038},{-0.12111985683441162,-0.21843759715557098,0.11394879221916199,-0.06265196204185486},{-0.027593309059739113,0.06650252640247345,-0.055320993065834045,-0.08475867658853531},{0.167635977268219,0.005386013071984053,-0.08237238228321075,-0.10995586216449738},{0.13043448328971863,-0.10834010690450668,0.2671050429344177,0.2292100489139557},{0.01754727214574814,0.0009120917529799044,0.25441908836364746,-0.06956620514392853},{-0.2997876703739166,0.19081057608127594,-0.021649222820997238,-0.12033365666866302},{-0.14306926727294922,0.07491540908813477,-0.18409083783626556,0.06428886950016022},{0.16030868887901306,0.04611121118068695,0.22000697255134583,0.07754497975111008},{-0.11161591857671738,-0.3509387969970703,-0.11851870268583298,-0.08549822866916656},{-0.20730556547641754,0.0503615140914917,-0.09057877212762833,0.23264610767364502},{-0.21360448002815247,-0.11574158072471619,-0.20224405825138092,0.15877372026443481},{-0.060828760266304016,-0.04340286925435066,0.28472626209259033,0.07260657101869583},{-0.1544179916381836,-0.11802493035793304,0.01360203605145216,-0.1569174826145172},{0.13226565718650818,0.09022919833660126,0.09592299908399582,-0.11166822910308838},{-0.036349475383758545,-0.19121108949184418,-0.07596321403980255,0.21747425198554993},{0.33746767044067383,-0.16259042918682098,0.12800702452659607,0.017422011122107506},{-0.29679974913597107,-0.12019716948270798,-0.303171306848526,-0.29291144013404846},{-0.12573395669460297,-0.12860706448554993,-0.060301996767520905,-0.09142310917377472},{0.10497580468654633,0.08745017647743225,-0.021924806758761406,0.10189057141542435},{0.14220313727855682,-0.1603935956954956,0.21155640482902527,0.061498012393713},{-0.0853017196059227,-0.13364773988723755,-0.007158502005040646,0.21979832649230957},{0.06662420183420181,0.020015807822346687,0.0445440374314785,0.04299372062087059},{-0.12416143715381622,0.10243647545576096,0.18821409344673157,-0.003610642859712243},{-0.17949554324150085,-0.11780527234077454,0.06452422589063644,0.15428276360034943},{0.19872885942459106,0.1862332969903946,0.22531692683696747,-0.033382710069417953}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.12534740567207336,-0.11268807202577591,0.02992989309132099,0.09680836647748947,0.11188889294862747,-0.09006177634000778,0.06743765622377396,-0.02346828579902649,-0.06121274456381798,-0.1032721996307373,-0.003097719047218561,0.06958537548780441,-0.01902032271027565,0.057695042341947556,0.09189876168966293,-0.051175933331251144};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.035147491842508316,0.061215877532958984,0.03291671723127365,-0.013548040762543678,-0.03289452940225601,0.06448397785425186,-0.05287559702992439,-0.0787758156657219,0.05528656393289566,0.0030290731228888035,-0.023059651255607605,-0.04461966082453728,0.019861625507473946,-0.08102171868085861,0.0022554972674697638,-0.06228606775403023};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04308618977665901,0.004451940767467022,-0.0454048216342926,0.03020440973341465,0.002786066150292754,0.016420111060142517,-0.052298061549663544,-0.040459342300891876,-0.02407093718647957,-0.018232209607958794,0.016080262139439583,0.04012143239378929,0.04394567012786865,-0.04368719831109047,0.030378736555576324,-0.08485137671232224,-0.006027855910360813,-0.035821881145238876,0.0365392342209816,-0.04803849384188652,0.024873042479157448,-0.0017127742758020759,0.03143351152539253,-0.07138364017009735,-0.055803705006837845,0.06366398930549622,0.047581084072589874,-0.02652072161436081,0.07913830131292343,0.03313571959733963,0.0013705837773159146,0.060717884451150894};
static const float action_parameterization_distribution_linear_bias[4] = {0.03524916619062424,0.06968960165977478,0.012677966617047787,0.0379573255777359};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3100612461566925,-0.14209844172000885,-0.006000056397169828,0.12206363677978516,0.024112174287438393,0.017215557396411896,-0.21857093274593353,0.04306059703230858},{0.01956363022327423,0.103578582406044,0.31166863441467285,0.27982839941978455,-0.09717323631048203,-0.21042750775814056,0.2982831597328186,0.10325605422258377},{0.0015432321233674884,0.21380384266376495,0.021825535222887993,-0.05524931475520134,0.29713574051856995,0.2445226013660431,-0.1080518290400505,0.06938016414642334},{0.10629162192344666,-0.2229374647140503,0.29364776611328125,-0.22637173533439636,-0.3218478262424469,0.006666125264018774,0.17162735760211945,0.1818256974220276},{-0.22511640191078186,0.018197327852249146,0.011276638135313988,-0.3065217137336731,0.06710132211446762,0.031301070004701614,0.231688991189003,0.271902471780777},{-0.06392718106508255,0.2863272428512573,-0.06376700103282928,-0.24044261872768402,0.14276525378227234,-0.0056035262532532215,0.025405410677194595,-0.19613368809223175},{-0.01897810958325863,0.30865827202796936,0.1797524243593216,-0.2021184116601944,0.21097244322299957,-0.27706727385520935,0.24355387687683105,0.07005388289690018},{0.005514559801667929,-0.20120736956596375,0.10259290784597397,-0.11266424506902695,0.3361155092716217,-0.13763757050037384,0.02252664789557457,-0.28413668274879456},{-0.1596633940935135,0.2774554491043091,0.17203007638454437,0.008035529404878616,0.0383492037653923,0.21156135201454163,0.39003586769104004,0.347339391708374},{0.05947889760136604,-0.06555995345115662,-0.23351426422595978,0.394560843706131,0.2557852268218994,0.1528584063053131,0.1679937094449997,-0.2705891728401184},{-0.11877800524234772,-0.3099634647369385,0.35302653908729553,0.28447145223617554,-0.03019341453909874,-0.37027478218078613,-0.12406039237976074,-0.28869250416755676},{0.3114776909351349,0.04282590374350548,0.35238903760910034,0.501148521900177,-0.15213897824287415,0.18556104600429535,0.11429388076066971,-0.33567315340042114},{-0.30644169449806213,0.15574920177459717,-0.34838953614234924,0.4160483181476593,-0.04068578779697418,0.2310914397239685,0.006961245089769363,0.2554329037666321},{-0.021406052634119987,0.17188610136508942,-0.12453221529722214,-0.17557074129581451,0.03699038177728653,0.07705316692590714,0.316162645816803,-0.03690061345696449},{0.14999008178710938,-0.3172570466995239,-0.27076104283332825,-0.19608363509178162,0.2128855139017105,-0.16323281824588776,0.22228989005088806,-0.1385757029056549},{-0.33829259872436523,-0.34593042731285095,-0.2702200412750244,-0.06473942846059799,0.019083982333540916,0.12528857588768005,0.1753048449754715,-0.02037990838289261},{-0.23413430154323578,-0.2721010744571686,0.14630161225795746,-0.20269142091274261,0.03515763208270073,0.08349422365427017,-0.40258821845054626,-0.22903111577033997},{0.016532836481928825,0.2535924017429352,0.0613938644528389,0.23523859679698944,-0.12901286780834198,0.32799696922302246,0.27902132272720337,-0.13932371139526367},{-0.027142617851495743,-0.2773328423500061,-0.08811192214488983,0.02911216951906681,-0.06882240623235703,-0.34313875436782837,0.1105213314294815,-0.2051161527633667},{-0.12213736027479172,0.025897948071360588,0.10227318853139877,-0.23209518194198608,0.1304291933774948,0.02942551113665104,0.10171544551849365,-0.0012473794631659985},{0.024599852040410042,-0.04608684033155441,0.08885973691940308,-0.11251365393400192,0.06704304367303848,-0.04701456055045128,0.0920284241437912,-0.18672922253608704},{-0.29097995162010193,0.2206118255853653,0.21585151553153992,-0.26401567459106445,-0.3451828360557556,-0.04797841235995293,0.19080962240695953,0.0061927177011966705},{0.28933054208755493,0.056974057108163834,-0.3874393105506897,-0.003628556150943041,-0.07924684137105942,0.21412025392055511,0.17397885024547577,0.25438225269317627},{0.015731001272797585,-0.2267928421497345,-0.042583346366882324,0.1276368796825409,-0.34933266043663025,-0.09475629031658173,-0.32924792170524597,-0.33489173650741577},{0.13210514187812805,-0.12682552635669708,-0.3477981686592102,0.35703131556510925,-0.3213493824005127,-0.10027714818716049,-0.4608558714389801,0.07453576475381851},{-0.0036183190532028675,0.28732824325561523,-0.15081466734409332,-0.0586380660533905,0.10495991259813309,-0.14506639540195465,0.22489163279533386,-0.31650325655937195},{-0.09328518062829971,0.10606683790683746,-0.04916360229253769,-0.23422092199325562,0.04401349648833275,-0.15047377347946167,-0.18152134120464325,-0.1115933507680893},{0.0907176285982132,-0.16984930634498596,0.0347965732216835,-0.13636931777000427,0.06816551089286804,0.06616295129060745,-0.2841736972332001,0.1249583289027214},{0.20455335080623627,0.014302733354270458,-0.28948259353637695,-0.16484765708446503,-0.18782544136047363,0.15799580514431,0.15847398340702057,0.05781739950180054},{0.28716424107551575,-0.39635005593299866,0.029648803174495697,-0.06817509233951569,0.08471966534852982,-0.1012122705578804,0.12191922217607498,0.21228636801242828},{-0.30409666895866394,-0.2580840587615967,0.028676537796854973,-0.38332614302635193,0.23430858552455902,-0.38774222135543823,-0.08277768641710281,0.05236605554819107},{0.2874149978160858,0.18674351274967194,0.009375456720590591,0.16369231045246124,0.09198630601167679,-0.22637063264846802,-0.06598206609487534,0.13648447394371033}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.18993355333805084,0.38984254002571106,-0.4328781068325043,-0.5027548670768738,-0.16675350069999695,-0.11452681571245193,-0.3495161533355713,0.4695166349411011},{0.002857001731172204,0.373338907957077,-0.23342972993850708,0.47550472617149353,-0.024129463359713554,-0.07439209520816803,-0.321655809879303,-0.04258018359541893},{-0.29480692744255066,-0.19915665686130524,-0.15561068058013916,-0.15328557789325714,0.39511600136756897,0.17870303988456726,-0.0962170958518982,0.3767039179801941},{-0.4529893696308136,-0.45668819546699524,0.2853224575519562,0.18948401510715485,-0.49070239067077637,-0.19263704121112823,0.3960310220718384,0.20435844361782074},{-0.24981366097927094,-0.21912582218647003,-0.29282644391059875,-0.19584530591964722,0.3201127052307129,-0.21183402836322784,0.4300864636898041,-0.3216343820095062},{-0.04617111012339592,0.27335530519485474,0.09978414326906204,-0.588725745677948,0.5105825662612915,-0.2081010490655899,-0.49807676672935486,-0.3475521504878998},{-0.2715001106262207,0.101437047123909,0.04886450245976448,-0.41409024596214294,0.060965389013290405,-0.47759222984313965,0.40424707531929016,0.08259864896535873},{-0.2930852174758911,-0.14933235943317413,-0.12091545760631561,-0.33928611874580383,-0.3579021394252777,0.08105988800525665,0.5420344471931458,-0.32578885555267334}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04659942165017128,-0.08232787996530533,-0.10217015445232391,0.02963417023420334,0.12965445220470428,0.03821733593940735,0.0930762067437172,0.017827467992901802};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.010299630463123322,0.023819053545594215,-0.018727315589785576,-0.07877983152866364,-0.059677604585886,-0.027859460562467575,0.018458325415849686,-0.1559673696756363};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

