#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.28978198766708374,0.010885367169976234,-0.14137010276317596,0.3109007775783539,0.2696595788002014,-0.19093969464302063,-0.21177040040493011,0.10428889095783234,0.2899225056171417,-0.3255695700645447,0.5691602826118469,-0.04184791445732117,0.28694474697113037,0.10822662711143494,-0.43413102626800537,0.04242108762264252},{-0.24597133696079254,-0.2709195911884308,-0.2943357825279236,-0.18079613149166107,0.0771392285823822,0.27452781796455383,0.0783429965376854,0.08068946748971939,0.21592865884304047,0.17054207623004913,-0.1610114723443985,-0.08607567101716995,-0.15844836831092834,0.07820241898298264,0.32697927951812744,-0.2984817624092102},{0.13710814714431763,0.2109949290752411,0.21018151938915253,0.3389075696468353,-0.11222516745328903,-0.23180565237998962,0.4480360150337219,-0.03671151027083397,-0.011795483529567719,-0.10056398063898087,-0.05980181321501732,-0.009701970964670181,0.06780576705932617,0.4354233741760254,-0.25946563482284546,-0.08182691782712936},{0.13729003071784973,-0.1557365506887436,-0.1263635903596878,-0.14294418692588806,0.04540945217013359,0.09714185446500778,0.06893453747034073,-0.19670753180980682,-0.1516335904598236,0.17066672444343567,0.5274366736412048,-0.22931712865829468,-0.16551724076271057,-0.15802255272865295,0.1970289945602417,0.10764984041452408},{-0.30828216671943665,0.04537587612867355,0.12538090348243713,-0.21516631543636322,0.27268853783607483,0.2878696918487549,0.1378307342529297,-0.20942984521389008,-0.1437235027551651,0.14485636353492737,-0.1448715180158615,-0.38155868649482727,-0.02876175567507744,-0.16540001332759857,0.3183507025241852,-0.04348888620734215},{0.013778059743344784,-0.02605639025568962,-0.012216896750032902,-0.0530446320772171,0.09804588556289673,-0.12185338139533997,0.4155554473400116,-0.3355385661125183,-0.13479384779930115,-0.16888543963432312,0.27134719491004944,0.03137556090950966,0.23522411286830902,0.06417737156152725,0.2847711145877838,0.26429471373558044},{-0.21182939410209656,0.2038917988538742,-0.06937281042337418,0.048940904438495636,-0.22375696897506714,-0.08015992492437363,-0.16635578870773315,-0.029498152434825897,0.1277938336133957,0.3634617328643799,-0.2533513903617859,-0.10116682201623917,0.21877962350845337,0.06936658173799515,-0.18406252562999725,0.3342674672603607},{-0.1305856555700302,0.018398819491267204,-0.1444157212972641,-0.1907436102628708,0.3643823266029358,-0.2783616781234741,-0.2878875136375427,-0.42800483107566833,-0.061076775193214417,-0.23036211729049683,0.42444366216659546,-0.040981192141771317,0.18033568561077118,0.1816391497850418,-0.2179928719997406,0.3983701467514038},{0.24091577529907227,0.08299717307090759,-0.004188612103462219,0.08636337518692017,-0.38755375146865845,-0.4477326571941376,0.3394094407558441,-0.28207793831825256,-0.14631910622119904,0.21351775527000427,0.1736459881067276,-0.2916681170463562,-0.15139180421829224,0.019401028752326965,0.16420890390872955,-0.048687659204006195},{0.45656824111938477,-0.5517858862876892,-0.11822321265935898,-0.0018889129860326648,0.20534464716911316,-0.16715817153453827,-0.25257182121276855,-0.15904127061367035,-0.16569866240024567,-0.02305135317146778,-0.025530949234962463,-0.21614141762256622,0.36664271354675293,-0.09681615233421326,-0.48056867718696594,-0.15955565869808197},{0.22117461264133453,0.204910010099411,-0.34630656242370605,0.08826281130313873,-0.014120832085609436,-0.212361142039299,-0.13434399664402008,0.12870608270168304,-0.16797742247581482,0.16338209807872772,0.16537481546401978,0.23975379765033722,-0.12383265048265457,0.25757840275764465,-0.05450737476348877,-0.22235050797462463},{-0.41519245505332947,0.2681358754634857,0.22861193120479584,-0.2843582332134247,-0.28889504075050354,0.32053759694099426,0.048047199845314026,0.3387097120285034,0.2091161608695984,0.1560409963130951,0.22510631382465363,-0.11885595321655273,0.1684161126613617,-0.07235033810138702,-0.06742380559444427,-0.13965487480163574},{0.10885211080312729,-0.25924211740493774,-0.18449366092681885,0.20284725725650787,-0.21449381113052368,-0.2626632750034332,-0.1323266625404358,0.24634897708892822,0.31097352504730225,-0.1487332284450531,-0.11380525678396225,0.06096411868929863,0.28105488419532776,0.13082772493362427,-0.17201657593250275,0.3059242367744446},{0.26557278633117676,0.20604828000068665,-0.14253947138786316,-0.11324431747198105,0.09892494976520538,-0.08590860664844513,-0.12568886578083038,0.32459917664527893,-0.20905043184757233,-0.18485671281814575,-0.1485264003276825,0.028916694223880768,-0.21557174623012543,-0.10964631289243698,-0.21217532455921173,-0.04551458731293678},{0.17041702568531036,0.3585270047187805,0.41004684567451477,-0.3839169144630432,-0.3850015699863434,0.10107288509607315,0.0565062053501606,-0.14953652024269104,0.3627689778804779,0.35931265354156494,-0.1856507956981659,0.07368214428424835,-0.05941053852438927,-0.320877343416214,0.0532858707010746,-0.13116803765296936},{-0.16538862884044647,-0.17970509827136993,-0.13065050542354584,0.4265870153903961,-0.23940818011760712,-0.19846978783607483,-0.22163131833076477,-0.2840842008590698,-0.5512331128120422,-0.2634750306606293,0.34924617409706116,0.26290345191955566,-0.6060630083084106,-0.3610089421272278,-0.624581515789032,-0.13247397541999817},{-0.4813108742237091,0.17960403859615326,-0.37332719564437866,-0.1436920017004013,-0.47623229026794434,0.2048754096031189,0.4713101387023926,0.06959142535924911,0.4465392827987671,-0.473467081785202,0.1940191686153412,-0.3755589425563812,-0.20465733110904694,0.02667279541492462,-0.18366675078868866,-0.23485097289085388},{0.3601161241531372,-0.5928041338920593,0.30771970748901367,0.24958425760269165,-0.1211731806397438,0.47525542974472046,0.2658442556858063,0.263324499130249,-0.05302827060222626,-0.26664409041404724,-0.10811037570238113,-0.17060542106628418,-0.08965560048818588,-0.5403638482093811,0.19580987095832825,-0.12131016701459885}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.053151704370975494,0.31203746795654297,0.2358541637659073,-0.166495680809021,-0.1923961043357849,0.04310344159603119,-0.02905910275876522,0.2542312443256378,-0.06387241184711456,0.31072938442230225,0.4869428277015686,-0.3764719069004059,0.028393683955073357,0.04842137172818184,0.027123792096972466,-0.11572864651679993},{-0.4384726583957672,0.19178910553455353,-0.2104315608739853,0.32136908173561096,0.28497540950775146,-0.15944626927375793,-0.33063098788261414,-0.16892223060131073,0.3822917342185974,0.2529057264328003,-0.06167342886328697,0.2525213062763214,-0.4125332534313202,0.1784147322177887,-0.22009673714637756,0.4553322494029999},{-0.2776918411254883,0.10607463866472244,-0.32528573274612427,0.18972215056419373,-0.47780540585517883,-0.24684232473373413,0.053698450326919556,0.14878980815410614,-0.2176448553800583,0.38945209980010986,0.23852260410785675,-0.16152256727218628,0.16528941690921783,-0.2818812131881714,-0.124386727809906,-0.0715332105755806},{0.33672648668289185,-0.22446466982364655,0.09512507170438766,0.40057721734046936,-0.4033607840538025,-0.314877450466156,0.3057383596897125,0.029659081250429153,0.2843990623950958,-0.09876029193401337,0.3409847319126129,0.08553828299045563,-0.20659109950065613,0.02913050353527069,-0.0007740126457065344,-0.43491241335868835},{-0.4082431495189667,-0.0640631765127182,0.16005855798721313,-0.2877558469772339,0.15893249213695526,0.39576515555381775,-0.2844301462173462,0.27585509419441223,-0.2385648787021637,0.21397027373313904,-0.00782427191734314,0.01720714010298252,-0.2571042478084564,-0.018338574096560478,-0.2910431921482086,-0.1319723278284073},{0.052424799650907516,-0.3217191994190216,0.007691917475312948,-0.33809638023376465,0.21138682961463928,0.0629691407084465,-0.14729665219783783,-0.05593937262892723,-0.16077394783496857,0.39517056941986084,0.1976582556962967,-0.0019200579263269901,-0.30519214272499084,0.07690136134624481,0.008557945489883423,-0.2886960208415985},{0.28708741068840027,-0.1707960069179535,0.33882662653923035,-0.2239694893360138,-0.4214209318161011,-0.02875566855072975,-0.34488293528556824,0.33927562832832336,-0.09552496671676636,-0.25329455733299255,-0.24476207792758942,-0.026930050924420357,-0.044127222150564194,-0.08576459437608719,0.49491462111473083,-0.3767096698284149},{-0.33277612924575806,0.3425593674182892,-0.0789245069026947,0.1848861575126648,-0.06269846111536026,-0.21679964661598206,-0.23811988532543182,0.08606173098087311,-0.013915607705712318,0.5192860960960388,0.11136989295482635,-0.11353873461484909,0.04038507491350174,-0.25461411476135254,0.0967038944363594,0.15591363608837128},{0.10287558287382126,0.2749824523925781,-0.17478348314762115,-0.3384930491447449,0.3498835265636444,-0.1950656920671463,0.15720996260643005,-0.31186428666114807,0.10182783752679825,0.06430685520172119,0.08371783792972565,0.12902376055717468,0.026271935552358627,-0.40131276845932007,-0.055823199450969696,0.20809020102024078},{-0.21192024648189545,0.05366089567542076,-0.2761596739292145,-0.33051398396492004,0.2152819037437439,-0.40776926279067993,-0.11972589790821075,0.3189837634563446,-0.18101739883422852,0.14856599271297455,-0.040533289313316345,-0.12184031307697296,-0.3635912239551544,0.10813314467668533,-0.24196895956993103,-0.3253820836544037},{-0.15570399165153503,-0.15811918675899506,0.01645704358816147,-0.25694382190704346,-0.31532150506973267,-0.021336261183023453,0.14434021711349487,-0.39377763867378235,0.053755149245262146,-0.0903245210647583,0.28034520149230957,-0.054765474051237106,0.28688791394233704,0.1644788384437561,0.23542040586471558,0.24480849504470825},{-0.09776830673217773,-0.03088177740573883,-0.3991403579711914,0.30643752217292786,0.10773038864135742,0.15343314409255981,0.2207004725933075,0.16505742073059082,-0.4280414581298828,0.19111323356628418,-0.33519724011421204,-0.20447589457035065,-0.35485363006591797,0.37131816148757935,-0.34595856070518494,0.10041692852973938},{-0.2395072728395462,-0.49238744378089905,-0.1353953778743744,0.15578120946884155,-0.22418054938316345,-0.03531700000166893,-0.10157440602779388,0.3902899920940399,0.46350347995758057,0.15559585392475128,-0.03311590850353241,-0.17197419703006744,0.13989928364753723,-0.4107690453529358,0.07961015403270721,-0.18524087965488434},{-0.2573574483394623,-0.4627683162689209,-0.15993112325668335,-0.13823342323303223,-0.48796048760414124,0.5028874278068542,-0.15917308628559113,0.20415323972702026,-0.11827933043241501,-0.23968061804771423,-0.3320927917957306,0.4338364601135254,-0.1698189526796341,-0.04551038518548012,-0.2379394918680191,0.3551253378391266},{-0.34463828802108765,0.3649539053440094,-0.22423285245895386,0.11752688139677048,-0.39315298199653625,0.1758633404970169,-0.03849569708108902,-0.3007865846157074,0.11360394209623337,0.2198808789253235,-0.26560086011886597,0.06514859944581985,0.2436531037092209,-0.3249361515045166,-0.34084782004356384,-0.1450529843568802},{-0.14308182895183563,-0.2910063564777374,-0.4511086344718933,0.19340403378009796,0.13761626183986664,0.04289600998163223,-0.24736180901527405,0.16975800693035126,-0.338319331407547,-0.2503519654273987,-0.3042481541633606,0.22092878818511963,-0.17271940410137177,0.13212652504444122,0.05362849682569504,0.29671236872673035}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10065940767526627,-0.06948600709438324,0.15644805133342743,-0.14541278779506683,-0.09695984423160553,0.11048916727304459,0.20618396997451782,-0.20983248949050903,-0.18066109716892242,0.2935711741447449,0.11297038942575455,0.11606846004724503,0.10325714945793152,0.17234337329864502,-0.15962441265583038,0.1473310887813568,0.12200639396905899,-0.33014923334121704,-0.19520056247711182,-0.05310482531785965,-0.15732775628566742,0.11924643814563751,-0.21436409652233124,0.2842172086238861,-0.10135813057422638,-0.04479695111513138,0.12116098403930664,0.19490692019462585,-0.24957895278930664,-0.15034443140029907,0.19605503976345062,0.2813977301120758},{0.22471605241298676,-0.05451672896742821,0.13673342764377594,-0.10421369969844818,-0.13454566895961761,0.24863649904727936,-0.01666630059480667,-0.06766314804553986,-0.03946949914097786,0.0058316802605986595,-0.13533613085746765,0.01763354428112507,0.3984704613685608,0.1664130687713623,0.13008995354175568,0.08616863936185837,-0.2534174919128418,-0.36806929111480713,0.08172056823968887,0.04483155533671379,0.06026799976825714,0.30166932940483093,0.2149890959262848,-0.24653717875480652,0.05240904167294502,0.2832695543766022,-0.28924357891082764,0.18663936853408813,0.12228301912546158,-0.2418922334909439,-0.031782761216163635,0.012288333848118782},{-0.10335911065340042,-0.06236936151981354,0.2551794946193695,-0.22508712112903595,-0.19298897683620453,0.041634127497673035,-0.1428135484457016,0.24451833963394165,0.13845670223236084,-0.0023655849508941174,-0.16648560762405396,-0.005322866607457399,0.24811182916164398,-0.21785840392112732,0.08573618531227112,-0.041801728308200836,-0.3224503993988037,0.26547685265541077,-0.2658827006816864,-0.03786490485072136,0.005301094148308039,-0.13402095437049866,-0.07179221510887146,-0.11348967999219894,-0.02012064680457115,0.3181803524494171,-0.04930300638079643,0.08385861665010452,0.26151078939437866,-0.2685428857803345,-0.19307652115821838,-0.014268375933170319},{0.14489905536174774,-0.14296329021453857,0.07535961270332336,-0.3505196273326874,0.13527368009090424,-0.12912282347679138,-0.05912298336625099,0.27162858843803406,0.015936270356178284,0.15832968056201935,0.13779941201210022,-0.11558349430561066,-0.2087501734495163,-0.08888637274503708,0.3002493977546692,-0.23485247790813446,0.043961238116025925,-0.11759421229362488,-0.119715616106987,0.09285753220319748,-0.11081183701753616,0.05623128265142441,-0.206498384475708,0.25142544507980347,-0.27963462471961975,0.08215290307998657,-0.08323730528354645,-0.19663342833518982,0.04910481348633766,0.027479559183120728,0.23370613157749176,-0.11807569861412048},{0.2270946353673935,0.01948649249970913,0.04338632524013519,0.2607576251029968,-0.2460799217224121,-0.074086032807827,0.20035308599472046,-0.04426540806889534,0.09890489280223846,-0.19087988138198853,-0.0006132747512310743,-0.07856465131044388,-0.14255940914154053,-0.1670021265745163,0.2869037985801697,0.3233868181705475,-0.08147794008255005,-0.34823596477508545,0.173189178109169,-0.12604700028896332,-0.1227969154715538,0.20545348525047302,0.28601324558258057,0.03644277900457382,-0.06807450205087662,-0.10434209555387497,-0.026409175246953964,0.26764169335365295,0.2725679278373718,0.13016515970230103,0.0779929980635643,-0.2620238661766052},{0.31449100375175476,-0.16002105176448822,0.037434373050928116,0.09331902861595154,-0.15680158138275146,-0.31215471029281616,-0.20421695709228516,-0.30500638484954834,-0.2267596423625946,0.005585501901805401,-0.027982333675026894,-0.02209467627108097,-0.1628967821598053,-0.03670182079076767,-0.22681550681591034,-0.23602107167243958,0.18461525440216064,0.008804896846413612,-0.29761219024658203,0.17437615990638733,-0.046002477407455444,-0.22868366539478302,0.18112081289291382,-0.16637709736824036,-0.1355813592672348,-0.2423454225063324,-0.08976969867944717,0.1258130967617035,0.1073429062962532,0.2625676989555359,-0.2594028115272522,0.17036177217960358},{0.17415009438991547,0.06966173648834229,0.2578793466091156,-0.17944113910198212,0.22561629116535187,-0.19169797003269196,-0.2558425962924957,0.03494199365377426,0.28180402517318726,0.14959388971328735,-0.12064352631568909,0.08661511540412903,0.07246357202529907,0.3581695854663849,0.12968656420707703,-0.11698375642299652,-0.19497482478618622,0.15330849587917328,0.005147205665707588,0.03222782909870148,-0.08413650095462799,0.2370903640985489,0.1621471494436264,0.18211010098457336,-0.23242244124412537,-0.2610509395599365,-0.2619943916797638,-0.37895631790161133,0.00019889444229193032,-0.0930449441075325,0.2330833077430725,0.1508016437292099},{0.3169139325618744,-0.31986647844314575,0.13331487774848938,-0.3762021064758301,-0.29889199137687683,0.3018917143344879,0.37940388917922974,0.1540938913822174,-0.11544406414031982,0.03348008543252945,0.19627591967582703,-0.14227457344532013,0.13333240151405334,0.3123883903026581,-0.013194343075156212,0.20421592891216278,0.37680256366729736,-0.1953171342611313,-0.037967391312122345,-0.30534952878952026,0.14161449670791626,0.22262127697467804,0.2629554867744446,0.14322789013385773,0.0898146852850914,0.10553355515003204,0.11121827363967896,0.2668762505054474,-0.20074482262134552,-0.22528694570064545,0.259530633687973,-0.01821652054786682},{-0.018930330872535706,-0.06486070901155472,0.2568313777446747,0.22680053114891052,-0.18274271488189697,-0.33003321290016174,-0.051568981260061264,0.25603461265563965,-0.2033957540988922,-0.2945384085178375,0.11266741156578064,0.10513753443956375,0.10804643481969833,-0.2687638998031616,0.11831031739711761,-0.18615232408046722,-0.1605561226606369,0.1805959790945053,-0.22116398811340332,0.3286858797073364,-0.2682833671569824,-0.3690555989742279,-0.2927432060241699,0.27589401602745056,0.11544989049434662,0.12084800750017166,0.2531099021434784,0.172958105802536,-0.16351009905338287,-0.2825843095779419,-0.18155226111412048,0.13939638435840607},{0.31261730194091797,-0.008791986852884293,-0.03246777132153511,0.1488598734140396,0.04706290736794472,0.2483053058385849,0.007820836268365383,0.31851547956466675,-0.044473450630903244,0.08402049541473389,0.17972370982170105,0.05074247345328331,-0.2212519645690918,-0.40525200963020325,0.11120384931564331,0.15432792901992798,0.11784464120864868,-0.14365129172801971,-0.05309644713997841,-0.10365783423185349,0.16293229162693024,-0.3457939326763153,0.27943524718284607,0.03406333178281784,-0.052549611777067184,0.13063055276870728,-0.2940672039985657,-0.19050578773021698,0.018452776595950127,0.018312852829694748,0.14263878762722015,0.2600859999656677},{-0.12773184478282928,0.08951890468597412,-0.12967954576015472,0.16147740185260773,-0.1257634460926056,0.2641659080982208,0.12584148347377777,-0.012473203241825104,0.3019014894962311,-0.2914806306362152,-0.13782694935798645,0.15635092556476593,-0.19409367442131042,0.037942007184028625,-0.3146521747112274,-0.04280872642993927,0.11690295487642288,0.16320106387138367,0.055081844329833984,-0.1705864667892456,-0.20898817479610443,0.18307028710842133,0.1768825203180313,0.17618967592716217,-0.27219149470329285,0.3749156594276428,-0.07542054355144501,-0.0251875389367342,-0.12209111452102661,0.12703268229961395,0.2182321846485138,0.30002883076667786},{-0.21970178186893463,0.3150556683540344,-0.0514533594250679,0.0017584939487278461,-0.20758433640003204,-0.1942714899778366,0.1343737095594406,-0.33044230937957764,-0.05192679539322853,-0.29840439558029175,-0.1928473711013794,-0.030315909534692764,0.19728496670722961,-0.23829267919063568,-0.1340840756893158,-0.2876061797142029,-0.19277413189411163,-0.0516323484480381,0.31592071056365967,-0.2646689713001251,0.09798718988895416,-0.20295590162277222,0.0521434023976326,0.2963320016860962,-0.14172635972499847,0.17995668947696686,0.22436979413032532,-0.08946513384580612,-0.0184628926217556,0.29711490869522095,-0.16256669163703918,-0.3021850883960724},{-0.034617941826581955,0.19843406975269318,0.20096459984779358,-0.263070672750473,0.2654646933078766,0.007281776051968336,-0.1428162008523941,-0.02561815083026886,0.1619253009557724,-0.27432921528816223,-0.07857875525951385,0.03273336961865425,0.15804289281368256,0.02734544686973095,0.05083964765071869,-0.08518365770578384,0.21566706895828247,-0.26325562596321106,0.32312092185020447,0.06074907258152962,-0.17873156070709229,0.22961270809173584,-0.13380840420722961,-0.2220960259437561,0.24835535883903503,-0.09771908819675446,0.036934155970811844,-0.13793432712554932,0.061613332480192184,-0.14927884936332703,0.28593072295188904,0.2560912072658539},{0.043184470385313034,-0.1987183392047882,-0.18953171372413635,0.06613673269748688,-0.030374884605407715,0.27509579062461853,-0.11903201788663864,-0.32349851727485657,0.3332618772983551,0.030633648857474327,0.05360710248351097,0.06903164088726044,-0.10903958976268768,0.16902375221252441,-0.22702886164188385,-0.3253606855869293,0.01399807445704937,-0.00048193076509051025,0.16435536742210388,0.4366151690483093,-0.2449878305196762,0.15057659149169922,-0.15857906639575958,0.058313846588134766,0.1628367006778717,-0.32968929409980774,-0.14378446340560913,-0.2968454360961914,-0.14739926159381866,-0.1931198686361313,0.14734843373298645,-0.380641907453537},{-0.11564818024635315,0.3427464962005615,0.09369242191314697,-0.1787247210741043,-0.12972474098205566,-0.23977334797382355,0.14169739186763763,-0.0790398120880127,0.25614145398139954,-0.052680570632219315,0.2165859490633011,0.20178504288196564,-0.027280673384666443,0.06098296120762825,-0.13358119130134583,0.15518587827682495,-0.19564767181873322,-0.38008615374565125,-0.27051404118537903,0.10321535915136337,0.14564889669418335,-0.2267039567232132,-0.3520597815513611,-0.2665858566761017,-0.1526467651128769,0.12626351416110992,0.3668610751628876,0.006448451429605484,-0.0875166803598404,0.0612085685133934,-0.11579375714063644,0.1062973290681839},{-0.24039028584957123,-0.16115517914295197,-0.196297749876976,0.038746174424886703,-0.24654343724250793,-0.14037834107875824,-0.060933664441108704,-0.06717236340045929,-0.3084506094455719,-0.2725149989128113,0.2226579487323761,0.16124075651168823,-0.30429500341415405,0.2546252906322479,-0.06805252283811569,0.1608385294675827,0.09608224034309387,0.02567315474152565,0.0480356328189373,0.12995879352092743,0.24543842673301697,0.22262249886989594,0.12918232381343842,0.24946701526641846,0.11048673838376999,-0.208932027220726,-0.1666450798511505,0.24193038046360016,-0.030597113072872162,-0.1963147073984146,-0.17654575407505035,-0.16850289702415466},{-0.27444902062416077,-0.2012104094028473,-0.34621167182922363,0.0712798610329628,-0.1003098115324974,-0.05942174047231674,-0.10721822082996368,0.13097313046455383,-0.08554274588823318,0.07660586386919022,-0.21957984566688538,0.018609557300806046,0.15477778017520905,-0.11046098172664642,0.052519965916872025,0.21395917236804962,-0.11559247225522995,-0.13998442888259888,0.17446169257164001,0.03928794339299202,0.19589950144290924,-0.025246087461709976,-0.21049301326274872,0.05588604509830475,0.20200645923614502,-0.2547040283679962,0.1499970257282257,0.06895286589860916,0.09189634770154953,-0.14877083897590637,0.24362221360206604,-0.05570843443274498},{0.2495972216129303,-0.0011124014854431152,0.025963513180613518,0.17834672331809998,-0.3477742075920105,-0.03958979249000549,0.07416777312755585,0.16064514219760895,-0.07253004610538483,-0.1524645984172821,0.3031655251979828,-0.09692808985710144,0.06121239438652992,-0.035328738391399384,-0.12349294871091843,0.27190425992012024,-0.05312886834144592,-0.13008882105350494,0.10246819257736206,-0.29877573251724243,-0.04267255589365959,-0.2597392201423645,-0.199664905667305,0.2319328635931015,-0.050652068108320236,-0.046833958476781845,0.1416749507188797,0.05116312950849533,-0.16696305572986603,-0.07958900183439255,-0.026343442499637604,-0.07502423971891403},{0.3024393618106842,-0.06921902298927307,0.06883467733860016,0.05643974617123604,-0.032077521085739136,-0.0868677869439125,0.18716926872730255,-0.2450014054775238,0.2548210322856903,0.29012760519981384,0.030634883791208267,0.1412992775440216,0.24689169228076935,0.3348177373409271,-0.28570786118507385,-0.35691964626312256,-0.24408338963985443,0.07870104908943176,-0.16485761106014252,-0.29998475313186646,-0.17200610041618347,0.258944571018219,0.06449387222528458,0.16297772526741028,-0.14572648704051971,-0.12959171831607819,-0.1427687704563141,-0.24135452508926392,0.24649213254451752,0.1881842315196991,-0.3276735246181488,-0.14992395043373108},{-0.10474022477865219,0.1524941772222519,0.27427467703819275,-0.03551129996776581,-0.03511037304997444,0.07717492431402206,-0.02359870634973049,-0.33445224165916443,0.18614716827869415,0.2452877163887024,0.16336408257484436,0.22629818320274353,-0.2192123979330063,0.19287879765033722,-0.25489842891693115,0.29695481061935425,0.16638384759426117,-0.25932183861732483,0.24486283957958221,0.08318684250116348,-0.3554273843765259,0.32103559374809265,-0.24698756635189056,0.16721902787685394,0.2164158970117569,0.25668132305145264,0.05308986082673073,0.13488854467868805,-0.17492544651031494,0.23749959468841553,-0.04769859090447426,0.09320154041051865},{-0.12342101335525513,-0.10905198007822037,0.00904037244617939,0.181064173579216,0.025644905865192413,0.22440411150455475,-0.2708333730697632,-0.10947762429714203,-0.1495092809200287,-0.08019956946372986,-0.14041006565093994,-0.18269258737564087,0.01703832298517227,-0.19870683550834656,0.09676776826381683,-0.20629826188087463,0.24387842416763306,-0.02618812769651413,-0.3066430687904358,-0.2910756766796112,0.1279904693365097,0.16406400501728058,-0.16016365587711334,0.33067604899406433,-0.25809046626091003,0.04405795410275459,0.0966714546084404,-0.09793739765882492,0.16127103567123413,-0.20896722376346588,0.2974807620048523,0.12684492766857147},{0.3155781924724579,0.05755309388041496,0.07144623249769211,0.2296174168586731,-0.2248806208372116,0.17265427112579346,-0.0864393338561058,0.161600723862648,0.10643719136714935,0.03466615080833435,0.09244753420352936,-0.31822308897972107,-0.25433477759361267,0.024199390783905983,0.0852128267288208,-0.07354510575532913,0.2633112072944641,0.1429252326488495,-0.1787213236093521,-0.21760284900665283,0.33654648065567017,0.18627728521823883,0.24712318181991577,0.07601825892925262,-0.025032753124833107,0.05905751511454582,-0.06194319576025009,-0.15792116522789001,0.2812994122505188,0.029026271775364876,-0.18571461737155914,0.11552732437849045},{-0.018298551440238953,0.021723924204707146,-0.03847787529230118,-0.2675936222076416,-0.09122426062822342,-0.22404395043849945,-0.21492640674114227,-0.13275139033794403,-0.028496896848082542,-0.02175268717110157,-0.25668808817863464,0.018813202157616615,-0.24536173045635223,-0.1649142950773239,0.0072980220429599285,0.10532927513122559,0.2726069390773773,-0.17542466521263123,-0.32608163356781006,0.2500850260257721,-0.17588402330875397,0.26081591844558716,0.031779106706380844,-0.03604559227824211,0.01882372610270977,0.16524003446102142,-0.07743892818689346,-0.25715723633766174,0.23144836723804474,0.25896915793418884,-0.1178339421749115,0.18712180852890015},{-0.23335273563861847,-0.03212399408221245,0.04632462561130524,-0.026231639087200165,0.10521671175956726,0.13969683647155762,-0.19442567229270935,0.11021329462528229,-0.1576174795627594,-0.13376617431640625,0.06674539297819138,-0.13611285388469696,-0.18949134647846222,0.25024667382240295,0.01863938942551613,0.04416211321949959,0.1847725659608841,-0.2579212188720703,-0.16142643988132477,0.3012228012084961,0.019390864297747612,0.2634103298187256,-0.05815175920724869,0.017347469925880432,-0.2649066150188446,-0.1854315549135208,0.003506840206682682,0.292305052280426,-0.008133276365697384,0.0012221159413456917,0.29444628953933716,0.3101409673690796}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10722499340772629,0.1668015569448471,0.35350891947746277,-0.01760008931159973},{0.10002708435058594,-0.08333296328783035,0.05981113016605377,0.19097261130809784},{-0.15728430449962616,0.2100697159767151,0.11837749183177948,0.13710898160934448},{0.32682764530181885,0.014207510277628899,0.06005477532744408,0.41816800832748413},{-0.10889215022325516,0.09512614458799362,0.30634889006614685,-0.036361757665872574},{-0.11857334524393082,0.2246992439031601,0.23267637193202972,-0.10494211316108704},{-0.26865383982658386,-0.004062050953507423,0.008392282761633396,-0.12053467333316803},{-0.38250747323036194,-0.13938534259796143,0.37525853514671326,-0.2921854555606842},{0.33357107639312744,-0.16672518849372864,-0.2849268615245819,-0.38390135765075684},{0.06097884848713875,0.3039742708206177,0.3382875323295593,-0.4291672110557556},{-0.16210629045963287,-0.16163209080696106,-0.21212883293628693,0.20352989435195923},{0.31415581703186035,-0.18841008841991425,-0.00356388371437788,0.20101721584796906},{0.311202734708786,0.296311616897583,-0.06977640837430954,0.10097780078649521},{0.026298126205801964,0.09389393776655197,-0.3053910732269287,0.01608913205564022},{0.10522927343845367,0.28828972578048706,0.37845903635025024,0.3325681686401367},{0.15387201309204102,0.03638937696814537,0.30233490467071533,0.24846939742565155},{-0.23383034765720367,-0.10469888150691986,-0.12384495884180069,-0.23109374940395355},{-0.20209485292434692,0.11922743171453476,-0.16484931111335754,-0.12340302020311356},{-0.17652074992656708,0.18479064106941223,0.16241736710071564,0.3034847378730774},{-0.03849910572171211,0.3416019082069397,-0.18912196159362793,0.07023640722036362},{-0.2587951719760895,-0.3856799900531769,-0.11670765280723572,0.022694719955325127},{0.33321958780288696,0.4421827793121338,0.04253891482949257,-0.2745817005634308},{-0.02992042526602745,0.15993449091911316,0.21186691522598267,0.16261406242847443},{-0.10390590131282806,0.38454127311706543,-0.07743954658508301,-0.14391061663627625},{0.03969025984406471,-0.03690372779965401,-0.08379481732845306,0.005413022357970476},{0.2710449993610382,-0.42318251729011536,-0.020309174433350563,0.036141376942396164},{0.006474325433373451,-0.326334148645401,-0.19608041644096375,-0.22968360781669617},{0.11035346984863281,-0.11755213886499405,0.2330288141965866,0.1432802677154541},{0.004695434123277664,-0.06503656506538391,0.1006603017449379,0.031126325950026512},{-0.348376601934433,0.349880576133728,0.23828238248825073,-0.08578275889158249},{0.3304016888141632,-0.14023803174495697,0.19291116297245026,-0.05297524109482765},{0.05232847109436989,-0.36217430233955383,0.40059542655944824,-0.3020080327987671}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.04365061596035957,-0.025466201826930046,0.0253672506660223,-0.02644914574921131,-0.039584700018167496,-0.16373106837272644,-0.010114399716258049,0.060967814177274704,0.024959981441497803,-0.06947890669107437,0.12522324919700623,0.06728284806013107,-0.03087671846151352,-0.05925407633185387,0.08036457747220993,-0.03598053380846977};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.07432204484939575,0.04683549329638481,0.03695773333311081,0.03259138762950897,0.05315471068024635,-0.005885372404009104,0.0612691268324852,-0.01221015490591526,-0.001670956495217979,0.00950581207871437,-0.033932045102119446,-0.03160320594906807,0.06673376262187958,-0.023793505504727364,-0.026262806728482246,-0.021030688658356667};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07033563405275345,0.06615223735570908,0.017413299530744553,0.06345613300800323,0.044869400560855865,-0.019973905757069588,-0.043256934732198715,-0.011443106457591057,-0.02757144905626774,-0.0010145488195121288,-0.04423002153635025,0.05299064889550209,0.05209265276789665,-0.06097836792469025,0.07436331361532211,0.07398983836174011,-0.06813972443342209,-0.06285829097032547,0.011246506124734879,0.01593230478465557,-0.03186318650841713,0.00015255124890245497,0.05799274891614914,0.0010087444679811597,-0.019455140456557274,0.016133515164256096,-0.03882439807057381,0.0566394105553627,0.0405019111931324,0.003172004595398903,0.03695520758628845,0.03877441957592964};
static const float action_parameterization_distribution_linear_bias[4] = {0.04203040525317192,0.0035491534508764744,0.05337553098797798,0.04836806654930115};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.015157359652221203,0.2772408425807953,-0.0903666615486145,0.14260055124759674,0.2628048360347748,0.1429617702960968,0.2662184238433838,0.056133054196834564},{-0.19703549146652222,-0.05500226467847824,-0.20270544290542603,-0.28858399391174316,-0.2897544503211975,-0.1638518124818802,-0.15707968175411224,-0.13826969265937805},{-0.26875296235084534,0.03878423571586609,0.2919064462184906,0.19005343317985535,0.23961618542671204,-0.0027767338324338198,0.21750284731388092,-0.08695244044065475},{0.011134393513202667,0.10531917959451675,-0.1402771919965744,-0.021612130105495453,-0.011294516734778881,-0.07642319798469543,0.22259871661663055,-0.16114987432956696},{-0.2716078758239746,-0.11511090397834778,-0.2098134309053421,-0.13792438805103302,-0.06099916249513626,0.14562852680683136,0.14633625745773315,-0.0033921413123607635},{-0.3103027045726776,0.042988184839487076,0.35112956166267395,0.2562941908836365,0.18681453168392181,-0.12052365392446518,-0.11287013441324234,-0.10192649066448212},{-0.1991048902273178,0.1052006408572197,0.3288939595222473,-0.1959385871887207,-0.09470544755458832,-0.3959253132343292,-0.07456851750612259,-0.1312989741563797},{-0.4061109125614166,-0.3422217071056366,0.48509058356285095,-0.03553406894207001,-0.23211024701595306,0.15241172909736633,0.16275544464588165,-0.17496630549430847},{-0.3244340717792511,0.21871627867221832,-0.1616872102022171,0.43301698565483093,0.09006645530462265,-0.39678406715393066,0.0747024267911911,0.11408789455890656},{-0.3263331651687622,-0.3676932454109192,-0.13953472673892975,-0.13286827504634857,-0.4985694885253906,0.019982481375336647,-0.03963374346494675,0.14278121292591095},{0.1598208099603653,0.3225667476654053,0.21466787159442902,0.019080480560660362,0.20860247313976288,0.053951676934957504,-0.26436713337898254,0.22873204946517944},{0.2271028608083725,0.0005077473470009863,0.28720390796661377,0.26050785183906555,-0.18659254908561707,0.2810787856578827,-0.01619919016957283,-0.22275283932685852},{0.11678846180438995,-0.26839691400527954,0.26249051094055176,-0.02828514389693737,-0.1753951460123062,-0.04329734295606613,-0.13305650651454926,-0.15810033679008484},{-0.2098766416311264,-0.11589142680168152,0.32857415080070496,0.3974367380142212,-0.08181944489479065,-0.040109846740961075,-0.2323610782623291,0.1203208714723587},{-0.010555517859756947,-0.14204056560993195,0.08689728379249573,-0.171954944729805,-0.3352527320384979,-0.10245511680841446,0.24209685623645782,-0.034893278032541275},{0.06212247163057327,-0.0457792766392231,-0.046259090304374695,-0.2925238311290741,-0.11682062596082687,0.08213312923908234,-0.022777173668146133,0.3787781596183777},{-0.027336781844496727,-0.19630444049835205,-0.1985868364572525,0.04708068445324898,-0.1496914178133011,-0.11530869454145432,-0.10333530604839325,0.07753472775220871},{-0.21749810874462128,-0.24896353483200073,0.06534691900014877,-0.0022887822706252337,0.14461606740951538,-0.19191250205039978,0.37080010771751404,0.16856855154037476},{0.0019279065309092402,0.15561974048614502,-0.225847527384758,0.10455732047557831,0.11416931450366974,0.14818419516086578,-0.17952615022659302,0.2915602922439575},{0.14101794362068176,-0.0592975877225399,-0.37209904193878174,0.0849827229976654,-0.06674481183290482,-0.10959911346435547,-0.2731528580188751,0.012093177996575832},{0.011321621015667915,-0.15894989669322968,0.021861350163817406,-0.1166829839348793,0.2584649324417114,-0.07073955982923508,-0.049348652362823486,0.4376038610935211},{-0.009484805166721344,0.09526752680540085,-0.3407030999660492,0.1982448697090149,0.26944321393966675,0.2849428355693817,0.11322261393070221,-0.27057307958602905},{-0.39563411474227905,-0.11796506494283676,0.08476744592189789,-0.09950320422649384,0.13285493850708008,-0.3395998775959015,0.1249677911400795,-0.23123405873775482},{-0.07981159538030624,0.10839387029409409,-0.09691375494003296,-0.4649924337863922,0.22823677957057953,0.04599648341536522,-0.36690062284469604,0.1582118719816208},{-0.18366384506225586,-0.18288525938987732,-0.09236316382884979,0.0794283002614975,0.07141656428575516,0.28553295135498047,0.29203253984451294,-0.04968724399805069},{-0.19548434019088745,0.06505278497934341,-0.32501333951950073,-0.2521344721317291,0.11782919615507126,0.019599121063947678,-0.06042853370308876,0.07411442697048187},{0.2979440689086914,0.3648627698421478,-0.21562717854976654,0.23491989076137543,0.08019030094146729,0.3153668940067291,-0.2866322100162506,-0.1634543240070343},{0.3939322233200073,0.24810835719108582,0.12101681530475616,0.1084514856338501,0.2054678201675415,0.08400202542543411,0.23323555290699005,0.37363678216934204},{-0.10393497347831726,0.3762262463569641,0.18212656676769257,0.04701966792345047,0.25168707966804504,0.014581059105694294,-0.3896803855895996,-0.2822915017604828},{-0.15880678594112396,-0.25339093804359436,0.05016419664025307,-0.1712648868560791,-0.25574979186058044,-0.19172793626785278,0.23986028134822845,-0.0038702660240232944},{0.4150159955024719,-0.2891751527786255,0.2952331602573395,-0.2643992304801941,0.11662528663873672,0.2543298006057739,0.0901833176612854,-0.14035910367965698},{0.1996455192565918,0.37228256464004517,0.446256160736084,-0.2415396273136139,-0.1876388043165207,0.07781874388456345,0.21207335591316223,0.0908370316028595}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.0011672483524307609,0.4058401882648468,-0.18569011986255646,0.24540045857429504,-0.38568222522735596,0.23490971326828003,0.4343583881855011,0.05348614230751991},{-0.4222460389137268,-0.4595491886138916,-0.35677197575569153,-0.4095552861690521,-0.4184034764766693,0.4083223044872284,0.4632740914821625,-0.41343799233436584},{0.00406367564573884,-0.13480119407176971,0.09576908499002457,0.003786883782595396,-0.07609915733337402,0.4288822114467621,-0.31975820660591125,-0.3316178619861603},{0.45325911045074463,-0.004020377993583679,0.06951818615198135,0.001241518766619265,0.5403664112091064,0.35716795921325684,0.39589565992355347,0.44385936856269836},{0.08547187596559525,0.23031042516231537,-0.14089030027389526,-0.0646355152130127,0.1198217123746872,-0.3272300660610199,-0.37926924228668213,0.4468403160572052},{0.4074190557003021,0.0960308238863945,0.021983901038765907,-0.3489238917827606,-0.3989655673503876,-0.46770328283309937,-0.09936598688364029,0.49327388405799866},{-0.37462952733039856,-0.29448002576828003,-0.010949298739433289,-0.2190607488155365,0.05622448772192001,0.35931479930877686,-0.5148317217826843,0.5614627599716187},{0.1673809438943863,0.07718268036842346,0.01120657380670309,-0.05867992714047432,0.3396175801753998,-0.521622896194458,0.3835931718349457,-0.47478485107421875}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0510609932243824,0.028921740129590034,0.08893321454524994,-0.043290261179208755,-0.03595339134335518,-0.03172282129526138,0.07691305130720139,-0.03428805619478226};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03586571663618088,-0.02492830716073513,0.033612996339797974,-0.11118459701538086,-0.015149603597819805,0.00548853212967515,-0.004717993550002575,-0.05853389948606491};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

