#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.260172963142395,0.02045057713985443,-0.15623155236244202,0.2825564742088318,0.3077526092529297,-0.2059767097234726,-0.22050543129444122,0.12450811266899109,0.2631741762161255,-0.3128160536289215,0.6269307732582092,-0.008368697948753834,0.2969696819782257,0.0997343435883522,-0.4456925094127655,0.04503149539232254},{-0.22557350993156433,-0.27471187710762024,-0.31579720973968506,-0.18661373853683472,0.06846779584884644,0.25607597827911377,0.06694939732551575,0.06543110311031342,0.24415023624897003,0.20523729920387268,-0.1890365332365036,-0.08656901121139526,-0.17269517481327057,0.07215587049722672,0.3409557342529297,-0.3091740012168884},{0.12563391029834747,0.21663932502269745,0.19884313642978668,0.3409118056297302,-0.08525173366069794,-0.22980760037899017,0.5113131403923035,-0.03258306905627251,-0.01510084792971611,-0.1314813643693924,-0.005832076538354158,-0.010986171662807465,0.06960126757621765,0.4723987281322479,-0.2783702611923218,-0.03821966052055359},{0.12472838163375854,-0.14857716858386993,-0.15583790838718414,-0.1023496463894844,0.030038829892873764,0.11677806824445724,0.09187997132539749,-0.1975737363100052,-0.15205347537994385,0.15103690326213837,0.5163768529891968,-0.2013767510652542,-0.1723203808069229,-0.15903371572494507,0.16866718232631683,0.1350054293870926},{-0.31177040934562683,0.06693617254495621,0.14010953903198242,-0.21744582056999207,0.27968916296958923,0.3207851052284241,0.14636853337287903,-0.19106806814670563,-0.10846307128667831,0.15246443450450897,-0.1365528255701065,-0.3862173855304718,-0.020820377394557,-0.1371421366930008,0.31569966673851013,-0.037551600486040115},{-0.040477264672517776,0.008577779866755009,-0.030438577756285667,0.010414699092507362,0.11808893084526062,-0.06661596149206161,0.3976828157901764,-0.351924866437912,-0.1394520401954651,-0.16792799532413483,0.30748510360717773,0.017218954861164093,0.19118370115756989,0.09438244998455048,0.2676798701286316,0.2746780216693878},{-0.174612358212471,0.1570999175310135,-0.020172864198684692,0.11768803745508194,-0.22004328668117523,-0.07388424873352051,-0.15667739510536194,-0.031081289052963257,0.1298537701368332,0.35579025745391846,-0.18280427157878876,-0.07666148990392685,0.20668070018291473,0.07432473450899124,-0.19367852807044983,0.288017213344574},{-0.10809154808521271,-0.045509129762649536,-0.2064376026391983,-0.2114744931459427,0.3617449104785919,-0.33786940574645996,-0.31536975502967834,-0.4089733958244324,-0.07852205634117126,-0.23145422339439392,0.3936435580253601,-0.035417258739471436,0.23725253343582153,0.1434963345527649,-0.21148590743541718,0.43606531620025635},{0.23242060840129852,0.06543387472629547,-0.02180299535393715,0.10401717573404312,-0.4028888940811157,-0.39916399121284485,0.34740957617759705,-0.33089113235473633,-0.16015878319740295,0.2200804203748703,0.18215937912464142,-0.3081519305706024,-0.13770738244056702,0.03128133714199066,0.18541234731674194,-0.0033667543902993202},{0.4259592294692993,-0.5001546144485474,-0.04899491369724274,0.021076612174510956,0.2651045024394989,-0.09889235347509384,-0.24132150411605835,-0.13436122238636017,-0.17201583087444305,0.012173909693956375,0.015558036044239998,-0.20213553309440613,0.3522900640964508,-0.07282909005880356,-0.5510942339897156,-0.17752966284751892},{0.2684134542942047,0.15059669315814972,-0.3035130500793457,0.12033449858427048,0.005714164115488529,-0.17732685804367065,-0.11622801423072815,0.15273600816726685,-0.15076948702335358,0.11798243969678879,0.21327774226665497,0.2161477506160736,-0.10850407928228378,0.24674880504608154,-0.036469824612140656,-0.2853807210922241},{-0.4533994495868683,0.28346171975135803,0.2370840311050415,-0.283384770154953,-0.2542755901813507,0.3145304322242737,0.048409610986709595,0.2965330183506012,0.22813542187213898,0.15386666357517242,0.19687283039093018,-0.12527647614479065,0.1624799370765686,-0.08358826488256454,-0.08207201212644577,-0.16468077898025513},{0.07934755086898804,-0.24071478843688965,-0.2214946299791336,0.17057940363883972,-0.2225627601146698,-0.21935538947582245,-0.10995297133922577,0.24873262643814087,0.33301445841789246,-0.14435268938541412,-0.043334800750017166,0.05172654613852501,0.24599435925483704,0.13950607180595398,-0.195054292678833,0.2860420048236847},{0.2756184935569763,0.16041302680969238,-0.11237062513828278,-0.10633167624473572,0.04670027270913124,-0.06771335750818253,-0.1190391480922699,0.2889949679374695,-0.2136698067188263,-0.18683572113513947,-0.14437244832515717,0.04741127789020538,-0.20944532752037048,-0.10818655788898468,-0.2273912876844406,-0.03359377011656761},{0.16020716726779938,0.4173456132411957,0.4021495580673218,-0.3342251479625702,-0.3548811078071594,0.17089596390724182,0.009765664115548134,-0.1461647003889084,0.4087197184562683,0.3991464078426361,-0.12844963371753693,0.11579372733831406,-0.10592219233512878,-0.3108343482017517,0.08536870032548904,-0.15933749079704285},{-0.20497259497642517,-0.15963351726531982,-0.09139245003461838,0.42617034912109375,-0.22822166979312897,-0.2074275016784668,-0.2286895364522934,-0.2749113440513611,-0.48893752694129944,-0.2232605367898941,0.3333629071712494,0.2762259840965271,-0.5723587274551392,-0.35373160243034363,-0.5491808652877808,-0.17878952622413635},{-0.4651087820529938,0.15982413291931152,-0.3096923828125,-0.1637142151594162,-0.45595744252204895,0.18937230110168457,0.5099748373031616,0.08968980610370636,0.4039885997772217,-0.47342756390571594,0.2371765375137329,-0.3505147397518158,-0.21076181530952454,0.031696103513240814,-0.1806102693080902,-0.20257651805877686},{0.3676435053348541,-0.5932590365409851,0.28788280487060547,0.22910018265247345,-0.1166331022977829,0.45386451482772827,0.23264476656913757,0.2884542942047119,-0.06412690132856369,-0.2544792890548706,-0.14854247868061066,-0.1324353814125061,-0.12556898593902588,-0.5258406400680542,0.26808589696884155,-0.10804242640733719}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.027568113058805466,0.2970731258392334,0.2196766585111618,-0.15516629815101624,-0.18370574712753296,0.034995321184396744,-0.017766373232007027,0.2390049248933792,-0.09238067269325256,0.3144530653953552,0.47509247064590454,-0.3857075870037079,0.05835280194878578,0.05016208812594414,0.007228739559650421,-0.08740225434303284},{-0.35356250405311584,0.1912618726491928,-0.1573450118303299,0.3085591197013855,0.2677951157093048,-0.0808728039264679,-0.3149559199810028,-0.14782580733299255,0.3424265384674072,0.2694074809551239,-0.06245115399360657,0.21049293875694275,-0.37955141067504883,0.17178593575954437,-0.205508291721344,0.43090203404426575},{-0.2501762807369232,0.12573306262493134,-0.24785172939300537,0.14143773913383484,-0.4368732273578644,-0.17324578762054443,0.02040567249059677,0.12941133975982666,-0.1644235998392105,0.3669983744621277,0.2241188883781433,-0.11594825983047485,0.14699631929397583,-0.26680225133895874,-0.09655200690031052,-0.030898407101631165},{0.22277946770191193,-0.22107486426830292,0.09612119197845459,0.39025402069091797,-0.4173397719860077,-0.32135534286499023,0.26116859912872314,0.03549744188785553,0.28102409839630127,-0.0897989347577095,0.31741514801979065,0.09552685171365738,-0.19359932839870453,0.01602613553404808,-0.010319803841412067,-0.37828749418258667},{-0.40123432874679565,-0.08456538617610931,0.1301850974559784,-0.259752094745636,0.14019612967967987,0.32570216059684753,-0.3040793538093567,0.2799772620201111,-0.19788797199726105,0.19387303292751312,0.0001900524803204462,0.053841281682252884,-0.2787304222583771,-0.012660796754062176,-0.26562485098838806,-0.09190037101507187},{0.07472575455904007,-0.2952467203140259,0.000673141039442271,-0.32557225227355957,0.21989805996418,0.029113858938217163,-0.1275981068611145,-0.058360178023576736,-0.12354317307472229,0.36527058482170105,0.1807767152786255,0.013030954636633396,-0.29801398515701294,0.08691676706075668,0.01291666179895401,-0.31503525376319885},{0.253059446811676,-0.2275199443101883,0.31717997789382935,-0.18798089027404785,-0.42035067081451416,0.034981515258550644,-0.354838103055954,0.34856894612312317,-0.10589595139026642,-0.25732192397117615,-0.2459862232208252,-0.024691777303814888,-0.06958328932523727,-0.07451176643371582,0.5006368160247803,-0.37911519408226013},{-0.34191644191741943,0.3386130630970001,-0.09417382627725601,0.1947537511587143,-0.1062953770160675,-0.23054394125938416,-0.2120865136384964,0.09786120057106018,-0.06663202494382858,0.46167635917663574,0.07956952601671219,-0.12782599031925201,0.05695972964167595,-0.21540987491607666,0.059544019401073456,0.15640322864055634},{0.1281234323978424,0.267842561006546,-0.17485786974430084,-0.298252671957016,0.3114132285118103,-0.1945113241672516,0.18748711049556732,-0.2523595094680786,0.005422401241958141,0.019293641671538353,0.10400943458080292,0.08141839504241943,0.013734856620430946,-0.3648003339767456,-0.07346571236848831,0.1958659589290619},{-0.17752017080783844,0.03695020079612732,-0.2659902572631836,-0.3058394491672516,0.21890519559383392,-0.3885918855667114,-0.10659430176019669,0.3070661723613739,-0.16996198892593384,0.132784903049469,-0.047098662704229355,-0.10488550364971161,-0.36244863271713257,0.1156369149684906,-0.22819086909294128,-0.3534168004989624},{-0.1264466941356659,-0.1622348427772522,0.015237201005220413,-0.23974497616291046,-0.312999963760376,0.021823735907673836,0.13800407946109772,-0.31114351749420166,0.022228840738534927,-0.08947894722223282,0.26201102137565613,-0.06314472109079361,0.22685253620147705,0.1561024785041809,0.2187860906124115,0.2509263753890991},{-0.12621745467185974,-0.027417687699198723,-0.3212949335575104,0.3194120228290558,0.08599567413330078,0.15932336449623108,0.19494231045246124,0.148161843419075,-0.4162934422492981,0.19602049887180328,-0.34847694635391235,-0.2265576422214508,-0.341298907995224,0.339781254529953,-0.3361566960811615,0.09529527276754379},{-0.17152458429336548,-0.44346776604652405,-0.06385350227355957,0.12980486452579498,-0.22537711262702942,-0.05994085222482681,-0.08612260222434998,0.38436511158943176,0.44172170758247375,0.1245567724108696,0.002551526762545109,-0.17730477452278137,0.15224376320838928,-0.3747795820236206,0.08956193178892136,-0.16053412854671478},{-0.2661839425563812,-0.4568714499473572,-0.12442045658826828,-0.13183186948299408,-0.5042558312416077,0.4722321033477783,-0.15703873336315155,0.2041175216436386,-0.14894071221351624,-0.2378491908311844,-0.2973424196243286,0.3896524906158447,-0.12863147258758545,-0.03414725884795189,-0.20183530449867249,0.3317510485649109},{-0.31312161684036255,0.355928510427475,-0.2378050982952118,0.1487537920475006,-0.35032734274864197,0.1413513571023941,-0.002598702209070325,-0.3330158293247223,0.13259275257587433,0.1950225681066513,-0.23110654950141907,0.06634228676557541,0.24497662484645844,-0.3004564046859741,-0.3363014757633209,-0.17475147545337677},{-0.12779325246810913,-0.28187647461891174,-0.4073032736778259,0.22659742832183838,0.13824152946472168,0.05109879747033119,-0.22524021565914154,0.16177594661712646,-0.35925745964050293,-0.23486633598804474,-0.28627681732177734,0.1861661821603775,-0.20885014533996582,0.1368168145418167,0.03975728526711464,0.29390496015548706}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11685936897993088,-0.04130116477608681,0.19739750027656555,-0.1345382034778595,-0.08000585436820984,0.09365799278020859,0.22211357951164246,-0.1895054280757904,-0.22716540098190308,0.25784435868263245,0.15135326981544495,0.11604733020067215,0.06270676106214523,0.17429834604263306,-0.15327094495296478,0.1648104190826416,0.1401899755001068,-0.3415917754173279,-0.15093651413917542,-0.0849326029419899,-0.11375907808542252,0.041566647589206696,-0.1892990916967392,0.2545273005962372,-0.08724287152290344,-0.05839712917804718,0.11432528495788574,0.2091234028339386,-0.19945451617240906,-0.130816251039505,0.17070919275283813,0.25741443037986755},{0.2166365534067154,-0.07230871915817261,0.1351861208677292,-0.13127078115940094,-0.12733665108680725,0.24122314155101776,-0.003710955148562789,-0.07062279433012009,-0.047893352806568146,0.019140349701046944,-0.14428383111953735,0.0033594018314033747,0.39524802565574646,0.17738521099090576,0.11624541878700256,0.060386452823877335,-0.21504703164100647,-0.3521776795387268,0.06813967972993851,0.04269076883792877,0.06679967045783997,0.2873499393463135,0.2025434821844101,-0.23853321373462677,0.03146630898118019,0.25498491525650024,-0.2717181444168091,0.17908667027950287,0.09694898873567581,-0.22678910195827484,-0.06519033014774323,-0.016261965036392212},{-0.10086686164140701,-0.0669126957654953,0.3052521049976349,-0.23636960983276367,-0.15404503047466278,0.05767710506916046,-0.1200796514749527,0.26355573534965515,0.10191807895898819,-0.0014739565085619688,-0.1747584342956543,-0.03157377243041992,0.23478177189826965,-0.21959103643894196,0.10167022049427032,-0.034516774117946625,-0.3008819818496704,0.2757473587989807,-0.22332914173603058,-0.03811974450945854,0.00784886721521616,-0.1444999873638153,-0.04022615775465965,-0.08168931305408478,-0.016456736251711845,0.26234546303749084,-0.07511219382286072,0.09495803713798523,0.24729056656360626,-0.22661738097667694,-0.21877926588058472,-0.05463496968150139},{0.14401787519454956,-0.09730841219425201,0.06502488255500793,-0.317841500043869,0.11389224976301193,-0.15530553460121155,-0.08306168764829636,0.2643483877182007,0.018261004239320755,0.12312289327383041,0.15795840322971344,-0.08393478393554688,-0.1915157586336136,-0.09359079599380493,0.3036143183708191,-0.22557313740253448,0.023498008027672768,-0.1418369710445404,-0.12569358944892883,0.10463953018188477,-0.10636674612760544,0.04050878807902336,-0.2007978856563568,0.22152996063232422,-0.24704936146736145,0.10881834477186203,-0.09414228051900864,-0.17756293714046478,0.09795549511909485,-0.0077220117673277855,0.2596631944179535,-0.11972229182720184},{0.20727287232875824,-0.0024736416526138783,0.03499194234609604,0.23862285912036896,-0.2491922229528427,-0.08149898797273636,0.20678840577602386,-0.056964412331581116,0.11343689262866974,-0.18140828609466553,0.0015695905312895775,-0.08814477175474167,-0.1508217602968216,-0.16153167188167572,0.26760345697402954,0.3055587112903595,-0.06331871449947357,-0.33390286564826965,0.1564638614654541,-0.117789626121521,-0.11822624504566193,0.20148815214633942,0.2612156569957733,0.058582402765750885,-0.04756252095103264,-0.09339026361703873,-0.007862185128033161,0.2571928799152374,0.24051839113235474,0.13678328692913055,0.08107762783765793,-0.24466760456562042},{0.32314494252204895,-0.152285635471344,0.002669617300853133,0.09711611270904541,-0.13550487160682678,-0.32902297377586365,-0.20560775697231293,-0.29709017276763916,-0.19485901296138763,0.02500537410378456,-0.05224677920341492,-0.012753479182720184,-0.1672918051481247,-0.05479131639003754,-0.21819134056568146,-0.2262773960828781,0.16686488687992096,-0.013545241206884384,-0.3109646439552307,0.15199142694473267,-0.057123586535453796,-0.21800324320793152,0.1780838668346405,-0.1577666699886322,-0.13149496912956238,-0.22815604507923126,-0.09711801260709763,0.15076567232608795,0.10014299303293228,0.26165202260017395,-0.2273387312889099,0.2051679641008377},{0.1508776843547821,0.09562068432569504,0.2619488835334778,-0.18399497866630554,0.22652681171894073,-0.2260434627532959,-0.24231892824172974,0.058561135083436966,0.2701106667518616,0.10309313237667084,-0.09756305068731308,0.10155857354402542,0.06040455400943756,0.3610970079898834,0.1132359504699707,-0.11525367945432663,-0.18438155949115753,0.14325271546840668,0.009305259212851524,0.005608963314443827,-0.04282868653535843,0.18934686481952667,0.15713366866111755,0.14512348175048828,-0.18571829795837402,-0.23627878725528717,-0.24744141101837158,-0.36587831377983093,0.0654950961470604,-0.11489830166101456,0.23802730441093445,0.1614869087934494},{0.27869802713394165,-0.2928600311279297,0.11634889245033264,-0.3665216565132141,-0.3475779891014099,0.2465675324201584,0.36918890476226807,0.1322818547487259,-0.09825513511896133,-0.00632488215342164,0.2302348017692566,-0.12843801081180573,0.144602432847023,0.33678337931632996,-0.030446872115135193,0.18133248388767242,0.3616442382335663,-0.18248344957828522,-0.034625984728336334,-0.287198930978775,0.1510184109210968,0.20699210464954376,0.23542915284633636,0.1124570295214653,0.11424430459737778,0.11059626191854477,0.11812391877174377,0.25877121090888977,-0.20463970303535461,-0.24836395680904388,0.24522945284843445,-0.06176100671291351},{0.03736663982272148,-0.08602797240018845,0.26388096809387207,0.22106067836284637,-0.1690344512462616,-0.28300362825393677,-0.06302528828382492,0.2740330696105957,-0.1821509301662445,-0.24289007484912872,0.06542976945638657,0.09854171425104141,0.12825819849967957,-0.2727082073688507,0.12431377917528152,-0.17992344498634338,-0.1564796417951584,0.17826582491397858,-0.2356363832950592,0.3333648145198822,-0.3069603443145752,-0.29611724615097046,-0.2765292227268219,0.2974911034107208,0.11326993256807327,0.1048751100897789,0.24223434925079346,0.17413321137428284,-0.16277828812599182,-0.27428674697875977,-0.1517358273267746,0.16794924437999725},{0.28642719984054565,-0.01899837702512741,-0.05694146081805229,0.16108477115631104,-0.015185307711362839,0.21214568614959717,-0.04820534959435463,0.23546317219734192,0.0005944297881796956,0.06956207007169724,0.17179594933986664,0.06716258078813553,-0.1310858428478241,-0.34880131483078003,0.10303391516208649,0.13211947679519653,0.09001881629228592,-0.12634149193763733,-0.0924476608633995,-0.03858211264014244,0.11155562102794647,-0.28066903352737427,0.22656427323818207,0.07427972555160522,-0.010079867206513882,0.1295420229434967,-0.27072256803512573,-0.24546709656715393,-0.05207083001732826,-0.022384652867913246,0.13364335894584656,0.1827227920293808},{-0.1278347671031952,0.09673285484313965,-0.09424077719449997,0.15235057473182678,-0.1105191707611084,0.27223896980285645,0.12776321172714233,-0.005531385540962219,0.27324941754341125,-0.310494065284729,-0.14694571495056152,0.15153323113918304,-0.16950763761997223,0.047866132110357285,-0.3036860227584839,-0.03596419095993042,0.11046997457742691,0.17222698032855988,0.08292865008115768,-0.1358991116285324,-0.21598590910434723,0.19872748851776123,0.18852290511131287,0.1824837327003479,-0.24453969299793243,0.3547646105289459,-0.09986581653356552,-0.02469392493367195,-0.10152249038219452,0.13817855715751648,0.21624918282032013,0.2748158276081085},{-0.17875508964061737,0.30581018328666687,-0.06554830074310303,0.015484538860619068,-0.17699766159057617,-0.1506609469652176,0.1327933371067047,-0.3112723231315613,-0.039974089711904526,-0.24314671754837036,-0.21415534615516663,-0.03514319658279419,0.1727384775876999,-0.27373552322387695,-0.11541225761175156,-0.2707553505897522,-0.19952762126922607,-0.0704733282327652,0.3051322400569916,-0.3004550635814667,0.08066581934690475,-0.1863008737564087,0.07898467034101486,0.3029303550720215,-0.18296058475971222,0.18394170701503754,0.21417827904224396,-0.07269801199436188,-0.019146518781781197,0.30773675441741943,-0.13296911120414734,-0.24847497045993805},{-0.047105517238378525,0.1636981964111328,0.2293902486562729,-0.28106677532196045,0.26663103699684143,0.018018798902630806,-0.11830098181962967,-0.02165590412914753,0.14923474192619324,-0.2961519956588745,-0.07851347327232361,0.0143979387357831,0.16210778057575226,0.05582265183329582,0.033416882157325745,-0.10481300950050354,0.24509942531585693,-0.23600372672080994,0.32773715257644653,0.08504891395568848,-0.16238941252231598,0.23628471791744232,-0.12899938225746155,-0.19251136481761932,0.277851939201355,-0.13047485053539276,0.025011230260133743,-0.1683792769908905,0.04378082603216171,-0.1337096244096756,0.2545440196990967,0.22491082549095154},{0.06564007699489594,-0.14814835786819458,-0.1675134003162384,0.06168197840452194,0.031161362305283546,0.2936248481273651,-0.09948597848415375,-0.25289207696914673,0.2720069885253906,0.030301867052912712,0.04800690338015556,0.08225397020578384,-0.16759918630123138,0.0780254602432251,-0.19913923740386963,-0.276674747467041,0.013174670748412609,-0.04984172433614731,0.20708008110523224,0.3787802755832672,-0.20622487366199493,0.08486413955688477,-0.12592662870883942,-0.006938980892300606,0.1219213679432869,-0.2982659637928009,-0.16494514048099518,-0.21246512234210968,-0.0411006361246109,-0.17532433569431305,0.17879681289196014,-0.30283090472221375},{-0.08166732639074326,0.28457510471343994,0.1565568596124649,-0.21403813362121582,-0.08049242198467255,-0.166342630982399,0.18422558903694153,-0.02282027155160904,0.21590538322925568,-0.01244957372546196,0.17609761655330658,0.1456078290939331,-0.04407560080289841,0.040268875658512115,-0.12587349116802216,0.16203947365283966,-0.1668248474597931,-0.3509727716445923,-0.2377612441778183,0.1145595908164978,0.13633190095424652,-0.20093658566474915,-0.30930304527282715,-0.22639602422714233,-0.14747381210327148,0.050675854086875916,0.3303477168083191,-0.009166796691715717,-0.06737495958805084,0.13093672692775726,-0.1439843773841858,0.10493210703134537},{-0.20204544067382812,-0.1845041662454605,-0.20647762715816498,0.001061976538039744,-0.21060174703598022,-0.09519350528717041,-0.027851218357682228,-0.012650907970964909,-0.2988876402378082,-0.21524280309677124,0.17671941220760345,0.12930940091609955,-0.30749914050102234,0.22862154245376587,-0.065095454454422,0.15997453033924103,0.10107362270355225,0.03381168097257614,0.037569355219602585,0.14280176162719727,0.2273510992527008,0.26624795794487,0.13824859261512756,0.2669331431388855,0.11211874336004257,-0.22488723695278168,-0.1881757378578186,0.24785825610160828,-0.0012696327175945044,-0.174131840467453,-0.15986505150794983,-0.0990128219127655},{-0.28963741660118103,-0.2132020741701126,-0.3331899344921112,0.04641927406191826,-0.11190182715654373,-0.054438523948192596,-0.07962120324373245,0.13821259140968323,-0.08856641501188278,0.07784256339073181,-0.1836877018213272,-0.001661717426031828,0.13969862461090088,-0.10910481959581375,0.03605160117149353,0.1847044974565506,-0.09337843954563141,-0.11073556542396545,0.1705467849969864,0.03304610401391983,0.22005337476730347,-0.04973616823554039,-0.21872761845588684,0.07066154479980469,0.180530846118927,-0.2523415982723236,0.17456366121768951,0.04724423214793205,0.07573064416646957,-0.14227421581745148,0.21035102009773254,-0.06266794353723526},{0.26731041073799133,0.023117724806070328,0.041669368743896484,0.20204652845859528,-0.3352794945240021,-0.03440762683749199,0.05933938920497894,0.15794527530670166,-0.07476522028446198,-0.13337282836437225,0.2885071039199829,-0.08979614824056625,0.08246612548828125,-0.05736937001347542,-0.1009233295917511,0.2904794216156006,-0.082862988114357,-0.1368771344423294,0.1095813438296318,-0.28685978055000305,-0.057938870042562485,-0.2555563449859619,-0.17449034750461578,0.2321334332227707,-0.08741430193185806,-0.0399111807346344,0.1248006746172905,0.06580276042222977,-0.14241519570350647,-0.0718950480222702,-0.025584328919649124,-0.08404414355754852},{0.29342740774154663,-0.07271493226289749,0.05125655233860016,0.05653061345219612,-0.03806386515498161,-0.07910031825304031,0.19261816143989563,-0.23134854435920715,0.25796574354171753,0.28496143221855164,0.043860629200935364,0.13919460773468018,0.2089647501707077,0.31895241141319275,-0.297452837228775,-0.3589949905872345,-0.22982905805110931,0.07445107400417328,-0.17947302758693695,-0.3571802079677582,-0.14899885654449463,0.2293894737958908,0.057263705879449844,0.14944203197956085,-0.14585334062576294,-0.11689484119415283,-0.11765770614147186,-0.24101214110851288,0.23868566751480103,0.18381643295288086,-0.3290252089500427,-0.11820893734693527},{-0.10664117336273193,0.16891023516654968,0.27861934900283813,-0.02193119004368782,-0.024791497737169266,0.08777858316898346,-0.023656615987420082,-0.3312428593635559,0.16962993144989014,0.2436160147190094,0.17513877153396606,0.22488132119178772,-0.2580659091472626,0.17218349874019623,-0.246829554438591,0.30834150314331055,0.15468865633010864,-0.2628788352012634,0.2566537857055664,0.05880643427371979,-0.33752354979515076,0.28427377343177795,-0.22978921234607697,0.14978986978530884,0.1733022928237915,0.2637982964515686,0.052308764308691025,0.13797743618488312,-0.16111540794372559,0.24197320640087128,-0.05001768097281456,0.10244225710630417},{-0.12767674028873444,-0.10636373609304428,0.03015696071088314,0.18349598348140717,0.023080911487340927,0.23758134245872498,-0.2516792118549347,-0.11264393478631973,-0.17797455191612244,-0.0815454050898552,-0.11364863067865372,-0.19723157584667206,-0.013941865414381027,-0.21200118958950043,0.10259852558374405,-0.20651668310165405,0.24238625168800354,-0.017265208065509796,-0.2775247097015381,-0.30444034934043884,0.1402372121810913,0.13398943841457367,-0.14345745742321014,0.3371889889240265,-0.2551406919956207,0.03589446097612381,0.09054530411958694,-0.10604524612426758,0.15499098598957062,-0.19286394119262695,0.28113412857055664,0.12167803943157196},{0.30169016122817993,0.0554586797952652,0.04757944121956825,0.23127643764019012,-0.24575702846050262,0.15079458057880402,-0.09845292568206787,0.13698577880859375,0.11582252383232117,0.006608771160244942,0.10597831755876541,-0.29939377307891846,-0.26135534048080444,0.06249089539051056,0.07259295880794525,-0.07931239157915115,0.2675764858722687,0.13553981482982635,-0.19316650927066803,-0.21400032937526703,0.3397875428199768,0.19206030666828156,0.2304907590150833,0.07550600916147232,-0.0011923840502277017,0.06518439948558807,-0.04899265989661217,-0.16532018780708313,0.23379860818386078,0.0032837195321917534,-0.17408722639083862,0.1099575012922287},{-0.017059585079550743,0.03215114399790764,-0.026036808267235756,-0.2552601099014282,-0.09665722399950027,-0.2347693294286728,-0.20866598188877106,-0.142429918050766,-0.03753111883997917,-0.024602172896265984,-0.23130212724208832,0.029739627614617348,-0.23667491972446442,-0.15928295254707336,0.009947612881660461,0.09627451747655869,0.259646475315094,-0.1775132566690445,-0.32530477643013,0.24745085835456848,-0.17025238275527954,0.24302837252616882,0.040677882730960846,-0.03961912915110588,-0.024119753390550613,0.1728505939245224,-0.07538354396820068,-0.25772643089294434,0.22312119603157043,0.24943827092647552,-0.12979774177074432,0.1768147051334381},{-0.24120773375034332,-0.021449856460094452,0.03772270679473877,-0.02153168059885502,0.09077808260917664,0.11421307176351547,-0.20178557932376862,0.09093786031007767,-0.1468321979045868,-0.14621601998806,0.0738455206155777,-0.1320435106754303,-0.17352965474128723,0.2715640962123871,0.015693893656134605,0.03777926787734032,0.1922636181116104,-0.259739488363266,-0.16689078509807587,0.33019688725471497,0.02334502898156643,0.2790982127189636,-0.07125571370124817,0.011642783880233765,-0.1874188929796219,-0.17660343647003174,0.00010577480861684307,0.2954813539981842,-0.014911523088812828,-0.0016567179700359702,0.2987534999847412,0.29331886768341064}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.1355140507221222,0.1262245923280716,0.24297843873500824,0.0007623234414495528},{0.06237984076142311,-0.038385599851608276,0.04447409138083458,0.12501098215579987},{-0.1300414651632309,0.16953681409358978,0.08061911165714264,0.13635005056858063},{0.3088575005531311,0.03843652456998825,0.059410590678453445,0.3669947683811188},{-0.09042058140039444,0.052741311490535736,0.22732344269752502,-0.0017774951411411166},{-0.1259901374578476,0.18719467520713806,0.16932088136672974,-0.05371192842721939},{-0.1957835555076599,0.009866751730442047,0.0023218158166855574,-0.10822413861751556},{-0.3182854950428009,-0.10379767417907715,0.2954348921775818,-0.26597917079925537},{0.2757818400859833,-0.17607064545154572,-0.24392542243003845,-0.32435259222984314},{0.044428952038288116,0.22663278877735138,0.287191241979599,-0.3521667420864105},{-0.10804077237844467,-0.12930670380592346,-0.1699475795030594,0.17558401823043823},{0.22430668771266937,-0.15561524033546448,0.03715088218450546,0.13981567323207855},{0.26167571544647217,0.2754802405834198,-0.06975237280130386,0.08029861003160477},{-0.007189995143562555,0.04270607978105545,-0.25520065426826477,0.02149057388305664},{0.12046569585800171,0.2707493007183075,0.2574619650840759,0.2931790351867676},{0.13423749804496765,0.06247086822986603,0.22064024209976196,0.2171185463666916},{-0.1705632209777832,-0.09556332230567932,-0.14112940430641174,-0.14450114965438843},{-0.1499483585357666,0.09794776141643524,-0.10610301047563553,-0.12207484245300293},{-0.15427646040916443,0.14973732829093933,0.15191558003425598,0.2415449470281601},{-0.020043745636940002,0.3164219558238983,-0.15023966133594513,0.055818069726228714},{-0.2085365355014801,-0.299111545085907,-0.1306728571653366,-0.0185281690210104},{0.23937459290027618,0.33646541833877563,0.025497954338788986,-0.19603708386421204},{0.0008524073055014014,0.14199264347553253,0.13402920961380005,0.1193050742149353},{-0.07650773227214813,0.3347930908203125,-0.049546774476766586,-0.104451484978199},{0.004080545622855425,-0.005320176016539335,-0.01766732521355152,-0.01860833540558815},{0.24273216724395752,-0.32164323329925537,-0.04866355285048485,0.04788583144545555},{-0.0018988930387422442,-0.2701632082462311,-0.15881425142288208,-0.22795920073986053},{0.08163955062627792,-0.05690828710794449,0.18504568934440613,0.08034268021583557},{-0.0007275835378095508,-0.035259097814559937,0.03956010565161705,0.015306230634450912},{-0.29378509521484375,0.31814655661582947,0.21165169775485992,-0.08712847530841827},{0.2800450026988983,-0.14254172146320343,0.15138360857963562,-0.0011902168625965714},{0.050265733152627945,-0.29284700751304626,0.29504185914993286,-0.23258838057518005}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.02753138169646263,0.006799330469220877,0.034909769892692566,-0.054009102284908295,-0.019656706601381302,-0.1570916473865509,0.03961026296019554,0.0447838120162487,0.012473706156015396,-0.1114259660243988,0.14956633746623993,0.08090037852525711,0.000316884572384879,-0.008916334249079227,0.0697573572397232,0.017084045335650444};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.05974297970533371,0.032212719321250916,0.030938059091567993,0.02831728756427765,0.04418257623910904,0.007855831645429134,0.04128173738718033,0.007527907378971577,0.0038416029419749975,0.005689288955181837,-0.044911324977874756,-0.010470619425177574,0.019720839336514473,-0.031162818893790245,-0.049607157707214355,0.013936220668256283};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06604598462581635,0.05395394191145897,0.017465775832533836,0.07166624069213867,0.03571619838476181,-0.021825438365340233,-0.03983638435602188,-0.012065612711012363,-0.023805798962712288,-0.010980791412293911,-0.04574541002511978,0.0518304742872715,0.06950635462999344,-0.0650252178311348,0.06809555739164352,0.06470558047294617,-0.05760045349597931,-0.05777033418416977,-0.003208235604688525,0.011312923394143581,-0.039112720638513565,0.009084402583539486,0.06026685610413551,0.025727910920977592,-0.007203107699751854,-0.0003669362049549818,-0.03599903732538223,0.051758963614702225,0.018873201683163643,-0.0042910887859761715,0.021916434168815613,0.02488880790770054};
static const float action_parameterization_distribution_linear_bias[4] = {0.052109669893980026,0.010251561179757118,0.04650558531284332,0.04132857918739319};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.005824852269142866,0.27408650517463684,-0.08056050539016724,0.15155157446861267,0.21260380744934082,0.18348626792430878,0.24931205809116364,0.00949828326702118},{-0.1983097642660141,-0.0860840305685997,-0.20391049981117249,-0.2919449210166931,-0.30840206146240234,-0.1385464370250702,-0.21573631465435028,-0.1216997280716896},{-0.26633867621421814,0.02588777244091034,0.2548327147960663,0.21313893795013428,0.22130213677883148,-0.004290363751351833,0.15841075778007507,-0.06301824748516083},{-0.04806474596261978,0.07783441245555878,-0.18472787737846375,-0.0211036279797554,-0.020103715360164642,-0.07077667862176895,0.15724971890449524,-0.1181730180978775},{-0.30188360810279846,-0.11944293230772018,-0.24930818378925323,-0.16184568405151367,-0.06301698088645935,0.19795510172843933,0.13077300786972046,0.003932824824005365},{-0.3695473372936249,0.01910942979156971,0.3238782286643982,0.2566852271556854,0.16975001990795135,-0.04804474115371704,-0.1080285906791687,-0.10938549041748047},{-0.2038850486278534,0.07972342520952225,0.30171605944633484,-0.16954058408737183,-0.12092103809118271,-0.33206355571746826,-0.06105973944067955,-0.13413137197494507},{-0.477134644985199,-0.3321252763271332,0.4999632239341736,-0.017597734928131104,-0.26594212651252747,0.16971273720264435,0.2057695835828781,-0.18734078109264374},{-0.2690523862838745,0.2811303436756134,-0.1131465807557106,0.43583443760871887,0.04185441508889198,-0.42274150252342224,0.11548203974962234,0.15392443537712097},{-0.24230407178401947,-0.31161388754844666,-0.1310160607099533,-0.1636277139186859,-0.4710753560066223,0.02870103344321251,0.01359855942428112,0.17127764225006104},{0.18597114086151123,0.339944064617157,0.24731050431728363,-0.01044927816838026,0.2541450262069702,0.017869381234049797,-0.20434090495109558,0.25958871841430664},{0.22168487310409546,-0.007459237705916166,0.28823450207710266,0.27231401205062866,-0.17490661144256592,0.23827028274536133,-0.004422810859978199,-0.2071322500705719},{0.12490563839673996,-0.26521483063697815,0.24074849486351013,0.007392830681055784,-0.13535790145397186,-0.05708228424191475,-0.14935672283172607,-0.18402794003486633},{-0.21736973524093628,-0.07213470339775085,0.30796539783477783,0.39151838421821594,0.01686621643602848,-0.032220952212810516,-0.2149328887462616,0.06100612133741379},{-0.05741441622376442,-0.13391681015491486,0.11005629599094391,-0.20266366004943848,-0.27737534046173096,-0.15721483528614044,0.17520277202129364,-0.06272388994693756},{-0.028817113488912582,-0.012473315931856632,-0.01346569787710905,-0.3359747529029846,-0.05951447784900665,0.04412403702735901,-0.06622985750436783,0.3540385365486145},{0.012562691234052181,-0.1914750635623932,-0.16450455784797668,0.038812100887298584,-0.19381825625896454,-0.12684354186058044,-0.11433298885822296,0.027821358293294907},{-0.15482564270496368,-0.19517065584659576,0.09538321197032928,-0.03271549195051193,0.10720092803239822,-0.19400553405284882,0.3901655972003937,0.09324006736278534},{0.06845185160636902,0.16321192681789398,-0.2642417550086975,0.09369926154613495,0.08541250228881836,0.11595434695482254,-0.19164671003818512,0.26637205481529236},{0.16839033365249634,-0.0692865177989006,-0.36485418677330017,0.06176566705107689,-0.15366221964359283,-0.1290491223335266,-0.2568616569042206,-0.018877651542425156},{0.003904899349436164,-0.20522922277450562,-0.0009153528371825814,-0.12697936594486237,0.1563316136598587,-0.10779791325330734,-0.06949257105588913,0.42701292037963867},{-0.04237961769104004,0.06528794765472412,-0.3330972492694855,0.23886191844940186,0.20620742440223694,0.2219645380973816,0.05497997999191284,-0.27982744574546814},{-0.4181467890739441,-0.12940648198127747,0.07548242807388306,-0.06720409542322159,0.1614498496055603,-0.3762213885784149,0.13420403003692627,-0.25735151767730713},{-0.0729791522026062,0.09595456719398499,-0.13575199246406555,-0.4382290244102478,0.23675306141376495,0.033108342438936234,-0.35267743468284607,0.12559854984283447},{-0.10692086815834045,-0.20006218552589417,-0.14672411978244781,0.09868088364601135,0.15316475927829742,0.2893151640892029,0.2650226354598999,-0.07733064144849777},{-0.11713788658380508,0.033769428730010986,-0.3477846384048462,-0.24027419090270996,0.13995422422885895,-0.022659676149487495,-0.06874603033065796,0.051296453922986984},{0.30421072244644165,0.3247207701206207,-0.23378312587738037,0.26016947627067566,0.09576617926359177,0.27149608731269836,-0.31330424547195435,-0.1762811690568924},{0.4097553491592407,0.2404967099428177,0.10990811139345169,0.08944243937730789,0.22769951820373535,0.05365188047289848,0.21727313101291656,0.35019272565841675},{-0.11686268448829651,0.29739683866500854,0.137806698679924,0.041571930050849915,0.2739278972148895,-0.015132678672671318,-0.424695760011673,-0.27091309428215027},{-0.16346552968025208,-0.2777375876903534,-0.051113732159137726,-0.17429853975772858,-0.2268049269914627,-0.15466947853565216,0.1901485025882721,0.012703013606369495},{0.41068965196609497,-0.28602659702301025,0.22079743444919586,-0.23480376601219177,0.15685699880123138,0.28949597477912903,0.047782786190509796,-0.15489043295383453},{0.17375046014785767,0.4443104863166809,0.43198588490486145,-0.18221941590309143,-0.19012793898582458,0.18009710311889648,0.18765130639076233,0.03789474070072174}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.056592974811792374,0.3612183928489685,-0.14935417473316193,0.24388547241687775,-0.3583844006061554,0.21376505494117737,0.42408743500709534,0.03217132389545441},{-0.3847217559814453,-0.44771894812583923,-0.3118760287761688,-0.3623715937137604,-0.3965182602405548,0.37242335081100464,0.47115108370780945,-0.41662877798080444},{0.03502501919865608,-0.1272362470626831,0.0962597131729126,0.010635999962687492,-0.07692057639360428,0.38285914063453674,-0.29586729407310486,-0.26320981979370117},{0.3306353986263275,0.01695864461362362,0.06655117869377136,-0.007563374470919371,0.48716339468955994,0.3795374929904938,0.3687746226787567,0.36673539876937866},{0.09642203897237778,0.19590821862220764,-0.13682810962200165,-0.05572181195020676,0.11221151798963547,-0.3045986294746399,-0.3544243276119232,0.42982733249664307},{0.41174614429473877,0.09573294967412949,0.04978790134191513,-0.31322962045669556,-0.30416619777679443,-0.4669395387172699,-0.11686784774065018,0.44979894161224365},{-0.3013189435005188,-0.2696119546890259,-8.303411595989019e-05,-0.1848047822713852,0.07065515220165253,0.3324839472770691,-0.45868825912475586,0.5603926777839661},{0.09556497633457184,0.021303197368979454,0.01827993430197239,-0.09849227964878082,0.2878968119621277,-0.4494120180606842,0.3709104359149933,-0.4796098470687866}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.023919591680169106,0.015948491171002388,0.09900423884391785,-0.038189612329006195,-0.0474197082221508,-0.04437277093529701,0.12617138028144836,-0.039737552404403687};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03504054993391037,-0.016473399475216866,0.049329329282045364,-0.1049136221408844,0.02858656644821167,0.0013360809534788132,-0.019690172746777534,-0.0549260713160038};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

