#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3016231656074524,-0.08288529515266418,0.270680695772171,0.13572223484516144,-0.2904028594493866,0.2782074213027954,-0.047525953501462936,-0.14767484366893768,0.12604425847530365,0.32737627625465393,0.12521058320999146,0.03813973441720009,0.25527316331863403,-0.252638578414917,0.2860666811466217,-0.06669484078884125},{-0.1552017480134964,-0.3897433578968048,0.3243846297264099,0.11454229801893234,-0.23952750861644745,0.16999885439872742,-0.4173656404018402,-0.04454107955098152,-0.09916989505290985,-0.1801299750804901,0.04166190326213837,-0.22261349856853485,0.01823677495121956,-0.34899380803108215,-0.2636076509952545,0.10637006163597107},{-0.08351729065179825,-0.23554816842079163,-0.4303428828716278,0.1523507833480835,0.24461598694324493,0.5508299469947815,0.0498502254486084,-0.05032368004322052,0.07427608221769333,-0.4965786933898926,-0.3827138841152191,0.762536346912384,-0.20375335216522217,-0.30138224363327026,-0.36492452025413513,0.24797192215919495},{0.14920952916145325,0.2674897015094757,0.3894554674625397,-0.028207415714859962,-0.4178956151008606,-0.012806091457605362,0.2641098201274872,0.06195295602083206,0.3107270300388336,-0.36513182520866394,0.019833780825138092,0.3976461589336395,-0.2387465387582779,0.021302849054336548,0.4843785762786865,-0.4724040925502777},{-0.07686696946620941,-0.034471411257982254,0.32779037952423096,-0.03887946158647537,0.3275797665119171,0.4443013370037079,0.21234779059886932,-0.012759382836520672,0.13857828080654144,0.20992110669612885,0.276503324508667,-0.35415709018707275,-0.2457754760980606,-0.4396623373031616,0.41884279251098633,0.09073735773563385},{-0.21592293679714203,-0.2252396196126938,-0.17021411657333374,-0.09996190667152405,0.1913243532180786,0.18307511508464813,0.041351787745952606,-0.13268306851387024,0.3732760548591614,-0.29328542947769165,-0.4264847934246063,0.2198801189661026,0.15668131411075592,-0.14392946660518646,-0.042669977992773056,0.05977147817611694},{0.059293232858181,0.047715622931718826,0.043305858969688416,-0.45780104398727417,0.21445168554782867,-0.05750180780887604,0.06224633380770683,0.3963434100151062,0.34753236174583435,0.055927105247974396,-0.446787029504776,-0.025969248265028,-0.01086511742323637,0.1478055864572525,-0.18790383636951447,-0.23969264328479767},{-0.2758042812347412,0.3871377110481262,0.3609651029109955,0.3979420065879822,-0.48564329743385315,-0.07491040974855423,0.5231693387031555,0.5335301756858826,-0.21752677857875824,0.35916781425476074,-0.6832432150840759,-0.3906649351119995,0.41855230927467346,0.13134153187274933,0.2955280840396881,0.41384434700012207},{0.3545936346054077,-0.28608500957489014,0.6208064556121826,0.11094695329666138,0.015249459072947502,0.10523893684148788,0.17401330173015594,-0.616168737411499,-0.18900750577449799,-0.4507625699043274,-0.16611537337303162,0.0032304429914802313,-0.106887087225914,0.6665697693824768,0.44588372111320496,-0.30863603949546814},{0.23336106538772583,-0.5889102816581726,-0.6363375782966614,-0.3129434585571289,-0.24664732813835144,0.2428828477859497,0.18497151136398315,0.16257895529270172,0.6054567098617554,0.25865426659584045,0.1945318877696991,-0.2760384976863861,-0.10874311625957489,0.4180738031864166,-0.20103074610233307,-0.548091471195221},{0.19256915152072906,0.3379819393157959,0.3811677396297455,-0.6526793241500854,-0.32210206985473633,0.11707940697669983,0.12936854362487793,0.43923842906951904,-0.32832926511764526,0.045702651143074036,-0.11643286794424057,0.02390616200864315,-0.17409110069274902,-0.2129252701997757,0.2445138394832611,-0.3577457666397095},{-0.017625413835048676,-0.4014284908771515,0.1536419540643692,0.568402886390686,0.73874431848526,0.4520508944988251,0.352868914604187,0.3964318335056305,0.05204229801893234,0.0005090053309686482,0.2589508891105652,-0.42811229825019836,-0.5511842966079712,-0.4256555438041687,0.6904842853546143,-0.038641076534986496},{-0.29923680424690247,0.4428848922252655,-0.03501943498849869,-0.6157198548316956,0.15734440088272095,0.020278841257095337,0.19864584505558014,0.2027876228094101,0.06344188749790192,0.07503490895032883,0.02712532877922058,0.2025444060564041,0.43803873658180237,0.3556072413921356,-0.07538513094186783,-0.1033344641327858},{0.04856061562895775,-0.3824249505996704,-0.254618763923645,-0.15169000625610352,-0.4398268461227417,0.015211135149002075,-0.24166251718997955,-0.23028261959552765,-0.19899481534957886,-0.04752050340175629,-0.4299214482307434,-0.02509995549917221,-0.22236965596675873,0.4216364920139313,0.18977142870426178,-0.00895705260336399},{0.0563209131360054,-0.31361883878707886,-0.24196390807628632,0.1771204024553299,-0.09246476739645004,-0.46343815326690674,0.259549081325531,-0.07395707070827484,0.023774167522788048,0.36601462960243225,0.10965030640363693,0.04019493982195854,0.2987561821937561,-0.047430142760276794,-0.3398153781890869,0.22450046241283417},{0.3965016007423401,0.0060599870048463345,-0.22027461230754852,-0.20185330510139465,-0.33103084564208984,0.182290181517601,0.3261565566062927,-0.0735042467713356,0.19553141295909882,0.36416715383529663,-0.14716185629367828,0.07594294100999832,-0.19716648757457733,0.24969495832920074,-0.1046043112874031,-0.025487374514341354},{-0.21483053267002106,-0.20021778345108032,0.23850853741168976,0.1321796327829361,-0.21697646379470825,0.09132809191942215,-0.20177645981311798,-0.11224038898944855,-0.22210590541362762,-0.26119717955589294,-0.0634680986404419,-0.2581278681755066,0.114605613052845,-0.1997145414352417,0.04417213797569275,-0.20436212420463562},{-0.2588365077972412,0.22032056748867035,-0.3461016118526459,-0.24110838770866394,0.04038742929697037,0.3137115240097046,-0.24599212408065796,-0.20752431452274323,0.17114411294460297,0.1856759935617447,0.3297816514968872,-0.12736785411834717,-0.32608091831207275,0.3168209493160248,0.03500254452228546,-0.4197990894317627}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05685283988714218,-0.034021709114313126,-0.09723207354545593,-0.3479571044445038,0.3192734122276306,0.2974628508090973,0.083983413875103,0.04965246841311455,-0.11467764526605606,-0.15079016983509064,-0.02774980664253235,0.07097747921943665,0.19806236028671265,0.36566615104675293,0.08404019474983215,0.07545506209135056},{-0.17214861512184143,-0.30743569135665894,-0.05720701813697815,0.0646381825208664,0.22364215552806854,-0.3084372282028198,0.04060089960694313,0.04210630804300308,-0.05942381173372269,0.2566279470920563,-0.24796807765960693,0.3260228931903839,-0.3851182162761688,0.19932067394256592,-0.3657746911048889,-0.36188942193984985},{0.057986125349998474,0.21628716588020325,-0.36657121777534485,-0.5236179828643799,0.19084076583385468,0.4655001759529114,-0.08497501164674759,0.07349450886249542,-0.2702729403972626,-0.29788410663604736,-0.00904612522572279,0.3243369460105896,-0.29391735792160034,-0.18354935944080353,0.09674020111560822,-0.07225078344345093},{0.17397043108940125,-0.057084545493125916,0.08562593162059784,0.20229974389076233,-0.4913674592971802,-0.002636883407831192,0.09622500091791153,-0.183847114443779,0.294039249420166,0.36681169271469116,-0.17003120481967926,-0.13442137837409973,-0.42572036385536194,-0.4074687361717224,0.18030349910259247,0.1736193299293518},{-0.10638312995433807,0.14091140031814575,0.0007761968881823123,0.24940931797027588,-0.23518326878547668,0.06712720543146133,-0.007784170564264059,0.1595662236213684,0.26124176383018494,-0.2563733160495758,0.18447893857955933,0.2762066423892975,0.18343664705753326,-0.4515345096588135,0.02754255197942257,-0.01815093122422695},{0.2370864301919937,0.26579412817955017,-0.040493838489055634,0.1718052327632904,-0.4858115017414093,-0.41264864802360535,0.2602006494998932,0.2907257676124573,0.11396250873804092,0.36238813400268555,0.2414676547050476,-0.21749258041381836,-0.013227829709649086,-0.14818623661994934,-0.06914634257555008,0.31022074818611145},{-0.10469789057970047,0.26565301418304443,0.2917971909046173,-0.37282055616378784,-0.25357019901275635,0.008106783963739872,-0.3486488163471222,-0.04724058136343956,0.16877411305904388,0.08490017056465149,-0.14529605209827423,-0.2163524180650711,-0.3257511854171753,-0.019423047080636024,0.18885871767997742,0.02994743548333645},{-0.16842235624790192,-0.14895792305469513,-0.4789677858352661,0.3098188042640686,-0.33247601985931396,-0.2548856735229492,-0.24037553369998932,-0.39643362164497375,0.14364710450172424,-0.25090429186820984,0.0480448342859745,0.08267567306756973,-0.16217893362045288,0.4366375207901001,-0.08050926774740219,-0.340725302696228},{-0.32943958044052124,0.2656880021095276,-0.002353010466322303,-0.03161315619945526,0.2743884325027466,-0.2766764163970947,0.3049697279930115,0.14447911083698273,0.3368752896785736,0.290764182806015,0.25832098722457886,0.3109767436981201,0.1853029578924179,-0.04265591502189636,0.2717989385128021,0.1013672724366188},{0.061516277492046356,-0.2738141417503357,-0.17662477493286133,-0.11879994720220566,0.26832425594329834,-0.17203617095947266,-0.3050578534603119,-0.16747291386127472,0.0757543072104454,-0.37692511081695557,-0.28277483582496643,0.3542157709598541,0.12189777195453644,0.15702742338180542,-0.38837766647338867,0.23459431529045105},{-0.06562605500221252,-0.455587774515152,0.3280220627784729,0.2931109368801117,0.24309004843235016,0.15504959225654602,0.18436174094676971,-0.14128565788269043,0.2305048704147339,-0.2867259085178375,0.19631686806678772,0.3598761558532715,0.5058152675628662,0.10211619734764099,-0.11238298565149307,0.08957179635763168},{0.05594024062156677,-0.005589393433183432,0.3940093517303467,-0.00693874154239893,-0.25117334723472595,-0.18512289226055145,0.4264257848262787,0.2968360483646393,-0.255670964717865,-0.20404154062271118,-0.09189870208501816,-0.3368804454803467,-0.03212180361151695,-0.2869734466075897,-0.38955047726631165,0.04155971482396126},{-0.10459082573652267,-0.31421902775764465,0.4079519510269165,-0.23254498839378357,0.3613249957561493,-0.3025672435760498,-0.46892356872558594,0.08007153123617172,0.07976650446653366,0.0683625191450119,-0.34228992462158203,0.1375642567873001,0.08595921099185944,-0.29973313212394714,-0.35739830136299133,-0.02018681913614273},{0.3711837828159332,-0.3392951786518097,0.46646037697792053,0.08822106570005417,-0.09463118761777878,0.3292146325111389,-0.1067810207605362,-0.23920702934265137,-0.4197515547275543,0.12021030485630035,0.011569742113351822,-0.36056482791900635,-0.11265605688095093,0.12958979606628418,0.30814483761787415,0.04229693487286568},{-0.0835985317826271,0.2420080304145813,0.1162676140666008,-0.46107611060142517,-0.2301526516675949,0.19720061123371124,0.28550654649734497,-0.2520654499530792,0.21597836911678314,-0.31817594170570374,0.037599556148052216,0.10677870362997055,-0.06634826213121414,0.18293525278568268,0.03785235807299614,0.08001811057329178},{-0.1731201410293579,0.42009884119033813,-0.4362519681453705,0.3825394809246063,0.09700597077608109,-0.4051664173603058,-0.016632577404379845,-0.0754115879535675,-0.3063935935497284,0.4017900824546814,-0.3272067606449127,0.3031981885433197,-0.07818767428398132,-0.3510577380657196,-0.2289513647556305,-0.4844902753829956}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.17084111273288727,0.12243834137916565,-0.02909325622022152,-0.05186650902032852,-0.12052824348211288,0.03812021389603615,0.27944353222846985,0.10383713245391846,-0.2009737640619278,-0.15957984328269958,0.1552245169878006,-0.29435211420059204,-0.23353907465934753,0.2344830483198166,0.22176064550876617,0.329118549823761,-0.2671952545642853,-0.2848241925239563,-0.20036575198173523,0.12431210279464722,-0.0724482461810112,-0.30584943294525146,-0.2223505675792694,-0.29241234064102173,-0.25940513610839844,0.17116835713386536,-0.19708801805973053,-0.018436802551150322,-0.033279936760663986,-0.031139502301812172,0.23015658557415009,-0.22322440147399902},{0.29250356554985046,0.1594257801771164,0.16580422222614288,-0.1242266446352005,0.15340396761894226,-0.1371244639158249,0.40417730808258057,0.1402875930070877,-0.14500977098941803,-0.07930871099233627,-0.12279128283262253,-0.28823021054267883,-0.17220069468021393,0.25401145219802856,-0.26186060905456543,-0.19525906443595886,-0.04127134755253792,0.21498173475265503,-0.38345471024513245,-0.21088525652885437,-0.03713323920965195,0.23745672404766083,0.03989861160516739,0.03447896987199783,0.22414356470108032,-0.3618413209915161,-0.057154007256031036,0.07392999529838562,0.17230728268623352,-0.13720816373825073,-0.060042329132556915,0.18489448726177216},{0.14535696804523468,0.03515339270234108,-0.16625575721263885,0.14860117435455322,-0.16987986862659454,-0.16987401247024536,-0.20755742490291595,0.03469592332839966,-0.1537698358297348,0.38495853543281555,-0.3112151026725769,-0.3016263246536255,0.12975747883319855,-0.38358405232429504,-0.16421586275100708,0.09507149457931519,-0.11323720961809158,-0.1377188265323639,0.1556544005870819,-0.12807007133960724,0.23545366525650024,0.2890787422657013,-0.2489594966173172,0.01732674613595009,-0.2772010266780853,0.004183792509138584,0.12512734532356262,-0.08479908853769302,-0.02801191806793213,-0.25689825415611267,-0.13897113502025604,-0.08177872747182846},{0.4378809332847595,0.04844487085938454,0.1685425192117691,-0.16521786153316498,-0.2834540605545044,-0.04876834526658058,-0.1755332052707672,0.3125799596309662,0.2450096607208252,-0.3169536590576172,-0.07405058294534683,0.32709258794784546,0.10135474056005478,-0.06915587186813354,-0.22968535125255585,0.2957976162433624,-0.3007137179374695,0.2479618489742279,0.06467030197381973,0.13208888471126556,-0.07584881782531738,-0.13190317153930664,0.29707735776901245,0.16052356362342834,0.2040436863899231,-0.4046875238418579,0.2833355665206909,-0.219102144241333,-0.07255534827709198,0.12331721186637878,-0.19154997169971466,0.14776931703090668},{-0.07268742471933365,-0.08617295324802399,-0.11816024780273438,0.14924052357673645,0.21022003889083862,-0.17057082056999207,-0.4252365231513977,-0.10044059157371521,-0.0996093899011612,-0.2889449894428253,0.11929942667484283,0.23982851207256317,-0.0263897143304348,-0.12288504093885422,-0.09574467688798904,0.11291509866714478,-0.04278925806283951,-0.06839052587747574,-0.3239290714263916,-0.1992529034614563,-0.14426282048225403,-0.3847915828227997,0.14666970074176788,0.14786237478256226,-0.12155582010746002,0.37408801913261414,-0.1851070374250412,0.18261417746543884,0.3452003300189972,0.37942537665367126,-0.06281855702400208,0.4022430181503296},{-0.3162754476070404,0.02291741408407688,-0.2483740746974945,-0.06346969306468964,-0.21211636066436768,0.2507255971431732,0.21372339129447937,0.0259870458394289,0.24633175134658813,0.25595569610595703,0.3440989851951599,-0.24246472120285034,-0.27401062846183777,0.18685774505138397,0.34662729501724243,-0.31980639696121216,-0.13923434913158417,-0.25795692205429077,0.21363963186740875,0.10287158936262131,0.09868127107620239,0.1909756362438202,0.08845008909702301,-0.08069802075624466,-0.37444791197776794,0.3847725987434387,-0.14095087349414825,0.21745099127292633,0.36359190940856934,0.17262588441371918,0.0528799332678318,0.016939202323555946},{0.2135525643825531,-0.13831914961338043,-0.13505882024765015,-0.34699228405952454,-0.052502620965242386,0.22714467346668243,0.32415592670440674,0.19041477143764496,0.07270186394453049,0.37693217396736145,-0.008672193624079227,-0.02920159511268139,-0.44619113206863403,-0.16916368901729584,-0.156439870595932,0.16857832670211792,-0.2976701557636261,-0.22542528808116913,0.20064446330070496,-0.07198397815227509,-0.13303162157535553,-0.14307111501693726,-0.2228890359401703,-0.20707593858242035,0.15889674425125122,-0.25990739464759827,-0.07981599867343903,-0.2143455296754837,0.2973181903362274,0.09481427818536758,-0.17341235280036926,-0.31248247623443604},{0.006374950986355543,0.15409788489341736,0.05490424856543541,-0.016841525211930275,0.13015815615653992,-0.3369280993938446,-0.1184319257736206,-0.19122624397277832,-0.0154758645221591,-0.22576428949832916,-0.319654256105423,-0.06252084672451019,-0.11245772987604141,-0.007664873730391264,-0.13019876182079315,0.3619033694267273,-0.02645564265549183,-0.1767156720161438,0.09749208390712738,0.3293105363845825,-0.1078595519065857,-0.24335861206054688,0.25955286622047424,0.09478606283664703,-0.04969305545091629,-0.3130335807800293,-0.31280216574668884,-0.31766319274902344,-0.3366963863372803,-0.26550766825675964,0.026014959439635277,-0.3026149570941925},{0.10372591018676758,0.34209874272346497,-0.2675309479236603,-0.3279761075973511,-0.23617790639400482,0.0842612162232399,0.04803043231368065,0.0826048031449318,0.12133008241653442,-0.28852909803390503,-0.1791953146457672,0.3419027626514435,-0.25464969873428345,-0.19159069657325745,0.20395635068416595,-0.2868478000164032,0.26557818055152893,0.1588958203792572,0.3638232350349426,0.025227883830666542,0.20610181987285614,0.07463988661766052,0.2779909670352936,-0.10688462853431702,0.37978699803352356,-0.23485636711120605,0.13904321193695068,0.3347489535808563,-0.2832113206386566,0.22658056020736694,0.00780192855745554,0.15883654356002808},{-0.18591316044330597,0.12701953947544098,-0.2582673132419586,-0.17544499039649963,0.1747014820575714,-0.15261973440647125,0.11566279083490372,0.0117046432569623,0.13266870379447937,-0.03083990514278412,-0.2685227394104004,-0.3127521574497223,-0.3503442108631134,-0.05638982728123665,-0.24904879927635193,0.11230229586362839,0.06117463856935501,-0.20018528401851654,0.2500806152820587,0.12044176459312439,-0.0032983804121613503,0.0005332615692168474,0.29735973477363586,-0.19790427386760712,0.3178531229496002,0.09515205025672913,-0.25292345881462097,0.024106791242957115,-0.0331733375787735,0.10414718836545944,-0.11894740909337997,0.07506629079580307},{0.10632489621639252,0.04756748676300049,0.192480206489563,-0.28717368841171265,-0.3552009165287018,-0.24476096034049988,-0.286618173122406,0.025476597249507904,-0.25016534328460693,0.4655857980251312,0.17224347591400146,-0.22169940173625946,-0.39910754561424255,-0.08968464285135269,-0.18465375900268555,-0.0947442576289177,0.17803804576396942,-0.17950473725795746,0.2879272401332855,-0.14021772146224976,-0.15631768107414246,-0.00587671110406518,0.2102830410003662,0.22288095951080322,0.17451727390289307,-0.15132583677768707,0.025381097570061684,-0.09481658786535263,-0.0493493378162384,0.024752052500844002,-0.04006994888186455,0.13638822734355927},{-0.16688737273216248,-0.11700402200222015,0.21472221612930298,0.2968858778476715,0.26897549629211426,-0.03514778986573219,0.058127716183662415,-0.22583332657814026,-0.03322383388876915,-0.27562063932418823,0.26247507333755493,-0.21565741300582886,-0.18988829851150513,-0.20492683351039886,0.2552816569805145,-0.013454558327794075,-0.007138078100979328,0.02394901216030121,0.36772939562797546,0.040118809789419174,-0.17602680623531342,0.2189781814813614,0.11409545689821243,-0.06926902383565903,0.23234593868255615,-0.09993665665388107,-0.16525577008724213,0.2127389907836914,0.16506002843379974,0.024608412757515907,-0.29312247037887573,-0.22594277560710907},{0.3247266709804535,-0.2742338478565216,0.01695059984922409,-0.28688547015190125,-0.049396879971027374,-0.18081460893154144,0.06409099698066711,0.1658167839050293,0.21883313357830048,0.07090736925601959,0.18130141496658325,0.29583436250686646,-0.4144032895565033,-0.4068158268928528,-0.02016686275601387,-0.24056152999401093,-0.2879354655742645,-0.35496747493743896,0.3420698344707489,-0.1815585494041443,0.3763783872127533,-0.14989463984966278,0.03356203809380531,0.1873668134212494,0.13107828795909882,-0.11789476871490479,0.1421099156141281,0.003541594371199608,0.11847386509180069,0.020162014290690422,-0.3011706471443176,0.03984607011079788},{0.26947829127311707,-0.039473239332437515,-0.01674165204167366,0.36664634943008423,-0.09999637305736542,-0.1837444305419922,-0.0365033783018589,0.16119138896465302,0.1916119009256363,0.26224955916404724,0.12271809577941895,-0.1156296581029892,0.058357469737529755,0.1976349800825119,-0.11171608418226242,0.11776155233383179,0.22673088312149048,-0.2474120706319809,0.1044638603925705,-0.3507157564163208,0.2692517638206482,0.14431260526180267,-0.09926070272922516,0.20540688931941986,0.24796560406684875,0.08473815768957138,0.14492256939411163,0.07634519785642624,0.08924701064825058,-0.14668752253055573,0.009111606515944004,0.3775171637535095},{0.066120944917202,-0.2001434862613678,-0.008581770583987236,0.09035277366638184,-0.28269830346107483,0.006269038189202547,0.05092852562665939,-0.2010372281074524,-0.1763337254524231,-0.012935822829604149,0.19632573425769806,0.20172615349292755,0.08155842125415802,0.23584383726119995,-0.029109451919794083,-0.025556690990924835,-0.22078275680541992,0.26929429173469543,-0.07513593882322311,-0.20923595130443573,-0.20275969803333282,-0.095586858689785,0.15606117248535156,0.04380170255899429,-0.0032002932857722044,-0.13816924393177032,-0.1772540807723999,0.22477751970291138,0.06412263214588165,-0.14844705164432526,0.2664060890674591,0.15889319777488708},{0.16883531212806702,-0.22775794565677643,0.010505673475563526,-0.199624702334404,-0.012640237808227539,0.15257912874221802,0.07232429087162018,0.2709665596485138,-0.10771320760250092,-0.013906114734709263,0.2342904806137085,0.10827230662107468,0.06242595985531807,-0.09613915532827377,-0.016192521899938583,0.20426759123802185,-0.3519633114337921,-0.19994638860225677,-0.045870985835790634,0.08043767511844635,0.033517539501190186,0.2547828257083893,0.16251158714294434,0.1835324466228485,0.052846044301986694,0.1866026669740677,-0.020244527608156204,-0.06056705489754677,0.10300544649362564,-0.11761004477739334,-0.2570686340332031,0.3156881332397461},{0.1405028998851776,0.02992093935608864,-0.3791755139827728,0.10296081006526947,0.04987781122326851,-0.00491885282099247,0.35658514499664307,0.1089356392621994,0.07455448061227798,-0.12879709899425507,0.22251734137535095,-0.27745091915130615,-0.45359715819358826,0.27311357855796814,0.08642183989286423,0.0708380937576294,0.01127325277775526,-0.07219622284173965,-0.16014757752418518,0.05172331631183624,-0.0733785554766655,0.26381751894950867,0.09507269412279129,-0.1755150407552719,-0.08355367928743362,-0.21507598459720612,0.06883323937654495,0.3734535872936249,0.2216814160346985,-0.21787519752979279,0.21484971046447754,0.14936013519763947},{-0.07872743904590607,-0.0005268504028208554,-0.08107435703277588,-0.08197236806154251,-0.23823444545269012,-0.021673478186130524,0.23271261155605316,0.18290984630584717,0.13479606807231903,0.002733879955485463,0.1911473274230957,-0.015117649920284748,0.22117476165294647,0.21631085872650146,0.16982242465019226,-0.08740851283073425,0.1334955096244812,0.2011561095714569,0.21612954139709473,0.045000240206718445,0.1693776696920395,0.2953600585460663,0.07984728366136551,0.16566674411296844,-0.025421686470508575,-0.06767164915800095,-0.13315725326538086,-0.22784028947353363,0.12762878835201263,-0.2776496708393097,0.047387342900037766,-0.07896389812231064},{-0.3463314473628998,0.024149412289261818,-0.3517853319644928,-0.33282649517059326,0.03538491949439049,-0.01701520010828972,0.14030474424362183,-0.17837189137935638,0.07451510429382324,0.3707594573497772,0.0075492472387850285,-0.24436457455158234,0.05707743763923645,-0.19264809787273407,-0.3275412321090698,0.018970435485243797,-0.18421931564807892,0.11635449528694153,-0.09484420716762543,0.0016258310060948133,-0.28744441270828247,0.152052104473114,0.10244950652122498,0.057663965970277786,-0.09047844260931015,0.3512912690639496,0.039027031511068344,-0.21775983273983002,-0.20183607935905457,0.0020299635361880064,-0.22533756494522095,-0.26782387495040894},{-0.00620768079534173,-0.25959399342536926,-0.2866292893886566,-0.05327178165316582,-0.32413148880004883,-0.1492946743965149,0.18572290241718292,-0.28513050079345703,-0.22783413529396057,0.17704494297504425,0.19084931910037994,0.08257342875003815,0.10979720205068588,-0.14303766191005707,0.27756986021995544,-0.2685910165309906,0.09423455595970154,0.2655083239078522,0.043270546942949295,0.2809288501739502,0.011703742668032646,-0.11620592325925827,-0.2852860689163208,0.22670409083366394,-0.11445979028940201,-0.15863922238349915,0.11394011974334717,0.04181244969367981,-0.11673399060964584,-0.33485808968544006,-0.03559236600995064,-0.19085656106472015},{0.21884042024612427,0.08887812495231628,-0.07060179859399796,0.23688922822475433,-0.24206626415252686,0.08002999424934387,-0.09942083060741425,-0.22717490792274475,-0.06906578689813614,0.23696169257164001,-0.3540734052658081,-0.14411219954490662,0.04598159343004227,-0.210176020860672,-0.392621785402298,-0.19669213891029358,-0.12415657937526703,-0.3447153866291046,-0.28256916999816895,0.2166772037744522,0.18197274208068848,0.05846444144845009,-0.3864291310310364,0.3285706639289856,0.12578314542770386,0.32344314455986023,-0.33197078108787537,-0.14014147222042084,0.10574088990688324,-0.210307776927948,0.08572062849998474,0.18433727324008942},{-0.053268495947122574,-0.2949603199958801,-0.048155300319194794,-0.3103732764720917,-0.06843060255050659,0.30009958148002625,0.20735324919223785,0.029112743213772774,-0.11355377733707428,0.007419923786073923,-0.15625275671482086,0.0940089151263237,0.09373752772808075,0.06944470852613449,0.12103138118982315,0.03502338007092476,-0.07497455924749374,0.15168093144893646,-0.11507516354322433,0.15107282996177673,0.1849970817565918,0.26252928376197815,-0.036279741674661636,-0.2500501275062561,0.16751760244369507,0.15928912162780762,0.27915599942207336,0.1752903163433075,0.02833082713186741,0.10335762798786163,0.02152547985315323,-0.10520829260349274},{-0.006538881454616785,-0.20778609812259674,0.24648408591747284,0.050568584352731705,0.299561470746994,-0.0327179878950119,-0.13221655786037445,-0.19220106303691864,0.14594358205795288,-0.04433981701731682,0.0721626803278923,0.014356211759150028,-0.28083738684654236,0.05705881863832474,-0.10044444352388382,-0.26219233870506287,-0.04734225571155548,-0.05496801808476448,0.17920660972595215,0.2069333791732788,0.03266756609082222,0.040144048631191254,0.15654942393302917,0.3085399270057678,-0.17315521836280823,-0.05433386191725731,0.16156554222106934,-0.08215316385030746,-0.15283527970314026,-0.2503357231616974,0.28999850153923035,0.01856834813952446},{0.19328904151916504,-0.07322338223457336,0.040867406874895096,0.11454235762357712,-0.04486368969082832,0.05984238162636757,-0.2447884976863861,0.31222614645957947,-0.1281975358724594,-0.04021388664841652,0.13121704757213593,-0.2998414635658264,0.03259452432394028,-0.06008584797382355,-0.1094580590724945,0.3233890235424042,-0.08018974959850311,-0.18204869329929352,0.03863828629255295,0.010122524574398994,-0.1867164969444275,0.18146133422851562,0.2250685691833496,0.23482702672481537,-0.2608881890773773,0.11565110832452774,-0.05960704758763313,0.08469294756650925,-0.2679733633995056,0.2538180947303772,-0.047368112951517105,0.038427066057920456}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.25418820977211,-0.13311097025871277,0.1250542253255844,-0.19389179348945618},{0.2061852216720581,-0.2540510892868042,0.27706488966941833,0.2357913851737976},{-0.32294148206710815,0.05784819275140762,0.16196109354496002,-0.048901572823524475},{0.2979279160499573,0.4930310547351837,0.3207215964794159,0.03920856863260269},{-0.3051137328147888,0.1752445101737976,-0.2885948121547699,0.13686120510101318},{0.004009328782558441,-0.12470024824142456,0.08688756823539734,0.376811683177948},{-0.11017292737960815,-0.23197205364704132,-0.4263022541999817,-0.0067664021626114845},{-0.12333580106496811,-0.3927583694458008,0.18403223156929016,-0.06300653517246246},{-0.13446161150932312,0.1740856021642685,-0.07715164124965668,-0.117848701775074},{0.29501068592071533,-0.012888368219137192,-0.1492123305797577,-0.22892843186855316},{0.24464602768421173,-0.23141616582870483,0.32342618703842163,0.2537219524383545},{-0.07675916701555252,0.02216792106628418,0.465286523103714,-0.11535283178091049},{-0.33909958600997925,0.266458123922348,-0.04121534898877144,-0.08145872503519058},{-0.19470222294330597,-0.016245760023593903,-0.2517344653606415,0.08437501639127731},{0.2026515007019043,-0.06074792146682739,0.2388637214899063,0.11006645113229752},{-0.1450553685426712,-0.3069678843021393,-0.1261281818151474,-0.08186691999435425},{-0.313293993473053,0.05476430431008339,-0.06758248805999756,0.3403069078922272},{-0.31870561838150024,-0.15532286465168,-0.2389332503080368,0.22350157797336578},{-0.07638704031705856,-0.14424817264080048,0.4392760097980499,0.07258456945419312},{-0.15995745360851288,-0.17750248312950134,-0.021564560011029243,-0.17725041508674622},{0.1692703664302826,0.14572443068027496,0.13490471243858337,-0.17356285452842712},{-0.0017335917800664902,-0.30671074986457825,-0.19543138146400452,0.32157185673713684},{0.30505162477493286,-0.1817563772201538,0.21643298864364624,0.04382653161883354},{-0.3039117753505707,-0.033982791006565094,-0.2836088538169861,-0.31169527769088745},{-0.26985204219818115,-0.1885596215724945,0.025890829041600227,-0.14195683598518372},{0.24124883115291595,0.24390174448490143,-0.10501052439212799,0.16071273386478424},{0.18062075972557068,-0.21769914031028748,0.25982314348220825,0.0879528746008873},{-0.0416637659072876,-0.1761961728334427,0.009693928994238377,0.33930882811546326},{0.10288990288972855,0.04147908464074135,0.023087477311491966,0.024238761514425278},{-0.18340516090393066,0.10724318772554398,0.31260067224502563,0.012272586114704609},{-0.18009427189826965,-0.1559930145740509,0.0774877741932869,0.24577781558036804},{0.22203221917152405,0.23690202832221985,0.29609182476997375,-0.043721601366996765}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.023143233731389046,-0.008828014135360718,-0.006601379718631506,0.0478164367377758,0.05372381955385208,-0.063168466091156,-0.022035768255591393,0.07189743220806122,-0.08933781832456589,-0.020185060799121857,0.0056355055421590805,0.00526282237842679,-0.027925288304686546,0.06097744032740593,-0.011116190813481808,-0.04282376542687416};
static const float actor_encoder_self_encoder_2_bias[16] = {0.005381631664931774,-0.013441598042845726,-0.01341890450567007,0.0021905957255512476,-0.04884473979473114,0.026635803282260895,-0.03200697526335716,-0.01344847958534956,0.027717845514416695,-0.04625425115227699,0.006330569740384817,-0.024004174396395683,-0.013918185606598854,-0.026646994054317474,-0.005079194903373718,-0.023937933146953583};
static const float actor_encoder_feed_forward_0_bias[32] = {0.004380034748464823,0.0513683520257473,-0.011756827123463154,0.009832906536757946,-0.013753285631537437,0.027893779799342155,-0.03678792342543602,-0.002645203610882163,-0.008358171209692955,-0.024577202275395393,-0.0047910818830132484,0.03400680050253868,0.021042518317699432,0.008444557897746563,0.0410054512321949,-0.03882373869419098,0.014777109958231449,-0.009097433649003506,0.01997632347047329,-0.031117601320147514,-0.01018916442990303,0.027353059500455856,-0.002447663340717554,-0.03720095008611679,-0.04667234793305397,0.012441187165677547,0.023307224735617638,0.02806214429438114,-0.0206117145717144,0.03076200559735298,0.03079499676823616,-0.004105858504772186};
static const float action_parameterization_distribution_linear_bias[4] = {-0.0012300595408305526,0.01135342475026846,0.010276173241436481,0.029951227828860283};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3905757963657379,-0.3752611577510834,-0.1424645185470581,0.22371481359004974,-0.2209307700395584,0.09057525545358658,-0.3477220833301544,0.04505656659603119},{0.19669559597969055,0.11201182007789612,0.4049151837825775,0.3877359628677368,-0.13501963019371033,-0.35392239689826965,0.30323001742362976,0.40433546900749207},{0.06650259345769882,0.18388836085796356,0.11726125329732895,-0.035632699728012085,0.3265146315097809,0.21329949796199799,-0.016988638788461685,0.25312408804893494},{0.11230049282312393,-0.3492202162742615,0.3422130048274994,-0.1521347314119339,-0.23417653143405914,0.09650494158267975,0.3061926066875458,0.26295939087867737},{-0.2568419873714447,-0.07281607389450073,-0.04438423365354538,-0.2712908387184143,0.1400195062160492,0.12117596715688705,0.33807551860809326,0.2898685932159424},{-0.06723909080028534,0.20058800280094147,-0.0031776519026607275,-0.20647287368774414,0.3432421386241913,0.1209259033203125,0.09636076539754868,-0.16015082597732544},{0.0007867394597269595,0.1716727614402771,0.14624649286270142,-0.15009522438049316,0.4384787678718567,-0.11262042820453644,0.15440256893634796,0.11082668602466583},{0.057142820209264755,-0.4268666207790375,-0.0414598323404789,-0.2297595888376236,0.28340187668800354,0.027584735304117203,-0.1697877198457718,-0.3254050612449646},{-0.26885226368904114,0.1764579564332962,-0.014374256134033203,-0.08456834405660629,-0.009302313439548016,0.4443572461605072,0.373203843832016,0.289189875125885},{-0.009564109146595001,-0.13634680211544037,-0.27267470955848694,0.28092160820961,0.2855238914489746,0.3221178352832794,0.35574832558631897,-0.31756719946861267},{-0.16948233544826508,-0.3766990900039673,0.361690878868103,0.18257783353328705,0.013015750795602798,-0.25951114296913147,0.03504760563373566,-0.33047863841056824},{0.22993610799312592,0.04121128097176552,0.40626275539398193,0.4035903811454773,-0.1170310527086258,0.33316460251808167,0.21795283257961273,-0.3344014585018158},{-0.3949007987976074,0.14182034134864807,-0.34904006123542786,0.44264528155326843,-0.02277480810880661,0.43188074231147766,0.02830839343369007,0.2657148241996765},{-0.06872161477804184,0.18073534965515137,-0.13087068498134613,-0.10596076399087906,0.012178100645542145,0.1468939185142517,0.3129054605960846,0.011199835687875748},{0.11465275287628174,-0.3245159387588501,-0.35301241278648376,-0.16093747317790985,0.12318127602338791,-0.16887934505939484,0.11660560965538025,-0.09090877324342728},{-0.4672730565071106,-0.32421690225601196,-0.2643362283706665,0.007545171305537224,-0.0417340062558651,0.21571660041809082,0.20805595815181732,-0.0783928632736206},{-0.17794261872768402,-0.3031848073005676,0.24087224900722504,-0.3441985547542572,0.002505865413695574,0.03267432376742363,-0.4303121864795685,-0.2690114378929138},{0.056638795882463455,0.21230365335941315,0.1519879549741745,0.19965818524360657,-0.10883883386850357,0.3398728370666504,0.2741343379020691,-0.19455887377262115},{0.05977925285696983,-0.3465314209461212,-0.07156552374362946,-0.0577339306473732,-0.15032684803009033,-0.33743539452552795,0.028263099491596222,-0.298511803150177},{-0.031224925071001053,0.0017698602750897408,0.11519983410835266,-0.3009530007839203,0.04280570521950722,0.11420724540948868,0.06272595375776291,-0.12073370814323425},{0.09596152603626251,-0.1014508455991745,0.07072565704584122,-0.2601938247680664,-0.009667185135185719,-0.006910667754709721,-0.04398481547832489,-0.244219571352005},{-0.31915783882141113,0.1936785727739334,0.14362990856170654,-0.24230536818504333,-0.4785163998603821,0.00939062237739563,0.11552009731531143,0.0004704161547124386},{0.2852545976638794,0.12313856184482574,-0.4138382375240326,0.12393400818109512,-0.0674055889248848,0.22467774152755737,0.21611177921295166,0.29057973623275757},{0.004424170590937138,-0.1055741012096405,-0.012293269857764244,0.31075409054756165,-0.3185200095176697,-0.06560210883617401,-0.17388267815113068,-0.3208892345428467},{0.221048042178154,0.0996539443731308,-0.4361385107040405,0.34822896122932434,-0.29966768622398376,-0.3512076735496521,-0.3486226201057434,0.17894786596298218},{0.05213534086942673,0.3738080561161041,-0.3085002601146698,-0.05058205872774124,0.07488714903593063,-0.2576676309108734,0.3096776008605957,-0.2849443554878235},{-0.06848108023405075,0.07601089030504227,-0.1633494794368744,-0.14314089715480804,0.023287640884518623,-0.18925514817237854,-0.11042255163192749,-0.13643772900104523},{0.14658500254154205,-0.17129603028297424,-0.06270737946033478,-0.09650702029466629,-0.0026511552277952433,0.004687079228460789,-0.2123744785785675,0.09195959568023682},{0.3636188805103302,0.055252235382795334,-0.40350034832954407,-0.18549174070358276,-0.26023396849632263,0.10231746733188629,0.2194894701242447,0.08299922943115234},{0.4053080081939697,-0.30143091082572937,-0.03186778724193573,-0.028659045696258545,0.11124783754348755,-0.12755325436592102,0.19818350672721863,0.34944966435432434},{-0.24389424920082092,-0.16641511023044586,0.03212898224592209,-0.24722763895988464,0.32425540685653687,-0.25376027822494507,0.04162178188562393,0.08839332312345505},{0.18330039083957672,0.01662413217127323,-0.15430393815040588,0.33569034934043884,0.07585861533880234,0.012600867077708244,-0.04152420163154602,0.02240302413702011}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24360767006874084,0.41777026653289795,-0.6092720031738281,-0.5728981494903564,-0.2776806056499481,0.055575866252183914,-0.4309214949607849,0.5572230815887451},{-0.029830554500222206,0.5304253101348877,-0.2198604941368103,0.536571204662323,-0.01352116372436285,0.045433346182107925,-0.23318138718605042,0.004483850672841072},{-0.4603923261165619,-0.21641772985458374,-0.16709861159324646,-0.22507894039154053,0.5295581221580505,0.1798735111951828,0.017821038141846657,0.4341646730899811},{-0.5030034780502319,-0.48696964979171753,0.3068011701107025,0.35688188672065735,-0.5130364894866943,-0.20923574268817902,0.5516076683998108,0.18751345574855804},{-0.3177165985107422,-0.3149872422218323,-0.3004746735095978,-0.3189271092414856,0.34048736095428467,-0.2929082214832306,0.5253833532333374,-0.47058916091918945},{-0.08491688966751099,0.16907967627048492,0.31427687406539917,-0.5744572877883911,0.5453370213508606,-0.3309195041656494,-0.4188925325870514,-0.3185044527053833},{-0.419188916683197,0.17253386974334717,0.07780196517705917,-0.37753593921661377,-0.028367580845952034,-0.5447378158569336,0.4908287227153778,0.06870047748088837},{-0.39534610509872437,-0.3153041899204254,-0.22390131652355194,-0.4196244478225708,-0.3134307861328125,0.11182694137096405,0.5145531892776489,-0.303218275308609}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0333995521068573,-0.02554178424179554,-0.012529424391686916,0.014698482118546963,-0.04023047164082527,-0.01719788834452629,-0.1034238263964653,0.02117137797176838};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.006592674646526575,-0.033284611999988556,-0.00760590098798275,0.047578196972608566,-0.03060035966336727,0.031775545328855515,-0.053345344960689545,0.043831098824739456};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

