#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3053515553474426,-0.19176293909549713,0.3327471613883972,0.19770266115665436,-0.36635252833366394,0.154159277677536,0.0017612549709156156,-0.21037672460079193,0.07809317857027054,0.43652382493019104,0.11910645663738251,0.0239246878772974,0.16396461427211761,-0.18824532628059387,0.35390570759773254,-0.09317859262228012},{-0.3770636022090912,-0.28753551840782166,0.2687269449234009,0.19168981909751892,-0.21726547181606293,0.023795360699295998,-0.40061649680137634,0.040303971618413925,-0.18025876581668854,-0.12248719483613968,0.147731751203537,-0.16968928277492523,0.23571425676345825,-0.39809995889663696,-0.21308840811252594,0.09065981209278107},{0.1544065624475479,-0.24476122856140137,-0.25864526629447937,0.07744506001472473,0.12091687321662903,0.15437975525856018,-0.05318014323711395,0.011933164671063423,-0.11931460350751877,-0.20010465383529663,-0.1936209797859192,0.4107849597930908,-0.016329800710082054,-0.16437149047851562,-0.3936789631843567,0.2371469885110855},{0.15262246131896973,0.18631020188331604,0.3393014371395111,-0.06962795555591583,-0.3346068263053894,-0.045127008110284805,0.17241378128528595,0.14182370901107788,0.48167362809181213,-0.3861071467399597,0.030291521921753883,0.1647503525018692,-0.31465744972229004,-0.047773562371730804,0.3334834575653076,-0.38360723853111267},{-0.035338666290044785,0.08050364255905151,0.23404355347156525,-0.12353412806987762,0.22971737384796143,0.26082155108451843,0.24339768290519714,-0.0611206479370594,-0.04692130908370018,0.2467702329158783,0.3274378478527069,-0.15543930232524872,-0.14598393440246582,-0.3206043839454651,0.39225658774375916,0.15257395803928375},{0.0011829085415229201,-0.17232728004455566,-0.13528846204280853,-0.23983915150165558,0.12482237815856934,0.025897298008203506,-0.03417481854557991,-0.1370091438293457,0.20081669092178345,-0.22842295467853546,-0.2852906584739685,0.1964714080095291,0.43880921602249146,-0.0003256632189732045,-0.046147704124450684,0.12632177770137787},{-0.0751243382692337,-0.042286425828933716,0.08832403272390366,-0.20776812732219696,0.20506353676319122,0.03664064407348633,0.0893760472536087,0.3155522048473358,0.3090837597846985,-0.004418864380568266,-0.3275783061981201,0.1837940514087677,-0.09426478296518326,0.21136607229709625,-0.17403604090213776,-0.2427631914615631},{-0.018256453797221184,0.01982872560620308,0.26158425211906433,0.2081298828125,-0.42156416177749634,-0.027804745361208916,0.33882176876068115,0.31389525532722473,-0.08177678287029266,0.2122417688369751,-0.4928348660469055,-0.3078439235687256,0.22621293365955353,0.3212831914424896,0.21438659727573395,0.168627068400383},{0.28612351417541504,-0.21954737603664398,0.3376274108886719,-0.052591901272535324,0.22281120717525482,0.10142859816551208,-0.16460372507572174,-0.24336835741996765,0.11182950437068939,-0.31570470333099365,0.046899281442165375,-0.2935008704662323,-0.19070489704608917,0.33616214990615845,0.1593240350484848,-0.10620143264532089},{0.06488756090402603,-0.3569071888923645,-0.47808805108070374,-0.02101997099816799,-0.30985701084136963,0.24018266797065735,0.3753352463245392,0.18757930397987366,0.4470003545284271,0.3530166745185852,0.0017405309481546283,-0.2801467180252075,0.10510870069265366,0.2739611566066742,-0.07349072396755219,-0.3468098044395447},{0.05654791370034218,0.23066270351409912,0.422058641910553,-0.32954421639442444,-0.3115603029727936,0.2191244512796402,0.15026064217090607,0.3859824240207672,-0.3156472146511078,-0.016695069149136543,-0.029982522130012512,0.16586288809776306,-0.30589181184768677,-0.17040729522705078,0.3196367025375366,-0.3511042296886444},{0.14376801252365112,-0.1544976383447647,-0.028012050315737724,0.15828131139278412,0.33350837230682373,0.29509681463241577,0.4560360908508301,-0.030853677541017532,0.004746127407997847,-0.019321955740451813,0.2689802944660187,-0.11031810939311981,-0.06204952299594879,-0.22043253481388092,0.23720493912696838,0.2777734696865082},{-0.14583006501197815,0.2960500121116638,0.14065349102020264,-0.2988053560256958,0.04694913327693939,0.13694073259830475,0.32479098439216614,-0.03896397352218628,0.14349988102912903,0.0008743792423047125,-0.07598953694105148,0.1221502274274826,0.18426962196826935,0.2938931882381439,0.13911716639995575,-0.2560936510562897},{-0.24900394678115845,-0.20354990661144257,-0.20303568243980408,-0.03774215281009674,-0.17365266382694244,0.08710834383964539,-0.3616923689842224,0.10802850872278214,-0.07953682541847229,-0.027497265487909317,-0.2849043607711792,-0.07588852196931839,-0.32839661836624146,0.0997583270072937,0.2393791377544403,0.09781049937009811},{-0.1708178073167801,-0.4136635959148407,-0.2271125316619873,0.35493186116218567,0.0771554633975029,-0.3431890606880188,0.29038819670677185,-0.09221421182155609,-0.019971923902630806,0.31106215715408325,0.08752278983592987,0.18790370225906372,0.186677023768425,-0.020536743104457855,-0.1861555129289627,0.19431503117084503},{0.5067449808120728,-0.0891980528831482,-0.2659444808959961,-0.3768504858016968,-0.5879144072532654,0.3173971474170685,0.4032991826534271,-0.2972998023033142,0.1686590611934662,0.10174373537302017,-0.30707794427871704,0.06898921728134155,-0.5502681136131287,0.5409702658653259,-0.29706263542175293,0.018333783373236656},{-0.3809252381324768,-0.3898831903934479,0.38854849338531494,0.38234326243400574,-0.3278413712978363,0.33977407217025757,-0.09188481420278549,-0.31698429584503174,0.2646859288215637,-0.449491411447525,-0.3434433341026306,-0.6666876673698425,-0.2515981197357178,-0.4695659875869751,-0.015627559274435043,-0.21030597388744354},{-0.41474977135658264,0.26129618287086487,-0.5179290771484375,-0.01195516623556614,0.032796915620565414,0.3343324661254883,-0.335463285446167,-0.4152546525001526,0.24661944806575775,0.2492542862892151,0.42843395471572876,-0.07930979132652283,-0.24782010912895203,0.3121868371963501,0.15711268782615662,-0.49874648451805115}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1204095184803009,-0.09629931300878525,-0.1739242523908615,-0.4247444272041321,0.40956246852874756,0.28112080693244934,0.07394823431968689,0.10290653258562088,-0.27673667669296265,-0.10041221976280212,-0.10309633612632751,-0.00027054629754275084,0.23822854459285736,0.5009395480155945,0.15313288569450378,0.07843060791492462},{-0.19167639315128326,-0.2664312720298767,-0.02289588190615177,0.14525504410266876,0.29698342084884644,-0.25775593519210815,0.16679884493350983,0.043031707406044006,-0.07087093591690063,0.25097957253456116,-0.12705811858177185,0.35456138849258423,-0.3576489984989166,0.23199090361595154,-0.35203248262405396,-0.24597185850143433},{0.14351169764995575,0.2430792897939682,-0.40884923934936523,-0.5645801424980164,0.1517944633960724,0.46368101239204407,-0.09195812046527863,0.12132914364337921,-0.2604779005050659,-0.2346886843442917,-0.017971709370613098,0.28322264552116394,-0.33296918869018555,-0.28810641169548035,0.1709023416042328,-0.06393726915121078},{0.2104002982378006,-0.0569097138941288,0.08482861518859863,0.16865015029907227,-0.49038153886795044,0.03365969657897949,0.00812289398163557,-0.27729734778404236,0.34773939847946167,0.3626768887042999,-0.13208559155464172,-0.18528056144714355,-0.40207287669181824,-0.36304405331611633,0.21463248133659363,0.21743297576904297},{-0.17530511319637299,0.05062267929315567,0.05972246080636978,0.27573102712631226,-0.2347782999277115,0.02301867865025997,-0.03512472286820412,0.18349876999855042,0.2409493625164032,-0.3040851652622223,0.04826909676194191,0.4157526195049286,0.13760583102703094,-0.4175942540168762,-0.08221292495727539,-0.10583943873643875},{0.25183728337287903,0.22883129119873047,-0.019098976626992226,0.1868624985218048,-0.36885568499565125,-0.40175876021385193,0.28008952736854553,0.2883778512477875,0.1216621920466423,0.49888989329338074,0.2687776982784271,-0.2815275490283966,0.023346249014139175,-0.1522696614265442,-0.050715476274490356,0.33294370770454407},{-0.022221604362130165,0.16958867013454437,0.34929582476615906,-0.3811585605144501,-0.16248531639575958,0.0672587901353836,-0.2933763861656189,-0.05983293801546097,0.08530313521623611,0.11532385647296906,-0.1414870172739029,-0.2867882549762726,-0.2846251428127289,0.068881556391716,0.22118990123271942,0.07797317206859589},{-0.19703581929206848,-0.18680252134799957,-0.4199635088443756,0.26713645458221436,-0.2819787561893463,-0.32245633006095886,-0.20547059178352356,-0.34131911396980286,0.014994760975241661,-0.2323157638311386,-0.13421717286109924,0.170043483376503,-0.2321295440196991,0.40557578206062317,-0.12555989623069763,-0.39755189418792725},{-0.25728660821914673,0.28872939944267273,0.010410803370177746,-0.025197943672537804,0.31182196736335754,-0.21087659895420074,0.40418246388435364,0.11938226968050003,0.28784897923469543,0.39003509283065796,0.3088798522949219,0.3022094666957855,0.2639976739883423,-0.045345891267061234,0.31076866388320923,0.14734944701194763},{0.137884259223938,-0.27149567008018494,-0.028900302946567535,-0.13695906102657318,0.32381880283355713,-0.03919845074415207,-0.27986615896224976,-0.23784655332565308,0.07100756466388702,-0.46191608905792236,-0.19090652465820312,0.21320459246635437,0.13541394472122192,0.18194453418254852,-0.3136149048805237,0.27343684434890747},{-0.17149034142494202,-0.34725919365882874,0.478035032749176,0.25223106145858765,0.21440361440181732,0.15716154873371124,0.14018605649471283,-0.1528877317905426,0.14952309429645538,-0.23436851799488068,0.029272107407450676,0.4192180633544922,0.36911541223526,0.13451778888702393,-0.21703843772411346,0.0058001140132546425},{0.013136024586856365,-0.16903473436832428,0.28744208812713623,0.03483656421303749,-0.1248912438750267,-0.21156340837478638,0.45237380266189575,0.2784893214702606,-0.24986059963703156,-0.3897019922733307,-0.12597747147083282,-0.2984011769294739,-0.0066442303359508514,-0.3170045018196106,-0.3731245696544647,-0.002527456032112241},{-0.06771194934844971,-0.3214041590690613,0.30356884002685547,-0.1929662525653839,0.2964257299900055,-0.33955395221710205,-0.38199225068092346,0.18326272070407867,0.12303446233272552,-0.04094329848885536,-0.2933511435985565,0.1021021157503128,0.07297669351100922,-0.32860520482063293,-0.39462044835090637,-0.021812163293361664},{0.30625104904174805,-0.32523679733276367,0.48355552554130554,0.14410153031349182,0.07439234852790833,0.30226701498031616,-0.08159483969211578,-0.23363611102104187,-0.5283835530281067,0.10486491769552231,0.02161591127514839,-0.40568992495536804,0.023517688736319542,0.26137831807136536,0.3252681791782379,0.07623974978923798},{-0.24145780503749847,0.15516193211078644,0.10212025046348572,-0.3130626082420349,-0.2173605114221573,0.07778841257095337,0.25226452946662903,-0.15355591475963593,0.18144036829471588,-0.3905821442604065,0.008999739773571491,0.06323017925024033,-0.04713703691959381,0.07688240706920624,-0.0760284885764122,0.0020819364581257105},{-0.17891906201839447,0.32900306582450867,-0.34566250443458557,0.3033594489097595,0.17455074191093445,-0.3717603087425232,-0.1483781337738037,-0.06948144733905792,-0.4171045124530792,0.270833820104599,-0.4250097870826721,0.31439343094825745,-0.09939931333065033,-0.17293119430541992,-0.2673387825489044,-0.5521369576454163}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.17974303662776947,0.018659427762031555,-0.08171311765909195,-0.013826828449964523,-0.11656112223863602,-0.0035728004295378923,0.2942582964897156,0.012146555818617344,-0.1118902936577797,-0.15930862724781036,0.09598447382450104,-0.3159777522087097,-0.2227133959531784,0.2207060009241104,0.20183666050434113,0.2652049958705902,-0.27869635820388794,-0.3255259692668915,-0.24245400726795197,0.031132763251662254,-0.02014242112636566,-0.3696008622646332,-0.2272171527147293,-0.2912963628768921,-0.319137305021286,0.24261517822742462,-0.26486459374427795,-0.053072571754455566,-0.008613529615104198,-0.015282858163118362,0.17703308165073395,-0.14598335325717926},{0.23776337504386902,0.2318716198205948,0.11069674789905548,-0.0799577534198761,0.11608199030160904,-0.07038281857967377,0.30879640579223633,0.10124241560697556,-0.2097318172454834,-0.14222973585128784,-0.05806683376431465,-0.2958161234855652,-0.1790016144514084,0.21060028672218323,-0.20444324612617493,-0.3193822205066681,-0.03878479078412056,0.17373298108577728,-0.3586089313030243,-0.30890774726867676,-0.015647560358047485,0.27514004707336426,0.13153240084648132,-0.1151793971657753,0.1321694552898407,-0.25974032282829285,0.0115576246753335,0.12005972862243652,0.20379717648029327,-0.14348773658275604,-0.027685098350048065,0.23191149532794952},{0.2336408942937851,0.08001622557640076,-0.07261915504932404,0.15537050366401672,-0.2118033468723297,-0.19270242750644684,-0.2804248332977295,0.14957158267498016,-0.12816140055656433,0.382730633020401,-0.27458807826042175,-0.17173312604427338,0.1206221953034401,-0.41091614961624146,-0.14052419364452362,0.10347254574298859,-0.16358599066734314,-0.17114229500293732,0.2810361385345459,-0.03948269411921501,0.2608187794685364,0.22695046663284302,-0.2345866709947586,0.025401612743735313,-0.2011425942182541,-0.09902660548686981,0.16680322587490082,-0.11150401830673218,-0.035074539482593536,-0.16354042291641235,-0.10876895487308502,-0.07791556417942047},{0.3376144766807556,0.0992308109998703,0.09578187763690948,-0.1238102987408638,-0.278927206993103,-0.06059778109192848,-0.175111785531044,0.26521867513656616,0.2399291843175888,-0.24194113910198212,-0.07526987791061401,0.31083959341049194,0.09373589605093002,-0.15400078892707825,-0.20041954517364502,0.2947661280632019,-0.3024156093597412,0.2281436324119568,0.01667233742773533,0.06680413335561752,-0.04954274371266365,-0.10405716300010681,0.2837298512458801,0.14797700941562653,0.16674332320690155,-0.3334046006202698,0.34364253282546997,-0.19963300228118896,-0.020185871049761772,0.053226642310619354,-0.276121586561203,0.1742660254240036},{-0.03599519282579422,-0.05511833354830742,-0.08591561019420624,0.051825057715177536,0.1884497106075287,-0.1928996592760086,-0.36603468656539917,-0.018471483141183853,-0.13668306171894073,-0.17708836495876312,0.14191953837871552,0.22640404105186462,-0.06544488668441772,-0.08878610283136368,-0.0913567841053009,0.21578872203826904,-0.06978485733270645,-0.015350867994129658,-0.3329484164714813,-0.06798387318849564,-0.1626398265361786,-0.36235398054122925,0.18098917603492737,0.22969944775104523,-0.06458230316638947,0.2884855568408966,-0.173712819814682,0.20277243852615356,0.310840368270874,0.3507048487663269,-0.03403306379914284,0.3046015799045563},{-0.24116769433021545,-0.08896288275718689,-0.17456752061843872,-0.052741602063179016,-0.1758173704147339,0.23897330462932587,0.21353070437908173,0.03231611102819443,0.30376192927360535,0.1565948873758316,0.3115728497505188,-0.23061035573482513,-0.18311375379562378,0.23691484332084656,0.29083117842674255,-0.34960412979125977,-0.1246640756726265,-0.24709270894527435,0.22286494076251984,0.10000453144311905,0.09433091431856155,0.13501709699630737,0.02117275260388851,-0.038486674427986145,-0.3721029460430145,0.33833804726600647,-0.20705881714820862,0.1569722294807434,0.3601979911327362,0.20760779082775116,0.06730873137712479,0.06923922151327133},{0.18113727867603302,-0.12043499946594238,-0.1434450000524521,-0.3407163918018341,-0.022121725603938103,0.2246508002281189,0.2747263014316559,0.14693683385849,0.08878567814826965,0.3347170352935791,-0.0011036043288186193,0.0009854952804744244,-0.4092872440814972,-0.1484706550836563,-0.15251494944095612,0.06229366362094879,-0.3019312620162964,-0.22481146454811096,0.1814071238040924,-0.09100113064050674,-0.11332038044929504,-0.13791576027870178,-0.2059149593114853,-0.25271645188331604,0.1915958970785141,-0.26387885212898254,-0.10139909386634827,-0.21317192912101746,0.34383389353752136,0.11157887428998947,-0.17842203378677368,-0.2788543701171875},{0.05996209755539894,0.1841638833284378,0.03969709202647209,-0.1421786993741989,0.15535548329353333,-0.3043629229068756,-0.04040411114692688,-0.16159914433956146,-0.010908150114119053,-0.26149114966392517,-0.3218860626220703,-0.11309316754341125,-0.12601236999034882,0.058600012212991714,-0.15269258618354797,0.41943472623825073,-0.0019590770825743675,-0.13370181620121002,0.10397293418645859,0.33946165442466736,-0.19880689680576324,-0.17457453906536102,0.30422502756118774,0.08829565346240997,0.011364156380295753,-0.33874794840812683,-0.324253112077713,-0.21542923152446747,-0.3830297887325287,-0.2840564250946045,0.09307960420846939,-0.3883800208568573},{0.0238972008228302,0.47935619950294495,-0.4241289496421814,-0.38484546542167664,-0.32655051350593567,0.16467119753360748,0.0665448009967804,0.14537672698497772,-0.0010147672146558762,-0.2592691481113434,-0.11843225359916687,0.2985144853591919,-0.42294496297836304,-0.24770183861255646,0.2346327006816864,-0.21492041647434235,0.22111479938030243,0.1488085389137268,0.37141022086143494,0.04738824442028999,0.17641134560108185,0.2162259817123413,0.3941131830215454,-0.16738884150981903,0.4705495536327362,-0.21431134641170502,0.2771332561969757,0.4121325612068176,-0.163234144449234,0.09227324277162552,0.03774536773562431,0.09970061480998993},{-0.2828056514263153,0.09623824059963226,-0.41508179903030396,-0.19359897077083588,0.11884825676679611,-0.2624122202396393,0.15062662959098816,-0.06309280544519424,0.20473405718803406,0.13829874992370605,-0.30148085951805115,-0.3966054916381836,-0.449250727891922,-0.12350402772426605,-0.27300336956977844,0.10228172689676285,-0.06309263408184052,-0.2661686837673187,0.1251852661371231,0.05885076895356178,0.08559110760688782,-0.015478190034627914,0.4130053222179413,-0.18337516486644745,0.32598212361335754,0.20748963952064514,-0.25888538360595703,0.02262253873050213,0.00999581441283226,-0.02127690799534321,-0.25986504554748535,0.12524355947971344},{0.09095309674739838,0.016634713858366013,0.12788096070289612,-0.30665042996406555,-0.298389732837677,-0.23157624900341034,-0.2507458031177521,-0.032245032489299774,-0.1989462524652481,0.3795492351055145,0.143266499042511,-0.28345465660095215,-0.37222447991371155,-0.060244057327508926,-0.22029684484004974,-0.125126913189888,0.20037460327148438,-0.1582910716533661,0.26954352855682373,-0.20730292797088623,-0.18783804774284363,0.049675796180963516,0.22482311725616455,0.17659181356430054,0.2117079794406891,-0.1482727825641632,-0.025707736611366272,-0.05982962250709534,-0.04353845864534378,-0.01875085011124611,-0.0785508081316948,0.16070739924907684},{-0.2127286195755005,-0.03965625911951065,0.2213767170906067,0.28010666370391846,0.2629682719707489,0.013693331740796566,0.09005699306726456,-0.2022334337234497,-0.11327207833528519,-0.2121049165725708,0.2947200834751129,-0.24947482347488403,-0.21139460802078247,-0.1864195615053177,0.28167104721069336,0.03607005253434181,0.0037705868016928434,0.05168088525533676,0.3516544699668884,0.0883609801530838,-0.2155345231294632,0.27578964829444885,0.11439059674739838,-0.07262670993804932,0.24070623517036438,-0.12764300405979156,-0.13159500062465668,0.2517890930175781,0.19058626890182495,-0.03098876029253006,-0.252247154712677,-0.2916349470615387},{0.2472202479839325,-0.2550117075443268,-0.02521941252052784,-0.3337508738040924,0.10271561145782471,-0.13307036459445953,0.15753570199012756,0.08144571632146835,0.27362820506095886,0.09992601722478867,0.11755119264125824,0.20267802476882935,-0.36747756600379944,-0.29396483302116394,-0.09510133415460587,-0.22058986127376556,-0.18442218005657196,-0.2405039519071579,0.2639850676059723,-0.23165085911750793,0.31068381667137146,-0.036971595138311386,-0.00684730801731348,0.19318561255931854,0.13865678012371063,-0.10194344818592072,0.11065946519374847,0.08731716126203537,0.14939482510089874,-0.07967101782560349,-0.2739013135433197,-0.07160276174545288},{0.21814173460006714,-0.10465138405561447,-0.04286804795265198,0.4280412793159485,-0.09701232612133026,-0.24893130362033844,-0.049723558127880096,0.06822793185710907,0.22882364690303802,0.3599722385406494,0.08332382142543793,-0.1686052829027176,0.0787089467048645,0.22639836370944977,-0.12245334684848785,0.05320043861865997,0.17745642364025116,-0.2602533996105194,0.022565709426999092,-0.3661297857761383,0.3496987521648407,0.09862951934337616,-0.09715716540813446,0.20906402170658112,0.16798461973667145,0.14171487092971802,0.057106174528598785,0.0016188928857445717,0.09315715730190277,-0.16511090099811554,-0.08219748735427856,0.41232621669769287},{0.008563268929719925,-0.27659812569618225,-0.09669864177703857,0.11601485311985016,-0.25028517842292786,-0.010279449634253979,0.06137358024716377,-0.2872067987918854,-0.13691528141498566,-0.029998216778039932,0.174860417842865,0.12005061656236649,0.08816318213939667,0.2572009265422821,-0.0654023140668869,-0.1001555547118187,-0.2331053912639618,0.2690863311290741,-0.1383199244737625,-0.29954975843429565,-0.18165382742881775,-0.07779256999492645,0.18302595615386963,-0.003417612984776497,-0.060010362416505814,-0.04377968609333038,-0.23153798282146454,0.21978245675563812,0.07329200953245163,-0.200699582695961,0.2106235772371292,0.19387145340442657},{0.12188270688056946,-0.19839267432689667,-0.13755613565444946,-0.17625020444393158,-0.13532783091068268,0.12743480503559113,0.04092226177453995,0.23210279643535614,-0.11853629350662231,0.06965696811676025,0.2511402666568756,0.10461656004190445,-0.08043050765991211,-0.16891101002693176,0.030322810634970665,0.15801221132278442,-0.47245875000953674,-0.29236409068107605,-0.06792071461677551,0.0350969024002552,0.1376369297504425,0.2406512051820755,0.32369154691696167,0.12893453240394592,0.05638439208269119,0.23002929985523224,0.02845824509859085,-0.08974236249923706,0.21388299763202667,-0.15537294745445251,-0.31206801533699036,0.3916860818862915},{0.1873008906841278,0.011390303261578083,-0.2601378262042999,0.15999852120876312,0.09279314428567886,-0.023894451558589935,0.2716275751590729,0.12667466700077057,0.10140696913003922,-0.22183331847190857,0.22716858983039856,-0.17977431416511536,-0.39983421564102173,0.24136734008789062,0.058738380670547485,0.05853228271007538,0.06756582856178284,-0.05247615650296211,-0.12504908442497253,0.05428706109523773,-0.07740650326013565,0.2130114734172821,0.07438068836927414,-0.15054400265216827,0.046810489147901535,-0.26905086636543274,0.04025614634156227,0.42607730627059937,0.24763168394565582,-0.14065441489219666,0.2272603064775467,0.19736969470977783},{-0.013954193331301212,-0.032206106930971146,-0.07209033519029617,-0.029676293954253197,-0.2539273798465729,-0.0452386774122715,0.18016429245471954,0.2188301682472229,0.1392478495836258,-0.010222284123301506,0.23585988581180573,0.04603566974401474,0.21364255249500275,0.1370866894721985,0.17768658697605133,-0.08879559487104416,0.11859630793333054,0.15845216810703278,0.2731839418411255,0.09622575342655182,0.20394916832447052,0.22462868690490723,0.06612593680620193,0.14130006730556488,-0.007179683074355125,-0.11532999575138092,-0.08895010501146317,-0.26334595680236816,0.17301903665065765,-0.21331484615802765,0.03662310540676117,-0.01453457958996296},{-0.3520013988018036,0.0935576856136322,-0.31797051429748535,-0.3476640582084656,-0.010629372671246529,0.055380929261446,0.13811363279819489,-0.14348386228084564,0.008426707237958908,0.3131980299949646,0.0609450526535511,-0.23508034646511078,0.03212656453251839,-0.15525878965854645,-0.3131549060344696,-0.027199141681194305,-0.18017098307609558,0.13902102410793304,-0.04101846367120743,-0.07579545676708221,-0.3291164040565491,0.19127799570560455,0.13149920105934143,0.031026745215058327,-0.016111008822917938,0.29914867877960205,0.012284008786082268,-0.12860020995140076,-0.17375458776950836,-0.005272925831377506,-0.15757577121257782,-0.26265260577201843},{0.0087795564904809,-0.21700718998908997,-0.22642120718955994,-0.020835718140006065,-0.35829612612724304,-0.16983254253864288,0.15713201463222504,-0.28586921095848083,-0.20303715765476227,0.19325052201747894,0.14299234747886658,0.125202938914299,0.13360635936260223,-0.11371869593858719,0.3123558461666107,-0.3141527771949768,0.06353837996721268,0.2193428874015808,0.05577463284134865,0.24704580008983612,0.056197214871644974,-0.13738244771957397,-0.28870001435279846,0.20645862817764282,-0.1704670637845993,-0.16358709335327148,0.08748366683721542,0.013271492905914783,-0.12368236482143402,-0.2907896935939789,-0.042266249656677246,-0.1415526568889618},{0.2344510853290558,0.17546939849853516,-0.07487881928682327,0.14303503930568695,-0.2846149802207947,0.1625726819038391,-0.04813067987561226,-0.13367336988449097,-0.19244123995304108,0.20833297073841095,-0.26936665177345276,-0.15665768086910248,-0.03764406219124794,-0.18217922747135162,-0.3760679066181183,-0.12004376202821732,-0.09317939728498459,-0.26622116565704346,-0.2268015593290329,0.3121984601020813,0.09150602668523788,0.12196461111307144,-0.33422237634658813,0.35126280784606934,0.20329774916172028,0.2417922019958496,-0.27634721994400024,-0.03693735599517822,0.0633232519030571,-0.2692996561527252,0.12140757590532303,0.08301953226327896},{0.016733214259147644,-0.3265911936759949,0.030603237450122833,-0.29473450779914856,-0.05632428824901581,0.25622981786727905,0.17848965525627136,0.032390106469392776,-0.030231643468141556,0.005376586690545082,-0.22913074493408203,0.1615450382232666,0.1651584655046463,0.11267422139644623,0.1332770586013794,0.021432427689433098,-0.06889965385198593,0.1305406093597412,-0.10573525726795197,0.1819724142551422,0.21839584410190582,0.22527958452701569,-0.09451095759868622,-0.23191383481025696,0.11710168421268463,0.10337173193693161,0.24553166329860687,0.1213558092713356,-0.04385538771748543,0.19610370695590973,0.03869996592402458,-0.11537526547908783},{0.02553439885377884,-0.1847318410873413,0.24525198340415955,-0.0027073409873992205,0.3004320561885834,-0.022166160866618156,-0.1163840964436531,-0.1678621768951416,0.14268366992473602,-0.07199294120073318,0.07411739975214005,-0.0009839064441621304,-0.24710623919963837,0.026823822408914566,-0.10419435054063797,-0.24650943279266357,-0.03979101777076721,-0.0337083600461483,0.21413476765155792,0.2508017420768738,0.0214308500289917,0.05303483083844185,0.1745310127735138,0.33804813027381897,-0.16024167835712433,-0.08331245183944702,0.2130613774061203,-0.09897938370704651,-0.2156689614057541,-0.24034395813941956,0.3074527978897095,-0.010747507214546204},{0.19518965482711792,-0.046840377151966095,0.051886577159166336,0.14517635107040405,-0.04262508079409599,0.07608320564031601,-0.2845454514026642,0.2817080020904541,-0.10272437334060669,-0.0570029690861702,0.12251681834459305,-0.261408269405365,-0.0034171552397310734,-0.03531615808606148,-0.07172670215368271,0.25709089636802673,-0.06680196523666382,-0.19336621463298798,0.04988400638103485,-0.031687382608652115,-0.16454477608203888,0.2146497666835785,0.23952586948871613,0.1929870843887329,-0.2983510196208954,0.13019806146621704,-0.05780487507581711,0.09602272510528564,-0.2762793302536011,0.301599383354187,-0.013742438517510891,0.06182166934013367}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.24481917917728424,-0.10992173105478287,0.1589217633008957,-0.17782741785049438},{0.21194811165332794,-0.3502199351787567,0.28948473930358887,0.27128860354423523},{-0.3313087224960327,0.12236305326223373,0.09030288457870483,-0.004816154949367046},{0.26254913210868835,0.5383372902870178,0.3739926517009735,0.03928796201944351},{-0.2823689877986908,0.15048283338546753,-0.34994879364967346,0.11302736401557922},{-0.08575962483882904,-0.08764412999153137,0.0980035811662674,0.4708995521068573},{-0.10920584201812744,-0.10748526453971863,-0.4033653438091278,0.011979039758443832},{-0.16219165921211243,-0.27168622612953186,0.24371621012687683,-0.062480997294187546},{-0.08353152871131897,0.13207313418388367,-0.1032978966832161,-0.13555441796779633},{0.28791680932044983,0.04395100846886635,-0.12391435354948044,-0.26752251386642456},{0.18629206717014313,-0.12182338535785675,0.3278430998325348,0.2863958477973938},{-0.08836787939071655,0.014673328027129173,0.4833570420742035,-0.09890346974134445},{-0.41987144947052,0.27899956703186035,0.0027603814378380775,-0.14954179525375366},{-0.20813415944576263,0.13630419969558716,-0.251661479473114,0.11156398057937622},{0.1683606207370758,0.033873192965984344,0.30809029936790466,0.12552811205387115},{-0.1563769429922104,-0.34333500266075134,-0.13934238255023956,-0.1199813038110733},{-0.37977325916290283,0.03801318258047104,-0.09524278342723846,0.3404882252216339},{-0.32416272163391113,-0.13093286752700806,-0.2080051600933075,0.25313279032707214},{-0.056390464305877686,-0.1719040423631668,0.42828530073165894,0.06673619151115417},{-0.2385500967502594,-0.19471529126167297,0.04791867733001709,-0.21174263954162598},{0.19108472764492035,0.16772250831127167,0.19299620389938354,-0.2431270331144333},{-0.04989556223154068,-0.35575491189956665,-0.12899234890937805,0.34953024983406067},{0.46551141142845154,-0.2730056047439575,0.13321882486343384,0.112358957529068},{-0.3455641567707062,-0.10545850545167923,-0.3145909011363983,-0.3807074725627899},{-0.15683573484420776,-0.28483936190605164,-0.11576633155345917,-0.1008797362446785},{0.19107277691364288,0.18432754278182983,-0.09444300085306168,0.07008559256792068},{0.12365549057722092,-0.20579087734222412,0.33061304688453674,0.10232175886631012},{-0.0805719867348671,-0.18787036836147308,-0.050207722932100296,0.3505837619304657},{0.15879158675670624,0.0340672992169857,0.07222484797239304,0.03796901926398277},{-0.1725209653377533,0.130036860704422,0.28570371866226196,0.04562307521700859},{-0.28731003403663635,-0.08277233690023422,0.0925661101937294,0.27203625440597534},{0.3183542788028717,0.23441362380981445,0.28642696142196655,-0.03680736944079399}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.08214623481035233,-0.13777996599674225,0.07911239564418793,0.09846475720405579,0.09295384585857391,-0.1759144514799118,0.0808812752366066,0.009700949303805828,-0.07417020946741104,-0.05467940866947174,0.008412031456828117,0.003709161188453436,-0.0019891432020813227,0.09166676551103592,0.11042127013206482,-0.030936649069190025};
static const float actor_encoder_self_encoder_2_bias[16] = {0.014948728494346142,0.06739465147256851,0.0459180548787117,-0.044117286801338196,-0.04801294952630997,0.07447858899831772,-0.04119032248854637,-0.08347690850496292,0.03495117649435997,-0.01529333833605051,-0.021243928000330925,-0.0032118898816406727,-0.002713636728003621,-0.0786215215921402,0.03963901475071907,-0.07846122980117798};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05562208592891693,-0.009457666426897049,-0.07435191422700882,0.041022416204214096,0.012673573568463326,0.020256944000720978,-0.04613107070326805,-0.054434407502412796,-0.012446478940546513,-0.021329661831259727,0.013073953799903393,0.018867891281843185,-0.0035991023760288954,-0.025079064071178436,0.02556188963353634,-0.07417099922895432,-0.00919007696211338,-0.03388603404164314,0.015107894316315651,-0.0720667615532875,0.015801861882209778,-0.008349503390491009,0.019857292994856834,-0.06469597667455673,-0.06787116080522537,0.06811293214559555,0.026926908642053604,-0.020096013322472572,0.05852043256163597,0.0027747813146561384,-0.019768044352531433,0.04652693122625351};
static const float action_parameterization_distribution_linear_bias[4] = {0.037600286304950714,0.05615606531500816,-0.005918401293456554,0.03876102343201637};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3217602074146271,-0.2142503410577774,-0.09110322594642639,0.20211687684059143,-0.0975663810968399,0.0795215293765068,-0.2582451403141022,-0.005902592092752457},{0.05746755003929138,0.1298649162054062,0.33844465017318726,0.35147717595100403,-0.10742704570293427,-0.2676597535610199,0.3218461275100708,0.20552091300487518},{-0.0019459588220342994,0.21757872402668,0.08562669903039932,-0.058095842599868774,0.32948049902915955,0.2475307434797287,-0.024067239835858345,0.12565089762210846},{0.06669364124536514,-0.26047223806381226,0.30351555347442627,-0.2348911613225937,-0.2557063400745392,0.05130579322576523,0.22578208148479462,0.19965848326683044},{-0.23910154402256012,0.01828327775001526,-0.07184775918722153,-0.3385829031467438,0.07886356115341187,0.04329119622707367,0.2864927649497986,0.25526461005210876},{-0.049838822335004807,0.3260859251022339,-0.07511395215988159,-0.2772892415523529,0.2130833864212036,0.004584065638482571,0.06464797258377075,-0.1782439649105072},{0.004612871445715427,0.32424601912498474,0.12872517108917236,-0.20554138720035553,0.2921735942363739,-0.24140679836273193,0.18052248656749725,0.09181483089923859},{0.0778980627655983,-0.19910244643688202,-0.02561136707663536,-0.20448647439479828,0.3014380633831024,-0.14739830791950226,-0.07581982761621475,-0.3018905520439148},{-0.1673544943332672,0.33457574248313904,0.06619387865066528,-0.05835998058319092,0.038509663194417953,0.22718167304992676,0.43089091777801514,0.38434720039367676},{0.06659966707229614,-0.015393737703561783,-0.28680169582366943,0.30585360527038574,0.29666516184806824,0.1605076789855957,0.25728318095207214,-0.2578342854976654},{-0.1207934245467186,-0.2985231876373291,0.34186241030693054,0.18649141490459442,0.0015316709177568555,-0.3514387905597687,-0.08415623754262924,-0.33713796734809875},{0.3036211431026459,0.07398402690887451,0.38812056183815,0.3958929181098938,-0.1412345916032791,0.2475961446762085,0.12544159591197968,-0.3671356737613678},{-0.31916865706443787,0.15923213958740234,-0.3286919891834259,0.40654486417770386,-0.02499663643538952,0.3173038065433502,0.0082602109760046,0.24502618610858917},{-0.010535364039242268,0.20726926624774933,-0.08954744786024094,-0.1430147886276245,0.0395861379802227,0.0433925986289978,0.2986966073513031,0.009943841025233269},{0.17324642837047577,-0.2867527902126312,-0.2924809455871582,-0.17911753058433533,0.19570963084697723,-0.20979413390159607,0.19837309420108795,-0.05988290160894394},{-0.3977048099040985,-0.33969545364379883,-0.2263379544019699,0.022536052390933037,0.053592659533023834,0.14887027442455292,0.28361716866493225,0.009973322972655296},{-0.16902920603752136,-0.23598675429821014,0.18351002037525177,-0.3453769087791443,0.10410688817501068,0.05080912262201309,-0.3853798508644104,-0.18958139419555664},{0.04780622199177742,0.24408087134361267,0.07190871238708496,0.15901866555213928,-0.03898482397198677,0.33765241503715515,0.3044944703578949,-0.14105916023254395},{0.01739322394132614,-0.3238362967967987,-0.1596229523420334,-0.052923914045095444,-0.0494498647749424,-0.3424145579338074,0.10631977766752243,-0.22954943776130676},{-0.088230200111866,-0.013858161866664886,0.007813174277544022,-0.2925971746444702,0.11738420277833939,0.10544008761644363,0.1803046464920044,-0.038605738431215286},{0.04829026386141777,-0.09039973467588425,-0.005660621449351311,-0.1829184591770172,0.05116011202335358,-0.04075860604643822,0.12712444365024567,-0.15459875762462616},{-0.33476051688194275,0.15615518391132355,0.11289109289646149,-0.2607249319553375,-0.3921271562576294,-0.027769505977630615,0.26516908407211304,0.05998086929321289},{0.2724103331565857,0.06716866046190262,-0.4289715588092804,0.016628148034214973,-0.03121776320040226,0.20895887911319733,0.31417691707611084,0.3449554741382599},{0.009699055925011635,-0.19430243968963623,-0.03894504904747009,0.13592010736465454,-0.3085755407810211,-0.08310462534427643,-0.1455674171447754,-0.256625235080719},{0.12936846911907196,-0.06419380009174347,-0.3972845673561096,0.3127289414405823,-0.310283362865448,-0.1444406807422638,-0.40866583585739136,0.12943536043167114},{-0.025129182264208794,0.32018816471099854,-0.22031091153621674,-0.121415875852108,0.10150305926799774,-0.13483767211437225,0.29428526759147644,-0.2890239655971527},{-0.1106986552476883,0.09351228177547455,-0.08518689125776291,-0.26333197951316833,0.051604874432086945,-0.12419979274272919,-0.13070407509803772,-0.11907444894313812},{0.0826246440410614,-0.1496066004037857,0.038068342953920364,-0.1459818035364151,0.08874426037073135,0.06999369710683823,-0.20837372541427612,0.10388285666704178},{0.24531349539756775,0.0326855331659317,-0.3039551377296448,-0.2515019476413727,-0.19527019560337067,0.15544602274894714,0.2207716852426529,0.06509564071893692},{0.31352439522743225,-0.3462463319301605,0.05515189841389656,-0.08333750814199448,0.12156091630458832,-0.11297127604484558,0.1791669726371765,0.31127890944480896},{-0.2700750529766083,-0.19880962371826172,0.09235738962888718,-0.3770228922367096,0.2881382405757904,-0.29838842153549194,-0.007822690531611443,0.09967613220214844},{0.21629701554775238,0.16441456973552704,-0.03681211546063423,0.22953549027442932,0.04897875338792801,-0.07849777489900589,-0.020547322928905487,0.0889134332537651}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23340827226638794,0.41346049308776855,-0.506685733795166,-0.5467005372047424,-0.21778541803359985,-0.07705339044332504,-0.41941162943840027,0.5603882074356079},{-0.06586549431085587,0.4902307689189911,-0.2591434419155121,0.6294535994529724,-0.04794244468212128,-0.02401098608970642,-0.3485749363899231,0.02892998233437538},{-0.37794479727745056,-0.16772152483463287,-0.1043148785829544,-0.07531197369098663,0.45652613043785095,0.2401183396577835,-0.04987623915076256,0.40935492515563965},{-0.5095516443252563,-0.5442549586296082,0.33485326170921326,0.324880450963974,-0.4726947546005249,-0.2259359061717987,0.4059252440929413,0.21791549026966095},{-0.3060248792171478,-0.2542373836040497,-0.3204629123210907,-0.22071616351604462,0.3284878730773926,-0.24921825528144836,0.4890853464603424,-0.3992369771003723},{-0.04171661287546158,0.23945072293281555,0.17130376398563385,-0.5225887298583984,0.572303831577301,-0.2585802674293518,-0.4799564778804779,-0.4080309569835663},{-0.3153051733970642,0.14997273683547974,0.09210961312055588,-0.4996747672557831,0.015500317327678204,-0.5064802765846252,0.5042086839675903,0.0277557410299778},{-0.38597968220710754,-0.16030198335647583,-0.12488125264644623,-0.3249904215335846,-0.3616935908794403,0.12614406645298004,0.565027117729187,-0.2972985506057739}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.004020672757178545,-0.14345812797546387,-0.13020983338356018,0.016428975388407707,0.14156746864318848,0.052230268716812134,0.09142295271158218,0.062372174113988876};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.03140588477253914,-0.03400801122188568,-0.006192666944116354,-0.10574112832546234,-0.0753866657614708,-0.07270228862762451,0.018269529566168785,-0.16444909572601318};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

