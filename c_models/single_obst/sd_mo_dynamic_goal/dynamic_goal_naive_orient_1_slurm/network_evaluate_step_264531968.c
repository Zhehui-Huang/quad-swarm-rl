#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.28133562207221985,-0.08949296176433563,0.27441906929016113,0.1575382649898529,-0.3202694058418274,0.26501351594924927,-0.06504873186349869,-0.15600717067718506,0.1387987732887268,0.28288209438323975,0.11646737158298492,0.04483707994222641,0.25891396403312683,-0.24801383912563324,0.258543461561203,-0.05984562262892723},{-0.17795103788375854,-0.3582286834716797,0.33291923999786377,0.15008386969566345,-0.26893579959869385,0.15782149136066437,-0.4135293662548065,-0.021649258211255074,-0.09232775866985321,-0.2057885378599167,0.04091409221291542,-0.22795796394348145,-0.00024105535703711212,-0.33110836148262024,-0.26102882623672485,0.09330321103334427},{-0.033425845205783844,-0.2572965621948242,-0.3755630850791931,0.1546040028333664,0.1997658610343933,0.48949918150901794,0.07029878348112106,-0.060751773416996,0.02498176135122776,-0.4521275460720062,-0.4009460508823395,0.7136441469192505,-0.15819290280342102,-0.2776266038417816,-0.34464940428733826,0.24017377197742462},{0.13711492717266083,0.2559293508529663,0.37663987278938293,-0.02192552015185356,-0.43185725808143616,-0.006671244278550148,0.2845509946346283,0.05226140469312668,0.3049124479293823,-0.38753005862236023,0.008581866510212421,0.4271514117717743,-0.25161075592041016,0.06268228590488434,0.45457717776298523,-0.45916542410850525},{-0.09477375447750092,-0.0377366878092289,0.316692590713501,-0.027364112436771393,0.3402480185031891,0.4428306519985199,0.23973895609378815,-0.0023043074179440737,0.12024377286434174,0.2101888656616211,0.29880547523498535,-0.3486402928829193,-0.28527501225471497,-0.4133017361164093,0.4299006462097168,0.08572081476449966},{-0.19154447317123413,-0.19739817082881927,-0.1877971589565277,-0.0936397910118103,0.13740265369415283,0.1515950709581375,0.0760016143321991,-0.14585739374160767,0.3530958592891693,-0.3402043581008911,-0.4236959218978882,0.23546651005744934,0.17944851517677307,-0.12588728964328766,-0.05670619755983353,0.06143645569682121},{0.049107786267995834,0.028814401477575302,0.06202453374862671,-0.4725567400455475,0.20151017606258392,-0.04555221274495125,0.09385102242231369,0.3966488242149353,0.32961317896842957,0.07620684057474136,-0.4388236403465271,-0.012695956975221634,-0.02490735799074173,0.14268380403518677,-0.18250301480293274,-0.2387462556362152},{-0.2880541682243347,0.33380573987960815,0.31928902864456177,0.4205447733402252,-0.4696495234966278,-0.04761473461985588,0.491502583026886,0.48803991079330444,-0.1969103366136551,0.36812955141067505,-0.6594103574752808,-0.35327646136283875,0.369418203830719,0.17965362966060638,0.2840968072414398,0.38837510347366333},{0.33445048332214355,-0.29046985507011414,0.6300550103187561,0.129108265042305,0.025023261085152626,0.06987837702035904,0.18214908242225647,-0.5381683111190796,-0.13507810235023499,-0.466808557510376,-0.15637478232383728,-0.044825512915849686,-0.14942200481891632,0.6469324231147766,0.4914263188838959,-0.30494266748428345},{0.23272618651390076,-0.6006131172180176,-0.5974297523498535,-0.26329106092453003,-0.21928244829177856,0.2525360584259033,0.18363632261753082,0.20452134311199188,0.6098079085350037,0.2729990482330322,0.15774407982826233,-0.30202361941337585,-0.07071918994188309,0.3665888011455536,-0.17375117540359497,-0.5088385939598083},{0.20248419046401978,0.3408828675746918,0.45003750920295715,-0.6507211923599243,-0.3656547963619232,0.09696196764707565,0.18116426467895508,0.43726402521133423,-0.3737642765045166,0.051236335188150406,-0.1413365602493286,0.00768915144726634,-0.17132924497127533,-0.20156492292881012,0.2872147262096405,-0.36078113317489624},{-0.05450882390141487,-0.3787652254104614,0.18463197350502014,0.5343368053436279,0.7262392044067383,0.43813782930374146,0.35055381059646606,0.40464290976524353,0.01175172720104456,0.041353192180395126,0.24035745859146118,-0.4307304918766022,-0.5316876769065857,-0.46680790185928345,0.6518011689186096,0.006364546716213226},{-0.2923945188522339,0.4378201365470886,-0.02310117520391941,-0.6014461517333984,0.14268752932548523,0.05143091827630997,0.1985515058040619,0.15701812505722046,0.07460388541221619,0.0811680480837822,-0.004522377625107765,0.19820135831832886,0.43928098678588867,0.3532875180244446,-0.052157651633024216,-0.12238576263189316},{0.06998147070407867,-0.3842294216156006,-0.2568119764328003,-0.15529745817184448,-0.4708316922187805,0.020359892398118973,-0.23203861713409424,-0.2519669532775879,-0.20084470510482788,-0.08534500002861023,-0.41949477791786194,0.009538651444017887,-0.22499850392341614,0.5042015314102173,0.21684473752975464,-0.03198652341961861},{0.06739789992570877,-0.3326050043106079,-0.22775572538375854,0.19997413456439972,-0.1058727353811264,-0.4721836447715759,0.2823902666568756,-0.06179187819361687,0.006132112350314856,0.3285459876060486,0.0967242494225502,0.053725648671388626,0.30695852637290955,-0.04211164265871048,-0.3202056884765625,0.2308904379606247},{0.35345005989074707,0.01891772821545601,-0.21962104737758636,-0.2103513479232788,-0.328718364238739,0.20788609981536865,0.3381580412387848,-0.08280416578054428,0.19272634387016296,0.35784822702407837,-0.14955000579357147,0.06681974232196808,-0.22839988768100739,0.26059454679489136,-0.10102052986621857,-0.014092295430600643},{-0.22053158283233643,-0.20156307518482208,0.21999980509281158,0.1381203830242157,-0.2149965614080429,0.1087513342499733,-0.22682563960552216,-0.1261415183544159,-0.23376446962356567,-0.2657683193683624,-0.08316612988710403,-0.2701084315776825,0.11050278693437576,-0.23774799704551697,0.027974069118499756,-0.2068028748035431},{-0.2742251455783844,0.21985693275928497,-0.3631158769130707,-0.22330930829048157,0.027263512834906578,0.35761576890945435,-0.2457168698310852,-0.2438763678073883,0.18361279368400574,0.15706074237823486,0.35231903195381165,-0.0998186320066452,-0.38429200649261475,0.33253946900367737,0.025063099339604378,-0.43507474660873413}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05352039262652397,-0.03193163126707077,-0.10816091299057007,-0.3356976807117462,0.33187299966812134,0.2976331114768982,0.09246855229139328,0.0426633283495903,-0.11487536877393723,-0.14417770504951477,-0.029509948566555977,0.07801908999681473,0.2010185867547989,0.37295421957969666,0.08456555753946304,0.07749418169260025},{-0.20167163014411926,-0.29897838830947876,-0.04557871073484421,0.0816461369395256,0.2331206202507019,-0.3321443796157837,0.06526307016611099,0.05783628672361374,-0.08239848166704178,0.24837200343608856,-0.23863382637500763,0.30884790420532227,-0.3625429570674896,0.20405852794647217,-0.3969043791294098,-0.3401779234409332},{0.09496001899242401,0.22068007290363312,-0.358243465423584,-0.5160410404205322,0.159275084733963,0.49333563446998596,-0.08927344530820847,0.07212992012500763,-0.25991058349609375,-0.29607799649238586,-0.0033508657943457365,0.33538249135017395,-0.31408601999282837,-0.20857779681682587,0.11080963909626007,-0.07841619849205017},{0.18811321258544922,-0.0511348731815815,0.06878910213708878,0.19275090098381042,-0.5171814560890198,0.007149694953113794,0.08750226348638535,-0.19018827378749847,0.3112533390522003,0.3629874885082245,-0.18172991275787354,-0.11971263587474823,-0.4424263536930084,-0.4307362735271454,0.16426941752433777,0.17481830716133118},{-0.13028529286384583,0.13023611903190613,-0.008410867303609848,0.2527924180030823,-0.23748455941677094,0.06394448131322861,0.0014592757215723395,0.1366741955280304,0.282921701669693,-0.3014480769634247,0.197005495429039,0.3044276535511017,0.2032480388879776,-0.4452945291996002,0.03715532645583153,-0.0048716687597334385},{0.23862718045711517,0.2559531033039093,-0.044833749532699585,0.19144031405448914,-0.47515374422073364,-0.4162371754646301,0.2475101351737976,0.2811133861541748,0.12220553308725357,0.3614133894443512,0.24070879817008972,-0.22269758582115173,-0.022207003086805344,-0.15317757427692413,-0.045759543776512146,0.29266953468322754},{-0.10071466118097305,0.2706264555454254,0.2802823483943939,-0.3768603801727295,-0.2510172426700592,0.01551253255456686,-0.3501893877983093,-0.07355818897485733,0.1676110476255417,0.07887905836105347,-0.1520758420228958,-0.1956322193145752,-0.3345956802368164,-0.02310977876186371,0.21730965375900269,0.032244931906461716},{-0.18537728488445282,-0.14277678728103638,-0.49221187829971313,0.3041929304599762,-0.3401297330856323,-0.26365208625793457,-0.25086069107055664,-0.41595783829689026,0.13931559026241302,-0.2803499400615692,0.03152533993124962,0.11485856771469116,-0.1776096522808075,0.4391710162162781,-0.07201052457094193,-0.3657730221748352},{-0.3305266201496124,0.2754877507686615,0.0013766894116997719,-0.013118645176291466,0.268379807472229,-0.28199687600135803,0.3278537690639496,0.14736536145210266,0.33279576897621155,0.3024006187915802,0.2643395960330963,0.3188893795013428,0.18430040776729584,-0.04967538267374039,0.2786363959312439,0.1117381900548935},{0.04618123546242714,-0.2704668641090393,-0.18781186640262604,-0.10543976724147797,0.27991437911987305,-0.183465838432312,-0.29688745737075806,-0.178127259016037,0.08072872459888458,-0.3845156729221344,-0.28583627939224243,0.35923051834106445,0.12309642881155014,0.16220054030418396,-0.3839562237262726,0.2355520874261856},{-0.08618099987506866,-0.45831048488616943,0.3301358222961426,0.3157842457294464,0.22893917560577393,0.15799996256828308,0.19944673776626587,-0.1514267772436142,0.2650855779647827,-0.313761830329895,0.21547351777553558,0.402185320854187,0.5137664675712585,0.10851447284221649,-0.1272886097431183,0.10507045686244965},{0.06348107755184174,0.006343971937894821,0.39520499110221863,-0.013547214679419994,-0.2540140748023987,-0.1806156188249588,0.4390169382095337,0.2882620096206665,-0.26283788681030273,-0.20085899531841278,-0.09294554591178894,-0.32162755727767944,-0.0345878079533577,-0.2933959364891052,-0.38577795028686523,0.048511844128370285},{-0.09181677550077438,-0.3109428882598877,0.4076671302318573,-0.22555235028266907,0.3551284670829773,-0.3039138913154602,-0.4679287374019623,0.09297772496938705,0.07474891096353531,0.07735846936702728,-0.345866322517395,0.1236686110496521,0.08470892906188965,-0.28931838274002075,-0.4049575924873352,-0.010698871687054634},{0.34757688641548157,-0.3402857780456543,0.4676556885242462,0.07672534137964249,-0.06817219406366348,0.3167167603969574,-0.10431742668151855,-0.24067065119743347,-0.43310609459877014,0.11647478491067886,0.008502381853759289,-0.36101365089416504,-0.0921899676322937,0.13997571170330048,0.3160603642463684,0.044895924627780914},{-0.1066957339644432,0.2349286526441574,0.11743704229593277,-0.42616111040115356,-0.22006985545158386,0.19105173647403717,0.2847578227519989,-0.24258758127689362,0.1926657259464264,-0.34087905287742615,0.03843563050031662,0.10043878853321075,-0.05741782858967781,0.1793954223394394,0.015801800414919853,0.09010954201221466},{-0.20794938504695892,0.3977256417274475,-0.4234171509742737,0.37106090784072876,0.1409197300672531,-0.41950592398643494,-0.03698064014315605,-0.08441424369812012,-0.31346288323402405,0.3687877655029297,-0.3514084219932556,0.30916011333465576,-0.06556052714586258,-0.3091735243797302,-0.2569434344768524,-0.5055522918701172}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.18422263860702515,0.1387905478477478,-0.04507044330239296,-0.04634750261902809,-0.12480941414833069,0.05097896605730057,0.28098422288894653,0.09883137047290802,-0.21844930946826935,-0.16565880179405212,0.1672634780406952,-0.3075118362903595,-0.2486032098531723,0.22312183678150177,0.24054975807666779,0.33223193883895874,-0.26515787839889526,-0.2858729362487793,-0.2001941055059433,0.10630720108747482,-0.07736871391534805,-0.2939381003379822,-0.20896203815937042,-0.3099176585674286,-0.28215479850769043,0.1936464160680771,-0.18825042247772217,-0.0010290765203535557,-0.017819352447986603,-0.03663817048072815,0.23243021965026855,-0.2270297408103943},{0.276031494140625,0.17319056391716003,0.16096316277980804,-0.12319903075695038,0.16440246999263763,-0.1124010682106018,0.40410712361335754,0.1307252198457718,-0.16335530579090118,-0.09252315014600754,-0.12252494692802429,-0.2949507236480713,-0.1653413623571396,0.2665257453918457,-0.2491474598646164,-0.21309123933315277,-0.022463789209723473,0.22813212871551514,-0.3833049237728119,-0.23330403864383698,-0.04991082102060318,0.256166011095047,0.041243940591812134,0.015809904783964157,0.21100646257400513,-0.35166987776756287,-0.05120106786489487,0.09543302655220032,0.1772463023662567,-0.13649214804172516,-0.034854065626859665,0.1716376692056656},{0.13850544393062592,0.03307404741644859,-0.17335446178913116,0.14845019578933716,-0.1829659640789032,-0.18148446083068848,-0.20356473326683044,0.03873482346534729,-0.15606485307216644,0.40692007541656494,-0.2927839159965515,-0.30529651045799255,0.09686269611120224,-0.3989280164241791,-0.1645483523607254,0.1062517762184143,-0.13560736179351807,-0.14970077574253082,0.15593673288822174,-0.1433665156364441,0.24487513303756714,0.2915602922439575,-0.229305699467659,0.01230628602206707,-0.281325101852417,0.009778334759175777,0.13796010613441467,-0.09505470097064972,-0.011949329636991024,-0.27882105112075806,-0.1568816602230072,-0.07287373393774033},{0.44546666741371155,0.053916722536087036,0.1728784739971161,-0.14279574155807495,-0.30129215121269226,-0.056264180690050125,-0.198774516582489,0.3172653317451477,0.2479087859392166,-0.3210746943950653,-0.06629959493875504,0.35145601630210876,0.09484286606311798,-0.09674622863531113,-0.215269073843956,0.28352096676826477,-0.3124258518218994,0.23063619434833527,0.07834013551473618,0.1408669799566269,-0.052700355648994446,-0.15371520817279816,0.30952566862106323,0.15537597239017487,0.2076389193534851,-0.4072478115558624,0.29589173197746277,-0.2281104028224945,-0.06783462315797806,0.14879195392131805,-0.20515583455562592,0.17497892677783966},{-0.06144430860877037,-0.09287693351507187,-0.12351422011852264,0.15779675543308258,0.19267375767230988,-0.2085406631231308,-0.4342957139015198,-0.09433849155902863,-0.0893210619688034,-0.2575419247150421,0.10213576257228851,0.25058817863464355,-0.02040603570640087,-0.14052273333072662,-0.10037026554346085,0.12067828327417374,-0.07591791450977325,-0.09549569338560104,-0.3229495584964752,-0.17836883664131165,-0.10729457437992096,-0.41690516471862793,0.15339843928813934,0.16613495349884033,-0.12138712406158447,0.36283189058303833,-0.1934794932603836,0.14327917993068695,0.3577035069465637,0.37804898619651794,-0.09656360745429993,0.41267043352127075},{-0.3321066200733185,0.045045506209135056,-0.2752309739589691,-0.07580240815877914,-0.23910170793533325,0.26742812991142273,0.2238186150789261,0.04483786225318909,0.20924779772758484,0.2638745903968811,0.370257169008255,-0.2565349340438843,-0.310507208108902,0.16976317763328552,0.36707261204719543,-0.309411883354187,-0.1519603431224823,-0.2622884213924408,0.21877574920654297,0.11613548547029495,0.08888887614011765,0.21398627758026123,0.12024301290512085,-0.09604890644550323,-0.3935260772705078,0.39897215366363525,-0.11566456407308578,0.2315552532672882,0.38122090697288513,0.1486131250858307,0.05594911426305771,0.010522043332457542},{0.21899783611297607,-0.14271388947963715,-0.12949852645397186,-0.36108317971229553,-0.06676744669675827,0.2143077403306961,0.3339746594429016,0.20122389495372772,0.06422017514705658,0.396366149187088,-0.008775085210800171,-0.025759382173419,-0.45107099413871765,-0.17934274673461914,-0.1556261032819748,0.1766916662454605,-0.3123398423194885,-0.23578211665153503,0.20836924016475677,-0.07188638299703598,-0.1306178867816925,-0.1447230875492096,-0.2105603814125061,-0.20155774056911469,0.1701621413230896,-0.278706431388855,-0.08033900707960129,-0.2330896258354187,0.2972061038017273,0.07966285198926926,-0.18191379308700562,-0.31151220202445984},{0.009492449462413788,0.16129526495933533,0.039010610431432724,-0.03999640420079231,0.12753160297870636,-0.3477632701396942,-0.0904177650809288,-0.18497277796268463,-0.028363805264234543,-0.2007008045911789,-0.3293108344078064,-0.08764559030532837,-0.11917386949062347,0.0008953653159551322,-0.13305464386940002,0.3914366066455841,-0.04309426620602608,-0.17716075479984283,0.083480104804039,0.3330738842487335,-0.11709509044885635,-0.2332325428724289,0.26902464032173157,0.10459455847740173,-0.04509565979242325,-0.3214004337787628,-0.3198414742946625,-0.32108139991760254,-0.34163302183151245,-0.2988077700138092,0.017201697453856468,-0.3245636522769928},{0.1109067052602768,0.36866286396980286,-0.2653373181819916,-0.35401636362075806,-0.2415357381105423,0.11704757809638977,0.05636420473456383,0.11237300932407379,0.0870894193649292,-0.30955949425697327,-0.1508818417787552,0.34477952122688293,-0.27318769693374634,-0.18202683329582214,0.2128947228193283,-0.2694511413574219,0.28536009788513184,0.17921298742294312,0.3916148245334625,0.03445406258106232,0.1752627193927765,0.10876847803592682,0.28479504585266113,-0.11926957964897156,0.4026173949241638,-0.2618919610977173,0.15777549147605896,0.3611711263656616,-0.2980211675167084,0.22699253261089325,0.04224858060479164,0.14154236018657684},{-0.1898149847984314,0.10583887994289398,-0.2669662535190582,-0.1615900695323944,0.19112847745418549,-0.18550318479537964,0.11793510615825653,-0.012519115582108498,0.15975719690322876,-0.01841593161225319,-0.29803523421287537,-0.3276776373386383,-0.33999255299568176,-0.05581163987517357,-0.2631527781486511,0.11300532519817352,0.048219822347164154,-0.20757295191287994,0.22433382272720337,0.11965446919202805,0.01582406461238861,-0.021332092583179474,0.2850179374217987,-0.18100693821907043,0.31050097942352295,0.11100497096776962,-0.27585917711257935,0.004176519811153412,-0.03118789754807949,0.09686556458473206,-0.1518314927816391,0.07178997993469238},{0.12257889658212662,0.0761551707983017,0.19236759841442108,-0.29249170422554016,-0.3949555456638336,-0.23494037985801697,-0.2946757674217224,0.061860643327236176,-0.29225438833236694,0.4627678096294403,0.20436495542526245,-0.20295816659927368,-0.4335293173789978,-0.1179967075586319,-0.14994603395462036,-0.08309424668550491,0.1638893038034439,-0.18477597832679749,0.3348037302494049,-0.12363637983798981,-0.15966680645942688,0.005837096832692623,0.2516271471977234,0.20778577029705048,0.18572115898132324,-0.1874597668647766,0.05922027677297592,-0.09405235201120377,-0.04607883468270302,0.0336800292134285,-0.02427263930439949,0.13858279585838318},{-0.1550484597682953,-0.10213349014520645,0.22258836030960083,0.28586822748184204,0.2610883414745331,-0.014417042955756187,0.056378256529569626,-0.20214521884918213,-0.05093459039926529,-0.28891313076019287,0.27083319425582886,-0.20164474844932556,-0.18386518955230713,-0.19861850142478943,0.26259317994117737,-0.008430344983935356,0.006571464706212282,0.03217519447207451,0.3848637640476227,0.06580270826816559,-0.18634063005447388,0.22854769229888916,0.11320741474628448,-0.07085683196783066,0.25145429372787476,-0.12427842617034912,-0.15772651135921478,0.2245936542749405,0.15336953103542328,0.03751702979207039,-0.2701430320739746,-0.22852657735347748},{0.35947105288505554,-0.2472030520439148,0.0253970455378294,-0.2656405568122864,-0.09492222219705582,-0.19490087032318115,0.02079189009964466,0.20387856662273407,0.1925191730260849,0.07577911764383316,0.20840680599212646,0.35117119550704956,-0.43117591738700867,-0.4701080620288849,0.01415394525974989,-0.24061554670333862,-0.3176611363887787,-0.3881182074546814,0.4062647521495819,-0.17564168572425842,0.41814354062080383,-0.17797571420669556,0.07609973847866058,0.17397522926330566,0.1538907289505005,-0.1635725498199463,0.1739548146724701,-0.02156793139874935,0.1348915547132492,0.05997750163078308,-0.3081018924713135,0.07429797947406769},{0.2791348695755005,-0.04728339985013008,0.005945654585957527,0.37695419788360596,-0.10193602740764618,-0.1943223923444748,-0.05636513605713844,0.1647365540266037,0.20564451813697815,0.2568246126174927,0.12059525400400162,-0.08964848518371582,0.0705862045288086,0.19274084270000458,-0.11244170367717743,0.10813786834478378,0.22577689588069916,-0.2529853284358978,0.12486417591571808,-0.35759276151657104,0.28494641184806824,0.1291964203119278,-0.10228559374809265,0.2079036831855774,0.2531377375125885,0.07033505290746689,0.14955782890319824,0.05933807045221329,0.0913400873541832,-0.1249348446726799,0.013593058101832867,0.3904934525489807},{0.04708649218082428,-0.18316423892974854,-0.019611364230513573,0.0852695181965828,-0.28090500831604004,0.03545722737908363,0.054073892533779144,-0.19510823488235474,-0.20547261834144592,-0.03380449861288071,0.21958929300308228,0.18954135477542877,0.0568288154900074,0.2388896495103836,-0.01322624459862709,-0.027239521965384483,-0.20452415943145752,0.2940088212490082,-0.059144772589206696,-0.21792832016944885,-0.22631317377090454,-0.06012996286153793,0.173050656914711,0.02258968912065029,-0.018161602318286896,-0.12614521384239197,-0.15545789897441864,0.25440648198127747,0.07262932509183884,-0.1534113585948944,0.2961220443248749,0.13761241734027863},{0.1736738085746765,-0.20808084309101105,0.007284689228981733,-0.20795004069805145,-0.022712092846632004,0.1633480042219162,0.07210002839565277,0.28628528118133545,-0.13502949476242065,-0.016839081421494484,0.25234508514404297,0.1093369722366333,0.047901105135679245,-0.10448361933231354,-0.0008791311993263662,0.21713560819625854,-0.3523203432559967,-0.19850659370422363,-0.024555983021855354,0.06834211200475693,0.026842748746275902,0.27060818672180176,0.17796862125396729,0.17046146094799042,0.05535643547773361,0.17468439042568207,-0.005310514941811562,-0.052182938903570175,0.10843037813901901,-0.12105295062065125,-0.24495995044708252,0.3072288930416107},{0.1378442645072937,0.015696439892053604,-0.3791477382183075,0.10991012305021286,0.07189038395881653,-0.014123798348009586,0.36497166752815247,0.08742467314004898,0.09399048984050751,-0.12444158643484116,0.20225124061107635,-0.2841465473175049,-0.436761736869812,0.2860356867313385,0.07341457158327103,0.0740245133638382,0.018368439748883247,-0.07415453344583511,-0.18235406279563904,0.05552658811211586,-0.0709443911910057,0.2579708397388458,0.071527861058712,-0.16584338247776031,-0.08416437357664108,-0.20881859958171844,0.04674222692847252,0.3666030764579773,0.22149115800857544,-0.21981306374073029,0.2015424519777298,0.14628446102142334},{-0.057879816740751266,-0.004639401100575924,-0.06644199788570404,-0.09290085732936859,-0.23383009433746338,-0.021231940016150475,0.23799706995487213,0.18640142679214478,0.14626647531986237,-0.00965675339102745,0.1946883350610733,-0.004811882972717285,0.22954730689525604,0.21599988639354706,0.16385722160339355,-0.07314512878656387,0.13929057121276855,0.1936710774898529,0.22345352172851562,0.05339210107922554,0.16092465817928314,0.291164368391037,0.07157643139362335,0.1701945662498474,-0.007518800441175699,-0.09000147879123688,-0.13374227285385132,-0.22321882843971252,0.11735883355140686,-0.26507776975631714,0.054459553211927414,-0.08464782685041428},{-0.36844402551651,0.014336558990180492,-0.39551034569740295,-0.34082213044166565,0.022188834846019745,-0.02908850833773613,0.16324694454669952,-0.1917513757944107,0.06986355781555176,0.4078253209590912,0.008134331554174423,-0.27044445276260376,0.03629099577665329,-0.18966075778007507,-0.333866149187088,0.02696840837597847,-0.21253381669521332,0.1049158126115799,-0.12378527224063873,0.0010709414491429925,-0.28157731890678406,0.15731008350849152,0.11225174367427826,0.06866511702537537,-0.09985832870006561,0.3647172152996063,0.036866385489702225,-0.22837932407855988,-0.1893637627363205,-0.035035986453294754,-0.2517679035663605,-0.27988532185554504},{-0.007521378807723522,-0.26142093539237976,-0.28694096207618713,-0.05201961100101471,-0.31878066062927246,-0.15376941859722137,0.18747898936271667,-0.2818697392940521,-0.22806772589683533,0.18307192623615265,0.1804632991552353,0.07817557454109192,0.11086513102054596,-0.13607192039489746,0.2768824100494385,-0.2617571949958801,0.09525318443775177,0.2733769714832306,0.03833527863025665,0.2883189916610718,0.014836309477686882,-0.11334016174077988,-0.2905653119087219,0.23224897682666779,-0.11253950744867325,-0.15553969144821167,0.10870607197284698,0.037802211940288544,-0.12070965766906738,-0.33947789669036865,-0.040120795369148254,-0.19085799157619476},{0.2170976996421814,0.07736358046531677,-0.07058251649141312,0.23656946420669556,-0.2283259779214859,0.07271338999271393,-0.09165938943624496,-0.239278182387352,-0.05737409368157387,0.23540198802947998,-0.3775538504123688,-0.1513233333826065,0.06630055606365204,-0.191684290766716,-0.4119367003440857,-0.20456260442733765,-0.11559873074293137,-0.3278205692768097,-0.30082255601882935,0.2457599937915802,0.17935562133789062,0.05056411400437355,-0.4078468382358551,0.34522658586502075,0.12551528215408325,0.3199416697025299,-0.3591196835041046,-0.15025129914283752,0.09874891489744186,-0.21346189081668854,0.08119606971740723,0.1695929765701294},{-0.054924700409173965,-0.29365986585617065,-0.03973456844687462,-0.30814313888549805,-0.054998014122247696,0.3054506480693817,0.20637065172195435,0.030781805515289307,-0.11282909661531448,0.0006278914515860379,-0.1653541922569275,0.09146785736083984,0.09925545006990433,0.08008382469415665,0.12191195785999298,0.035875070840120316,-0.06073073670268059,0.16669346392154694,-0.11510081589221954,0.15448346734046936,0.1804800182580948,0.2691543400287628,-0.04589719697833061,-0.2505836486816406,0.1673736870288849,0.16267363727092743,0.2726300358772278,0.18016467988491058,0.02165030688047409,0.10618051886558533,0.027706794440746307,-0.1055460050702095},{-0.0012531488901004195,-0.22823694348335266,0.25957757234573364,0.05369597300887108,0.30742841958999634,-0.0555071160197258,-0.13853685557842255,-0.19529348611831665,0.16115140914916992,-0.042920149862766266,0.04953461512923241,0.014360124245285988,-0.25752925872802734,0.06215672194957733,-0.12099100649356842,-0.2738685607910156,-0.05126577243208885,-0.0495537593960762,0.1721709966659546,0.20866023004055023,0.040709834545850754,0.021823769435286522,0.14497515559196472,0.3283228576183319,-0.1711300164461136,-0.048505865037441254,0.14464910328388214,-0.1041552722454071,-0.15958137810230255,-0.24809174239635468,0.2806079387664795,0.018908895552158356},{0.20397986471652985,-0.06997306644916534,0.05547301471233368,0.10585059970617294,-0.039395757019519806,0.06776651740074158,-0.24345621466636658,0.3247210681438446,-0.12645506858825684,-0.049436409026384354,0.1305115520954132,-0.2933492958545685,0.027164435014128685,-0.05674948915839195,-0.10104991495609283,0.3369075655937195,-0.0719914436340332,-0.17501451075077057,0.050948210060596466,0.0168785210698843,-0.19099336862564087,0.1888403743505478,0.22215548157691956,0.23287880420684814,-0.2526502311229706,0.10372333228588104,-0.054367199540138245,0.09300920367240906,-0.2860882878303528,0.26423946022987366,-0.037931542843580246,0.037485603243112564}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.28974267840385437,-0.13812798261642456,0.17613233625888824,-0.20544099807739258},{0.2125968337059021,-0.2604052722454071,0.2754293382167816,0.24546334147453308},{-0.37517330050468445,0.0693095251917839,0.22010526061058044,-0.035055968910455704},{0.28500011563301086,0.5380224585533142,0.3360068202018738,0.03175564110279083},{-0.32226327061653137,0.2112264484167099,-0.31834930181503296,0.1257583647966385},{-0.011636273004114628,-0.1465742290019989,0.07923340797424316,0.4560195803642273},{-0.11275319755077362,-0.24055913090705872,-0.47617772221565247,0.03508531302213669},{-0.13275554776191711,-0.4123919606208801,0.23540644347667694,-0.05986041575670242},{-0.1453293114900589,0.19265013933181763,-0.07403063774108887,-0.1420208364725113},{0.3406510055065155,-0.03350649029016495,-0.1771346479654312,-0.2595605254173279},{0.2601171135902405,-0.27668601274490356,0.37984171509742737,0.2728424370288849},{-0.1084246039390564,0.02826507017016411,0.5418747663497925,-0.12609365582466125},{-0.37281328439712524,0.2954307496547699,-0.05446147546172142,-0.07571101933717728},{-0.21196429431438446,-0.002003169385716319,-0.2759593725204468,0.12405291944742203},{0.20523542165756226,-0.08134318888187408,0.2596380412578583,0.1479911506175995},{-0.14227774739265442,-0.31818369030952454,-0.13223475217819214,-0.10170654207468033},{-0.3857016861438751,0.082156702876091,-0.07570353895425797,0.37151795625686646},{-0.3456606864929199,-0.15059562027454376,-0.2596236765384674,0.258980393409729},{-0.08762595802545547,-0.19456243515014648,0.5071092844009399,0.0615890733897686},{-0.17122551798820496,-0.18576279282569885,-0.0416058786213398,-0.18811830878257751},{0.16618721187114716,0.1667708307504654,0.1778012216091156,-0.19754238426685333},{-0.023792032152414322,-0.3414326012134552,-0.21000005304813385,0.3790663778781891},{0.325732558965683,-0.21376392245292664,0.24341659247875214,0.05204471945762634},{-0.3346281349658966,-0.04094734787940979,-0.272035151720047,-0.377696692943573},{-0.31795811653137207,-0.1841205507516861,0.06125147268176079,-0.1332060992717743},{0.28070786595344543,0.2621043622493744,-0.13813677430152893,0.15317746996879578},{0.18302276730537415,-0.2204168140888214,0.2932814657688141,0.09286791831254959},{-0.056867506355047226,-0.18917404115200043,0.015677200630307198,0.3843024969100952},{0.13456928730010986,0.054069049656391144,0.05174832046031952,0.018701966851949692},{-0.19362029433250427,0.10539352148771286,0.3595717251300812,0.009874707087874413},{-0.21020027995109558,-0.15142343938350677,0.061198096722364426,0.2925145626068115},{0.21913650631904602,0.2543386220932007,0.3522922992706299,-0.052826955914497375}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.003306476166471839,-0.011634068563580513,0.0017969256732612848,0.04995386302471161,0.04943397641181946,-0.06415200233459473,-0.02750488929450512,0.07216548174619675,-0.09872687608003616,-0.027022631838917732,0.007556948810815811,-0.01692298986017704,-0.03414379805326462,0.07418088614940643,-0.0014777088072150946,-0.05302072688937187};
static const float actor_encoder_self_encoder_2_bias[16] = {0.006480702664703131,-0.010002907365560532,-0.009392269887030125,0.005862440448254347,-0.05269762873649597,0.028641974553465843,-0.027638258412480354,-0.008315077051520348,0.03234179690480232,-0.05061699077486992,0.012387138791382313,-0.02290494553744793,-0.006180678494274616,-0.02805975452065468,0.002307841321453452,-0.023767542093992233};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01821257919073105,0.04131748154759407,-0.0044716037809848785,-0.001558243646286428,-0.013311274349689484,0.023255283012986183,-0.031424835324287415,-0.0012923076283186674,0.001388084958307445,-0.030948828905820847,-0.004496790934354067,0.039261844009160995,0.02863716147840023,0.008466437458992004,0.029530208557844162,-0.033645279705524445,0.013826890848577023,-0.014042523689568043,0.02172146551311016,-0.024708665907382965,-0.014777346514165401,0.020813601091504097,-0.007702752947807312,-0.027375241741538048,-0.03476914018392563,-0.0014691936085000634,0.020377391949295998,0.026121575385332108,-0.03017346002161503,0.03660351410508156,0.033776335418224335,-0.012673073448240757};
static const float action_parameterization_distribution_linear_bias[4] = {-0.012448119930922985,0.008832166902720928,0.010102074593305588,0.022089935839176178};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3749587833881378,-0.3482847809791565,-0.15813341736793518,0.19679348170757294,-0.25017645955085754,0.09038586169481277,-0.33240005373954773,0.035879138857126236},{0.2009769082069397,0.14546675980091095,0.3970881700515747,0.37709879875183105,-0.1516389399766922,-0.36804288625717163,0.3223641812801361,0.4169926643371582},{0.0750134065747261,0.2110859453678131,0.11962809413671494,-0.03532838821411133,0.3260614275932312,0.20287226140499115,-0.0033486071042716503,0.27701273560523987},{0.11346200853586197,-0.31866806745529175,0.34452024102211,-0.15459492802619934,-0.23175323009490967,0.09529773890972137,0.33069732785224915,0.2830445170402527},{-0.26283952593803406,-0.04680711776018143,-0.04320162907242775,-0.2777431011199951,0.14612752199172974,0.12622642517089844,0.3503987193107605,0.3032672107219696},{-0.07538791000843048,0.23068314790725708,-0.0005114426021464169,-0.21456681191921234,0.3518544137477875,0.1290930062532425,0.12289676815271378,-0.1449478268623352},{-0.002181548858061433,0.2122359722852707,0.14665792882442474,-0.16178731620311737,0.44341519474983215,-0.1099090725183487,0.17118406295776367,0.12669919431209564},{0.06734422594308853,-0.3710725009441376,-0.04663653299212456,-0.24456271529197693,0.27870628237724304,0.016041146591305733,-0.15388350188732147,-0.3050353229045868},{-0.26517102122306824,0.21872815489768982,-0.03876449540257454,-0.11222932487726212,-0.04520835354924202,0.4353141486644745,0.3762313425540924,0.27957379817962646},{-0.008476875722408295,-0.10480053722858429,-0.2895206809043884,0.2598761320114136,0.26139718294143677,0.32511889934539795,0.35241445899009705,-0.32306066155433655},{-0.17109957337379456,-0.3515673875808716,0.35350123047828674,0.16445475816726685,-0.00495182303711772,-0.24748487770557404,0.05029000714421272,-0.33607590198516846},{0.22763122618198395,0.06425968557596207,0.39520278573036194,0.39120304584503174,-0.13243339955806732,0.33828338980674744,0.24757947027683258,-0.3363489508628845},{-0.3972679376602173,0.1646510362625122,-0.3598066568374634,0.4281690716743469,-0.036931343376636505,0.4343344271183014,0.06067875400185585,0.26854774355888367},{-0.06426234543323517,0.2118573784828186,-0.1396031379699707,-0.11809024959802628,0.0004775637062266469,0.13611356914043427,0.33995121717453003,0.02104761078953743},{0.11615852266550064,-0.2983079254627228,-0.34968888759613037,-0.166799396276474,0.12475696951150894,-0.17605559527873993,0.1558547168970108,-0.07307903468608856},{-0.4648953974246979,-0.30017927289009094,-0.2526428997516632,0.009678100235760212,-0.029279800131917,0.20848487317562103,0.25496017932891846,-0.050717953592538834},{-0.16103334724903107,-0.26221632957458496,0.2463705688714981,-0.3454892039299011,0.008395787328481674,0.008759778924286366,-0.4006846845149994,-0.23337385058403015},{0.0648273155093193,0.24458050727844238,0.1622665375471115,0.19769228994846344,-0.10060151666402817,0.3295373320579529,0.3087143898010254,-0.16506317257881165},{0.06116011366248131,-0.31795263290405273,-0.06060049310326576,-0.06929123401641846,-0.14633190631866455,-0.3401813209056854,0.06558490544557571,-0.278734415769577},{-0.035361312329769135,0.025333618745207787,0.12885446846485138,-0.31889206171035767,0.043190158903598785,0.1171504482626915,0.09993592649698257,-0.10515652596950531},{0.08912502229213715,-0.08030261844396591,0.086224265396595,-0.2732975482940674,-0.0058037894777953625,0.0013278246624395251,0.0010795253328979015,-0.22896744310855865},{-0.32309454679489136,0.21561658382415771,0.16330140829086304,-0.2501022219657898,-0.47383764386177063,0.01813516579568386,0.16491006314754486,0.020123491063714027},{0.2791772484779358,0.14211896061897278,-0.38627874851226807,0.121476911008358,-0.05701686069369316,0.2396734058856964,0.26700595021247864,0.3124676048755646},{-0.00964246317744255,-0.09647335857152939,0.020957697182893753,0.3138754665851593,-0.30388179421424866,-0.04573797434568405,-0.12268363684415817,-0.3015480935573578},{0.20773005485534668,0.11374819278717041,-0.417803555727005,0.34350061416625977,-0.2905804216861725,-0.33238208293914795,-0.30691900849342346,0.1945684254169464},{0.0400555245578289,0.3924930989742279,-0.28762513399124146,-0.05594152584671974,0.08087784796953201,-0.24026699364185333,0.35544127225875854,-0.2720050811767578},{-0.07764889299869537,0.09619642049074173,-0.15528357028961182,-0.15502353012561798,0.022411668673157692,-0.17717301845550537,-0.07183653861284256,-0.12693865597248077},{0.14131753146648407,-0.1598716527223587,-0.05376920849084854,-0.10342703759670258,-8.12438374850899e-05,0.014393738470971584,-0.1763182431459427,0.10576046258211136},{0.359846293926239,0.05928755924105644,-0.39265358448028564,-0.18791720271110535,-0.2531101703643799,0.11151658743619919,0.2545660436153412,0.10000200569629669},{0.40531018376350403,-0.2933173179626465,-0.024684127420186996,-0.034018415957689285,0.11539072543382645,-0.12412284314632416,0.2308163195848465,0.3661755621433258},{-0.25873619318008423,-0.1657760888338089,0.03460010886192322,-0.2657495141029358,0.31965377926826477,-0.2413121461868286,0.07342017441987991,0.08721345663070679},{0.15151478350162506,0.006195839028805494,-0.1587151736021042,0.30593109130859375,0.062352124601602554,0.03969528153538704,-0.009343346580862999,0.0022943115327507257}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2407684475183487,0.4096587598323822,-0.6267004609107971,-0.5873604416847229,-0.30396661162376404,0.04712720215320587,-0.44717657566070557,0.5637060403823853},{-0.03219588100910187,0.5341474413871765,-0.21539580821990967,0.5294073224067688,-0.006710817106068134,0.052290309220552444,-0.22459359467029572,0.02336812950670719},{-0.459799200296402,-0.21178527176380157,-0.16556169092655182,-0.23583285510540009,0.5350999236106873,0.20145614445209503,0.03531553968787193,0.44619888067245483},{-0.4758400321006775,-0.4917590618133545,0.3667450547218323,0.35753312706947327,-0.5171231627464294,-0.21242405474185944,0.521629810333252,0.20859116315841675},{-0.34042859077453613,-0.336510568857193,-0.325993150472641,-0.31260228157043457,0.35538992285728455,-0.3102092444896698,0.5448843240737915,-0.4827609062194824},{-0.0696115493774414,0.18021558225154877,0.32100051641464233,-0.5541622042655945,0.5327421426773071,-0.33206120133399963,-0.44583091139793396,-0.32816019654273987},{-0.4252295196056366,0.17989668250083923,0.07558450102806091,-0.3663100004196167,-0.034954436123371124,-0.5523200035095215,0.49094080924987793,0.051135629415512085},{-0.40941962599754333,-0.31540602445602417,-0.24624598026275635,-0.44615399837493896,-0.3460818827152252,0.13365823030471802,0.5562293529510498,-0.3042008876800537}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03757317736744881,-0.0044847773388028145,-0.006055057514458895,0.014029011130332947,-0.038634028285741806,-0.005913708824664354,-0.06227395310997963,0.03531205654144287};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0008189469226635993,-0.024825068190693855,-0.009585106745362282,0.05789538845419884,-0.03677797317504883,0.025806395336985588,-0.05029411241412163,0.02660171128809452};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

