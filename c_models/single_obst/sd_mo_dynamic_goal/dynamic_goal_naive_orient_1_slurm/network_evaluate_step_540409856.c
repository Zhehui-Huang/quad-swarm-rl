#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3221670389175415,0.03932441771030426,0.037059176713228226,0.2517527639865875,0.33855435252189636,-0.2345884144306183,-0.299186646938324,0.12516798079013824,0.354279100894928,-0.30245816707611084,0.4544399082660675,0.08093740791082382,0.2591747045516968,0.11356107890605927,-0.29680395126342773,0.01355267595499754},{-0.3390001952648163,-0.18997734785079956,-0.28997164964675903,-0.08266164362430573,0.19067129492759705,0.38977620005607605,0.17015667259693146,0.0013408904196694493,0.15855160355567932,0.2432052344083786,-0.10483023524284363,-0.004462216515094042,-0.10040847212076187,0.1026669293642044,0.2786390483379364,-0.2259325534105301},{-0.03427097573876381,0.23802311718463898,0.2250484973192215,0.31313708424568176,0.06232912465929985,-0.29491934180259705,0.827418327331543,-0.2714265286922455,-0.23171287775039673,0.03375915065407753,-0.011547373607754707,-0.23951442539691925,0.34163737297058105,0.6382217407226562,-0.5015785098075867,0.19013836979866028},{0.16161422431468964,-0.15897883474826813,-0.1481626182794571,-0.0361320935189724,-0.1793723851442337,0.0892244279384613,-0.04222865402698517,-0.22941552102565765,-0.002625728491693735,-0.13164879381656647,0.5984885692596436,-0.22388207912445068,-0.34731316566467285,-0.19639074802398682,0.21475139260292053,-0.06705883890390396},{-0.18763087689876556,-0.022002534940838814,0.18581350147724152,-0.42353975772857666,0.502223014831543,0.2270762324333191,0.24874809384346008,-0.20466744899749756,-0.19564397633075714,0.2954481542110443,-0.0767371729016304,-0.4462506175041199,0.016696512699127197,-0.22778239846229553,0.4362671375274658,-0.024190491065382957},{-0.02866271510720253,-0.11881166696548462,-0.06975338608026505,-0.062063511461019516,0.089183509349823,-0.25583547353744507,0.5958547592163086,-0.30578455328941345,-0.21670112013816833,-0.20076793432235718,0.17134898900985718,0.07892405986785889,0.32659071683883667,0.020130924880504608,0.30162304639816284,0.24993997812271118},{-0.16824805736541748,0.2641388773918152,-0.042707379907369614,0.08760938048362732,-0.28794577717781067,-0.1193993017077446,-0.08133380115032196,0.015924252569675446,0.3521791696548462,0.34264934062957764,-0.28867995738983154,-0.13543564081192017,0.264740914106369,-0.05393051728606224,-0.09705407172441483,0.24628771841526031},{-0.34361904859542847,0.17708639800548553,0.00833748560398817,-0.30914589762687683,0.38101667165756226,-0.2610384523868561,-0.35870498418807983,-0.49875637888908386,-0.06735363602638245,-0.22473269701004028,0.5513111352920532,0.15000829100608826,0.0019319760613143444,0.462827205657959,0.06259401887655258,0.6119402647018433},{0.2797688841819763,0.1260000616312027,-0.21024535596370697,0.041974108666181564,-0.617435872554779,-0.5812421441078186,0.17042481899261475,-0.5837354063987732,-0.04149005562067032,-0.1511569768190384,0.32208123803138733,-0.6043453216552734,-0.5359851121902466,0.09722958505153656,0.05870123580098152,-0.3167961835861206},{0.6816129684448242,-0.8152263164520264,-0.39042386412620544,0.14172208309173584,0.1697690784931183,-0.3394666612148285,-0.02736860141158104,-0.23500686883926392,-0.3883017599582672,-0.02592995949089527,-0.31529372930526733,-0.3262299597263336,0.5833298563957214,-0.31807199120521545,-0.751349687576294,-0.297019898891449},{0.29516708850860596,0.33328938484191895,-0.14642424881458282,0.07603257149457932,0.05525905638933182,-0.21177537739276886,-0.1183110699057579,0.13959558308124542,-0.026706593111157417,0.23442241549491882,0.20200486481189728,0.22476322948932648,-0.1319139450788498,0.1656835377216339,0.03524240851402283,-0.3506292700767517},{-0.44666987657546997,0.2890861928462982,0.5987260937690735,-0.895560085773468,0.11176040023565292,0.1423429548740387,0.13622838258743286,0.32908761501312256,0.35197576880455017,0.44332218170166016,0.4710436761379242,-0.3537619709968567,0.30951231718063354,-0.22448182106018066,0.07352183014154434,-0.21938855946063995},{0.14603005349636078,-0.2583242952823639,-0.24094733595848083,0.31295934319496155,-0.19773611426353455,-0.2693111300468445,-0.06586845219135284,0.348519891500473,0.2567008435726166,-0.13542743027210236,-0.2706902027130127,0.291812926530838,0.39387866854667664,0.3156118094921112,-0.18608899414539337,0.6147600412368774},{0.27243345975875854,0.28792256116867065,-0.3291822373867035,0.0953235849738121,-0.06295502185821533,-0.13280268013477325,-0.2523662745952606,0.17380934953689575,-0.2982564866542816,-0.3492080271244049,-0.09106983989477158,0.10746727883815765,-0.5756182670593262,-0.07651276886463165,-0.2716731131076813,-0.14160384237766266},{0.14663340151309967,0.5904460549354553,0.4298669695854187,-0.43517643213272095,-0.3253229856491089,0.24665841460227966,-0.06267835199832916,0.05463602393865585,0.5089576840400696,0.337471067905426,-0.2159326672554016,0.1348167359828949,-0.18133114278316498,-0.3459523022174835,0.18561406433582306,-0.33738207817077637},{-0.31434619426727295,-0.0635269358754158,-0.02775336615741253,0.2304319143295288,-0.024938663467764854,0.013184240087866783,-0.14053860306739807,-0.04295338690280914,-0.38073673844337463,-0.0872436985373497,0.27173343300819397,0.10115545988082886,-0.1971021592617035,-0.21540911495685577,-0.39413660764694214,-0.11242049187421799},{-0.29099541902542114,0.15540680289268494,-0.20931006968021393,0.009194914251565933,-0.1412595957517624,0.3250502347946167,0.31969940662384033,0.15417934954166412,0.23186682164669037,-0.2349407970905304,-0.05600503459572792,-0.1102791577577591,-0.010800118558108807,0.04190643131732941,-0.01675674319267273,-0.1458326280117035},{0.11188189685344696,-0.491866797208786,0.1540146768093109,0.177428737282753,0.013973157852888107,0.2921597957611084,0.33075204491615295,0.15007591247558594,-0.14695876836776733,-0.27516958117485046,-0.12378350645303726,-0.10399241745471954,-0.1153331771492958,-0.3725726306438446,0.0982092022895813,0.01774265430867672}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15640412271022797,0.3076571226119995,0.3528772294521332,-0.09404917061328888,-0.19412270188331604,0.06917599588632584,0.069748654961586,0.26300811767578125,-0.06028405576944351,0.28707507252693176,0.491566926240921,-0.3651990592479706,-0.12719495594501495,0.06521347165107727,0.017610911279916763,-0.03299136459827423},{-0.5550293922424316,0.21915748715400696,-0.31579867005348206,0.2605239450931549,0.3490656316280365,-0.14636076986789703,-0.355984628200531,-0.26869311928749084,0.29475876688957214,0.31041038036346436,-0.09903887659311295,0.2392311841249466,-0.3309886157512665,0.153291717171669,-0.2664552927017212,0.44087663292884827},{-0.4053099751472473,0.1851438730955124,-0.3699243664741516,0.023898212239146233,-0.4150085151195526,-0.3018489480018616,-0.11494028568267822,0.02658144198358059,-0.2452014684677124,0.3483564257621765,0.208719864487648,-0.06994203478097916,0.23632724583148956,-0.35549119114875793,-0.05741140618920326,0.014810774475336075},{0.24077047407627106,-0.22583121061325073,0.08485721051692963,0.44515228271484375,-0.45185020565986633,-0.34650716185569763,0.2687097489833832,0.11591590940952301,0.3040286898612976,-0.08568252623081207,0.3050491213798523,0.10806716978549957,-0.25994205474853516,-0.037022657692432404,-0.014318197034299374,-0.35021936893463135},{-0.35811182856559753,0.010825707577168941,0.2484908550977707,-0.36110952496528625,0.15305837988853455,0.3112848401069641,-0.3196484446525574,0.24307376146316528,-0.21933095157146454,0.19074924290180206,-0.12716346979141235,-0.011292724870145321,-0.13753151893615723,-0.013817228376865387,-0.1997242122888565,-0.21069885790348053},{0.005102531518787146,-0.2185879796743393,-0.02421828918159008,-0.35716551542282104,0.28807035088539124,0.08639559894800186,-0.02394094504415989,-0.09003173559904099,-0.20315977931022644,0.36610147356987,0.2982393503189087,-0.08488161116838455,-0.15379464626312256,0.2423609346151352,-0.056343693286180496,-0.36268314719200134},{0.21594075858592987,-0.14003217220306396,0.30179330706596375,-0.29950523376464844,-0.3714323341846466,-0.04992857202887535,-0.381131112575531,0.3461189866065979,-0.12115848809480667,-0.23434413969516754,-0.2753433287143707,-0.036904796957969666,-0.03847247362136841,-0.08706296235322952,0.4659613370895386,-0.3854696452617645},{-0.29659074544906616,0.389961302280426,-0.06431198120117188,0.2597516179084778,0.012751761823892593,-0.2359839528799057,-0.09779980778694153,0.10920622199773788,-0.03807075321674347,0.4968080520629883,0.15952175855636597,-0.22055421769618988,0.03761056810617447,-0.08803650736808777,0.06620871275663376,0.17513848841190338},{0.13933229446411133,0.28335416316986084,-0.16058756411075592,-0.3480105996131897,0.3859819769859314,-0.19593429565429688,0.24003781378269196,-0.36002928018569946,0.09885470569133759,0.03209298849105835,0.1392921656370163,0.10781369358301163,-0.028867414221167564,-0.27768099308013916,-0.08690373599529266,0.226074680685997},{-0.20810599625110626,-0.007386261597275734,-0.28650420904159546,-0.3335905969142914,0.24544979631900787,-0.47147300839424133,-0.2074567675590515,0.25622931122779846,-0.1229948028922081,0.1983165293931961,-0.015721198171377182,-0.07995232194662094,-0.3630944490432739,-0.0069868615828454494,-0.23157989978790283,-0.3620679974555969},{-0.2633742094039917,-0.10716696083545685,-0.1012244001030922,-0.3513558804988861,-0.32632747292518616,-0.00019391399109736085,0.12599189579486847,-0.4890398383140564,0.014305912889540195,-0.050014935433864594,0.155108243227005,0.004627386573702097,0.4174194633960724,0.030050043016672134,0.22175836563110352,0.2305784970521927},{-0.22010080516338348,-0.04982886090874672,-0.4370240569114685,0.35952746868133545,0.13576222956180573,0.006204168312251568,0.15739652514457703,0.08088377118110657,-0.3965916037559509,0.22568553686141968,-0.3582412004470825,-0.14643295109272003,-0.37743130326271057,0.40463584661483765,-0.3464279770851135,0.09728555381298065},{-0.14544670283794403,-0.45105794072151184,-0.10335621982812881,0.15580226480960846,-0.18872860074043274,-0.09451936185359955,-0.08106306940317154,0.3836314082145691,0.4252036213874817,0.09153184294700623,-0.09065624326467514,-0.25836142897605896,0.15482352674007416,-0.3659532368183136,0.15314345061779022,-0.20773859322071075},{-0.25795838236808777,-0.4695684611797333,-0.171355739235878,-0.1126696988940239,-0.4563877284526825,0.3646763265132904,-0.07071027904748917,0.19809861481189728,-0.18605421483516693,-0.3292522728443146,-0.2968028485774994,0.40061578154563904,-0.20152899622917175,0.0698736235499382,-0.2702009677886963,0.3752962052822113},{-0.32784226536750793,0.3360952138900757,-0.1666979044675827,0.10360170900821686,-0.36447247862815857,0.20288774371147156,0.04562168940901756,-0.371946781873703,0.10932472348213196,0.17004452645778656,-0.1562766432762146,0.0755724161863327,0.2782672643661499,-0.23662425577640533,-0.3354533314704895,-0.16259914636611938},{-0.15199288725852966,-0.3705325722694397,-0.5266136527061462,0.28710511326789856,0.03591339290142059,0.13117359578609467,-0.25650760531425476,0.2059127390384674,-0.4311554729938507,-0.3226264417171478,-0.3933646082878113,0.24588994681835175,-0.243249773979187,0.19210246205329895,0.09404847770929337,0.3401619493961334}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.0587882399559021,-0.11335386335849762,0.12557171285152435,-0.11140505969524384,-0.09098885208368301,0.1170867308974266,0.16979379951953888,-0.24818962812423706,-0.15218311548233032,0.296495258808136,0.07905343174934387,0.13197676837444305,0.10428117215633392,0.14085102081298828,-0.17870976030826569,0.14068393409252167,0.10881713032722473,-0.29872626066207886,-0.23918312788009644,-0.069318488240242,-0.18809311091899872,0.12434079498052597,-0.2012285441160202,0.3632948398590088,-0.18224480748176575,-0.03857441246509552,0.10730159282684326,0.17527666687965393,-0.2555871903896332,-0.18701227009296417,0.24853207170963287,0.26342788338661194},{0.163165882229805,-0.06332800537347794,0.1628967970609665,-0.09217137843370438,-0.09199701249599457,0.2326454222202301,0.023296503350138664,-0.059352580457925797,-0.0313565693795681,-0.04166080057621002,-0.10884126275777817,0.00395395839586854,0.37882864475250244,0.20824074745178223,0.11283198744058609,0.03871680423617363,-0.23703330755233765,-0.2760097086429596,0.1094222366809845,0.039172206073999405,0.07942468672990799,0.29611364006996155,0.2703067660331726,-0.15415836870670319,0.047498151659965515,0.2824039161205292,-0.35264426469802856,0.2009732574224472,0.08611195534467697,-0.23849698901176453,-0.08423051238059998,-0.017648683860898018},{-0.061398137360811234,-0.06842364370822906,0.1927192211151123,-0.16196952760219574,-0.15988413989543915,0.04992523044347763,-0.2376852184534073,0.186566561460495,0.22116832435131073,0.014875018037855625,-0.21379008889198303,0.05802921950817108,0.3506122827529907,-0.2571444809436798,0.10660841315984726,-0.05140069127082825,-0.3865867257118225,0.24235807359218597,-0.34623128175735474,-0.04220089316368103,-0.06673845648765564,-0.08459704369306564,-0.05853747949004173,-0.04807378724217415,-0.03765209764242172,0.3717856705188751,-0.07596397399902344,0.09222471714019775,0.24878041446208954,-0.34821707010269165,-0.10402587056159973,-0.001549168606288731},{0.15106675028800964,-0.23212233185768127,0.0103557538241148,-0.38502585887908936,0.08150416612625122,-0.11581826955080032,-0.05741124600172043,0.1972861886024475,0.05318325757980347,0.22263893485069275,0.039077889174222946,-0.1366516500711441,-0.2025800198316574,-0.03168288245797157,0.24233777821063995,-0.22484777867794037,0.058575764298439026,-0.062228672206401825,-0.15189515054225922,0.12392628937959671,-0.16194899380207062,0.15179511904716492,-0.2541741728782654,0.30067458748817444,-0.25055786967277527,0.03645409643650055,-0.06478904187679291,-0.2385183572769165,0.049377914518117905,0.024854538962244987,0.21876849234104156,-0.15224245190620422},{0.2635795474052429,-0.04041019082069397,0.015079859644174576,0.2604885697364807,-0.2977685332298279,-0.09482056647539139,0.16948866844177246,-0.017728345468640327,0.12434402108192444,-0.1820170283317566,0.00592005206272006,-0.07583891600370407,-0.1979909986257553,-0.13829337060451508,0.28465673327445984,0.24988874793052673,-0.04488995671272278,-0.33106350898742676,0.11823800951242447,-0.12898379564285278,-0.13080868124961853,0.22582601010799408,0.24404066801071167,0.012430372647941113,-0.10396360605955124,-0.09542132169008255,0.03876442089676857,0.2507655620574951,0.2361525595188141,0.08687242120504379,0.13569411635398865,-0.22058476507663727},{0.3047078549861908,-0.155397430062294,0.018127111718058586,0.0865996852517128,-0.128439798951149,-0.31547582149505615,-0.23052610456943512,-0.3127979338169098,-0.18299901485443115,0.03686465695500374,-0.039955414831638336,0.00944576133042574,-0.08622858673334122,-0.07033035159111023,-0.1998531073331833,-0.2762550711631775,0.15813332796096802,0.018801240250468254,-0.324336439371109,0.2143779993057251,-0.08843546360731125,-0.18279974162578583,0.2023804783821106,-0.14099504053592682,-0.1613246202468872,-0.22747941315174103,-0.11718892306089401,0.0752434954047203,0.08656627684831619,0.23778393864631653,-0.2623178958892822,0.18097996711730957},{0.17635703086853027,0.0806942954659462,0.2220882773399353,-0.1509016901254654,0.23633423447608948,-0.20956802368164062,-0.30513474345207214,-0.018715394660830498,0.28645873069763184,0.12696407735347748,-0.1608218401670456,0.13218875229358673,0.0764772966504097,0.3163650929927826,0.10160122066736221,-0.05294258892536163,-0.20770245790481567,0.1135585606098175,-0.018387582153081894,-0.04714719578623772,-0.08317116647958755,0.21319739520549774,0.1695670783519745,0.1243899017572403,-0.2673637866973877,-0.2104162722826004,-0.25941818952560425,-0.3240237236022949,0.09271606802940369,-0.13788136839866638,0.32070764899253845,0.16486990451812744},{0.32418912649154663,-0.37115880846977234,0.07210201770067215,-0.420027494430542,-0.3194762170314789,0.3015362024307251,0.407434344291687,0.19408634305000305,-0.06653241813182831,0.10419075936079025,0.16716010868549347,-0.1411966234445572,0.06209052354097366,0.2914782762527466,-0.038507282733917236,0.20538951456546783,0.3995383679866791,-0.26187002658843994,-0.0728253573179245,-0.37816548347473145,0.19211137294769287,0.23616984486579895,0.20081493258476257,0.14735504984855652,0.1315167248249054,0.11427684128284454,0.16270963847637177,0.2738304138183594,-0.11755833774805069,-0.270244300365448,0.2523234486579895,0.06120644137263298},{0.05110776424407959,-0.09880272299051285,0.21173374354839325,0.2685188055038452,-0.21376794576644897,-0.3054961860179901,-0.07944104820489883,0.23134908080101013,-0.19065281748771667,-0.19306866824626923,0.02371140755712986,0.11611400544643402,0.15225660800933838,-0.30519431829452515,0.15028059482574463,-0.18070673942565918,-0.2098684161901474,0.16572175920009613,-0.28014957904815674,0.2755632996559143,-0.3549524247646332,-0.29299435019493103,-0.32327860593795776,0.25303900241851807,0.09382672607898712,0.08280977606773376,0.3182174861431122,0.2006460428237915,-0.16882488131523132,-0.3290468156337738,-0.14635267853736877,0.16927888989448547},{0.3205088973045349,0.053973790258169174,0.029588595032691956,0.23492859303951263,0.035706646740436554,0.2445300966501236,-0.05169045552611351,0.23213309049606323,-0.06282777339220047,0.027934633195400238,0.16549897193908691,0.10986067354679108,-0.09025626629590988,-0.3147886395454407,0.1859491467475891,0.20853117108345032,-0.0007226571906358004,-0.1543196439743042,-0.005569172091782093,0.01870807819068432,0.08765042573213577,-0.32343533635139465,0.3572240173816681,0.03615890443325043,-0.05199803411960602,0.1116616427898407,-0.3769339919090271,-0.1723622977733612,0.009735064581036568,0.019908104091882706,0.08283974230289459,0.2136315554380417},{-0.08242771774530411,0.08744631707668304,-0.06467777490615845,0.1964690089225769,-0.07069002091884613,0.3086743652820587,0.09421589225530624,-0.08362361788749695,0.2633529603481293,-0.3010599613189697,-0.16922473907470703,0.15383002161979675,-0.08715863525867462,0.06689746677875519,-0.2906091511249542,0.0412161611020565,0.06481216847896576,0.15698115527629852,0.09022872149944305,-0.12375152111053467,-0.269272118806839,0.1757514625787735,0.24960467219352722,0.22880513966083527,-0.3364524245262146,0.3388679027557373,-0.16658225655555725,0.015036383643746376,-0.11173713207244873,0.1432429999113083,0.20470558106899261,0.2604212760925293},{-0.19512389600276947,0.2678701877593994,-0.09167739003896713,-0.01669398322701454,-0.2346361130475998,-0.16187068819999695,0.1478530913591385,-0.2898731827735901,-0.00723057659342885,-0.2256801426410675,-0.2294720709323883,-0.06820563226938248,0.17922408878803253,-0.278010755777359,-0.11444894969463348,-0.3823675811290741,-0.15493981540203094,-0.007980343885719776,0.2722315490245819,-0.28782469034194946,0.058535385876894,-0.13411776721477509,0.015896255150437355,0.2876645624637604,-0.13464345037937164,0.14958344399929047,0.28984788060188293,-0.1340928077697754,-0.07343373447656631,0.2883935570716858,-0.16714069247245789,-0.2951032817363739},{-0.05246705189347267,0.23131772875785828,0.24824555218219757,-0.34303775429725647,0.3164779543876648,0.03456037864089012,-0.1102873831987381,-0.0008400126243941486,0.12941893935203552,-0.2899255156517029,-0.051071859896183014,0.02164544351398945,0.21013301610946655,0.026435380801558495,0.007254528813064098,-0.03624578192830086,0.2351994663476944,-0.2889500856399536,0.3333278298377991,0.07643643021583557,-0.17250804603099823,0.19673649966716766,-0.09358508139848709,-0.21611331403255463,0.24307654798030853,-0.09124895185232162,-0.018517324700951576,-0.12325769662857056,0.03400855138897896,-0.11589790135622025,0.28990936279296875,0.27065008878707886},{0.09606526792049408,-0.20081178843975067,-0.17702369391918182,0.08572431653738022,0.07629774510860443,0.27969855070114136,-0.11176478862762451,-0.2520642876625061,0.300753116607666,0.04599186033010483,0.04492078721523285,0.04240410402417183,-0.20730772614479065,0.0907866358757019,-0.1889379769563675,-0.28609851002693176,0.06610502302646637,-0.019732771441340446,0.20573660731315613,0.35372617840766907,-0.2243698239326477,0.10502087324857712,-0.1378973126411438,0.03410646319389343,0.06840135902166367,-0.28089678287506104,-0.14866569638252258,-0.2510344684123993,-0.05332067236304283,-0.14238518476486206,0.23749275505542755,-0.3239544928073883},{-0.04299698770046234,0.31646135449409485,0.17154371738433838,-0.1867791712284088,-0.10805021226406097,-0.18589946627616882,0.16407808661460876,-0.08513627201318741,0.2044837772846222,-0.03043261729180813,0.2262113094329834,0.15870626270771027,0.016330210492014885,0.06997726857662201,-0.12825354933738708,0.1985192745923996,-0.20758146047592163,-0.3737161159515381,-0.25106802582740784,0.14999684691429138,0.10712598264217377,-0.25132182240486145,-0.31492501497268677,-0.20722845196723938,-0.22270023822784424,0.051680196076631546,0.3432202637195587,-0.006514883600175381,-0.12918683886528015,0.11109872907400131,-0.16407239437103271,0.0865907371044159},{-0.2079504281282425,-0.18371787667274475,-0.25081101059913635,0.07002165913581848,-0.2880646884441376,-0.1376127451658249,-0.11093737930059433,-0.13658182322978973,-0.28429970145225525,-0.1858307123184204,0.10686074197292328,0.18251794576644897,-0.26335182785987854,0.2815985679626465,-0.036893002688884735,0.18626388907432556,0.043554775416851044,0.010889331810176373,0.02606012299656868,0.11056379228830338,0.15304531157016754,0.3191370964050293,0.0875445306301117,0.22308041155338287,0.12164248526096344,-0.236657053232193,-0.1197008565068245,0.2612953186035156,-0.008531760424375534,-0.22740569710731506,-0.16256114840507507,-0.16828523576259613},{-0.33449259400367737,-0.21430964767932892,-0.388191282749176,0.06818535178899765,-0.1639743596315384,-0.1099839061498642,-0.13536836206912994,0.057155903428792953,-0.01830882951617241,0.06787162274122238,-0.2268683910369873,0.009013975970447063,0.14542384445667267,-0.020512759685516357,-0.0012430495116859674,0.1587408035993576,-0.13962551951408386,-0.07621575891971588,0.14454469084739685,0.11312738806009293,0.2319716364145279,-0.005377456545829773,-0.2969280183315277,0.06796211004257202,0.25022614002227783,-0.293804794549942,0.19720256328582764,-0.01917266473174095,0.04818001389503479,-0.1591464877128601,0.18426746129989624,-0.10987986624240875},{0.269216924905777,-0.04868423938751221,0.05309835076332092,0.12208714336156845,-0.2923893928527832,-0.006740378215909004,0.15506702661514282,0.21192246675491333,-0.083279550075531,-0.10948634892702103,0.3102097809314728,-0.17565155029296875,-0.01810556836426258,-0.05703038349747658,-0.14857913553714752,0.22397157549858093,0.011667873710393906,-0.06786792725324631,0.12281005829572678,-0.28047874569892883,0.03821665048599243,-0.3101152181625366,-0.24047188460826874,0.2548171877861023,-0.13760915398597717,-0.1291493922472,0.16796725988388062,-0.008597913198173046,-0.1591256707906723,-0.0052320584654808044,-0.09703323990106583,-0.03688142076134682},{0.2941470146179199,-0.0509406253695488,0.07166329026222229,0.06242917850613594,-0.012401027604937553,-0.11240383982658386,0.16043488681316376,-0.232539564371109,0.22510926425457,0.27548104524612427,0.015100892633199692,0.16104960441589355,0.25119009613990784,0.3354664146900177,-0.3023607134819031,-0.30636468529701233,-0.2984737753868103,0.04701019451022148,-0.1419631838798523,-0.29623958468437195,-0.18370187282562256,0.2842152416706085,0.0658203586935997,0.13405568897724152,-0.13254748284816742,-0.08531223237514496,-0.1455223262310028,-0.19851726293563843,0.2537722885608673,0.1614208072423935,-0.2790379822254181,-0.14972594380378723},{-0.1068674847483635,0.16133242845535278,0.29990267753601074,-0.06191667541861534,-0.013029733672738075,0.06166397035121918,-0.004394370596855879,-0.3137590289115906,0.19377844035625458,0.24751660227775574,0.18009893596172333,0.20004165172576904,-0.25830599665641785,0.19523338973522186,-0.27436700463294983,0.29516831040382385,0.14516639709472656,-0.23620520532131195,0.2649410665035248,0.1433575302362442,-0.2955256700515747,0.2946794331073761,-0.3158193826675415,0.12735924124717712,0.17263169586658478,0.2114298790693283,0.09130694717168808,0.09488190710544586,-0.20992110669612885,0.25656023621559143,-0.10284067690372467,0.09620220214128494},{-0.14435763657093048,-0.06591455638408661,0.03444097563624382,0.22913403809070587,-0.02352232113480568,0.1987251490354538,-0.3394855260848999,-0.18445993959903717,-0.17859351634979248,-0.10869771242141724,-0.18141691386699677,-0.14042404294013977,0.08059220016002655,-0.10381557792425156,0.11569323390722275,-0.17753219604492188,0.141475111246109,-0.005769537296146154,-0.30752378702163696,-0.20757831633090973,0.09334719181060791,0.21232952177524567,-0.17711423337459564,0.33945873379707336,-0.2752971351146698,0.06733518093824387,0.09751085937023163,-0.10333666205406189,0.07481714338064194,-0.2248237431049347,0.3150472640991211,0.05025305226445198},{0.3581113815307617,-0.06589240580797195,0.05850057676434517,0.14438284933567047,-0.14506159722805023,0.2437017410993576,-0.019888300448656082,0.25704213976860046,0.16721799969673157,0.12649381160736084,0.03217161446809769,-0.4091598391532898,-0.284284770488739,-0.08018678426742554,0.07619091868400574,-0.1339019387960434,0.3202363848686218,0.2031513899564743,-0.21438874304294586,-0.22130972146987915,0.27703016996383667,0.2846369743347168,0.25670957565307617,0.14269912242889404,-0.07446775585412979,-0.03179721161723137,-0.0834084004163742,-0.2263704538345337,0.20417843759059906,0.0829651951789856,-0.19793368875980377,0.13341279327869415},{-0.018202880397439003,0.025001825764775276,-0.06460709124803543,-0.2468440681695938,-0.10667811334133148,-0.24513021111488342,-0.22916102409362793,-0.1771407425403595,0.01916954666376114,-0.01633286662399769,-0.2598403990268707,0.026654446497559547,-0.25018391013145447,-0.15641506016254425,0.0012922633904963732,0.08616714924573898,0.271034300327301,-0.17330440878868103,-0.3546498715877533,0.2738475203514099,-0.15109951794147491,0.25736385583877563,-0.026552213355898857,-0.052857086062431335,0.04355339705944061,0.1252940446138382,-0.05317014455795288,-0.2818235456943512,0.22734765708446503,0.2536028325557709,-0.15481658279895782,0.19349120557308197},{-0.27253445982933044,-0.00678076408803463,0.03932362422347069,-0.006967788562178612,0.028662720695137978,0.08542303740978241,-0.18533506989479065,0.10639329254627228,-0.20512105524539948,-0.20645911991596222,0.12326481938362122,-0.11050749570131302,-0.1824183166027069,0.2534247040748596,0.013753104954957962,0.013503172434866428,0.19755472242832184,-0.27053797245025635,-0.16373050212860107,0.2458878755569458,0.037284836173057556,0.20178081095218658,-0.0032991988118737936,0.0017679419834166765,-0.25151848793029785,-0.11737866699695587,0.026647955179214478,0.3292866349220276,0.02786915935575962,-0.026759542524814606,0.29771938920021057,0.31216534972190857}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.08945410698652267,0.1556045562028885,0.3595673739910126,-0.04372875764966011},{0.05565740168094635,-0.10255545377731323,0.03607548028230667,0.2250247746706009},{-0.12105374038219452,0.1342274248600006,0.11068827658891678,0.12152180075645447},{0.3352515399456024,0.0411907434463501,0.07594643533229828,0.4478655457496643},{-0.056324657052755356,0.08073270320892334,0.3099021315574646,0.008990153670310974},{-0.14494460821151733,0.23408377170562744,0.2363472282886505,-0.045446883887052536},{-0.3106482923030853,-0.018207665532827377,0.05533516779541969,-0.10237565636634827},{-0.34554317593574524,-0.13297080993652344,0.3668336570262909,-0.2853942811489105},{0.28961169719696045,-0.14027664065361023,-0.261508584022522,-0.38007304072380066},{0.0644216313958168,0.3045695126056671,0.3088173270225525,-0.38724860548973083},{-0.16258850693702698,-0.17870113253593445,-0.10888552665710449,0.13416893780231476},{0.3514702320098877,-0.15303723514080048,-0.031942978501319885,0.20353049039840698},{0.25309470295906067,0.2850639522075653,-0.06842480599880219,0.12862080335617065},{-0.0009286795393563807,0.023070035502314568,-0.288760244846344,0.055398713797330856},{0.10334566235542297,0.2526838481426239,0.33602362871170044,0.268110454082489},{0.15139077603816986,0.001201117760501802,0.25983116030693054,0.27807188034057617},{-0.2535434365272522,-0.10458070039749146,-0.08404549211263657,-0.2526804208755493},{-0.13018916547298431,0.14099207520484924,-0.11924749612808228,-0.1072068065404892},{-0.32446181774139404,0.15110565721988678,0.16389577090740204,0.34969016909599304},{-0.023806478828191757,0.30872219800949097,-0.16669684648513794,0.16861416399478912},{-0.25397568941116333,-0.3583764135837555,-0.12370706349611282,-0.002490503014996648},{0.33353230357170105,0.39678311347961426,0.018759742379188538,-0.2944892644882202},{0.0013593434123322368,0.17080119252204895,0.2161163091659546,0.17374497652053833},{-0.07074888050556183,0.3899303078651428,-0.06550195813179016,-0.17622826993465424},{-0.003498455975204706,-0.06250400096178055,-0.09366119652986526,-0.01256505586206913},{0.2802024781703949,-0.3514595627784729,-0.03965691849589348,0.024636270478367805},{-0.029704313725233078,-0.3403139114379883,-0.1763559728860855,-0.268315851688385},{0.1472199708223343,-0.18572396039962769,0.22568365931510925,0.12583346664905548},{0.013589630834758282,-0.03914548084139824,0.020131561905145645,-0.008797110058367252},{-0.4138984680175781,0.37731999158859253,0.20780575275421143,-0.003147000214084983},{0.3507407605648041,-0.15799999237060547,0.19429448246955872,-0.04578518867492676},{0.128592848777771,-0.36988964676856995,0.3807656168937683,-0.241357684135437}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09354917705059052,-0.034439314156770706,0.023425424471497536,0.04247056692838669,-0.07841459661722183,-0.11077697575092316,0.026219557970762253,0.03941275551915169,0.03798602521419525,-0.018692122772336006,-0.05962877348065376,-0.002295667538419366,0.05671033263206482,0.023707587271928787,-0.08382947742938995,-0.006354968994855881};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.025119632482528687,0.0023106385488063097,0.0022698906250298023,0.009830344468355179,0.00031350419158115983,-0.016016885638237,0.029094131663441658,0.03189254179596901,0.010651261545717716,0.02459070459008217,0.030368337407708168,-0.005768559407442808,0.051083195954561234,-0.03011430613696575,-0.0468248687684536,0.010375258512794971};
static const float actor_encoder_feed_forward_0_bias[32] = {0.0021122160833328962,0.007878019474446774,0.012928348034620285,-0.0032679401338100433,0.015427674166858196,0.005551006179302931,0.009468232281506062,0.019941870123147964,-0.03953655809164047,-0.013061350211501122,0.0009379105176776648,0.00014078296953812242,0.009704086929559708,-0.0006504309712909162,-3.5396245948504657e-05,0.03584061190485954,0.0003615902678575367,-0.0200794730335474,0.024655818939208984,-0.012347759678959846,-0.022021902725100517,-0.00569380447268486,0.051189206540584564,0.01343714538961649,0.006659871898591518,0.021686265245079994,-0.028323408216238022,0.03835368528962135,-0.003688057651743293,0.002063179388642311,0.01966710202395916,0.010216639377176762};
static const float action_parameterization_distribution_linear_bias[4] = {-0.008165721781551838,-0.012984930537641048,0.0014793628361076117,0.008725408464670181};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.038733482360839844,0.272972971200943,-0.16210955381393433,0.18705138564109802,0.11028052866458893,0.050390828400850296,0.45809972286224365,-0.10127507150173187},{-0.2148798257112503,-0.032524995505809784,-0.28773367404937744,-0.2112199366092682,-0.3926248550415039,-0.2597578167915344,0.009880753234028816,-0.2620978355407715},{-0.26703718304634094,0.016388772055506706,0.2556788921356201,0.2691587209701538,0.22584396600723267,-0.05201871320605278,0.38150501251220703,-0.17150837182998657},{-0.003096936969086528,0.08822428435087204,-0.14193738996982574,0.042737316340208054,-0.009881388396024704,-0.08566708862781525,0.34871459007263184,-0.2523181736469269},{-0.2902449369430542,-0.128320574760437,-0.19364890456199646,-0.09472616016864777,-0.05397176742553711,0.15182489156723022,0.21459925174713135,-0.07852298766374588},{-0.3467319905757904,-0.04292645305395126,0.4423164427280426,0.2765372693538666,0.15728701651096344,-0.12874141335487366,-0.12100090831518173,-0.16182513535022736},{-0.2899160385131836,0.0019727307371795177,0.4913482666015625,-0.16034987568855286,-0.15062054991722107,-0.4366064965724945,-0.09551092982292175,-0.12036444246768951},{-0.2894733250141144,-0.37090274691581726,0.5909351110458374,-0.04539952427148819,-0.20633669197559357,0.22614918649196625,0.17966049909591675,-0.24232016503810883},{-0.40082821249961853,0.2890685498714447,-0.0831536203622818,0.3908103406429291,0.09511183947324753,-0.3247321546077728,0.008819090202450752,0.11583683639764786},{-0.4490230679512024,-0.3289317488670349,-0.09426132589578629,-0.1981780081987381,-0.5311941504478455,0.13080263137817383,-0.052519168704748154,0.1721503585577011},{0.02915317565202713,0.3161156475543976,0.25769010186195374,-0.013315782882273197,0.20496125519275665,0.15355469286441803,-0.22441405057907104,0.24247120320796967},{0.08582550287246704,0.013056779280304909,0.2716580331325531,0.24243399500846863,-0.300090491771698,0.3216724395751953,-0.01779782958328724,-0.21386092901229858},{0.015540543012320995,-0.34482401609420776,0.2628263235092163,-0.06565853208303452,-0.35626348853111267,-0.06346039474010468,-0.18553489446640015,-0.10966606438159943},{-0.2804100811481476,-0.27317601442337036,0.32605311274528503,0.3361385762691498,-0.2443132996559143,-0.055627916008234024,-0.3068290948867798,0.23523779213428497},{0.010029907338321209,-0.20954805612564087,0.15641358494758606,-0.22801928222179413,-0.27963951230049133,-0.11890728026628494,0.22090496122837067,0.02248097024857998},{0.13574279844760895,-0.0828087329864502,0.05443957820534706,-0.23297224938869476,0.06604403257369995,0.07651879638433456,0.08400770276784897,0.40324631333351135},{-0.09246553480625153,-0.33876651525497437,-0.16799558699131012,0.11890541762113571,-0.2087220698595047,-0.13571308553218842,-0.1293945014476776,0.13243229687213898},{-0.23304317891597748,-0.3394896388053894,0.03249909728765488,0.044086333364248276,0.11516252905130386,-0.18994976580142975,0.33898890018463135,0.17266200482845306},{-0.04192648082971573,0.08081815391778946,-0.26564478874206543,0.12035252153873444,0.1064215898513794,0.19710800051689148,-0.2346271574497223,0.364900141954422},{0.09521052241325378,-0.0434599369764328,-0.3712690472602844,0.10008204728364944,-0.06292574107646942,-0.02345573529601097,-0.3093259930610657,7.741612353129312e-05},{0.013048364780843258,-0.15028899908065796,0.06293883174657822,-0.0835300087928772,0.3387969136238098,0.05885636433959007,-0.007483134511858225,0.40570759773254395},{-0.04515107721090317,0.08483783155679703,-0.2647179663181305,0.3011804223060608,0.37965863943099976,0.37277036905288696,0.22467651963233948,-0.3148619532585144},{-0.5130379796028137,-0.17354334890842438,0.1554793268442154,-0.06344527006149292,0.2327776402235031,-0.24488715827465057,0.2809695601463318,-0.28449633717536926},{-0.2832561731338501,-0.008933555334806442,-0.09384553879499435,-0.4227927029132843,0.2561481297016144,0.052598197013139725,-0.2697555124759674,0.15855509042739868},{-0.35010281205177307,-0.1940595805644989,-0.029090510681271553,0.004202243406325579,-0.0488833487033844,0.20328332483768463,0.3635294437408447,-0.13687504827976227},{-0.31739941239356995,0.05013330653309822,-0.3933718502521515,-0.34428584575653076,0.18060703575611115,0.0662703663110733,-0.036138422787189484,0.06196095049381256},{0.25236231088638306,0.3799704611301422,-0.3043302595615387,0.15239746868610382,0.2232959270477295,0.4087473452091217,-0.23901449143886566,-0.15150012075901031},{0.28720077872276306,0.24999631941318512,0.03683735057711601,0.04441343620419502,0.29963770508766174,0.22249093651771545,0.3137129545211792,0.3618621230125427},{-0.22683510184288025,0.37944266200065613,0.13120043277740479,-0.022063136100769043,0.2450423538684845,0.07766120135784149,-0.2832542061805725,-0.30417272448539734},{-0.31126800179481506,-0.21230162680149078,0.056838054209947586,-0.2887618839740753,-0.29141831398010254,-0.15227797627449036,0.40765178203582764,-0.08528391271829605},{0.2668289840221405,-0.2338729202747345,0.33161109685897827,-0.344448059797287,0.021729620173573494,0.22544308006763458,0.30556389689445496,-0.2981935143470764},{0.08443395048379898,0.4092394709587097,0.3916042149066925,-0.28657540678977966,-0.29257071018218994,0.03306503966450691,0.32264444231987,0.00673245545476675}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.011530608870089054,0.4540230333805084,-0.1690346896648407,0.1811135858297348,-0.4143560230731964,0.31795185804367065,0.31615254282951355,0.10061297565698624},{-0.5072829723358154,-0.4154486060142517,-0.36240771412849426,-0.4486331641674042,-0.4622913599014282,0.4867016673088074,0.3644006848335266,-0.3650707006454468},{0.12021100521087646,-0.16675899922847748,0.15623590350151062,0.19639837741851807,-0.02229313552379608,0.4547990560531616,-0.29615452885627747,-0.5070980787277222},{0.43207117915153503,-0.0676785334944725,0.196360781788826,0.002586015500128269,0.49094951152801514,0.44473785161972046,0.5549246072769165,0.38400954008102417},{0.10740428417921066,0.1756899058818817,-0.14936861395835876,-0.25482529401779175,0.09334670007228851,-0.44951242208480835,-0.5271910429000854,0.5907849073410034},{0.4531642198562622,0.11788097023963928,-0.01533956453204155,-0.343883216381073,-0.4766935706138611,-0.4932132661342621,-0.13027359545230865,0.4219246506690979},{-0.47206342220306396,-0.32726892828941345,-0.11666781455278397,-0.2283875048160553,-0.02019590698182583,0.5229165554046631,-0.5185943245887756,0.5104256868362427},{0.19437609612941742,0.07687532156705856,-0.002250869758427143,0.0537438727915287,0.3695125877857208,-0.49395060539245605,0.3351091742515564,-0.373146653175354}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09701638668775558,0.015260742977261543,0.04461399465799332,-0.021368512883782387,-0.0414215512573719,0.02022453583776951,0.011684288270771503,-0.005306039936840534};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.017769919708371162,0.0027862614952027798,-0.047708552330732346,0.06064772605895996,-0.015850109979510307,-0.007363446988165379,0.032874807715415955,-0.07952573895454407};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

