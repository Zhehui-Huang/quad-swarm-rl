#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.29417651891708374,0.022879378870129585,-0.09817227721214294,0.3024255931377411,0.3010343015193939,-0.21926598250865936,-0.28964513540267944,0.11752322316169739,0.2972146272659302,-0.3204677700996399,0.5478794574737549,-0.051358699798583984,0.2746678292751312,0.1511414349079132,-0.4119587242603302,0.035356681793928146},{-0.23904253542423248,-0.27264121174812317,-0.2901807427406311,-0.22781899571418762,0.08172351866960526,0.33435386419296265,0.08064499497413635,0.11667285114526749,0.2309250682592392,0.17605113983154297,-0.14064574241638184,-0.07097283005714417,-0.12455185502767563,0.0503699854016304,0.34220340847969055,-0.3058058023452759},{0.13523565232753754,0.22472617030143738,0.20494502782821655,0.31416818499565125,-0.10634166747331619,-0.19066479802131653,0.4028489589691162,-0.04000997915863991,0.007063327357172966,-0.08444799482822418,-0.08263260871171951,-0.0014946756418794394,0.05805790424346924,0.3979007303714752,-0.2604101300239563,-0.10658667981624603},{0.1452493965625763,-0.16228355467319489,-0.11259672045707703,-0.14679105579853058,0.05719168484210968,0.0924379825592041,0.07717946171760559,-0.20111744105815887,-0.15355661511421204,0.13002470135688782,0.4850858151912689,-0.2514096796512604,-0.19555912911891937,-0.1345912665128708,0.19063417613506317,0.10042622685432434},{-0.3089413642883301,-0.006260760594159365,0.12923216819763184,-0.23022153973579407,0.2713473439216614,0.3404713273048401,0.13628838956356049,-0.19650782644748688,-0.13938601315021515,0.14536139369010925,-0.1299043744802475,-0.3959543704986572,-0.053156133741140366,-0.16431553661823273,0.29465848207473755,-0.04080206900835037},{0.050985123962163925,-0.059797827154397964,-0.010958557017147541,-0.05712391436100006,0.12779229879379272,-0.13906855881214142,0.4210134744644165,-0.3302650451660156,-0.13123036921024323,-0.17386551201343536,0.28934386372566223,0.06334249675273895,0.26163798570632935,0.03655405715107918,0.28728529810905457,0.26427045464515686},{-0.23216433823108673,0.17242111265659332,-0.1097739189863205,0.028285181149840355,-0.23324747383594513,-0.08928670734167099,-0.1710132509469986,-0.014607415534555912,0.2095581740140915,0.3439556658267975,-0.30765533447265625,-0.11185820400714874,0.24809180200099945,0.06551557034254074,-0.2106073945760727,0.31948935985565186},{-0.11591675877571106,0.004832730162888765,-0.09657865017652512,-0.19329360127449036,0.3687739670276642,-0.2743561863899231,-0.2711404263973236,-0.4172813594341278,-0.13387633860111237,-0.22622986137866974,0.3518463969230652,-0.012885318137705326,0.18366430699825287,0.18091650307178497,-0.16828982532024384,0.3996816575527191},{0.22872720658779144,0.08930958062410355,0.016465017572045326,0.051320258527994156,-0.3804064691066742,-0.46035054326057434,0.32307401299476624,-0.33627399802207947,-0.15686127543449402,0.19301877915859222,0.15870311856269836,-0.2985309362411499,-0.17475245893001556,0.06264437735080719,0.1647733896970749,-0.029517004266381264},{0.42660436034202576,-0.5481419563293457,-0.13413883745670319,-0.035667162388563156,0.19100886583328247,-0.20563791692256927,-0.259114146232605,-0.19613587856292725,-0.1539454311132431,-0.031210318207740784,-0.04207369685173035,-0.1968512386083603,0.39100733399391174,-0.13485607504844666,-0.47534656524658203,-0.16773824393749237},{0.21116390824317932,0.19534265995025635,-0.3457556664943695,0.10824453830718994,-0.024561630561947823,-0.2700832784175873,-0.15799714624881744,0.1091943010687828,-0.13120803236961365,0.15266984701156616,0.1402524709701538,0.2614916265010834,-0.13132816553115845,0.2697831392288208,-0.10219349712133408,-0.21140888333320618},{-0.42113909125328064,0.26120996475219727,0.25902387499809265,-0.271707147359848,-0.3239969313144684,0.29076042771339417,0.04968978092074394,0.29647326469421387,0.1902831792831421,0.1894751340150833,0.28472185134887695,-0.08826058357954025,0.10987253487110138,-0.048433490097522736,-0.08856911957263947,-0.14867240190505981},{0.12030729651451111,-0.25366470217704773,-0.19283320009708405,0.2346799671649933,-0.19622556865215302,-0.25742730498313904,-0.15973599255084991,0.2999039590358734,0.3021475374698639,-0.16538214683532715,-0.14478638768196106,0.07497767359018326,0.29381492733955383,0.13936300575733185,-0.18191766738891602,0.3317544162273407},{0.30234119296073914,0.18828876316547394,-0.16482117772102356,-0.09082131087779999,0.10902660340070724,-0.08518697321414948,-0.08885499835014343,0.3149226903915405,-0.25846871733665466,-0.19218450784683228,-0.15082420408725739,0.027017828077077866,-0.2217595875263214,-0.1315629631280899,-0.24283866584300995,-0.05641087889671326},{0.1740163117647171,0.36605265736579895,0.40394866466522217,-0.4046741724014282,-0.3892591595649719,0.058149322867393494,0.05467921122908592,-0.13135959208011627,0.38570699095726013,0.3506254255771637,-0.20330631732940674,0.10959014296531677,-0.032302021980285645,-0.3355492651462555,0.008689208887517452,-0.11998556554317474},{-0.1864282637834549,-0.2017950862646103,-0.12894979119300842,0.4006563723087311,-0.23657375574111938,-0.14212557673454285,-0.23975105583667755,-0.27455389499664307,-0.5600727796554565,-0.21040476858615875,0.34629473090171814,0.2901017963886261,-0.6252243518829346,-0.3392365574836731,-0.6298006176948547,-0.14098918437957764},{-0.5325648784637451,0.17605067789554596,-0.4573349952697754,-0.08215130865573883,-0.43912380933761597,0.19937515258789062,0.47277161478996277,0.06912923604249954,0.4493616819381714,-0.46188417077064514,0.19803117215633392,-0.3584146797657013,-0.16559992730617523,0.010239074937999249,-0.1911565214395523,-0.19522424042224884},{0.3305581510066986,-0.6228073835372925,0.30573809146881104,0.32784053683280945,-0.12980586290359497,0.47834134101867676,0.3209221661090851,0.2835022509098053,-0.09849179536104202,-0.31569334864616394,-0.12768137454986572,-0.1750016063451767,-0.0423254631459713,-0.5223821997642517,0.17517879605293274,-0.11349235475063324}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.0592331700026989,0.32492733001708984,0.23954243957996368,-0.14393050968647003,-0.20575247704982758,0.05398784950375557,-0.018648119643330574,0.2842729389667511,-0.0841517373919487,0.32567012310028076,0.4795561134815216,-0.39232420921325684,0.027991382405161858,0.03962789848446846,0.034073468297719955,-0.13921502232551575},{-0.47131121158599854,0.1793171912431717,-0.24031592905521393,0.3042505383491516,0.2860080897808075,-0.15972624719142914,-0.32170599699020386,-0.19332091510295868,0.3646421432495117,0.23601457476615906,-0.07466039061546326,0.2685747742652893,-0.42949000000953674,0.20687511563301086,-0.2477855533361435,0.48626646399497986},{-0.28308823704719543,0.0977567508816719,-0.35829704999923706,0.20406852662563324,-0.4838854670524597,-0.28625261783599854,0.09307727962732315,0.16378217935562134,-0.2725847065448761,0.4185205101966858,0.27398085594177246,-0.20190495252609253,0.19420355558395386,-0.287810355424881,-0.16652412712574005,-0.09511643648147583},{0.3466488718986511,-0.23979587852954865,0.12375028431415558,0.4095829129219055,-0.41461947560310364,-0.2989329695701599,0.2959919571876526,0.04772809520363808,0.29572364687919617,-0.0699528306722641,0.3513646721839905,0.09446831792593002,-0.21339014172554016,-0.016296247020363808,0.018219858407974243,-0.45786264538764954},{-0.4043367803096771,-0.054118383675813675,0.1661778688430786,-0.29162177443504333,0.15682286024093628,0.45308759808540344,-0.28838691115379333,0.2899816036224365,-0.23175106942653656,0.2293657511472702,-0.025833355262875557,0.0032262366730719805,-0.24800658226013184,-0.020689543336629868,-0.28549084067344666,-0.14400117099285126},{0.07045497745275497,-0.34026214480400085,0.017707329243421555,-0.326977014541626,0.2024078667163849,0.04749244451522827,-0.16402138769626617,-0.041367024183273315,-0.15016938745975494,0.40861672163009644,0.23088504374027252,-0.01949412003159523,-0.2961967885494232,0.07342901825904846,0.014617251232266426,-0.3043881356716156},{0.2925763428211212,-0.161609947681427,0.3527432084083557,-0.2547658681869507,-0.41453826427459717,-0.07951793819665909,-0.34437400102615356,0.3568425476551056,-0.0932137668132782,-0.26144471764564514,-0.225684255361557,-0.03098961152136326,-0.027187544852495193,-0.08418933302164078,0.4997076988220215,-0.3545599579811096},{-0.31495827436447144,0.3663117587566376,-0.06513747572898865,0.17531082034111023,-0.0442679300904274,-0.20058734714984894,-0.2355954647064209,0.06486276537179947,0.026199880987405777,0.5315258502960205,0.12730786204338074,-0.10483706742525101,0.04694001376628876,-0.257768839597702,0.12745711207389832,0.15594257414340973},{0.08284153044223785,0.2686727046966553,-0.1676119714975357,-0.35639429092407227,0.3617528975009918,-0.17007312178611755,0.13357114791870117,-0.323075532913208,0.15470963716506958,0.0856628268957138,0.08218326419591904,0.14764495193958282,0.016063161194324493,-0.42680707573890686,-0.024669867008924484,0.22358179092407227},{-0.24985791742801666,0.06798578798770905,-0.30242711305618286,-0.35196033120155334,0.23157423734664917,-0.43764933943748474,-0.14829249680042267,0.3066868782043457,-0.17483103275299072,0.13906614482402802,-0.03598390519618988,-0.1083192452788353,-0.36597970128059387,0.11550436168909073,-0.25684964656829834,-0.282914936542511},{-0.14484304189682007,-0.15155458450317383,0.0044350638054311275,-0.2543148696422577,-0.31972116231918335,-0.018926503136754036,0.1540634036064148,-0.4289786219596863,0.027756482362747192,-0.11208600550889969,0.2756039500236511,-0.05141506344079971,0.2926906645298004,0.17151173949241638,0.22838468849658966,0.23861438035964966},{-0.08879034966230392,-0.032303616404533386,-0.41800644993782043,0.3434830904006958,0.10638702660799026,0.15350301563739777,0.26829251646995544,0.18370354175567627,-0.46175897121429443,0.18026477098464966,-0.3258398175239563,-0.21953974664211273,-0.37179306149482727,0.4049932062625885,-0.36827898025512695,0.07443102449178696},{-0.2271142154932022,-0.5007457137107849,-0.1403961181640625,0.17289859056472778,-0.23257558047771454,-0.001586462720297277,-0.08763080835342407,0.3940402865409851,0.4807036519050598,0.15529866516590118,-0.02389673888683319,-0.18927249312400818,0.14865335822105408,-0.4107045829296112,0.10350871086120605,-0.21063825488090515},{-0.3123602569103241,-0.45224541425704956,-0.19843199849128723,-0.15836258232593536,-0.46580472588539124,0.5391905307769775,-0.16684938967227936,0.20682746171951294,-0.10203627496957779,-0.24974553287029266,-0.36201319098472595,0.4663389027118683,-0.200990229845047,-0.050107192248106,-0.2561129629611969,0.3872964680194855},{-0.3893008232116699,0.34333890676498413,-0.22825689613819122,0.12383513152599335,-0.40453699231147766,0.18396863341331482,-0.08409905433654785,-0.27164217829704285,0.1299230009317398,0.2537097632884979,-0.2773810625076294,0.061063461005687714,0.23281380534172058,-0.37460675835609436,-0.3371323347091675,-0.1392926722764969},{-0.14618010818958282,-0.32463952898979187,-0.46232667565345764,0.21898293495178223,0.10524377971887589,0.07692794501781464,-0.25457248091697693,0.18875473737716675,-0.34431055188179016,-0.2615746557712555,-0.30695804953575134,0.2298327535390854,-0.1914202719926834,0.13396142423152924,0.07429608702659607,0.2821663022041321}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.09663983434438705,-0.05885056406259537,0.09869880974292755,-0.1477379947900772,-0.11868029832839966,0.10245068371295929,0.1766005903482437,-0.2249266356229782,-0.12109247595071793,0.29618045687675476,0.09257566183805466,0.1553422510623932,0.11639353632926941,0.18033656477928162,-0.18034148216247559,0.14629243314266205,0.1170838251709938,-0.35695701837539673,-0.25647324323654175,-0.09800209105014801,-0.1573125720024109,0.12585406005382538,-0.23553502559661865,0.2911013066768646,-0.08182968199253082,-0.005089638754725456,0.15385469794273376,0.1913124918937683,-0.25568100810050964,-0.20419073104858398,0.2367297261953354,0.29706498980522156},{0.24445940554141998,-0.04915587231516838,0.14796853065490723,-0.10287558287382126,-0.11683553457260132,0.26238369941711426,-0.023330871015787125,-0.06062990427017212,-0.041030123829841614,0.007833996787667274,-0.15451163053512573,0.026434453204274178,0.4153270423412323,0.15928064286708832,0.14745984971523285,0.10187069326639175,-0.2671363651752472,-0.37303292751312256,0.09616128355264664,0.02474808692932129,0.03879991173744202,0.31574052572250366,0.22322435677051544,-0.24455899000167847,0.05830726400017738,0.28842055797576904,-0.2993341386318207,0.19181212782859802,0.14200851321220398,-0.23370985686779022,-0.01861671358346939,0.007746935356408358},{-0.10646416246891022,-0.03300599381327629,0.21894901990890503,-0.20480479300022125,-0.22229190170764923,0.010494882240891457,-0.1881859302520752,0.22231315076351166,0.18330635130405426,-0.023422613739967346,-0.16088394820690155,0.05110234022140503,0.28207412362098694,-0.20586471259593964,0.08392751216888428,-0.025477400049567223,-0.3426709771156311,0.23302288353443146,-0.3036195933818817,-0.06279972940683365,0.005304170772433281,-0.1364443451166153,-0.07945853471755981,-0.12811952829360962,0.015686597675085068,0.36677536368370056,-0.031861960887908936,0.08906569331884384,0.2674335837364197,-0.3260648846626282,-0.15776026248931885,-0.006817230023443699},{0.16992123425006866,-0.17573203146457672,0.07751531153917313,-0.37064328789711,0.16989655792713165,-0.08496380597352982,-0.04017741605639458,0.2718031406402588,0.025215940549969673,0.2077038586139679,0.0926034227013588,-0.14891280233860016,-0.21167443692684174,-0.09505265951156616,0.30729207396507263,-0.24323660135269165,0.058904871344566345,-0.10324927419424057,-0.1231989786028862,0.09924659132957458,-0.13907390832901,0.08662811666727066,-0.19421197474002838,0.2821337878704071,-0.31515178084373474,0.049892671406269073,-0.10072395205497742,-0.21238407492637634,0.034707944840192795,0.06349338591098785,0.22509531676769257,-0.11234326660633087},{0.2245362102985382,0.011862663552165031,0.04877404496073723,0.2804928421974182,-0.2723413109779358,-0.06748219579458237,0.16789692640304565,-0.08485067635774612,0.08614648133516312,-0.20394159853458405,0.003257865784689784,-0.061673037707805634,-0.1197507455945015,-0.12216155230998993,0.29507768154144287,0.32032865285873413,-0.11222906410694122,-0.3329690992832184,0.18518242239952087,-0.08766226470470428,-0.1371288150548935,0.22046324610710144,0.27823561429977417,0.050135139375925064,-0.04240988940000534,-0.11232663691043854,-0.041343290358781815,0.2636679708957672,0.24421614408493042,0.11319178342819214,0.06701993942260742,-0.301398366689682},{0.306956022977829,-0.1769656389951706,0.06901723891496658,0.08239296823740005,-0.15318156778812408,-0.2947048842906952,-0.18471764028072357,-0.2956670820713043,-0.25668445229530334,-0.002637420082464814,0.0012966371141374111,-0.04686075076460838,-0.16696998476982117,-0.020495038479566574,-0.21686328947544098,-0.2432241141796112,0.19159261882305145,0.037697598338127136,-0.27154234051704407,0.21920166909694672,-0.029675260186195374,-0.2388247847557068,0.2057950794696808,-0.14624544978141785,-0.14923863112926483,-0.2683841288089752,-0.1070026308298111,0.10317124426364899,0.09653124958276749,0.2791367769241333,-0.3052873909473419,0.15238645672798157},{0.21029652655124664,0.049714572727680206,0.2559283375740051,-0.19671255350112915,0.2480897307395935,-0.15181924402713776,-0.25247445702552795,0.03135477378964424,0.2880232334136963,0.1984192579984665,-0.16855409741401672,0.06820888072252274,0.07141737639904022,0.3330300748348236,0.1363673210144043,-0.11612337082624435,-0.19392013549804688,0.15488524734973907,-0.004387854598462582,0.010713675059378147,-0.11142551898956299,0.2564292550086975,0.18016335368156433,0.20935527980327606,-0.2811508774757385,-0.27418094873428345,-0.27676430344581604,-0.38329756259918213,0.002169528976082802,-0.07661919295787811,0.2452990710735321,0.15521050989627838},{0.34017300605773926,-0.3526048958301544,0.14013470709323883,-0.39952710270881653,-0.25804272294044495,0.3500513434410095,0.3992553651332855,0.18811818957328796,-0.09956125169992447,0.0728449746966362,0.16488061845302582,-0.1693068891763687,0.13431891798973083,0.30355778336524963,-0.012096474878489971,0.20866654813289642,0.4045703411102295,-0.19774115085601807,-0.044461313635110855,-0.29645687341690063,0.12899254262447357,0.25428035855293274,0.2800438404083252,0.172675222158432,0.06329910457134247,0.07476739585399628,0.10228889435529709,0.24746251106262207,-0.2041507214307785,-0.19955481588840485,0.25807249546051025,0.008405824191868305},{-0.06375188380479813,-0.007925976067781448,0.23955200612545013,0.2624806761741638,-0.22297590970993042,-0.3956008553504944,-0.06264436990022659,0.21391937136650085,-0.213441401720047,-0.35749998688697815,0.16792142391204834,0.1481555849313736,0.09294693171977997,-0.2755550444126129,0.10383536666631699,-0.1743840128183365,-0.1714710295200348,0.14932459592819214,-0.2275744378566742,0.3189890682697296,-0.2274516522884369,-0.4318881928920746,-0.31715214252471924,0.20713022351264954,0.1530895084142685,0.14889362454414368,0.2699861228466034,0.21312305331230164,-0.15193232893943787,-0.3271664083003998,-0.18370260298252106,0.12975402176380157},{0.35419824719429016,-0.027648497372865677,-0.02203807793557644,0.11053728312253952,0.09201602637767792,0.2886510193347931,0.04056266322731972,0.38446173071861267,-0.0525231696665287,0.12364315986633301,0.14265049993991852,0.024802636355161667,-0.2598089277744293,-0.45426204800605774,0.10812579840421677,0.1601209193468094,0.13807156682014465,-0.14257360994815826,-0.057520609349012375,-0.13248243927955627,0.16912473738193512,-0.3453536927700043,0.27740681171417236,0.021910807117819786,-0.0941784605383873,0.13192114233970642,-0.28085917234420776,-0.17517507076263428,0.054658371955156326,0.04219221696257591,0.1596830040216446,0.32126954197883606},{-0.11648000776767731,0.09075523912906647,-0.15644218027591705,0.15663181245326996,-0.1371684968471527,0.2585505545139313,0.10553429275751114,-0.031513478606939316,0.3349052667617798,-0.27488216757774353,-0.1617186963558197,0.1733926236629486,-0.18625912070274353,0.023678703233599663,-0.3246845006942749,-0.04298964887857437,0.11426357179880142,0.1467946320772171,0.013617350719869137,-0.1912318617105484,-0.22324341535568237,0.1880691796541214,0.16797249019145966,0.18143780529499054,-0.274735689163208,0.395920991897583,-0.06331866979598999,-0.024387627840042114,-0.12308651953935623,0.10647949576377869,0.24108482897281647,0.3077157735824585},{-0.2881755828857422,0.34133416414260864,-0.01950846239924431,0.027623111382126808,-0.24093401432037354,-0.24375934898853302,0.15991055965423584,-0.3496028780937195,-0.10882928967475891,-0.38508427143096924,-0.1005035787820816,-0.035323549062013626,0.1769874393939972,-0.20565946400165558,-0.14163151383399963,-0.3053319454193115,-0.18950533866882324,-0.022429266944527626,0.3745516240596771,-0.232015460729599,0.15753228962421417,-0.26928383111953735,0.04929181560873985,0.26613345742225647,-0.10973525047302246,0.16480211913585663,0.22120410203933716,-0.08529499173164368,-0.027571145445108414,0.2944963276386261,-0.2335694581270218,-0.34906959533691406},{-0.007750191260129213,0.2420208752155304,0.17527206242084503,-0.25267890095710754,0.27165475487709045,-0.004860685672610998,-0.17238232493400574,-0.019008520990610123,0.17723140120506287,-0.25270143151283264,-0.10267046838998795,0.07408081740140915,0.15369729697704315,-0.02898060344159603,0.07052955031394958,-0.040521394461393356,0.18915130198001862,-0.330341637134552,0.2891109585762024,0.015862969681620598,-0.18961367011070251,0.2242366224527359,-0.12904052436351776,-0.26402318477630615,0.23995251953601837,-0.04118090495467186,0.04176010191440582,-0.0894574373960495,0.11042197048664093,-0.1731097549200058,0.3546147346496582,0.3104352355003357},{0.03883499279618263,-0.25563135743141174,-0.1988181471824646,0.056242961436510086,-0.04235498979687691,0.2858872711658478,-0.12983044981956482,-0.3642948865890503,0.3652161657810211,0.059064704924821854,0.03051118366420269,0.04288891702890396,-0.0718674510717392,0.2314671128988266,-0.23456229269504547,-0.37377846240997314,0.02536073513329029,0.057940512895584106,0.15479306876659393,0.47179874777793884,-0.2870946228504181,0.2046758383512497,-0.16764751076698303,0.13298466801643372,0.16838397085666656,-0.3603770434856415,-0.1595851331949234,-0.3631788194179535,-0.20855115354061127,-0.17011258006095886,0.12652522325515747,-0.4351489841938019},{-0.13083884119987488,0.3916345238685608,0.007936363108456135,-0.1421239972114563,-0.19030319154262543,-0.3042793571949005,0.07190914452075958,-0.14409053325653076,0.34168073534965515,-0.06781049072742462,0.21162036061286926,0.2849047780036926,-0.0009687504498288035,0.07555727660655975,-0.15353691577911377,0.17405977845191956,-0.2230839878320694,-0.444355309009552,-0.36368462443351746,0.0733998641371727,0.13678289949893951,-0.22361384332180023,-0.3968987762928009,-0.291961133480072,-0.09538859128952026,0.1996503323316574,0.4118131101131439,0.029448216781020164,-0.09667371213436127,-0.024480802938342094,-0.048895228654146194,0.11756458878517151},{-0.26485028862953186,-0.1666330099105835,-0.18096207082271576,0.06804286688566208,-0.27853453159332275,-0.1550188809633255,-0.07903581112623215,-0.14914889633655548,-0.3276861310005188,-0.2876012921333313,0.23717379570007324,0.15481755137443542,-0.28379714488983154,0.29199716448783875,-0.060915909707546234,0.14643536508083344,0.07843054831027985,0.047166142612695694,0.06850593537092209,0.18905016779899597,0.2205525040626526,0.23501189053058624,0.1256534457206726,0.2658040225505829,0.12256503105163574,-0.23602475225925446,-0.18699391186237335,0.22947339713573456,-0.06751976907253265,-0.18965975940227509,-0.21518193185329437,-0.23705631494522095},{-0.27578768134117126,-0.19700804352760315,-0.35297197103500366,0.10267595946788788,-0.09450934827327728,-0.06286893039941788,-0.11247526854276657,0.12470822036266327,-0.07412903010845184,0.07179773598909378,-0.23010945320129395,0.022941457107663155,0.171175017952919,-0.0964374840259552,0.049849990755319595,0.21822965145111084,-0.12621860206127167,-0.14621686935424805,0.17806346714496613,0.0551580972969532,0.19054384529590607,-0.012462496757507324,-0.21330511569976807,0.04356994852423668,0.21010521054267883,-0.2580864429473877,0.145102396607399,0.07298676669597626,0.0852588638663292,-0.15797357261180878,0.24530234932899475,-0.06088446453213692},{0.2435351461172104,-0.013896171003580093,0.013399844989180565,0.17548538744449615,-0.3256343901157379,-0.024038881063461304,0.10089346021413803,0.18735371530056,-0.07076661288738251,-0.1507577747106552,0.3034185767173767,-0.1181507408618927,0.044181156903505325,-0.04264870658516884,-0.14684680104255676,0.2556159198284149,-0.030897941440343857,-0.11841557919979095,0.0993022695183754,-0.30582016706466675,-0.017573658376932144,-0.26246175169944763,-0.2127065658569336,0.23058277368545532,-0.06081005558371544,-0.05352133885025978,0.15492373704910278,0.045427169650793076,-0.16861768066883087,-0.07144862413406372,-0.04317430406808853,-0.0623505525290966},{0.3075152337551117,-0.07113579660654068,0.0887787714600563,0.0473850853741169,-0.03646480292081833,-0.0980270579457283,0.18451382219791412,-0.2506619393825531,0.26503026485443115,0.29295605421066284,0.02493809349834919,0.13959427177906036,0.2514711022377014,0.3562183380126953,-0.2901484966278076,-0.34547942876815796,-0.25439321994781494,0.08226382732391357,-0.16127556562423706,-0.2683158814907074,-0.17771615087985992,0.2726937234401703,0.06296873092651367,0.1524033397436142,-0.13780784606933594,-0.1355852335691452,-0.1480485498905182,-0.24504531919956207,0.2354946881532669,0.18444642424583435,-0.3228747248649597,-0.14726585149765015},{-0.10702173411846161,0.14864391088485718,0.26229128241539,-0.043223895132541656,-0.044147126376628876,0.05878075584769249,-0.029622359201312065,-0.33165785670280457,0.21351724863052368,0.24635553359985352,0.15544317662715912,0.23333200812339783,-0.2165297269821167,0.2119699865579605,-0.27878183126449585,0.29607921838760376,0.16697853803634644,-0.2609388828277588,0.22078996896743774,0.09682057052850723,-0.3473581373691559,0.3359534442424774,-0.2737395763397217,0.14466412365436554,0.24034659564495087,0.2699306607246399,0.07477129250764847,0.1356731653213501,-0.18814828991889954,0.21442627906799316,-0.0408686138689518,0.11130008846521378},{-0.11699531972408295,-0.11289671808481216,-0.0011129947379231453,0.1812683343887329,0.01958034373819828,0.21454593539237976,-0.27701833844184875,-0.10094210505485535,-0.12655191123485565,-0.07736045867204666,-0.16106486320495605,-0.1770145148038864,0.02237541787326336,-0.18992359936237335,0.0868370532989502,-0.2062709629535675,0.24499496817588806,-0.030880192294716835,-0.3267322778701782,-0.2847132980823517,0.12268661707639694,0.17565707862377167,-0.18171431124210358,0.3026849627494812,-0.2531437575817108,0.05873250961303711,0.1115196943283081,-0.0920926183462143,0.15385836362838745,-0.22383202612400055,0.31166398525238037,0.15358293056488037},{0.3353995978832245,0.03581400215625763,0.10318392515182495,0.20060694217681885,-0.21646395325660706,0.18556061387062073,-0.08034270256757736,0.1663355529308319,0.09789416193962097,0.060727525502443314,0.07998798787593842,-0.33706915378570557,-0.2502155900001526,0.027859488502144814,0.10462207347154617,-0.06865968555212021,0.2642068564891815,0.15335078537464142,-0.1751575767993927,-0.20660580694675446,0.31038418412208557,0.2016560286283493,0.27023860812187195,0.1006670668721199,-0.03902978450059891,0.032600488513708115,-0.07942061871290207,-0.1691548228263855,0.2778761386871338,0.051781877875328064,-0.18299545347690582,0.11622529476881027},{-0.020423315465450287,0.013380907475948334,-0.05493202432990074,-0.23849725723266602,-0.0871688574552536,-0.2195175439119339,-0.22327406704425812,-0.1385086327791214,-0.014463302679359913,-0.0168163925409317,-0.27089372277259827,0.01935907080769539,-0.22098244726657867,-0.15704034268856049,0.004351441282778978,0.10086911916732788,0.2697436809539795,-0.1792355328798294,-0.32919859886169434,0.2592483460903168,-0.1882227212190628,0.2812660336494446,0.023063261061906815,-0.0353170707821846,0.033797554671764374,0.1588984727859497,-0.0788286104798317,-0.25780463218688965,0.22300931811332703,0.24654793739318848,-0.12093274295330048,0.18114648759365082},{-0.2502937912940979,-0.029214713722467422,0.03822973370552063,-0.036550287157297134,0.09931295365095139,0.130998894572258,-0.17877478897571564,0.11998311430215836,-0.1719191074371338,-0.1635850965976715,0.10150321573019028,-0.1389940232038498,-0.20539844036102295,0.2347460240125656,0.010196711868047714,0.02394576370716095,0.2005121409893036,-0.2476252317428589,-0.16400311887264252,0.27340221405029297,0.04343103989958763,0.22802910208702087,-0.051110826432704926,0.021145669743418694,-0.28277257084846497,-0.17898818850517273,0.0198835376650095,0.28853410482406616,0.002307034097611904,0.013074765913188457,0.27985879778862,0.3068094253540039}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.07578033953905106,0.23962806165218353,0.4448683559894562,-0.07817018032073975},{0.13170865178108215,-0.1569172590970993,0.07077134400606155,0.2421666830778122},{-0.15413407981395721,0.19201233983039856,0.16473090648651123,0.13531464338302612},{0.3110491931438446,0.013133524917066097,0.036733195185661316,0.4703349471092224},{-0.12869395315647125,0.09384474158287048,0.38402295112609863,-0.07373499870300293},{-0.10783999413251877,0.2598949074745178,0.2774377465248108,-0.17292115092277527},{-0.30869555473327637,-0.01348696369677782,0.0088902423158288,-0.12991803884506226},{-0.41310712695121765,-0.17083878815174103,0.44932061433792114,-0.33089327812194824},{0.39700016379356384,-0.16083239018917084,-0.30157670378685,-0.4459702670574188},{0.07441116124391556,0.3504975438117981,0.38898321986198425,-0.5225734114646912},{-0.19869129359722137,-0.18489418923854828,-0.24045276641845703,0.20194929838180542},{0.41571447253227234,-0.244246244430542,-0.04151888191699982,0.2293633371591568},{0.34269335865974426,0.27818915247917175,-0.05996061861515045,0.12711481750011444},{0.036463260650634766,0.13509587943553925,-0.33641016483306885,-0.009430676698684692},{0.1048879399895668,0.31491923332214355,0.4433385729789734,0.3517268896102905},{0.1943036913871765,0.016690166667103767,0.3293692171573639,0.2541566491127014},{-0.27018076181411743,-0.08444228023290634,-0.10551238805055618,-0.3091338276863098},{-0.26277050375938416,0.15576431155204773,-0.18221305310726166,-0.10609272122383118},{-0.24069459736347198,0.23344746232032776,0.18193753063678741,0.3580758273601532},{-0.04625212773680687,0.36326107382774353,-0.21989557147026062,0.09920533001422882},{-0.3154015839099884,-0.39525121450424194,-0.11126542836427689,0.052053727209568024},{0.4060169458389282,0.5406430959701538,0.04425512254238129,-0.36141738295555115},{-0.07864131778478622,0.22177281975746155,0.2563503682613373,0.17167149484157562},{-0.11897595226764679,0.41719552874565125,-0.08714577555656433,-0.16394883394241333},{0.06078946590423584,-0.04322871193289757,-0.12403703480958939,0.04191857576370239},{0.3285033106803894,-0.5130755305290222,6.164799560792744e-05,0.03313449025154114},{0.02122926339507103,-0.4088071584701538,-0.23876453936100006,-0.2137954831123352},{0.1256268173456192,-0.1817871332168579,0.21756485104560852,0.22527064383029938},{0.011228782124817371,-0.05311591923236847,0.13069486618041992,0.05313027277588844},{-0.41166144609451294,0.3808133602142334,0.2455512136220932,-0.07052002847194672},{0.3734806478023529,-0.16005811095237732,0.23990876972675323,-0.11818524450063705},{0.09204422682523727,-0.4701620638370514,0.4766335189342499,-0.3702140748500824}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.05739507079124451,-0.028132107108831406,0.03646892309188843,-0.03261030837893486,-0.034316327422857285,-0.14370699226856232,-0.09566482156515121,0.05765427276492119,0.038013000041246414,-0.03339722007513046,0.09830287843942642,0.0658995732665062,-0.07532700896263123,-0.11354854702949524,0.07043304294347763,-0.07745767384767532};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.05948547646403313,0.05381912365555763,0.027595674619078636,0.018389645963907242,0.06748155504465103,-0.017139744013547897,0.07827451080083847,-0.010911227203905582,-0.015881700441241264,0.02070443704724312,-0.023253366351127625,-0.03812425211071968,0.07347015291452408,-0.03747760131955147,-0.0316019244492054,-0.025070616975426674};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06520818918943405,0.06790418177843094,0.019861994311213493,0.06371372193098068,0.044940825551748276,-0.012508640065789223,-0.03757183998823166,-0.01650763489305973,-0.02731185033917427,0.0064015015959739685,-0.04620818793773651,0.046280741691589355,0.05117228999733925,-0.0666915625333786,0.07725955545902252,0.07616235315799713,-0.06591948866844177,-0.06517323851585388,0.02462952956557274,0.005753418896347284,-0.04095036908984184,0.007985520176589489,0.06606055051088333,-0.000848340627271682,-0.02357654459774494,0.008784860372543335,-0.05207142233848572,0.053346384316682816,0.041178859770298004,0.007617676164954901,0.03694240003824234,0.03679322451353073};
static const float action_parameterization_distribution_linear_bias[4] = {0.03617759048938751,0.008634542115032673,0.05228536203503609,0.04980853945016861};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.02422875352203846,0.2594754993915558,-0.14744138717651367,0.19706827402114868,0.23806220293045044,0.12442702800035477,0.28860485553741455,-0.004837485961616039},{-0.1936243325471878,-0.0705840215086937,-0.27837809920310974,-0.249180406332016,-0.3011550307273865,-0.17112144827842712,-0.11915803700685501,-0.17867892980575562},{-0.2702009975910187,0.0015973662957549095,0.24645334482192993,0.21868756413459778,0.2480323761701584,-0.019903576001524925,0.23507030308246613,-0.08214665204286575},{-0.0069948965683579445,0.06812141835689545,-0.1658729910850525,-0.016899295151233673,-0.02035396359860897,-0.05970937758684158,0.237441748380661,-0.16152694821357727},{-0.31334060430526733,-0.14337041974067688,-0.2235134243965149,-0.146111398935318,-0.04694507643580437,0.16603997349739075,0.15742620825767517,-0.03745698183774948},{-0.30381473898887634,-0.022407952696084976,0.38881823420524597,0.23469752073287964,0.1797577291727066,-0.11900443583726883,-0.14654037356376648,-0.12539882957935333},{-0.21472400426864624,0.04813900962471962,0.40430325269699097,-0.20591425895690918,-0.09816481173038483,-0.4260577857494354,-0.1104755848646164,-0.13387702405452728},{-0.33852049708366394,-0.36372631788253784,0.5111265778541565,-0.0946100577712059,-0.2223697453737259,0.1996230036020279,0.14349518716335297,-0.21950221061706543},{-0.3051915168762207,0.26395905017852783,-0.17656396329402924,0.3840488791465759,0.0666934922337532,-0.37072208523750305,0.08274471014738083,0.08263055235147476},{-0.29962876439094543,-0.3137286603450775,-0.14939287304878235,-0.19420158863067627,-0.5290487408638,0.08349733054637909,-0.008721116930246353,0.11032968759536743},{0.17287352681159973,0.34318020939826965,0.2091444432735443,-0.02211790159344673,0.15757976472377777,0.09411439299583435,-0.22252912819385529,0.17957283556461334},{0.2024267315864563,0.0319046750664711,0.28210845589637756,0.24432821571826935,-0.28466475009918213,0.28550079464912415,-0.005141871515661478,-0.24885161221027374},{0.11452251672744751,-0.2813217043876648,0.2727040648460388,-0.0439152829349041,-0.27993252873420715,-0.07394571602344513,-0.17238068580627441,-0.13423147797584534},{-0.2162993997335434,-0.1554793417453766,0.3188788890838623,0.3540000021457672,-0.17306649684906006,-0.06181539222598076,-0.2974095046520233,0.1938692033290863},{0.017154840752482414,-0.14874804019927979,0.09387246519327164,-0.23123231530189514,-0.35649657249450684,-0.13569273054599762,0.21559211611747742,0.014828628860414028},{0.13485172390937805,-0.03405167534947395,-0.0307124312967062,-0.31326180696487427,-0.06310053914785385,0.06136462837457657,-0.007376453839242458,0.41890525817871094},{-0.017166797071695328,-0.22885550558567047,-0.1902972310781479,0.020560864359140396,-0.11103246361017227,-0.11991281807422638,-0.12366105616092682,0.09520985931158066},{-0.17606602609157562,-0.27727606892585754,0.061155688017606735,-0.0022705693263560534,0.205565944314003,-0.20847567915916443,0.3799627125263214,0.13091138005256653},{0.05767673999071121,0.10879349708557129,-0.22941060364246368,0.07540000975131989,0.16209188103675842,0.1552780568599701,-0.18186260759830475,0.29419130086898804},{0.18330903351306915,-0.05429968237876892,-0.3536028563976288,0.045609693974256516,-0.016539299860596657,-0.08563753217458725,-0.2939581573009491,-0.020546741783618927},{0.06603918224573135,-0.1494990736246109,0.04323539510369301,-0.1373492330312729,0.3007960021495819,-0.038095708936452866,-0.07741440087556839,0.43552589416503906},{0.015829605981707573,0.13677477836608887,-0.29059481620788574,0.21068014204502106,0.30446702241897583,0.281194806098938,0.12400256097316742,-0.2863018214702606},{-0.39074304699897766,-0.09313736110925674,0.12858940660953522,-0.0884266123175621,0.20306169986724854,-0.3467801511287689,0.163332000374794,-0.24428309500217438},{-0.12205243110656738,0.10063530504703522,-0.08722458779811859,-0.4014933109283447,0.2699979245662689,-0.014483004808425903,-0.3665000796318054,0.2071927785873413},{-0.1886766254901886,-0.17156954109668732,-0.018214914947748184,0.07639212161302567,0.0018279908690601587,0.19573739171028137,0.2874138057231903,-0.061198171228170395},{-0.19352415204048157,0.07280570268630981,-0.3325943350791931,-0.2831687927246094,0.1488734781742096,-0.004183409735560417,-0.08871419727802277,0.09566925466060638},{0.32145318388938904,0.3782844841480255,-0.2430465668439865,0.20073039829730988,0.1542833298444748,0.3032785654067993,-0.2888588011264801,-0.13645118474960327},{0.39464807510375977,0.24625161290168762,0.10913731157779694,0.08583693951368332,0.22383715212345123,0.07886676490306854,0.2417243868112564,0.37756577134132385},{-0.1184501126408577,0.38776737451553345,0.1858319640159607,0.016232239082455635,0.2212514728307724,0.00381149142049253,-0.38249528408050537,-0.30034759640693665},{-0.14050380885601044,-0.23634938895702362,0.07650209963321686,-0.1968391090631485,-0.2847006320953369,-0.21698272228240967,0.2629418969154358,-0.03791116923093796},{0.43157655000686646,-0.2728021442890167,0.3091605305671692,-0.2575409710407257,0.09000644087791443,0.2368575781583786,0.13983018696308136,-0.19217315316200256},{0.264994740486145,0.39012598991394043,0.36346322298049927,-0.2386729121208191,-0.16694393754005432,0.0954599604010582,0.21995563805103302,0.07275675237178802}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.015512472949922085,0.39527884125709534,-0.18065233528614044,0.24959824979305267,-0.3953072130680084,0.2650895118713379,0.43519124388694763,0.07106523960828781},{-0.43090540170669556,-0.4899155795574188,-0.3777306079864502,-0.44827181100845337,-0.4337617754936218,0.4041077196598053,0.44688206911087036,-0.4190864562988281},{-0.025879181921482086,-0.16310979425907135,0.11930985748767853,0.05019175261259079,-0.0721466988325119,0.443324476480484,-0.3479294180870056,-0.3569852113723755},{0.4961559772491455,0.007558623794466257,0.08855722099542618,-0.017155854031443596,0.5441005229949951,0.3765546679496765,0.3356337547302246,0.4188406467437744},{0.08108019083738327,0.2566641569137573,-0.1635979264974594,-0.11129514873027802,0.11242316663265228,-0.3522948622703552,-0.3637525737285614,0.4628153443336487},{0.3956955075263977,0.08556779474020004,0.03677283972501755,-0.38147637248039246,-0.43062442541122437,-0.4857774078845978,-0.11064226925373077,0.5076494812965393},{-0.46297112107276917,-0.3438347578048706,-0.034038204699754715,-0.2256416380405426,0.019537918269634247,0.43176010251045227,-0.534604012966156,0.5962898135185242},{0.227007195353508,0.0765538439154625,0.007830624468624592,-0.02922978438436985,0.4036528766155243,-0.5430084466934204,0.4358479380607605,-0.40666279196739197}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.05096045881509781,0.033982668071985245,0.055846892297267914,-0.03631040081381798,-0.01449279673397541,0.01610940508544445,0.039385415613651276,-0.007933289743959904};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0012927677016705275,-0.033785391598939896,0.021300183609128,-0.08947711437940598,-0.011656570248305798,-0.010399289429187775,-0.034535713493824005,-0.06436368823051453};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

