#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3319701850414276,0.07330495864152908,0.01651301607489586,0.2536068558692932,0.3696395456790924,-0.2741405665874481,-0.29916277527809143,0.1645512878894806,0.35510513186454773,-0.285828560590744,0.4281819760799408,0.042824260890483856,0.28144708275794983,0.10606349259614944,-0.2833051085472107,0.03048858419060707},{-0.3282614052295685,-0.21211004257202148,-0.3112255334854126,-0.12783847749233246,0.18758980929851532,0.35403144359588623,0.13325749337673187,0.016730699688196182,0.1537681370973587,0.20868609845638275,-0.13376294076442719,0.009630996733903885,-0.0760350152850151,0.14611947536468506,0.2797687351703644,-0.2342212051153183},{0.055821552872657776,0.2836456298828125,0.13142436742782593,0.2411336451768875,-0.022689443081617355,-0.2438708245754242,0.6236361265182495,-0.1911996603012085,-0.07358129322528839,-0.08444016426801682,-0.039341602474451065,-0.16225428879261017,0.13705123960971832,0.5305901169776917,-0.4106850028038025,0.04696813225746155},{0.1355690211057663,-0.15226568281650543,-0.13475938141345978,-0.04469749704003334,-0.2095472812652588,0.01853037439286709,-0.01740420050919056,-0.2729736566543579,-0.04840155318379402,-0.1226043626666069,0.5766392946243286,-0.27215576171875,-0.3263707458972931,-0.13897457718849182,0.21517644822597504,-0.023416364565491676},{-0.24270769953727722,-0.026632510125637054,0.2362918257713318,-0.4643157720565796,0.478781521320343,0.17284142971038818,0.2375882863998413,-0.19258761405944824,-0.1644037663936615,0.24754157662391663,-0.048133961856365204,-0.42334797978401184,0.009176382794976234,-0.2297140657901764,0.4336012899875641,-0.021795939654111862},{-0.033211905509233475,-0.11310527473688126,-0.1140950620174408,-0.13369783759117126,0.10685215890407562,-0.30133605003356934,0.5441330671310425,-0.30078572034835815,-0.18390227854251862,-0.23203125596046448,0.22375252842903137,0.06762438267469406,0.33500373363494873,0.019975243136286736,0.3331814110279083,0.278408408164978},{-0.26122263073921204,0.325555682182312,-0.02377895452082157,0.04356013238430023,-0.2947484254837036,-0.12067264318466187,-0.14976398646831512,-0.022145653143525124,0.2849207818508148,0.3468245267868042,-0.2629531919956207,-0.10130424052476883,0.28230351209640503,0.012456158176064491,-0.1232278123497963,0.3213036060333252},{-0.23066909611225128,0.11179354786872864,0.02234693057835102,-0.25097939372062683,0.33664053678512573,-0.252514511346817,-0.26742857694625854,-0.44202953577041626,-0.08309490978717804,-0.2778869867324829,0.5355513691902161,0.11694846302270889,0.05073321983218193,0.3206912875175476,0.03695105016231537,0.5577194690704346},{0.22693559527397156,0.15648145973682404,-0.08531699329614639,0.016004500910639763,-0.5320650935173035,-0.5277188420295715,0.1409013867378235,-0.5772538781166077,-0.059604618698358536,-0.08698190748691559,0.29223692417144775,-0.543054461479187,-0.4847508668899536,0.13802093267440796,0.12070288509130478,-0.25506001710891724},{0.523716926574707,-0.7406908869743347,-0.28185755014419556,0.08007140457630157,0.2340332418680191,-0.2911224663257599,-0.16996391117572784,-0.20756445825099945,-0.3275769054889679,0.03213987872004509,-0.30303293466567993,-0.2732602655887604,0.6191363334655762,-0.1900235116481781,-0.692021906375885,-0.16868123412132263},{0.24859759211540222,0.34847742319107056,-0.17211957275867462,0.11976872384548187,-0.028171710669994354,-0.23405767977237701,-0.21965394914150238,0.12120935320854187,-0.07590315490961075,0.2142917662858963,0.18249475955963135,0.2990419864654541,-0.13516247272491455,0.20578426122665405,0.01120658777654171,-0.256604939699173},{-0.36658981442451477,0.22322101891040802,0.4475715160369873,-0.7046155333518982,-0.06606755405664444,0.08174389600753784,0.029511768370866776,0.2574092745780945,0.32204920053482056,0.3749840259552002,0.3887408375740051,-0.1767156571149826,0.15277738869190216,-0.18991371989250183,0.100902259349823,-0.2126036435365677},{0.17645971477031708,-0.34453627467155457,-0.2657988965511322,0.3888656198978424,-0.2058563530445099,-0.3222508728504181,-0.0016243299469351768,0.3584071397781372,0.1152324229478836,-0.10014083236455917,-0.4036409258842468,0.27812907099723816,0.515028715133667,0.34858810901641846,-0.2349380999803543,0.647878110408783},{0.2568883001804352,0.21063798666000366,-0.3977486789226532,0.1335969865322113,-0.07425299286842346,-0.2037803828716278,-0.22593280673027039,0.12296552956104279,-0.3812614679336548,-0.4037143290042877,-0.10992095619440079,0.06573766469955444,-0.5625244379043579,-0.050894126296043396,-0.4032876193523407,-0.1062951311469078},{0.12467889487743378,0.5911037921905518,0.49683138728141785,-0.515984058380127,-0.27137377858161926,0.29439613223075867,-0.059729158878326416,0.0633595883846283,0.5311840176582336,0.3601545989513397,-0.11447717994451523,0.06803107261657715,-0.11648784577846527,-0.41241875290870667,0.18537186086177826,-0.3535075783729553},{-0.3347035348415375,-0.08449610322713852,-0.04018019139766693,0.2578153908252716,-0.08127347379922867,0.030681712552905083,-0.19074593484401703,-0.05774714797735214,-0.36699044704437256,-0.12056411057710648,0.3233526647090912,0.16824348270893097,-0.253428190946579,-0.2488684505224228,-0.41892170906066895,-0.1419115662574768},{-0.36545661091804504,0.15305893123149872,-0.2829974293708801,0.011112119071185589,-0.1444181650876999,0.3231983184814453,0.379739910364151,0.17860153317451477,0.2550285756587982,-0.22559191286563873,-0.06306169182062149,-0.11398966610431671,0.01566092111170292,0.05232945457100868,-0.03453219309449196,-0.15010026097297668},{0.13845087587833405,-0.4357840418815613,0.18255777657032013,0.1969030648469925,-0.014183451421558857,0.3262200653553009,0.3299250900745392,0.14939938485622406,-0.18111668527126312,-0.27066171169281006,-0.14198626577854156,-0.08741258829832077,-0.1474323570728302,-0.4013795554637909,0.10904569178819656,0.03117859922349453}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15078045427799225,0.30416685342788696,0.34297698736190796,-0.09326590597629547,-0.24300554394721985,0.09638343006372452,0.02577957883477211,0.2849116623401642,-0.03866705670952797,0.288808673620224,0.47346460819244385,-0.3627890646457672,-0.09716212004423141,0.051713623106479645,0.03577885776758194,-0.05237279087305069},{-0.5456576943397522,0.24854540824890137,-0.30286481976509094,0.2630639672279358,0.3682321012020111,-0.18965789675712585,-0.3401734530925751,-0.28395429253578186,0.3441898226737976,0.29530271887779236,-0.04773205891251564,0.25678113102912903,-0.37384453415870667,0.16200318932533264,-0.27104848623275757,0.4705461859703064},{-0.39199668169021606,0.2180250883102417,-0.37204045057296753,0.01819988712668419,-0.40514513850212097,-0.29030361771583557,-0.1033749207854271,-0.0017868574941530824,-0.24142087996006012,0.3771682381629944,0.23721849918365479,-0.0886819064617157,0.27264857292175293,-0.3406050205230713,-0.0846184641122818,-0.005867805331945419},{0.296713262796402,-0.23768019676208496,0.09890115261077881,0.4528406262397766,-0.44020307064056396,-0.43262287974357605,0.28323742747306824,0.11196920275688171,0.2780408263206482,-0.10447142273187637,0.34830519556999207,0.09637029469013214,-0.2637399733066559,-0.022198429331183434,-0.014706864953041077,-0.381289005279541},{-0.41151031851768494,0.05061397701501846,0.24171005189418793,-0.38104286789894104,0.18071283400058746,0.366953045129776,-0.3109997510910034,0.20966877043247223,-0.21712304651737213,0.21535761654376984,-0.09292767941951752,-0.01296921819448471,-0.11591783910989761,-0.0335179828107357,-0.20121705532073975,-0.1597474366426468},{0.00973715540021658,-0.2496151328086853,-0.015632441267371178,-0.35085901618003845,0.2948373258113861,0.067861407995224,-0.0349280871450901,-0.07467391341924667,-0.21933695673942566,0.37307411432266235,0.28267982602119446,-0.08435546606779099,-0.18709200620651245,0.2135334461927414,-0.05223149433732033,-0.3556300401687622},{0.2522113025188446,-0.1343272626399994,0.3461942970752716,-0.29679563641548157,-0.36173582077026367,-0.02744189463555813,-0.3720795512199402,0.3646351099014282,-0.09431028366088867,-0.24493548274040222,-0.25749677419662476,-0.044404394924640656,-0.04000821337103844,-0.1051596850156784,0.476117342710495,-0.36501315236091614},{-0.2808648943901062,0.364990234375,-0.09449660778045654,0.31500300765037537,0.023768499493598938,-0.2788127660751343,-0.10021612793207169,0.15307417511940002,-0.08925694227218628,0.4865095913410187,0.1508537232875824,-0.21676228940486908,-0.027424044907093048,-0.08743887394666672,0.026125885546207428,0.13097497820854187},{0.08936405926942825,0.2868863642215729,-0.17904122173786163,-0.35332179069519043,0.38627034425735474,-0.21341155469417572,0.1806996464729309,-0.3463418781757355,0.1299259066581726,0.036377619951963425,0.11360663175582886,0.1433333307504654,-0.02395922690629959,-0.32874059677124023,-0.06784258782863617,0.2250390201807022},{-0.2501354217529297,-0.003792419098317623,-0.31926485896110535,-0.33867931365966797,0.23741920292377472,-0.4266500174999237,-0.1919800490140915,0.27800366282463074,-0.1348995566368103,0.2368948608636856,-0.054644133895635605,-0.09968301653862,-0.3470275104045868,-0.003937903791666031,-0.2525409758090973,-0.3416762053966522},{-0.24964341521263123,-0.09866330772638321,-0.07003196328878403,-0.35209059715270996,-0.34341979026794434,-0.031924325972795486,0.1490827053785324,-0.5291363000869751,0.016652245074510574,-0.05897585302591324,0.20777645707130432,0.0032305314671248198,0.4407646954059601,0.05714654177427292,0.21945957839488983,0.2473582774400711},{-0.18094173073768616,-0.0449146144092083,-0.41981855034828186,0.33059680461883545,0.11937865614891052,-0.07536038011312485,0.18389132618904114,0.09171590209007263,-0.41946500539779663,0.21288982033729553,-0.2929783761501312,-0.1630844622850418,-0.38873374462127686,0.43370458483695984,-0.3554035723209381,0.09014250338077545},{-0.20054471492767334,-0.44137638807296753,-0.15102234482765198,0.1733703464269638,-0.1589132398366928,-0.11144524067640305,-0.1206832006573677,0.42114633321762085,0.4215796887874603,0.10082198679447174,-0.09890249371528625,-0.25860971212387085,0.17931872606277466,-0.39543256163597107,0.12336791306734085,-0.23778507113456726},{-0.2825142443180084,-0.44146889448165894,-0.19154314696788788,-0.08611810952425003,-0.44536349177360535,0.43243977427482605,-0.05850423872470856,0.20599545538425446,-0.17588141560554504,-0.34161123633384705,-0.31461235880851746,0.41970616579055786,-0.24611970782279968,0.07702135294675827,-0.2954682409763336,0.39306312799453735},{-0.3688909709453583,0.3497173488140106,-0.1780683994293213,0.11784514784812927,-0.3874250650405884,0.3198787271976471,0.024490680545568466,-0.3681263029575348,0.12107164412736893,0.1942049115896225,-0.21812982857227325,0.08869978785514832,0.2745526432991028,-0.26631322503089905,-0.34736168384552,-0.1480637788772583},{-0.15296787023544312,-0.395439475774765,-0.5490925908088684,0.315376341342926,-0.005639986600726843,0.17291957139968872,-0.3133015036582947,0.21881188452243805,-0.43932658433914185,-0.3297542631626129,-0.4268231689929962,0.2600514888763428,-0.22216078639030457,0.1835145354270935,0.10370524227619171,0.285374253988266}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07783477008342743,-0.13465508818626404,0.07883600890636444,-0.1647898256778717,-0.1092040091753006,0.09305104613304138,0.18759877979755402,-0.21428637206554413,-0.06998511403799057,0.3199109733104706,0.07482589036226273,0.14034120738506317,0.07584366202354431,0.14577385783195496,-0.2248946726322174,0.12887004017829895,0.13445977866649628,-0.30731502175331116,-0.3021228313446045,-0.12570910155773163,-0.16504614055156708,0.13382942974567413,-0.26289287209510803,0.36058786511421204,-0.16138683259487152,-0.005634920671582222,0.16073638200759888,0.1759464293718338,-0.26845434308052063,-0.23287184536457062,0.2517898678779602,0.31977981328964233},{0.18159598112106323,-0.027325952425599098,0.17630308866500854,-0.049054622650146484,-0.11631916463375092,0.21552704274654388,-0.018494000658392906,-0.09334566444158554,-0.05492745339870453,-0.06349818408489227,-0.10769465565681458,0.04412631690502167,0.4006868600845337,0.21213427186012268,0.14610745012760162,0.07682535797357559,-0.26956069469451904,-0.3206525146961212,0.1082070842385292,0.050683822482824326,0.060957908630371094,0.27645960450172424,0.27005624771118164,-0.17978569865226746,0.04302278161048889,0.3099115490913391,-0.34602072834968567,0.2210904359817505,0.14289699494838715,-0.24224722385406494,-0.05812351405620575,-0.024296414107084274},{-0.09334998577833176,-0.05022919923067093,0.1366349160671234,-0.15490877628326416,-0.21663640439510345,-0.02028304897248745,-0.2824449837207794,0.16337937116622925,0.29734766483306885,-0.006424539256840944,-0.2210131585597992,0.12469913810491562,0.3598420321941376,-0.21699368953704834,0.06707347184419632,-0.03148268163204193,-0.40764328837394714,0.20952200889587402,-0.40970882773399353,-0.07357452809810638,-0.051512449979782104,-0.07741957157850266,-0.10305959731340408,-0.08549589663743973,0.0055467514321208,0.43395745754241943,-0.02335028164088726,0.1240842193365097,0.2907426059246063,-0.43226420879364014,-0.07751932740211487,0.034249354153871536},{0.19655272364616394,-0.27137887477874756,0.02403673157095909,-0.4239869713783264,0.13627077639102936,-0.06423536688089371,-0.022070422768592834,0.24684996902942657,0.05314208194613457,0.27691635489463806,0.025499703362584114,-0.18225038051605225,-0.21800386905670166,-0.09407887607812881,0.2551751732826233,-0.23810283839702606,0.07487599551677704,-0.05491526424884796,-0.15937034785747528,0.0976552665233612,-0.16570478677749634,0.1801513135433197,-0.23585201799869537,0.33415353298187256,-0.3078760504722595,0.0053182486444711685,-0.07345133274793625,-0.26797762513160706,-0.020269019529223442,0.06566993147134781,0.224087655544281,-0.13850833475589752},{0.2664138972759247,-0.015982044860720634,0.055932193994522095,0.2686747610569,-0.24727822840213776,-0.07503894716501236,0.18459804356098175,-0.0008893458871170878,0.09920825809240341,-0.18975847959518433,0.008780771866440773,-0.07715831696987152,-0.20235399901866913,-0.1642032414674759,0.3166603147983551,0.28682777285575867,-0.06091546639800072,-0.34002920985221863,0.1653773933649063,-0.12492529302835464,-0.1228765994310379,0.21008776128292084,0.2666763663291931,0.005594009533524513,-0.1098284125328064,-0.11448311805725098,0.004305071197450161,0.27202776074409485,0.2693822681903839,0.11698552221059799,0.12452652305364609,-0.23001855611801147},{0.27282580733299255,-0.177274689078331,0.01845620758831501,0.09151999652385712,-0.17961876094341278,-0.3283388018608093,-0.24417221546173096,-0.3593143820762634,-0.1803566813468933,0.010664728470146656,-0.036478087306022644,-0.0037198730278760195,-0.061811331659555435,0.0020287155639380217,-0.2190481275320053,-0.3003543019294739,0.17454880475997925,0.053231243044137955,-0.3198128342628479,0.2742343544960022,-0.0955396220088005,-0.18486645817756653,0.19529610872268677,-0.10822689533233643,-0.1350814551115036,-0.24946676194667816,-0.12602011859416962,0.05087518319487572,0.06898685544729233,0.23889116942882538,-0.32083484530448914,0.13446146249771118},{0.19504964351654053,0.07247146964073181,0.23598095774650574,-0.15920498967170715,0.24352556467056274,-0.1988409161567688,-0.3076338768005371,-0.01686483435332775,0.29989737272262573,0.14999379217624664,-0.17737241089344025,0.1297556459903717,0.0861855074763298,0.31293749809265137,0.11834399402141571,-0.04072490334510803,-0.23867906630039215,0.1340179443359375,-0.015000593848526478,-0.03789570927619934,-0.09753555804491043,0.24195286631584167,0.17161303758621216,0.1472574919462204,-0.30773285031318665,-0.22728852927684784,-0.27651798725128174,-0.35414066910743713,0.03900020197033882,-0.12437590956687927,0.30072927474975586,0.14341536164283752},{0.3512570858001709,-0.4247412383556366,0.06897984445095062,-0.4723888039588928,-0.2776012420654297,0.3580430746078491,0.47230470180511475,0.26986047625541687,-0.06517544388771057,0.14028503000736237,0.1831490397453308,-0.19948500394821167,0.012558101676404476,0.23650948703289032,-0.058998897671699524,0.16645966470241547,0.48960548639297485,-0.25575536489486694,-0.0842163935303688,-0.424127995967865,0.2123769223690033,0.2376505434513092,0.2068765014410019,0.13990506529808044,0.13014574348926544,0.09781225025653839,0.19190844893455505,0.2778956890106201,-0.1249270960688591,-0.23707157373428345,0.2586648762226105,0.11458028852939606},{0.038186803460121155,-0.0644349679350853,0.18557387590408325,0.2821396291255951,-0.22742164134979248,-0.35190293192863464,-0.10877414047718048,0.22523684799671173,-0.16502276062965393,-0.22666233777999878,0.03552628681063652,0.16149666905403137,0.14629162847995758,-0.30872952938079834,0.13244375586509705,-0.15889647603034973,-0.23432205617427826,0.13174620270729065,-0.300563246011734,0.2605189085006714,-0.32862403988838196,-0.3047481179237366,-0.32427269220352173,0.20997534692287445,0.11407158523797989,0.1305474042892456,0.32649877667427063,0.23494288325309753,-0.1402086466550827,-0.3632217347621918,-0.10705862194299698,0.17605413496494293},{0.39521142840385437,0.07428298890590668,0.09120362251996994,0.24958282709121704,0.12037667632102966,0.2985761761665344,-0.032678764313459396,0.28782764077186584,-0.1453615128993988,0.052123550325632095,0.16198696196079254,0.09459120780229568,-0.10841860622167587,-0.4147240221500397,0.2554079294204712,0.2610173523426056,0.0009032383095473051,-0.1970173418521881,0.051739178597927094,-0.0045624105259776115,0.08148077130317688,-0.34430715441703796,0.4396616220474243,0.010442201048135757,-0.0985097661614418,0.0935228019952774,-0.4047166705131531,-0.12324178218841553,0.0962190106511116,0.07165835797786713,0.1364855021238327,0.24426309764385223},{-0.08477293699979782,0.10424523800611496,-0.0889706015586853,0.20680654048919678,-0.10209152847528458,0.27581173181533813,0.06789416074752808,-0.09590628743171692,0.2920408844947815,-0.30674299597740173,-0.16909806430339813,0.19237171113491058,-0.0827801376581192,0.05758300796151161,-0.29987630248069763,0.04916022717952728,0.038108471781015396,0.14195330440998077,0.06245715543627739,-0.14183171093463898,-0.2630542814731598,0.18440799415111542,0.2280842661857605,0.20564906299114227,-0.33057039976119995,0.3678090274333954,-0.13132067024707794,0.003491635899990797,-0.11535802483558655,0.11262527108192444,0.23517060279846191,0.2616545855998993},{-0.2555842697620392,0.28508803248405457,-0.09473063796758652,-0.005883737001568079,-0.2786983251571655,-0.21030168235301971,0.1393042504787445,-0.34346887469291687,-0.009671571664512157,-0.27729734778404236,-0.20302289724349976,-0.06708892434835434,0.19771523773670197,-0.19662143290042877,-0.1418144255876541,-0.4005858898162842,-0.16390402615070343,0.022373056039214134,0.2912049889564514,-0.22985884547233582,0.07109910249710083,-0.15247797966003418,-0.007279256358742714,0.31106293201446533,-0.1035931184887886,0.13884387910366058,0.2659090459346771,-0.15606963634490967,-0.10585853457450867,0.2815357446670532,-0.2284080535173416,-0.3677496910095215},{-0.039615850895643234,0.2829815447330475,0.26219528913497925,-0.29883840680122375,0.29604753851890564,0.008294690400362015,-0.13330645859241486,-0.018855776637792587,0.10175929963588715,-0.3163967430591583,-0.03655482456088066,0.057379212230443954,0.21008111536502838,0.03366951271891594,0.031171895563602448,0.00034217300708405674,0.1969941407442093,-0.32516369223594666,0.34444648027420044,0.06365158408880234,-0.16507194936275482,0.15840846300125122,-0.07446741312742233,-0.2602039575576782,0.23932728171348572,-0.06541590392589569,-0.009229183197021484,-0.09704035520553589,0.07664887607097626,-0.12961426377296448,0.3099365532398224,0.2824529707431793},{0.07226629555225372,-0.24746349453926086,-0.2062198668718338,0.05950869619846344,0.05430910736322403,0.28075554966926575,-0.11936455965042114,-0.27962177991867065,0.35633447766304016,0.07699253410100937,0.00810951367020607,0.030645271763205528,-0.18289776146411896,0.11937188357114792,-0.21274374425411224,-0.322064608335495,0.05993185564875603,0.03006620518863201,0.1662081927061081,0.3735392093658447,-0.24625378847122192,0.1653984636068344,-0.18524092435836792,0.09277442842721939,0.06583806127309799,-0.30539822578430176,-0.14362584054470062,-0.31888794898986816,-0.13410550355911255,-0.15028424561023712,0.20243658125400543,-0.35397130250930786},{-0.08977695554494858,0.3285655975341797,0.10322114080190659,-0.20892639458179474,-0.15601421892642975,-0.24281686544418335,0.1548292636871338,-0.07990243285894394,0.27555134892463684,-0.05181873217225075,0.2502518594264984,0.19509698450565338,-0.01946868561208248,0.07479898631572723,-0.19308429956436157,0.17613466084003448,-0.19390878081321716,-0.39846107363700867,-0.3140060603618622,0.09383979439735413,0.1545030176639557,-0.27228254079818726,-0.3625626266002655,-0.24285782873630524,-0.17377185821533203,0.11106996983289719,0.40829989314079285,0.010517950169742107,-0.13013021647930145,0.03697168081998825,-0.12469103932380676,0.13178879022598267},{-0.2058771401643753,-0.18315592408180237,-0.2493356466293335,0.08957215398550034,-0.2963882386684418,-0.13867869973182678,-0.14172455668449402,-0.18028463423252106,-0.2872657775878906,-0.19601623713970184,0.10032529383897781,0.18709340691566467,-0.2370421588420868,0.2826423645019531,-0.029189515858888626,0.17570321261882782,0.018542751669883728,0.02675798162817955,0.027250925078988075,0.14982302486896515,0.13979168236255646,0.33835193514823914,0.09902849793434143,0.2409956306219101,0.10083164274692535,-0.2436760514974594,-0.14781782031059265,0.233722984790802,-0.05651549994945526,-0.21349039673805237,-0.15238702297210693,-0.2274377942085266},{-0.3100069761276245,-0.18817102909088135,-0.37878334522247314,0.12401707470417023,-0.13055455684661865,-0.09931720793247223,-0.16718369722366333,0.04359294846653938,-0.042027100920677185,0.07047256827354431,-0.2539208233356476,0.042778175324201584,0.1816951185464859,-0.057062387466430664,0.05014938488602638,0.197745680809021,-0.17792074382305145,-0.12624873220920563,0.15981774032115936,0.11153518408536911,0.1954205334186554,0.003560827113687992,-0.25580862164497375,0.044266004115343094,0.24037425220012665,-0.2788534164428711,0.15208907425403595,0.019036952406167984,0.08375857025384903,-0.1673157960176468,0.21337220072746277,-0.09671813994646072},{0.2646317481994629,-0.06242898851633072,0.04364152252674103,0.09858418256044388,-0.27597081661224365,0.006747582461684942,0.17165139317512512,0.2367020845413208,-0.0860152542591095,-0.09919723868370056,0.3035685420036316,-0.19966119527816772,-0.03202291950583458,-0.08230146020650864,-0.14999978244304657,0.21326890587806702,0.032377634197473526,-0.07323300093412399,0.12982936203479767,-0.2939787805080414,0.03845623508095741,-0.3099892735481262,-0.23300841450691223,0.25532349944114685,-0.13223861157894135,-0.13196991384029388,0.16514341533184052,-0.009392978623509407,-0.16226035356521606,-0.006875051185488701,-0.10158821195363998,-0.01293395645916462},{0.3317188620567322,-0.05519714951515198,0.09735902398824692,0.08505958318710327,-0.00018070393707603216,-0.09165497124195099,0.14916427433490753,-0.24094180762767792,0.2146233320236206,0.29667919874191284,-0.008153339847922325,0.17310312390327454,0.2754563093185425,0.3272584080696106,-0.2738405168056488,-0.28564655780792236,-0.3160509467124939,0.04748890548944473,-0.14124725759029388,-0.28684937953948975,-0.21362124383449554,0.3033143877983093,0.0858076885342598,0.14958563446998596,-0.15911175310611725,-0.0949191078543663,-0.16250799596309662,-0.19000646471977234,0.2672787010669708,0.17941023409366608,-0.2622833549976349,-0.15638002753257751},{-0.11979519575834274,0.12739922106266022,0.2566109001636505,-0.08582348376512527,-0.034081704914569855,0.05390356853604317,-0.008845627307891846,-0.31396374106407166,0.2290111780166626,0.26880544424057007,0.15029114484786987,0.20029450953006744,-0.2527601718902588,0.18582198023796082,-0.29767102003097534,0.25799912214279175,0.17730626463890076,-0.23246967792510986,0.22846263647079468,0.12756286561489105,-0.3103564381599426,0.3110211193561554,-0.33419495820999146,0.1397135704755783,0.21479566395282745,0.23370720446109772,0.11624958366155624,0.08822654187679291,-0.19479802250862122,0.22387340664863586,-0.08436639606952667,0.12910687923431396},{-0.152509868144989,-0.04943608120083809,-0.004681192338466644,0.2632095217704773,-0.030217858031392097,0.16758327186107635,-0.36954453587532043,-0.2061893790960312,-0.1493862122297287,-0.1257176697254181,-0.18581297993659973,-0.10265170782804489,0.09766410291194916,-0.1130165159702301,0.1095166802406311,-0.1874191015958786,0.14429771900177002,-0.027166040614247322,-0.32557499408721924,-0.2187492996454239,0.08770091086626053,0.2033892422914505,-0.19250622391700745,0.3135114312171936,-0.24501463770866394,0.10427156090736389,0.10949917137622833,-0.08245102316141129,0.13174699246883392,-0.2641209661960602,0.34604254364967346,0.06532397121191025},{0.35758310556411743,-0.07419931888580322,0.07644299417734146,0.14187593758106232,-0.17107100784778595,0.24271778762340546,-0.016687002032995224,0.2467925101518631,0.16126267611980438,0.1310252696275711,0.030195366591215134,-0.4119740426540375,-0.2791936695575714,-0.05146319419145584,0.06673339009284973,-0.1408744752407074,0.32696834206581116,0.23076988756656647,-0.21045173704624176,-0.20623263716697693,0.2785663306713104,0.28305286169052124,0.26248157024383545,0.17007824778556824,-0.06868370622396469,-0.03860750421881676,-0.07699043303728104,-0.23516906797885895,0.21143856644630432,0.09551984816789627,-0.20343002676963806,0.12324182689189911},{-0.03615245595574379,0.012617884203791618,-0.08238758891820908,-0.2680336833000183,-0.10773342847824097,-0.24532820284366608,-0.2177840620279312,-0.16489672660827637,0.02539197914302349,-0.013720855116844177,-0.2630690336227417,0.0087956627830863,-0.26070544123649597,-0.16488206386566162,-0.011104483157396317,0.06556079536676407,0.2936684191226959,-0.17234711349010468,-0.35352006554603577,0.26753079891204834,-0.14715534448623657,0.2552505433559418,-0.02970520406961441,-0.05158363655209541,0.06521288305521011,0.12706206738948822,-0.048015449196100235,-0.28866440057754517,0.22082193195819855,0.24481533467769623,-0.16339044272899628,0.20958615839481354},{-0.2391897737979889,0.0032916858326643705,0.08162734657526016,0.01689145341515541,0.0794033482670784,0.12048538774251938,-0.1837477684020996,0.10981224477291107,-0.23741364479064941,-0.2021217942237854,0.1274297833442688,-0.12032879143953323,-0.17185793817043304,0.23979072272777557,0.048393335193395615,0.040550198405981064,0.17906077206134796,-0.26548048853874207,-0.127879798412323,0.26166030764579773,0.026155726984143257,0.20750142633914948,0.022525105625391006,0.01235047448426485,-0.3155719041824341,-0.1518370658159256,-0.0162617526948452,0.33363640308380127,0.019407836720347404,0.012976274825632572,0.2906836271286011,0.2846904993057251}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.0481746569275856,0.2059423178434372,0.47355082631111145,-0.09765344858169556},{0.08394241333007812,-0.1606174111366272,0.0112095782533288,0.33031708002090454},{-0.13357345759868622,0.12211587280035019,0.16786690056324005,0.12466349452733994},{0.38957011699676514,0.06164834275841713,0.0557611808180809,0.5613548755645752},{-0.07127946615219116,0.10434700548648834,0.3541315495967865,0.04022917523980141},{-0.15731839835643768,0.2550255060195923,0.2998983561992645,-0.07741046696901321},{-0.4439973831176758,-0.06994348019361496,0.10779885202646255,-0.19143284857273102},{-0.41680213809013367,-0.16276468336582184,0.5078205466270447,-0.3063613772392273},{0.33647605776786804,-0.15711325407028198,-0.3123992085456848,-0.44051507115364075},{0.06373107433319092,0.346777081489563,0.3749217092990875,-0.5496073961257935},{-0.2955629825592041,-0.24873709678649902,-0.08872461318969727,0.11038496345281601},{0.49898454546928406,-0.22320188581943512,-0.07735560089349747,0.24339133501052856},{0.31709983944892883,0.2774129807949066,-0.06664905697107315,0.167082279920578},{0.0025974540039896965,0.04794401302933693,-0.3208751678466797,0.05390311777591705},{0.09495624899864197,0.30108362436294556,0.46920445561408997,0.36419564485549927},{0.15083587169647217,-0.03613341227173805,0.32868626713752747,0.28856030106544495},{-0.3402147591114044,-0.11161073297262192,-0.08440251648426056,-0.32633233070373535},{-0.1328386813402176,0.2174523025751114,-0.17883263528347015,-0.10862231999635696},{-0.37698307633399963,0.21865954995155334,0.20400939881801605,0.44996270537376404},{-0.01697515696287155,0.3741703927516937,-0.22866013646125793,0.19884607195854187},{-0.31281667947769165,-0.39157798886299133,-0.12161612510681152,0.042921070009469986},{0.3707422912120819,0.4789615273475647,0.031508803367614746,-0.3468713164329529},{-0.018784653395414352,0.2198607474565506,0.2513691484928131,0.23930363357067108},{-0.05930051952600479,0.44526198506355286,-0.057428255677223206,-0.2528572678565979},{-0.007254927419126034,-0.09675589203834534,-0.13485634326934814,0.002943666186183691},{0.3656062185764313,-0.49835431575775146,-0.03590336814522743,-0.007686454337090254},{-0.041332490742206573,-0.4197008013725281,-0.20841556787490845,-0.3232421576976776},{0.16417425870895386,-0.23784326016902924,0.25153735280036926,0.17011693120002747},{0.04789680987596512,-0.05474795028567314,0.07683916389942169,0.06602638959884644},{-0.48432907462120056,0.4316292703151703,0.21735027432441711,-0.005740438122302294},{0.37329453229904175,-0.17951366305351257,0.24187161028385162,-0.05121997371315956},{0.13417096436023712,-0.4743121266365051,0.44548702239990234,-0.2921844720840454}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.03786342591047287,-0.013106660917401314,0.02184392139315605,0.0375576876103878,-0.08233042061328888,-0.07899495959281921,0.012982234358787537,0.04930175468325615,0.088765949010849,-0.012352598831057549,-0.04552404209971428,-0.01973816566169262,0.0410916730761528,-0.010360948741436005,-0.045195791870355606,-0.03446182608604431};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02916921302676201,0.005697012413293123,-0.0015161953633651137,0.01934107393026352,0.023036755621433258,-0.013343262486159801,0.033663369715213776,0.00974831823259592,0.009855490177869797,0.02291802503168583,0.03707696497440338,0.0010008910903707147,0.049043335020542145,-0.03818906098604202,-0.03617391362786293,-0.0033105926122516394};
static const float actor_encoder_feed_forward_0_bias[32] = {0.014019018970429897,0.009426655247807503,0.02815096825361252,0.0018228120170533657,0.014116075821220875,0.007182729430496693,0.013895654119551182,0.0162420142441988,-0.041984159499406815,-0.01362112071365118,0.012046529911458492,0.0030810630414634943,0.008933702483773232,0.010629341006278992,-0.0004622426349669695,0.03726137802004814,-0.0015344294952228665,-0.008287816308438778,0.024224286898970604,-0.00603913888335228,-0.016782192513346672,-0.007884759455919266,0.04302159324288368,0.016829123720526695,-0.006567888893187046,0.012377379462122917,-0.023183677345514297,0.033307239413261414,-0.006255508866161108,0.018028710037469864,0.016403503715991974,-0.008022506721317768};
static const float action_parameterization_distribution_linear_bias[4] = {-0.015775134786963463,-0.006631004624068737,0.0006528556114062667,0.011455520987510681};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.06705379486083984,0.24003146588802338,-0.17312587797641754,0.22151929140090942,0.08861509710550308,0.04549535736441612,0.3573961853981018,-0.047248102724552155},{-0.25727856159210205,-0.03418035805225372,-0.3064311742782593,-0.19473741948604584,-0.403918981552124,-0.26550742983818054,-0.023668237030506134,-0.2511741816997528},{-0.2636732757091522,0.033898547291755676,0.22159557044506073,0.2642098665237427,0.23339936137199402,-0.048795878887176514,0.38738054037094116,-0.17792291939258575},{0.031259678304195404,0.10733648389577866,-0.19349874556064606,0.026437608525156975,0.012285785749554634,-0.07071162760257721,0.3468335270881653,-0.25640782713890076},{-0.3086192309856415,-0.12772946059703827,-0.25021639466285706,-0.11055553704500198,-0.026759646832942963,0.1723785698413849,0.18267208337783813,-0.05959637835621834},{-0.32682934403419495,-0.03282919153571129,0.3714503347873688,0.25490516424179077,0.18637219071388245,-0.11195621639490128,-0.1356169879436493,-0.15054923295974731},{-0.2621332108974457,0.01650470308959484,0.40232712030410767,-0.19251862168312073,-0.10657733678817749,-0.41151857376098633,-0.11434227973222733,-0.11019725352525711},{-0.26925405859947205,-0.3380180299282074,0.471557080745697,-0.10289289057254791,-0.1379202902317047,0.27306586503982544,0.17286567389965057,-0.24227775633335114},{-0.35517922043800354,0.32371261715888977,-0.18603771924972534,0.3303481936454773,0.17814414203166962,-0.25967392325401306,0.013183635659515858,0.12873557209968567},{-0.39872974157333374,-0.28996145725250244,-0.15642468631267548,-0.22775325179100037,-0.4893079102039337,0.16085681319236755,-0.03986211121082306,0.17081573605537415},{0.08453590422868729,0.3587316870689392,0.21146725118160248,-0.02920033410191536,0.21504195034503937,0.16354073584079742,-0.21154849231243134,0.23359215259552002},{0.13400574028491974,0.03587360307574272,0.25996267795562744,0.25953465700149536,-0.3230002522468567,0.2973753809928894,-0.008772630244493484,-0.21423748135566711},{0.06687494367361069,-0.33523961901664734,0.2600732445716858,-0.041632283478975296,-0.38387036323547363,-0.09114035964012146,-0.18560566008090973,-0.09530825167894363},{-0.23649102449417114,-0.2628057897090912,0.32331857085227966,0.35541632771492004,-0.26566433906555176,-0.07220209389925003,-0.3046628534793854,0.25181105732917786},{0.06462547928094864,-0.17415402829647064,0.1330535113811493,-0.2247963696718216,-0.28422072529792786,-0.1274385303258896,0.2546952962875366,0.02008403092622757},{0.19740939140319824,-0.016813082620501518,0.015024497173726559,-0.23747089505195618,0.06660032272338867,0.06394734233617783,0.1479739248752594,0.375165730714798},{-0.013059684075415134,-0.29724258184432983,-0.16983745992183685,0.1283137947320938,-0.21244685351848602,-0.14768201112747192,-0.12520726025104523,0.13028587400913239},{-0.17072191834449768,-0.32781073451042175,0.025910884141921997,0.060068074613809586,0.11879818886518478,-0.19950254261493683,0.3343466520309448,0.1933026760816574},{0.004506624769419432,0.08475302904844284,-0.272283673286438,0.1362617313861847,0.11415863037109375,0.18952928483486176,-0.2564477324485779,0.3918728530406952},{0.11751246452331543,-0.044025324285030365,-0.3886527717113495,0.11192034184932709,-0.046191759407520294,-0.02833988144993782,-0.33813801407814026,0.027736721560359},{0.050735730677843094,-0.1304059773683548,0.044253408908843994,-0.07810629904270172,0.35544028878211975,0.05244402214884758,-0.03112720139324665,0.4209102690219879},{0.0009562965715304017,0.12762708961963654,-0.27222174406051636,0.3193410336971283,0.37649989128112793,0.3408083915710449,0.21910172700881958,-0.31976518034935},{-0.4549098610877991,-0.13148538768291473,0.16196388006210327,-0.02319556288421154,0.21382775902748108,-0.2947351634502411,0.2840685248374939,-0.2927700877189636},{-0.2467699944972992,0.014035590924322605,-0.06896646320819855,-0.3411284387111664,0.21108803153038025,-0.0285603329539299,-0.2835012376308441,0.17202262580394745},{-0.3192032277584076,-0.1955520063638687,0.015742920339107513,0.07400468736886978,-0.11472468823194504,0.10715953260660172,0.3412131369113922,-0.128658726811409},{-0.29895955324172974,0.053845081478357315,-0.38503560423851013,-0.3115478456020355,0.16067887842655182,0.020969979465007782,-0.06099364906549454,0.0767427310347557},{0.25028181076049805,0.38364049792289734,-0.3150019645690918,0.16649898886680603,0.22658663988113403,0.3941250443458557,-0.27207624912261963,-0.1344332993030548},{0.28741636872291565,0.25340667366981506,0.03976771980524063,0.06538211554288864,0.29071900248527527,0.2027187943458557,0.28216639161109924,0.3769041895866394},{-0.22613853216171265,0.39518871903419495,0.15720507502555847,0.003268954111263156,0.21658530831336975,0.04368831589818001,-0.30670788884162903,-0.3075461983680725},{-0.3137775957584381,-0.2126581072807312,0.08322805911302567,-0.25335636734962463,-0.31957393884658813,-0.17701390385627747,0.3519766330718994,-0.07443246245384216},{0.2770979702472687,-0.24226891994476318,0.34055182337760925,-0.31793102622032166,0.011578690260648727,0.2215586155653,0.23878155648708344,-0.2728392779827118},{0.09393803775310516,0.3854181468486786,0.3880229592323303,-0.2511870563030243,-0.2830953896045685,0.03609483689069748,0.23854203522205353,0.057845767587423325}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.004474188666790724,0.46642377972602844,-0.19237679243087769,0.21361252665519714,-0.4169042706489563,0.32003578543663025,0.3423762619495392,0.0743950679898262},{-0.5107654333114624,-0.4073713719844818,-0.38130074739456177,-0.4255252480506897,-0.49928018450737,0.49377313256263733,0.3983657658100128,-0.4069460928440094},{0.09966263920068741,-0.1955619603395462,0.14884279668331146,0.16372644901275635,-0.022942986339330673,0.4512445330619812,-0.3393538296222687,-0.4616276025772095},{0.4821704924106598,-0.006341399624943733,0.1655847430229187,0.015938077121973038,0.5008372664451599,0.4174160361289978,0.4753360450267792,0.3520180284976959},{0.08772967755794525,0.21608462929725647,-0.1937112808227539,-0.3221745789051056,0.06626290082931519,-0.5082097053527832,-0.5094849467277527,0.6404106616973877},{0.43832913041114807,0.06273877620697021,0.020972605794668198,-0.3817581236362457,-0.47789186239242554,-0.5185493230819702,-0.12909545004367828,0.4529150724411011},{-0.47695207595825195,-0.35999026894569397,-0.09381002187728882,-0.257034569978714,-0.012787251733243465,0.5196148753166199,-0.5543854236602783,0.5389678478240967},{0.2630175054073334,0.09926838427782059,-0.02648092992603779,0.0498788021504879,0.4300536811351776,-0.5885671973228455,0.4154304265975952,-0.36882779002189636}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09174197167158127,0.01960418000817299,0.029946990311145782,-0.016862208023667336,-0.03997151553630829,0.0234442800283432,0.0036434056237339973,0.006936945021152496};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011925795115530491,-0.009481456130743027,-0.023494666442275047,0.02893628552556038,-0.01173936016857624,-0.008914174512028694,0.010425979271531105,-0.05367264896631241};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

