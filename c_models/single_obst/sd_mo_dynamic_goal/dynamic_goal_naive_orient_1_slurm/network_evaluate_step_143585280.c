#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.29798656702041626,-0.007213478907942772,-0.10198869556188583,0.3209981322288513,0.2756706178188324,-0.24933861196041107,-0.3126550018787384,0.10427098721265793,0.29596805572509766,-0.32909250259399414,0.5364278554916382,-0.06012210249900818,0.2626681625843048,0.15921619534492493,-0.4145641326904297,0.04186316207051277},{-0.24157465994358063,-0.28255435824394226,-0.295575886964798,-0.21787893772125244,0.07414891570806503,0.34337812662124634,0.12224257737398148,0.10941112041473389,0.22939689457416534,0.15409159660339355,-0.11563044041395187,-0.06961215287446976,-0.11309132725000381,0.04292713478207588,0.3216838538646698,-0.3185863196849823},{0.1404111385345459,0.2349492460489273,0.206536203622818,0.30328720808029175,-0.09278743714094162,-0.18100696802139282,0.3907264173030853,-0.047170136123895645,0.022215593606233597,-0.07371298223733902,-0.08791061490774155,-0.006254613399505615,0.04592449590563774,0.3762011229991913,-0.2703665494918823,-0.1211397722363472},{0.1386370062828064,-0.16740919649600983,-0.11228340119123459,-0.13820405304431915,0.07498984038829803,0.07742933183908463,0.08478857576847076,-0.1981322020292282,-0.15566498041152954,0.1306377798318863,0.4524909257888794,-0.2349332869052887,-0.19373363256454468,-0.1171693429350853,0.1995551735162735,0.12248699367046356},{-0.30509570240974426,-0.017337985336780548,0.12257860600948334,-0.21568563580513,0.26844754815101624,0.3394934833049774,0.14155377447605133,-0.20969219505786896,-0.16994668543338776,0.1425790637731552,-0.1242774948477745,-0.3858396112918854,-0.05735096335411072,-0.17267751693725586,0.2791357636451721,-0.038714922964572906},{0.05400724336504936,-0.08004174381494522,-0.009181656874716282,-0.05403873696923256,0.10826649516820908,-0.15590283274650574,0.42964285612106323,-0.31403449177742004,-0.13902384042739868,-0.18474037945270538,0.30538180470466614,0.07319575548171997,0.2543523609638214,0.0150486184284091,0.2786577045917511,0.2489340901374817},{-0.25121423602104187,0.17623601853847504,-0.10974617302417755,0.033671218901872635,-0.2473403960466385,-0.10721417516469955,-0.16292564570903778,-0.019637368619441986,0.1899728775024414,0.3180990517139435,-0.29808127880096436,-0.1190788671374321,0.23219893872737885,0.08280624449253082,-0.21098028123378754,0.32900649309158325},{-0.1150408536195755,-0.0005471977056004107,-0.10473338514566422,-0.14374405145645142,0.35419270396232605,-0.27458855509757996,-0.2599871754646301,-0.4168005585670471,-0.16588632762432098,-0.26643896102905273,0.372844934463501,-0.009048521518707275,0.1805361658334732,0.1722887009382248,-0.17677240073680878,0.4036768674850464},{0.23215584456920624,0.09797805547714233,0.04164782539010048,0.046031370759010315,-0.36428993940353394,-0.4429432153701782,0.3181159198284149,-0.33646801114082336,-0.19278445839881897,0.20633473992347717,0.14713706076145172,-0.3193458914756775,-0.17935286462306976,0.10908662527799606,0.17109137773513794,-0.006698447745293379},{0.4135874807834625,-0.5586792826652527,-0.1525890827178955,-0.05929369851946831,0.18353581428527832,-0.2550830543041229,-0.24669486284255981,-0.22487188875675201,-0.14498011767864227,-0.006716402713209391,-0.038896072655916214,-0.19085322320461273,0.39437955617904663,-0.11280301958322525,-0.4985794723033905,-0.13491590321063995},{0.19564154744148254,0.18484772741794586,-0.3229905068874359,0.12130574136972427,-0.029205355793237686,-0.28566795587539673,-0.1493181437253952,0.116934634745121,-0.17245925962924957,0.14484575390815735,0.13906802237033844,0.27857571840286255,-0.1469774693250656,0.2896779477596283,-0.10451735556125641,-0.1866077482700348},{-0.4440430700778961,0.25823938846588135,0.2443045675754547,-0.29559817910194397,-0.37731003761291504,0.2645891010761261,0.035232413560152054,0.2795007526874542,0.18189844489097595,0.2117672860622406,0.3163369596004486,-0.060602784156799316,0.04730602353811264,-0.0643082931637764,-0.11321715265512466,-0.1399446725845337},{0.13109882175922394,-0.26150548458099365,-0.19535602629184723,0.2763955295085907,-0.184197336435318,-0.28650203347206116,-0.17041319608688354,0.2972049415111542,0.26279017329216003,-0.1618453860282898,-0.1803392618894577,0.11759298294782639,0.32643923163414,0.14289423823356628,-0.18123812973499298,0.3466697931289673},{0.3166385889053345,0.18098904192447662,-0.18695707619190216,-0.08487900346517563,0.12239116430282593,-0.10696393996477127,-0.09733933955430984,0.3017834424972534,-0.25449058413505554,-0.20316335558891296,-0.14564920961856842,0.00126163219101727,-0.23770610988140106,-0.13523519039154053,-0.2510205805301666,-0.06394289433956146},{0.153145894408226,0.3626217246055603,0.414519727230072,-0.4061253070831299,-0.3938577473163605,0.0382000207901001,0.08462633192539215,-0.09261821210384369,0.3625715970993042,0.342205286026001,-0.19352038204669952,0.11519930511713028,-0.03794574737548828,-0.32965803146362305,-0.007291367743164301,-0.11788429319858551},{-0.1708204597234726,-0.2188560664653778,-0.13237659633159637,0.4014730751514435,-0.2452622354030609,-0.1505371481180191,-0.24486994743347168,-0.272447794675827,-0.5792075991630554,-0.2070482075214386,0.37620872259140015,0.3045920133590698,-0.6292505860328674,-0.3747693598270416,-0.6418801546096802,-0.15046803653240204},{-0.5265389084815979,0.17005205154418945,-0.45422548055648804,-0.07397083193063736,-0.42851102352142334,0.23019273579120636,0.4774559438228607,0.0929601863026619,0.4493439197540283,-0.4572833180427551,0.2015877515077591,-0.35423240065574646,-0.1494228094816208,-0.018786415457725525,-0.17508813738822937,-0.20404934883117676},{0.28711867332458496,-0.5823931097984314,0.2812119126319885,0.33324509859085083,-0.130208358168602,0.48162052035331726,0.319050669670105,0.2776772677898407,-0.12179362028837204,-0.3337843418121338,-0.10660649091005325,-0.17340123653411865,-0.061040546745061874,-0.49397212266921997,0.18082329630851746,-0.07980850338935852}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.053444936871528625,0.30637747049331665,0.2408898025751114,-0.1234058067202568,-0.22603930532932281,0.07141491770744324,-0.029087288305163383,0.3050619661808014,-0.09551936388015747,0.32831066846847534,0.4650557041168213,-0.38663357496261597,0.004263538867235184,0.03633981943130493,0.028469346463680267,-0.13292723894119263},{-0.48200273513793945,0.1889977604150772,-0.24320368468761444,0.28556159138679504,0.2817397117614746,-0.17416512966156006,-0.3255029320716858,-0.19955526292324066,0.35568439960479736,0.24508385360240936,-0.06321623921394348,0.27219539880752563,-0.42805272340774536,0.20901381969451904,-0.2495240420103073,0.4909510910511017},{-0.3184242844581604,0.12262465804815292,-0.3774341940879822,0.18371352553367615,-0.45560696721076965,-0.28870105743408203,0.09484876692295074,0.14049184322357178,-0.28460657596588135,0.41942909359931946,0.2637317180633545,-0.1961473822593689,0.18531884253025055,-0.28577491641044617,-0.18391501903533936,-0.08777248859405518},{0.34983623027801514,-0.25099337100982666,0.13084177672863007,0.4166373610496521,-0.42306312918663025,-0.30462491512298584,0.2934940457344055,0.0513535812497139,0.29452356696128845,-0.07004279643297195,0.35513198375701904,0.09064055234193802,-0.21253637969493866,-0.02702852338552475,0.02008175291121006,-0.46049755811691284},{-0.39733532071113586,-0.058313220739364624,0.17141295969486237,-0.28148317337036133,0.15090839564800262,0.46515724062919617,-0.27728816866874695,0.30123379826545715,-0.2236260175704956,0.23731845617294312,-0.03265069052577019,-0.005711348261684179,-0.24078142642974854,-0.027427664026618004,-0.27332741022109985,-0.15106800198554993},{0.07663164287805557,-0.3134456276893616,0.018031306564807892,-0.3460243344306946,0.22747479379177094,0.045391131192445755,-0.16219963133335114,-0.0638655498623848,-0.12671209871768951,0.408043771982193,0.22604089975357056,-0.014742450788617134,-0.2849511504173279,0.07523402571678162,0.019535131752490997,-0.29894474148750305},{0.28656041622161865,-0.15837343037128448,0.36195358633995056,-0.280978262424469,-0.4010262191295624,-0.08828722685575485,-0.36052370071411133,0.34134674072265625,-0.08678507804870605,-0.26074326038360596,-0.21314923465251923,-0.022960307076573372,-0.034578148275613785,-0.09457193315029144,0.5041630268096924,-0.35440659523010254},{-0.3073187470436096,0.37502145767211914,-0.05616828054189682,0.1778019368648529,-0.03394809737801552,-0.20413418114185333,-0.2262180596590042,0.05161989480257034,0.03268984332680702,0.5250257849693298,0.11436399817466736,-0.09355711191892624,0.04886702820658684,-0.2396993190050125,0.12181013822555542,0.1748371422290802},{0.09602303802967072,0.26075315475463867,-0.15673162043094635,-0.3638370931148529,0.35271716117858887,-0.18839505314826965,0.11428431421518326,-0.32357534766197205,0.17072618007659912,0.09308484941720963,0.09454226493835449,0.15488342940807343,0.032463956624269485,-0.4396219551563263,-0.012922631576657295,0.2213028222322464},{-0.2809421718120575,0.06991071999073029,-0.31929653882980347,-0.3683256208896637,0.23351262509822845,-0.41460365056991577,-0.16533808410167694,0.2964186668395996,-0.17316900193691254,0.1441361904144287,-0.04534216970205307,-0.089162178337574,-0.3865039646625519,0.10441210865974426,-0.2686213254928589,-0.27457195520401},{-0.13544782996177673,-0.1457650363445282,0.010261856950819492,-0.2455558478832245,-0.3189550042152405,-0.03759896755218506,0.16599081456661224,-0.4346333146095276,0.01182102132588625,-0.12408216297626495,0.27741730213165283,-0.06618747860193253,0.31344476342201233,0.18550103902816772,0.22587323188781738,0.23578603565692902},{-0.06554530560970306,-0.01530579011887312,-0.40535157918930054,0.32910680770874023,0.12149127572774887,0.11039014160633087,0.2724323272705078,0.16722726821899414,-0.4583768844604492,0.1738959550857544,-0.30419981479644775,-0.23447315394878387,-0.3396081328392029,0.41460663080215454,-0.35950347781181335,0.06671611219644547},{-0.20275676250457764,-0.5104421377182007,-0.13079579174518585,0.18481740355491638,-0.23503251373767853,-0.026650624349713326,-0.08440770208835602,0.40154337882995605,0.4792395830154419,0.138642355799675,-0.01168900914490223,-0.19524452090263367,0.16833922266960144,-0.3980119228363037,0.11369437724351883,-0.2188105434179306},{-0.326654851436615,-0.4509637653827667,-0.19677871465682983,-0.15675610303878784,-0.4573594033718109,0.5406124591827393,-0.16532576084136963,0.2137051373720169,-0.11146767437458038,-0.24356704950332642,-0.3645007610321045,0.4641670882701874,-0.21218004822731018,-0.062419842928647995,-0.27561870217323303,0.3819572329521179},{-0.4112209975719452,0.33020079135894775,-0.23604875802993774,0.12766923010349274,-0.40549343824386597,0.2104596197605133,-0.10601084679365158,-0.2673178017139435,0.1352541744709015,0.2690540850162506,-0.291891485452652,0.07165263593196869,0.21138213574886322,-0.39569327235221863,-0.3442860245704651,-0.14613577723503113},{-0.13895706832408905,-0.36475419998168945,-0.4737066626548767,0.26223039627075195,0.07564198225736618,0.08487018197774887,-0.252702534198761,0.21834392845630646,-0.3579249083995819,-0.2690190076828003,-0.31332141160964966,0.22192664444446564,-0.1950496882200241,0.13897201418876648,0.07086218148469925,0.27635833621025085}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10385982692241669,-0.048835184425115585,0.08124598115682602,-0.14016887545585632,-0.13154026865959167,0.09165247529745102,0.16724137961864471,-0.2355656623840332,-0.10528401285409927,0.2928062677383423,0.0915696769952774,0.17307065427303314,0.11537797749042511,0.18048374354839325,-0.19050101935863495,0.14848525822162628,0.10963891446590424,-0.3719881772994995,-0.28214231133461,-0.10992457717657089,-0.15690401196479797,0.12571614980697632,-0.24541588127613068,0.27703261375427246,-0.0698888823390007,0.013982114382088184,0.17218638956546783,0.20184941589832306,-0.25537800788879395,-0.22601717710494995,0.25533270835876465,0.30844351649284363},{0.2414521425962448,-0.03793879598379135,0.16242572665214539,-0.0877956748008728,-0.12196405977010727,0.2608615458011627,-0.020880568772554398,-0.07448557764291763,-0.06238279491662979,-0.013885880820453167,-0.13530181348323822,0.026191411539912224,0.41229087114334106,0.16646209359169006,0.160652756690979,0.10943974554538727,-0.2730262577533722,-0.3632528781890869,0.12348158657550812,0.029466085135936737,0.047250937670469284,0.3028908669948578,0.2386762499809265,-0.2451966255903244,0.06719478219747543,0.28271907567977905,-0.30942776799201965,0.20109806954860687,0.1558729112148285,-0.22899748384952545,-0.043947942554950714,-0.01461381372064352},{-0.12082517147064209,-0.023729458451271057,0.2062927484512329,-0.1946982592344284,-0.24577786028385162,-0.003985595889389515,-0.195981964468956,0.21240395307540894,0.1944517195224762,-0.03961046040058136,-0.1416683942079544,0.06346846371889114,0.2873336374759674,-0.19683371484279633,0.072921983897686,-0.03475504368543625,-0.346861869096756,0.23106059432029724,-0.31709861755371094,-0.060542915016412735,0.012931430712342262,-0.14274732768535614,-0.0912175178527832,-0.1392454355955124,0.037884246557950974,0.38202157616615295,-0.016270210966467857,0.0988541916012764,0.2644822299480438,-0.34764379262924194,-0.15884873270988464,-0.01143985241651535},{0.1762690544128418,-0.19818700850009918,0.07200481742620468,-0.3887595534324646,0.18086527287960052,-0.07748265564441681,-0.036069322377443314,0.2650529146194458,0.04038691520690918,0.22633731365203857,0.06704964488744736,-0.16063153743743896,-0.2091924101114273,-0.09630268812179565,0.30072498321533203,-0.2456159144639969,0.0665440484881401,-0.09921389818191528,-0.1372263878583908,0.10541693866252899,-0.14999356865882874,0.10459680110216141,-0.1860968917608261,0.29392459988594055,-0.33207985758781433,0.04081280529499054,-0.10162276029586792,-0.22768762707710266,0.022812819108366966,0.07229535281658173,0.23413047194480896,-0.10489416122436523},{0.22740218043327332,0.010180637240409851,0.03658761829137802,0.27899742126464844,-0.28330251574516296,-0.07674850523471832,0.14373557269573212,-0.10060609877109528,0.09429775178432465,-0.2113969773054123,0.002938578836619854,-0.04399420693516731,-0.10640376061201096,-0.10151572525501251,0.2997439503669739,0.3277227580547333,-0.11574596166610718,-0.34622451663017273,0.17583972215652466,-0.08427709341049194,-0.14774926006793976,0.22664518654346466,0.2733439803123474,0.04975973814725876,-0.033631596714258194,-0.10367311537265778,-0.0375412255525589,0.26651689410209656,0.24866190552711487,0.0977616086602211,0.07818508893251419,-0.2969071567058563},{0.3051510155200958,-0.1837608963251114,0.07032839953899384,0.0685437023639679,-0.15152108669281006,-0.2959471344947815,-0.17048728466033936,-0.27132001519203186,-0.2553216516971588,-0.0033299527131021023,0.01385338231921196,-0.05424623563885689,-0.17989279329776764,-0.029687026515603065,-0.22697323560714722,-0.2557254135608673,0.20371700823307037,0.0420808307826519,-0.2742948532104492,0.21228860318660736,-0.011436961591243744,-0.24879124760627747,0.19878563284873962,-0.14510640501976013,-0.1537536084651947,-0.2690095901489258,-0.09984572976827621,0.10481856763362885,0.09741285443305969,0.27771055698394775,-0.30464014410972595,0.16395793855190277},{0.22578316926956177,0.0462392121553421,0.2530885934829712,-0.18985699117183685,0.2601064145565033,-0.1410505473613739,-0.2693996727466583,0.020809059962630272,0.2947062849998474,0.21429993212223053,-0.1916828155517578,0.07412642985582352,0.08882207423448563,0.32519182562828064,0.144246444106102,-0.10023785382509232,-0.20652392506599426,0.13836140930652618,-0.01405626442283392,0.009295539930462837,-0.13144104182720184,0.2738383412361145,0.1955687552690506,0.2054230272769928,-0.29583078622817993,-0.2728711664676666,-0.2841755151748657,-0.38222888112068176,0.007362219970673323,-0.08063240349292755,0.2716742157936096,0.1631992906332016},{0.3359728157520294,-0.3721765875816345,0.14329195022583008,-0.41972461342811584,-0.2506523132324219,0.35062670707702637,0.4241234064102173,0.19995056092739105,-0.0983811691403389,0.07478547096252441,0.16580645740032196,-0.18777692317962646,0.11306852847337723,0.2969023585319519,-0.02133847400546074,0.1952574998140335,0.42226919531822205,-0.181472048163414,-0.04950575903058052,-0.2994596064090729,0.14677350223064423,0.2490558624267578,0.28044793009757996,0.18909968435764313,0.051884740591049194,0.06469135731458664,0.10109108686447144,0.23451876640319824,-0.2103523463010788,-0.18665045499801636,0.24592505395412445,0.014588545076549053},{-0.07986418157815933,-0.010926563292741776,0.2170894891023636,0.2516981363296509,-0.2374798059463501,-0.4162939190864563,-0.05901169031858444,0.21211877465248108,-0.1933772712945938,-0.3645731508731842,0.17293433845043182,0.15142446756362915,0.07940205186605453,-0.27012404799461365,0.08330084383487701,-0.18468926846981049,-0.15285076200962067,0.1447775959968567,-0.24957402050495148,0.299772709608078,-0.21561796963214874,-0.44443178176879883,-0.33876949548721313,0.19099009037017822,0.16417083144187927,0.1681590974330902,0.2946063280105591,0.21759578585624695,-0.15995539724826813,-0.34094199538230896,-0.182967871427536,0.1442173272371292},{0.37073439359664917,-0.007014764938503504,0.005096858832985163,0.13989195227622986,0.09880213439464569,0.2842334806919098,0.015622212551534176,0.3599063754081726,-0.08191598951816559,0.11098022758960724,0.1425318568944931,0.041137102991342545,-0.2342611849308014,-0.4614037573337555,0.14419494569301605,0.19458308815956116,0.10722625255584717,-0.1542598009109497,-0.024213917553424835,-0.10996512323617935,0.15388357639312744,-0.3513307571411133,0.30173593759536743,0.02593034692108631,-0.09657007455825806,0.12698984146118164,-0.31313323974609375,-0.15876372158527374,0.06831587105989456,0.04321517050266266,0.1550392359495163,0.30250030755996704},{-0.11146148294210434,0.09306289255619049,-0.1510390192270279,0.17187277972698212,-0.14204947650432587,0.2570136487483978,0.08220497518777847,-0.05792635679244995,0.33122527599334717,-0.2802995443344116,-0.1625736951828003,0.18269243836402893,-0.15615572035312653,0.02957743965089321,-0.314847856760025,-0.032829735428094864,0.09749450534582138,0.1423511654138565,0.020577792078256607,-0.1691219061613083,-0.23898258805274963,0.1947830468416214,0.1759709268808365,0.18258723616600037,-0.27111881971359253,0.39362001419067383,-0.07574485242366791,-0.025451164692640305,-0.1271790862083435,0.09949928522109985,0.24579326808452606,0.2878812849521637},{-0.2987551689147949,0.34234926104545593,-0.026721246540546417,0.011920597404241562,-0.24216194450855255,-0.25123900175094604,0.17766761779785156,-0.3225320875644684,-0.11021850258111954,-0.3893420696258545,-0.09392095357179642,-0.043184492737054825,0.15001307427883148,-0.21462757885456085,-0.1498820185661316,-0.31426680088043213,-0.17139598727226257,-0.025261174887418747,0.36718329787254333,-0.2534421980381012,0.17350655794143677,-0.2890816926956177,0.0422140434384346,0.2588067054748535,-0.10945095866918564,0.1760934740304947,0.24045658111572266,-0.0774848610162735,-0.022519396618008614,0.3005867898464203,-0.24431543052196503,-0.3275447189807892},{-0.0029695245902985334,0.23378416895866394,0.17443881928920746,-0.2594124376773834,0.2692302465438843,0.006824004463851452,-0.16738082468509674,-0.011873363517224789,0.1882077306509018,-0.23623962700366974,-0.1061725914478302,0.06411832571029663,0.16350094974040985,-0.026660233736038208,0.06021564453840256,-0.059349242597818375,0.19655363261699677,-0.3196640610694885,0.2851940095424652,0.021424349397420883,-0.19462737441062927,0.2351723164319992,-0.14068660140037537,-0.26251375675201416,0.23800276219844818,-0.047989845275878906,0.04299301281571388,-0.10145283490419388,0.09920840710401535,-0.1730932593345642,0.36156412959098816,0.30265873670578003},{0.04636819288134575,-0.25855958461761475,-0.20749111473560333,0.06266697496175766,-0.04223359748721123,0.2953130304813385,-0.15228697657585144,-0.38229620456695557,0.3760383129119873,0.0674353539943695,0.016938041895627975,0.05284213647246361,-0.04567240923643112,0.24795763194561005,-0.2295602709054947,-0.36385318636894226,0.007211417891085148,0.051608871668577194,0.14840704202651978,0.4863471984863281,-0.31282055377960205,0.2350979894399643,-0.16126489639282227,0.14027903974056244,0.17157942056655884,-0.3631335496902466,-0.1647409349679947,-0.3701792061328888,-0.21184779703617096,-0.17705829441547394,0.14094088971614838,-0.443088561296463},{-0.14650709927082062,0.39267703890800476,-0.019243324175477028,-0.14014002680778503,-0.21454176306724548,-0.32093092799186707,0.06106759235262871,-0.1616922914981842,0.3781815469264984,-0.0648864135146141,0.20814639329910278,0.29958826303482056,0.0079879155382514,0.09502760320901871,-0.17761877179145813,0.15763355791568756,-0.2225695550441742,-0.44717636704444885,-0.39535635709762573,0.0775018110871315,0.12839657068252563,-0.21137750148773193,-0.4273086190223694,-0.3054776191711426,-0.07150249928236008,0.21644127368927002,0.436657190322876,0.024626709520816803,-0.12203773111104965,-0.04964775592088699,-0.030939213931560516,0.11495678126811981},{-0.26089903712272644,-0.18739421665668488,-0.1927405595779419,0.05946061760187149,-0.2788315713405609,-0.1567271649837494,-0.08904903382062912,-0.15991444885730743,-0.31046468019485474,-0.27579689025878906,0.21938256919384003,0.15394164621829987,-0.2739473879337311,0.30845049023628235,-0.0632169246673584,0.1454375833272934,0.08243297785520554,0.045876555144786835,0.06045634672045708,0.1948586255311966,0.2029971331357956,0.2562766373157501,0.12215228378772736,0.27710026502609253,0.12353085726499557,-0.2412988245487213,-0.18408876657485962,0.21755073964595795,-0.08137550204992294,-0.19164960086345673,-0.20869719982147217,-0.23630088567733765},{-0.26450425386428833,-0.18575410544872284,-0.35575711727142334,0.11863669008016586,-0.09061308950185776,-0.062222495675086975,-0.12137464433908463,0.12170539796352386,-0.0689934715628624,0.07960676401853561,-0.23856598138809204,0.03158959746360779,0.18277141451835632,-0.10206996649503708,0.05912090837955475,0.23354223370552063,-0.1386794000864029,-0.15952375531196594,0.1769312173128128,0.05945342779159546,0.18752439320087433,-0.009913668967783451,-0.19900481402873993,0.04097798839211464,0.21308596432209015,-0.2517532408237457,0.13623595237731934,0.08453164994716644,0.09264270961284637,-0.15863828361034393,0.24643513560295105,-0.05439555644989014},{0.2360709011554718,-0.027781199663877487,0.014440000988543034,0.16612161695957184,-0.334651917219162,-0.023448215797543526,0.11128897964954376,0.18134678900241852,-0.06412714719772339,-0.15208078920841217,0.31548383831977844,-0.13187609612941742,0.051720231771469116,-0.02246188186109066,-0.16096438467502594,0.23702280223369598,-0.018644511699676514,-0.09224583208560944,0.10169554501771927,-0.2783721387386322,-0.009854413568973541,-0.26326149702072144,-0.2089187204837799,0.25300318002700806,-0.05252057686448097,-0.07067582756280899,0.15004852414131165,0.022044586017727852,-0.19025206565856934,-0.06011611595749855,-0.07214006036520004,-0.07986312359571457},{0.32331588864326477,-0.08604937046766281,0.10014855116605759,0.026823928579688072,-0.013971487060189247,-0.07452546060085297,0.19865629076957703,-0.21949008107185364,0.2557193338871002,0.3186923861503601,0.012158829718828201,0.12362955510616302,0.23878566920757294,0.33635225892066956,-0.2836575508117676,-0.33780863881111145,-0.24639227986335754,0.08108031749725342,-0.15615303814411163,-0.27716246247291565,-0.17665377259254456,0.27707335352897644,0.06611038744449615,0.15672828257083893,-0.15861915051937103,-0.1378374844789505,-0.1486218422651291,-0.2484641820192337,0.2505791187286377,0.19969509541988373,-0.3137832581996918,-0.13227859139442444},{-0.11696276813745499,0.13848930597305298,0.26127326488494873,-0.06613403558731079,-0.04941842332482338,0.05970882996916771,-0.01863219402730465,-0.31994131207466125,0.2159186154603958,0.2486243098974228,0.16648979485034943,0.22523227334022522,-0.22190797328948975,0.22108635306358337,-0.29481443762779236,0.2839645445346832,0.18050338327884674,-0.24849069118499756,0.21885502338409424,0.10653050988912582,-0.3342328369617462,0.3314550817012787,-0.2879595160484314,0.15388834476470947,0.2467750459909439,0.26774364709854126,0.08486425876617432,0.1187749132514,-0.1972343474626541,0.21482005715370178,-0.05069379881024361,0.10693304240703583},{-0.10198433697223663,-0.11374138295650482,-0.00752363121137023,0.1782226413488388,0.030150268226861954,0.2218894213438034,-0.288950651884079,-0.0866558626294136,-0.11294596642255783,-0.05681300163269043,-0.18785981833934784,-0.1670796275138855,0.031002897769212723,-0.2033247947692871,0.0935775637626648,-0.19206149876117706,0.24201202392578125,-0.048738498240709305,-0.33823162317276,-0.29389604926109314,0.11053828150033951,0.18776467442512512,-0.18959465622901917,0.2991209626197815,-0.26144590973854065,0.0725758820772171,0.11605793237686157,-0.08606932312250137,0.1654438078403473,-0.2290930151939392,0.3417484760284424,0.17436181008815765},{0.3278168737888336,0.03689562529325485,0.1055305227637291,0.1840234249830246,-0.21031686663627625,0.18318502604961395,-0.05824630707502365,0.1961570829153061,0.08543664216995239,0.05643601715564728,0.09348178654909134,-0.34671878814697266,-0.2878795266151428,0.009320957586169243,0.0979049801826477,-0.0782814472913742,0.27964073419570923,0.15674519538879395,-0.17199094593524933,-0.23342609405517578,0.33474522829055786,0.18021024763584137,0.26182085275650024,0.08625862747430801,-0.045816488564014435,0.0416545569896698,-0.06527788937091827,-0.1607694923877716,0.2938050925731659,0.04983590915799141,-0.1870574802160263,0.13003209233283997},{-0.02492344193160534,0.025364084169268608,-0.07142627984285355,-0.23009659349918365,-0.09977356344461441,-0.23552581667900085,-0.2336975783109665,-0.1553337424993515,0.002288349438458681,-0.022488214075565338,-0.2692391276359558,0.032268255949020386,-0.2138054370880127,-0.14218176901340485,-0.002338357036933303,0.09871262311935425,0.2644025683403015,-0.18364134430885315,-0.34548360109329224,0.25842490792274475,-0.18534745275974274,0.28406205773353577,0.016778910532593727,-0.036237508058547974,0.05048491433262825,0.16506995260715485,-0.07406729459762573,-0.2536490857601166,0.21443882584571838,0.23435287177562714,-0.1261368840932846,0.18260979652404785},{-0.2680011987686157,-0.029740942642092705,0.028627650812268257,-0.033609263598918915,0.08704275637865067,0.11693543195724487,-0.1745651662349701,0.12249969691038132,-0.16322915256023407,-0.18213558197021484,0.11988887935876846,-0.13126759231090546,-0.21727849543094635,0.22645734250545502,-0.005765331909060478,0.01188950426876545,0.2136658877134323,-0.24574334919452667,-0.1712723672389984,0.2608465552330017,0.05963639169931412,0.2075694352388382,-0.05959717929363251,-0.0024184577632695436,-0.27284160256385803,-0.1645093858242035,0.03796721622347832,0.2975614070892334,0.0049863168969750404,0.001065266435034573,0.2761089503765106,0.30912262201309204}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.051477108150720596,0.2587449550628662,0.46741363406181335,-0.07172869890928268},{0.13547328114509583,-0.16565699875354767,0.058807045221328735,0.2566085159778595},{-0.18615034222602844,0.17561590671539307,0.16664041578769684,0.12534327805042267},{0.3122711479663849,0.012075874954462051,0.053114958107471466,0.4875516891479492},{-0.11962030827999115,0.11912129074335098,0.41664984822273254,-0.0760064646601677},{-0.11131387203931808,0.28084591031074524,0.2901492118835449,-0.15775053203105927},{-0.350797563791275,-0.007891401648521423,0.00565161369740963,-0.13182757794857025},{-0.4281906187534332,-0.16764727234840393,0.4512997567653656,-0.31727373600006104},{0.4154305160045624,-0.1502211093902588,-0.3109043836593628,-0.4483259618282318},{0.0710204690694809,0.3602384924888611,0.4152204394340515,-0.5320120453834534},{-0.23509766161441803,-0.195927232503891,-0.2717483341693878,0.1895483285188675},{0.46080851554870605,-0.2252165675163269,-0.06075490266084671,0.2415936142206192},{0.34457898139953613,0.2877297103404999,-0.049944184720516205,0.1397339403629303},{0.028171947225928307,0.13748744130134583,-0.34688207507133484,-0.02638188749551773},{0.11895950883626938,0.32647210359573364,0.46378961205482483,0.3645298182964325},{0.2046169936656952,0.02759195677936077,0.31202206015586853,0.2804005742073059},{-0.28967660665512085,-0.10538280010223389,-0.10543391853570938,-0.32869383692741394},{-0.2793292999267578,0.16083502769470215,-0.16915813088417053,-0.11410526931285858},{-0.26617011427879333,0.27503156661987305,0.18925410509109497,0.3811497986316681},{-0.034968968480825424,0.36860793828964233,-0.2406550645828247,0.10150785744190216},{-0.3461040258407593,-0.4254038631916046,-0.09624666720628738,0.06342868506908417},{0.4259723126888275,0.5524947047233582,0.05213119089603424,-0.38653677701950073},{-0.09435077756643295,0.2345004826784134,0.277958482503891,0.19447338581085205},{-0.11550199240446091,0.4263012409210205,-0.0805206298828125,-0.18664726614952087},{0.054284851998090744,-0.04175964370369911,-0.14918197691440582,0.053252752870321274},{0.32951655983924866,-0.5305420160293579,-0.017700618132948875,0.05552983656525612},{0.019216205924749374,-0.44302597641944885,-0.25799617171287537,-0.23624278604984283},{0.11317112296819687,-0.2130085527896881,0.1971677839756012,0.24448107182979584},{0.009582781232893467,-0.07384961098432541,0.16223488748073578,0.062235794961452484},{-0.438886433839798,0.38335439562797546,0.2573392987251282,-0.0705498680472374},{0.4098803400993347,-0.1469339281320572,0.2544762194156647,-0.11993090063333511},{0.09948624670505524,-0.49373453855514526,0.48124945163726807,-0.36250391602516174}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.07078807055950165,-0.03486287221312523,0.0519656278192997,-0.038954492658376694,-0.028713854029774666,-0.12952931225299835,-0.13295045495033264,0.0578596405684948,0.053392037749290466,-0.012296661734580994,0.08257042616605759,0.058948054909706116,-0.0865938663482666,-0.1349322497844696,0.07351182401180267,-0.09026958048343658};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06736361980438232,0.07568076997995377,0.025825513526797295,0.017728956416249275,0.0801796019077301,-0.023219970986247063,0.09823505580425262,-0.023704595863819122,-0.03341738134622574,0.025791902095079422,-0.01579011045396328,-0.048412345349788666,0.07604819536209106,-0.040359266102313995,-0.043125417083501816,-0.03339390084147453};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07982203364372253,0.07032749801874161,0.02608991414308548,0.07603234052658081,0.056085698306560516,0.0007722869631834328,-0.04612267017364502,-0.02263769507408142,-0.030679304152727127,0.016532400622963905,-0.06687408685684204,0.040876928716897964,0.06519442796707153,-0.07473684102296829,0.0967271700501442,0.08800558000802994,-0.07915009558200836,-0.07010357826948166,0.02765176258981228,0.006770875304937363,-0.0613800585269928,0.022629419341683388,0.08891960233449936,0.0023602372966706753,-0.035604432225227356,0.004985141567885876,-0.06911265850067139,0.05855897441506386,0.0534718818962574,0.01687048189342022,0.038871727883815765,0.035041630268096924};
static const float action_parameterization_distribution_linear_bias[4] = {0.04495873674750328,0.024390192702412605,0.06535151600837708,0.05171043425798416};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.011751772835850716,0.23319873213768005,-0.14926446974277496,0.22562870383262634,0.22943119704723358,0.0978185385465622,0.28080570697784424,-0.01094237994402647},{-0.24057093262672424,-0.08362659066915512,-0.2992013096809387,-0.21292267739772797,-0.30387547612190247,-0.19968049228191376,-0.12632213532924652,-0.18649394810199738},{-0.29776036739349365,0.0009504758636467159,0.22027437388896942,0.24556440114974976,0.2575826346874237,-0.031070442870259285,0.2619008719921112,-0.13052162528038025},{-0.02812434919178486,0.06430526077747345,-0.18760716915130615,0.008481300435960293,-0.011777395382523537,-0.06544218957424164,0.27016857266426086,-0.21800115704536438},{-0.3531545102596283,-0.15178973972797394,-0.23251646757125854,-0.12956513464450836,-0.03857634961605072,0.16212067008018494,0.1689738631248474,-0.07215171307325363},{-0.3249615430831909,-0.028619881719350815,0.3781146705150604,0.24601459503173828,0.18860873579978943,-0.13032998144626617,-0.13604119420051575,-0.14919425547122955},{-0.2158237099647522,0.04886849224567413,0.4038303792476654,-0.21323977410793304,-0.09673882275819778,-0.41909825801849365,-0.09064771234989166,-0.1703120321035385},{-0.3107762336730957,-0.3576071560382843,0.4780196249485016,-0.10187100619077682,-0.20271433889865875,0.21127675473690033,0.17153608798980713,-0.25898972153663635},{-0.31639400124549866,0.2655450701713562,-0.19858555495738983,0.36532309651374817,0.09694542735815048,-0.3454734683036804,0.07367246598005295,0.05904551222920418},{-0.30912885069847107,-0.31640562415122986,-0.176152303814888,-0.21136575937271118,-0.5223739147186279,0.10369178652763367,-0.0033732152078300714,0.10315024107694626},{0.1713661551475525,0.34396934509277344,0.2055540382862091,-0.02465430274605751,0.16368067264556885,0.10616999864578247,-0.20694278180599213,0.1658799946308136},{0.2017451673746109,0.04003293812274933,0.27920132875442505,0.24075832962989807,-0.3074682652950287,0.2834254205226898,0.00621371902525425,-0.26840582489967346},{0.11363349854946136,-0.29370632767677307,0.26259249448776245,-0.036244526505470276,-0.33156266808509827,-0.08527534455060959,-0.1658182293176651,-0.14430657029151917},{-0.2225179523229599,-0.18488004803657532,0.3000389635562897,0.36116310954093933,-0.23822619020938873,-0.08420465886592865,-0.2976181209087372,0.1902318298816681},{0.024010121822357178,-0.1599622517824173,0.05394604802131653,-0.22552570700645447,-0.36979877948760986,-0.1579241007566452,0.21467158198356628,0.014540751464664936},{0.15202389657497406,-0.02318371832370758,-0.08139603585004807,-0.30459943413734436,-0.052242033183574677,0.05296730995178223,-0.003732785116881132,0.39583465456962585},{-0.01632056199014187,-0.21649684011936188,-0.21163634955883026,0.06310215592384338,-0.1410389542579651,-0.12125004827976227,-0.13796018064022064,0.08338066935539246},{-0.1732429563999176,-0.26472437381744385,0.041406065225601196,0.02388909086585045,0.1758626252412796,-0.20276322960853577,0.357889324426651,0.1249670535326004},{0.04460136592388153,0.12400578707456589,-0.23841722309589386,0.1158796101808548,0.11940441280603409,0.17401544749736786,-0.2223735749721527,0.2985382080078125},{0.18239974975585938,-0.0366811566054821,-0.35726115107536316,0.07249211519956589,-0.04420947656035423,-0.05175822600722313,-0.319180965423584,-0.03755619376897812},{0.08412370085716248,-0.1281784176826477,0.054543718695640564,-0.129532590508461,0.30555617809295654,0.017371224239468575,-0.08691225945949554,0.41817355155944824},{0.03972458839416504,0.1549912393093109,-0.2635270655155182,0.21455839276313782,0.3096952736377716,0.3127645254135132,0.1401120275259018,-0.31608811020851135},{-0.3863285779953003,-0.09673818200826645,0.14982976019382477,-0.09045395255088806,0.19704535603523254,-0.32100316882133484,0.1684042513370514,-0.25373345613479614},{-0.12594127655029297,0.08328349143266678,-0.05709616839885712,-0.39652687311172485,0.22471025586128235,-0.021511046215891838,-0.37135714292526245,0.19995126128196716},{-0.20988984405994415,-0.17921271920204163,-0.0206418689340353,0.10165078938007355,-0.03134613856673241,0.1556440144777298,0.2823452353477478,-0.05147000774741173},{-0.21238374710083008,0.06271953880786896,-0.36054113507270813,-0.2756899893283844,0.14297525584697723,-0.0022215552162379026,-0.09897404164075851,0.1091012954711914},{0.3256727457046509,0.3857138752937317,-0.2709944546222687,0.1708143949508667,0.1785767823457718,0.34250932931900024,-0.30197224020957947,-0.12284915894269943},{0.37682390213012695,0.2585605978965759,0.08080855756998062,0.062340203672647476,0.23715338110923767,0.14180077612400055,0.2297743707895279,0.3901798725128174},{-0.12118232250213623,0.4045407474040985,0.170493945479393,-0.0016459452454000711,0.21828106045722961,0.03537869080901146,-0.36572977900505066,-0.2958325743675232},{-0.16208405792713165,-0.20456549525260925,0.07392943650484085,-0.22979328036308289,-0.2951008379459381,-0.1833621710538864,0.2812784016132355,-0.05265588313341141},{0.40369555354118347,-0.259128212928772,0.30319830775260925,-0.2645384669303894,0.08085492998361588,0.2568245828151703,0.15553459525108337,-0.20409663021564484},{0.24161198735237122,0.4004439413547516,0.3627626895904541,-0.23140902817249298,-0.17345242202281952,0.09383980184793472,0.21381443738937378,0.07996910810470581}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.025515936315059662,0.4262998104095459,-0.18972598016262054,0.24081476032733917,-0.41040515899658203,0.25774845480918884,0.40825212001800537,0.053522415459156036},{-0.42895984649658203,-0.4921133518218994,-0.3929929733276367,-0.44629454612731934,-0.4419730603694916,0.37496650218963623,0.4482472240924835,-0.4260728657245636},{-0.017880050465464592,-0.15618202090263367,0.11037630587816238,0.05738655850291252,-0.07438234239816666,0.4498507082462311,-0.364213764667511,-0.35872548818588257},{0.5196474194526672,0.02500334568321705,0.07778757065534592,-0.015910955145955086,0.5684004426002502,0.3879295885562897,0.34708237648010254,0.41822320222854614},{0.08378833532333374,0.25549745559692383,-0.1410578042268753,-0.10103169083595276,0.08322606980800629,-0.38931119441986084,-0.3711020350456238,0.4361690878868103},{0.39282795786857605,0.08398326486349106,0.03353099524974823,-0.40415242314338684,-0.44478654861450195,-0.5042333602905273,-0.1262774020433426,0.5174157619476318},{-0.47509366273880005,-0.3411114513874054,-0.06581044942140579,-0.2452310174703598,0.027800073847174644,0.45511940121650696,-0.5357711911201477,0.6151675581932068},{0.26805609464645386,0.0858156830072403,0.0015182511415332556,-0.011520682834088802,0.4095987379550934,-0.582168459892273,0.44516462087631226,-0.4118298888206482}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.076993428170681,-0.004647500813007355,0.03839195892214775,-0.0186651349067688,-0.026510706171393394,0.015007288195192814,0.0017126223538070917,0.03001115284860134};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.02139664813876152,-0.05010291561484337,0.026758290827274323,-0.07108037918806076,0.004188203252851963,-0.03297339752316475,-0.017767665907740593,-0.06565339118242264};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

