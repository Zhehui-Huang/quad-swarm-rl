#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3121378719806671,0.04686000198125839,0.02720262110233307,0.2550814151763916,0.35821470618247986,-0.24151983857154846,-0.296930730342865,0.12916916608810425,0.365233451128006,-0.3035743832588196,0.45491823554039,0.07827990502119064,0.2521969676017761,0.10764671117067337,-0.3016769289970398,0.008467658422887325},{-0.3185788094997406,-0.18993809819221497,-0.2990051507949829,-0.09558797627687454,0.18559931218624115,0.3817673623561859,0.17403621971607208,-0.007539153564721346,0.15766794979572296,0.24084767699241638,-0.10420411080121994,0.0005397603963501751,-0.10643560439348221,0.10774911940097809,0.27504342794418335,-0.23659071326255798},{-0.013916390016674995,0.24296501278877258,0.2333146631717682,0.29596221446990967,0.07505099475383759,-0.2775203287601471,0.8110904693603516,-0.2529987692832947,-0.20833341777324677,0.04710203409194946,-0.01091128122061491,-0.23205463588237762,0.327997088432312,0.6194666028022766,-0.49028220772743225,0.1694752275943756},{0.1650054007768631,-0.16021820902824402,-0.13760995864868164,-0.027285804972052574,-0.19173632562160492,0.07757711410522461,-0.04310984164476395,-0.2095228135585785,-0.002473538275808096,-0.13541817665100098,0.5975008010864258,-0.21089322865009308,-0.34467145800590515,-0.21386218070983887,0.22198715806007385,-0.05945903807878494},{-0.19562780857086182,-0.012609714642167091,0.19852426648139954,-0.44118043780326843,0.4940013289451599,0.24076378345489502,0.23847971856594086,-0.20158971846103668,-0.1910402476787567,0.28571441769599915,-0.07152308523654938,-0.43967321515083313,0.0105638662353158,-0.22328141331672668,0.45188894867897034,-0.02567128650844097},{-0.008511013351380825,-0.12263868004083633,-0.07323701679706573,-0.061521969735622406,0.08083757758140564,-0.24817095696926117,0.5917479991912842,-0.3006042540073395,-0.24155986309051514,-0.20819561183452606,0.1572750359773636,0.07490597665309906,0.3258180022239685,0.02972414717078209,0.2936168909072876,0.252966046333313},{-0.15439863502979279,0.26359373331069946,-0.027011260390281677,0.0752977728843689,-0.280100017786026,-0.11709441244602203,-0.08503949642181396,0.022412968799471855,0.34182047843933105,0.3380555510520935,-0.29050788283348083,-0.1412983536720276,0.2752802073955536,-0.0484054759144783,-0.0927247479557991,0.25579407811164856},{-0.3626868724822998,0.17273704707622528,0.012434331700205803,-0.31210511922836304,0.3969581723213196,-0.25997260212898254,-0.3458090126514435,-0.4909895360469818,-0.07036744803190231,-0.22629934549331665,0.5665119290351868,0.1433628499507904,0.024411456659436226,0.457933247089386,0.053215403109788895,0.6207354664802551},{0.286117821931839,0.12441170960664749,-0.2011461704969406,0.0298603605479002,-0.6075820922851562,-0.5843160152435303,0.1625397801399231,-0.5851105451583862,-0.03938206285238266,-0.16613449156284332,0.3227497339248657,-0.5959509611129761,-0.5451648831367493,0.10834649205207825,0.059227317571640015,-0.30252668261528015},{0.6452881693840027,-0.7888866662979126,-0.3668590784072876,0.12229907512664795,0.1851537823677063,-0.33131471276283264,-0.029613671824336052,-0.2370966523885727,-0.37460944056510925,-0.01018306240439415,-0.2872471511363983,-0.33586159348487854,0.5868214964866638,-0.29551583528518677,-0.7561578154563904,-0.26998409628868103},{0.30750545859336853,0.33358705043792725,-0.13501711189746857,0.08814859390258789,0.05128519982099533,-0.20127131044864655,-0.1437278687953949,0.14520232379436493,-0.05562863126397133,0.2369195818901062,0.1906420886516571,0.2407800555229187,-0.12471013516187668,0.1858872026205063,0.0462130568921566,-0.33071157336235046},{-0.4424682557582855,0.26421982049942017,0.5747384428977966,-0.8544342517852783,0.08219531923532486,0.12409323453903198,0.14127343893051147,0.30596724152565,0.33705347776412964,0.43598324060440063,0.44428059458732605,-0.3453410863876343,0.3224373757839203,-0.2155332714319229,0.047533582895994186,-0.2097497582435608},{0.13446363806724548,-0.25375017523765564,-0.2490384727716446,0.33898478746414185,-0.20619365572929382,-0.2688367962837219,-0.06613938510417938,0.3541543185710907,0.25183793902397156,-0.1155749261379242,-0.26756829023361206,0.30842429399490356,0.3974928557872772,0.303790807723999,-0.17370304465293884,0.6180198788642883},{0.2895127236843109,0.26607972383499146,-0.33017420768737793,0.13015416264533997,-0.06885874271392822,-0.15034587681293488,-0.22951330244541168,0.16468766331672668,-0.3101460635662079,-0.3628217875957489,-0.08604297786951065,0.08119631558656693,-0.573803722858429,-0.08542685955762863,-0.28967419266700745,-0.14987915754318237},{0.1538555920124054,0.5994744300842285,0.4560101330280304,-0.45039013028144836,-0.3061291575431824,0.26752424240112305,-0.07111410796642303,0.061772074550390244,0.49039867520332336,0.34915459156036377,-0.22305339574813843,0.13336439430713654,-0.17415177822113037,-0.33044081926345825,0.20080320537090302,-0.3335142433643341},{-0.32864969968795776,-0.0697547197341919,-0.030349070206284523,0.2179354578256607,-0.03384383022785187,0.043157462030649185,-0.14817498624324799,-0.06526269018650055,-0.3787842094898224,-0.08592095971107483,0.27399569749832153,0.10276544839143753,-0.18371477723121643,-0.2212916761636734,-0.3955376446247101,-0.11432525515556335},{-0.2870899736881256,0.15456843376159668,-0.22742626070976257,0.010606911033391953,-0.13544486463069916,0.33067888021469116,0.32950371503829956,0.14570288360118866,0.23128588497638702,-0.22431127727031708,-0.06752174347639084,-0.11739655584096909,-0.005207774695008993,0.054204341024160385,-0.011255573481321335,-0.15226612985134125},{0.12780623137950897,-0.4984244406223297,0.14176180958747864,0.19221828877925873,0.004323726054280996,0.27406927943229675,0.31222668290138245,0.16639778017997742,-0.15609925985336304,-0.28211063146591187,-0.13986171782016754,-0.09892237186431885,-0.1147831454873085,-0.38448798656463623,0.08035285770893097,0.00018194086442235857}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1581728160381317,0.3121209740638733,0.3627622127532959,-0.08948029577732086,-0.20062726736068726,0.06911821663379669,0.0663149431347847,0.26005277037620544,-0.04777222499251366,0.2807547450065613,0.49313652515411377,-0.36279377341270447,-0.12512832880020142,0.06512269377708435,0.025394240394234657,-0.033614303916692734},{-0.5581501722335815,0.2165367752313614,-0.31497690081596375,0.2579065263271332,0.3499807119369507,-0.14464734494686127,-0.3517642319202423,-0.2659341096878052,0.29870784282684326,0.31217724084854126,-0.08991832286119461,0.2407819926738739,-0.3469087481498718,0.14886434376239777,-0.2610777020454407,0.4422079622745514},{-0.4052971601486206,0.1803116798400879,-0.3789535462856293,0.03464353829622269,-0.4165291488170624,-0.3005989193916321,-0.11806949228048325,0.024933621287345886,-0.2442978173494339,0.34841200709342957,0.20734725892543793,-0.07068467140197754,0.23300813138484955,-0.35316142439842224,-0.060093410313129425,0.006927422247827053},{0.24360452592372894,-0.2250296026468277,0.08926478028297424,0.4429423213005066,-0.44665947556495667,-0.34543243050575256,0.27136775851249695,0.11359472572803497,0.3030242919921875,-0.09230034053325653,0.3157944083213806,0.10819636285305023,-0.2657281756401062,-0.03101344220340252,-0.013983413577079773,-0.3467271029949188},{-0.3726005256175995,0.01667935773730278,0.2554892897605896,-0.37307003140449524,0.15986907482147217,0.3192230463027954,-0.32200050354003906,0.23246869444847107,-0.21587221324443817,0.1854403018951416,-0.12210170179605484,-0.0019817459397017956,-0.14419911801815033,-0.0034351786598563194,-0.19581356644630432,-0.1887759566307068},{0.010775960981845856,-0.2181253731250763,-0.024632615968585014,-0.3587292432785034,0.28878191113471985,0.08791932463645935,-0.022342350333929062,-0.08424288779497147,-0.20928949117660522,0.37132009863853455,0.298874169588089,-0.08750181645154953,-0.15395532548427582,0.23996664583683014,-0.06434231996536255,-0.36164745688438416},{0.2300601601600647,-0.13539892435073853,0.30589526891708374,-0.2945939004421234,-0.3734174966812134,-0.04325060546398163,-0.37331056594848633,0.35617655515670776,-0.12284285575151443,-0.23419871926307678,-0.27441641688346863,-0.04646122455596924,-0.032196179032325745,-0.08838910609483719,0.4573974311351776,-0.38889506459236145},{-0.28987306356430054,0.3889996111392975,-0.06481479853391647,0.2693111300468445,0.012859494425356388,-0.23419660329818726,-0.09310973435640335,0.11605004966259003,-0.04211290180683136,0.4937990605831146,0.16723625361919403,-0.22123947739601135,0.02583494782447815,-0.0879003182053566,0.058586206287145615,0.1701219230890274},{0.12880726158618927,0.29201993346214294,-0.16393111646175385,-0.3409603238105774,0.386363685131073,-0.1936980038881302,0.23529896140098572,-0.36009785532951355,0.10290590673685074,0.035294629633426666,0.13539284467697144,0.10977131128311157,-0.033379558473825455,-0.28304851055145264,-0.08972615003585815,0.23077403008937836},{-0.21900704503059387,-0.007216306868940592,-0.2954416573047638,-0.3354308307170868,0.24394556879997253,-0.47958940267562866,-0.20723524689674377,0.2562274634838104,-0.13330605626106262,0.20392060279846191,-0.0285649374127388,-0.0776199996471405,-0.3599730134010315,-0.005715419538319111,-0.23560750484466553,-0.35780423879623413},{-0.26539933681488037,-0.11977052688598633,-0.10131394863128662,-0.34796610474586487,-0.3318043649196625,0.0009126796503551304,0.11808833479881287,-0.4851223826408386,0.014418802224099636,-0.05251152068376541,0.15675237774848938,0.007755731698125601,0.4153572916984558,0.03076271153986454,0.22794771194458008,0.23140181601047516},{-0.21554312109947205,-0.05506007745862007,-0.4377698302268982,0.3655646741390228,0.13228705525398254,0.003757606726139784,0.16452556848526,0.08294747769832611,-0.40786027908325195,0.22025957703590393,-0.3539937734603882,-0.1475469022989273,-0.3876177966594696,0.4116852581501007,-0.3505830466747284,0.08557529747486115},{-0.1567676067352295,-0.44557562470436096,-0.10483282804489136,0.1605035960674286,-0.18384438753128052,-0.10066082328557968,-0.08261188119649887,0.3918735086917877,0.4234714210033417,0.09505899250507355,-0.08536972850561142,-0.26527470350265503,0.15559104084968567,-0.37116843461990356,0.14960186183452606,-0.211503803730011},{-0.26632899045944214,-0.46220165491104126,-0.1681842803955078,-0.11718059331178665,-0.4561494290828705,0.3708987236022949,-0.07529377192258835,0.19694899022579193,-0.18086430430412292,-0.3310088813304901,-0.30058589577674866,0.40639424324035645,-0.20301707088947296,0.0651133581995964,-0.2667824327945709,0.3851098120212555},{-0.32553523778915405,0.34557676315307617,-0.16503499448299408,0.11470885574817657,-0.3662022054195404,0.2065381556749344,0.04812086746096611,-0.3705118000507355,0.10966447740793228,0.18222129344940186,-0.16332325339317322,0.0643690675497055,0.29553285241127014,-0.24495306611061096,-0.3439583480358124,-0.1754826158285141},{-0.14998897910118103,-0.367082804441452,-0.524682879447937,0.2984156012535095,0.03605907782912254,0.13682179152965546,-0.26142632961273193,0.20214886963367462,-0.42835649847984314,-0.32199668884277344,-0.39713767170906067,0.2409222275018692,-0.23267360031604767,0.18848992884159088,0.09724974632263184,0.32961753010749817}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.05607124790549278,-0.11530817300081253,0.12368292361497879,-0.11538964509963989,-0.09059552848339081,0.11645200848579407,0.1652243584394455,-0.25196021795272827,-0.14227156341075897,0.30383607745170593,0.07049911469221115,0.1371559202671051,0.11339656263589859,0.13856564462184906,-0.17962054908275604,0.1410791575908661,0.11118171364068985,-0.3011096119880676,-0.24808870255947113,-0.06981547921895981,-0.19315865635871887,0.13166016340255737,-0.2051311433315277,0.3658491373062134,-0.18442057073116302,-0.03942890092730522,0.11385291814804077,0.17779196798801422,-0.25612396001815796,-0.19419075548648834,0.2575110197067261,0.26744508743286133},{0.1660623401403427,-0.06419709324836731,0.16575324535369873,-0.0894634798169136,-0.09621535241603851,0.23350585997104645,0.0152546102181077,-0.06422928720712662,-0.03383815288543701,-0.040250301361083984,-0.11207756400108337,0.005545954219996929,0.3892594575881958,0.21402223408222198,0.11896923929452896,0.043602243065834045,-0.24493013322353363,-0.2742527425289154,0.10769649595022202,0.04410470277070999,0.07110762596130371,0.299344927072525,0.2685115337371826,-0.1515374332666397,0.04631352797150612,0.2833751142024994,-0.35455819964408875,0.19899821281433105,0.08610934764146805,-0.23839832842350006,-0.08170589804649353,-0.02273017354309559},{-0.0739019587635994,-0.061464641243219376,0.18267786502838135,-0.1528250277042389,-0.1802685707807541,0.029501372948288918,-0.2569546401500702,0.16708675026893616,0.23987513780593872,0.0035190554335713387,-0.2153686136007309,0.07999657839536667,0.3657098710536957,-0.2367289513349533,0.09895829111337662,-0.04853517934679985,-0.39207109808921814,0.23715470731258392,-0.3620903193950653,-0.04108486324548721,-0.06687048077583313,-0.07989659160375595,-0.061835113912820816,-0.05553200840950012,-0.021996889263391495,0.3836044371128082,-0.06418956071138382,0.09764565527439117,0.26041722297668457,-0.37505513429641724,-0.0928330272436142,-0.0035690004006028175},{0.16390866041183472,-0.23394881188869476,0.010394161567091942,-0.3858807384967804,0.09222955256700516,-0.10749979317188263,-0.058783553540706635,0.20051267743110657,0.050910547375679016,0.23364803194999695,0.031250111758708954,-0.1375948041677475,-0.20450858771800995,-0.04583029821515083,0.24968311190605164,-0.221944659948349,0.051104363054037094,-0.0649307444691658,-0.15111728012561798,0.12063472718000412,-0.16891896724700928,0.15855836868286133,-0.24961824715137482,0.3027868866920471,-0.26537206768989563,0.03352215141057968,-0.07166262716054916,-0.23445582389831543,0.03673151507973671,0.03226611390709877,0.22337830066680908,-0.14792002737522125},{0.26400846242904663,-0.03657141327857971,0.025451714172959328,0.2647804617881775,-0.29015204310417175,-0.09049071371555328,0.17247945070266724,-0.02224116586148739,0.11451050639152527,-0.18447202444076538,0.006665267050266266,-0.07800813764333725,-0.19273297488689423,-0.13510261476039886,0.29392045736312866,0.25386425852775574,-0.048851076513528824,-0.32995837926864624,0.1292991042137146,-0.118850938975811,-0.13244222104549408,0.2243296056985855,0.25587430596351624,0.019084664061665535,-0.10751041769981384,-0.10331372171640396,0.023929450660943985,0.2469812035560608,0.2344699203968048,0.09508319199085236,0.13382795453071594,-0.2344149798154831},{0.29817837476730347,-0.14975638687610626,0.01663505658507347,0.0922960713505745,-0.1368013620376587,-0.32094964385032654,-0.24062848091125488,-0.3198757767677307,-0.17778180539608002,0.02877012826502323,-0.03890825808048248,0.018459945917129517,-0.07743951678276062,-0.0670555830001831,-0.19865350425243378,-0.2719731330871582,0.15258100628852844,0.010801205411553383,-0.328228622674942,0.21626758575439453,-0.09031304717063904,-0.18353314697742462,0.20125915110111237,-0.14697182178497314,-0.15522946417331696,-0.22244484722614288,-0.11744894832372665,0.08010891824960709,0.0982261598110199,0.2284536361694336,-0.2648758590221405,0.18132486939430237},{0.17787472903728485,0.08004314452409744,0.22090774774551392,-0.14918969571590424,0.23663422465324402,-0.21105621755123138,-0.3079918920993805,-0.02108553797006607,0.2874744236469269,0.1253332495689392,-0.1605527400970459,0.13205702602863312,0.07442126423120499,0.31580236554145813,0.10302146524190903,-0.05031808093190193,-0.21313214302062988,0.11587686091661453,-0.016887526959180832,-0.04681768640875816,-0.08514781296253204,0.21326184272766113,0.16845469176769257,0.12548047304153442,-0.2735807001590729,-0.209941565990448,-0.2595275342464447,-0.3226066827774048,0.08285215497016907,-0.13647519052028656,0.3205399811267853,0.16294677555561066},{0.3176538050174713,-0.3739142417907715,0.06589866429567337,-0.4225703477859497,-0.3270754814147949,0.29818227887153625,0.4028269052505493,0.18845807015895844,-0.055120132863521576,0.10387656092643738,0.1668359637260437,-0.13562791049480438,0.06702220439910889,0.2965497076511383,-0.04357729107141495,0.20130102336406708,0.4012264013290405,-0.2624434530735016,-0.07778961211442947,-0.37754806876182556,0.19428613781929016,0.23976227641105652,0.1919451206922531,0.14419764280319214,0.13863039016723633,0.11582638323307037,0.16624976694583893,0.26772305369377136,-0.12540729343891144,-0.2757672369480133,0.2461511641740799,0.0594925694167614},{0.05425667762756348,-0.09214355796575546,0.20885325968265533,0.2692148983478546,-0.2184947431087494,-0.3152635395526886,-0.08442822843790054,0.2327405959367752,-0.18879540264606476,-0.19926565885543823,0.02471468783915043,0.12541460990905762,0.14720843732357025,-0.30782029032707214,0.15210294723510742,-0.17288725078105927,-0.2155465930700302,0.16046734154224396,-0.28089436888694763,0.2677081227302551,-0.3505750596523285,-0.29578885436058044,-0.3199841380119324,0.24497662484645844,0.09328250586986542,0.09377260506153107,0.3184557259082794,0.2131166309118271,-0.16241508722305298,-0.33414435386657715,-0.1373853236436844,0.17526108026504517},{0.32605427503585815,0.048730410635471344,0.03071746788918972,0.23509332537651062,0.041892703622579575,0.24925586581230164,-0.052856333553791046,0.23633314669132233,-0.06617926806211472,0.033971842378377914,0.16125188767910004,0.10700363665819168,-0.09494464844465256,-0.31657540798187256,0.18886761367321014,0.20859390497207642,-0.001526382053270936,-0.15404006838798523,-0.00269789295271039,0.013937645591795444,0.08531449735164642,-0.32056549191474915,0.36746639013290405,0.03990602120757103,-0.055730678141117096,0.1119052991271019,-0.3819144070148468,-0.1723729819059372,0.01455407403409481,0.022249450907111168,0.08497001975774765,0.21294459700584412},{-0.09218952804803848,0.0855388194322586,-0.07550497353076935,0.19827578961849213,-0.0877927914261818,0.2965056896209717,0.08604703098535538,-0.09403877705335617,0.2738674283027649,-0.30883267521858215,-0.16512754559516907,0.16010937094688416,-0.08981062471866608,0.08218925446271896,-0.30122748017311096,0.03519458323717117,0.06361313164234161,0.16355958580970764,0.08146132528781891,-0.12545984983444214,-0.26636457443237305,0.1762525886297226,0.24172835052013397,0.2284010350704193,-0.32678332924842834,0.34707018733024597,-0.1558370292186737,0.011949442327022552,-0.1174514889717102,0.13139842450618744,0.20630662143230438,0.25529834628105164},{-0.1983124315738678,0.2786540687084198,-0.08496683090925217,-0.01569407992064953,-0.23243220150470734,-0.16353382170200348,0.15430627763271332,-0.2879650294780731,-0.019341422244906425,-0.23626600205898285,-0.22147227823734283,-0.07023224234580994,0.17823030054569244,-0.2815764844417572,-0.1107352152466774,-0.38008913397789,-0.15506751835346222,-0.011282233521342278,0.2816287577152252,-0.2813376486301422,0.06094731390476227,-0.14226919412612915,0.019658740609884262,0.2868068218231201,-0.13631004095077515,0.14767923951148987,0.2818995416164398,-0.1296929270029068,-0.0708526074886322,0.29401421546936035,-0.1763748675584793,-0.3006580173969269},{-0.04305540770292282,0.2311791181564331,0.2527253329753876,-0.3419477939605713,0.325028657913208,0.03875505179166794,-0.1046210527420044,0.010165727697312832,0.12647606432437897,-0.28430137038230896,-0.050845663994550705,0.018404534086585045,0.1994478851556778,0.015055311843752861,0.009073905646800995,-0.03167526423931122,0.23977969586849213,-0.29117539525032043,0.33159223198890686,0.0628945529460907,-0.1696077287197113,0.1902589350938797,-0.0914691835641861,-0.22199185192584991,0.23848947882652283,-0.08893150836229324,-0.00896056555211544,-0.11104844510555267,0.04814298450946808,-0.11679316312074661,0.29997482895851135,0.2865971028804779},{0.08524422347545624,-0.20346030592918396,-0.18574263155460358,0.08327662199735641,0.07043539732694626,0.27443093061447144,-0.11054806411266327,-0.2626030743122101,0.3075876235961914,0.04237150028347969,0.04855538532137871,0.0402880497276783,-0.20712819695472717,0.10107965022325516,-0.19795313477516174,-0.29697751998901367,0.06891492009162903,-0.014383362606167793,0.1988830268383026,0.3613087236881256,-0.2217111885547638,0.10819710791110992,-0.14497704803943634,0.039199814200401306,0.07572050392627716,-0.28426843881607056,-0.14630480110645294,-0.26593631505966187,-0.06546061486005783,-0.14320647716522217,0.23277293145656586,-0.33496740460395813},{-0.0431256927549839,0.31760069727897644,0.16324205696582794,-0.19200168550014496,-0.112613745033741,-0.191838338971138,0.16498173773288727,-0.0818919762969017,0.21327415108680725,-0.02780132181942463,0.2263186126947403,0.1641402244567871,0.006617007311433554,0.06567433476448059,-0.13838228583335876,0.19322438538074493,-0.19876304268836975,-0.37643006443977356,-0.26331469416618347,0.1353159099817276,0.11462491005659103,-0.2523927390575409,-0.31813615560531616,-0.21373474597930908,-0.21890129148960114,0.05902142450213432,0.3587242364883423,0.00365006597712636,-0.1214178130030632,0.09915131330490112,-0.1522849202156067,0.10034149140119553},{-0.20820648968219757,-0.181406170129776,-0.25064340233802795,0.06841385364532471,-0.29424041509628296,-0.13852252066135406,-0.11018265783786774,-0.13692818582057953,-0.2904904782772064,-0.1909588873386383,0.11226871609687805,0.17993207275867462,-0.2682446837425232,0.27952221035957336,-0.03336102142930031,0.18700113892555237,0.03787808492779732,0.013552558608353138,0.031093109399080276,0.11136694997549057,0.15268810093402863,0.3163492977619171,0.08658941090106964,0.22356323897838593,0.11745065450668335,-0.23575621843338013,-0.12493310868740082,0.2610136866569519,-0.020197145640850067,-0.21950110793113708,-0.1700267791748047,-0.17403224110603333},{-0.3406077027320862,-0.20328129827976227,-0.3888053596019745,0.08401677012443542,-0.16879631578922272,-0.11765111237764359,-0.1489104926586151,0.041731737554073334,-0.019845537841320038,0.05778101459145546,-0.22480283677577972,0.020276948809623718,0.1534973382949829,-0.009775028564035892,0.0045587909407913685,0.163833349943161,-0.15003573894500732,-0.08412850648164749,0.14821742475032806,0.12292811274528503,0.22765888273715973,-0.005158951971679926,-0.2931521236896515,0.06463082134723663,0.2561645209789276,-0.2913012206554413,0.18640200793743134,-0.019300444051623344,0.042012859135866165,-0.16438798606395721,0.17837481200695038,-0.12192241102457047},{0.2696785628795624,-0.04965810850262642,0.054348528385162354,0.11971350014209747,-0.290336549282074,-0.004021910950541496,0.15752509236335754,0.21621569991111755,-0.08574485033750534,-0.1083250418305397,0.3092445731163025,-0.1802179366350174,-0.018619677051901817,-0.0573200099170208,-0.14848068356513977,0.22353202104568481,0.012803638353943825,-0.06735098361968994,0.12740102410316467,-0.280186265707016,0.03720593824982643,-0.309345006942749,-0.23740153014659882,0.2539185583591461,-0.13701200485229492,-0.1319989562034607,0.16433261334896088,-0.012981338426470757,-0.15900231897830963,-0.002330771181732416,-0.09835781902074814,-0.03769589960575104},{0.2914141118526459,-0.04799393564462662,0.07208479940891266,0.06849605590105057,-0.016968049108982086,-0.11622104793787003,0.15388250350952148,-0.24214377999305725,0.22618573904037476,0.27224093675613403,0.015241362154483795,0.16764283180236816,0.2563213109970093,0.34025609493255615,-0.30001381039619446,-0.30492332577705383,-0.3024669587612152,0.04686547443270683,-0.1441240906715393,-0.2905522286891937,-0.18585489690303802,0.2847268283367157,0.0657978355884552,0.1355792135000229,-0.1305130273103714,-0.08415699750185013,-0.14699725806713104,-0.19676946103572845,0.25149405002593994,0.15763410925865173,-0.28108859062194824,-0.1550859957933426},{-0.10915812104940414,0.15467217564582825,0.2926267981529236,-0.06320806592702866,-0.021872268989682198,0.057696837931871414,-0.015078290365636349,-0.3216988444328308,0.20547986030578613,0.2526206970214844,0.16782356798648834,0.20476944744586945,-0.249644935131073,0.19995218515396118,-0.2767147719860077,0.2914162278175354,0.14480946958065033,-0.23298132419586182,0.25415247678756714,0.14749354124069214,-0.30484670400619507,0.30631476640701294,-0.31645503640174866,0.13120612502098083,0.1821340173482895,0.2145276814699173,0.09098541736602783,0.08889931440353394,-0.2028890699148178,0.2469005435705185,-0.09688083082437515,0.09385721385478973},{-0.15508247911930084,-0.06597904115915298,0.016918852925300598,0.23139342665672302,-0.03287683054804802,0.183769091963768,-0.3504929542541504,-0.19413021206855774,-0.1620456576347351,-0.11504795402288437,-0.1815623939037323,-0.13074325025081635,0.08035249263048172,-0.09625491499900818,0.10527557879686356,-0.1863582581281662,0.14706557989120483,-0.01065090112388134,-0.32143548130989075,-0.20977427065372467,0.0964546650648117,0.21371127665042877,-0.18819883465766907,0.33259302377700806,-0.2584914565086365,0.07872273027896881,0.10434246063232422,-0.10428259521722794,0.08454588800668716,-0.24126873910427094,0.3172755837440491,0.05109373480081558},{0.3653409779071808,-0.0649469718337059,0.06591448932886124,0.13937711715698242,-0.14288510382175446,0.24946121871471405,-0.0173262320458889,0.26424381136894226,0.16418574750423431,0.1321423053741455,0.026711706072092056,-0.41084954142570496,-0.2857038378715515,-0.08942091464996338,0.08003810048103333,-0.1270626187324524,0.3204836845397949,0.2032700926065445,-0.21451525390148163,-0.2259228527545929,0.2760867178440094,0.2855047285556793,0.2632783055305481,0.14305783808231354,-0.0780239924788475,-0.029982050880789757,-0.08136698603630066,-0.2178734838962555,0.2213604748249054,0.08248507231473923,-0.1862279325723648,0.1419675350189209},{-0.018020011484622955,0.02316848561167717,-0.06652291119098663,-0.24968606233596802,-0.1071259006857872,-0.24461893737316132,-0.22937552630901337,-0.17401480674743652,0.020431311801075935,-0.014310628175735474,-0.26301607489585876,0.024294538423419,-0.24980853497982025,-0.15707293152809143,-0.0003644274256657809,0.0851210281252861,0.27237793803215027,-0.17287258803844452,-0.3549690842628479,0.2726096510887146,-0.1524677276611328,0.26017358899116516,-0.025401471182703972,-0.053946178406476974,0.046177417039871216,0.125946506857872,-0.05406007915735245,-0.28505492210388184,0.23172436654567719,0.2527637481689453,-0.1514205038547516,0.19493871927261353},{-0.28336435556411743,0.0021690628491342068,0.04938296973705292,-0.0034614214673638344,0.02766876481473446,0.08416172116994858,-0.17507055401802063,0.10333346575498581,-0.21984998881816864,-0.223369762301445,0.1456747055053711,-0.116722971200943,-0.1889835149049759,0.2655017077922821,0.012235612608492374,0.010243775323033333,0.2006382942199707,-0.2680390477180481,-0.14567995071411133,0.25427791476249695,0.050239477306604385,0.18449896574020386,-0.005515068769454956,-0.0004381004546303302,-0.2512156367301941,-0.1275566816329956,0.02379009686410427,0.32489416003227234,0.009481321088969707,-0.015935562551021576,0.2746906876564026,0.2978798747062683}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10053623467683792,0.16738593578338623,0.3801283836364746,-0.052166007459163666},{0.05097534880042076,-0.11304587125778198,0.045780811458826065,0.22446730732917786},{-0.11378122121095657,0.13537777960300446,0.12189632654190063,0.11479680240154266},{0.33567163348197937,0.04351481795310974,0.06869669258594513,0.4635576009750366},{-0.06167028844356537,0.0785805732011795,0.32115137577056885,0.00532896164804697},{-0.14736996591091156,0.23752672970294952,0.23197992146015167,-0.05397145077586174},{-0.32245004177093506,-0.014288142323493958,0.061581265181303024,-0.11098431050777435},{-0.35715946555137634,-0.1368040144443512,0.3874083459377289,-0.28808367252349854},{0.30518361926078796,-0.14310099184513092,-0.26979684829711914,-0.3916059732437134},{0.08593446016311646,0.32030558586120605,0.31732144951820374,-0.4074624180793762},{-0.18343877792358398,-0.18396665155887604,-0.10418078303337097,0.13714566826820374},{0.37782466411590576,-0.1611163318157196,-0.04832186922430992,0.20796413719654083},{0.26604071259498596,0.2845912277698517,-0.07235072553157806,0.1303761750459671},{-0.00432714493945241,0.024859797209501266,-0.29730460047721863,0.060061343014240265},{0.09966090321540833,0.264092355966568,0.3639734387397766,0.2773664891719818},{0.15040633082389832,0.004122162703424692,0.2622654438018799,0.2792004644870758},{-0.26433098316192627,-0.10590634495019913,-0.08274390548467636,-0.2648969292640686},{-0.12890878319740295,0.14437973499298096,-0.12203461676836014,-0.10789234191179276},{-0.34571442008018494,0.16050565242767334,0.1691771298646927,0.35992950201034546},{-0.029212066903710365,0.31307968497276306,-0.1693311631679535,0.17215770483016968},{-0.2717893421649933,-0.3662651777267456,-0.11877825111150742,0.0029583473224192858},{0.33822762966156006,0.41231200098991394,0.012501735240221024,-0.29678279161453247},{-0.0032514857593923807,0.1777939796447754,0.2196660339832306,0.18107075989246368},{-0.06291020661592484,0.39937832951545715,-0.07286510616540909,-0.17568963766098022},{-0.0035789059475064278,-0.06583259999752045,-0.09310821443796158,-0.016888506710529327},{0.30678635835647583,-0.36333033442497253,-0.04404273256659508,0.01120789349079132},{-0.03175513818860054,-0.3522989749908447,-0.1777830421924591,-0.2733345329761505},{0.14574433863162994,-0.19070321321487427,0.2224089652299881,0.1377013474702835},{0.019380617886781693,-0.04459263011813164,0.02728481963276863,-0.002877176273614168},{-0.4233146011829376,0.3849881589412689,0.2160041481256485,-0.007192244753241539},{0.3503311574459076,-0.15844979882240295,0.19358912110328674,-0.0438636839389801},{0.1337123066186905,-0.38520899415016174,0.3900251090526581,-0.25205838680267334}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09559910744428635,-0.0337168425321579,0.018314126878976822,0.04507775977253914,-0.0808592364192009,-0.11421221494674683,0.028412053361535072,0.0452423021197319,0.03853408619761467,-0.014998185448348522,-0.06118074432015419,-0.0017812327714636922,0.05978138744831085,0.01672578789293766,-0.08035087585449219,-0.007568801287561655};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02132793888449669,-0.0014185125473886728,0.003540641628205776,0.011655488982796669,0.0004824635689146817,-0.013179859146475792,0.027325687929987907,0.030437959358096123,0.012506872415542603,0.02270711399614811,0.02943144552409649,-0.003737708553671837,0.048989735543727875,-0.03267969191074371,-0.04301716387271881,0.0119205042719841};
static const float actor_encoder_feed_forward_0_bias[32] = {0.0004233077634125948,0.00864461436867714,0.010881592519581318,-0.001605907455086708,0.013747903518378735,0.002356173237785697,0.008304927498102188,0.016201835125684738,-0.03707665205001831,-0.015175440348684788,0.003619700437411666,0.003812844632193446,0.008394339121878147,0.0007145010167732835,-0.0013290834613144398,0.034518156200647354,0.0009398963302373886,-0.02047639712691307,0.02075868472456932,-0.012944342568516731,-0.019558554515242577,-0.007812266703695059,0.04680996760725975,0.013461490161716938,0.006940757855772972,0.023974603042006493,-0.02440125122666359,0.0416351780295372,-0.0055216955952346325,-0.0004915932659059763,0.018046649172902107,0.010480904020369053};
static const float action_parameterization_distribution_linear_bias[4] = {-0.006275057792663574,-0.016501979902386665,-0.0004923127708025277,0.009113443084061146};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.015582938678562641,0.2738220691680908,-0.16171228885650635,0.19348064064979553,0.10513381659984589,0.048735953867435455,0.4419635832309723,-0.09686322510242462},{-0.21680592000484467,-0.03229944407939911,-0.28430837392807007,-0.20472601056098938,-0.3981063663959503,-0.26177316904067993,0.001207282766699791,-0.26101788878440857},{-0.26882925629615784,0.0174164529889822,0.2520378530025482,0.27015411853790283,0.22712774574756622,-0.04856293648481369,0.3762822449207306,-0.17093710601329803},{0.008151337504386902,0.0897604301571846,-0.14997726678848267,0.041418153792619705,-0.005652873311191797,-0.07958128303289413,0.3438454270362854,-0.25211969017982483},{-0.2941305637359619,-0.1296791434288025,-0.20164668560028076,-0.0962672308087349,-0.048593830317258835,0.15819665789604187,0.20837953686714172,-0.07610421627759933},{-0.3415040075778961,-0.03798333555459976,0.4335852861404419,0.27352604269981384,0.1615270972251892,-0.12481852620840073,-0.11831054091453552,-0.16340601444244385},{-0.29568251967430115,0.00032119776005856693,0.48373323678970337,-0.16001518070697784,-0.14613743126392365,-0.4337020218372345,-0.0978512391448021,-0.11701419204473495},{-0.29854655265808105,-0.37142449617385864,0.5815809965133667,-0.044458866119384766,-0.20198749005794525,0.22776661813259125,0.18230153620243073,-0.24057257175445557},{-0.4133194386959076,0.291970431804657,-0.09075620025396347,0.3904697895050049,0.10626455396413803,-0.32003122568130493,0.0028112127911299467,0.1205674484372139},{-0.46110013127326965,-0.3243475556373596,-0.09667608141899109,-0.1972057968378067,-0.5259530544281006,0.13170896470546722,-0.056079715490341187,0.17441263794898987},{0.026607804000377655,0.32433077692985535,0.25333288311958313,-0.011767656542360783,0.2051146775484085,0.15225015580654144,-0.22901298105716705,0.24144938588142395},{0.07765314728021622,0.018404094502329826,0.2649405300617218,0.2458552122116089,-0.302456259727478,0.3177401125431061,-0.02343394234776497,-0.21193955838680267},{0.01471223309636116,-0.33902397751808167,0.25508973002433777,-0.0635925903916359,-0.3587922751903534,-0.06777596473693848,-0.1898079514503479,-0.10917365550994873},{-0.2860410511493683,-0.26882219314575195,0.3191174864768982,0.3391619324684143,-0.24723398685455322,-0.059146638959646225,-0.3120845854282379,0.23566026985645294},{0.007279050536453724,-0.20186898112297058,0.1427234411239624,-0.22701245546340942,-0.27869877219200134,-0.11802622675895691,0.2195042073726654,0.021253755316138268},{0.1342185139656067,-0.07642705738544464,0.04287885129451752,-0.2264048308134079,0.06441519409418106,0.07351440191268921,0.08657068759202957,0.4014360010623932},{-0.08499730378389359,-0.33311107754707336,-0.16371630132198334,0.12918412685394287,-0.21351298689842224,-0.1428399533033371,-0.13352136313915253,0.13107416033744812},{-0.23282477259635925,-0.33658483624458313,0.035340990871191025,0.05099965259432793,0.1128578707575798,-0.19398100674152374,0.3356720507144928,0.1727546900510788},{-0.04433254897594452,0.07877254486083984,-0.2622975707054138,0.126426562666893,0.10501990467309952,0.19324810802936554,-0.24176736176013947,0.3673122227191925},{0.09168536216020584,-0.04563917964696884,-0.368455708026886,0.10406401008367538,-0.061223018914461136,-0.026926711201667786,-0.31484121084213257,0.0009020241559483111},{0.012214252725243568,-0.14986158907413483,0.06646786630153656,-0.08089212328195572,0.3409808278083801,0.055706318467855453,-0.013671980239450932,0.4053064286708832},{-0.04309825599193573,0.09096883237361908,-0.2620639204978943,0.30000802874565125,0.38087698817253113,0.3690582513809204,0.2228681594133377,-0.3178081512451172},{-0.5155453085899353,-0.16487613320350647,0.1586391031742096,-0.06335942447185516,0.23202309012413025,-0.251677542924881,0.27998584508895874,-0.2876264452934265},{-0.29074981808662415,-0.0008098652469925582,-0.08909253031015396,-0.417839914560318,0.2532431185245514,0.04342973604798317,-0.27380770444869995,0.15744929015636444},{-0.35999545454978943,-0.1936926394701004,-0.02202839031815529,0.008122192695736885,-0.05079198256134987,0.1981537789106369,0.3595147132873535,-0.13570855557918549},{-0.33029964566230774,0.05085957422852516,-0.3898864686489105,-0.34397441148757935,0.1831241101026535,0.06560873985290527,-0.037732359021902084,0.06333409249782562},{0.23788927495479584,0.3819379210472107,-0.3023199141025543,0.14984571933746338,0.22879882156848907,0.4107044041156769,-0.24405528604984283,-0.14914466440677643},{0.27229341864585876,0.25268474221229553,0.044685278087854385,0.04769202694296837,0.299662321805954,0.21845005452632904,0.30930864810943604,0.36130034923553467},{-0.24274544417858124,0.3829118311405182,0.1400529444217682,-0.01725764200091362,0.2427884340286255,0.07160087674856186,-0.2862481474876404,-0.30747219920158386},{-0.3274325430393219,-0.20958589017391205,0.06483770906925201,-0.2846854329109192,-0.2923205494880676,-0.1557343751192093,0.40764835476875305,-0.08764968812465668},{0.2556431293487549,-0.23587583005428314,0.3411490321159363,-0.33944910764694214,0.02273796685039997,0.22731205821037292,0.29233160614967346,-0.2927766442298889},{0.07787489891052246,0.40807774662971497,0.40367791056632996,-0.27825024724006653,-0.29248034954071045,0.031598374247550964,0.3118498921394348,0.011560758575797081}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.014492973685264587,0.4571886360645294,-0.170069620013237,0.1846231371164322,-0.4141092598438263,0.3173827826976776,0.3013502061367035,0.09452661126852036},{-0.513222873210907,-0.4132530689239502,-0.3642509877681732,-0.4501264989376068,-0.4612838923931122,0.4896564483642578,0.34446537494659424,-0.3662501871585846},{0.12100541591644287,-0.16856145858764648,0.15342779457569122,0.19278380274772644,-0.02618706226348877,0.4543139934539795,-0.2884739935398102,-0.5006739497184753},{0.43341726064682007,-0.06452236324548721,0.19123069941997528,0.0066044991835951805,0.49195247888565063,0.44370442628860474,0.5593109726905823,0.38400527834892273},{0.10366126894950867,0.196713387966156,-0.1563267856836319,-0.27110356092453003,0.07401387393474579,-0.46177688241004944,-0.548095703125,0.5940091013908386},{0.4517520070075989,0.11165331304073334,-0.013155524618923664,-0.34877821803092957,-0.4782445728778839,-0.49770262837409973,-0.13089299201965332,0.426316499710083},{-0.46946418285369873,-0.3276189863681793,-0.11696283519268036,-0.23377040028572083,-0.021463533863425255,0.5236192345619202,-0.51035076379776,0.5171275734901428},{0.20045387744903564,0.06589698791503906,0.0016468269750475883,0.06558334827423096,0.3858852982521057,-0.497037798166275,0.3687784671783447,-0.3778887689113617}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.08815477788448334,0.01709756627678871,0.045236289501190186,-0.018828870728611946,-0.040558092296123505,0.020969055593013763,0.006602716166526079,-0.004773070104420185};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.020694861188530922,-0.0001124518530559726,-0.04682913050055504,0.056998249143362045,-0.016245536506175995,-0.006799881346523762,0.04724453017115593,-0.07337447255849838};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

