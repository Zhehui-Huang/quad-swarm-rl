#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.34972015023231506,-0.11134626716375351,0.2902081608772278,0.1142432689666748,-0.28582578897476196,0.29086920619010925,0.005265823099762201,-0.11164885014295578,0.10213729739189148,0.3197896182537079,0.08881162106990814,0.011582250706851482,0.21411246061325073,-0.22046388685703278,0.25616753101348877,-0.030097076669335365},{-0.2084130495786667,-0.40078380703926086,0.2777184247970581,0.06542462110519409,-0.20746907591819763,0.1570713222026825,-0.42995479702949524,-0.042154375463724136,-0.10878504812717438,-0.2136882245540619,0.012927590869367123,-0.18570229411125183,-0.018553053960204124,-0.32343989610671997,-0.28321683406829834,0.11694418638944626},{-0.1634330004453659,-0.2719326913356781,-0.47769537568092346,0.20727738738059998,0.2849021255970001,0.6367648839950562,0.022323191165924072,-0.02452482096850872,0.17029425501823425,-0.5795714259147644,-0.43464240431785583,0.8560794591903687,-0.2761775851249695,-0.33195993304252625,-0.44836127758026123,0.34092849493026733},{0.18566815555095673,0.2464642971754074,0.38002023100852966,-0.03177207335829735,-0.3890061378479004,-0.026806265115737915,0.2697184681892395,0.08287066966295242,0.32038643956184387,-0.30285361409187317,0.0069518848322331905,0.4080156981945038,-0.23006369173526764,-0.015081847086548805,0.4756315052509308,-0.4683555066585541},{-0.09122051298618317,0.041743893176317215,0.3098052740097046,-0.06558511406183243,0.30064448714256287,0.42998170852661133,0.164901465177536,-0.04225170239806175,0.11903784424066544,0.20085489749908447,0.2919820547103882,-0.3328517973423004,-0.16581211984157562,-0.44083672761917114,0.3512987494468689,0.10265685617923737},{-0.2858744263648987,-0.18093784153461456,-0.2192244529724121,-0.0283778328448534,0.20611350238323212,0.24453169107437134,0.008688921108841896,-0.08940840512514114,0.3334769308567047,-0.3070986568927765,-0.44867008924484253,0.23865020275115967,0.07911890745162964,-0.1700836569070816,0.00035112936166115105,0.11032427847385406},{0.05654623359441757,0.12711313366889954,0.04795815423130989,-0.41662317514419556,0.13244083523750305,-0.033945634961128235,0.03327399864792824,0.3518271744251251,0.3181978166103363,0.06672689318656921,-0.4054374396800995,-0.03849805146455765,-0.0007590337190777063,0.18016110360622406,-0.23407883942127228,-0.23243296146392822},{-0.28109633922576904,0.4627278447151184,0.4200989902019501,0.3673173487186432,-0.4671938717365265,-0.05282201990485191,0.5912409424781799,0.523128867149353,-0.2557268738746643,0.2854492664337158,-0.7360143661499023,-0.4336046874523163,0.46001124382019043,0.04405966401100159,0.23505941033363342,0.45529597997665405},{0.40756502747535706,-0.30632317066192627,0.6306222677230835,0.09741739928722382,0.010474554263055325,0.06270208209753036,0.1378488391637802,-0.6902247071266174,-0.2504570782184601,-0.3834254741668701,-0.1497022658586502,0.010613084770739079,-0.06955652683973312,0.7512055039405823,0.48529496788978577,-0.3403727412223816},{0.18011300265789032,-0.6185771226882935,-0.6608244776725769,-0.38245251774787903,-0.22737529873847961,0.2506280541419983,0.14497199654579163,0.11095888912677765,0.6398773789405823,0.29005661606788635,0.2238493710756302,-0.2688901722431183,-0.13933727145195007,0.46496158838272095,-0.21471473574638367,-0.5987237691879272},{0.20512737333774567,0.4221598207950592,0.4156757593154907,-0.5684986114501953,-0.3745289742946625,0.1294642686843872,0.18516471982002258,0.4504217207431793,-0.40125909447669983,0.046426329761743546,-0.05420567840337753,-0.03980559483170509,-0.13169251382350922,-0.18037909269332886,0.27380985021591187,-0.4187517762184143},{-0.07225232571363449,-0.45345836877822876,0.18647485971450806,0.6866055727005005,0.8735532164573669,0.45712801814079285,0.4537491202354431,0.45576098561286926,0.024805866181850433,-0.03155979514122009,0.2503473460674286,-0.45786920189857483,-0.6642281413078308,-0.4206123948097229,0.8194006085395813,-0.031916771084070206},{-0.21930745244026184,0.36975112557411194,-0.07158041000366211,-0.6166170835494995,0.14973482489585876,0.09799424558877945,0.1809871941804886,0.17771944403648376,0.07061859965324402,0.006247945129871368,0.05895092338323593,0.1894327998161316,0.35751792788505554,0.32734549045562744,-0.110468789935112,-0.11344100534915924},{0.030000094324350357,-0.39585188031196594,-0.2646864354610443,-0.2045239508152008,-0.4528887867927551,0.04647969827055931,-0.33181291818618774,-0.3391048312187195,-0.2546567916870117,-0.02580854296684265,-0.41863250732421875,-0.02167477086186409,-0.18871402740478516,0.41050466895103455,0.11175265908241272,-0.007248407695442438},{0.05241980403661728,-0.27782103419303894,-0.23200108110904694,0.19674213230609894,-0.1400548815727234,-0.44475698471069336,0.28807419538497925,-0.07688207924365997,-0.019568942487239838,0.37297913432121277,0.07554991543292999,0.027735635638237,0.28546401858329773,-0.01139891054481268,-0.22670072317123413,0.21941162645816803},{0.3530673682689667,0.0034680699463933706,-0.2373984009027481,-0.14894834160804749,-0.27642348408699036,0.14978265762329102,0.33390921354293823,-0.08601310104131699,0.15305690467357635,0.32359951734542847,-0.14115333557128906,0.05834116414189339,-0.17934741079807281,0.2173963338136673,-0.06923803687095642,-0.0034297730308026075},{-0.2398729771375656,-0.2093716263771057,0.2415689080953598,0.1110861673951149,-0.2368575632572174,0.05459270998835564,-0.1850704550743103,-0.10011057555675507,-0.19304345548152924,-0.2698204815387726,-0.036645662039518356,-0.2846144139766693,0.07443464547395706,-0.19291332364082336,0.07576756924390793,-0.20547246932983398},{-0.23205414414405823,0.2479390650987625,-0.3166293203830719,-0.16666196286678314,0.04840662702918053,0.3062790632247925,-0.1861068308353424,-0.20468547940254211,0.11736023426055908,0.11748617887496948,0.3357301652431488,-0.11578954756259918,-0.28985607624053955,0.29766035079956055,0.005572834517806768,-0.39794090390205383}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.022989880293607712,-0.061815761029720306,-0.1020374745130539,-0.33814024925231934,0.30979061126708984,0.2905503809452057,0.07345554977655411,0.04786691814661026,-0.06717920303344727,-0.18521316349506378,0.0036089960485696793,0.07085356116294861,0.20166511833667755,0.2817822992801666,0.15207797288894653,0.04098103195428848},{-0.13770347833633423,-0.3013707995414734,-0.055972274392843246,0.03831762447953224,0.24324166774749756,-0.2810746431350708,0.025387011468410492,0.04715888947248459,-0.05120387300848961,0.2709064781665802,-0.21961399912834167,0.3268659710884094,-0.37666812539100647,0.15853290259838104,-0.22502462565898895,-0.3420434296131134},{0.026823336258530617,0.21122592687606812,-0.3878271281719208,-0.5179111361503601,0.20450687408447266,0.43755435943603516,-0.08634478598833084,0.06200901046395302,-0.26811110973358154,-0.2383655160665512,-0.012316095642745495,0.32866477966308594,-0.2859840393066406,-0.11936076730489731,0.11399166285991669,-0.092325858771801},{0.1359206587076187,-0.06933830678462982,0.09255744516849518,0.16968616843223572,-0.4364416301250458,0.003146299161016941,0.05999186635017395,-0.19897159934043884,0.27709540724754333,0.3588857352733612,-0.17480015754699707,-0.14854225516319275,-0.42796650528907776,-0.31988760828971863,0.18973693251609802,0.12743666768074036},{-0.02483724057674408,0.15000119805335999,0.011369924061000347,0.2778722047805786,-0.23193123936653137,0.09799747914075851,-0.010716436430811882,0.17129477858543396,0.2437288910150528,-0.20964883267879486,0.19222086668014526,0.24202735722064972,0.18469859659671783,-0.4308975338935852,0.02215609885752201,0.0472988560795784},{0.19331398606300354,0.2592402994632721,-0.0035633419174700975,0.18884749710559845,-0.49371397495269775,-0.4428415298461914,0.26629987359046936,0.32599735260009766,0.06026255339384079,0.3680460453033447,0.22418220341205597,-0.2551341652870178,-0.0023210574872791767,-0.16760887205600739,-0.11058866232633591,0.2797960937023163},{-0.10976385325193405,0.25793230533599854,0.28544071316719055,-0.37228524684906006,-0.25003117322921753,0.007265372201800346,-0.3529065251350403,-0.03865265101194382,0.1862754076719284,0.061592984944581985,-0.12770500779151917,-0.20499856770038605,-0.31493332982063293,-0.10943697392940521,0.1878800392150879,0.016657071188092232},{-0.09958668798208237,-0.12791144847869873,-0.4712957739830017,0.2888926863670349,-0.2964370548725128,-0.24805095791816711,-0.23692665994167328,-0.3712853193283081,0.13881641626358032,-0.19228355586528778,0.05300910398364067,0.052917271852493286,-0.14515483379364014,0.41863173246383667,-0.006318375468254089,-0.2925472557544708},{-0.2996370792388916,0.2449418157339096,-0.011795220896601677,-0.05936196818947792,0.27663716673851013,-0.27533286809921265,0.2856879234313965,0.13575494289398193,0.3382120430469513,0.32080787420272827,0.25414571166038513,0.31054210662841797,0.18338020145893097,-0.11492188274860382,0.23259319365024567,0.09251871705055237},{0.09238513559103012,-0.2753359079360962,-0.12802653014659882,-0.12576691806316376,0.23483309149742126,-0.15648634731769562,-0.28681597113609314,-0.14833953976631165,0.0495031513273716,-0.36797043681144714,-0.2516906261444092,0.3094037175178528,0.11472998559474945,0.06943918019533157,-0.2784286439418793,0.22484540939331055},{-0.02543339878320694,-0.4416753947734833,0.2793031632900238,0.27102717757225037,0.26889684796333313,0.15776456892490387,0.14010201394557953,-0.13594487309455872,0.23174554109573364,-0.1985672563314438,0.16521750390529633,0.3401341140270233,0.46775272488594055,0.10380521416664124,-0.015162495896220207,0.030788002535700798},{0.049949727952480316,-0.008897442370653152,0.3929864466190338,-0.014651179313659668,-0.25095662474632263,-0.19215132296085358,0.4228813648223877,0.3028879165649414,-0.23531977832317352,-0.1860886663198471,-0.04576118662953377,-0.3507293462753296,-0.0024466682225465775,-0.2999526560306549,-0.2837260365486145,0.08533550053834915},{-0.1686481535434723,-0.3166895806789398,0.416015088558197,-0.23129776120185852,0.38109874725341797,-0.30996882915496826,-0.46738365292549133,0.0608617439866066,0.10254573076963425,0.05786437541246414,-0.31009069085121155,0.11238328367471695,0.10623011738061905,-0.2556859850883484,-0.18633675575256348,-0.00704106455668807},{0.37874835729599,-0.3399724066257477,0.45595476031303406,0.08713046461343765,-0.0987817570567131,0.3393484354019165,-0.11026452481746674,-0.22483845055103302,-0.393228679895401,0.08169382065534592,0.025414366275072098,-0.34820377826690674,-0.11558806896209717,0.07880781590938568,0.2901933789253235,0.048819541931152344},{-0.09531763195991516,0.18635623157024384,0.13043111562728882,-0.4847159683704376,-0.17719587683677673,0.20580390095710754,0.23458151519298553,-0.2559998333454132,0.24209877848625183,-0.26011061668395996,0.07809194922447205,0.11209435015916824,-0.02885892055928707,0.19636306166648865,0.056203972548246384,0.0658997967839241},{-0.13109925389289856,0.3931410312652588,-0.4489128291606903,0.39811956882476807,0.09316117316484451,-0.37616923451423645,-0.01719692349433899,-0.08053916692733765,-0.31769412755966187,0.3659801185131073,-0.29157504439353943,0.2561359703540802,-0.10456878691911697,-0.28060421347618103,-0.08976341038942337,-0.4632481038570404}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12146687507629395,0.10136651992797852,0.01196080818772316,-0.046821512281894684,-0.09144173562526703,0.00028296493110246956,0.26082682609558105,0.08307614177465439,-0.16240982711315155,-0.18341858685016632,0.1082674190402031,-0.2481871396303177,-0.17680047452449799,0.23884126543998718,0.21384257078170776,0.3146809935569763,-0.25977709889411926,-0.2746213972568512,-0.18084819614887238,0.1396491378545761,-0.04532865062355995,-0.35755985975265503,-0.266482949256897,-0.2694239318370819,-0.22101280093193054,0.11370165646076202,-0.2219661921262741,-0.06958726048469543,-0.08792495727539062,0.0009440098656341434,0.2137717455625534,-0.20873987674713135},{0.29886341094970703,0.14716367423534393,0.18435372412204742,-0.07284941524267197,0.1290515661239624,-0.1562373787164688,0.34215351939201355,0.15295499563217163,-0.11791811883449554,-0.07013265043497086,-0.12498556822538376,-0.24333150684833527,-0.19360001385211945,0.23538823425769806,-0.26216715574264526,-0.1979271024465561,-0.05196087062358856,0.17650464177131653,-0.3492640554904938,-0.21233217418193817,-0.017530931159853935,0.20066434144973755,0.016959598287940025,0.030871689319610596,0.22153447568416595,-0.3345698118209839,-0.05778590962290764,0.05807124823331833,0.15700680017471313,-0.09603805094957352,-0.07521151751279831,0.21223832666873932},{0.1703537106513977,0.050158992409706116,-0.13043880462646484,0.1423981785774231,-0.15092994272708893,-0.14028353989124298,-0.21481984853744507,0.05829320475459099,-0.1739966720342636,0.33549901843070984,-0.31550875306129456,-0.2709273397922516,0.1815532147884369,-0.40548646450042725,-0.1402188539505005,0.09606993943452835,-0.0810200423002243,-0.11379173398017883,0.19173642992973328,-0.10086965560913086,0.23497311770915985,0.2793290317058563,-0.2179805338382721,0.023735065013170242,-0.2640770673751831,-0.024197334423661232,0.1448061615228653,-0.06397451460361481,0.02384314313530922,-0.20395830273628235,-0.10235348343849182,-0.0769139751791954},{0.3875885009765625,0.057222094386816025,0.12901170551776886,-0.18096071481704712,-0.24806758761405945,-0.04190514236688614,-0.12823010981082916,0.27009475231170654,0.22678790986537933,-0.29494836926460266,-0.06021934375166893,0.2528141140937805,0.11938973516225815,-0.009534520097076893,-0.24275146424770355,0.2929956912994385,-0.29367130994796753,0.2614661157131195,-0.0045979218557477,0.10558993369340897,-0.09916740655899048,-0.08605380356311798,0.2902056872844696,0.15594373643398285,0.1566556841135025,-0.35179823637008667,0.2611618638038635,-0.20481789112091064,-0.03324790298938751,0.05113836005330086,-0.21155673265457153,0.14053885638713837},{-0.06548184156417847,-0.05042524263262749,-0.11321301013231277,0.11677724868059158,0.2085600197315216,-0.13748815655708313,-0.41095006465911865,-0.07570343464612961,-0.10444463044404984,-0.3132198750972748,0.15255141258239746,0.24251630902290344,-0.05475285276770592,-0.11817969381809235,-0.09895104914903641,0.12667693197727203,-0.018705708906054497,-0.03383219614624977,-0.29743823409080505,-0.20000162720680237,-0.17903733253479004,-0.34496477246284485,0.1394815742969513,0.1346433013677597,-0.10467168688774109,0.34526386857032776,-0.17979386448860168,0.22221828997135162,0.26477402448654175,0.37924724817276,-0.015001576393842697,0.37410634756088257},{-0.27327489852905273,0.03368622437119484,-0.23363888263702393,-0.055984947830438614,-0.20174339413642883,0.23914015293121338,0.20816664397716522,0.021050607785582542,0.25303611159324646,0.21042008697986603,0.33122387528419495,-0.22733458876609802,-0.27550452947616577,0.1974431574344635,0.33829227089881897,-0.33184218406677246,-0.11183106899261475,-0.2438002973794937,0.23994982242584229,0.11041604727506638,0.0837320014834404,0.19265034794807434,0.06379178911447525,-0.07981513440608978,-0.33347025513648987,0.33721157908439636,-0.13374122977256775,0.2196931093931198,0.28744304180145264,0.17912212014198303,0.07350283861160278,0.01111290417611599},{0.19443188607692719,-0.13031499087810516,-0.1264059990644455,-0.28216660022735596,-0.03905250504612923,0.24288210272789001,0.2798246741294861,0.18813127279281616,0.07956306636333466,0.3394101858139038,0.001258003176189959,-0.011594658717513084,-0.4879317581653595,-0.17474502325057983,-0.1467703878879547,0.1621468961238861,-0.2505229711532593,-0.21376197040081024,0.2313580960035324,-0.0845797061920166,-0.13235625624656677,-0.1450735330581665,-0.22944214940071106,-0.21468456089496613,0.1313619613647461,-0.2100425660610199,-0.0722983255982399,-0.19203291833400726,0.2957504391670227,0.14467467367649078,-0.15067492425441742,-0.2890075147151947},{0.005463610403239727,0.17410847544670105,0.057261258363723755,0.01104293018579483,0.12774451076984406,-0.3014269769191742,-0.1504887491464615,-0.14411146938800812,-0.03623293712735176,-0.2437525987625122,-0.2870885729789734,-0.020506707951426506,-0.16105012595653534,-0.03685174509882927,-0.1125861257314682,0.384918212890625,-0.004997335374355316,-0.1496468186378479,0.14506101608276367,0.3347724378108978,-0.10758782178163528,-0.22963203489780426,0.2626539468765259,0.0907350480556488,-0.056798700243234634,-0.28208088874816895,-0.287457674741745,-0.29854512214660645,-0.3260238766670227,-0.22884602844715118,0.053786344826221466,-0.29168248176574707},{0.07907462865114212,0.28797635436058044,-0.2591726779937744,-0.3130249083042145,-0.1968996524810791,0.047193609178066254,0.07242327928543091,0.043018899857997894,0.17256981134414673,-0.2694242596626282,-0.25014448165893555,0.3185517489910126,-0.2451096475124359,-0.18042930960655212,0.17708992958068848,-0.2848523259162903,0.2669546902179718,0.15244533121585846,0.30631718039512634,0.03785424306988716,0.22473011910915375,0.027699695900082588,0.25264620780944824,-0.07631362974643707,0.3609622120857239,-0.2025918960571289,0.0929902121424675,0.3102850019931793,-0.2692679762840271,0.2172270119190216,-0.03517736494541168,0.1512797474861145},{-0.18657483160495758,0.12498562037944794,-0.22265318036079407,-0.1493426114320755,0.1969269961118698,-0.12751616537570953,0.06339983642101288,-0.005673337262123823,0.15003424882888794,-0.057551294565200806,-0.2508756220340729,-0.2755029499530792,-0.3023454546928406,-0.05915044620633125,-0.24355852603912354,0.09429223835468292,0.08458881825208664,-0.20532359182834625,0.282246470451355,0.07559861242771149,-0.004869652912020683,-0.015442637726664543,0.27531787753105164,-0.2074398547410965,0.2984811067581177,0.12170690298080444,-0.2592715620994568,0.024359257891774178,-0.0016605277778580785,0.14865699410438538,-0.11364635825157166,0.1127995029091835},{0.0755053162574768,0.006223894655704498,0.2114485204219818,-0.25480878353118896,-0.2747872769832611,-0.25748032331466675,-0.26540055871009827,-0.005790869239717722,-0.1960328221321106,0.4208695888519287,0.12048142403364182,-0.25633782148361206,-0.39609721302986145,-0.024089723825454712,-0.23832330107688904,-0.08792150020599365,0.22600454092025757,-0.1392073780298233,0.25107327103614807,-0.13647913932800293,-0.1932986080646515,-0.007401204667985439,0.1424042135477066,0.24435818195343018,0.157723069190979,-0.10280158370733261,-0.02143927291035652,-0.10174616426229477,-0.08201263844966888,0.026060350239276886,-0.05177333950996399,0.12204746156930923},{-0.17272375524044037,-0.12021221220493317,0.20952507853507996,0.3036537766456604,0.24655023217201233,-0.0652836263179779,0.06282248347997665,-0.2255704551935196,-0.011330586858093739,-0.24622376263141632,0.26434963941574097,-0.22462494671344757,-0.22796133160591125,-0.20709294080734253,0.23996563255786896,-0.009700869210064411,-0.02689245156943798,-0.00021054617536719888,0.3512728214263916,0.04333276301622391,-0.16498111188411713,0.2091173678636551,0.10311981290578842,-0.06993319094181061,0.22408244013786316,-0.09036681801080704,-0.1828913688659668,0.20446939766407013,0.10597678273916245,0.008463790640234947,-0.31219032406806946,-0.22705034911632538},{0.2871638536453247,-0.2510874271392822,0.009642010554671288,-0.3184340000152588,0.011406594887375832,-0.1540287882089615,0.12193096429109573,0.1572338044643402,0.22984354197978973,0.044796038419008255,0.17597845196723938,0.24653832614421844,-0.42984437942504883,-0.3400017023086548,-0.04680994898080826,-0.20568880438804626,-0.2335396260023117,-0.27985110878944397,0.3105195164680481,-0.1649431735277176,0.3208926022052765,-0.09008976072072983,-0.011150214821100235,0.1986193060874939,0.11395416408777237,-0.09724055230617523,0.10849564522504807,0.05110733211040497,0.04083673655986786,-0.019734635949134827,-0.2692958116531372,-0.014312629587948322},{0.2680811882019043,-0.03855254128575325,-0.011326414532959461,0.3300280272960663,-0.09722833335399628,-0.16255448758602142,-0.010962532833218575,0.1860780566930771,0.18691816926002502,0.23971626162528992,0.11729171127080917,-0.13883808255195618,0.06202354654669762,0.2111264020204544,-0.12623760104179382,0.13826501369476318,0.2294808328151703,-0.2182316780090332,0.11608948558568954,-0.3290790915489197,0.23449471592903137,0.16100771725177765,-0.08201169222593307,0.20366623997688293,0.26191017031669617,0.05552350729703903,0.16139262914657593,0.0917012020945549,0.07017918676137924,-0.14141890406608582,0.03641337528824806,0.3385656476020813},{0.08305583149194717,-0.19784069061279297,-0.0041189915500581264,0.09933190792798996,-0.27777907252311707,-0.02222302369773388,0.051989633589982986,-0.20362553000450134,-0.15673641860485077,-0.01812521554529667,0.16199259459972382,0.21460837125778198,0.09318916499614716,0.23675745725631714,-0.028531305491924286,-0.025687851011753082,-0.2393662929534912,0.24517495930194855,-0.0712684914469719,-0.18831172585487366,-0.19937458634376526,-0.11786306649446487,0.151292085647583,0.054350025951862335,0.010214944370090961,-0.15864171087741852,-0.16181038320064545,0.19846710562705994,0.04185238853096962,-0.15905438363552094,0.2433599829673767,0.16105248034000397},{0.16557805240154266,-0.23313939571380615,0.02493658848106861,-0.18247264623641968,0.01835503615438938,0.1535806804895401,0.05981720983982086,0.260581910610199,-0.07827724516391754,-0.035133711993694305,0.20117002725601196,0.13061891496181488,0.04843040183186531,-0.10491602122783661,-0.013811925426125526,0.20502685010433197,-0.3284313678741455,-0.17486190795898438,-0.0312100388109684,0.08574064075946808,0.041099097579717636,0.23392504453659058,0.14198383688926697,0.1929827779531479,0.0521133616566658,0.18491968512535095,-0.030023032799363136,-0.061839111149311066,0.06605261564254761,-0.09534402191638947,-0.2515951991081238,0.31310129165649414},{0.17401432991027832,-0.01986539550125599,-0.3105812668800354,0.1219887062907219,0.06822827458381653,-0.060701195150613785,0.32307499647140503,0.10459165275096893,0.13403698801994324,-0.12697312235832214,0.18129181861877441,-0.22432145476341248,-0.3478218615055084,0.24238570034503937,0.06767595559358597,0.035755060613155365,-0.019173644483089447,-0.10743264108896255,-0.15873971581459045,0.07321667671203613,-0.027813449501991272,0.182538703083992,0.06958749890327454,-0.15146248042583466,-0.06970379501581192,-0.23728598654270172,0.03512471914291382,0.2958568334579468,0.19671404361724854,-0.15887348353862762,0.16971109807491302,0.18253567814826965},{-0.0911283865571022,0.0055773817002773285,-0.09116820991039276,-0.06277149170637131,-0.23985613882541656,-0.03202248737215996,0.21150489151477814,0.15851490199565887,0.123408742249012,0.030500641092658043,0.18133723735809326,0.0005016445065848529,0.25103747844696045,0.18897363543510437,0.19801799952983856,-0.12786227464675903,0.11122149229049683,0.17936882376670837,0.20142748951911926,0.04093699902296066,0.2157052457332611,0.26327574253082275,0.08430837839841843,0.15883341431617737,-0.04660813882946968,-0.057603541761636734,-0.13183066248893738,-0.2635323405265808,0.14828647673130035,-0.2803100645542145,0.015023180283606052,-0.048818398267030716},{-0.3114333748817444,0.0495167151093483,-0.3097493648529053,-0.3315410614013672,0.02396794594824314,-0.0017004588153213263,0.11346372216939926,-0.14596688747406006,0.045240990817546844,0.3421860933303833,0.018325909972190857,-0.185062974691391,0.07799755781888962,-0.19993023574352264,-0.2989339232444763,0.018214048817753792,-0.16872470080852509,0.10816138982772827,-0.04149720072746277,0.027629634365439415,-0.28188222646713257,0.13960815966129303,0.09050392359495163,0.04265758767724037,-0.0637374147772789,0.31539642810821533,0.05234457924962044,-0.20153014361858368,-0.17037828266620636,0.044325411319732666,-0.19607244431972504,-0.2522318363189697},{-0.006009555887430906,-0.26323214173316956,-0.2691766917705536,-0.051298417150974274,-0.3232641816139221,-0.14707285165786743,0.17951735854148865,-0.2707633674144745,-0.20782755315303802,0.1636585146188736,0.20813050866127014,0.09020102769136429,0.12031096965074539,-0.15273134410381317,0.26489073038101196,-0.2694372236728668,0.0932324156165123,0.2587268650531769,0.055331435054540634,0.2720109224319458,0.0006064522312954068,-0.11268402636051178,-0.27415943145751953,0.22043907642364502,-0.11663339287042618,-0.15033461153507233,0.11761114746332169,0.043910082429647446,-0.12818311154842377,-0.31550684571266174,-0.025249384343624115,-0.1888984739780426},{0.23078759014606476,0.14764001965522766,-0.05403675511479378,0.20227254927158356,-0.2443954199552536,0.14427542686462402,-0.09390059113502502,-0.16602995991706848,-0.13625194132328033,0.17941352725028992,-0.29575538635253906,-0.13583718240261078,-0.022267011925578117,-0.2032604068517685,-0.37637293338775635,-0.14733915030956268,-0.08188623189926147,-0.29903295636177063,-0.2239803820848465,0.20986129343509674,0.11059322953224182,0.1280660182237625,-0.3769122362136841,0.29875582456588745,0.1505853831768036,0.30117133259773254,-0.272699773311615,-0.056781474500894547,0.06028176471590996,-0.19630619883537292,0.15583646297454834,0.1476694941520691},{-0.052580639719963074,-0.305220365524292,-0.040203940123319626,-0.30246907472610474,-0.0778873935341835,0.2849537134170532,0.19853274524211884,0.038888294249773026,-0.08747241646051407,0.010602203197777271,-0.14474743604660034,0.10376257449388504,0.0994141548871994,0.049072857946157455,0.10927601903676987,0.03278512507677078,-0.0949130654335022,0.13218684494495392,-0.11005106568336487,0.1455961912870407,0.19128915667533875,0.250830739736557,-0.019290106371045113,-0.25200754404067993,0.16375122964382172,0.16462884843349457,0.28359320759773254,0.15759755671024323,0.012404952198266983,0.11728020012378693,0.012798475101590157,-0.09591550379991531},{-0.015291601419448853,-0.20904922485351562,0.22335468232631683,0.07462728768587112,0.26725637912750244,-0.03401720151305199,-0.14333638548851013,-0.19835926592350006,0.14802074432373047,-0.04343150556087494,0.0793575718998909,0.010909043252468109,-0.33590176701545715,0.05179418995976448,-0.09707324951887131,-0.256788432598114,-0.05096195265650749,-0.06827763468027115,0.1934584081172943,0.19900883734226227,0.02888588421046734,0.041947126388549805,0.16769027709960938,0.29608771204948425,-0.18116292357444763,-0.04742417857050896,0.16495808959007263,-0.07224983721971512,-0.13648782670497894,-0.24998556077480316,0.2927703857421875,0.025446202605962753},{0.19135619699954987,-0.10013950616121292,0.05299941822886467,0.10366585850715637,-0.011998601257801056,0.03773864731192589,-0.2258516103029251,0.2927285134792328,-0.09456806629896164,-0.026430930942296982,0.09736182540655136,-0.311381459236145,0.11418700963258743,-0.04447481408715248,-0.12689949572086334,0.30833700299263,-0.08158303052186966,-0.170937180519104,0.0030506057664752007,0.01860746741294861,-0.17093190550804138,0.15955111384391785,0.2067309319972992,0.2628018260002136,-0.26481470465660095,0.12034659087657928,-0.09321396797895432,0.0518394373357296,-0.26095864176750183,0.24629709124565125,-0.06659918278455734,0.030872821807861328}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.17784322798252106,-0.10821808874607086,0.03560802340507507,-0.10343438386917114},{0.1965302675962448,-0.23971900343894958,0.265044629573822,0.2237168401479721},{-0.19157527387142181,0.029224758967757225,0.0523560494184494,-0.033142827451229095},{0.26784273982048035,0.373441606760025,0.2892007529735565,0.03573174774646759},{-0.2425764948129654,0.14184647798538208,-0.24504469335079193,0.1022651195526123},{0.01796753890812397,-0.06723026931285858,0.0693594291806221,0.21631336212158203},{-0.10127386450767517,-0.15083840489387512,-0.30616965889930725,-0.06412482261657715},{-0.08877134323120117,-0.30186378955841064,0.11425817012786865,-0.059857819229364395},{-0.0818476751446724,0.14271223545074463,-0.0877583920955658,-0.07410619407892227},{0.18241681158542633,-0.03129231184720993,-0.059505775570869446,-0.13717594742774963},{0.20163510739803314,-0.1770835518836975,0.2693761885166168,0.1919011026620865},{-0.015061775222420692,0.003732719225808978,0.3049020767211914,-0.0696728378534317},{-0.2785404622554779,0.22200612723827362,-0.044563256204128265,-0.07055939733982086},{-0.13505838811397552,0.017868736758828163,-0.19907298684120178,0.019816512241959572},{0.1802700310945511,-0.01564886048436165,0.19755864143371582,0.05421746149659157},{-0.11187591403722763,-0.2567547857761383,-0.10610944777727127,-0.06870542466640472},{-0.22000710666179657,0.050638597458601,-0.07021024078130722,0.24353697896003723},{-0.2245677262544632,-0.11497995257377625,-0.21494396030902863,0.15330784022808075},{-0.06030270457267761,-0.07645832002162933,0.29989683628082275,0.07275085151195526},{-0.12610682845115662,-0.15183664858341217,-0.005840678233653307,-0.1450280100107193},{0.1324613094329834,0.09973642230033875,0.10272566229104996,-0.12286432087421417},{-0.007542658597230911,-0.21587610244750977,-0.1086069643497467,0.19633077085018158},{0.2629142105579376,-0.10693922638893127,0.13380567729473114,0.006523731630295515},{-0.23115099966526031,-0.09758906811475754,-0.25632551312446594,-0.14673984050750732},{-0.21132464706897736,-0.1536630541086197,-0.018009042367339134,-0.12136995792388916},{0.13281840085983276,0.1352400928735733,-0.03473711386322975,0.13710139691829681},{0.1691311001777649,-0.18262477219104767,0.20114311575889587,0.06385653465986252},{-0.04783898591995239,-0.1371452957391739,0.004882564768195152,0.26446208357810974},{0.019144466146826744,0.006613351870328188,0.017794564366340637,0.00905023142695427},{-0.11540313065052032,0.10220465809106827,0.1747717708349228,0.015007885172963142},{-0.12012459337711334,-0.1194850504398346,0.08103542774915695,0.15100990235805511},{0.16149137914180756,0.1803978532552719,0.1721717119216919,-0.012267819605767727}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.06162763759493828,0.001142258639447391,-0.00025557191111147404,0.04782586172223091,0.049752313643693924,-0.0368206687271595,0.009486199356615543,0.053765978664159775,-0.06567224860191345,-0.08835558593273163,-0.02593889646232128,0.07116387039422989,-0.033325910568237305,0.03755844384431839,-0.026390863582491875,-0.016644535586237907};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.004358805250376463,-0.0004970690351910889,-0.01119486428797245,-0.015157321467995644,-0.0557689443230629,0.015977997332811356,-0.02296285703778267,-0.004456316586583853,0.017813406884670258,-0.04742010682821274,-0.009405030868947506,-0.017451634630560875,-0.008721697144210339,-0.021174920722842216,-0.015581963583827019,-0.04633227363228798};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.002881539985537529,0.060097236186265945,-0.024043256416916847,0.017441529780626297,-0.013825178146362305,0.03630945459008217,-0.041986409574747086,-0.021646497771143913,-0.03209857642650604,-0.018324589356780052,-0.014785351231694221,0.032402150332927704,0.016514258459210396,0.013795905746519566,0.06310585886240005,-0.051749154925346375,0.022804023697972298,-0.005173081532120705,0.016335736960172653,-0.032921161502599716,0.0011223884066566825,0.024248206987977028,-0.010781045071780682,-0.0425577387213707,-0.05429641157388687,0.013391668908298016,0.022488858550786972,0.0318116657435894,0.00704627949744463,0.021028591319918633,0.027514128014445305,0.003143926151096821};
static const float action_parameterization_distribution_linear_bias[4] = {0.00811075884848833,0.023725265637040138,0.014855674467980862,0.04189896956086159};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4409392178058624,-0.36693522334098816,-0.12365425378084183,0.24735334515571594,-0.15588639676570892,0.1003711000084877,-0.2874481678009033,0.07027588784694672},{0.21129703521728516,0.11694546788930893,0.40620625019073486,0.38337835669517517,-0.09885107725858688,-0.3392530083656311,0.330191433429718,0.3983725309371948},{0.0668741762638092,0.1855604499578476,0.11229616403579712,-0.055122341960668564,0.3364715874195099,0.2200605869293213,-0.0032885971013456583,0.2309170812368393},{0.11974949389696121,-0.3640190064907074,0.34745001792907715,-0.15263336896896362,-0.22129736840724945,0.09666144847869873,0.3462347388267517,0.25345951318740845},{-0.2330990731716156,-0.0798536092042923,-0.029896264895796776,-0.2647232413291931,0.1489337682723999,0.11628928035497665,0.381721556186676,0.2771553099155426},{-0.039267636835575104,0.18450187146663666,0.0076771932654082775,-0.19218771159648895,0.34229812026023865,0.11150766164064407,0.14162443578243256,-0.17182143032550812},{0.01415260136127472,0.14518040418624878,0.15353669226169586,-0.14197938144207,0.4338480830192566,-0.11256089806556702,0.17706626653671265,0.08415506035089493},{0.05399588122963905,-0.471435546875,-0.01570333167910576,-0.21673105657100677,0.29927852749824524,0.05150057002902031,-0.139647975564003,-0.34818053245544434},{-0.2556416094303131,0.1599516123533249,0.028485171496868134,-0.06187877058982849,0.04862594231963158,0.4780936539173126,0.41772711277008057,0.2812599539756775},{1.9210097889299504e-05,-0.16291771829128265,-0.258417010307312,0.2830696105957031,0.31353697180747986,0.33330726623535156,0.37857216596603394,-0.33477550745010376},{-0.15810124576091766,-0.3951493799686432,0.3624725043773651,0.1767013967037201,0.03143443912267685,-0.2680625021457672,0.03883188217878342,-0.3503144383430481},{0.24828752875328064,0.028680499643087387,0.41095098853111267,0.3983084261417389,-0.09698101133108139,0.3237565755844116,0.20243598520755768,-0.34487757086753845},{-0.37408655881881714,0.14018091559410095,-0.35748183727264404,0.4300428032875061,-0.015606474131345749,0.4034997820854187,-0.031022178009152412,0.240455761551857},{-0.053471725434064865,0.1774180829524994,-0.1209765076637268,-0.11858217418193817,0.03508071228861809,0.15674228966236115,0.2723424732685089,-0.019652748480439186},{0.11208091676235199,-0.3979063034057617,-0.3578323721885681,-0.17016254365444183,0.14358219504356384,-0.13561703264713287,0.09889174997806549,-0.13944131135940552},{-0.4831675887107849,-0.38610997796058655,-0.2975817620754242,-0.017439281567931175,-0.05187913030385971,0.23878931999206543,0.15224377810955048,-0.16106560826301575},{-0.19013811647891998,-0.35124585032463074,0.19236522912979126,-0.35057514905929565,-0.0194395724684,0.022787712514400482,-0.455124169588089,-0.3370315432548523},{0.06662842631340027,0.20077913999557495,0.10874474793672562,0.21546638011932373,-0.12810608744621277,0.3054125905036926,0.2428893893957138,-0.23794662952423096},{0.07587601244449615,-0.35505497455596924,-0.09948310256004333,-0.02557600662112236,-0.15092405676841736,-0.3682713806629181,0.005063171032816172,-0.32487085461616516},{-0.013342221267521381,-0.008837202563881874,0.08866025507450104,-0.27455464005470276,0.04035191982984543,0.09840337187051773,0.04671487584710121,-0.1661585569381714},{0.12039880454540253,-0.11006245762109756,0.047285281121730804,-0.22999879717826843,-0.004725826438516378,-0.023366449400782585,-0.06398538500070572,-0.27547794580459595},{-0.29190459847450256,0.1689557284116745,0.11825346201658249,-0.22114746272563934,-0.4678901731967926,-0.001512697315774858,0.1019887775182724,-0.029530704021453857},{0.31136709451675415,0.11910989135503769,-0.4564572274684906,0.13417626917362213,-0.07388195395469666,0.21141673624515533,0.2033439725637436,0.2463168054819107},{0.047218527644872665,-0.0923861637711525,-0.0621534138917923,0.31840863823890686,-0.33875757455825806,-0.08721214532852173,-0.19390292465686798,-0.3651008903980255},{0.23766160011291504,0.08436479419469833,-0.5038770437240601,0.31943222880363464,-0.31924793124198914,-0.36856886744499207,-0.3510797619819641,0.13144482672214508},{0.07854671031236649,0.3481506407260895,-0.344681054353714,-0.052386634051799774,0.07785437256097794,-0.26504960656166077,0.32009437680244446,-0.31148797273635864},{-0.046548835933208466,0.05742095410823822,-0.17577162384986877,-0.1283518671989441,0.041281454265117645,-0.19490842521190643,-0.08629988878965378,-0.15207472443580627},{0.1564917117357254,-0.1949368268251419,-0.08521753549575806,-0.08096501231193542,0.009397570975124836,-0.007970951497554779,-0.19672083854675293,0.08171822875738144},{0.3536367118358612,0.037271615117788315,-0.4101969599723816,-0.16940271854400635,-0.24761773645877838,0.09559987485408783,0.2466474324464798,0.06913252174854279},{0.41560500860214233,-0.3058215081691742,-0.05464750528335571,-0.01603318564593792,0.10992147773504257,-0.14310322701931,0.22545941174030304,0.33740749955177307},{-0.20186062157154083,-0.15497702360153198,0.02564546838402748,-0.21089158952236176,0.33357247710227966,-0.2798284590244293,0.06270327419042587,0.10045865178108215},{0.258876770734787,0.035319071263074875,-0.1419905126094818,0.39402124285697937,0.11038342118263245,-0.014066088013350964,-0.0018264661775901914,0.060877494513988495}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2327759563922882,0.38850221037864685,-0.5998890399932861,-0.4602648615837097,-0.2508980631828308,0.08702810853719711,-0.4074748754501343,0.5097380876541138},{-0.03520381078124046,0.5720347762107849,-0.20717447996139526,0.44462335109710693,-0.02116873301565647,0.011926913633942604,-0.24901722371578217,0.023037327453494072},{-0.46070730686187744,-0.16785474121570587,-0.166571244597435,-0.30865585803985596,0.5073570013046265,0.15429532527923584,-0.010949043557047844,0.4596237242221832},{-0.44010671973228455,-0.39372214674949646,0.26809409260749817,0.3787679672241211,-0.505488932132721,-0.13366863131523132,0.3305228352546692,0.18518774211406708},{-0.23592571914196014,-0.31102779507637024,-0.26266270875930786,-0.23249493539333344,0.3147004246711731,-0.24087491631507874,0.41753432154655457,-0.3765257000923157},{-0.07105174660682678,0.14089852571487427,0.28737562894821167,-0.5053315162658691,0.5323787927627563,-0.2757648229598999,-0.4279274046421051,-0.3099766671657562},{-0.4127598702907562,0.1277931183576584,0.0642428770661354,-0.28879818320274353,-0.020316869020462036,-0.5120877623558044,0.5051349997520447,0.049383487552404404},{-0.3927595317363739,-0.2973181903362274,-0.2239174246788025,-0.489075630903244,-0.29880088567733765,0.043188247829675674,0.44919925928115845,-0.28473061323165894}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.013126944191753864,-0.042235054075717926,-0.013810048811137676,0.03633280098438263,-0.02040671557188034,-0.03026336245238781,-0.0912897139787674,0.01508406363427639};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.010396940633654594,-0.08194352686405182,-0.024907482787966728,0.13271039724349976,-0.023669471964240074,0.059012532234191895,-0.03493472561240196,0.02217070944607258};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

