#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.307693213224411,0.07588573545217514,0.017010757699608803,0.2410115748643875,0.38598719239234924,-0.27350369095802307,-0.32114177942276,0.1651432365179062,0.3533165752887726,-0.2707614004611969,0.42984461784362793,0.035458289086818695,0.2981566786766052,0.11091071367263794,-0.2716136574745178,0.04631802439689636},{-0.33078086376190186,-0.19982047379016876,-0.2981811463832855,-0.1331506371498108,0.18345798552036285,0.34749218821525574,0.1384490728378296,0.03661850467324257,0.15554958581924438,0.2081383466720581,-0.16487367451190948,0.02162359468638897,-0.07048168778419495,0.16641879081726074,0.2840724289417267,-0.21636343002319336},{0.09550172835588455,0.30288761854171753,0.12422671169042587,0.2614307105541229,-0.07370833307504654,-0.247577503323555,0.5659372210502625,-0.17166291177272797,-0.07972938567399979,-0.08590266853570938,-0.06984339654445648,-0.10507186502218246,0.08123090863227844,0.5170881152153015,-0.4102044403553009,0.020635131746530533},{0.13263553380966187,-0.14640963077545166,-0.09630253165960312,-0.05747581273317337,-0.17335091531276703,0.055216483771800995,-0.026440488174557686,-0.24954278767108917,-0.056962985545396805,-0.07149037718772888,0.5500388145446777,-0.25957387685775757,-0.29586195945739746,-0.1334940791130066,0.21722781658172607,-0.0013809954980388284},{-0.2345338761806488,-0.04933277890086174,0.22671626508235931,-0.4337518811225891,0.453879714012146,0.1774662286043167,0.22849291563034058,-0.1873013973236084,-0.17180104553699493,0.24816110730171204,-0.06198716163635254,-0.4155886173248291,0.01736832968890667,-0.25087201595306396,0.43559375405311584,-0.032207880169153214},{-0.03448334336280823,-0.07918962091207504,-0.09979289770126343,-0.15896621346473694,0.12276751548051834,-0.29882776737213135,0.528019368648529,-0.3231648802757263,-0.1654275506734848,-0.21800516545772552,0.2681056559085846,0.0735650286078453,0.34180495142936707,0.03908186033368111,0.3554670214653015,0.29650142788887024},{-0.2628838121891022,0.3513129949569702,-0.012027531862258911,0.021474689245224,-0.2825796604156494,-0.10236796736717224,-0.16594812273979187,-0.025794921442866325,0.30017510056495667,0.37292033433914185,-0.2555978000164032,-0.07565385103225708,0.2742557227611542,0.026890262961387634,-0.10478391498327255,0.3366013765335083},{-0.176369309425354,0.05535941570997238,-0.004749758169054985,-0.20929093658924103,0.3123514950275421,-0.2355155050754547,-0.23461905121803284,-0.43692782521247864,-0.08338260650634766,-0.2982276380062103,0.5262452960014343,0.07314798980951309,0.07088655233383179,0.26287227869033813,-0.002453823108226061,0.5022578239440918},{0.2261955440044403,0.20762322843074799,-0.043410319834947586,-0.028849748894572258,-0.48448219895362854,-0.5148066282272339,0.13446049392223358,-0.5628626346588135,-0.050857167690992355,-0.06228002905845642,0.31017595529556274,-0.5230648517608643,-0.4867304563522339,0.1342194378376007,0.1619422435760498,-0.2596311867237091},{0.46242257952690125,-0.6890461444854736,-0.2567509114742279,0.028826134279370308,0.2597885727882385,-0.31010761857032776,-0.21097701787948608,-0.21676908433437347,-0.30139705538749695,0.04074186086654663,-0.27508094906806946,-0.2573277950286865,0.5984503626823425,-0.15516223013401031,-0.6326539516448975,-0.14193475246429443},{0.2423015981912613,0.3712407648563385,-0.15940260887145996,0.09914785623550415,-0.024889158084988594,-0.22109489142894745,-0.23232723772525787,0.12369582802057266,-0.07240748405456543,0.23978911340236664,0.18465560674667358,0.33608168363571167,-0.13723500072956085,0.21810783445835114,0.03542241454124451,-0.2270212173461914},{-0.3687436580657959,0.2176286280155182,0.39368587732315063,-0.6272866129875183,-0.15507851541042328,0.06276381015777588,-0.028023244813084602,0.251304030418396,0.3008171021938324,0.33957886695861816,0.36877065896987915,-0.11471516638994217,0.09182306379079819,-0.1937468945980072,0.09030788391828537,-0.20228040218353271},{0.17249220609664917,-0.3797586262226105,-0.2370331734418869,0.4316636323928833,-0.1980724036693573,-0.2862336039543152,0.00874365959316492,0.41016843914985657,0.07901211082935333,-0.057490404695272446,-0.4744226038455963,0.29828983545303345,0.5715022087097168,0.3505832850933075,-0.27081266045570374,0.6665772795677185},{0.24592609703540802,0.22927230596542358,-0.3512759506702423,0.08567008376121521,-0.01575503684580326,-0.1730072796344757,-0.20369218289852142,0.14549633860588074,-0.3766559660434723,-0.3582984507083893,-0.11624927818775177,0.06471113860607147,-0.5360161066055298,-0.05988625809550285,-0.375870019197464,-0.11564254760742188},{0.10752922296524048,0.6248084306716919,0.5178685784339905,-0.5400488972663879,-0.2530020773410797,0.30352699756622314,-0.06628217548131943,0.060543935745954514,0.5390653014183044,0.3848903477191925,-0.09954923391342163,0.07498784363269806,-0.10002488642930984,-0.38603729009628296,0.21692240238189697,-0.32839247584342957},{-0.3701813817024231,-0.08609721809625626,-0.056262657046318054,0.279447078704834,-0.10432444512844086,0.033465735614299774,-0.21700997650623322,-0.06871646642684937,-0.37597760558128357,-0.12994727492332458,0.31734198331832886,0.18794789910316467,-0.27413830161094666,-0.24845650792121887,-0.41672569513320923,-0.1315731257200241},{-0.3557891547679901,0.15065044164657593,-0.29673707485198975,0.008093053475022316,-0.1338428109884262,0.3392951488494873,0.38573142886161804,0.18830113112926483,0.2638378441333771,-0.23006170988082886,-0.06680428981781006,-0.11551892757415771,0.016551025211811066,0.059051841497421265,-0.03614542633295059,-0.16088980436325073},{0.1579877883195877,-0.4318818151950836,0.16451361775398254,0.218170627951622,-0.02705228514969349,0.31512194871902466,0.32296088337898254,0.1462431252002716,-0.1670442670583725,-0.27621859312057495,-0.12959536910057068,-0.07640794664621353,-0.16331420838832855,-0.40355828404426575,0.10061481595039368,0.04268811270594597}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1340327113866806,0.29396942257881165,0.3306030035018921,-0.1064053624868393,-0.25600239634513855,0.08928457647562027,-0.0022834104020148516,0.29414284229278564,-0.034185003489255905,0.2912718653678894,0.46092185378074646,-0.35802072286605835,-0.0922667533159256,0.03733223304152489,0.0423765666782856,-0.05205290764570236},{-0.5458535552024841,0.25876450538635254,-0.29813823103904724,0.2602521777153015,0.3723233938217163,-0.19971610605716705,-0.33778536319732666,-0.2872486412525177,0.34136804938316345,0.303236186504364,-0.04441450536251068,0.25469252467155457,-0.3843705952167511,0.1561848521232605,-0.28354939818382263,0.4702105224132538},{-0.36559832096099854,0.22354575991630554,-0.3531288206577301,0.03338872641324997,-0.4221406579017639,-0.28929758071899414,-0.0682966485619545,0.0005962594877928495,-0.23631101846694946,0.35537588596343994,0.2654085159301758,-0.09692484885454178,0.2716990113258362,-0.3096584975719452,-0.08948210626840591,-0.003975976724177599},{0.29778653383255005,-0.24352914094924927,0.09246869385242462,0.4546264111995697,-0.42521366477012634,-0.43459898233413696,0.2941572666168213,0.11901414394378662,0.2656051516532898,-0.10269516706466675,0.33876633644104004,0.09374221414327621,-0.2717844247817993,-0.011556990444660187,-0.018398074433207512,-0.38577818870544434},{-0.39865952730178833,0.044076476246118546,0.247898668050766,-0.37379223108291626,0.1623457372188568,0.37220871448516846,-0.3147121071815491,0.2280077189207077,-0.2097558081150055,0.20968091487884521,-0.0829862430691719,-0.015033402480185032,-0.11299584805965424,-0.04016564041376114,-0.1908821016550064,-0.1592789739370346},{0.02977730892598629,-0.24658969044685364,-0.0016138522187247872,-0.3433462679386139,0.30021369457244873,0.07303057610988617,-0.0293924268335104,-0.07546228915452957,-0.2213047444820404,0.3768114745616913,0.29123419523239136,-0.09531057626008987,-0.18946030735969543,0.21096831560134888,-0.05157771706581116,-0.36252400279045105},{0.25549453496932983,-0.129489928483963,0.35068196058273315,-0.29438936710357666,-0.35835596919059753,-0.017334027215838432,-0.37273287773132324,0.35712730884552,-0.0989399328827858,-0.24420471489429474,-0.2572075128555298,-0.040389806032180786,-0.04660335183143616,-0.10408183187246323,0.47201430797576904,-0.3619546592235565},{-0.2736445367336273,0.36025893688201904,-0.09078589081764221,0.3149472177028656,0.020416198298335075,-0.2784169614315033,-0.1067618876695633,0.15752547979354858,-0.09341149032115936,0.4901773929595947,0.15066386759281158,-0.21968446671962738,-0.04326831176877022,-0.09558357298374176,0.02191029116511345,0.13182030618190765},{0.07185038924217224,0.2858677804470062,-0.18201252818107605,-0.3747316896915436,0.38527044653892517,-0.2179499864578247,0.14492669701576233,-0.3493179380893707,0.14114826917648315,0.05174076929688454,0.10143037885427475,0.15123113989830017,-0.02173496223986149,-0.360025018453598,-0.060104310512542725,0.2308683544397354},{-0.2478288859128952,-0.002893192460760474,-0.3265908360481262,-0.3187161087989807,0.23267973959445953,-0.4250621795654297,-0.17473340034484863,0.28027769923210144,-0.13778631389141083,0.23405785858631134,-0.04805457592010498,-0.105760857462883,-0.3535992503166199,0.007938049733638763,-0.26991528272628784,-0.33982518315315247},{-0.2469509243965149,-0.08980587124824524,-0.07320788502693176,-0.34528717398643494,-0.3291153013706207,-0.0363994799554348,0.16530784964561462,-0.5290489792823792,0.007950806058943272,-0.055304769426584244,0.20388413965702057,-0.004927912726998329,0.44666334986686707,0.065900057554245,0.21376150846481323,0.24177923798561096},{-0.16593720018863678,-0.06345997005701065,-0.4165725111961365,0.3310193419456482,0.10627041757106781,-0.07815449684858322,0.18006949126720428,0.10508739948272705,-0.41361212730407715,0.19304469227790833,-0.28705495595932007,-0.1591484248638153,-0.3908941447734833,0.4418264925479889,-0.33908611536026,0.0882701426744461},{-0.20772244036197662,-0.44607698917388916,-0.15072514116764069,0.1588495820760727,-0.17718380689620972,-0.11621025949716568,-0.14656488597393036,0.424916535615921,0.4350115954875946,0.0979081317782402,-0.10004019737243652,-0.25010237097740173,0.1746026575565338,-0.414716899394989,0.13016362488269806,-0.22770027816295624},{-0.29713985323905945,-0.4387117326259613,-0.19926667213439941,-0.09007647633552551,-0.4396241009235382,0.4259020686149597,-0.06983122229576111,0.20793317258358002,-0.1761404573917389,-0.3251505196094513,-0.31962528824806213,0.4164447486400604,-0.2534923255443573,0.05715874210000038,-0.30972403287887573,0.39505472779273987},{-0.37172797322273254,0.34140846133232117,-0.1768876314163208,0.10628701001405716,-0.4076698124408722,0.3197743594646454,-0.01508269365876913,-0.3625620901584625,0.13516554236412048,0.1945081502199173,-0.22447942197322845,0.09623600542545319,0.28677231073379517,-0.29133832454681396,-0.3265204131603241,-0.1510683000087738},{-0.13250204920768738,-0.4071217477321625,-0.5381885170936584,0.31329381465911865,-0.027791408821940422,0.1465795636177063,-0.3252643644809723,0.2451968491077423,-0.42945969104766846,-0.3332463204860687,-0.4157751202583313,0.24483361840248108,-0.2120630145072937,0.1695357710123062,0.11930929124355316,0.26638197898864746}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.08808023482561111,-0.1227765902876854,0.09461402893066406,-0.1546872854232788,-0.10697849094867706,0.09486090391874313,0.19402971863746643,-0.21663635969161987,-0.08215340226888657,0.30564093589782715,0.09253346920013428,0.12964072823524475,0.07632102072238922,0.15659199655056,-0.2158663272857666,0.13186410069465637,0.1368848830461502,-0.30228346586227417,-0.28066354990005493,-0.11501597613096237,-0.1554163694381714,0.12327579408884048,-0.24910883605480194,0.3566742539405823,-0.1530972123146057,-0.013344775885343552,0.14617259800434113,0.16833902895450592,-0.2701203525066376,-0.2210470288991928,0.22200748324394226,0.3049866557121277},{0.16832399368286133,-0.014584217220544815,0.16927151381969452,-0.05083538219332695,-0.12802565097808838,0.19977417588233948,-0.020159009844064713,-0.0995379090309143,-0.06370384991168976,-0.0816371738910675,-0.09323824197053909,0.05076277256011963,0.39719337224960327,0.22128410637378693,0.13621851801872253,0.07429725676774979,-0.26969820261001587,-0.3208340108394623,0.10966071486473083,0.0537615641951561,0.07919289916753769,0.25345298647880554,0.25825583934783936,-0.19201789796352386,0.052234500646591187,0.31597599387168884,-0.33332252502441406,0.21513225138187408,0.14334525167942047,-0.2509205937385559,-0.06362439692020416,-0.02849455550312996},{-0.09915736317634583,-0.033580467104911804,0.15833589434623718,-0.14351680874824524,-0.21653561294078827,-0.01732988841831684,-0.2770518660545349,0.1590435653924942,0.2730869948863983,-0.021682674065232277,-0.20396016538143158,0.11536359786987305,0.3613424301147461,-0.20408441126346588,0.08324442058801651,-0.019309256225824356,-0.4105822443962097,0.21266838908195496,-0.3773743808269501,-0.05735151469707489,-0.04124075546860695,-0.09295807033777237,-0.07900822162628174,-0.09015629440546036,0.009231597185134888,0.4221871495246887,-0.04757522791624069,0.12255837023258209,0.29057663679122925,-0.41838157176971436,-0.11262538284063339,0.017252745106816292},{0.18873284757137299,-0.2721751928329468,0.02563994936645031,-0.42105725407600403,0.14819121360778809,-0.06360331177711487,-0.016899321228265762,0.25325775146484375,0.05768356844782829,0.27077487111091614,0.03541678190231323,-0.1874634325504303,-0.22363592684268951,-0.09941700100898743,0.2536640167236328,-0.2461957335472107,0.08635099232196808,-0.05734822526574135,-0.1614406853914261,0.0860138013958931,-0.1600589156150818,0.1731097400188446,-0.2431335747241974,0.33051908016204834,-0.3022783100605011,0.008978624828159809,-0.06763676553964615,-0.26479676365852356,-0.015294483862817287,0.0668834000825882,0.2234135866165161,-0.13302047550678253},{0.2734575867652893,-0.01436492707580328,0.06126486137509346,0.26891279220581055,-0.24414779245853424,-0.07552403956651688,0.18391577899456024,-0.0012993263080716133,0.09760536998510361,-0.18692827224731445,0.0021103420294821262,-0.07443732023239136,-0.2057972252368927,-0.17593763768672943,0.3236449956893921,0.3029741644859314,-0.06721259653568268,-0.3482782542705536,0.16995103657245636,-0.12479031831026077,-0.12605267763137817,0.2135515809059143,0.27681732177734375,0.009408392012119293,-0.11919483542442322,-0.11140364408493042,-0.004093554802238941,0.2754304111003876,0.2727053463459015,0.12185207009315491,0.12324071675539017,-0.2262018620967865},{0.2608549892902374,-0.1657712757587433,0.012859482318162918,0.08201619237661362,-0.19374525547027588,-0.3404443860054016,-0.23451906442642212,-0.35195139050483704,-0.18892693519592285,-0.005753302946686745,-0.010720886290073395,0.0020946068689227104,-0.08275429904460907,0.006325556430965662,-0.2342536300420761,-0.29983779788017273,0.17882709205150604,0.03870520368218422,-0.3204740881919861,0.25913411378860474,-0.06032451614737511,-0.21689660847187042,0.183868870139122,-0.1357499659061432,-0.11589383333921432,-0.2369147092103958,-0.10673444718122482,0.0624876394867897,0.07799048721790314,0.22333671152591705,-0.3136959969997406,0.14832742512226105},{0.1927168071269989,0.07878013700246811,0.251858651638031,-0.15080444514751434,0.2513333857059479,-0.19670133292675018,-0.30103057622909546,-0.013492343947291374,0.2857171893119812,0.14432787895202637,-0.16699457168579102,0.11890886723995209,0.08727487176656723,0.3158986568450928,0.13002611696720123,-0.040104880928993225,-0.23507291078567505,0.13828542828559875,0.0029752524569630623,-0.03225652128458023,-0.0963965356349945,0.23694388568401337,0.18015073239803314,0.14849746227264404,-0.30684733390808105,-0.23644542694091797,-0.28541460633277893,-0.35820668935775757,0.040791165083646774,-0.10991058498620987,0.2736542522907257,0.1339905858039856},{0.35321348905563354,-0.4456801414489746,0.05887424200773239,-0.4855896532535553,-0.28376203775405884,0.3621465563774109,0.47884422540664673,0.2739350199699402,-0.06120415776968002,0.15008576214313507,0.17715544998645782,-0.20646339654922485,0.0079426858574152,0.2413894236087799,-0.07214026153087616,0.14828024804592133,0.4994402825832367,-0.24540120363235474,-0.09696485102176666,-0.42630019783973694,0.20770050585269928,0.24476677179336548,0.19506612420082092,0.15141244232654572,0.13098593056201935,0.09440012276172638,0.20665782690048218,0.2709045708179474,-0.1381404995918274,-0.24332347512245178,0.27531522512435913,0.12035585939884186},{0.02981334738433361,-0.043833110481500626,0.20461271703243256,0.29548993706703186,-0.21817518770694733,-0.35018351674079895,-0.10670305788516998,0.2208748608827591,-0.18443697690963745,-0.25229161977767944,0.05434199795126915,0.1622217297554016,0.1413602977991104,-0.307198166847229,0.14533090591430664,-0.14077387750148773,-0.24146920442581177,0.12840837240219116,-0.27396517992019653,0.27022355794906616,-0.31317538022994995,-0.329602986574173,-0.3030344247817993,0.19996610283851624,0.11572884023189545,0.1255982667207718,0.30480673909187317,0.2469281703233719,-0.12726227939128876,-0.3526189923286438,-0.1300954967737198,0.16403065621852875},{0.39467328786849976,0.052450504153966904,0.054921846836805344,0.22604645788669586,0.10279790312051773,0.28464433550834656,-0.04087422788143158,0.2816930413246155,-0.12038921564817429,0.06869234889745712,0.14041796326637268,0.10595306009054184,-0.1101372018456459,-0.4145929217338562,0.22903525829315186,0.24206316471099854,0.010541129857301712,-0.19259138405323029,0.013987857848405838,-0.015331362374126911,0.0724884569644928,-0.32776445150375366,0.4062535762786865,0.024845117703080177,-0.09667331725358963,0.10985970497131348,-0.37851423025131226,-0.12649065256118774,0.07926356792449951,0.05041065812110901,0.1537027359008789,0.2594643831253052},{-0.08063459396362305,0.10750538855791092,-0.07992921769618988,0.22041206061840057,-0.09271983802318573,0.28182724118232727,0.06223587691783905,-0.10085811465978622,0.2853061854839325,-0.30411386489868164,-0.17567740380764008,0.18902339041233063,-0.06791185587644577,0.06159312650561333,-0.28359079360961914,0.05089205875992775,0.034689947962760925,0.1493285596370697,0.07473526895046234,-0.13073129951953888,-0.27780359983444214,0.1948634684085846,0.2385805994272232,0.21494048833847046,-0.3371913731098175,0.3598550260066986,-0.1488381326198578,3.725021088030189e-05,-0.11517347395420074,0.12294965237379074,0.21522344648838043,0.25116127729415894},{-0.24506230652332306,0.2935809791088104,-0.0810052901506424,-0.0002976827963721007,-0.2664426863193512,-0.201846182346344,0.13925610482692719,-0.3389192819595337,-0.017646927386522293,-0.2786455750465393,-0.20323525369167328,-0.06307636201381683,0.19625163078308105,-0.21018099784851074,-0.12962225079536438,-0.3790779411792755,-0.17826253175735474,0.010472605936229229,0.30155596137046814,-0.23293191194534302,0.07365749031305313,-0.15734897553920746,0.01090981438755989,0.3036273717880249,-0.11476929485797882,0.13761985301971436,0.2535839080810547,-0.14443892240524292,-0.09020765125751495,0.28731513023376465,-0.22098679840564728,-0.3658451437950134},{-0.05152525752782822,0.30352574586868286,0.2561158537864685,-0.2835720479488373,0.2884621024131775,-0.004483487457036972,-0.14808574318885803,-0.03356882557272911,0.10602787882089615,-0.3306742012500763,-0.03182376176118851,0.07218468189239502,0.2225731462240219,0.04541420936584473,0.03234054148197174,0.000654087692964822,0.19114361703395844,-0.32872000336647034,0.3431515395641327,0.06907110661268234,-0.1611795872449875,0.15071584284305573,-0.08265777677297592,-0.2773803770542145,0.2500205934047699,-0.05458728224039078,-0.011012177914381027,-0.09188057482242584,0.08493365347385406,-0.14137117564678192,0.3088880479335785,0.2782266438007355},{0.0808289423584938,-0.25778496265411377,-0.20252205431461334,0.05900426208972931,0.06077800691127777,0.2881563901901245,-0.11885057389736176,-0.27630433440208435,0.3659498989582062,0.09251543134450912,-0.00267226854339242,0.022230075672268867,-0.1768101006746292,0.11387261748313904,-0.20677833259105682,-0.32568463683128357,0.06317152827978134,0.032692186534404755,0.16518032550811768,0.373737096786499,-0.26189714670181274,0.18579669296741486,-0.1814725399017334,0.10644268244504929,0.05793068930506706,-0.3122219145298004,-0.1479227989912033,-0.3286017179489136,-0.14052355289459229,-0.14133751392364502,0.19652053713798523,-0.35612601041793823},{-0.09265027940273285,0.33353203535079956,0.10826205462217331,-0.19959129393100739,-0.14725571870803833,-0.23219196498394012,0.15046368539333344,-0.0877029299736023,0.28219833970069885,-0.0534648671746254,0.24955174326896667,0.1919911950826645,-0.009196768514811993,0.08040773868560791,-0.18314573168754578,0.1786113977432251,-0.19246840476989746,-0.3921147584915161,-0.3076215088367462,0.10355136543512344,0.15020886063575745,-0.26766642928123474,-0.3502320647239685,-0.24120879173278809,-0.17236921191215515,0.10651946812868118,0.38525035977363586,0.008701764978468418,-0.13332495093345642,0.0444374717772007,-0.1432017832994461,0.11992846429347992},{-0.20685532689094543,-0.16693222522735596,-0.2394704818725586,0.10164286196231842,-0.28233712911605835,-0.1398267149925232,-0.1462372988462448,-0.1773088425397873,-0.2961629629135132,-0.2098422348499298,0.1090160459280014,0.1982264667749405,-0.24087928235530853,0.27085065841674805,-0.020546192303299904,0.19037094712257385,0.00892787054181099,0.01105166133493185,0.03654511272907257,0.14036832749843597,0.1476823091506958,0.32381319999694824,0.10679017007350922,0.22387517988681793,0.0986676961183548,-0.23768429458141327,-0.14991776645183563,0.25197353959083557,-0.03324291855096817,-0.21461926400661469,-0.14458982646465302,-0.22252164781093597},{-0.3125388026237488,-0.20744532346725464,-0.3826695382595062,0.07870569080114365,-0.12269018590450287,-0.0918862596154213,-0.12263420969247818,0.0859835147857666,-0.03714196756482124,0.07888846099376678,-0.22621726989746094,0.019709253683686256,0.12572143971920013,-0.0841316506266594,0.023111838847398758,0.18300937116146088,-0.12896442413330078,-0.13506779074668884,0.15381039679050446,0.07559122890233994,0.22611302137374878,-0.01171345729380846,-0.27968305349349976,0.03382541984319687,0.24763695895671844,-0.27663901448249817,0.18744945526123047,0.0214471984654665,0.07665305584669113,-0.16380536556243896,0.22508634626865387,-0.06742139905691147},{0.2605871558189392,-0.06345689296722412,0.047400277107954025,0.08916708827018738,-0.2775844633579254,0.011251037009060383,0.17993177473545074,0.24293303489685059,-0.09060841798782349,-0.10412074625492096,0.3150113821029663,-0.20478330552577972,-0.04424871504306793,-0.08081134408712387,-0.15523011982440948,0.2099783718585968,0.03728756681084633,-0.07339932769536972,0.1339619755744934,-0.2967199981212616,0.044333189725875854,-0.31337228417396545,-0.23012813925743103,0.25289759039878845,-0.1283315122127533,-0.13722428679466248,0.1651480793952942,-0.012740103527903557,-0.1667671799659729,-0.003835698589682579,-0.1046559140086174,-0.014686344191432},{0.3347594738006592,-0.061639025807380676,0.09645801037549973,0.07308275997638702,0.005081359762698412,-0.08988460153341293,0.1658802032470703,-0.22664093971252441,0.21577996015548706,0.3045591711997986,-0.0030754772014915943,0.16391657292842865,0.2590297758579254,0.3137768805027008,-0.2793065309524536,-0.2899389863014221,-0.29755648970603943,0.04721330478787422,-0.14245083928108215,-0.2979969382286072,-0.20013593137264252,0.2951957881450653,0.07340870052576065,0.1482502818107605,-0.16193655133247375,-0.09213095903396606,-0.14711731672286987,-0.1852625012397766,0.26671576499938965,0.18227538466453552,-0.25922125577926636,-0.14354802668094635},{-0.12552538514137268,0.12857672572135925,0.25934842228889465,-0.10227937251329422,-0.03386301547288895,0.05698173865675926,0.013421572744846344,-0.29425689578056335,0.22056831419467926,0.2622413635253906,0.17333343625068665,0.19221940636634827,-0.28236445784568787,0.1743910014629364,-0.30818918347358704,0.25392210483551025,0.1950875222682953,-0.2398146241903305,0.23392479121685028,0.11334411799907684,-0.28801432251930237,0.29504451155662537,-0.33935678005218506,0.12911264598369598,0.219292551279068,0.23493696749210358,0.1310882866382599,0.09596110880374908,-0.1956847906112671,0.22594526410102844,-0.08135741949081421,0.1402440220117569},{-0.1627928465604782,-0.047873228788375854,-0.02160016819834709,0.24489152431488037,-0.03225453197956085,0.15287193655967712,-0.35635730624198914,-0.1920812577009201,-0.13917410373687744,-0.127221018075943,-0.17191638052463531,-0.098196841776371,0.06888328492641449,-0.1276036947965622,0.08917926996946335,-0.19201552867889404,0.16824056208133698,-0.04415443539619446,-0.34238824248313904,-0.24470846354961395,0.11074042320251465,0.18934166431427002,-0.2194693684577942,0.2956773340702057,-0.2318524569272995,0.12766064703464508,0.14309535920619965,-0.07196138799190521,0.1382213979959488,-0.28108781576156616,0.36735615134239197,0.09160353988409042},{0.339106947183609,-0.058015041053295135,0.07528027892112732,0.15811780095100403,-0.19314944744110107,0.2264043390750885,-0.021386772394180298,0.2307385802268982,0.1538010835647583,0.11000094562768936,0.04607701301574707,-0.4061530828475952,-0.27289628982543945,-0.028662756085395813,0.06514660269021988,-0.14683033525943756,0.3195298910140991,0.2356734573841095,-0.20337451994419098,-0.1938282996416092,0.29579997062683105,0.2636479139328003,0.2619614899158478,0.16508370637893677,-0.05245799571275711,-0.03441911190748215,-0.07566507905721664,-0.23276562988758087,0.21091949939727783,0.09151137620210648,-0.22652502357959747,0.10851842164993286},{-0.0386735200881958,0.01556304283440113,-0.07773880660533905,-0.27153950929641724,-0.10730226337909698,-0.24171344935894012,-0.21341560781002045,-0.16005481779575348,0.018906546756625175,-0.019816718995571136,-0.2537568211555481,0.00796202290803194,-0.2694341838359833,-0.16614609956741333,-0.011954174377024174,0.0672297552227974,0.29317915439605713,-0.17579840123653412,-0.3481789827346802,0.2649399936199188,-0.1433214694261551,0.251512348651886,-0.02285577543079853,-0.05582257732748985,0.0675060972571373,0.12371354550123215,-0.050817541778087616,-0.2868388295173645,0.22082693874835968,0.24592719972133636,-0.16228218376636505,0.20843811333179474},{-0.2570919096469879,-0.001287452643737197,0.06581517308950424,0.011088265106081963,0.05844544246792793,0.10378012806177139,-0.18972501158714294,0.0936867818236351,-0.22005048394203186,-0.20633190870285034,0.12864826619625092,-0.11916418373584747,-0.16732463240623474,0.26573020219802856,0.028910478577017784,0.02310621179640293,0.1862763911485672,-0.25615862011909485,-0.14540411531925201,0.267633318901062,0.029282789677381516,0.2103702574968338,-0.0005840476951561868,0.016199102625250816,-0.29181092977523804,-0.14500457048416138,-0.003912110812962055,0.3140607178211212,0.007379115093499422,0.003441832959651947,0.27391573786735535,0.2775757908821106}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.050863493233919144,0.21119101345539093,0.46617165207862854,-0.10940755903720856},{0.10119717568159103,-0.15046881139278412,0.011233738623559475,0.3552282452583313},{-0.14668631553649902,0.12724432349205017,0.15209656953811646,0.15830551087856293},{0.39902302622795105,0.0537327416241169,0.06006748974323273,0.5595285296440125},{-0.06052934750914574,0.11202600598335266,0.35394689440727234,0.03196011856198311},{-0.1441815346479416,0.2660723328590393,0.28799107670783997,-0.1018899530172348},{-0.42944154143333435,-0.034159623086452484,0.11415260285139084,-0.21686434745788574},{-0.4053133726119995,-0.1407611221075058,0.4877929091453552,-0.3193496763706207},{0.32975393533706665,-0.14168810844421387,-0.30918648838996887,-0.4392188489437103},{0.0413404144346714,0.3460809588432312,0.3780248165130615,-0.5731918215751648},{-0.28175440430641174,-0.24292518198490143,-0.11345600336790085,0.09463918209075928},{0.49084213376045227,-0.2186295986175537,-0.06496910750865936,0.26546356081962585},{0.31382882595062256,0.2801252007484436,-0.06565140187740326,0.18066014349460602},{-0.006052663084119558,0.050175197422504425,-0.328401654958725,0.05329453572630882},{0.11625847965478897,0.30391332507133484,0.46567437052726746,0.36431360244750977},{0.15435448288917542,-0.03222212195396423,0.32751214504241943,0.2814176678657532},{-0.33323392271995544,-0.12229344993829727,-0.09246402978897095,-0.3450128734111786},{-0.13674645125865936,0.23308590054512024,-0.16866494715213776,-0.0934019535779953},{-0.3508196175098419,0.23095861077308655,0.21890410780906677,0.42337092757225037},{-0.016164934262633324,0.3682982921600342,-0.23586057126522064,0.2131921947002411},{-0.3007179796695709,-0.4015800952911377,-0.1298685520887375,0.026422346010804176},{0.3633338212966919,0.4733445942401886,0.03199917450547218,-0.34882304072380066},{-0.002061075996607542,0.22715772688388824,0.24512448906898499,0.23364488780498505},{-0.08244241774082184,0.43830230832099915,-0.04761830344796181,-0.25024938583374023},{0.0010062443325296044,-0.10469360649585724,-0.12809887528419495,-0.006558224558830261},{0.36550986766815186,-0.49057355523109436,-0.04214362055063248,0.017472000792622566},{-0.04979563504457474,-0.4188164174556732,-0.20279359817504883,-0.32123807072639465},{0.16392698884010315,-0.2434682995080948,0.2434084117412567,0.1771811544895172},{0.05178213119506836,-0.07091740518808365,0.07697786390781403,0.06803522258996964},{-0.4701813757419586,0.43108251690864563,0.2252335399389267,-0.024142805486917496},{0.37653619050979614,-0.17548152804374695,0.23933610320091248,-0.061798933893442154},{0.11991411447525024,-0.4820195436477661,0.4178802967071533,-0.2780097424983978}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.04960015416145325,-0.014567269943654537,0.019321873784065247,0.035732682794332504,-0.07716094702482224,-0.08217981457710266,0.02482542023062706,0.044181566685438156,0.09508538991212845,-0.02207469381392002,-0.036446463316679,-0.030720192939043045,0.032801687717437744,-0.014129752293229103,-0.04635804891586304,-0.035793472081422806};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.029459236189723015,0.008660697378218174,0.005506617017090321,0.021468808874487877,0.023206718266010284,-0.013691751286387444,0.03182327374815941,0.007375379558652639,0.020959747955203056,0.02392355352640152,0.04131744056940079,-0.007616249844431877,0.051948901265859604,-0.03589717298746109,-0.030927209183573723,-0.005004731006920338};
static const float actor_encoder_feed_forward_0_bias[32] = {0.02283473126590252,0.005915955174714327,0.02426784671843052,0.006216786801815033,0.0211658738553524,0.0068869334645569324,0.008611592464148998,0.01568901166319847,-0.03549836575984955,-0.0023868463467806578,-0.002477903151884675,0.005777680780738592,0.017683086916804314,0.0023094865027815104,0.004692302085459232,0.041058171540498734,-0.0026616021059453487,-0.009191296994686127,0.017741376534104347,-0.007464661728590727,-0.025311414152383804,-0.0009871869115158916,0.03898240998387337,0.02060786820948124,-0.014416366815567017,0.017358463257551193,-0.021921681240200996,0.03633201867341995,-0.0019287813920527697,0.01619146764278412,0.024271702393889427,-0.0010371803073212504};
static const float action_parameterization_distribution_linear_bias[4] = {-0.004983800463378429,-0.00024029123596847057,0.009300140663981438,0.005714479833841324};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.11160095781087875,0.22744445502758026,-0.18459893763065338,0.22090382874011993,0.09440790861845016,0.05725039541721344,0.35124608874320984,-0.032340530306100845},{-0.3167515993118286,-0.043470535427331924,-0.3137563467025757,-0.1932246834039688,-0.40119194984436035,-0.25921517610549927,-0.023946786299347878,-0.24087370932102203},{-0.3154044449329376,0.028732119128108025,0.2159246951341629,0.26629701256752014,0.23399895429611206,-0.046397607773542404,0.39671996235847473,-0.1728692352771759},{-0.019343173131346703,0.1060708686709404,-0.19939513504505157,0.026159120723605156,0.014515780843794346,-0.06760144978761673,0.36320334672927856,-0.25491172075271606},{-0.340850830078125,-0.1251373440027237,-0.2585392892360687,-0.11757522076368332,-0.023033184930682182,0.17820051312446594,0.20518727600574493,-0.06180809810757637},{-0.3576711416244507,-0.031017111614346504,0.3604004681110382,0.2478025108575821,0.19036558270454407,-0.10557256639003754,-0.1160917580127716,-0.15156368911266327},{-0.279694139957428,0.023184822872281075,0.3884235620498657,-0.20630577206611633,-0.09968841075897217,-0.4013856053352356,-0.09435756504535675,-0.1141848936676979},{-0.29535019397735596,-0.33252862095832825,0.4528662860393524,-0.11762040853500366,-0.12795527279376984,0.28588300943374634,0.19097447395324707,-0.24480386078357697},{-0.3649265766143799,0.3256646394729614,-0.21590837836265564,0.3137666583061218,0.19796115159988403,-0.2364780753850937,0.031216243281960487,0.1326274424791336},{-0.4072228968143463,-0.2831505239009857,-0.17754380404949188,-0.24254871904850006,-0.47639456391334534,0.17847105860710144,-0.016046443954110146,0.1684478223323822},{0.08823912590742111,0.36881861090660095,0.20235849916934967,-0.03561754524707794,0.21705889701843262,0.16990423202514648,-0.1842406839132309,0.22610169649124146},{0.13641124963760376,0.047521404922008514,0.25982728600502014,0.2590111792087555,-0.32986265420913696,0.2954569458961487,0.020600635558366776,-0.22476182878017426},{0.06310249865055084,-0.3288034200668335,0.26734957098960876,-0.03512553125619888,-0.39780035614967346,-0.09892068803310394,-0.15933997929096222,-0.10271183401346207},{-0.23960158228874207,-0.25813496112823486,0.32913804054260254,0.3605246841907501,-0.2765054702758789,-0.07688555121421814,-0.27787935733795166,0.2469990849494934},{0.0593256838619709,-0.16856913268566132,0.13489823043346405,-0.2259424328804016,-0.2914140522480011,-0.1271607130765915,0.2866506576538086,0.015896808356046677},{0.1908990442752838,-0.005267302971333265,0.01244801189750433,-0.2430800348520279,0.062356043606996536,0.06752292066812515,0.18477250635623932,0.36769524216651917},{-0.02622421272099018,-0.29673367738723755,-0.17501018941402435,0.13027651607990265,-0.2114270031452179,-0.14591211080551147,-0.10658202320337296,0.13330693542957306},{-0.1869111955165863,-0.33230698108673096,0.02293509617447853,0.0662226751446724,0.11828698962926865,-0.19958741962909698,0.3476136028766632,0.20107164978981018},{-0.016094615682959557,0.07950713485479355,-0.27448639273643494,0.14384427666664124,0.11168302595615387,0.18869435787200928,-0.2443191260099411,0.400777667760849},{0.09953995048999786,-0.048775024712085724,-0.3886198401451111,0.12015710771083832,-0.05135856941342354,-0.03149217739701271,-0.3225453197956085,0.03525805100798607},{0.036883942782878876,-0.1317531019449234,0.044971685856580734,-0.06998235732316971,0.3492986559867859,0.04824341461062431,-0.013818253763020039,0.4256856143474579},{-0.010163252241909504,0.1318255215883255,-0.2701031267642975,0.3256150484085083,0.3689199984073639,0.33612489700317383,0.24238765239715576,-0.3196484446525574},{-0.4649525284767151,-0.1270361691713333,0.16731590032577515,-0.012171288952231407,0.20266611874103546,-0.30411627888679504,0.31029871106147766,-0.2953205108642578},{-0.25368207693099976,0.01760680601000786,-0.06367453187704086,-0.32788169384002686,0.199520081281662,-0.03999469801783562,-0.2587161362171173,0.16954529285430908},{-0.337808221578598,-0.19053103029727936,0.029703756794333458,0.08949621766805649,-0.13822825253009796,0.08881190419197083,0.3568919897079468,-0.13386963307857513},{-0.3203248977661133,0.058386292308568954,-0.3768099546432495,-0.30218350887298584,0.1432092934846878,0.00973896961659193,-0.045924779027700424,0.0725366473197937},{0.22687505185604095,0.38861849904060364,-0.31011226773262024,0.17171065509319305,0.21322332322597504,0.3872166872024536,-0.26074132323265076,-0.137319877743721},{0.2654081881046295,0.2583274841308594,0.04564981162548065,0.06782203912734985,0.2801712453365326,0.2002754658460617,0.2965630292892456,0.374002069234848},{-0.24595440924167633,0.3987117111682892,0.16554871201515198,0.008780472911894321,0.20380926132202148,0.03978550061583519,-0.29450297355651855,-0.3087965250015259},{-0.3332136571407318,-0.21148313581943512,0.09141401201486588,-0.24711737036705017,-0.33134859800338745,-0.1795872300863266,0.36042356491088867,-0.07265835255384445},{0.25366470217704773,-0.24892185628414154,0.34088215231895447,-0.31083595752716064,0.005736263003200293,0.22448936104774475,0.23690631985664368,-0.2622116208076477},{0.06846916675567627,0.37352752685546875,0.3835170567035675,-0.23815959692001343,-0.2865125238895416,0.038778163492679596,0.22634899616241455,0.07435259222984314}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.004757182206958532,0.4718284606933594,-0.20119550824165344,0.2126634567975998,-0.4218776822090149,0.3211004436016083,0.3401142656803131,0.07349713891744614},{-0.5041427612304688,-0.42407751083374023,-0.36853161454200745,-0.441424161195755,-0.4974024295806885,0.48419925570487976,0.40745505690574646,-0.4243926703929901},{0.09222865849733353,-0.1741712987422943,0.1467008739709854,0.16487416625022888,-0.03330477327108383,0.4622262716293335,-0.34252533316612244,-0.46090027689933777},{0.4924658238887787,0.019583581015467644,0.13037237524986267,0.032018061727285385,0.5136347413063049,0.41486722230911255,0.4639708995819092,0.37558218836784363},{0.09177928417921066,0.19687475264072418,-0.1813085526227951,-0.30562832951545715,0.07383706420660019,-0.513107180595398,-0.488404244184494,0.6283660531044006},{0.4317116439342499,0.06076768785715103,0.034454502165317535,-0.3816587030887604,-0.4845513105392456,-0.5124785900115967,-0.11733479797840118,0.4424167573451996},{-0.47248151898384094,-0.36815571784973145,-0.08538977056741714,-0.2573876678943634,-0.008311953395605087,0.5154038667678833,-0.5576534271240234,0.5346418619155884},{0.26190584897994995,0.11151497811079025,-0.048497363924980164,0.05346859246492386,0.43722519278526306,-0.5983622670173645,0.42704224586486816,-0.33187201619148254}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.12231279909610748,0.01724627986550331,0.028803691267967224,-0.011133863590657711,-0.04469892755150795,0.02508266642689705,0.020833639428019524,0.00932121742516756};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012696548365056515,-0.01665600575506687,-0.013020765967667103,0.030168840661644936,-0.00644804909825325,-0.010280467569828033,0.01368149183690548,-0.05403129756450653};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

