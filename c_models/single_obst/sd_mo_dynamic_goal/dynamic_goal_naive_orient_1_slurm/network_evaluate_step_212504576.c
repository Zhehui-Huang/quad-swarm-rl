#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3293440639972687,0.07513465732336044,0.024027319625020027,0.23280194401741028,0.3732345998287201,-0.24632154405117035,-0.3152850270271301,0.14476816356182098,0.3469948172569275,-0.2808888554573059,0.45186847448349,0.04980411008000374,0.26826462149620056,0.11627858877182007,-0.2736711800098419,0.03009629063308239},{-0.3087727725505829,-0.20154596865177155,-0.3176412880420685,-0.11314810812473297,0.1915532499551773,0.34104660153388977,0.13997821509838104,0.023928984999656677,0.15752670168876648,0.20023508369922638,-0.13223601877689362,0.01397247426211834,-0.07134885340929031,0.12675823271274567,0.2745935916900635,-0.22820690274238586},{0.046521928161382675,0.26980459690093994,0.17612767219543457,0.24168501794338226,0.01773938722908497,-0.22750510275363922,0.6778791546821594,-0.19039508700370789,-0.10981760919094086,-0.03416689857840538,-0.04914199188351631,-0.1929055154323578,0.2154109627008438,0.5475364923477173,-0.4389960765838623,0.08056824654340744},{0.17218486964702606,-0.15964457392692566,-0.14558269083499908,-0.029737796634435654,-0.23375388979911804,0.03791256994009018,-0.028599774464964867,-0.2606821358203888,-0.06529159843921661,-0.1276412010192871,0.5744161605834961,-0.2423560917377472,-0.3465568423271179,-0.14476953446865082,0.21811257302761078,-0.03015117160975933},{-0.26452407240867615,-0.007714084815233946,0.2252969890832901,-0.47177577018737793,0.4791973829269409,0.1780245304107666,0.23825548589229584,-0.20835097134113312,-0.16727933287620544,0.24969226121902466,-0.04164295271039009,-0.42556193470954895,0.0024013041984289885,-0.21724142134189606,0.4463452100753784,-0.008703515864908695},{-0.022349068894982338,-0.11981536448001862,-0.10466158390045166,-0.10380218178033829,0.09410621970891953,-0.2882939577102661,0.5608406066894531,-0.29558825492858887,-0.22817933559417725,-0.23029036819934845,0.18591128289699554,0.08071403205394745,0.321479856967926,0.033849213272333145,0.32330766320228577,0.27154064178466797},{-0.26022279262542725,0.3111550211906433,-0.02929643727838993,0.07259663939476013,-0.2872941493988037,-0.11005154997110367,-0.11814698576927185,-0.011287607252597809,0.2524239718914032,0.36403194069862366,-0.3125542402267456,-0.09043821692466736,0.307096004486084,0.020436793565750122,-0.14593122899532318,0.33752596378326416},{-0.27999353408813477,0.1379648596048355,0.0437590628862381,-0.2626860737800598,0.3535251319408417,-0.2546423673629761,-0.2573666572570801,-0.44426098465919495,-0.09510990232229233,-0.25910672545433044,0.5426462292671204,0.1228414997458458,0.05491909384727478,0.35733264684677124,0.04534231498837471,0.5743495225906372},{0.24504457414150238,0.15330387651920319,-0.1166779175400734,0.005374316591769457,-0.5665373206138611,-0.5479834675788879,0.1637554168701172,-0.5813954472541809,-0.0395287424325943,-0.1047917902469635,0.3108634650707245,-0.5694318413734436,-0.5260912775993347,0.11964301019906998,0.10086961090564728,-0.27604466676712036},{0.5877600908279419,-0.7773309946060181,-0.30042508244514465,0.10107524693012238,0.21400019526481628,-0.283219575881958,-0.14907251298427582,-0.20736539363861084,-0.3420364260673523,0.02854982577264309,-0.3126164674758911,-0.2686300575733185,0.6219508051872253,-0.23330311477184296,-0.6995857357978821,-0.18223299086093903},{0.23418760299682617,0.354871541261673,-0.16576933860778809,0.12175324559211731,0.003370834281668067,-0.22706842422485352,-0.20525354146957397,0.1301378458738327,-0.09457368403673172,0.22724919021129608,0.15464697778224945,0.31018581986427307,-0.12202194333076477,0.23795334994792938,0.00106720719486475,-0.24908828735351562},{-0.3645690381526947,0.21604017913341522,0.49641308188438416,-0.7287985682487488,-0.018137240782380104,0.09635375440120697,0.08183689415454865,0.2971962094306946,0.2987154722213745,0.4225374758243561,0.3808780312538147,-0.22880026698112488,0.2468971610069275,-0.19961364567279816,0.07300787419080734,-0.20954132080078125},{0.1820056289434433,-0.3278220295906067,-0.27762460708618164,0.38300472497940063,-0.22392332553863525,-0.3293803632259369,-0.023942260071635246,0.33311623334884644,0.1354469209909439,-0.11380675435066223,-0.3774493634700775,0.3031546175479889,0.4726630449295044,0.3393852710723877,-0.20453064143657684,0.6509790420532227},{0.24864961206912994,0.2294263392686844,-0.41173040866851807,0.1454884111881256,-0.09553550183773041,-0.20697063207626343,-0.2399977147579193,0.09929441660642624,-0.35544103384017944,-0.4242878258228302,-0.11938293278217316,0.08835132420063019,-0.5981914401054382,-0.05790073424577713,-0.3707025945186615,-0.1201518177986145},{0.10028310120105743,0.5865945219993591,0.4782555103302002,-0.5006513595581055,-0.2858731150627136,0.29621922969818115,-0.05325794219970703,0.05940283089876175,0.5091476440429688,0.3653395473957062,-0.15917162597179413,0.09943979233503342,-0.14222750067710876,-0.36832693219184875,0.16949798166751862,-0.32388585805892944},{-0.34391528367996216,-0.07963403314352036,-0.026388593018054962,0.25481346249580383,-0.06320767104625702,0.03251197189092636,-0.1812313199043274,-0.059206895530223846,-0.3550044596195221,-0.09929018467664719,0.31693345308303833,0.1601349264383316,-0.23013485968112946,-0.25047406554222107,-0.4111670255661011,-0.11919209361076355},{-0.3651895225048065,0.15706171095371246,-0.2722795903682709,0.020819824188947678,-0.11676487326622009,0.32869642972946167,0.36694639921188354,0.16043099761009216,0.26626038551330566,-0.22933520376682281,-0.05696524679660797,-0.1114664226770401,0.016527250409126282,0.0565611869096756,-0.034077975898981094,-0.15313057601451874},{0.1312730759382248,-0.42964527010917664,0.17888721823692322,0.19083426892757416,0.003285354468971491,0.32175755500793457,0.3332771956920624,0.1577284038066864,-0.18502837419509888,-0.25413599610328674,-0.14048342406749725,-0.10128454864025116,-0.14538294076919556,-0.3879184126853943,0.09171842038631439,0.026740368455648422}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.16609826683998108,0.3112969398498535,0.3630151152610779,-0.0867450013756752,-0.23778094351291656,0.0967777892947197,0.052661456167697906,0.27445414662361145,-0.03450814634561539,0.28263354301452637,0.4881439208984375,-0.365325927734375,-0.1022278219461441,0.06810707598924637,0.035676099359989166,-0.05240079388022423},{-0.5585023760795593,0.2340477705001831,-0.2945409417152405,0.24981270730495453,0.36727121472358704,-0.1926598697900772,-0.3553611636161804,-0.2850533425807953,0.3628453314304352,0.2961140275001526,-0.06422439217567444,0.26835283637046814,-0.3592032492160797,0.15646317601203918,-0.24148070812225342,0.46171507239341736},{-0.39734771847724915,0.19999836385250092,-0.3818756937980652,0.019334139302372932,-0.4103470742702484,-0.30582067370414734,-0.12150831520557404,0.004554517101496458,-0.24649202823638916,0.37305909395217896,0.22550846636295319,-0.08131765574216843,0.26283299922943115,-0.35158413648605347,-0.0674375668168068,-0.013631748035550117},{0.2791230380535126,-0.23365578055381775,0.09161711484193802,0.44669434428215027,-0.4393274486064911,-0.42348119616508484,0.2887789309024811,0.1176101565361023,0.28521448373794556,-0.10303562879562378,0.3447461724281311,0.0965079516172409,-0.25807374715805054,-0.02407781220972538,-0.018572159111499786,-0.3682817220687866},{-0.4010072350502014,0.04370024800300598,0.24619974195957184,-0.38225844502449036,0.17899559438228607,0.3550490438938141,-0.31908831000328064,0.20577174425125122,-0.21854467689990997,0.2116079479455948,-0.10280561447143555,-0.0145559161901474,-0.11208626627922058,-0.029091082513332367,-0.19607549905776978,-0.16042420268058777},{0.0043259793892502785,-0.2402278631925583,-0.019596746191382408,-0.3595220148563385,0.2958472967147827,0.0744180977344513,-0.036826033145189285,-0.07693704217672348,-0.21626412868499756,0.37332138419151306,0.2874288558959961,-0.07999886572360992,-0.17773763835430145,0.21646751463413239,-0.058139778673648834,-0.34717491269111633},{0.24412274360656738,-0.12762552499771118,0.3463999032974243,-0.30827391147613525,-0.3619682788848877,-0.03711649402976036,-0.37470734119415283,0.3588351607322693,-0.0900440514087677,-0.23825353384017944,-0.2560652196407318,-0.046156104654073715,-0.024063115939497948,-0.10727325826883316,0.48308467864990234,-0.3701029121875763},{-0.2914973497390747,0.3788980543613434,-0.08234328776597977,0.29368939995765686,0.029309816658496857,-0.26489654183387756,-0.0915093794465065,0.13667111098766327,-0.06824727356433868,0.4898654520511627,0.14860913157463074,-0.2055685967206955,-0.0065146153792738914,-0.07856480032205582,0.036329980939626694,0.14575254917144775},{0.09704352915287018,0.2846122980117798,-0.1717332899570465,-0.34777459502220154,0.3856602609157562,-0.2020263820886612,0.20323534309864044,-0.3563424050807953,0.12455319613218307,0.036311667412519455,0.10647185891866684,0.14291353523731232,-0.030925044789910316,-0.3039882481098175,-0.07291635870933533,0.22547028958797455},{-0.23465889692306519,-0.019571518525481224,-0.32190799713134766,-0.32857558131217957,0.23248067498207092,-0.432809978723526,-0.21173739433288574,0.285532683134079,-0.14650563895702362,0.22982695698738098,-0.05830564722418785,-0.09294603019952774,-0.3610461354255676,-0.0173261146992445,-0.2517428696155548,-0.34620794653892517},{-0.2570103406906128,-0.11670403927564621,-0.08692992478609085,-0.3549019396305084,-0.34895098209381104,-0.03336107358336449,0.12647853791713715,-0.514025092124939,0.012991780415177345,-0.06575505435466766,0.19097048044204712,0.012811445631086826,0.4309071898460388,0.05028253793716431,0.22870665788650513,0.25216159224510193},{-0.18281467258930206,-0.053125686943531036,-0.42841625213623047,0.35573768615722656,0.12366502732038498,-0.05994613468647003,0.18718190491199493,0.09888189285993576,-0.42644408345222473,0.20410782098770142,-0.29818031191825867,-0.15970763564109802,-0.39803412556648254,0.4371505081653595,-0.3636312186717987,0.09603765606880188},{-0.18294726312160492,-0.45132169127464294,-0.1343926042318344,0.1808905154466629,-0.1666998714208603,-0.11166898161172867,-0.10370244085788727,0.4209076464176178,0.4205653667449951,0.10428687930107117,-0.10770819336175919,-0.2638707458972931,0.17932908236980438,-0.3824920356273651,0.13370952010154724,-0.25196248292922974},{-0.27917197346687317,-0.4417415261268616,-0.17830002307891846,-0.0915198102593422,-0.44423091411590576,0.4206923842430115,-0.057292986661195755,0.19860923290252686,-0.16984868049621582,-0.33036720752716064,-0.32063907384872437,0.4144431948661804,-0.23182350397109985,0.07163532823324203,-0.28836876153945923,0.38309982419013977},{-0.3539753258228302,0.3512636423110962,-0.16774365305900574,0.12208382785320282,-0.3882628083229065,0.30837690830230713,0.03261185809969902,-0.3778609037399292,0.11653689295053482,0.19073379039764404,-0.20299656689167023,0.08679428696632385,0.27145251631736755,-0.2525028586387634,-0.3440359830856323,-0.1535990834236145},{-0.14991161227226257,-0.38693881034851074,-0.5350043177604675,0.3168121576309204,-0.0048793405294418335,0.17049731314182281,-0.29317134618759155,0.20251180231571198,-0.44107165932655334,-0.3354419469833374,-0.4160245358943939,0.2590646743774414,-0.23358523845672607,0.19982223212718964,0.10460268706083298,0.2887932062149048}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.05672585591673851,-0.14206035435199738,0.09067848324775696,-0.1503620743751526,-0.09736759215593338,0.11209256201982498,0.17307595908641815,-0.22604312002658844,-0.09021206200122833,0.332731157541275,0.05188682675361633,0.13566727936267853,0.0946338102221489,0.14118002355098724,-0.20616663992404938,0.13759808242321014,0.12311632186174393,-0.3027696907520294,-0.2924463748931885,-0.10668116807937622,-0.19285742938518524,0.15372459590435028,-0.23006151616573334,0.3719956874847412,-0.18629144132137299,-0.01765730232000351,0.1366254985332489,0.1800234317779541,-0.2685493230819702,-0.21929483115673065,0.2685374915599823,0.3106289803981781},{0.16857869923114777,-0.029678184539079666,0.16438114643096924,-0.04907798767089844,-0.1143149584531784,0.20610052347183228,-0.020137760788202286,-0.09937706589698792,-0.03575272113084793,-0.06444177031517029,-0.1094387024641037,0.044389210641384125,0.40138137340545654,0.21664085984230042,0.13651710748672485,0.06488969177007675,-0.26669609546661377,-0.3084369897842407,0.09929171949625015,0.051354698836803436,0.06497777253389359,0.28107067942619324,0.2635398209095001,-0.17185291647911072,0.049497827887535095,0.3076983392238617,-0.34823769330978394,0.21190600097179413,0.13259689509868622,-0.2494562268257141,-0.06412637233734131,-0.030952218919992447},{-0.08181243389844894,-0.04517187550663948,0.13997124135494232,-0.13988961279392242,-0.20785914361476898,-0.017329880967736244,-0.2948840260505676,0.15576820075511932,0.28690198063850403,-0.006649921648204327,-0.23008638620376587,0.128930926322937,0.36947157979011536,-0.22168663144111633,0.07677476108074188,-0.021203748881816864,-0.4167846739292145,0.2010449320077896,-0.40539517998695374,-0.07046262919902802,-0.06261267513036728,-0.07253259420394897,-0.08305343985557556,-0.09125256538391113,-0.0013874712167307734,0.4364224076271057,-0.03730836510658264,0.1326044350862503,0.3011867105960846,-0.43457740545272827,-0.05854545533657074,0.03655453771352768},{0.19194282591342926,-0.26824453473091125,0.02047662064433098,-0.4157279133796692,0.12233635783195496,-0.07035848498344421,-0.04046354815363884,0.2347078174352646,0.058168452233076096,0.2753378450870514,0.012244699522852898,-0.16545061767101288,-0.20531058311462402,-0.0839206650853157,0.26212775707244873,-0.23263129591941833,0.06011158972978592,-0.060570817440748215,-0.16216033697128296,0.10629062354564667,-0.1815607249736786,0.18838617205619812,-0.2370573878288269,0.33066079020500183,-0.30980053544044495,0.011474133469164371,-0.08142674714326859,-0.25734156370162964,-0.014320245012640953,0.057579249143600464,0.23082582652568817,-0.14095903933048248},{0.2670230269432068,-0.01755981147289276,0.05229918658733368,0.2705545723438263,-0.26274770498275757,-0.07677889615297318,0.18328732252120972,-0.014181609265506268,0.09058800339698792,-0.1880122870206833,0.008650804869830608,-0.08489719778299332,-0.1923295110464096,-0.15310008823871613,0.31704792380332947,0.2809734046459198,-0.05763167887926102,-0.328137069940567,0.16226129233837128,-0.11055070906877518,-0.12729765474796295,0.2213238775730133,0.2792801558971405,0.013399101793766022,-0.10992426425218582,-0.1213679239153862,0.007875308394432068,0.2573271691799164,0.2554747760295868,0.11982087790966034,0.11521964520215988,-0.247105672955513},{0.2881312072277069,-0.1727580577135086,0.018005872145295143,0.10022692382335663,-0.16347011923789978,-0.3276280164718628,-0.25236764550209045,-0.3569200336933136,-0.17458461225032806,0.020118584856390953,-0.04954094812273979,0.0077818711288273335,-0.052708469331264496,-0.013517052866518497,-0.2107803374528885,-0.29089170694351196,0.15497872233390808,0.042624376714229584,-0.32280147075653076,0.26551586389541626,-0.10820706933736801,-0.17575432360172272,0.20150138437747955,-0.11274143308401108,-0.14232298731803894,-0.24394413828849792,-0.13275067508220673,0.05434471741318703,0.08217477798461914,0.2321292906999588,-0.3046344816684723,0.14469709992408752},{0.19510000944137573,0.06208408623933792,0.23708325624465942,-0.16187645494937897,0.2449653148651123,-0.18797747790813446,-0.31147632002830505,-0.0205927062779665,0.2958732843399048,0.15319670736789703,-0.1856854408979416,0.12277654558420181,0.0891476646065712,0.32067418098449707,0.12079723179340363,-0.04545564949512482,-0.23036324977874756,0.13962535560131073,-0.018421364948153496,-0.025797130540013313,-0.10864103585481644,0.24965980648994446,0.18335376679897308,0.16131265461444855,-0.316523939371109,-0.23691397905349731,-0.2898353338241577,-0.3497679829597473,0.0327380895614624,-0.11811095476150513,0.30501624941825867,0.13704833388328552},{0.3609260022640228,-0.41026797890663147,0.06794100999832153,-0.45917579531669617,-0.269748717546463,0.351608544588089,0.45127072930336,0.2592579424381256,-0.057605449110269547,0.14560283720493317,0.1646462082862854,-0.1733361929655075,0.030289072543382645,0.2300698161125183,-0.04229093715548515,0.18390534818172455,0.4540451467037201,-0.26814132928848267,-0.08695469796657562,-0.4252247214317322,0.19348618388175964,0.24805425107479095,0.20643965899944305,0.13274544477462769,0.11763861030340195,0.10970282554626465,0.18035510182380676,0.29100358486175537,-0.1125674918293953,-0.25121164321899414,0.26976487040519714,0.12176455557346344},{0.03772028908133507,-0.06099722161889076,0.1858954280614853,0.2853279411792755,-0.23549889028072357,-0.3535204529762268,-0.10822989791631699,0.22231106460094452,-0.17019838094711304,-0.22659505903720856,0.03797132894396782,0.1590942144393921,0.15114977955818176,-0.30661487579345703,0.1364431381225586,-0.15708070993423462,-0.23682327568531036,0.1308363378047943,-0.3016648590564728,0.25820285081863403,-0.32972466945648193,-0.3059026002883911,-0.3257148265838623,0.2031708061695099,0.11197392642498016,0.1312144696712494,0.33456951379776,0.22654996812343597,-0.14301706850528717,-0.3664943277835846,-0.11286236345767975,0.17530955374240875},{0.3626921772956848,0.07662282884120941,0.07066319137811661,0.24083517491817474,0.1005120724439621,0.2753444015979767,-0.02983831986784935,0.27849408984184265,-0.11374171078205109,0.035954900085926056,0.17799365520477295,0.09638609737157822,-0.11680036783218384,-0.39504989981651306,0.2317226529121399,0.2419544905424118,0.012648703530430794,-0.18589100241661072,0.03777856379747391,-0.005207557696849108,0.10221746563911438,-0.34933486580848694,0.41314175724983215,0.012214405462145805,-0.07619829475879669,0.0982450619339943,-0.3905351459980011,-0.14338816702365875,0.07713307440280914,0.056443750858306885,0.10952398926019669,0.23388458788394928},{-0.09252116829156876,0.09792877733707428,-0.08569549024105072,0.20522932708263397,-0.10073070228099823,0.2817399501800537,0.06691185384988785,-0.09876706451177597,0.290756493806839,-0.31072747707366943,-0.1695077121257782,0.1847921907901764,-0.08507870882749557,0.06764202564954758,-0.29941311478614807,0.0448811911046505,0.04754844680428505,0.14866594970226288,0.06393266469240189,-0.13192620873451233,-0.263724684715271,0.18352386355400085,0.23408517241477966,0.21678917109966278,-0.3336043953895569,0.35963869094848633,-0.14368492364883423,0.006367451045662165,-0.1225351020693779,0.11699161678552628,0.23044641315937042,0.2540994882583618},{-0.24508973956108093,0.296854704618454,-0.08644287288188934,0.0037752599455416203,-0.2768300473690033,-0.20793890953063965,0.1452094465494156,-0.33453527092933655,-0.025386763736605644,-0.27780309319496155,-0.19533343613147736,-0.06471623480319977,0.1943100094795227,-0.21248003840446472,-0.13275085389614105,-0.3886938691139221,-0.1731296181678772,0.006310748867690563,0.29781702160835266,-0.24170568585395813,0.07713563740253448,-0.16081461310386658,0.0013971097068861127,0.2909650206565857,-0.10421860963106155,0.14574302732944489,0.2756451368331909,-0.14945997297763824,-0.09036877751350403,0.2810777425765991,-0.2194502204656601,-0.3585668206214905},{-0.04449960216879845,0.2607056200504303,0.26136794686317444,-0.31552934646606445,0.3057157099246979,0.018686093389987946,-0.1184367835521698,-0.005147264339029789,0.10877184569835663,-0.3106725215911865,-0.03479848802089691,0.03987126052379608,0.19651609659194946,0.03611791506409645,0.016228575259447098,-0.01651070825755596,0.22128163278102875,-0.31054389476776123,0.34275704622268677,0.05985289812088013,-0.1607513576745987,0.15632164478302002,-0.08920918405056,-0.2418331354856491,0.2430884838104248,-0.07690154016017914,-0.0086949672549963,-0.10690637677907944,0.06389691680669785,-0.11866970360279083,0.3084013760089874,0.2889907956123352},{0.07377089560031891,-0.24050867557525635,-0.20230704545974731,0.06406234204769135,0.050326958298683167,0.2810332179069519,-0.12282297760248184,-0.2800299823284149,0.3424239158630371,0.06992022693157196,0.011773930862545967,0.03411424532532692,-0.18496505916118622,0.12046770006418228,-0.20844659209251404,-0.31309086084365845,0.062231920659542084,0.019825424998998642,0.1720135658979416,0.3769952058792114,-0.24631187319755554,0.158782497048378,-0.16976240277290344,0.08653341233730316,0.06641172617673874,-0.3008731007575989,-0.14852602779865265,-0.2995623052120209,-0.1205008253455162,-0.14968940615653992,0.21457429230213165,-0.3530503511428833},{-0.08078087121248245,0.3269401490688324,0.11111938208341599,-0.19841080904006958,-0.15341541171073914,-0.23586729168891907,0.14701305329799652,-0.08355247229337692,0.2617780566215515,-0.05064528435468674,0.24272726476192474,0.19508467614650726,-0.010430574417114258,0.0722850039601326,-0.18328072130680084,0.18677450716495514,-0.1971093863248825,-0.4030812382698059,-0.3035901188850403,0.09754066169261932,0.14495748281478882,-0.2707987129688263,-0.35346874594688416,-0.24592967331409454,-0.17901669442653656,0.10991933941841125,0.40201637148857117,0.013289904221892357,-0.12331734597682953,0.042337629944086075,-0.11485020816326141,0.13279205560684204},{-0.20791080594062805,-0.17482885718345642,-0.24096539616584778,0.09147033095359802,-0.29852214455604553,-0.13850164413452148,-0.1355341672897339,-0.17015378177165985,-0.29430118203163147,-0.19857937097549438,0.10713250935077667,0.1897575706243515,-0.2385074645280838,0.28043073415756226,-0.019647963345050812,0.18373002111911774,0.011232723481953144,0.018603544682264328,0.032919883728027344,0.14497336745262146,0.14022696018218994,0.32656311988830566,0.09541352093219757,0.2320777326822281,0.09947864711284637,-0.24408428370952606,-0.1449810266494751,0.2396959811449051,-0.04994918778538704,-0.21572130918502808,-0.15968164801597595,-0.22431787848472595},{-0.3173902928829193,-0.20686650276184082,-0.3895220458507538,0.0994882732629776,-0.14812293648719788,-0.10322029143571854,-0.16097350418567657,0.039967454969882965,-0.027107631787657738,0.07676472514867783,-0.2538903057575226,0.03091316856443882,0.17813023924827576,-0.03790636733174324,0.029736755415797234,0.17058037221431732,-0.15932632982730865,-0.1047210767865181,0.14744432270526886,0.11849984526634216,0.19665198028087616,0.014851309359073639,-0.2743988633155823,0.06309162080287933,0.24728168547153473,-0.28578001260757446,0.1646513193845749,-0.00895115826278925,0.05730297788977623,-0.16339167952537537,0.19034527242183685,-0.107247494161129},{0.2713208496570587,-0.06326425820589066,0.04952477291226387,0.09786974638700485,-0.2771528959274292,0.007541457191109657,0.17056304216384888,0.23382264375686646,-0.08354276418685913,-0.09595683217048645,0.2995625436306,-0.20037779211997986,-0.028156228363513947,-0.08197414129972458,-0.14788609743118286,0.2150402069091797,0.029434343799948692,-0.06937628984451294,0.133395254611969,-0.2888444662094116,0.03480686992406845,-0.30798277258872986,-0.2351493537425995,0.2600872218608856,-0.13813015818595886,-0.13779638707637787,0.1690458208322525,-0.011748996563255787,-0.1629306823015213,-0.002677963115274906,-0.10023840516805649,-0.01884029619395733},{0.3152464032173157,-0.056980762630701065,0.09023340046405792,0.07789849489927292,-0.005851613357663155,-0.09748801589012146,0.1553388386964798,-0.24132812023162842,0.21317125856876373,0.28748053312301636,0.004365915898233652,0.16730932891368866,0.26729816198349,0.3390960395336151,-0.285830020904541,-0.2988952398300171,-0.30596083402633667,0.05537373200058937,-0.14390815794467926,-0.2841297388076782,-0.20262394845485687,0.29940441250801086,0.08067880570888519,0.14824646711349487,-0.14725004136562347,-0.0954582691192627,-0.1636105328798294,-0.2018747627735138,0.25614580512046814,0.17726804316043854,-0.27748459577560425,-0.1618729829788208},{-0.12246450036764145,0.1294006109237671,0.26705124974250793,-0.08630093932151794,-0.03502046316862106,0.051976002752780914,-0.004636939615011215,-0.3186280131340027,0.2222270518541336,0.2615813612937927,0.1591900885105133,0.19369889795780182,-0.25460872054100037,0.19641870260238647,-0.2984602153301239,0.25710344314575195,0.17649506032466888,-0.21907272934913635,0.23933908343315125,0.141027569770813,-0.3048989474773407,0.3073393702507019,-0.3351564407348633,0.14258018136024475,0.20990946888923645,0.22023165225982666,0.11546401679515839,0.07709673792123795,-0.20031480491161346,0.2320789396762848,-0.09674299508333206,0.11137760430574417},{-0.17124269902706146,-0.05134015157818794,-0.010923086665570736,0.25264570116996765,-0.046553876250982285,0.15883521735668182,-0.3668031096458435,-0.21236436069011688,-0.15308338403701782,-0.1365545690059662,-0.17490556836128235,-0.10579707473516464,0.09349076449871063,-0.09224716573953629,0.09603603184223175,-0.2018013596534729,0.1520339399576187,-0.017395272850990295,-0.3288443386554718,-0.21111264824867249,0.09717144817113876,0.20448358356952667,-0.19919413328170776,0.3143087923526764,-0.23122960329055786,0.10313663631677628,0.1113777905702591,-0.10042754560709,0.11600512266159058,-0.26493385434150696,0.3242524266242981,0.055832162499427795},{0.36115458607673645,-0.07385370880365372,0.08666350692510605,0.15190692245960236,-0.15485988557338715,0.24997541308403015,-0.013187575154006481,0.24926315248012543,0.15187957882881165,0.12994301319122314,0.030969511717557907,-0.41983771324157715,-0.2753307819366455,-0.056361034512519836,0.07499329745769501,-0.13491126894950867,0.3242042064666748,0.23911885917186737,-0.20032182335853577,-0.19735267758369446,0.2744283974170685,0.2825590670108795,0.27201059460639954,0.17358280718326569,-0.08020275086164474,-0.052098896354436874,-0.08945026248693466,-0.23826198279857635,0.21051257848739624,0.10361023247241974,-0.20400218665599823,0.11351263523101807},{-0.025671163573861122,0.011683762073516846,-0.07837465405464172,-0.2653394937515259,-0.10781724750995636,-0.24522481858730316,-0.2233724743127823,-0.16909897327423096,0.02945077233016491,-0.007641906384378672,-0.2720688581466675,0.011951053515076637,-0.2530333399772644,-0.1671692281961441,-0.006588743533939123,0.07124383002519608,0.2865537106990814,-0.1709667444229126,-0.35368210077285767,0.271121621131897,-0.1554720550775528,0.26105332374572754,-0.030405662953853607,-0.04643876478075981,0.05513475090265274,0.12452518939971924,-0.0447634756565094,-0.287905752658844,0.22377996146678925,0.24603550136089325,-0.1572054922580719,0.20661194622516632},{-0.2453061044216156,-0.00017973920330405235,0.08153465390205383,0.005336802452802658,0.07542360574007034,0.12577222287654877,-0.17016936838626862,0.1212494745850563,-0.2409130185842514,-0.20240908861160278,0.13486503064632416,-0.13007749617099762,-0.18026092648506165,0.23834648728370667,0.04319438338279724,0.030432581901550293,0.19173984229564667,-0.26709073781967163,-0.12527821958065033,0.25681591033935547,0.03375399112701416,0.2030273973941803,0.02214650623500347,0.012620927765965462,-0.30315735936164856,-0.1542980968952179,-0.013131733983755112,0.3251318335533142,0.010322468355298042,0.020811844617128372,0.27635133266448975,0.29032641649246216}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.06783317774534225,0.21266011893749237,0.4585718512535095,-0.08707013726234436},{0.05421574041247368,-0.16305950284004211,0.0064958566799759865,0.31323882937431335},{-0.1314162164926529,0.128431037068367,0.15755322575569153,0.12096096575260162},{0.3584303855895996,0.05576390400528908,0.039078760892152786,0.552391529083252},{-0.07476687431335449,0.09895742684602737,0.34442219138145447,0.030231744050979614},{-0.15810330212116241,0.25392505526542664,0.28442656993865967,-0.07178010791540146},{-0.41872715950012207,-0.06337030977010727,0.1141119971871376,-0.17159703373908997},{-0.4053554832935333,-0.16102468967437744,0.49384695291519165,-0.306509792804718},{0.335013210773468,-0.15074248611927032,-0.3045634329319,-0.4304800033569336},{0.08359679579734802,0.35925137996673584,0.37060028314590454,-0.5323054790496826},{-0.2861054837703705,-0.24207958579063416,-0.07539314031600952,0.12193414568901062},{0.48059800267219543,-0.21992982923984528,-0.07893572002649307,0.23726871609687805},{0.3114011585712433,0.2691859304904938,-0.07354606688022614,0.15496738255023956},{4.589417585521005e-05,0.05094946175813675,-0.3115522563457489,0.0547429695725441},{0.09260078519582748,0.28992903232574463,0.4466588795185089,0.34983202815055847},{0.147361159324646,-0.023242224007844925,0.31539610028266907,0.28292256593704224},{-0.3248129189014435,-0.1021958515048027,-0.07501263916492462,-0.31676438450813293},{-0.13415774703025818,0.19298768043518066,-0.16919544339179993,-0.09917855262756348},{-0.3983381390571594,0.19681929051876068,0.18933773040771484,0.43307986855506897},{-0.015971491113305092,0.3615706264972687,-0.21483221650123596,0.1908062994480133},{-0.30893152952194214,-0.3972274363040924,-0.11998607218265533,0.037229496985673904},{0.36626312136650085,0.4903346300125122,0.024629484862089157,-0.33589228987693787},{-0.016964754089713097,0.2133895605802536,0.24303753674030304,0.23423020541667938},{-0.058851879090070724,0.4527871906757355,-0.05961637943983078,-0.23447690904140472},{-0.010803106240928173,-0.10306886583566666,-0.12797167897224426,0.0007324971375055611},{0.3661418855190277,-0.4882642924785614,-0.041699063032865524,0.005007973872125149},{-0.04039160534739494,-0.41408872604370117,-0.19808430969715118,-0.3177468180656433},{0.16173040866851807,-0.22894471883773804,0.25179967284202576,0.16653475165367126},{0.03862737491726875,-0.05357486754655838,0.0557086281478405,0.052503593266010284},{-0.48391076922416687,0.42456066608428955,0.21589051187038422,-0.006720131728798151},{0.3710259795188904,-0.16869083046913147,0.22930142283439636,-0.0567673034965992},{0.13760368525981903,-0.4489697217941284,0.44227129220962524,-0.29323965311050415}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05248254910111427,-0.014817412942647934,0.015934310853481293,0.03606531769037247,-0.08193641901016235,-0.08757995069026947,0.0050565507262945175,0.04565591737627983,0.08916722983121872,-0.005905271973460913,-0.0464988648891449,-0.014469188638031483,0.04352015629410744,-0.009254383854568005,-0.05185190960764885,-0.024316102266311646};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.025647981092333794,0.007317576091736555,-0.0004137415671721101,0.008184571750462055,0.014566773548722267,-0.013565138913691044,0.02933976985514164,0.015317174606025219,0.01095704548060894,0.02135961502790451,0.037194669246673584,-4.947968591295648e-06,0.047073010355234146,-0.03708307445049286,-0.034162960946559906,0.0004498136986512691};
static const float actor_encoder_feed_forward_0_bias[32] = {0.003815185511484742,0.012150638736784458,0.019324446097016335,0.0032015859615057707,0.009786729700863361,0.0027018808759748936,0.011988825164735317,0.015561480075120926,-0.04279511421918869,-0.01922544836997986,0.016171667724847794,0.007373997010290623,0.00609713327139616,0.014492634683847427,-0.004393042530864477,0.03461229056119919,0.0002705489459913224,-0.013436537235975266,0.018330564722418785,-0.010587443597614765,-0.012462087906897068,-0.009328612126410007,0.04390978813171387,0.010421947576105595,0.0037326826713979244,0.021302929148077965,-0.026065433397889137,0.03522176295518875,-0.005680902861058712,0.010306012816727161,0.014441507868468761,-0.002468358026817441};
static const float action_parameterization_distribution_linear_bias[4] = {-0.01370064914226532,-0.014843576587736607,-0.003813388291746378,0.011490168049931526};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.06486161798238754,0.24560672044754028,-0.17513155937194824,0.21331787109375,0.09015728533267975,0.05125770717859268,0.368938148021698,-0.05405903607606888},{-0.25002965331077576,-0.031353093683719635,-0.30515632033348083,-0.2008361965417862,-0.4039509892463684,-0.26022452116012573,-0.013737766072154045,-0.2546122074127197},{-0.2606452405452728,0.03262836113572121,0.22645895183086395,0.2648225426673889,0.22675371170043945,-0.04630959406495094,0.3845043480396271,-0.17656607925891876},{0.027058053761720657,0.10794910043478012,-0.1845175176858902,0.027972210198640823,0.004004115238785744,-0.06990749388933182,0.34798428416252136,-0.25763368606567383},{-0.2940444052219391,-0.12213076651096344,-0.23701581358909607,-0.10855264961719513,-0.03888173773884773,0.1691364049911499,0.19139982759952545,-0.06617795675992966},{-0.31054040789604187,-0.027771299704909325,0.3895411491394043,0.25974512100219727,0.1707165241241455,-0.11756327748298645,-0.12755388021469116,-0.15677163004875183},{-0.2598273456096649,0.015495146624743938,0.42051613330841064,-0.1851038634777069,-0.1218380257487297,-0.4163224399089813,-0.10942862927913666,-0.11236478388309479},{-0.2656450867652893,-0.3434204161167145,0.49775487184524536,-0.08774358779191971,-0.1603187769651413,0.26262667775154114,0.17610397934913635,-0.2424483448266983},{-0.3707314729690552,0.3034553825855255,-0.16522040963172913,0.35913944244384766,0.15393978357315063,-0.2813923954963684,0.0002907872258219868,0.13619370758533478},{-0.413956880569458,-0.30945318937301636,-0.14204584062099457,-0.2048744410276413,-0.5066596865653992,0.14531457424163818,-0.053456611931324005,0.17980104684829712},{0.07560180872678757,0.34401190280914307,0.21563664078712463,-0.01714366488158703,0.2084319144487381,0.15716063976287842,-0.22018595039844513,0.23975622653961182},{0.12322238087654114,0.02724473737180233,0.26005586981773376,0.26327604055404663,-0.32524433732032776,0.29780012369155884,-0.015822365880012512,-0.21178919076919556},{0.05041256919503212,-0.33677923679351807,0.2580479681491852,-0.04447837918996811,-0.3822636008262634,-0.08504144102334976,-0.1897100806236267,-0.09839413315057755},{-0.251370370388031,-0.2631780505180359,0.3228779137134552,0.3538873791694641,-0.2657633125782013,-0.06991638243198395,-0.3099351227283478,0.24676579236984253},{0.055480509996414185,-0.17179827392101288,0.13329064846038818,-0.22639816999435425,-0.2852816581726074,-0.12450064718723297,0.24590885639190674,0.01426629163324833},{0.18147720396518707,-0.02620122767984867,0.021025527268648148,-0.231086865067482,0.06111384183168411,0.06436513364315033,0.13092753291130066,0.3778490722179413},{-0.023493647575378418,-0.3020009398460388,-0.17399363219738007,0.12995781004428864,-0.21467049419879913,-0.1470252275466919,-0.1301475614309311,0.1295187920331955},{-0.17695459723472595,-0.3310767114162445,0.019719945266842842,0.060465067625045776,0.11604682356119156,-0.19796279072761536,0.32925689220428467,0.19093085825443268},{0.004230063874274492,0.08490551263093948,-0.2728461027145386,0.1354808211326599,0.10790518671274185,0.19048723578453064,-0.2541023790836334,0.38515353202819824},{0.12276563793420792,-0.04154181107878685,-0.3871142566204071,0.11050140112638474,-0.05403755605220795,-0.028100131079554558,-0.3336559236049652,0.01983666606247425},{0.061517395079135895,-0.12701666355133057,0.047022800892591476,-0.08030269294977188,0.3478832542896271,0.05270225182175636,-0.025149380788207054,0.41302698850631714},{0.008955414406955242,0.12698236107826233,-0.2732359766960144,0.3159807324409485,0.3716968894004822,0.34444209933280945,0.22027473151683807,-0.32288262248039246},{-0.460949182510376,-0.13684089481830597,0.15415844321250916,-0.03109607845544815,0.2155645489692688,-0.2835298776626587,0.2784142792224884,-0.2896515429019928},{-0.2531714141368866,0.008932255208492279,-0.08001678436994553,-0.3547685146331787,0.2173106074333191,-0.012223071418702602,-0.28931131958961487,0.17363478243350983},{-0.33225733041763306,-0.19744208455085754,0.0003983153437729925,0.05819080397486687,-0.10175934433937073,0.12767527997493744,0.33947229385375977,-0.128253772854805},{-0.30840834975242615,0.05321350321173668,-0.3928349018096924,-0.32079705595970154,0.165267214179039,0.031835347414016724,-0.06143483519554138,0.07377499341964722},{0.2466469556093216,0.381865531206131,-0.31706708669662476,0.1643701195716858,0.22510778903961182,0.3981648087501526,-0.2768247723579407,-0.13517338037490845},{0.2841648459434509,0.249522402882576,0.03435676172375679,0.061226699501276016,0.2931838929653168,0.20992159843444824,0.2801080346107483,0.3779657781124115},{-0.22982774674892426,0.3885597586631775,0.14804689586162567,0.0003439083811827004,0.22282202541828156,0.053371842950582504,-0.309771329164505,-0.30382996797561646},{-0.3123007118701935,-0.21621735394001007,0.07228678464889526,-0.26030221581459045,-0.3104306757450104,-0.16591937839984894,0.3581444323062897,-0.07429172098636627},{0.2818896472454071,-0.24247923493385315,0.33792707324028015,-0.32171952724456787,0.013024949468672276,0.22482702136039734,0.25107115507125854,-0.2781526744365692},{0.09688781201839447,0.387401819229126,0.389892578125,-0.25534236431121826,-0.2852447032928467,0.03947139158844948,0.25577646493911743,0.049153104424476624}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.005043754354119301,0.46681591868400574,-0.18654456734657288,0.2111511528491974,-0.4175550639629364,0.31730321049690247,0.32472845911979675,0.0742073804140091},{-0.4969627559185028,-0.4180203974246979,-0.3720152676105499,-0.419403076171875,-0.47321730852127075,0.47755536437034607,0.3781990110874176,-0.4039631187915802},{0.10042276233434677,-0.18532903492450714,0.15222659707069397,0.16138532757759094,-0.025981899350881577,0.4602932929992676,-0.3237941265106201,-0.4680749475955963},{0.47475072741508484,-0.032682474702596664,0.1940421313047409,0.0396745391190052,0.49786531925201416,0.4274742007255554,0.5233033299446106,0.3337062895298004},{0.08728979527950287,0.20755794644355774,-0.1853673756122589,-0.31400564312934875,0.061799708753824234,-0.5037728548049927,-0.5184211730957031,0.6220456957817078},{0.43463823199272156,0.07128752022981644,0.016372639685869217,-0.37257033586502075,-0.47257381677627563,-0.5102300047874451,-0.1267809271812439,0.44466039538383484},{-0.4784981608390808,-0.34998831152915955,-0.10196860879659653,-0.2594274878501892,-0.016326410695910454,0.5235015153884888,-0.5403528809547424,0.5386986136436462},{0.2610926628112793,0.07828514277935028,-0.01446855254471302,0.0814882218837738,0.4376528263092041,-0.5728941559791565,0.42897918820381165,-0.38425034284591675}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09063903242349625,0.0171674694865942,0.029783515259623528,-0.015419786795973778,-0.043558020144701004,0.025739125907421112,0.0005447701551020145,0.006060459651052952};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012544164434075356,-0.009659712202847004,-0.02984859235584736,0.031005674973130226,-0.011476901359856129,-0.0067164115607738495,0.02748962678015232,-0.05318153649568558};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

