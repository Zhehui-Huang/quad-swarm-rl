#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2883279621601105,-0.027825122699141502,-0.09065420925617218,0.32541361451148987,0.262104868888855,-0.2789074182510376,-0.3841327428817749,0.079963319003582,0.28660646080970764,-0.3167797923088074,0.4810282289981842,-0.03211755305528641,0.24504823982715607,0.1575794667005539,-0.42411550879478455,0.06310415267944336},{-0.2864192724227905,-0.24105344712734222,-0.27880287170410156,-0.20843277871608734,0.13050758838653564,0.29162412881851196,0.11616262048482895,0.08993937820196152,0.16722019016742706,0.1695336401462555,-0.12358872592449188,-0.002113817958161235,-0.10725001245737076,0.11025301367044449,0.31510454416275024,-0.23952782154083252},{0.13345664739608765,0.2828322947025299,0.23074281215667725,0.3086163103580475,-0.09345483779907227,-0.19841837882995605,0.38879093527793884,-0.04557850584387779,0.04451264068484306,-0.015012726187705994,-0.09885486215353012,-0.006398783065378666,0.046677783131599426,0.38046878576278687,-0.2848728597164154,-0.14883914589881897},{0.20154796540737152,-0.22629569470882416,-0.07322807610034943,-0.11503725498914719,0.05991794914007187,0.07562848180532455,0.08428316563367844,-0.20828105509281158,-0.1912008821964264,0.12479257583618164,0.4459499418735504,-0.22737939655780792,-0.186776265501976,-0.13170471787452698,0.19270522892475128,0.09537561982870102},{-0.301893025636673,-0.045540738850831985,0.11685990542173386,-0.1944180130958557,0.2395125925540924,0.2983517646789551,0.13823555409908295,-0.24801050126552582,-0.213148832321167,0.12998664379119873,-0.097449392080307,-0.374347984790802,-0.0798911452293396,-0.19596555829048157,0.2576659321784973,-0.04192771762609482},{0.011963422410190105,-0.04745776578783989,-0.03819375857710838,-0.12673136591911316,0.11421779543161392,-0.1873195916414261,0.41444534063339233,-0.3265085220336914,-0.1509048342704773,-0.15903708338737488,0.36066702008247375,0.12660983204841614,0.24855831265449524,0.03950267657637596,0.30083146691322327,0.28600913286209106},{-0.2526482045650482,0.18366090953350067,-0.07140577584505081,0.0623159296810627,-0.27703171968460083,-0.11758128553628922,-0.14932683110237122,-0.017848994582891464,0.16405554115772247,0.32586830854415894,-0.3295072913169861,-0.09430088102817535,0.23297744989395142,0.09830593317747116,-0.22483229637145996,0.35888227820396423},{-0.06056470423936844,-0.09749322384595871,-0.05515826866030693,-0.060210876166820526,0.3167184293270111,-0.16273081302642822,-0.20579387247562408,-0.3616947829723358,-0.17390865087509155,-0.28950393199920654,0.3677729666233063,-0.016722045838832855,0.21071812510490417,0.08808338642120361,-0.16581182181835175,0.3329201638698578},{0.2429422289133072,0.10088635236024857,0.08137303590774536,0.032256729900836945,-0.3126000761985779,-0.43841373920440674,0.2882155179977417,-0.3658941388130188,-0.2056053727865219,0.19487428665161133,0.11025349050760269,-0.33648547530174255,-0.1853942722082138,0.1708543449640274,0.22349385917186737,-0.008581847883760929},{0.3424631953239441,-0.4872559905052185,-0.17507869005203247,-0.13212907314300537,0.24408628046512604,-0.33673256635665894,-0.3127211928367615,-0.2643016278743744,-0.16531001031398773,0.05226144194602966,-0.08681478351354599,-0.16879144310951233,0.3851148784160614,-0.016641534864902496,-0.43735963106155396,-0.03451750800013542},{0.2126954346895218,0.1926291584968567,-0.25403836369514465,0.14719969034194946,-0.04593478888273239,-0.28601905703544617,-0.174838587641716,0.12232405692338943,-0.20971210300922394,0.17548887431621552,0.08882822841405869,0.3166658580303192,-0.15512296557426453,0.31747007369995117,-0.1068425104022026,-0.1620779037475586},{-0.48774296045303345,0.26583608984947205,0.2372407764196396,-0.33797502517700195,-0.4245425760746002,0.24669043719768524,-0.07397877424955368,0.25268295407295227,0.1590552181005478,0.24877506494522095,0.32811427116394043,0.014877263456583023,-0.033162232488393784,-0.09155073761940002,-0.13386867940425873,-0.13729895651340485},{0.16809840500354767,-0.28444668650627136,-0.18633368611335754,0.2999078929424286,-0.19880275428295135,-0.325992226600647,-0.17186880111694336,0.31392723321914673,0.22592192888259888,-0.16747581958770752,-0.203897163271904,0.17119866609573364,0.3454488217830658,0.15411870181560516,-0.17884448170661926,0.4198205769062042},{0.32379618287086487,0.16159634292125702,-0.20534946024417877,-0.05518518015742302,0.1682434231042862,-0.17291294038295746,-0.07515694200992584,0.2459774911403656,-0.3058059811592102,-0.2257561981678009,-0.14267055690288544,0.016100134700536728,-0.28477242588996887,-0.11439494788646698,-0.3030027151107788,-0.06011798977851868},{0.15728704631328583,0.3887569010257721,0.43797874450683594,-0.42479172348976135,-0.3808494806289673,0.08812594413757324,0.09326896071434021,-0.03123973309993744,0.3604682683944702,0.33565205335617065,-0.21778245270252228,0.11815214902162552,0.007850611582398415,-0.29827603697776794,0.03882014378905296,-0.0896492749452591},{-0.22148548066616058,-0.18499599397182465,-0.126450777053833,0.35551273822784424,-0.20738644897937775,-0.10049956291913986,-0.25527703762054443,-0.22931888699531555,-0.5585413575172424,-0.18816398084163666,0.38747933506965637,0.3216593861579895,-0.5846737623214722,-0.3510350286960602,-0.5826637744903564,-0.12282408773899078},{-0.49005118012428284,0.1638520061969757,-0.39776328206062317,-0.04087567701935768,-0.3893720805644989,0.24770666658878326,0.4816301763057709,0.1305423229932785,0.40842053294181824,-0.40126052498817444,0.09891553223133087,-0.3131060004234314,-0.12476103007793427,-0.004314271733164787,-0.16907043755054474,-0.1811264455318451},{0.20431183278560638,-0.5356233716011047,0.24744902551174164,0.304348349571228,-0.1127895787358284,0.46387460827827454,0.28726768493652344,0.21894584596157074,-0.15653447806835175,-0.3216499388217926,-0.1192011684179306,-0.10061769932508469,-0.12164432555437088,-0.4177114963531494,0.13800807297229767,0.009002503007650375}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05747805908322334,0.28763484954833984,0.24964898824691772,-0.11490000039339066,-0.25590890645980835,0.0929466113448143,-0.03525390103459358,0.35722479224205017,-0.10504395514726639,0.3141440153121948,0.4543476998806,-0.3864361345767975,-0.021338848397135735,0.0331295020878315,0.025506990030407906,-0.13865916430950165},{-0.47357770800590515,0.21437577903270721,-0.23939812183380127,0.28704994916915894,0.2835714519023895,-0.24501082301139832,-0.3195667266845703,-0.21388359367847443,0.34974220395088196,0.27384957671165466,-0.036704741418361664,0.25337982177734375,-0.405728280544281,0.18693387508392334,-0.2589694857597351,0.4649728238582611},{-0.3443148136138916,0.16282378137111664,-0.3714904189109802,0.12413278967142105,-0.41483914852142334,-0.3340783417224884,0.06681833416223526,0.05779469013214111,-0.2513599991798401,0.4239007830619812,0.27114081382751465,-0.16639921069145203,0.20219740271568298,-0.30379143357276917,-0.17499975860118866,-0.06618829816579819},{0.3562777638435364,-0.2493358999490738,0.11663854867219925,0.4153083860874176,-0.4239053726196289,-0.2988835871219635,0.2837880849838257,0.058787751942873,0.30412596464157104,-0.08090448379516602,0.34040582180023193,0.10944260656833649,-0.2307579517364502,-0.027706142514944077,0.010531741194427013,-0.44048476219177246},{-0.36781081557273865,-0.04673398658633232,0.20780298113822937,-0.29886311292648315,0.16127656400203705,0.46677497029304504,-0.25377291440963745,0.29407164454460144,-0.22153325378894806,0.2002648115158081,-0.015599980019032955,-0.009645276702940464,-0.21624493598937988,0.00291380169801414,-0.2505130171775818,-0.14259055256843567},{0.0918145701289177,-0.3059621751308441,0.018140768632292747,-0.34583234786987305,0.2477761059999466,0.04087255895137787,-0.1369323432445526,-0.1035262942314148,-0.13412952423095703,0.37512946128845215,0.25001224875450134,-0.01793486252427101,-0.2815667986869812,0.1299334168434143,0.025432391092181206,-0.2775401771068573},{0.26868897676467896,-0.14909206330776215,0.3543239235877991,-0.28055447340011597,-0.3880678415298462,-0.0956546813249588,-0.36885297298431396,0.33549779653549194,-0.08565913140773773,-0.25076812505722046,-0.2220228761434555,-0.012241289019584656,-0.04795949161052704,-0.1098242923617363,0.4880189001560211,-0.35091206431388855},{-0.3002461791038513,0.3767510950565338,-0.09192793816328049,0.2230650633573532,-0.02869860827922821,-0.18936288356781006,-0.1768292486667633,0.07701189070940018,-0.007339279167354107,0.4832623302936554,0.10672399401664734,-0.10135385394096375,0.0026160485576838255,-0.15236783027648926,0.09421484172344208,0.22338934242725372},{0.07361119985580444,0.2594132721424103,-0.1758628785610199,-0.35402193665504456,0.34967318177223206,-0.21373090147972107,0.10664577782154083,-0.30878087878227234,0.1786818951368332,0.12025690823793411,0.08081202954053879,0.15323251485824585,0.03037872351706028,-0.4550684988498688,-0.018306029960513115,0.21328409016132355},{-0.2980913519859314,0.059024155139923096,-0.3269118368625641,-0.3618321716785431,0.22189849615097046,-0.42027413845062256,-0.17644003033638,0.29146239161491394,-0.18078964948654175,0.15899896621704102,-0.03929388150572777,-0.09996360540390015,-0.3855193853378296,0.08277326822280884,-0.2749091386795044,-0.29679518938064575},{-0.14618514478206635,-0.12525182962417603,-0.004463834222406149,-0.254013329744339,-0.29770803451538086,-0.05478442832827568,0.18362264335155487,-0.43813595175743103,-0.004713446367532015,-0.09500811249017715,0.265708863735199,-0.09083526581525803,0.3492256999015808,0.17203934490680695,0.216310515999794,0.20149989426136017},{-0.10180781781673431,-0.01795804314315319,-0.4043876528739929,0.2809697389602661,0.1312820017337799,0.08507157862186432,0.2137630730867386,0.13189904391765594,-0.40944215655326843,0.19390654563903809,-0.33298900723457336,-0.18464311957359314,-0.35103467106819153,0.37872111797332764,-0.3382291793823242,0.10436797887086868},{-0.23680752515792847,-0.4888235926628113,-0.1567154973745346,0.18401923775672913,-0.2126946896314621,-0.037691641598939896,-0.07898689806461334,0.41026929020881653,0.4789394438266754,0.1444109082221985,-0.03642835468053818,-0.1997058093547821,0.1705484837293625,-0.39530301094055176,0.10211566090583801,-0.2044380009174347},{-0.32062414288520813,-0.4250407814979553,-0.20176440477371216,-0.15757958590984344,-0.4456750750541687,0.5134034156799316,-0.15526005625724792,0.21232090890407562,-0.11091704666614532,-0.23596136271953583,-0.3533501923084259,0.45088738203048706,-0.18636161088943481,-0.07668386399745941,-0.27966129779815674,0.3731388747692108},{-0.40557628870010376,0.32002297043800354,-0.22523821890354156,0.12151385843753815,-0.40862882137298584,0.2287735939025879,-0.11454707384109497,-0.2699073255062103,0.1410476118326187,0.27364736795425415,-0.2769835293292999,0.06629662960767746,0.2307368367910385,-0.4041879177093506,-0.3257032036781311,-0.1679883748292923},{-0.11570588499307632,-0.38874778151512146,-0.4552801847457886,0.26158466935157776,0.053342416882514954,0.08161742985248566,-0.2668015956878662,0.2448035180568695,-0.3515305519104004,-0.2760542333126068,-0.30235517024993896,0.21913474798202515,-0.17652224004268646,0.1376868635416031,0.10077541321516037,0.2570413649082184}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1226818785071373,-0.07719703018665314,0.10583165287971497,-0.17383499443531036,-0.13104717433452606,0.10046053677797318,0.20518358051776886,-0.22419068217277527,-0.12639452517032623,0.28425052762031555,0.1259412169456482,0.13133201003074646,0.07977444678544998,0.19029070436954498,-0.20507210493087769,0.11619764566421509,0.15220940113067627,-0.3225333094596863,-0.2672528624534607,-0.10350104421377182,-0.1346178948879242,0.10363896191120148,-0.24108503758907318,0.30898401141166687,-0.09070949256420135,-0.014499152079224586,0.16365352272987366,0.1732286810874939,-0.275820791721344,-0.20997066795825958,0.20297779142856598,0.2937633693218231},{0.2308141440153122,-0.062320005148649216,0.15967029333114624,-0.09684816747903824,-0.12741896510124207,0.2582412362098694,-0.003521781414747238,-0.06906485557556152,-0.04952649027109146,-0.014112722128629684,-0.12089047580957413,0.0021135874558240175,0.3951530456542969,0.1934475153684616,0.14317059516906738,0.08157775551080704,-0.2543472647666931,-0.3372263014316559,0.11718456447124481,0.041535086929798126,0.05673213675618172,0.30329635739326477,0.20340579748153687,-0.22926999628543854,0.07465460151433945,0.2770688533782959,-0.2919044494628906,0.17661075294017792,0.1330358237028122,-0.22023582458496094,-0.0502985380589962,-0.026113275438547134},{-0.12443327903747559,-0.0650985911488533,0.21309834718704224,-0.22326409816741943,-0.2523924708366394,0.0009764099959284067,-0.18875598907470703,0.19755791127681732,0.20992721617221832,-0.02403269335627556,-0.14246676862239838,0.032751020044088364,0.303523451089859,-0.16656044125556946,0.0695522129535675,-0.07482542097568512,-0.3258455693721771,0.277972549200058,-0.3292838931083679,-0.01653154566884041,-0.015381836332380772,-0.11214334517717361,-0.09070412069559097,-0.09211127460002899,0.033845510333776474,0.3498038053512573,-0.028642987832427025,0.04869147762656212,0.2233649492263794,-0.33451756834983826,-0.18863871693611145,-0.03651367500424385},{0.1550230234861374,-0.18510130047798157,0.07244136929512024,-0.37113049626350403,0.17128893733024597,-0.08368610590696335,-0.0418999120593071,0.24529530107975006,0.02554701641201973,0.20573727786540985,0.08780895173549652,-0.14508941769599915,-0.21195995807647705,-0.09176445752382278,0.30121394991874695,-0.2261582762002945,0.05995609611272812,-0.10266905277967453,-0.12517254054546356,0.0918240174651146,-0.13187646865844727,0.08724980056285858,-0.18531638383865356,0.2993258833885193,-0.32343271374702454,0.04530934989452362,-0.10915616154670715,-0.2197132110595703,0.028787977993488312,0.049629997462034225,0.22465747594833374,-0.11770042032003403},{0.22806493937969208,-0.011911534704267979,0.021433772519230843,0.2560199201107025,-0.28937873244285583,-0.09350208938121796,0.15954366326332092,-0.088343545794487,0.11762262880802155,-0.20627741515636444,0.0025584655813872814,-0.05322657898068428,-0.11864564567804337,-0.0884086862206459,0.2701045274734497,0.29540252685546875,-0.09650205075740814,-0.33962440490722656,0.1541920006275177,-0.08597882837057114,-0.14135070145130157,0.2262958139181137,0.24499504268169403,0.05482383444905281,-0.04338579252362251,-0.09767786413431168,-0.0013539907522499561,0.2535833418369293,0.23146365582942963,0.08125407993793488,0.08355824649333954,-0.28478509187698364},{0.2982522249221802,-0.17642222344875336,0.06306486576795578,0.05740769952535629,-0.16705681383609772,-0.31112074851989746,-0.17525170743465424,-0.28099188208580017,-0.25104811787605286,-0.013208175078034401,0.01640966907143593,-0.04452205449342728,-0.16593512892723083,-0.03623374551534653,-0.23297211527824402,-0.2639542818069458,0.20429717004299164,0.03576711192727089,-0.2877483665943146,0.22535988688468933,-0.010859307833015919,-0.247762531042099,0.2041737586259842,-0.15636229515075684,-0.14411313831806183,-0.26657024025917053,-0.09330685436725616,0.1017761304974556,0.09728305786848068,0.26424965262413025,-0.31131887435913086,0.16855038702487946},{0.2116585671901703,0.053417716175317764,0.2725380063056946,-0.1771356612443924,0.25903555750846863,-0.14867375791072845,-0.26091209053993225,0.02813095413148403,0.26510804891586304,0.1898719072341919,-0.16006936132907867,0.07358768582344055,0.06722945719957352,0.3168111741542816,0.14557509124279022,-0.08268065005540848,-0.19439715147018433,0.1411697268486023,0.014838666655123234,-0.01298860739916563,-0.10630250722169876,0.2366197407245636,0.20756672322750092,0.19248676300048828,-0.309042751789093,-0.276439368724823,-0.29045403003692627,-0.369651198387146,0.02371666580438614,-0.08557717502117157,0.24849815666675568,0.15511582791805267},{0.31732261180877686,-0.38490819931030273,0.1420145034790039,-0.4292582869529724,-0.2631548047065735,0.35569441318511963,0.4323676526546478,0.18166124820709229,-0.1025744378566742,0.07039406150579453,0.17644786834716797,-0.19182567298412323,0.11684831976890564,0.31547436118125916,-0.03531428053975105,0.18572935461997986,0.4174995422363281,-0.1654917597770691,-0.05210552737116814,-0.2741447389125824,0.1586175262928009,0.25386151671409607,0.27115076780319214,0.20274563133716583,0.07138827443122864,0.04993884265422821,0.10124489665031433,0.21824774146080017,-0.23165453970432281,-0.18697048723697662,0.22852832078933716,-0.0067799827083945274},{-0.03631303831934929,-0.02275729738175869,0.24186362326145172,0.24648568034172058,-0.20165203511714935,-0.3667897880077362,-0.05204857885837555,0.22724270820617676,-0.2112353891134262,-0.3365079462528229,0.14778153598308563,0.135006844997406,0.08812705427408218,-0.2809111475944519,0.11199551075696945,-0.17195682227611542,-0.16416114568710327,0.1541924625635147,-0.23338231444358826,0.2888956367969513,-0.23483170568943024,-0.4289691150188446,-0.30034467577934265,0.21855281293392181,0.13121214509010315,0.14161516726016998,0.2649555802345276,0.2191103845834732,-0.14881867170333862,-0.3204737901687622,-0.18078163266181946,0.14453323185443878},{0.3617226183414459,-0.01462628971785307,0.004411465488374233,0.16768191754817963,0.06716733425855637,0.26868802309036255,-0.004389788955450058,0.31612321734428406,-0.07497580349445343,0.09442827105522156,0.14381887018680573,0.05360659584403038,-0.18586969375610352,-0.40348294377326965,0.1369245946407318,0.19211046397686005,0.07639085501432419,-0.145316943526268,-0.020915977656841278,-0.04770691692829132,0.1329202502965927,-0.32854750752449036,0.29284757375717163,0.056505236774683,-0.06902076303958893,0.11128498613834381,-0.31343933939933777,-0.17794929444789886,0.036695029586553574,0.03916775435209274,0.13179199397563934,0.26037362217903137},{-0.11189225316047668,0.05832589417695999,-0.1327127069234848,0.18190549314022064,-0.147198885679245,0.2598690688610077,0.08270028233528137,-0.07110290974378586,0.3321612775325775,-0.2714022397994995,-0.1623547524213791,0.16557978093624115,-0.12737047672271729,0.062206875532865524,-0.3111172616481781,-0.03331587463617325,0.1053236648440361,0.17269493639469147,0.030617402866482735,-0.1351390928030014,-0.2734832465648651,0.22239622473716736,0.18448807299137115,0.2284332811832428,-0.2817173898220062,0.3613813817501068,-0.09538206458091736,-0.06268513947725296,-0.15373511612415314,0.11634305864572525,0.21307381987571716,0.25527024269104004},{-0.26969560980796814,0.372597336769104,-0.04933077096939087,0.015765056014060974,-0.21477212011814117,-0.23885659873485565,0.15107612311840057,-0.31867676973342896,-0.08799081295728683,-0.37008702754974365,-0.13018518686294556,-0.015663910657167435,0.16261735558509827,-0.25388216972351074,-0.1353326141834259,-0.3021914064884186,-0.19054332375526428,-0.06787459552288055,0.34363895654678345,-0.30075961351394653,0.15942013263702393,-0.2836829721927643,0.04176836088299751,0.23743201792240143,-0.12120097130537033,0.20896315574645996,0.25013235211372375,-0.04050728678703308,0.007545481901615858,0.26888686418533325,-0.1915230005979538,-0.28947439789772034},{0.0077848308719694614,0.2288917750120163,0.18785089254379272,-0.27205023169517517,0.26688528060913086,0.015665272250771523,-0.16189007461071014,0.0029535582289099693,0.1786293238401413,-0.23229321837425232,-0.10669924318790436,0.05356940999627113,0.16391541063785553,-0.030736885964870453,0.06971236318349838,-0.05685422196984291,0.206805020570755,-0.31224435567855835,0.2939099371433258,0.029572978615760803,-0.20275641977787018,0.24186652898788452,-0.11894185096025467,-0.26344749331474304,0.22962066531181335,-0.06416520476341248,0.02571715973317623,-0.11272109299898148,0.09945287555456161,-0.1485428810119629,0.3539785146713257,0.30533039569854736},{0.03702521696686745,-0.2647542357444763,-0.21769468486309052,0.06573359668254852,-0.03617097809910774,0.2799524664878845,-0.14930197596549988,-0.37266024947166443,0.3855188190937042,0.07215434312820435,0.020796533674001694,0.04993020370602608,-0.0669863298535347,0.23278234899044037,-0.2324294149875641,-0.36352595686912537,0.033473800867795944,0.04558664187788963,0.14162863790988922,0.45861610770225525,-0.30955421924591064,0.22864177823066711,-0.17590172588825226,0.13419070839881897,0.16223835945129395,-0.34424009919166565,-0.15415909886360168,-0.37020084261894226,-0.2027759850025177,-0.1857410967350006,0.15337692201137543,-0.42458367347717285},{-0.1412469893693924,0.35698550939559937,0.011195269413292408,-0.1728946715593338,-0.21192502975463867,-0.29023709893226624,0.08770675957202911,-0.15272387862205505,0.3631151616573334,-0.053707584738731384,0.21809549629688263,0.25699448585510254,-0.0007006675587035716,0.11118872463703156,-0.17204910516738892,0.1337861567735672,-0.19293685257434845,-0.39671650528907776,-0.37736767530441284,0.10168598592281342,0.11729077994823456,-0.20346702635288239,-0.39542901515960693,-0.25800621509552,-0.0940689891576767,0.17225219309329987,0.4001036584377289,-0.011115031316876411,-0.148395374417305,-0.010330207645893097,-0.07686983048915863,0.09180518984794617},{-0.22379346191883087,-0.16596315801143646,-0.1999169886112213,0.07874443382024765,-0.2504720091819763,-0.14182275533676147,-0.11015554517507553,-0.14766085147857666,-0.30715447664260864,-0.25954097509384155,0.18505428731441498,0.1810770183801651,-0.2661978006362915,0.2720949351787567,-0.035676587373018265,0.18537892401218414,0.06104285642504692,-0.0001427476672688499,0.05941065028309822,0.1408926099538803,0.19213926792144775,0.25943437218666077,0.13380341231822968,0.2538575828075409,0.10067664831876755,-0.21874593198299408,-0.18826152384281158,0.2564079165458679,-0.03508541360497475,-0.21068936586380005,-0.15635891258716583,-0.20994646847248077},{-0.25257420539855957,-0.1843414008617401,-0.32715457677841187,0.11517884582281113,-0.0654168352484703,-0.047452498227357864,-0.10207954794168472,0.12932419776916504,-0.10461875796318054,0.08089721202850342,-0.2283390909433365,0.01168135181069374,0.15680478513240814,-0.11182254552841187,0.07670677453279495,0.24750874936580658,-0.13910171389579773,-0.16394297778606415,0.2108585685491562,0.058455631136894226,0.19960881769657135,-0.02908620424568653,-0.1814374327659607,0.04693945124745369,0.19609247148036957,-0.27471333742141724,0.11851154267787933,0.09835837781429291,0.10512769222259521,-0.13038884103298187,0.23972904682159424,-0.048153214156627655},{0.24698489904403687,-0.06386834383010864,0.037896595895290375,0.10877474397420883,-0.29945138096809387,0.0008880696841515601,0.1772644966840744,0.23234370350837708,-0.09214101731777191,-0.13289973139762878,0.333139568567276,-0.19143135845661163,-0.011543846689164639,-0.036971837282180786,-0.17298798263072968,0.21307054162025452,0.03836078569293022,-0.062351908534765244,0.11934425681829453,-0.2873803675174713,0.02265266515314579,-0.2903884947299957,-0.20338405668735504,0.2773978114128113,-0.08920309692621231,-0.10907282680273056,0.1485176533460617,0.005402941722422838,-0.19671036303043365,-0.018371116369962692,-0.09707120060920715,-0.05270076170563698},{0.3084268867969513,-0.043123871088027954,0.1093989685177803,0.0469646193087101,-0.019827911630272865,-0.1062014028429985,0.19787073135375977,-0.21943166851997375,0.22465762495994568,0.2772526144981384,0.04368290677666664,0.14621897041797638,0.21378971636295319,0.3260517716407776,-0.2815478444099426,-0.32336199283599854,-0.2704204320907593,0.05416445434093475,-0.13223934173583984,-0.2990591824054718,-0.13662616908550262,0.2281671017408371,0.06324448436498642,0.11457601189613342,-0.14079642295837402,-0.1048651933670044,-0.12340094894170761,-0.19675946235656738,0.2800867259502411,0.18211089074611664,-0.3164132535457611,-0.1251840591430664},{-0.14555683732032776,0.15491800010204315,0.2534968852996826,-0.08819203823804855,-0.0659756064414978,0.01938156597316265,0.005749550648033619,-0.30772945284843445,0.2071593701839447,0.2125006467103958,0.2099820375442505,0.22385452687740326,-0.2663615942001343,0.22728973627090454,-0.32266372442245483,0.26336097717285156,0.19875095784664154,-0.2529565393924713,0.22061972320079803,0.09754682332277298,-0.284983366727829,0.28175511956214905,-0.3085620403289795,0.12730322778224945,0.27128371596336365,0.28471168875694275,0.12445288896560669,0.14065846800804138,-0.19843918085098267,0.19623494148254395,-0.06818664819002151,0.12282595038414001},{-0.11938553303480148,-0.10868287086486816,0.009731967002153397,0.16309718787670135,0.02180738002061844,0.21541544795036316,-0.2662639617919922,-0.09062713384628296,-0.14505703747272491,-0.07756566256284714,-0.16045160591602325,-0.18043330311775208,0.007750632707029581,-0.19065558910369873,0.08643024414777756,-0.21019840240478516,0.2527725100517273,-0.03729958459734917,-0.3115081787109375,-0.2784891128540039,0.13720650970935822,0.1513809710741043,-0.19083547592163086,0.3064708113670349,-0.2586820423603058,0.06623750180006027,0.125106081366539,-0.08055060356855392,0.1546163111925125,-0.22243154048919678,0.3172227740287781,0.15610362589359283},{0.326015442609787,0.07200424373149872,0.103579081594944,0.22188280522823334,-0.22452344000339508,0.15300767123699188,-0.0937223732471466,0.18226081132888794,0.08639256656169891,0.033174823969602585,0.09137632697820663,-0.31293731927871704,-0.2562713921070099,0.007100129500031471,0.11401344835758209,-0.06107056885957718,0.24092774093151093,0.1326248198747635,-0.17028774321079254,-0.2296883910894394,0.32902419567108154,0.17911440134048462,0.2818940281867981,0.05774102732539177,-0.028611216694116592,0.06573177129030228,-0.06868962943553925,-0.13290858268737793,0.31037637591362,0.024044357240200043,-0.17748582363128662,0.12181467562913895},{-0.03178614005446434,0.031693123281002045,-0.05781678110361099,-0.22988654673099518,-0.10040782392024994,-0.24144236743450165,-0.22380322217941284,-0.1654892861843109,-0.019701464101672173,-0.042637743055820465,-0.2411024272441864,0.021502520889043808,-0.23370715975761414,-0.13943034410476685,0.0039013968780636787,0.10050661861896515,0.27127084136009216,-0.18119987845420837,-0.3260878622531891,0.26846668124198914,-0.16692163050174713,0.25828784704208374,0.02408495917916298,-0.03994687274098396,0.05878547206521034,0.14521263539791107,-0.0858885794878006,-0.24644292891025543,0.21836735308170319,0.2456234097480774,-0.14296692609786987,0.1791977882385254},{-0.2711009085178375,-0.03255283087491989,0.05032622814178467,-0.023450231179594994,0.07968685775995255,0.12390223890542984,-0.17838846147060394,0.10764016956090927,-0.181039497256279,-0.18469855189323425,0.11816450953483582,-0.1388656497001648,-0.18946130573749542,0.23631402850151062,0.01030901912599802,0.017741059884428978,0.20711909234523773,-0.23614880442619324,-0.14995113015174866,0.28498244285583496,0.03858942911028862,0.22199176251888275,-0.037573426961898804,0.019800972193479538,-0.28589117527008057,-0.1865028738975525,0.0057250745594501495,0.2727140486240387,-0.01132629718631506,0.012940769083797932,0.25400298833847046,0.2746041417121887}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.05941152572631836,0.24567890167236328,0.43867751955986023,-0.06899651885032654},{0.15417002141475677,-0.16552484035491943,0.05946125090122223,0.24721485376358032},{-0.21237507462501526,0.18162524700164795,0.13400040566921234,0.1279573291540146},{0.34089282155036926,-0.0022338253911584616,0.06885992735624313,0.4846741855144501},{-0.09709131717681885,0.11667181551456451,0.410470575094223,-0.05773478001356125},{-0.11342886835336685,0.30002379417419434,0.2478598803281784,-0.16319090127944946},{-0.36205026507377625,-0.021463759243488312,0.008335452526807785,-0.16691261529922485},{-0.42787593603134155,-0.11559932678937912,0.4449801743030548,-0.31270456314086914},{0.40309542417526245,-0.15835708379745483,-0.3372795581817627,-0.4546119272708893},{0.04713797569274902,0.32523712515830994,0.3861592710018158,-0.4979890286922455},{-0.25140097737312317,-0.2065754532814026,-0.2708665132522583,0.1796489953994751},{0.45447707176208496,-0.2218960076570511,-0.06022576242685318,0.2255534827709198},{0.3216680586338043,0.3061772584915161,-0.03692101687192917,0.1147758886218071},{0.009055748581886292,0.10779457539319992,-0.34662047028541565,-0.003258708631619811},{0.14937357604503632,0.35305044054985046,0.4628886282444,0.36185207962989807},{0.17849941551685333,0.039840877056121826,0.30526769161224365,0.2643915116786957},{-0.30389052629470825,-0.11978469789028168,-0.1234760656952858,-0.29605069756507874},{-0.22196927666664124,0.16057005524635315,-0.1486528366804123,-0.11058247089385986},{-0.24239283800125122,0.2396601140499115,0.2288525104522705,0.3514682948589325},{-0.021977003663778305,0.38368237018585205,-0.23159469664096832,0.09965386986732483},{-0.3115658760070801,-0.41916462779045105,-0.08257587999105453,0.07924378663301468},{0.40567684173583984,0.5205994248390198,0.028381841257214546,-0.3488338589668274},{-0.03626740351319313,0.2355262041091919,0.2605673670768738,0.19797874987125397},{-0.14666233956813812,0.41403284668922424,-0.06891759485006332,-0.1780668944120407},{0.0720619261264801,-0.0636734887957573,-0.13041703402996063,0.030864981934428215},{0.32926827669143677,-0.5065606236457825,-0.05876084789633751,0.043342337012290955},{-0.01986485719680786,-0.44029542803764343,-0.2357555776834488,-0.2509653866291046},{0.11788849532604218,-0.18609413504600525,0.20277395844459534,0.20137165486812592},{0.04460449516773224,-0.0849129930138588,0.1594279408454895,0.09618864953517914},{-0.4135855734348297,0.3518538475036621,0.2561432123184204,-0.04626129940152168},{0.37330031394958496,-0.11715934425592422,0.23298773169517517,-0.11837776005268097},{0.06344274431467056,-0.4466552734375,0.4390048086643219,-0.3339259922504425}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.07845696806907654,-0.019666556268930435,0.06768929213285446,-0.01882929727435112,-0.04765764996409416,-0.14609313011169434,-0.11836423724889755,0.05232182890176773,0.060655608773231506,0.019105682149529457,0.05408789962530136,0.04182465001940727,-0.07750654965639114,-0.12174227833747864,0.04984857514500618,-0.09490489959716797};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.054840508848428726,0.07434818893671036,0.021788937970995903,0.025666560977697372,0.06352266669273376,-0.05488777160644531,0.10577152669429779,-0.02090061642229557,-0.035882968455553055,0.0031394814141094685,0.002960733138024807,-0.052779413759708405,0.07173998653888702,-0.018466098234057426,-0.04047364369034767,-0.02836102806031704};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07457098364830017,0.05290455371141434,0.005189797375351191,0.06653082370758057,0.04561514034867287,0.008231137879192829,-0.05762844160199165,-0.03274649381637573,-0.0006641634972766042,0.029527027159929276,-0.07115060091018677,0.042424481362104416,0.07303529232740402,-0.04453805088996887,0.07743190228939056,0.06753966212272644,-0.07398641854524612,-0.054064564406871796,0.012581218965351582,0.009194456040859222,-0.07148058712482452,0.043752383440732956,0.06119997799396515,0.007274446077644825,-0.02392083965241909,0.007361831609159708,-0.05591355636715889,0.044111061841249466,0.02570103481411934,0.0034799750428646803,0.05750846490263939,0.01729968748986721};
static const float action_parameterization_distribution_linear_bias[4] = {0.06319815665483475,0.03377988189458847,0.04889056459069252,0.02914666011929512};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.09408624470233917,0.17660827934741974,-0.18842238187789917,0.2204357534646988,0.16841956973075867,0.0640225037932396,0.29462936520576477,-0.031901437789201736},{-0.29620373249053955,-0.10941670089960098,-0.348775714635849,-0.20490355789661407,-0.31932276487350464,-0.25854238867759705,-0.06898591667413712,-0.24922482669353485},{-0.33517056703567505,-0.020382488146424294,0.17964670062065125,0.24422991275787354,0.27840209007263184,-0.060030195862054825,0.32002443075180054,-0.1613369733095169},{-0.04548070952296257,0.046892039477825165,-0.23449836671352386,0.006670540198683739,0.046335261315107346,-0.09695450216531754,0.32395023107528687,-0.24573518335819244},{-0.36758747696876526,-0.17718052864074707,-0.2883889377117157,-0.1482534259557724,0.03532305732369423,0.15053918957710266,0.1770867109298706,-0.06942374259233475},{-0.3704209625720978,-0.08057025820016861,0.3278198838233948,0.2156461775302887,0.25349313020706177,-0.12662780284881592,-0.14626474678516388,-0.15327821671962738},{-0.24540244042873383,-0.01809350773692131,0.3577139675617218,-0.24400094151496887,-0.03158911317586899,-0.42569345235824585,-0.0991368442773819,-0.14617182314395905},{-0.2525803744792938,-0.39768868684768677,0.41311413049697876,-0.1413237750530243,-0.0895184576511383,0.2479415386915207,0.16335129737854004,-0.2486518770456314},{-0.2694374918937683,0.26928389072418213,-0.30983778834342957,0.2791610360145569,0.24141836166381836,-0.2423044592142105,-0.015730582177639008,0.13906453549861908},{-0.28860124945640564,-0.31817254424095154,-0.2513631582260132,-0.2576977014541626,-0.440371036529541,0.17163482308387756,-0.05787050351500511,0.16136936843395233},{0.19588948786258698,0.36279889941215515,0.15273724496364594,-0.048868220299482346,0.22479499876499176,0.15712909400463104,-0.23354551196098328,0.20532342791557312},{0.21909593045711517,0.05685991048812866,0.2502170205116272,0.2469867318868637,-0.3138105571269989,0.30035653710365295,-0.021812710911035538,-0.2504155933856964},{0.11701615154743195,-0.3096458911895752,0.26372069120407104,-0.025956157594919205,-0.384233683347702,-0.10428932309150696,-0.2070894092321396,-0.12281766533851624},{-0.19062471389770508,-0.21398310363292694,0.3234712779521942,0.351829469203949,-0.2647049129009247,-0.08051621913909912,-0.3377789258956909,0.2055126577615738},{0.07966411113739014,-0.13701310753822327,0.09747153520584106,-0.2316000908613205,-0.32447609305381775,-0.14433985948562622,0.21956214308738708,0.004899556282907724},{0.2085021436214447,0.03900999575853348,-0.051311396062374115,-0.2643902599811554,-0.0019495236920192838,0.044162265956401825,0.07602612674236298,0.3634120225906372},{0.02214878611266613,-0.266679584980011,-0.18674500286579132,0.138081893324852,-0.20497238636016846,-0.17721186578273773,-0.1351587474346161,0.11110619455575943},{-0.13701598346233368,-0.3218637704849243,0.03779061883687973,0.08279694616794586,0.11562280356884003,-0.23703493177890778,0.3331315219402313,0.166366308927536},{0.03454412892460823,0.08638183772563934,-0.2528057098388672,0.1545545905828476,0.09110495448112488,0.1571798473596573,-0.2655058205127716,0.36205270886421204},{0.15065816044807434,-0.04198781028389931,-0.351576030254364,0.11242551356554031,-0.08075979351997375,-0.054154399782419205,-0.3405839800834656,-0.00824122317135334},{0.08211591839790344,-0.12004479020833969,0.06214876100420952,-0.09716582298278809,0.3075609505176544,0.025256836786866188,-0.0677342414855957,0.40137889981269836},{0.0417911633849144,0.1738336831331253,-0.22516199946403503,0.27201253175735474,0.31143805384635925,0.30935466289520264,0.1937384158372879,-0.35533198714256287},{-0.40555518865585327,-0.08275853097438812,0.20930145680904388,-0.03937593474984169,0.15964394807815552,-0.3451535403728485,0.2368147373199463,-0.30701470375061035},{-0.17458680272102356,0.054090842604637146,-0.01451801136136055,-0.33173003792762756,0.1543242335319519,-0.10464441776275635,-0.3417200744152069,0.18173827230930328},{-0.23808616399765015,-0.15591998398303986,0.041720300912857056,0.13324719667434692,-0.12071292847394943,0.06428801268339157,0.29674243927001953,-0.09131933003664017},{-0.22118420898914337,0.06944644451141357,-0.3851938545703888,-0.26539286971092224,0.15252932906150818,-0.019402215257287025,-0.1040349081158638,0.09391361474990845},{0.3109864890575409,0.3811139762401581,-0.3194621503353119,0.19180914759635925,0.20932891964912415,0.3578936457633972,-0.30363523960113525,-0.12855790555477142},{0.3473159372806549,0.23486961424350739,0.04223217815160751,0.07909886538982391,0.2562892436981201,0.15559978783130646,0.22418633103370667,0.3899345397949219},{-0.16952097415924072,0.36843615770339966,0.14936763048171997,0.0053638434037566185,0.18979930877685547,0.014400634914636612,-0.3850681185722351,-0.29020169377326965},{-0.2320164442062378,-0.2546514570713043,0.07548969984054565,-0.24897246062755585,-0.34935322403907776,-0.20680853724479675,0.2701828181743622,-0.06368256360292435},{0.34769803285598755,-0.3048142194747925,0.3072666525840759,-0.29185009002685547,0.01130673661828041,0.20375050604343414,0.15054255723953247,-0.22866706550121307},{0.18513718247413635,0.32492154836654663,0.3543477952480316,-0.23681369423866272,-0.2461775243282318,0.04869535565376282,0.18297871947288513,0.07774389535188675}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.023183947429060936,0.42410796880722046,-0.18910819292068481,0.2280309796333313,-0.44137024879455566,0.2842882573604584,0.3899235129356384,0.04813908413052559},{-0.4255070984363556,-0.5352301001548767,-0.36620619893074036,-0.4597603380680084,-0.446791410446167,0.33643361926078796,0.4730454683303833,-0.4265466332435608},{0.008043861016631126,-0.16214445233345032,0.08011649549007416,0.08302204310894012,-0.0650375485420227,0.4615909159183502,-0.3843894898891449,-0.3933177888393402},{0.560871422290802,0.04753468185663223,0.0708690732717514,-0.030695391818881035,0.5187641978263855,0.3644433319568634,0.31624841690063477,0.3721831738948822},{0.07368823885917664,0.2385963350534439,-0.08207453787326813,-0.09929820895195007,0.08358155190944672,-0.41666460037231445,-0.32977625727653503,0.48593148589134216},{0.4088401198387146,0.03836619481444359,0.04202639311552048,-0.4425026476383209,-0.4589141607284546,-0.5324597358703613,-0.13381902873516083,0.5256655812263489},{-0.48418501019477844,-0.36091887950897217,-0.06602662801742554,-0.27162736654281616,-0.0024078155402094126,0.49895721673965454,-0.5595274567604065,0.5840275287628174},{0.2749742567539215,0.11073768883943558,-0.016924424096941948,-0.017266375944018364,0.4023086428642273,-0.6046163439750671,0.4180401563644409,-0.39572012424468994}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07286597788333893,0.014655767939984798,0.07581114768981934,0.01609533093869686,-0.06329227238893509,0.0019255729857832193,-0.001319268369115889,0.026303548365831375};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.03236667439341545,-0.07052096724510193,0.035684727132320404,-0.046570707112550735,0.015008594840765,-0.03461431339383125,-0.0023456821218132973,-0.06393777579069138};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

