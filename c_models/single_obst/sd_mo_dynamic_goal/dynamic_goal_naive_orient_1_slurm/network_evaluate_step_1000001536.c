#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3924483060836792,-0.20051974058151245,0.38522598147392273,0.14105398952960968,-0.42709407210350037,0.11789418756961823,0.012454982846975327,-0.20847921073436737,0.10161767899990082,0.4570961892604828,0.07908011227846146,-0.013557079248130322,0.15720520913600922,-0.11833538115024567,0.43443188071250916,-0.12866593897342682},{-0.36913925409317017,-0.1805182248353958,0.274576872587204,0.1428072303533554,-0.27850639820098877,-0.018597424030303955,-0.3866257071495056,0.059483323246240616,-0.15952087938785553,-0.11743853986263275,0.12091096490621567,-0.14472003281116486,0.1614038348197937,-0.3071568012237549,-0.24283887445926666,0.09573934227228165},{0.1447826772928238,-0.2189570963382721,-0.2328745722770691,0.018090950325131416,0.11922866851091385,0.16294534504413605,-0.07274632155895233,-0.007494628429412842,-0.06459304690361023,-0.20785556733608246,-0.21000024676322937,0.40680715441703796,0.01919003203511238,-0.1572469025850296,-0.32630348205566406,0.21654659509658813},{0.19252890348434448,0.18395282328128815,0.2830052673816681,-0.06362777948379517,-0.36537444591522217,0.00921835470944643,0.13741925358772278,0.09080320596694946,0.5231340527534485,-0.38015425205230713,0.011795707046985626,0.11829204857349396,-0.2646375596523285,-0.0742114707827568,0.29881444573402405,-0.35380542278289795},{-0.08493032306432724,0.17427195608615875,0.2221299111843109,-0.09867861866950989,0.2192155420780182,0.25613829493522644,0.2332059144973755,-0.04347802326083183,-0.07466240227222443,0.23429852724075317,0.2889118194580078,-0.10547696799039841,-0.07542051374912262,-0.3744710087776184,0.32120221853256226,0.12870655953884125},{-0.07676991820335388,-0.19127964973449707,-0.1791921705007553,-0.2886808514595032,0.1205272302031517,0.05436226353049278,-0.04753509908914566,-0.15470702946186066,0.2265520691871643,-0.25303348898887634,-0.32899925112724304,0.21377058327198029,0.38322964310646057,-0.034912239760160446,-0.12348460406064987,0.21671536564826965},{-0.12370683997869492,0.10817231237888336,0.0491868294775486,-0.24002580344676971,0.26671022176742554,0.032365258783102036,0.06544899195432663,0.38814976811408997,0.24760845303535461,-0.034846264868974686,-0.40294069051742554,0.28110721707344055,-0.044545941054821014,0.1636991649866104,-0.19204258918762207,-0.12842968106269836},{0.05736961215734482,-0.10873440653085709,0.2045731246471405,0.2019335925579071,-0.32676786184310913,-0.021074991673231125,0.269294410943985,0.32291004061698914,-0.006761196535080671,0.17845885455608368,-0.42295947670936584,-0.2716647982597351,0.2334337681531906,0.23719759285449982,0.22417591512203217,0.15150734782218933},{0.34438958764076233,-0.1749909669160843,0.373710960149765,-0.031429097056388855,0.11107061058282852,0.12070325762033463,-0.23532749712467194,-0.23058904707431793,0.20968253910541534,-0.27495327591896057,0.004089572001248598,-0.2768179476261139,-0.1852320283651352,0.3054907023906708,0.15834040939807892,-0.08511954545974731},{0.045298606157302856,-0.1246521919965744,-0.4244002103805542,-0.07532999664545059,-0.3301788568496704,0.2142537236213684,0.39788755774497986,0.17775486409664154,0.3919423222541809,0.3971678912639618,0.009339186362922192,-0.30666273832321167,0.07484273612499237,0.2878444492816925,-0.09745892137289047,-0.39854696393013},{-0.00016854074783623219,0.26181623339653015,0.34162580966949463,-0.27040335536003113,-0.28573229908943176,0.19947925209999084,0.20061084628105164,0.3399747908115387,-0.3031834065914154,-0.03089200332760811,-0.033976126462221146,0.19054298102855682,-0.27411144971847534,-0.18983741104602814,0.32817715406417847,-0.38806575536727905},{0.003496205899864435,-0.17769186198711395,0.012077761813998222,0.19640658795833588,0.3466111421585083,0.339715838432312,0.4175199568271637,-0.031227249652147293,0.00833202339708805,-0.06669055670499802,0.29114413261413574,-0.1782931089401245,0.030871571972966194,-0.22668708860874176,0.30794015526771545,0.3036152422428131},{-0.08066773414611816,0.25293129682540894,0.10566716641187668,-0.3411495089530945,0.09241630882024765,0.1016535684466362,0.3436419367790222,-0.05838903784751892,0.09661534428596497,0.023386087268590927,-0.08511785417795181,0.17956480383872986,0.135432630777359,0.26048529148101807,0.14756467938423157,-0.2979460060596466},{-0.22519269585609436,-0.24389110505580902,-0.23606596887111664,0.001587019651196897,-0.16539117693901062,0.06999564170837402,-0.26825767755508423,0.04475611448287964,-0.006679408717900515,-0.042580634355545044,-0.2756229639053345,-0.01875370368361473,-0.3664540648460388,0.07621239125728607,0.20819026231765747,0.08403089642524719},{-0.2653581202030182,-0.30732160806655884,-0.2759554088115692,0.3258283734321594,0.13378559052944183,-0.36728575825691223,0.27525317668914795,-0.13338395953178406,0.0960969477891922,0.29938071966171265,0.09139583259820938,0.2006930708885193,0.18889395892620087,-0.003802001941949129,-0.23240725696086884,0.2778318226337433},{0.41002288460731506,-0.0778772383928299,-0.24709224700927734,-0.3748548626899719,-0.59088134765625,0.28812935948371887,0.44635751843452454,-0.26567342877388,0.15193171799182892,0.07358653843402863,-0.31049391627311707,0.11472807079553604,-0.49792468547821045,0.5810408592224121,-0.2872433066368103,0.007594165857881308},{-0.33921870589256287,-0.36644405126571655,0.40842023491859436,0.3189799189567566,-0.2539428770542145,0.24210506677627563,-0.08000695705413818,-0.2445589154958725,0.27978628873825073,-0.4145846962928772,-0.30387935042381287,-0.6561787128448486,-0.3314048647880554,-0.44700226187705994,0.07909419387578964,-0.23543573915958405},{-0.3565489947795868,0.2717440128326416,-0.5475345849990845,-0.0500032901763916,0.0023996417876333,0.3389439880847931,-0.39826342463493347,-0.40988168120384216,0.23002395033836365,0.1475512683391571,0.38563695549964905,-0.023480979725718498,-0.23294124007225037,0.25062882900238037,0.13038119673728943,-0.4633451998233795}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04135323688387871,-0.1008794978260994,-0.20695018768310547,-0.41554346680641174,0.3474091589450836,0.2781713008880615,0.04593319445848465,0.06741410493850708,-0.17918233573436737,-0.11399544775485992,-0.05707709491252899,0.05887231603264809,0.19374939799308777,0.4228944480419159,0.06584762036800385,0.10441567003726959},{-0.12312184274196625,-0.22673356533050537,-0.056807924062013626,0.14631293714046478,0.3100380301475525,-0.21864378452301025,0.12435175478458405,0.04547262564301491,-0.05262845754623413,0.2582976818084717,-0.1496208906173706,0.34157103300094604,-0.34399622678756714,0.18688032031059265,-0.3167424201965332,-0.24527712166309357},{0.10952465981245041,0.17235666513442993,-0.3133944571018219,-0.6123546361923218,0.16958917677402496,0.42855244874954224,-0.08526407927274704,0.10420095175504684,-0.23803307116031647,-0.23361466825008392,-0.016139360144734383,0.27305173873901367,-0.2414950728416443,-0.21713586151599884,0.11058926582336426,-0.018527159467339516},{0.13910551369190216,-0.027490032836794853,0.0622677206993103,0.14925053715705872,-0.4877264201641083,0.00018551528046373278,0.0647067204117775,-0.2697024941444397,0.3091610372066498,0.3231288194656372,-0.10796131938695908,-0.20275412499904633,-0.4214739501476288,-0.3254491090774536,0.17894145846366882,0.23819327354431152},{-0.039519768208265305,0.08868420124053955,0.02294076420366764,0.34131038188934326,-0.23851723968982697,0.008233388885855675,-0.039822835475206375,0.21887212991714478,0.2183040976524353,-0.2876065969467163,0.011844214983284473,0.3683861196041107,0.10290348529815674,-0.4371299147605896,-0.050081346184015274,-0.14293783903121948},{0.14324110746383667,0.11296017467975616,-0.00997219793498516,0.15942443907260895,-0.34259718656539917,-0.39896392822265625,0.16422806680202484,0.2707497775554657,0.13721010088920593,0.4102165400981903,0.19563208520412445,-0.2533336281776428,0.015459793619811535,-0.15938180685043335,-0.09228586405515671,0.29223406314849854},{-0.02275395765900612,0.13741107285022736,0.31682291626930237,-0.3486330211162567,-0.1482226550579071,0.08229365944862366,-0.29575175046920776,-0.06059647351503372,0.1382480263710022,0.07076345384120941,-0.1040678322315216,-0.2909705638885498,-0.2152978479862213,-0.016277313232421875,0.14050593972206116,0.07548895478248596},{-0.12507399916648865,-0.16309921443462372,-0.35997819900512695,0.2958555519580841,-0.23351562023162842,-0.30383622646331787,-0.15410007536411285,-0.3295997083187103,0.03336222842335701,-0.1303090900182724,-0.12004709243774414,0.13074147701263428,-0.1721642166376114,0.4031623899936676,-0.08223371207714081,-0.36994487047195435},{-0.1542976349592209,0.2728085219860077,-0.02999204397201538,-0.03363964706659317,0.3055737614631653,-0.2024008184671402,0.3665863275527954,0.11220578849315643,0.2220718264579773,0.35682907700538635,0.16906903684139252,0.31068363785743713,0.2055199295282364,-0.0404830276966095,0.24626117944717407,0.10766349732875824},{0.08954992890357971,-0.2778218388557434,-0.02593361772596836,-0.14562830328941345,0.30880630016326904,-0.044637858867645264,-0.3009347915649414,-0.23069919645786285,0.04922863468527794,-0.4480249285697937,-0.13447049260139465,0.2013111561536789,0.12142252922058105,0.15512718260288239,-0.3045242726802826,0.29790809750556946},{-0.09315267205238342,-0.30928710103034973,0.4476776719093323,0.24423496425151825,0.21494507789611816,0.13709035515785217,0.07134662568569183,-0.14422297477722168,0.10418783873319626,-0.19136233627796173,0.0022757446859031916,0.40472742915153503,0.23461604118347168,0.14795427024364471,-0.18037103116512299,-0.01997620239853859},{0.003628738457337022,-0.1135382130742073,0.2589523494243622,-0.001943119685165584,-0.15174689888954163,-0.22505412995815277,0.46495091915130615,0.31572726368904114,-0.2642265260219574,-0.34402915835380554,-0.0909954383969307,-0.3410325050354004,0.04460819438099861,-0.3692404329776764,-0.3500739336013794,-0.005765649955719709},{-0.06037047505378723,-0.30073609948158264,0.30880194902420044,-0.208048015832901,0.299118310213089,-0.3079136610031128,-0.32470259070396423,0.17009541392326355,0.07620730251073837,-0.061254192143678665,-0.2500269114971161,0.07561146467924118,0.0636783167719841,-0.22759298980236053,-0.3316245377063751,0.020185597240924835},{0.2962976396083832,-0.26419639587402344,0.3989652395248413,0.15341487526893616,0.036221422255039215,0.30136775970458984,-0.08768849819898605,-0.2161615788936615,-0.5022715926170349,0.11370053142309189,0.04841651767492294,-0.35802745819091797,-0.01401614211499691,0.18821440637111664,0.3520682752132416,0.04056913033127785},{-0.22659239172935486,0.1379321962594986,0.11209895461797714,-0.29274803400039673,-0.17719271779060364,0.019035622477531433,0.21132899820804596,-0.10690698772668839,0.17142926156520844,-0.33825838565826416,-0.028136076405644417,0.03881540894508362,-0.0003781392879318446,0.038867149502038956,-0.1186557188630104,0.034912109375},{-0.2291444092988968,0.300876647233963,-0.28046488761901855,0.35043221712112427,0.12053528428077698,-0.37455472350120544,-0.08158674836158752,-0.09218926727771759,-0.3580743670463562,0.26619550585746765,-0.299716979265213,0.3109724819660187,-0.07953717559576035,-0.20193849503993988,-0.26432982087135315,-0.5397195219993591}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11678190529346466,0.005411169957369566,-0.04154299199581146,-0.04845532774925232,-0.11950890719890594,0.024097084999084473,0.27237170934677124,0.07310072332620621,-0.13367792963981628,-0.2129117250442505,0.13384954631328583,-0.26667988300323486,-0.1656598299741745,0.2127319574356079,0.23215427994728088,0.2910296618938446,-0.22587747871875763,-0.32531043887138367,-0.1691078394651413,0.0667039304971695,-0.04079112038016319,-0.34852683544158936,-0.2440592646598816,-0.2659156620502472,-0.29670220613479614,0.1793898046016693,-0.21269014477729797,-0.025215134024620056,-0.02426522970199585,0.030510440468788147,0.2464643120765686,-0.17277468740940094},{0.2886885106563568,0.21800407767295837,0.15949927270412445,-0.06343237310647964,0.09971173107624054,-0.09758924692869186,0.2691532373428345,0.14519155025482178,-0.18499121069908142,-0.17782849073410034,-0.04771251231431961,-0.2271381914615631,-0.1663338840007782,0.1663278192281723,-0.20102816820144653,-0.3172731399536133,-0.05785079672932625,0.1323518604040146,-0.27290764451026917,-0.2730728089809418,0.022810591384768486,0.22289890050888062,0.1004265770316124,-0.115281842648983,0.1507766991853714,-0.2825101315975189,0.04174882918596268,0.06592407077550888,0.22890229523181915,-0.0980074405670166,-0.030759304761886597,0.27990245819091797},{0.2255580872297287,0.08384707570075989,-0.03479057177901268,0.1033562645316124,-0.14921610057353973,-0.13432079553604126,-0.21331681311130524,0.1255815178155899,-0.1261381059885025,0.3446837067604065,-0.29631173610687256,-0.2249404340982437,0.17009560763835907,-0.3170444667339325,-0.17666132748126984,0.1243060827255249,-0.07271001487970352,-0.08634162694215775,0.22010144591331482,-0.026897620409727097,0.17719723284244537,0.2887475788593292,-0.26784688234329224,0.06401849538087845,-0.16744031012058258,-0.0994754359126091,0.11222276091575623,-0.03468775004148483,-0.08284956961870193,-0.16455881297588348,-0.03649576008319855,-0.15778428316116333},{0.3181154429912567,0.04390764236450195,0.09473884105682373,-0.13437171280384064,-0.24423091113567352,-0.0837109312415123,-0.11642603576183319,0.20503941178321838,0.2368316501379013,-0.19342894852161407,-0.13368463516235352,0.24381005764007568,0.12960684299468994,-0.08448785543441772,-0.24532000720500946,0.3282751142978668,-0.30477583408355713,0.27567678689956665,-0.05770467221736908,0.04453401640057564,-0.07441902905702591,-0.09583627432584763,0.2664043605327606,0.1706453561782837,0.16216295957565308,-0.31323957443237305,0.2828974723815918,-0.19054275751113892,-0.045693863183259964,-0.0036528189666569233,-0.31489789485931396,0.13639211654663086},{-0.027326388284564018,-0.020572131499648094,-0.08213382959365845,0.042808644473552704,0.20040437579154968,-0.13333867490291595,-0.3782018721103668,0.017633959650993347,-0.14824675023555756,-0.21787020564079285,0.1690787672996521,0.21818244457244873,-0.09729992598295212,-0.08791764080524445,-0.07207873463630676,0.21709829568862915,-0.028116777539253235,0.015518894419074059,-0.3283447325229645,-0.04071391001343727,-0.19776922464370728,-0.31653305888175964,0.16808640956878662,0.22353988885879517,-0.05516558885574341,0.26894134283065796,-0.16081497073173523,0.26002639532089233,0.27735435962677,0.3530329763889313,0.026678554713726044,0.28188931941986084},{-0.19237013161182404,-0.1188521459698677,-0.1186392679810524,-0.09923417866230011,-0.10575318336486816,0.21744582056999207,0.2206319272518158,0.05692950636148453,0.327517569065094,0.12221897393465042,0.27702489495277405,-0.21590197086334229,-0.14064940810203552,0.24817009270191193,0.23806089162826538,-0.3313206136226654,-0.06975873559713364,-0.2312069684267044,0.2314765900373459,0.18165233731269836,0.060911934822797775,0.13300186395645142,-0.016199061647057533,0.0023051882162690163,-0.32578837871551514,0.28267425298690796,-0.20430730283260345,0.152955561876297,0.2935118079185486,0.22312912344932556,0.10983406752347946,0.04121411219239235},{0.1556704193353653,-0.13146229088306427,-0.13471505045890808,-0.3245919942855835,0.00938816275447607,0.23312419652938843,0.2737923562526703,0.11705902963876724,0.10502026230096817,0.28954020142555237,1.1813815945060924e-05,0.013210151344537735,-0.4448990225791931,-0.1232462152838707,-0.1352202445268631,0.017650524154305458,-0.2739274203777313,-0.21976624429225922,0.1778186410665512,-0.09243994951248169,-0.11866569519042969,-0.14992938935756683,-0.22255639731884003,-0.2616298198699951,0.17351551353931427,-0.25086134672164917,-0.12358177453279495,-0.2176293581724167,0.33440712094306946,0.125982865691185,-0.18458518385887146,-0.2670063078403473},{0.06346012651920319,0.2009221464395523,0.055153198540210724,-0.10434424877166748,0.13127604126930237,-0.27426639199256897,-0.06596711277961731,-0.1431065797805786,0.005820596590638161,-0.3086228370666504,-0.28460144996643066,-0.0727393701672554,-0.1381414830684662,0.04104946181178093,-0.0995967909693718,0.37859922647476196,0.004667296074330807,-0.15246587991714478,0.14595569670200348,0.31538885831832886,-0.16744659841060638,-0.20332998037338257,0.2843865156173706,0.06641684472560883,-0.012991907075047493,-0.3291566073894501,-0.3101261258125305,-0.22378316521644592,-0.34426286816596985,-0.24201273918151855,0.10582524538040161,-0.35781580209732056},{0.045275554060935974,0.3581637442111969,-0.33478018641471863,-0.35560309886932373,-0.24266313016414642,0.040784530341625214,0.09592333436012268,0.09109771251678467,0.1577814370393753,-0.2162514179944992,-0.241946741938591,0.2723362445831299,-0.290660560131073,-0.14160209894180298,0.16423726081848145,-0.2276671826839447,0.21360176801681519,0.11411154270172119,0.27027782797813416,0.0713157132267952,0.21964192390441895,0.08090507984161377,0.2871989607810974,-0.10615910589694977,0.46385613083839417,-0.17589645087718964,0.15851439535617828,0.2894730567932129,-0.20028643310070038,0.12108352780342102,-0.0037065157666802406,0.08819214254617691},{-0.18022705614566803,0.09789136797189713,-0.29888203740119934,-0.16149203479290009,0.1196989119052887,-0.17576752603054047,0.07903209328651428,0.016429899260401726,0.15125976502895355,-0.0008976907120086253,-0.2334413379430771,-0.30186790227890015,-0.3820766508579254,-0.12266726791858673,-0.22086870670318604,0.07286357879638672,0.006932017859071493,-0.2432544082403183,0.2517085671424866,0.08070090413093567,0.0721985250711441,-0.01567741297185421,0.34420397877693176,-0.23700827360153198,0.31604743003845215,0.13342848420143127,-0.2121001034975052,0.07691517472267151,0.0243163350969553,0.0870635136961937,-0.15235474705696106,0.14552389085292816},{0.06508056819438934,-0.05867873504757881,0.1994759738445282,-0.2507212162017822,-0.221418559551239,-0.22661684453487396,-0.2600093185901642,-0.10494692623615265,-0.15118132531642914,0.3035478889942169,0.10740561783313751,-0.2671366035938263,-0.33300650119781494,0.006275922060012817,-0.20684538781642914,-0.22608835995197296,0.2652095854282379,-0.15328051149845123,0.26961562037467957,-0.21841123700141907,-0.18671105802059174,-0.014562910422682762,0.14650069177150726,0.16496969759464264,0.14844298362731934,-0.12983109056949615,-0.07562828063964844,-0.0882035568356514,-0.06521502137184143,0.035146236419677734,-0.07984118163585663,0.17563439905643463},{-0.21894103288650513,-0.04391812905669212,0.24799489974975586,0.34755948185920715,0.2682834565639496,-0.012172257527709007,0.05087887868285179,-0.21960417926311493,-0.08488496392965317,-0.18796087801456451,0.2758435308933258,-0.24694298207759857,-0.20692388713359833,-0.20377379655838013,0.2815011143684387,0.0021830277983099222,-0.02378617413341999,0.01965342089533806,0.3234449326992035,0.07400252670049667,-0.16597019135951996,0.2083030492067337,0.10470160841941833,-0.11513775587081909,0.191597118973732,-0.09554190188646317,-0.14464892446994781,0.20717251300811768,0.20657436549663544,-0.024433566257357597,-0.27172088623046875,-0.24320368468761444},{0.21648693084716797,-0.22006411850452423,0.00019902651547454298,-0.33441051840782166,0.1324826031923294,-0.030296221375465393,0.17094913125038147,0.07662629336118698,0.2378474324941635,0.03865436837077141,0.15367142856121063,0.18395249545574188,-0.3753543496131897,-0.2177056521177292,-0.048439085483551025,-0.23202212154865265,-0.10469391942024231,-0.1987830549478531,0.2505042850971222,-0.233431875705719,0.24369527399539948,0.019587265327572823,-0.013782030902802944,0.17669382691383362,0.11098198592662811,-0.061842162162065506,0.1271987408399582,0.16280709207057953,0.12909358739852905,-0.07080388069152832,-0.18445323407649994,-0.10098178684711456},{0.220987468957901,-0.040419455617666245,-0.0581175871193409,0.40900442004203796,-0.0993087887763977,-0.18220952153205872,-0.07348199188709259,0.10792271792888641,0.15852923691272736,0.28545719385147095,0.1266063153743744,-0.15406790375709534,0.01148324552923441,0.20442581176757812,-0.0972188338637352,0.05901208519935608,0.20984555780887604,-0.22628675401210785,0.058213766664266586,-0.31570103764533997,0.30635926127433777,0.16408175230026245,-0.06009545549750328,0.18775099515914917,0.19390363991260529,0.07530907541513443,0.097832091152668,0.07038567960262299,0.04896384850144386,-0.15910553932189941,-0.029091116040945053,0.39126548171043396},{0.036428920924663544,-0.2782515287399292,-0.08046546578407288,0.11441261321306229,-0.247737318277359,-0.0052962470799684525,0.052216771990060806,-0.26522204279899597,-0.1726326197385788,-0.07196475565433502,0.18982785940170288,0.15944881737232208,0.0841403603553772,0.2628937065601349,-0.05460911616683006,-0.11001939326524734,-0.2186519056558609,0.25956568121910095,-0.08538797497749329,-0.2616385817527771,-0.19045843183994293,-0.0775085836648941,0.1717740148305893,-0.012541958130896091,-0.049122411757707596,-0.09134004265069962,-0.19581979513168335,0.22276341915130615,0.05730408430099487,-0.16677848994731903,0.2254578024148941,0.19966119527816772},{0.1457359343767166,-0.22386230528354645,-0.06492564082145691,-0.18269650638103485,-0.08585675805807114,0.1671150177717209,0.030971024185419083,0.2438877522945404,-0.07863727957010269,-0.016803191974759102,0.2704158425331116,0.12815169990062714,-0.024646470323204994,-0.10974618047475815,0.060016315430402756,0.13464686274528503,-0.38582462072372437,-0.2922156751155853,-0.043112367391586304,0.05229755491018295,0.11068163067102432,0.2260439097881317,0.2600197196006775,0.15209472179412842,0.04783915355801582,0.22499026358127594,0.020383285358548164,-0.0705992802977562,0.1917857676744461,-0.09200088679790497,-0.22673887014389038,0.3661232888698578},{0.21690993010997772,-0.03801985830068588,-0.23475968837738037,0.1500098556280136,0.07989102602005005,-0.07804100960493088,0.2750413715839386,0.12321687489748001,0.12143320590257645,-0.2013760358095169,0.19500017166137695,-0.16928640007972717,-0.33902862668037415,0.24269111454486847,0.06312285363674164,0.060703784227371216,0.05326983332633972,-0.05147388204932213,-0.14218811690807343,0.09623364359140396,-0.06908699870109558,0.16193178296089172,0.04701538383960724,-0.11790896207094193,0.04971124976873398,-0.34172841906547546,0.029996683821082115,0.37806421518325806,0.18541568517684937,-0.13087047636508942,0.19960977137088776,0.16415628790855408},{-0.10600007325410843,-0.03525066748261452,-0.11134897172451019,-0.03476320207118988,-0.23807373642921448,-0.03877510502934456,0.20638425648212433,0.13092176616191864,0.1415281593799591,0.02851690910756588,0.24683600664138794,-0.002023450331762433,0.20058593153953552,0.17127175629138947,0.18435229361057281,-0.1282556802034378,0.10862980037927628,0.1554444432258606,0.22720246016979218,0.04194217920303345,0.18757683038711548,0.2311425805091858,0.06242768093943596,0.12959063053131104,-0.0511615164577961,-0.07923281937837601,-0.10462421923875809,-0.27013686299324036,0.1702774316072464,-0.24145062267780304,-0.022803999483585358,-0.019887680187821388},{-0.2569887340068817,0.10946916043758392,-0.25625506043434143,-0.3347265124320984,-0.03794737532734871,0.071456179022789,0.09530070424079895,-0.06876974552869797,-0.01882053352892399,0.2722701132297516,0.060469869524240494,-0.18453383445739746,0.12545694410800934,-0.206680566072464,-0.30408862233161926,-0.02991691417992115,-0.17811380326747894,0.15100045502185822,-0.001539393444545567,-0.027492394670844078,-0.302467405796051,0.1567699909210205,0.11170319467782974,0.02276635356247425,-0.0018292006570845842,0.22421850264072418,0.041472550481557846,-0.13521261513233185,-0.17782096564769745,0.05138391628861427,-0.09669054299592972,-0.2313118427991867},{0.0033297801855951548,-0.2056226134300232,-0.2142149806022644,-0.01814582571387291,-0.3556388318538666,-0.1283586025238037,0.15342721343040466,-0.2925664484500885,-0.19969956576824188,0.18056805431842804,0.15298491716384888,0.12483011186122894,0.1387660652399063,-0.11724864691495895,0.3173743486404419,-0.3190004527568817,0.09469710290431976,0.24119019508361816,0.0625009536743164,0.23681040108203888,0.04300028830766678,-0.09823135286569595,-0.2774316966533661,0.17927779257297516,-0.18711386620998383,-0.17849697172641754,0.10693535953760147,0.05299907922744751,-0.11146465688943863,-0.29388290643692017,-0.006889632903039455,-0.14543470740318298},{0.2364959865808487,0.2110062688589096,-0.06889207661151886,0.17933833599090576,-0.288655549287796,0.1863163262605667,-0.06491978466510773,-0.1278885006904602,-0.19000244140625,0.17831705510616302,-0.2533261775970459,-0.15830036997795105,-0.029014522209763527,-0.1995798647403717,-0.35856908559799194,-0.11496150493621826,-0.07346951216459274,-0.2667232155799866,-0.23405839502811432,0.25636208057403564,0.09083114564418793,0.12598952651023865,-0.33342045545578003,0.31956109404563904,0.1860225647687912,0.24875299632549286,-0.2807595133781433,-0.0078105684369802475,0.07062313705682755,-0.25240519642829895,0.14473600685596466,0.09744597971439362},{-0.019300110638141632,-0.3145976960659027,0.00979990791529417,-0.24583466351032257,-0.10221604257822037,0.2762014865875244,0.13774503767490387,0.00978661049157381,-0.05384279042482376,0.0018335512140765786,-0.18481920659542084,0.19810830056667328,0.13661301136016846,0.08651455491781235,0.1900358945131302,-0.0424015074968338,-0.08578365296125412,0.0871175229549408,-0.07672960311174393,0.15587060153484344,0.2444063127040863,0.21700310707092285,-0.04484979808330536,-0.2789899706840515,0.05228592827916145,0.11435249447822571,0.2923295795917511,0.11871837079524994,-0.009963016957044601,0.2095029354095459,0.026698846369981766,-0.09400428086519241},{0.017283909022808075,-0.16785605251789093,0.22019389271736145,0.007635093294084072,0.2953144907951355,-0.03931469842791557,-0.11321591585874557,-0.15639419853687286,0.12816138565540314,-0.06465137004852295,0.07637584209442139,-0.0020452162716537714,-0.3160537779331207,0.01329852920025587,-0.09861961007118225,-0.22353793680667877,-0.05567833036184311,-0.053835365921258926,0.21589431166648865,0.2356591522693634,0.03830960392951965,0.04648636281490326,0.1842450201511383,0.3402180075645447,-0.14381031692028046,-0.03085630014538765,0.2042304128408432,-0.10911517590284348,-0.19091011583805084,-0.2500059902667999,0.2881190776824951,0.0010462870122864842},{0.17038138210773468,-0.09103833138942719,0.017398755997419357,0.14756669104099274,-0.023081477731466293,0.051635727286338806,-0.26720762252807617,0.23550006747245789,-0.045738328248262405,-0.023732025176286697,0.09186585992574692,-0.28528791666030884,-0.021404219791293144,-0.009891859255731106,-0.10858327895402908,0.2567899227142334,-0.08854445815086365,-0.2071995586156845,0.015124522149562836,-0.037752870470285416,-0.17206907272338867,0.20052754878997803,0.2227693796157837,0.20885467529296875,-0.30007198452949524,0.13181966543197632,-0.0700654461979866,0.07745067030191422,-0.2784002423286438,0.25279539823532104,-0.048378899693489075,0.047723475843667984}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.14561831951141357,-0.07461215555667877,0.04531475529074669,-0.10035192221403122},{0.17138777673244476,-0.29055511951446533,0.22469131648540497,0.19533346593379974},{-0.16161078214645386,0.07978016883134842,0.023952489718794823,-0.005903905723243952},{0.27718815207481384,0.4104940891265869,0.2929897606372833,0.03805612400174141},{-0.22440004348754883,0.10205931216478348,-0.252133309841156,0.06990564614534378},{-0.022680623456835747,-0.02863464131951332,0.04647063463926315,0.26539552211761475},{-0.11018721014261246,-0.07468775659799576,-0.25639069080352783,-0.02431812882423401},{-0.1197424829006195,-0.19862358272075653,0.095163494348526,-0.06911677867174149},{-0.01981632225215435,0.05060209333896637,-0.05417858064174652,-0.08011987805366516},{0.15880727767944336,0.002697096671909094,-0.07139259576797485,-0.09745224565267563},{0.12172156572341919,-0.0995892807841301,0.2593556344509125,0.22206196188926697},{0.01627410389482975,-0.008829422295093536,0.2311468869447708,-0.06055467575788498},{-0.28891700506210327,0.18101659417152405,-0.020256072282791138,-0.11502597481012344},{-0.13407886028289795,0.07659629732370377,-0.172437846660614,0.06099792569875717},{0.1578972339630127,0.04899930953979492,0.21037757396697998,0.07303957641124725},{-0.11279916018247604,-0.34515026211738586,-0.11433587223291397,-0.08275865018367767},{-0.18129423260688782,0.049478013068437576,-0.08762019127607346,0.21344390511512756},{-0.20489057898521423,-0.11775006353855133,-0.1943100094795227,0.15806293487548828},{-0.059588994830846786,-0.028279585763812065,0.27140259742736816,0.07091125100851059},{-0.13706229627132416,-0.1212330013513565,0.012082922272384167,-0.14603140950202942},{0.12449731677770615,0.08237341046333313,0.08239154517650604,-0.09951049834489822},{-0.02910754084587097,-0.1733567863702774,-0.06759724766016006,0.19596776366233826},{0.31834590435028076,-0.14988529682159424,0.12330224364995956,0.01519736647605896},{-0.2857432961463928,-0.12369385361671448,-0.29800617694854736,-0.279613196849823},{-0.12163186073303223,-0.12022626399993896,-0.04915545880794525,-0.096620112657547},{0.09714732319116592,0.07314792275428772,-0.020559679716825485,0.09633985161781311},{0.13681992888450623,-0.16224336624145508,0.19296810030937195,0.05357343703508377},{-0.08283179998397827,-0.12430161237716675,-0.006655190140008926,0.20305661857128143},{0.05895296111702919,0.028218626976013184,0.036875169724226,0.04211582988500595},{-0.12059389799833298,0.10123035311698914,0.1713397204875946,-0.004744375124573708},{-0.15873810648918152,-0.12454293668270111,0.05986117571592331,0.1387341171503067},{0.18023063242435455,0.1850455403327942,0.21496959030628204,-0.031956788152456284}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11591003835201263,-0.092652328312397,0.02614263817667961,0.08449927717447281,0.11659859120845795,-0.08993890136480331,0.07442355155944824,-0.029589980840682983,-0.05497639998793602,-0.0997912585735321,-0.010152988135814667,0.06754555553197861,-0.023257488384842873,0.049063704907894135,0.0923854410648346,-0.04514358565211296};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.04764961823821068,0.06359255313873291,0.015054479241371155,-0.01195281557738781,-0.01866166666150093,0.066035196185112,-0.05821453779935837,-0.07732561975717545,0.05702078342437744,0.008092410862445831,-0.015318989753723145,-0.04127423092722893,0.021635644137859344,-0.08145962655544281,0.004031242802739143,-0.06530771404504776};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0451657697558403,0.004989622160792351,-0.047450534999370575,0.033656854182481766,0.002448287094011903,0.017340216785669327,-0.05398743599653244,-0.041678961366415024,-0.025871165096759796,-0.012259216979146004,0.021151812747120857,0.041684191673994064,0.03953450545668602,-0.04286298528313637,0.032100241631269455,-0.0937153548002243,-0.0046934401616454124,-0.034005776047706604,0.03500836342573166,-0.047968748956918716,0.028068911284208298,-0.0021161804907023907,0.04036705568432808,-0.07195068895816803,-0.06115739047527313,0.0668589323759079,0.04798203334212303,-0.027340885251760483,0.08237958699464798,0.03586222231388092,-0.0015993444249033928,0.06481176614761353};
static const float action_parameterization_distribution_linear_bias[4] = {0.038291312754154205,0.07548100501298904,0.015546378679573536,0.04155035689473152};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3077651560306549,-0.12929248809814453,-0.011123026721179485,0.15465101599693298,0.030681617558002472,0.02558879740536213,-0.1911885291337967,0.026699921116232872},{0.024144034832715988,0.11849136650562286,0.2636772692203522,0.3107919991016388,-0.131710946559906,-0.21149230003356934,0.3156842887401581,0.09055273234844208},{0.0061047752387821674,0.22807812690734863,-0.0010520084761083126,-0.029864810407161713,0.27636438608169556,0.24773883819580078,-0.09957277774810791,0.03537237271666527},{0.12540480494499207,-0.20622117817401886,0.3104778528213501,-0.24538716673851013,-0.32209908962249756,0.011844358406960964,0.16861194372177124,0.16746193170547485},{-0.2098923921585083,0.01892988011240959,0.020915232598781586,-0.3509591817855835,0.03816491365432739,0.05358210578560829,0.21228525042533875,0.25823140144348145},{-0.05285879224538803,0.2672276794910431,-0.057888634502887726,-0.27885183691978455,0.11188140511512756,-0.02074037306010723,-0.0013885957887396216,-0.2026674896478653},{-0.020824948325753212,0.30927470326423645,0.20327363908290863,-0.19446992874145508,0.2009381204843521,-0.2971937358379364,0.25031739473342896,0.0782841145992279},{0.0064218249171972275,-0.2075771689414978,0.1308508664369583,-0.12617644667625427,0.3134578764438629,-0.1349533349275589,0.043549370020627975,-0.30095210671424866},{-0.15837323665618896,0.27382224798202515,0.1853892058134079,-0.009008239023387432,0.020812353119254112,0.20931470394134521,0.36487242579460144,0.35394278168678284},{0.06952212750911713,-0.06909509748220444,-0.2232099175453186,0.3690963089466095,0.24960343539714813,0.1423850804567337,0.1676139384508133,-0.2646944522857666},{-0.11613336950540543,-0.30966851115226746,0.3572673797607422,0.24590951204299927,-0.03266973793506622,-0.35229548811912537,-0.11383402347564697,-0.2941742241382599},{0.3378632962703705,0.0575798824429512,0.35317784547805786,0.499004989862442,-0.14077670872211456,0.17047889530658722,0.11467766761779785,-0.3129894435405731},{-0.2837248742580414,0.16948360204696655,-0.34535083174705505,0.39639419317245483,-0.04094076156616211,0.20089222490787506,0.024791644886136055,0.24182631075382233},{-0.030102385208010674,0.1849723905324936,-0.12539738416671753,-0.18993592262268066,0.023867441341280937,0.061665136367082596,0.3130224347114563,-0.06395971029996872},{0.14447015523910522,-0.29989367723464966,-0.26428598165512085,-0.19144047796726227,0.18824085593223572,-0.15892310440540314,0.18285909295082092,-0.16835176944732666},{-0.337993860244751,-0.30664312839508057,-0.2150457799434662,-0.04271453246474266,0.021891729906201363,0.14403007924556732,0.17686642706394196,-0.029943615198135376},{-0.24639162421226501,-0.2742008566856384,0.15647858381271362,-0.17701415717601776,0.01878785528242588,0.09829214215278625,-0.4038107693195343,-0.22409269213676453},{0.01539357379078865,0.2652108371257782,0.06727627664804459,0.2495432198047638,-0.15185211598873138,0.3381122648715973,0.2821328639984131,-0.1494389921426773},{-0.016713116317987442,-0.2805265486240387,-0.10281208157539368,0.00033245733357034624,-0.1078219935297966,-0.3547060787677765,0.07870502769947052,-0.20566102862358093},{-0.11901106685400009,0.01811695098876953,0.07575657963752747,-0.265027791261673,0.1228722408413887,0.02181735448539257,0.09402759373188019,0.020425263792276382},{0.03272194042801857,-0.0577533096075058,0.0817873552441597,-0.12114611268043518,0.08217447996139526,-0.03795298561453819,0.10491842031478882,-0.17608045041561127},{-0.2852218747138977,0.22927924990653992,0.20678825676441193,-0.280168741941452,-0.34737643599510193,-0.035301145166158676,0.2140762209892273,0.013076525181531906},{0.28031209111213684,0.05897832289338112,-0.40326517820358276,-0.03474750742316246,-0.10206714272499084,0.21271362900733948,0.20305243134498596,0.2499723583459854},{0.010520203039050102,-0.22386471927165985,-0.045375432819128036,0.10959713160991669,-0.36810413002967834,-0.09577637910842896,-0.3084506690502167,-0.3355439007282257},{0.13121899962425232,-0.13305261731147766,-0.3453735113143921,0.34990355372428894,-0.32373252511024475,-0.08082195371389389,-0.45486995577812195,0.06984824687242508},{0.0021824263967573643,0.3031063377857208,-0.12867699563503265,-0.06339371204376221,0.10149573534727097,-0.13507741689682007,0.22690081596374512,-0.30329787731170654},{-0.0896875336766243,0.1264083832502365,-0.048444878309965134,-0.24683766067028046,0.044090189039707184,-0.13766252994537354,-0.18881699442863464,-0.09028749167919159},{0.07995902746915817,-0.1554671823978424,0.035075727850198746,-0.10241944342851639,0.08340699225664139,0.07821184396743774,-0.2929086685180664,0.14119493961334229},{0.19167879223823547,0.03676571696996689,-0.28346166014671326,-0.13932164013385773,-0.17052744328975677,0.16825881600379944,0.16265496611595154,0.06634924560785294},{0.26919594407081604,-0.3950916826725006,0.013264226727187634,-0.06353858858346939,0.07486113905906677,-0.12112239748239517,0.11756742745637894,0.2321254462003708},{-0.3279935121536255,-0.26423439383506775,0.030874503776431084,-0.36879962682724,0.25143301486968994,-0.4099528193473816,-0.07482614368200302,0.06555595248937607},{0.292540580034256,0.19431158900260925,-0.012549083679914474,0.1729227751493454,0.10072562098503113,-0.2532186210155487,-0.08169133961200714,0.14944088459014893}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.1897786259651184,0.3684498965740204,-0.4245498776435852,-0.4857775568962097,-0.15821215510368347,-0.11836815625429153,-0.32733356952667236,0.4649171531200409},{0.01688571088016033,0.3520435094833374,-0.2240913212299347,0.43955597281455994,-0.037586893886327744,-0.0787530243396759,-0.3113853633403778,-0.06627140194177628},{-0.2735179364681244,-0.2078588455915451,-0.14699605107307434,-0.16825753450393677,0.38811221718788147,0.2000454217195511,-0.10885010659694672,0.3531922996044159},{-0.45037734508514404,-0.4153467118740082,0.2814449965953827,0.1763731688261032,-0.48186179995536804,-0.18748526275157928,0.3954087793827057,0.2091740369796753},{-0.2571466863155365,-0.19663867354393005,-0.2815513610839844,-0.17883428931236267,0.31326794624328613,-0.21410781145095825,0.39034512639045715,-0.3147864043712616},{-0.054176684468984604,0.2843390107154846,0.08123914152383804,-0.5752584934234619,0.5101839900016785,-0.2151569128036499,-0.4961034059524536,-0.3340575397014618},{-0.24903088808059692,0.09882097691297531,0.0499291867017746,-0.3968461751937866,0.0519530326128006,-0.44638654589653015,0.3709838390350342,0.08431120961904526},{-0.2677295506000519,-0.12531563639640808,-0.10640858113765717,-0.3423934578895569,-0.35514891147613525,0.06744245439767838,0.5416994094848633,-0.31602591276168823}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04776236042380333,-0.07462657243013382,-0.08988875895738602,0.04316934570670128,0.13773708045482635,0.017474712803959846,0.06825696676969528,0.015416929498314857};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.009967811405658722,0.018618497997522354,-0.021888822317123413,-0.06681275367736816,-0.06453780084848404,-0.021109679713845253,0.022706810384988785,-0.14901864528656006};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

