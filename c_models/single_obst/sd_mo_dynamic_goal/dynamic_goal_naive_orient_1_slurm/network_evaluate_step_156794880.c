#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.27445918321609497,-0.09850522875785828,0.2962390184402466,0.17681707441806793,-0.33608487248420715,0.24630510807037354,-0.05791100114583969,-0.15233798325061798,0.12608139216899872,0.30301401019096375,0.1052364856004715,0.042421672493219376,0.2497294545173645,-0.2606932818889618,0.2784116268157959,-0.05749184265732765},{-0.16749081015586853,-0.40469399094581604,0.34357941150665283,0.1571180373430252,-0.2925497591495514,0.15494701266288757,-0.414088636636734,-0.014427205547690392,-0.08886872977018356,-0.20747624337673187,0.05462883040308952,-0.2505744397640228,-0.013975385576486588,-0.30988723039627075,-0.24746839702129364,0.07774613052606583},{-0.02509523555636406,-0.2457207590341568,-0.32511547207832336,0.16768276691436768,0.18707877397537231,0.4438796043395996,0.10152620077133179,-0.04907216504216194,-0.03131220489740372,-0.4013516306877136,-0.42319047451019287,0.6919867396354675,-0.1355692744255066,-0.26421216130256653,-0.3192121982574463,0.24324338138103485},{0.12909114360809326,0.23503832519054413,0.3972605764865875,-0.03522110357880592,-0.42334887385368347,-0.024150053039193153,0.29573366045951843,0.05145086720585823,0.2886439859867096,-0.40134310722351074,0.023134270682930946,0.3944988250732422,-0.2633402943611145,0.0946759283542633,0.44554996490478516,-0.46797898411750793},{-0.1046559065580368,-0.06009979546070099,0.30976125597953796,-0.03804773464798927,0.3410167098045349,0.4501916766166687,0.21725529432296753,-0.018095051869750023,0.15373508632183075,0.21292205154895782,0.30656230449676514,-0.35632917284965515,-0.31400546431541443,-0.39512819051742554,0.4406226575374603,0.06699976325035095},{-0.18095305562019348,-0.19853664934635162,-0.22171837091445923,-0.1377960443496704,0.1762939989566803,0.1746222972869873,0.0628604143857956,-0.13660573959350586,0.3780713379383087,-0.27817562222480774,-0.41398194432258606,0.22076644003391266,0.22126972675323486,-0.12599949538707733,-0.07095524668693542,0.07230892777442932},{0.06237111985683441,0.03616388142108917,0.06987795978784561,-0.45086807012557983,0.2184358388185501,0.014704201370477676,0.09921586513519287,0.4125458598136902,0.3355889618396759,0.053769707679748535,-0.4421146810054779,0.011540676467120647,-0.0810856819152832,0.1423102170228958,-0.15559472143650055,-0.2532404959201813},{-0.2804339528083801,0.26829758286476135,0.2609426975250244,0.40281859040260315,-0.4422610104084015,-0.03980126976966858,0.42902737855911255,0.43759265542030334,-0.148784339427948,0.3796577453613281,-0.5916842222213745,-0.3088732957839966,0.3336334526538849,0.18541443347930908,0.25694549083709717,0.33330458402633667},{0.3361077606678009,-0.2501283586025238,0.6046448349952698,0.1144399493932724,0.05992855131626129,0.0840151235461235,0.18434171378612518,-0.501755952835083,-0.14724402129650116,-0.48021140694618225,-0.17329087853431702,-0.048227034509181976,-0.13810904324054718,0.6223956942558289,0.4645902216434479,-0.2651147246360779},{0.25803086161613464,-0.5941828489303589,-0.50494784116745,-0.20454488694667816,-0.25597354769706726,0.20055200159549713,0.23220358788967133,0.20041964948177338,0.525331974029541,0.25834885239601135,0.08404974639415741,-0.31700533628463745,-0.04951682314276695,0.40264302492141724,-0.11577558517456055,-0.5068351030349731},{0.21051621437072754,0.3544756770133972,0.43882814049720764,-0.6124166250228882,-0.3429397940635681,0.1628997027873993,0.18357768654823303,0.4890690743923187,-0.3445665240287781,0.05148780718445778,-0.14543460309505463,0.020842505618929863,-0.2080061435699463,-0.21382926404476166,0.30975738167762756,-0.3477793335914612},{-0.07089168578386307,-0.33748531341552734,0.18186932802200317,0.5026052594184875,0.6738130450248718,0.44685259461402893,0.3613676428794861,0.34006768465042114,-0.01847018115222454,0.04787294939160347,0.22522759437561035,-0.3387726843357086,-0.5349277257919312,-0.43761515617370605,0.6178798079490662,0.026875115931034088},{-0.2863142788410187,0.44777384400367737,0.006017404608428478,-0.6046195030212402,0.10442031919956207,0.011608666740357876,0.14375030994415283,0.16355794668197632,0.08578819036483765,0.12036154419183731,0.0023215082474052906,0.15122947096824646,0.4660830497741699,0.3502540588378906,-0.03730848804116249,-0.12636442482471466},{0.07714293897151947,-0.36213555932044983,-0.22425954043865204,-0.1455259770154953,-0.49817174673080444,0.023457322269678116,-0.18471291661262512,-0.23992663621902466,-0.22864247858524323,-0.11861300468444824,-0.4641748070716858,0.002491491846740246,-0.2067718207836151,0.5339193344116211,0.24749602377414703,-0.009881965816020966},{0.05551813170313835,-0.3088405728340149,-0.2662414610385895,0.19267146289348602,-0.08151450753211975,-0.35575759410858154,0.3057093024253845,-0.07071607559919357,0.02097727730870247,0.29260239005088806,0.07963196188211441,0.12740448117256165,0.28985676169395447,-0.05398503690958023,-0.3207849860191345,0.2653603255748749},{0.33686670660972595,-0.0001223157305503264,-0.22543850541114807,-0.21169413626194,-0.3574812114238739,0.2210286557674408,0.3561098277568817,-0.10497501492500305,0.20882099866867065,0.3735436797142029,-0.1526302993297577,0.08187679201364517,-0.25166788697242737,0.2786141037940979,-0.11411773413419724,-0.016400376334786415},{-0.24200329184532166,-0.21021004021167755,0.20965872704982758,0.16229936480522156,-0.22142235934734344,0.11627861857414246,-0.21679329872131348,-0.14490902423858643,-0.2249596267938614,-0.26698052883148193,-0.08586840331554413,-0.29035380482673645,0.12628711760044098,-0.25783294439315796,0.017041612416505814,-0.2106803059577942},{-0.2895957827568054,0.22311344742774963,-0.3853059709072113,-0.22614526748657227,0.0208125039935112,0.36546942591667175,-0.223703071475029,-0.24091720581054688,0.18393009901046753,0.17846758663654327,0.35101252794265747,-0.07253645360469818,-0.37572988867759705,0.3176499009132385,0.032468389719724655,-0.41276800632476807}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.069487564265728,-0.03207394853234291,-0.11033625155687332,-0.3524661660194397,0.3389720618724823,0.31330612301826477,0.08842132240533829,0.03842255100607872,-0.13152188062667847,-0.1344785988330841,-0.048409245908260345,0.07813601940870285,0.17951351404190063,0.3735508322715759,0.0894634798169136,0.06562114506959915},{-0.23499731719493866,-0.30100637674331665,-0.04545404016971588,0.09396181255578995,0.2419755458831787,-0.34127068519592285,0.07924967259168625,0.07450861483812332,-0.0909440815448761,0.25055789947509766,-0.25044187903404236,0.293456494808197,-0.358863890171051,0.20076517760753632,-0.4476729929447174,-0.350761353969574},{0.10940318554639816,0.21292904019355774,-0.34758681058883667,-0.5103311538696289,0.15511205792427063,0.5111476182937622,-0.0884234681725502,0.06591033190488815,-0.25596845149993896,-0.30321264266967773,0.015205762349069118,0.34974047541618347,-0.31004148721694946,-0.22533346712589264,0.1300538182258606,-0.0674244835972786},{0.19483374059200287,-0.04635594040155411,0.07651370763778687,0.19208592176437378,-0.5234913229942322,0.010823908261954784,0.08733951300382614,-0.18859554827213287,0.30504748225212097,0.3745177984237671,-0.1845807433128357,-0.1216609925031662,-0.44650882482528687,-0.43413108587265015,0.15751667320728302,0.1775079071521759},{-0.15368454158306122,0.1372087001800537,-0.02031616121530533,0.24754004180431366,-0.2577277421951294,0.05582645162940025,0.011956384405493736,0.13795867562294006,0.29098862409591675,-0.31276175379753113,0.19388505816459656,0.31937262415885925,0.19557411968708038,-0.4517289698123932,0.021378343924880028,-0.011587081477046013},{0.24672190845012665,0.2540523409843445,-0.05199737846851349,0.19416919350624084,-0.46682795882225037,-0.42308714985847473,0.22699172794818878,0.27963703870773315,0.13234339654445648,0.3554077446460724,0.23077930510044098,-0.2180551141500473,-0.02939700335264206,-0.16891741752624512,-0.025107651948928833,0.2813163697719574},{-0.09808334708213806,0.26789432764053345,0.28081366419792175,-0.3754681646823883,-0.25053679943084717,0.025475135073065758,-0.3345594108104706,-0.06905636191368103,0.1604507565498352,0.08857936412096024,-0.1497417837381363,-0.20461855828762054,-0.33735349774360657,-0.03039715625345707,0.21174393594264984,0.0377214215695858},{-0.1747615784406662,-0.14539194107055664,-0.49376052618026733,0.2826819121837616,-0.3510434031486511,-0.2487238049507141,-0.24276967346668243,-0.41900238394737244,0.13032682240009308,-0.281235933303833,0.025906329974532127,0.1322747766971588,-0.18949374556541443,0.42966794967651367,-0.07572972029447556,-0.3712226450443268},{-0.31621575355529785,0.2679709494113922,0.010624391958117485,-0.02166271023452282,0.2757636308670044,-0.2548653185367584,0.33183932304382324,0.14533917605876923,0.3203408420085907,0.30448850989341736,0.2612799108028412,0.3223121762275696,0.18436527252197266,-0.05017624795436859,0.2764354944229126,0.11649414151906967},{0.041764311492443085,-0.2741852402687073,-0.1924913227558136,-0.09816551208496094,0.28330251574516296,-0.18612109124660492,-0.2920306921005249,-0.17927564680576324,0.09055987000465393,-0.3853866457939148,-0.2883506715297699,0.3616577684879303,0.12282118201255798,0.17002202570438385,-0.38219937682151794,0.23241673409938812},{-0.08360247313976288,-0.46274399757385254,0.35112661123275757,0.3087047040462494,0.2286515235900879,0.17423363029956818,0.2101416438817978,-0.16289930045604706,0.2616092562675476,-0.31283286213874817,0.21146728098392487,0.4030085802078247,0.5166236758232117,0.10698202252388,-0.13859708607196808,0.10550551116466522},{0.0623960942029953,0.001457041478715837,0.38319632411003113,-0.020048927515745163,-0.24780529737472534,-0.1653500348329544,0.43167123198509216,0.28594762086868286,-0.2738535702228546,-0.20437884330749512,-0.10995107889175415,-0.3099471926689148,-0.045837562531232834,-0.2935400903224945,-0.40151694416999817,0.03810130059719086},{-0.09818381816148758,-0.3180422782897949,0.4005412757396698,-0.20873108506202698,0.3576716184616089,-0.30843108892440796,-0.4730830788612366,0.0841289684176445,0.08671405166387558,0.06838332861661911,-0.3319132924079895,0.12942102551460266,0.09963757544755936,-0.26786836981773376,-0.41201671957969666,-0.001439975225366652},{0.3279213011264801,-0.3429010212421417,0.4740864038467407,0.07133996486663818,-0.049604035913944244,0.30600693821907043,-0.10874190181493759,-0.23020152747631073,-0.45890161395072937,0.1224367693066597,-0.011642426252365112,-0.3827868103981018,-0.09200482070446014,0.1614726185798645,0.2862520217895508,0.029492216184735298},{-0.11346561461687088,0.23460927605628967,0.12699052691459656,-0.4148401916027069,-0.22715184092521667,0.20005205273628235,0.298068642616272,-0.23337437212467194,0.17631466686725616,-0.3368293344974518,0.03529941663146019,0.0958782508969307,-0.06343275308609009,0.14949500560760498,-0.0049085174687206745,0.08325012028217316},{-0.23054800927639008,0.3848191499710083,-0.42604687809944153,0.3678547143936157,0.13987337052822113,-0.42971116304397583,-0.024502452462911606,-0.08463634550571442,-0.3146689236164093,0.36298078298568726,-0.359242707490921,0.31253406405448914,-0.06446358561515808,-0.27456575632095337,-0.2712126672267914,-0.5130120515823364}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.18865928053855896,0.14425894618034363,-0.05675426870584488,-0.03088897280395031,-0.12906579673290253,0.056959282606840134,0.2750011682510376,0.08113254606723785,-0.22366662323474884,-0.16363666951656342,0.1611778885126114,-0.30958253145217896,-0.2466259002685547,0.22288919985294342,0.2468116283416748,0.31479379534721375,-0.2634568214416504,-0.29231491684913635,-0.21045659482479095,0.0880761668086052,-0.07480983436107635,-0.2968011498451233,-0.20516976714134216,-0.32040873169898987,-0.29627901315689087,0.20420491695404053,-0.19305624067783356,0.006614343728870153,-0.00980860274285078,-0.034899402409791946,0.2349996268749237,-0.22413453459739685},{0.2692369222640991,0.18714675307273865,0.1544884741306305,-0.13741950690746307,0.16605593264102936,-0.08069354295730591,0.41901737451553345,0.13757090270519257,-0.18934538960456848,-0.09636358171701431,-0.10376793146133423,-0.3140910565853119,-0.1717093139886856,0.27807167172431946,-0.23665501177310944,-0.20078453421592712,-0.006051389034837484,0.24473583698272705,-0.3808870017528534,-0.23804013431072235,-0.07854706794023514,0.2925560474395752,0.05956627056002617,0.0067131370306015015,0.20641061663627625,-0.3517304062843323,-0.04359015077352524,0.12736167013645172,0.17214806377887726,-0.15144453942775726,-0.01244699489325285,0.14853133261203766},{0.12743303179740906,0.019847560673952103,-0.1761278212070465,0.15049836039543152,-0.1934465765953064,-0.21235409379005432,-0.21036413311958313,0.03790847584605217,-0.13621871173381805,0.42907682061195374,-0.30833208560943604,-0.2959422469139099,0.1035718098282814,-0.4024617373943329,-0.18231767416000366,0.1025129035115242,-0.15670062601566315,-0.15197527408599854,0.14644849300384521,-0.1147489920258522,0.2704726755619049,0.270916223526001,-0.2355220764875412,0.02451668493449688,-0.28459998965263367,0.01867133006453514,0.1279638260602951,-0.12855054438114166,-0.010954600758850574,-0.27852293848991394,-0.18957827985286713,-0.06257528066635132},{0.4641607105731964,0.044301267713308334,0.18408747017383575,-0.15156641602516174,-0.2906358242034912,-0.06139750778675079,-0.19286681711673737,0.32234564423561096,0.26481473445892334,-0.33633601665496826,-0.07711305469274521,0.36233338713645935,0.10618900507688522,-0.09293907135725021,-0.2284131646156311,0.2953794300556183,-0.3032504916191101,0.2268744558095932,0.08124731481075287,0.1441146582365036,-0.05605359748005867,-0.1525469571352005,0.2896135747432709,0.17168056964874268,0.2282448709011078,-0.4289550483226776,0.2955012321472168,-0.2299572378396988,-0.07944124937057495,0.15994545817375183,-0.19704799354076385,0.17281578481197357},{-0.06339871883392334,-0.07186854630708694,-0.1245381087064743,0.18381890654563904,0.170973002910614,-0.2162138819694519,-0.46767666935920715,-0.09166181087493896,-0.09067129343748093,-0.25161394476890564,0.11743570864200592,0.2730030417442322,-0.03715867921710014,-0.1776830404996872,-0.07849738001823425,0.0937729924917221,-0.09891685098409653,-0.12392711639404297,-0.3062475323677063,-0.19761249423027039,-0.06712154299020767,-0.4506899118423462,0.17965516448020935,0.14453503489494324,-0.134560689330101,0.3721857964992523,-0.17301416397094727,0.13022500276565552,0.3872743248939514,0.39743244647979736,-0.11535290628671646,0.4517240822315216},{-0.3629523515701294,0.04662699997425079,-0.30196550488471985,-0.07241027057170868,-0.2500514090061188,0.2705385982990265,0.23161976039409637,0.02315087616443634,0.1934977024793625,0.2933366298675537,0.3698579668998718,-0.279171347618103,-0.3231826424598694,0.16635078191757202,0.375858873128891,-0.3261876404285431,-0.16499048471450806,-0.26890283823013306,0.20106607675552368,0.1036149188876152,0.08777138590812683,0.21947349607944489,0.1245712861418724,-0.10881994664669037,-0.4240775406360626,0.42102503776550293,-0.1189132109284401,0.23492120206356049,0.3960818350315094,0.1218453124165535,0.04604335501790047,0.0069585079327225685},{0.1766255795955658,-0.14606519043445587,-0.1489832103252411,-0.3621728718280792,-0.056128669530153275,0.21373870968818665,0.3446577787399292,0.17661230266094208,0.059596944600343704,0.4212895631790161,-0.015933262184262276,-0.0479695163667202,-0.4378851354122162,-0.1616899073123932,-0.15756429731845856,0.1687048226594925,-0.31989577412605286,-0.2286185324192047,0.18221764266490936,-0.06578085571527481,-0.13114109635353088,-0.1328125149011612,-0.2127196043729782,-0.20551684498786926,0.14447836577892303,-0.24938441812992096,-0.09293333441019058,-0.23755896091461182,0.30357202887535095,0.052661243826150894,-0.2022530883550644,-0.3179624080657959},{0.020114010199904442,0.16051116585731506,0.04840502515435219,-0.046450719237327576,0.1323254555463791,-0.34279394149780273,-0.09047259390354156,-0.18256297707557678,-0.028233105316758156,-0.2067321538925171,-0.3307698965072632,-0.08258336782455444,-0.10601974278688431,0.013669626787304878,-0.1390203833580017,0.3992074728012085,-0.03332905471324921,-0.173464834690094,0.08641484379768372,0.33671846985816956,-0.12395966798067093,-0.23112864792346954,0.2712254524230957,0.11031565815210342,-0.04000887647271156,-0.3239436745643616,-0.32692083716392517,-0.3164692223072052,-0.3418844938278198,-0.2939356565475464,0.025196149945259094,-0.32385048270225525},{0.10924030840396881,0.40087446570396423,-0.2769286334514618,-0.3741203546524048,-0.25508755445480347,0.14246289432048798,0.06835832446813583,0.1319097876548767,0.04575794190168381,-0.3036175072193146,-0.12174291908740997,0.3372141420841217,-0.2954026758670807,-0.1820506900548935,0.22969242930412292,-0.25479093194007874,0.2791549265384674,0.18395942449569702,0.4015669822692871,0.03845815360546112,0.15378329157829285,0.1452106386423111,0.30813491344451904,-0.13443231582641602,0.4108166992664337,-0.27013808488845825,0.18189352750778198,0.385650098323822,-0.29322147369384766,0.20600198209285736,0.05416417866945267,0.12508997321128845},{-0.1752409189939499,0.08745463937520981,-0.26568010449409485,-0.1568642258644104,0.19072534143924713,-0.20422151684761047,0.1134108155965805,-0.018962444737553596,0.1868368685245514,-0.02035382203757763,-0.31907591223716736,-0.3198758065700531,-0.3246837258338928,-0.058434855192899704,-0.2787991166114807,0.11404566466808319,0.044521916657686234,-0.21981853246688843,0.2151859998703003,0.12208196520805359,0.02701784297823906,-0.03878038004040718,0.27471670508384705,-0.1625564694404602,0.3190220892429352,0.10492229461669922,-0.28844794631004333,-0.012914692983031273,-0.035693712532520294,0.10801289975643158,-0.16290196776390076,0.07457379996776581},{0.1130373477935791,0.10083956271409988,0.17399270832538605,-0.29717588424682617,-0.41385364532470703,-0.22414544224739075,-0.2903851568698883,0.06040406972169876,-0.3285558819770813,0.4804217517375946,0.2184831202030182,-0.20391204953193665,-0.44505512714385986,-0.12232690304517746,-0.13189135491847992,-0.09011789411306381,0.1506100296974182,-0.19384807348251343,0.3298867344856262,-0.1256968379020691,-0.16503047943115234,0.025993233546614647,0.2734832465648651,0.198368638753891,0.17538100481033325,-0.1823086142539978,0.07678660750389099,-0.07576961070299149,-0.03851376846432686,0.016638925299048424,-0.025006406009197235,0.13166069984436035},{-0.15820574760437012,-0.08408036828041077,0.22487160563468933,0.27557438611984253,0.25659698247909546,-0.0003223762905690819,0.058606140315532684,-0.18993371725082397,-0.07264135032892227,-0.2862194776535034,0.29305678606033325,-0.2031630128622055,-0.19738906621932983,-0.20918895304203033,0.276794970035553,-0.0019626040011644363,0.0013320716097950935,0.02975628711283207,0.40032485127449036,0.06410878896713257,-0.19061978161334991,0.2411700189113617,0.1260155737400055,-0.08260133862495422,0.2541060447692871,-0.13101314008235931,-0.13808712363243103,0.23373077809810638,0.16013912856578827,0.029336221516132355,-0.26496899127960205,-0.22900384664535522},{0.367227703332901,-0.20866763591766357,0.02207406796514988,-0.2520778179168701,-0.10871041566133499,-0.17495097219944,0.00033918966073542833,0.21214202046394348,0.1750151515007019,0.07171282172203064,0.2318374365568161,0.3728220462799072,-0.44134029746055603,-0.4854702353477478,0.03760776296257973,-0.26054295897483826,-0.32332780957221985,-0.4041861593723297,0.42316991090774536,-0.20102612674236298,0.4322960376739502,-0.1735180914402008,0.10113564133644104,0.1468045562505722,0.15228842198848724,-0.17086908221244812,0.20862314105033875,-0.0026261606253683567,0.15693925321102142,0.07621460407972336,-0.301167368888855,0.09130820631980896},{0.26667794585227966,-0.04848053678870201,-0.0035669198259711266,0.3850618898868561,-0.09426053613424301,-0.20031698048114777,-0.05542386695742607,0.15404750406742096,0.21023233234882355,0.26033827662467957,0.1104627251625061,-0.09771627932786942,0.07118037343025208,0.19783322513103485,-0.11497252434492111,0.09991828352212906,0.22296835482120514,-0.24489398300647736,0.10771118849515915,-0.3528441786766052,0.29122409224510193,0.12511153519153595,-0.10252082347869873,0.20976342260837555,0.24796374142169952,0.08297489583492279,0.13919705152511597,0.05674825608730316,0.08608871698379517,-0.13119861483573914,0.003370919032022357,0.3861787021160126},{0.026118187233805656,-0.17141391336917877,-0.052697114646434784,0.08745308220386505,-0.2938723564147949,0.04709548503160477,0.06319141387939453,-0.20948411524295807,-0.22617241740226746,-0.0149720823392272,0.22441630065441132,0.1681557595729828,0.03970044478774071,0.23654749989509583,-0.0018785278080031276,-0.04093240201473236,-0.21229617297649384,0.290508508682251,-0.07798219472169876,-0.23036828637123108,-0.2337404042482376,-0.03955588489770889,0.18828773498535156,0.010722288861870766,-0.04125039279460907,-0.10785719007253647,-0.15034374594688416,0.27052634954452515,0.08068490028381348,-0.176513671875,0.29391682147979736,0.12513133883476257},{0.16759775578975677,-0.18779638409614563,-0.00860646739602089,-0.19514746963977814,-0.03796985000371933,0.16920799016952515,0.05951835587620735,0.27997374534606934,-0.15447290241718292,-0.0023771740961819887,0.25995925068855286,0.11218522489070892,0.041278161108493805,-0.1122942566871643,0.013679075986146927,0.20154938101768494,-0.36637377738952637,-0.20957618951797485,-0.02867574244737625,0.06089987978339195,0.03756146505475044,0.2712448835372925,0.20096881687641144,0.15407338738441467,0.044126417487859726,0.18465322256088257,0.002862955443561077,-0.047820642590522766,0.12146288901567459,-0.12585411965847015,-0.25385186076164246,0.3124290704727173},{0.12391270697116852,0.01402241736650467,-0.3770826458930969,0.16511961817741394,0.07950972765684128,-0.006167269311845303,0.3211559057235718,0.058986030519008636,0.11105601489543915,-0.14493697881698608,0.2094571590423584,-0.264934241771698,-0.43252694606781006,0.276282399892807,0.09021341055631638,0.028780348598957062,0.03242390975356102,-0.09568076580762863,-0.1786096841096878,0.011249260045588017,-0.048479512333869934,0.22879621386528015,0.06642704457044601,-0.19155298173427582,-0.11236128211021423,-0.1673130989074707,0.04417559877038002,0.36734676361083984,0.2532943785190582,-0.1842067539691925,0.20288890600204468,0.19496560096740723},{-0.07643353939056396,-0.008446427062153816,-0.08608999848365784,-0.08402279019355774,-0.22942334413528442,-0.014135199598968029,0.24369214475154877,0.17577804625034332,0.1453775316476822,-0.004210588987916708,0.19584578275680542,-0.023887446150183678,0.21525324881076813,0.2231910526752472,0.1704370379447937,-0.08095398545265198,0.1394246518611908,0.20444296300411224,0.21327932178974152,0.040236588567495346,0.15664969384670258,0.2924109995365143,0.0683765560388565,0.15517917275428772,-0.02369762398302555,-0.06666151434183121,-0.14120438694953918,-0.215269535779953,0.13184531033039093,-0.27423834800720215,0.057877067476511,-0.08102495968341827},{-0.35772258043289185,0.012767729349434376,-0.38531163334846497,-0.3333146870136261,0.04205625504255295,-0.02140141651034355,0.16009511053562164,-0.19887256622314453,0.07500166445970535,0.38512057065963745,0.007409170735627413,-0.2705690860748291,0.04710885137319565,-0.17675547301769257,-0.33320415019989014,0.019040605053305626,-0.1970219761133194,0.11067621409893036,-0.11910244822502136,-0.018612883985042572,-0.2893579304218292,0.15699680149555206,0.09470687061548233,0.06965883821249008,-0.09179087728261948,0.36280813813209534,0.036915116012096405,-0.21436285972595215,-0.19157223403453827,-0.015801072120666504,-0.23033586144447327,-0.2696011960506439},{0.0012007617624476552,-0.2647053599357605,-0.27314290404319763,-0.04565063863992691,-0.31294581294059753,-0.15122228860855103,0.17827123403549194,-0.28068220615386963,-0.2210092544555664,0.17053306102752686,0.17908087372779846,0.09041160345077515,0.1219031810760498,-0.13670165836811066,0.27045634388923645,-0.2574494779109955,0.10802242159843445,0.26657864451408386,0.0405418686568737,0.2863525450229645,0.015723664313554764,-0.11438887566328049,-0.29592880606651306,0.2370256781578064,-0.10806910693645477,-0.15565581619739532,0.10979542881250381,0.038507480174303055,-0.12595000863075256,-0.3252919912338257,-0.037451114505529404,-0.18626724183559418},{0.21257638931274414,0.08740196377038956,-0.09942124038934708,0.23783589899539948,-0.26777133345603943,0.039154503494501114,-0.09723354130983353,-0.24300295114517212,-0.07486635446548462,0.28155890107154846,-0.36914947628974915,-0.1504414826631546,0.035443030297756195,-0.22571627795696259,-0.400542676448822,-0.20936106145381927,-0.16731765866279602,-0.37207603454589844,-0.3016984760761261,0.25050073862075806,0.20991984009742737,0.03298144042491913,-0.3764709234237671,0.3535001873970032,0.11538529396057129,0.3173324763774872,-0.3423856496810913,-0.17802457511425018,0.12327384203672409,-0.23898765444755554,0.03741195425391197,0.18047712743282318},{-0.05503655597567558,-0.30283668637275696,-0.0370393767952919,-0.30681419372558594,-0.0499153696000576,0.30165019631385803,0.20555050671100616,0.02672361023724079,-0.10296300053596497,0.002163582481443882,-0.173226460814476,0.09425167739391327,0.10796196013689041,0.08086822181940079,0.1099059209227562,0.04287946969270706,-0.05482880771160126,0.1587161272764206,-0.1239686906337738,0.15686465799808502,0.18234829604625702,0.26892244815826416,-0.05164460465312004,-0.2419503927230835,0.16675640642642975,0.1681288778781891,0.2659473717212677,0.17395943403244019,0.017925148829817772,0.10607050359249115,0.01982061006128788,-0.10605662316083908},{0.026964398100972176,-0.229294553399086,0.29735007882118225,0.03640645742416382,0.30916857719421387,-0.07007452845573425,-0.1391190141439438,-0.17912867665290833,0.16883344948291779,-0.05250019580125809,0.03642551600933075,0.03404533118009567,-0.2279992550611496,0.06553759425878525,-0.13359282910823822,-0.2689152657985687,-0.05171950161457062,-0.0412970632314682,0.18824602663516998,0.23824365437030792,0.04271695390343666,0.012074696831405163,0.14037324488162994,0.3497134745121002,-0.1440456211566925,-0.08782656490802765,0.14020943641662598,-0.12039914727210999,-0.18802420794963837,-0.23747912049293518,0.28067463636398315,0.004102212842553854},{0.20764072239398956,-0.08424810320138931,0.06134286895394325,0.10585598647594452,-0.03007330745458603,0.06538243591785431,-0.24408793449401855,0.32539308071136475,-0.11404888331890106,-0.05235302075743675,0.12294765561819077,-0.2912256121635437,0.03508565202355385,-0.0578196719288826,-0.11451728641986847,0.34571245312690735,-0.06137118488550186,-0.17918820679187775,0.043769512325525284,0.019929932430386543,-0.19109532237052917,0.1887640655040741,0.20999042689800262,0.2400040477514267,-0.2501002252101898,0.11066187173128128,-0.06056180223822594,0.09197193384170532,-0.2911926805973053,0.26939553022384644,-0.041461143642663956,0.040876541286706924}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.29196980595588684,-0.14884288609027863,0.1807970255613327,-0.2204752266407013},{0.22085633873939514,-0.2779140770435333,0.27582377195358276,0.253704696893692},{-0.4005390405654907,0.039248302578926086,0.2180708646774292,-0.04143601283431053},{0.30073612928390503,0.5561422109603882,0.35023435950279236,0.016330162063241005},{-0.35313448309898376,0.22511008381843567,-0.3159032166004181,0.1292802393436432},{0.007132889237254858,-0.1569865345954895,0.05649661645293236,0.48334547877311707},{-0.11085081100463867,-0.22768695652484894,-0.508266031742096,0.08019372820854187},{-0.12947708368301392,-0.41688376665115356,0.23019173741340637,-0.04502888396382332},{-0.15720278024673462,0.20431043207645416,-0.0790642499923706,-0.15069885551929474},{0.3689197301864624,-0.018410449847579002,-0.19542153179645538,-0.2873425781726837},{0.2848206162452698,-0.2682637870311737,0.4000508487224579,0.33973467350006104},{-0.12051253020763397,0.002587583614513278,0.5727394223213196,-0.12632280588150024},{-0.4106139838695526,0.3032037615776062,-0.06134023517370224,-0.09095518290996552},{-0.22152642905712128,0.01665276661515236,-0.29910042881965637,0.14902256429195404},{0.21539053320884705,-0.07999742776155472,0.2695603668689728,0.1863972246646881},{-0.15896792709827423,-0.30774572491645813,-0.14027369022369385,-0.107262521982193},{-0.4266640245914459,0.07365881651639938,-0.08069698512554169,0.3994656205177307},{-0.3861158788204193,-0.16408969461917877,-0.2650945484638214,0.2857065796852112},{-0.08880030363798141,-0.2175370454788208,0.5120497345924377,0.061819978058338165},{-0.1902581751346588,-0.1909206062555313,-0.03167009353637695,-0.2017539143562317},{0.19686469435691833,0.17495295405387878,0.18732206523418427,-0.23912011086940765},{-0.01441104430705309,-0.3568963408470154,-0.24068820476531982,0.40952906012535095},{0.3284020721912384,-0.23794642090797424,0.25835829973220825,0.07869484275579453},{-0.3515561521053314,-0.056026358157396317,-0.2619877755641937,-0.41808098554611206},{-0.3245161473751068,-0.22701990604400635,0.06464987993240356,-0.13699093461036682},{0.31339168548583984,0.2900204658508301,-0.13794617354869843,0.13113081455230713},{0.15964455902576447,-0.22461454570293427,0.3071471154689789,0.10059422999620438},{-0.04328778386116028,-0.19522465765476227,0.022879764437675476,0.42427974939346313},{0.19783270359039307,0.07492037862539291,0.05183752253651619,0.026238592341542244},{-0.19969017803668976,0.09748106449842453,0.37180230021476746,0.016886819154024124},{-0.21472936868667603,-0.14938271045684814,0.05427316576242447,0.30987823009490967},{0.2503601014614105,0.2566433250904083,0.36896196007728577,-0.06299588084220886}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.012117571197450161,-0.010040445253252983,0.0012914802646264434,0.05759488046169281,0.035662177950143814,-0.06347101926803589,-0.02597196400165558,0.0694127231836319,-0.09403568506240845,-0.035937774926424026,0.003367261029779911,-0.01574132964015007,-0.037935324013233185,0.067781962454319,-0.012793319299817085,-0.04085564240813255};
static const float actor_encoder_self_encoder_2_bias[16] = {0.010926999151706696,-0.005131484940648079,-0.01419588178396225,0.008105282671749592,-0.05177127197384834,0.03252577781677246,-0.025303510949015617,-0.013881208375096321,0.034702759236097336,-0.05000884085893631,0.011391338892281055,-0.016546975821256638,-0.010411813855171204,-0.03794225677847862,0.013632691465318203,-0.03370904549956322};
static const float actor_encoder_feed_forward_0_bias[32] = {0.015004404820501804,0.04401295632123947,-0.00928113516420126,-0.0028322995640337467,-0.014436018653213978,0.02394159510731697,-0.028502430766820908,-0.001180955208837986,-0.0033486478496342897,-0.028218138962984085,-0.002075284020975232,0.032521266490221024,0.02164403162896633,0.009175737388432026,0.03722621500492096,-0.04237348958849907,0.007907353341579437,-0.005211591254919767,0.024839509278535843,-0.025502121075987816,-0.015694960951805115,0.018910937011241913,-0.006504765246063471,-0.03488049656152725,-0.03680652752518654,-0.00170273263938725,0.02056519128382206,0.028871728107333183,-0.026303572580218315,0.0330205038189888,0.03715183213353157,-0.011891151778399944};
static const float action_parameterization_distribution_linear_bias[4] = {-0.005803064908832312,0.007150458637624979,0.010514471679925919,0.025042198598384857};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.36669817566871643,-0.3321825861930847,-0.18105360865592957,0.18046896159648895,-0.2751639485359192,0.08069197088479996,-0.3367019295692444,0.023393480107188225},{0.20337744057178497,0.16287516057491302,0.38548365235328674,0.37345725297927856,-0.16308893263339996,-0.3837777078151703,0.3117459714412689,0.4216623604297638},{0.0784546509385109,0.22284182906150818,0.11343146115541458,-0.03801633045077324,0.3207460641860962,0.18686896562576294,-0.010090276598930359,0.2868516147136688},{0.10655959695577621,-0.3160988986492157,0.3374115824699402,-0.16573390364646912,-0.234508216381073,0.08624199032783508,0.310130774974823,0.28708338737487793},{-0.2793668210506439,-0.05639941990375519,-0.05023154616355896,-0.29466545581817627,0.14652840793132782,0.12601250410079956,0.33656495809555054,0.3011767268180847},{-0.08880312740802765,0.22789941728115082,-0.011080469936132431,-0.2331112176179886,0.35092252492904663,0.1276155412197113,0.11135820299386978,-0.1482653170824051},{-0.013123390264809132,0.21035894751548767,0.13333775103092194,-0.18154527246952057,0.44291529059410095,-0.11358331888914108,0.162205770611763,0.12410657852888107},{0.07088875025510788,-0.356998085975647,-0.0699969008564949,-0.26637813448905945,0.2689031660556793,-0.003953853156417608,-0.16088971495628357,-0.30140626430511475},{-0.2649236023426056,0.21939454972743988,-0.06061669439077377,-0.1350848376750946,-0.06684071570634842,0.4177573621273041,0.36744070053100586,0.2718501687049866},{-0.009193921461701393,-0.10652731359004974,-0.3053065538406372,0.24170543253421783,0.24633312225341797,0.31022995710372925,0.3439120650291443,-0.3280695676803589},{-0.1696331650018692,-0.35664430260658264,0.34533557295799255,0.1580362617969513,-0.011031382717192173,-0.2630388140678406,0.05858345702290535,-0.3331463932991028},{0.2267417162656784,0.06160955876111984,0.38424551486968994,0.3872806131839752,-0.14118485152721405,0.3235224783420563,0.24729599058628082,-0.33499348163604736},{-0.3972037136554718,0.1633632928133011,-0.3638799488544464,0.4231431484222412,-0.04326503723859787,0.41723760962486267,0.07293956726789474,0.2736210227012634},{-0.0566435270011425,0.21286119520664215,-0.13850174844264984,-0.11472906172275543,0.0014561176067218184,0.1118125468492508,0.3588401675224304,0.0345325693488121},{0.13200899958610535,-0.2967201769351959,-0.3411363959312439,-0.15676333010196686,0.13654933869838715,-0.2099171280860901,0.1755332052707672,-0.04696160927414894},{-0.44375020265579224,-0.2990427017211914,-0.23379793763160706,0.028223790228366852,-0.0041826567612588406,0.1728714555501938,0.2689341604709625,-0.013491254299879074},{-0.15346185863018036,-0.27342021465301514,0.25886067748069763,-0.3306832015514374,0.028750933706760406,-0.004408651031553745,-0.38293683528900146,-0.21000410616397858},{0.06214486062526703,0.22654284536838531,0.17151792347431183,0.20253197848796844,-0.08653465658426285,0.3278202414512634,0.3224586546421051,-0.15565767884254456},{0.0589476153254509,-0.33465576171875,-0.057699497789144516,-0.06963363289833069,-0.13969790935516357,-0.34443408250808716,0.08264945447444916,-0.2732418477535248},{-0.04043048992753029,0.004161650314927101,0.13460031151771545,-0.31943103671073914,0.04982105270028114,0.11558856815099716,0.11763273179531097,-0.0995577871799469},{0.08218825608491898,-0.1059485450387001,0.0908772200345993,-0.2764241099357605,-0.0033480303827673197,0.0008017527870833874,0.025552110746502876,-0.2266818881034851},{-0.33267471194267273,0.1915019303560257,0.17351457476615906,-0.2515575587749481,-0.46915683150291443,0.021479804068803787,0.2002134919166565,0.02433905005455017},{0.26860249042510986,0.11069507151842117,-0.36459267139434814,0.12338811159133911,-0.04259297251701355,0.24611707031726837,0.30738890171051025,0.32125768065452576},{-0.02292426861822605,-0.13694575428962708,0.048841409385204315,0.3155568838119507,-0.2836807072162628,-0.03493610769510269,-0.08626686036586761,-0.2942535877227783},{0.20817099511623383,0.09744572639465332,-0.40996038913726807,0.34561073780059814,-0.28095367550849915,-0.3358500301837921,-0.30509722232818604,0.2106761783361435},{0.04462132602930069,0.38186711072921753,-0.28056034445762634,-0.05320466682314873,0.08627210557460785,-0.2484465390443802,0.36479759216308594,-0.25725314021110535},{-0.07584632188081741,0.09103768318891525,-0.1593789905309677,-0.1601225733757019,0.019419867545366287,-0.18463854491710663,-0.06487002223730087,-0.12022844702005386},{0.14096681773662567,-0.1683693826198578,-0.04897233843803406,-0.10308900475502014,0.003854909911751747,0.010548585094511509,-0.1678585261106491,0.11326318234205246},{0.3579869866371155,0.054151806980371475,-0.3864615559577942,-0.18904995918273926,-0.24570076167583466,0.10718026012182236,0.2659025192260742,0.10901708900928497},{0.4014369249343872,-0.3075333833694458,-0.013733617030084133,-0.03300473839044571,0.1278810352087021,-0.12473829090595245,0.2419055551290512,0.3766616880893707},{-0.2745446562767029,-0.18402636051177979,0.04620255529880524,-0.2694222629070282,0.32986244559288025,-0.23386584222316742,0.09225129336118698,0.08602267503738403},{0.12000169605016708,-0.011191354133188725,-0.1545116901397705,0.28977170586586,0.057184163480997086,0.05438994616270065,-0.003172441152855754,-0.018747951835393906}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2324356883764267,0.4315524995326996,-0.6193918585777283,-0.5277584791183472,-0.3210630714893341,0.05273806303739548,-0.46279531717300415,0.5438165664672852},{-0.0252242349088192,0.5375112295150757,-0.21004654467105865,0.5647004842758179,-0.004250037483870983,0.07312455773353577,-0.2327033281326294,0.05401081219315529},{-0.45701488852500916,-0.2116563767194748,-0.15672816336154938,-0.193485289812088,0.5472499132156372,0.21213790774345398,0.030919073149561882,0.46982213854789734},{-0.47739651799201965,-0.48075616359710693,0.36699649691581726,0.34411537647247314,-0.5263300538063049,-0.18867290019989014,0.5277506709098816,0.2553901672363281},{-0.3471667170524597,-0.3195672631263733,-0.33197441697120667,-0.2781216502189636,0.36244651675224304,-0.30809658765792847,0.5500307083129883,-0.48872849345207214},{-0.05600586533546448,0.19656188786029816,0.33478760719299316,-0.5948962569236755,0.5287134647369385,-0.3244573175907135,-0.45442676544189453,-0.340171754360199},{-0.42398878931999207,0.18775025010108948,0.08011914789676666,-0.4044744074344635,-0.04098482057452202,-0.5597245693206787,0.492046058177948,0.02409972995519638},{-0.4282354712486267,-0.2786317765712738,-0.24590827524662018,-0.38493433594703674,-0.3520439863204956,0.15856850147247314,0.5867251753807068,-0.3279445171356201}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03815174102783203,-0.01822894811630249,-0.007360278163105249,0.012409236282110214,-0.03583415970206261,-0.00935877300798893,-0.03223658725619316,0.04263611510396004};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0001208452376886271,-0.017596835270524025,-0.005463758949190378,0.018463267013430595,-0.04268047958612442,0.017472820356488228,-0.0485442616045475,-0.0011827627895399928};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

