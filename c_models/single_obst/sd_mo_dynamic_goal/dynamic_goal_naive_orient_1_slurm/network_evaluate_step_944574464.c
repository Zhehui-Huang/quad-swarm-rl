#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.387591689825058,-0.20567263662815094,0.367639422416687,0.14510244131088257,-0.4399086833000183,0.11917133629322052,0.0040984489023685455,-0.20600180327892303,0.10857828706502914,0.4549471437931061,0.08995185047388077,-0.00609066616743803,0.16057124733924866,-0.11173370480537415,0.4206235706806183,-0.13143858313560486},{-0.3653395175933838,-0.18125571310520172,0.2795056998729706,0.14599087834358215,-0.26903682947158813,-0.00808484386652708,-0.3847298324108124,0.05354571342468262,-0.17394348978996277,-0.11387652158737183,0.1146756038069725,-0.1421816200017929,0.17153942584991455,-0.3256661891937256,-0.2457459270954132,0.09267829358577728},{0.15940135717391968,-0.2270006537437439,-0.23447678983211517,0.013733221217989922,0.10705084353685379,0.15670304000377655,-0.0657060369849205,0.0011852419702336192,-0.06814250349998474,-0.20722785592079163,-0.20545311272144318,0.40381309390068054,0.02826988324522972,-0.1449825018644333,-0.32297125458717346,0.21350298821926117},{0.18866901099681854,0.19775833189487457,0.28941860795021057,-0.08547129482030869,-0.35433483123779297,0.006397049408406019,0.13252688944339752,0.0943475291132927,0.5214380025863647,-0.38610273599624634,0.008407034911215305,0.114983469247818,-0.2594987452030182,-0.07758517563343048,0.3001028597354889,-0.3708849549293518},{-0.06539151817560196,0.15241675078868866,0.23286128044128418,-0.09065790474414825,0.2215099036693573,0.257994681596756,0.2388131320476532,-0.05134039744734764,-0.0853356197476387,0.23991058766841888,0.30273523926734924,-0.10273682326078415,-0.08873231709003448,-0.36347445845603943,0.3298615515232086,0.1261332482099533},{-0.0696054995059967,-0.20226342976093292,-0.17373335361480713,-0.29420673847198486,0.10774692893028259,0.039082713425159454,-0.04780902713537216,-0.1542753130197525,0.23436769843101501,-0.24360790848731995,-0.3288232386112213,0.20210500061511993,0.3653050661087036,-0.04740862920880318,-0.10592255741357803,0.20421020686626434},{-0.1145184189081192,0.10236075520515442,0.045776233077049255,-0.22203196585178375,0.26048627495765686,0.01834961399435997,0.07256235182285309,0.3819384276866913,0.2516126036643982,-0.020559677854180336,-0.3811815083026886,0.27339237928390503,-0.047858916223049164,0.1765321046113968,-0.18740619719028473,-0.14240188896656036},{0.044203441590070724,-0.11196400970220566,0.22213198244571686,0.22438256442546844,-0.3378466069698334,-0.004234591964632273,0.28443270921707153,0.33287715911865234,-0.00036496983375400305,0.17384803295135498,-0.42858651280403137,-0.2784922420978546,0.23715493083000183,0.22915740311145782,0.22115610539913177,0.14846524596214294},{0.3453306257724762,-0.16830435395240784,0.3715134859085083,-0.03212614357471466,0.11019133031368256,0.11892489343881607,-0.23834581673145294,-0.2473219484090805,0.21593813598155975,-0.28465893864631653,0.00939017441123724,-0.2688658833503723,-0.19071142375469208,0.3065926730632782,0.1577349156141281,-0.09072630107402802},{0.05806554853916168,-0.14112073183059692,-0.44211065769195557,-0.0590287484228611,-0.3227913975715637,0.21672323346138,0.38397905230522156,0.1822405904531479,0.41731858253479004,0.4055172801017761,-0.005723423790186644,-0.3161354660987854,0.062190357595682144,0.30371007323265076,-0.12455739080905914,-0.39248403906822205},{0.009868116118013859,0.28723034262657166,0.3544614613056183,-0.2583500146865845,-0.2930900752544403,0.19080033898353577,0.21423257887363434,0.3376447260379791,-0.29293105006217957,-0.030732261016964912,-0.017678454518318176,0.17859788239002228,-0.27714288234710693,-0.2032131850719452,0.3348492681980133,-0.38689103722572327},{-0.008793962188065052,-0.1693531721830368,0.004058592487126589,0.18587927520275116,0.3491906225681305,0.32648807764053345,0.40011927485466003,-0.035095471888780594,0.019505281001329422,-0.06070926412940025,0.3016051650047302,-0.17368324100971222,0.026589855551719666,-0.2234792560338974,0.3277375102043152,0.28740328550338745},{-0.07957223057746887,0.24345797300338745,0.10232266038656235,-0.3333241045475006,0.10352406650781631,0.10893090069293976,0.3533174395561218,-0.03293788805603981,0.07958984375,0.020963093265891075,-0.09934703260660172,0.17202158272266388,0.12288148701190948,0.26049092411994934,0.13943128287792206,-0.3114442527294159},{-0.2456587255001068,-0.2532675862312317,-0.23948882520198822,0.018752899020910263,-0.17610077559947968,0.07933447510004044,-0.281410276889801,0.048957306891679764,0.005268633831292391,-0.0437198169529438,-0.2542214095592499,-0.024320542812347412,-0.3638880252838135,0.0698717013001442,0.19370096921920776,0.08162738382816315},{-0.2594442367553711,-0.3108562231063843,-0.27357324957847595,0.32751181721687317,0.1329018771648407,-0.37351253628730774,0.27672719955444336,-0.13116787374019623,0.10195507109165192,0.29505667090415955,0.10669708997011185,0.1887407898902893,0.18458928167819977,-0.016878971830010414,-0.21979746222496033,0.27105948328971863},{0.4118763208389282,-0.06854095309972763,-0.24715463817119598,-0.37129947543144226,-0.6001864075660706,0.28967711329460144,0.46901386976242065,-0.2838999927043915,0.12855085730552673,0.08329950273036957,-0.300201952457428,0.11417256295681,-0.4971098005771637,0.5787746906280518,-0.28248876333236694,0.012582235038280487},{-0.3588847815990448,-0.3722052276134491,0.401836097240448,0.31973567605018616,-0.26291927695274353,0.25567543506622314,-0.08131153881549835,-0.23647521436214447,0.2852500081062317,-0.41385334730148315,-0.3116878569126129,-0.6639293432235718,-0.320868581533432,-0.45002949237823486,0.07701117545366287,-0.20985348522663116},{-0.3401899039745331,0.2634055018424988,-0.5362021923065186,-0.03792528063058853,-0.004710732027888298,0.34664300084114075,-0.3751124143600464,-0.41106072068214417,0.2262708991765976,0.14439895749092102,0.3953884243965149,-0.03402131050825119,-0.21916386485099792,0.23794853687286377,0.14383673667907715,-0.4676838517189026}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.03576863557100296,-0.10611013323068619,-0.2006751298904419,-0.4205964505672455,0.3525477349758148,0.28148651123046875,0.04681042209267616,0.06592501699924469,-0.19158963859081268,-0.11231384426355362,-0.07335957139730453,0.06427770107984543,0.19385387003421783,0.42846816778182983,0.0685991570353508,0.09537885338068008},{-0.15452398359775543,-0.2340490221977234,-0.043222684413194656,0.14771781861782074,0.3080689311027527,-0.22641968727111816,0.1258455067873001,0.045442186295986176,-0.045856114476919174,0.2547970712184906,-0.1511876881122589,0.33159759640693665,-0.3488369584083557,0.18690669536590576,-0.3216198980808258,-0.2549115717411041},{0.11939501017332077,0.1784822940826416,-0.3118059039115906,-0.6103342175483704,0.1643935889005661,0.42476189136505127,-0.08148659020662308,0.10958987474441528,-0.24595902860164642,-0.22179071605205536,-0.007761264685541391,0.27609577775001526,-0.24494130909442902,-0.22239777445793152,0.10229727625846863,-0.019243594259023666},{0.16512274742126465,-0.033415473997592926,0.05183431878685951,0.1444331258535385,-0.48255956172943115,0.005285419058054686,0.05701538547873497,-0.27375319600105286,0.3131042718887329,0.33139467239379883,-0.1076168641448021,-0.19607460498809814,-0.4242646396160126,-0.33208027482032776,0.18145212531089783,0.24154184758663177},{-0.06736398488283157,0.08220534026622772,0.026467645540833473,0.34029847383499146,-0.24096469581127167,0.011406727135181427,-0.031047778204083443,0.2206522524356842,0.22058340907096863,-0.2970518469810486,0.01540898997336626,0.3610314428806305,0.1104307770729065,-0.42962726950645447,-0.05378597229719162,-0.14461302757263184},{0.14721575379371643,0.12709172070026398,-0.008844226598739624,0.16102126240730286,-0.34582874178886414,-0.4065043032169342,0.17413297295570374,0.2723817825317383,0.13223692774772644,0.40904000401496887,0.21104519069194794,-0.2508891522884369,0.02651919610798359,-0.1634320169687271,-0.08874296396970749,0.2936501204967499},{-0.048243507742881775,0.14094029366970062,0.3393755555152893,-0.3431906998157501,-0.1553659290075302,0.0773010328412056,-0.28227511048316956,-0.05836419761180878,0.143703430891037,0.07141044735908508,-0.10986374318599701,-0.28767824172973633,-0.21219752728939056,-0.007932362146675587,0.1402791291475296,0.07450105249881744},{-0.1428166627883911,-0.1659458428621292,-0.3606974184513092,0.29771584272384644,-0.23380273580551147,-0.30644696950912476,-0.15880510210990906,-0.3287893533706665,0.037460505962371826,-0.13263222575187683,-0.11897300183773041,0.1287946105003357,-0.17497918009757996,0.40863940119743347,-0.08580133318901062,-0.3743565082550049},{-0.1665063053369522,0.2784772515296936,-0.013701461255550385,-0.025573307648301125,0.3045789301395416,-0.20151963829994202,0.38987764716148376,0.10893566161394119,0.22871017456054688,0.3804060220718384,0.1911572962999344,0.31466639041900635,0.2357698529958725,-0.038149721920490265,0.23402057588100433,0.11873744428157806},{0.08539310097694397,-0.2800615727901459,-0.01646377146244049,-0.13407002389431,0.31649306416511536,-0.04919532686471939,-0.3044635057449341,-0.2291475236415863,0.055046431720256805,-0.44345012307167053,-0.13408496975898743,0.20352783799171448,0.1252060979604721,0.16264456510543823,-0.2961938679218292,0.30341917276382446},{-0.09289880096912384,-0.31804072856903076,0.4450414180755615,0.2366994172334671,0.22628408670425415,0.13929927349090576,0.06991161406040192,-0.1428983509540558,0.11062988638877869,-0.18555784225463867,0.0014200048753991723,0.40376922488212585,0.23158253729343414,0.1432882696390152,-0.1873498409986496,-0.021446865051984787},{-0.0010982335079461336,-0.10960014909505844,0.27129828929901123,-0.0036498289555311203,-0.15352903306484222,-0.22612296044826508,0.4631960391998291,0.31306323409080505,-0.2643589973449707,-0.349463552236557,-0.09410799294710159,-0.340067982673645,0.05358942225575447,-0.3627365827560425,-0.3594615161418915,-0.008155282586812973},{-0.04230393096804619,-0.28895771503448486,0.2950119078159332,-0.21126239001750946,0.3032824993133545,-0.3062320649623871,-0.32037246227264404,0.17009176313877106,0.06632062792778015,-0.05563683807849884,-0.2542581558227539,0.06689698249101639,0.07716791331768036,-0.23336446285247803,-0.3280874490737915,0.014781944453716278},{0.2906985282897949,-0.2661483883857727,0.4147946238517761,0.16376642882823944,0.03467784449458122,0.30477404594421387,-0.07334628701210022,-0.21291294693946838,-0.49863794445991516,0.12407853454351425,0.04719814285635948,-0.36926624178886414,-0.00931535940617323,0.19379186630249023,0.3537331521511078,0.040531281381845474},{-0.24345116317272186,0.1382725089788437,0.12116692215204239,-0.3000265657901764,-0.186110258102417,0.01942864991724491,0.2187516987323761,-0.10647819191217422,0.1666385680437088,-0.33528491854667664,-0.01375910546630621,0.04167575389146805,-0.005570098292082548,0.04555670544505119,-0.11250024288892746,0.023568278178572655},{-0.22679363191127777,0.29473039507865906,-0.29414913058280945,0.35895687341690063,0.13334152102470398,-0.36894187331199646,-0.07380008697509766,-0.0882917121052742,-0.36257365345954895,0.2655142545700073,-0.2979513108730316,0.3123975992202759,-0.05610125511884689,-0.19066974520683289,-0.2654392719268799,-0.521751880645752}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12320663034915924,0.008075603283941746,-0.044105127453804016,-0.04764345660805702,-0.12197966873645782,0.030563365668058395,0.27396878600120544,0.0719103068113327,-0.13643868267536163,-0.21938277781009674,0.13705842196941376,-0.2702596187591553,-0.16872665286064148,0.21788227558135986,0.22811894118785858,0.29349857568740845,-0.22614438831806183,-0.32367685437202454,-0.1710522174835205,0.06303806602954865,-0.043433696031570435,-0.3450196087360382,-0.24373756349086761,-0.2686075270175934,-0.29716625809669495,0.18733257055282593,-0.2127586007118225,-0.01866878755390644,-0.018219301477074623,0.028546420857310295,0.24920547008514404,-0.17351315915584564},{0.28871747851371765,0.2156856656074524,0.16007068753242493,-0.06189275160431862,0.09924725443124771,-0.10252784192562103,0.27046915888786316,0.1445700228214264,-0.1821332424879074,-0.17228245735168457,-0.04883469641208649,-0.22936321794986725,-0.1661091297864914,0.16650812327861786,-0.19704753160476685,-0.32114359736442566,-0.06152844429016113,0.12721775472164154,-0.27524930238723755,-0.2734852433204651,0.0257088765501976,0.22119112312793732,0.09726081043481827,-0.11381877213716507,0.15232384204864502,-0.28171247243881226,0.0413571260869503,0.060388825833797455,0.23039142787456512,-0.10239546000957489,-0.03748062252998352,0.2802305519580841},{0.22632350027561188,0.08703311532735825,-0.044612761586904526,0.09871412068605423,-0.14906173944473267,-0.14035792648792267,-0.20908723771572113,0.12507885694503784,-0.1239657923579216,0.3530784845352173,-0.2996693253517151,-0.22601284086704254,0.16306370496749878,-0.3254948854446411,-0.18133902549743652,0.13241007924079895,-0.08193614333868027,-0.08596596121788025,0.21848653256893158,-0.02427561767399311,0.18040533363819122,0.2924300730228424,-0.26280179619789124,0.06476140022277832,-0.16645169258117676,-0.10371389240026474,0.11551296710968018,-0.03780670091509819,-0.08580201119184494,-0.16897590458393097,-0.03858666121959686,-0.1575528234243393},{0.31845054030418396,0.04371875524520874,0.09529788047075272,-0.13794554769992828,-0.2481861263513565,-0.08756672590970993,-0.11880436539649963,0.20793543756008148,0.23990954458713531,-0.19695895910263062,-0.12880484759807587,0.24698950350284576,0.13273046910762787,-0.08686697483062744,-0.24209879338741302,0.3262270987033844,-0.31024640798568726,0.27731186151504517,-0.05394969880580902,0.04743999242782593,-0.0700443908572197,-0.1007143035531044,0.2665955722332001,0.17291632294654846,0.16093629598617554,-0.31613805890083313,0.28308162093162537,-0.19388334453105927,-0.045841339975595474,0.001132873585447669,-0.31637701392173767,0.14212729036808014},{-0.027081437408924103,-0.02369203232228756,-0.08512093126773834,0.045349668711423874,0.20137664675712585,-0.1371058076620102,-0.37631285190582275,0.017375951632857323,-0.1483413130044937,-0.2107103168964386,0.16460363566875458,0.22458739578723907,-0.10129836201667786,-0.0894819051027298,-0.07507737725973129,0.21994780004024506,-0.03151208907365799,0.009454086422920227,-0.32939139008522034,-0.03933478891849518,-0.1946311593055725,-0.3205204904079437,0.17407803237438202,0.22566728293895721,-0.058955173939466476,0.2701369822025299,-0.15659604966640472,0.2577802836894989,0.276996374130249,0.3540414869785309,0.022949064150452614,0.28183892369270325},{-0.1918245553970337,-0.11756755411624908,-0.1130753830075264,-0.09183288365602493,-0.11085482686758041,0.22289171814918518,0.22046490013599396,0.05812158063054085,0.33201053738594055,0.11794682592153549,0.2708711326122284,-0.21869218349456787,-0.13256345689296722,0.2508476972579956,0.2370668649673462,-0.3318263590335846,-0.0671466812491417,-0.22792622447013855,0.23504535853862762,0.18205662071704865,0.05814581364393234,0.13401000201702118,-0.02076849900186062,2.9425138563965447e-05,-0.3274542987346649,0.29074668884277344,-0.20698121190071106,0.15795119106769562,0.299062043428421,0.2311028242111206,0.1131003275513649,0.0356953889131546},{0.15716664493083954,-0.12943656742572784,-0.13747890293598175,-0.325353741645813,0.013271390460431576,0.23272423446178436,0.2762719690799713,0.11656211316585541,0.1056891530752182,0.2945594787597656,-0.003984978422522545,0.010902426205575466,-0.4456081688404083,-0.12512174248695374,-0.1354072093963623,0.01864607073366642,-0.2729901671409607,-0.22308209538459778,0.1771751493215561,-0.09036888927221298,-0.117258220911026,-0.14702068269252777,-0.22165167331695557,-0.26009315252304077,0.17716027796268463,-0.25266796350479126,-0.12251193821430206,-0.21418488025665283,0.3313741981983185,0.12037951499223709,-0.18195419013500214,-0.26856809854507446},{0.0682152584195137,0.19517956674098969,0.05745239555835724,-0.1098598763346672,0.14446493983268738,-0.2790788412094116,-0.05661098286509514,-0.14549700915813446,0.00934072770178318,-0.30695801973342896,-0.2897253930568695,-0.07571475952863693,-0.13512125611305237,0.04660193249583244,-0.10861829668283463,0.38194870948791504,0.008379782550036907,-0.15537585318088531,0.14147859811782837,0.3196505308151245,-0.16992051899433136,-0.2024971842765808,0.27630186080932617,0.07451733201742172,-0.007218354847282171,-0.33504995703697205,-0.3144965171813965,-0.22419218719005585,-0.3514878451824188,-0.24912762641906738,0.10595956444740295,-0.3612217307090759},{0.04628417640924454,0.36648932099342346,-0.33912020921707153,-0.35617706179618835,-0.2487023025751114,0.0496089830994606,0.09029927104711533,0.09197225421667099,0.1467028111219406,-0.22040995955467224,-0.2382272332906723,0.2723482847213745,-0.30519840121269226,-0.15248726308345795,0.16732856631278992,-0.23012615740299225,0.21721996366977692,0.11647504568099976,0.2758543789386749,0.06771348416805267,0.2162545621395111,0.08841639757156372,0.291807621717453,-0.11449798196554184,0.4639640748500824,-0.17761535942554474,0.16421347856521606,0.2958296835422516,-0.1991366147994995,0.12126695364713669,0.0025339743588119745,0.09109971672296524},{-0.18022528290748596,0.09599263966083527,-0.30429452657699585,-0.16650573909282684,0.112721748650074,-0.18120023608207703,0.08091365545988083,0.020349185913801193,0.1523396372795105,0.003709938609972596,-0.234561488032341,-0.2994707226753235,-0.38852548599243164,-0.12628325819969177,-0.2171616405248642,0.07558692991733551,-0.004528634250164032,-0.25328290462493896,0.24955172836780548,0.08382215350866318,0.08101561665534973,-0.018679644912481308,0.3494175672531128,-0.23786009848117828,0.31834307312965393,0.1307893544435501,-0.20556634664535522,0.07270723581314087,0.026211654767394066,0.08509327471256256,-0.15752597153186798,0.14893099665641785},{0.06413045525550842,-0.05573520064353943,0.1965741664171219,-0.25322437286376953,-0.22510264813899994,-0.2277170717716217,-0.2542306184768677,-0.10727079212665558,-0.1482660323381424,0.30915355682373047,0.10446463525295258,-0.2741457521915436,-0.33392825722694397,0.0029058055952191353,-0.21036933362483978,-0.22231878340244293,0.26384299993515015,-0.1576356142759323,0.2652648687362671,-0.214888334274292,-0.1851634830236435,-0.011531566269695759,0.1475619077682495,0.16806210577487946,0.1553748995065689,-0.13108642399311066,-0.07755137234926224,-0.0844484269618988,-0.06731434166431427,0.02685009501874447,-0.07920857518911362,0.1740770787000656},{-0.2176671028137207,-0.04700551927089691,0.24782654643058777,0.34716179966926575,0.2670081555843353,-0.012377891689538956,0.04780883342027664,-0.21782520413398743,-0.08447936177253723,-0.18750235438346863,0.27428755164146423,-0.24382716417312622,-0.2126646786928177,-0.20418715476989746,0.2830648720264435,0.0013737763511016965,-0.022913750261068344,0.020495103672146797,0.3249437212944031,0.07547250390052795,-0.16584348678588867,0.20617201924324036,0.10721983015537262,-0.11446205526590347,0.1892816722393036,-0.0946304053068161,-0.1440577656030655,0.20586436986923218,0.20627035200595856,-0.01978977769613266,-0.2732449471950531,-0.24220319092273712},{0.2200307548046112,-0.22556453943252563,0.0018564647762104869,-0.3370521366596222,0.13999181985855103,-0.03547754883766174,0.17708322405815125,0.07603959739208221,0.2431143820285797,0.04048667848110199,0.1526605784893036,0.18446770310401917,-0.37462136149406433,-0.2153692990541458,-0.05474993959069252,-0.2285454273223877,-0.1081225648522377,-0.2029993087053299,0.24986304342746735,-0.2285645306110382,0.24576444923877716,0.018041638657450676,-0.017575273290276527,0.18302088975906372,0.11465160548686981,-0.06567130237817764,0.12560074031352997,0.16310885548591614,0.12638866901397705,-0.07209119945764542,-0.1852259784936905,-0.10037685930728912},{0.22384540736675262,-0.04188615083694458,-0.05225908383727074,0.41250717639923096,-0.10245203971862793,-0.18032009899616241,-0.07650493830442429,0.10847894847393036,0.16068734228610992,0.2859049439430237,0.12486620247364044,-0.15095050632953644,0.02135590650141239,0.20092251896858215,-0.09721468389034271,0.05855554714798927,0.21242034435272217,-0.22616057097911835,0.058251604437828064,-0.3150615692138672,0.30599266290664673,0.16260971128940582,-0.05600712448358536,0.185668483376503,0.19241921603679657,0.06992661207914352,0.09789100289344788,0.0735001191496849,0.04893350601196289,-0.1534987837076187,-0.026898177340626717,0.3899379074573517},{0.03727421164512634,-0.27581122517585754,-0.07999507337808609,0.11303958296775818,-0.25073182582855225,-0.004716511350125074,0.05490848794579506,-0.26226648688316345,-0.1682559996843338,-0.07019514590501785,0.1884991079568863,0.1556299775838852,0.08780208230018616,0.2610534727573395,-0.05470118671655655,-0.10704270005226135,-0.22210238873958588,0.25850245356559753,-0.08599462360143661,-0.25917479395866394,-0.18933749198913574,-0.07424626499414444,0.1713229864835739,-0.011839039623737335,-0.045421820133924484,-0.08622081577777863,-0.19517196714878082,0.22624386847019196,0.05982901528477669,-0.16699467599391937,0.22443872690200806,0.19680975377559662},{0.13940490782260895,-0.22407762706279755,-0.0697554424405098,-0.18029168248176575,-0.08521712571382523,0.17298631370067596,0.032198481261730194,0.23787394165992737,-0.08235388249158859,-0.015371843241155148,0.2674097716808319,0.12373441457748413,-0.03497718274593353,-0.11008167266845703,0.05483205243945122,0.1343495100736618,-0.3843555450439453,-0.29391583800315857,-0.04764138162136078,0.047122761607170105,0.1086224839091301,0.23163241147994995,0.26322364807128906,0.1467939019203186,0.04758294299244881,0.23010371625423431,0.02089271880686283,-0.06535585224628448,0.19504152238368988,-0.09866078943014145,-0.22560586035251617,0.36565276980400085},{0.21843628585338593,-0.04002257063984871,-0.23328237235546112,0.14935354888439178,0.08433659374713898,-0.07719159126281738,0.2762056887149811,0.12268152087926865,0.12447753548622131,-0.2036607265472412,0.19506336748600006,-0.16968794167041779,-0.3269369900226593,0.24247121810913086,0.05683315917849541,0.06400682032108307,0.05724189803004265,-0.04716227576136589,-0.1438121199607849,0.09891335666179657,-0.07047711312770844,0.16421549022197723,0.04615151882171631,-0.11827386915683746,0.05416598543524742,-0.34401488304138184,0.026162514463067055,0.3834861218929291,0.1846330463886261,-0.13101641833782196,0.20033836364746094,0.16408637166023254},{-0.10515549033880234,-0.03670831024646759,-0.11557213962078094,-0.04123229905962944,-0.24871744215488434,-0.045216578990221024,0.2074134349822998,0.13677875697612762,0.143165722489357,0.03349350392818451,0.24282796680927277,0.0002638474106788635,0.19503647089004517,0.1669221818447113,0.17914164066314697,-0.11781464517116547,0.10489527881145477,0.15234613418579102,0.22224484384059906,0.046816207468509674,0.1907528042793274,0.23183642327785492,0.06818655878305435,0.13103468716144562,-0.04058342054486275,-0.08496345579624176,-0.10159250348806381,-0.2702178359031677,0.16778677701950073,-0.24651187658309937,-0.025865504518151283,-0.019946187734603882},{-0.26141467690467834,0.10631174594163895,-0.25589969754219055,-0.33653929829597473,-0.03315850719809532,0.06856616586446762,0.09446299076080322,-0.07293790578842163,-0.015736272558569908,0.2767168879508972,0.061616215854883194,-0.18596072494983673,0.1265348345041275,-0.20694857835769653,-0.3033584952354431,-0.03311699256300926,-0.17998839914798737,0.15400177240371704,-0.00048491195775568485,-0.029518159106373787,-0.3007616698741913,0.15254390239715576,0.11231115460395813,0.02341386489570141,-0.005538278259336948,0.22936417162418365,0.036435551941394806,-0.13712967932224274,-0.17947621643543243,0.051496703177690506,-0.10307473689317703,-0.22851689159870148},{0.0057135228998959064,-0.2095169574022293,-0.2168816477060318,-0.014228107407689095,-0.3586382269859314,-0.13596723973751068,0.15608707070350647,-0.2956031858921051,-0.19830197095870972,0.1847170740365982,0.15034762024879456,0.1263093650341034,0.14146430790424347,-0.12106836587190628,0.3143253028392792,-0.3190532326698303,0.08763610571622849,0.242435023188591,0.06239243224263191,0.2401595115661621,0.04761013016104698,-0.10313482582569122,-0.2772931158542633,0.18226942420005798,-0.18181684613227844,-0.18300926685333252,0.10469160974025726,0.04616500064730644,-0.11709295958280563,-0.2932744324207306,-0.01567200943827629,-0.14189650118350983},{0.23967985808849335,0.20867034792900085,-0.06500593572854996,0.17673835158348083,-0.28669479489326477,0.1842612475156784,-0.06509646028280258,-0.12641161680221558,-0.18849501013755798,0.1777353137731552,-0.25387370586395264,-0.15883292257785797,-0.03102981485426426,-0.1973075568675995,-0.3614422380924225,-0.11364196985960007,-0.07258253544569016,-0.2641873061656952,-0.23287969827651978,0.2587788701057434,0.08961179107427597,0.1233973279595375,-0.3338989317417145,0.3270284831523895,0.18864017724990845,0.2457796186208725,-0.28327181935310364,-0.013462407514452934,0.0713745728135109,-0.24939589202404022,0.1426314264535904,0.0981234535574913},{-0.016852445900440216,-0.31690216064453125,0.009069803170859814,-0.24554941058158875,-0.0955192968249321,0.2741687595844269,0.14396317303180695,0.0063321879133582115,-0.04874153062701225,0.004777692724019289,-0.1900700330734253,0.19482973217964172,0.14722831547260284,0.08906370401382446,0.18504579365253448,-0.03993145376443863,-0.08272510021924973,0.08808565884828568,-0.07965006679296494,0.15687569975852966,0.24323441088199615,0.21847301721572876,-0.04821779206395149,-0.2776130139827728,0.05591185763478279,0.11029014736413956,0.286379337310791,0.1206299290060997,-0.011887938715517521,0.20859433710575104,0.02532104030251503,-0.09591205418109894},{0.022601064294576645,-0.16949540376663208,0.22178915143013,0.011890350840985775,0.29654252529144287,-0.040378157049417496,-0.11573442071676254,-0.15512369573116302,0.1306116282939911,-0.06858786940574646,0.07737759500741959,-0.0008442919352091849,-0.31570175290107727,0.015186107717454433,-0.09622623026371002,-0.22574499249458313,-0.05736861377954483,-0.057492371648550034,0.21532221138477325,0.2386811226606369,0.03814734145998955,0.04297095164656639,0.18064427375793457,0.3414061665534973,-0.1456979215145111,-0.03249305114150047,0.20754286646842957,-0.11434974521398544,-0.19018013775348663,-0.2488698661327362,0.2917565107345581,-0.0030654098372906446},{0.16847006976604462,-0.08622124791145325,0.014243477024137974,0.1457897573709488,-0.02048659697175026,0.05201943218708038,-0.2647048532962799,0.23899543285369873,-0.0507541224360466,-0.019872162491083145,0.09401696920394897,-0.2848754823207855,-0.025398729369044304,-0.009532026946544647,-0.10747408866882324,0.25760963559150696,-0.08949626237154007,-0.20400655269622803,0.01683056354522705,-0.03697975352406502,-0.1728014349937439,0.2066424936056137,0.22394710779190063,0.20843720436096191,-0.3015051782131195,0.1283796727657318,-0.06890345364809036,0.0815507099032402,-0.2811454236507416,0.25234973430633545,-0.04820144921541214,0.049173593521118164}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.1557481437921524,-0.07968472689390182,0.044601332396268845,-0.10692281275987625},{0.1766672432422638,-0.29121291637420654,0.23017190396785736,0.1961732655763626},{-0.17030024528503418,0.08433083444833755,0.02685059793293476,-0.006137250456959009},{0.27538079023361206,0.4159103035926819,0.3013691008090973,0.03886249288916588},{-0.2302653193473816,0.10223684459924698,-0.2588413953781128,0.06921564787626266},{-0.028270721435546875,-0.02301226183772087,0.04881281405687332,0.2878950834274292},{-0.11408025026321411,-0.07230441272258759,-0.26317068934440613,-0.021687187254428864},{-0.12075337767601013,-0.21071800589561462,0.10069054365158081,-0.06333097815513611},{-0.031054558232426643,0.056821636855602264,-0.05491112172603607,-0.08404822647571564},{0.16655245423316956,0.001699847518466413,-0.07695306092500687,-0.10737296938896179},{0.1223955750465393,-0.1005711704492569,0.26215243339538574,0.2276453673839569},{0.01784125529229641,-0.007501741871237755,0.24202725291252136,-0.060206953436136246},{-0.2925700843334198,0.1875709891319275,-0.022271953523159027,-0.11460705101490021},{-0.14047040045261383,0.07630415260791779,-0.17874696850776672,0.06571729481220245},{0.1590188443660736,0.04797564446926117,0.21448473632335663,0.07916177064180374},{-0.11154568195343018,-0.35151126980781555,-0.11821422725915909,-0.07976967096328735},{-0.19427742063999176,0.049014151096343994,-0.08663667738437653,0.22227777540683746},{-0.2066713273525238,-0.11778053641319275,-0.19771508872509003,0.15501436591148376},{-0.06034311279654503,-0.037305377423763275,0.27659156918525696,0.07147422432899475},{-0.14492499828338623,-0.12097062915563583,0.01226232573390007,-0.15264835953712463},{0.12805044651031494,0.08197176456451416,0.08674593269824982,-0.10552533715963364},{-0.029336711391806602,-0.17924834787845612,-0.07433447241783142,0.20294038951396942},{0.3267131745815277,-0.1562165468931198,0.12510861456394196,0.01589140295982361},{-0.29314225912094116,-0.12265967577695847,-0.30107149481773376,-0.2871568202972412},{-0.1262534111738205,-0.12165168672800064,-0.051663048565387726,-0.09816640615463257},{0.10080625116825104,0.08011632412672043,-0.01809375360608101,0.10468431562185287},{0.14088673889636993,-0.16055536270141602,0.19892682135105133,0.056639425456523895},{-0.08746620267629623,-0.127183735370636,-0.005433176644146442,0.21157725155353546},{0.062126919627189636,0.025787673890590668,0.04130999371409416,0.04390544444322586},{-0.12314543128013611,0.10265426337718964,0.18030071258544922,0.004340760875493288},{-0.17199793457984924,-0.125047966837883,0.06146638095378876,0.1473485678434372},{0.18643993139266968,0.18629954755306244,0.2217659205198288,-0.028140926733613014}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.12108083069324493,-0.10256464779376984,0.02462778612971306,0.09546171128749847,0.11974303424358368,-0.09576613456010818,0.07476506382226944,-0.02078915201127529,-0.06013426557183266,-0.10489237308502197,-0.007743115071207285,0.07116630673408508,-0.012773803435266018,0.04780299961566925,0.09910818934440613,-0.04731718823313713};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.04035568609833717,0.06010366603732109,0.029353344812989235,-0.01155234407633543,-0.026727871969342232,0.0626809373497963,-0.058435726910829544,-0.07842866331338882,0.05808504670858383,0.005687964614480734,-0.019050253555178642,-0.04474423825740814,0.0141728101298213,-0.08504236489534378,0.0030020475387573242,-0.06731897592544556};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0451483279466629,0.007573574315756559,-0.04779350012540817,0.03205699101090431,0.0003037004207726568,0.014596983790397644,-0.05175016447901726,-0.04279594123363495,-0.02441437542438507,-0.013816678896546364,0.018302252516150475,0.03852927312254906,0.04318487271666527,-0.04504142329096794,0.032132215797901154,-0.08913157880306244,-0.006171098444610834,-0.031732331961393356,0.03460202366113663,-0.04891904070973396,0.027119053527712822,-0.0017657253192737699,0.03625855967402458,-0.07182355970144272,-0.05824519321322441,0.0680551677942276,0.045542579144239426,-0.029645774513483047,0.0808035358786583,0.03261760249733925,-0.0035211830399930477,0.06270645558834076};
static const float action_parameterization_distribution_linear_bias[4] = {0.038989029824733734,0.07387632131576538,0.012066996656358242,0.039295122027397156};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.30722513794898987,-0.13849852979183197,-0.016689090058207512,0.1402665674686432,0.016080131754279137,0.015061675570905209,-0.2249259501695633,0.022209443151950836},{0.022945359349250793,0.1127082109451294,0.28801724314689636,0.3023544251918793,-0.11753770709037781,-0.21781031787395477,0.30124205350875854,0.08238294720649719},{0.004906768910586834,0.22820991277694702,0.01601087674498558,-0.03395383432507515,0.28968241810798645,0.2427099198102951,-0.10289128124713898,0.041053034365177155},{0.11207772046327591,-0.2170596867799759,0.29995518922805786,-0.2211935818195343,-0.32110360264778137,0.005640505347400904,0.17412152886390686,0.16785210371017456},{-0.220988929271698,0.02001601830124855,0.01474644523113966,-0.3307078182697296,0.054640624672174454,0.035645741969347,0.21039564907550812,0.2558480501174927},{-0.05600328370928764,0.27430015802383423,-0.062289416790008545,-0.2665807604789734,0.12805551290512085,-0.007397400680929422,0.0023661169689148664,-0.20455335080623627},{-0.02456503175199032,0.30629053711891174,0.19734610617160797,-0.21287302672863007,0.2112358808517456,-0.2911423444747925,0.24085994064807892,0.07470227032899857},{-0.0014956557424739003,-0.20623886585235596,0.11747778207063675,-0.15201234817504883,0.3192722499370575,-0.15102218091487885,0.02645091898739338,-0.29085931181907654},{-0.1599825769662857,0.27583441138267517,0.18129804730415344,-0.006795721594244242,0.02620955929160118,0.20278041064739227,0.3937533497810364,0.35188567638397217},{0.06762039661407471,-0.06771314144134521,-0.22051559388637543,0.3820721209049225,0.2476280778646469,0.1424289494752884,0.19133765995502472,-0.27202585339546204},{-0.11275040358304977,-0.3132666349411011,0.351617693901062,0.2635897397994995,-0.03090931475162506,-0.3592652678489685,-0.11442670971155167,-0.2929080128669739},{0.32505372166633606,0.04243779927492142,0.34506693482398987,0.5057148337364197,-0.14368492364883423,0.18816819787025452,0.11950728297233582,-0.33584094047546387},{-0.2977270483970642,0.15682636201381683,-0.3593598008155823,0.409005343914032,-0.04065875709056854,0.22539456188678741,0.015172070823609829,0.24389466643333435},{-0.02302577719092369,0.17001478374004364,-0.13793741166591644,-0.1765698343515396,0.025117844343185425,0.08372608572244644,0.3118496239185333,-0.052848268300294876},{0.14469707012176514,-0.3040752112865448,-0.270383358001709,-0.18523651361465454,0.2069823294878006,-0.14429515600204468,0.190694198012352,-0.16055893898010254},{-0.3389415144920349,-0.3150084912776947,-0.2508924901485443,-0.04490531608462334,0.029022227972745895,0.1508825570344925,0.1778583526611328,-0.036283571273088455},{-0.2373214066028595,-0.27144762873649597,0.17142729461193085,-0.1839476078748703,0.025913024321198463,0.07669571787118912,-0.4063152074813843,-0.22529837489128113},{0.009902124293148518,0.24517983198165894,0.06743214279413223,0.2453814297914505,-0.14249256253242493,0.328336238861084,0.2830582559108734,-0.1576405167579651},{-0.021657031029462814,-0.2865011394023895,-0.08820019662380219,0.021344134584069252,-0.08438684046268463,-0.35691559314727783,0.10550841689109802,-0.21317149698734283},{-0.12050136923789978,0.017168527469038963,0.09489511698484421,-0.24699464440345764,0.12754085659980774,0.025505604222416878,0.10544153302907944,-0.0016079742927104235},{0.02129265107214451,-0.06774470210075378,0.09207449853420258,-0.1436089426279068,0.059703052043914795,-0.03126785159111023,0.10380636155605316,-0.19786307215690613},{-0.2850809097290039,0.2216971516609192,0.21810033917427063,-0.288448303937912,-0.3454560935497284,-0.038306623697280884,0.20611825585365295,0.0032810878474265337},{0.29189813137054443,0.05528508499264717,-0.393322616815567,-0.03514058142900467,-0.07698263227939606,0.2101011723279953,0.19071051478385925,0.25182056427001953},{0.013854322955012321,-0.21854044497013092,-0.03921780735254288,0.11158602684736252,-0.3440818786621094,-0.09345029294490814,-0.3049558699131012,-0.3360949754714966},{0.13083136081695557,-0.126188725233078,-0.33961763978004456,0.34262368083000183,-0.3198797106742859,-0.09049662202596664,-0.4692498445510864,0.07674817740917206},{0.00605956232175231,0.2955383062362671,-0.13096456229686737,-0.07434308528900146,0.11068879067897797,-0.14976008236408234,0.22587212920188904,-0.3062251806259155},{-0.08873108774423599,0.11645767092704773,-0.04461994394659996,-0.248124897480011,0.046036943793296814,-0.1495916098356247,-0.1827000081539154,-0.10933364182710648},{0.08233579993247986,-0.16562646627426147,0.04284375533461571,-0.11461208015680313,0.07772767543792725,0.06444036215543747,-0.2838593125343323,0.1256476193666458},{0.2025585174560547,0.0323018953204155,-0.2827494442462921,-0.1310601830482483,-0.17823751270771027,0.1508386731147766,0.15912538766860962,0.06470795720815659},{0.27315428853034973,-0.3955719769001007,0.035269733518362045,-0.04935107007622719,0.08646272122859955,-0.11103872209787369,0.12037978321313858,0.2099466174840927},{-0.30645251274108887,-0.25807711482048035,0.039678800851106644,-0.36380094289779663,0.2421826273202896,-0.4004843235015869,-0.07698188722133636,0.05140499025583267},{0.30146324634552,0.20023958384990692,0.005118877161294222,0.16866618394851685,0.09768383949995041,-0.2499450445175171,-0.08001101016998291,0.14427471160888672}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.18512693047523499,0.3736959397792816,-0.428567111492157,-0.49750614166259766,-0.1615268886089325,-0.10268116742372513,-0.3274931013584137,0.46147069334983826},{0.00988954957574606,0.3694901168346405,-0.22913874685764313,0.46453264355659485,-0.02899950183928013,-0.07960259914398193,-0.31522849202156067,-0.059916574507951736},{-0.28413525223731995,-0.19610285758972168,-0.14912213385105133,-0.1590515822172165,0.3969174921512604,0.18235978484153748,-0.10625557601451874,0.3619192838668823},{-0.45351776480674744,-0.4247405529022217,0.286190003156662,0.17752942442893982,-0.49522486329078674,-0.1840081810951233,0.3911852240562439,0.2030906230211258},{-0.2497640997171402,-0.21384596824645996,-0.2908192276954651,-0.1898624747991562,0.3190438151359558,-0.20911915600299835,0.415323942899704,-0.3176082968711853},{-0.05389344319701195,0.2887144982814789,0.09014405310153961,-0.5892403721809387,0.5051237940788269,-0.20954963564872742,-0.5047243237495422,-0.344462126493454},{-0.26509854197502136,0.10172797739505768,0.056351188570261,-0.40146657824516296,0.060891248285770416,-0.4724522531032562,0.38720524311065674,0.08739548176527023},{-0.2791966497898102,-0.13265717029571533,-0.11584904044866562,-0.3372901380062103,-0.35344481468200684,0.07593107223510742,0.5393331050872803,-0.3293876647949219}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.05778180807828903,-0.07125367224216461,-0.0980156809091568,0.03806435316801071,0.13484793901443481,0.02246660366654396,0.07460559159517288,0.021650375798344612};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0154974814504385,0.03286685422062874,-0.023186003789305687,-0.06517422199249268,-0.06423209607601166,-0.026878787204623222,0.010545617900788784,-0.15828219056129456};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

