#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3272956609725952,0.03731155022978783,0.06645891815423965,0.2639913856983185,0.2776838541030884,-0.21236704289913177,-0.31093212962150574,0.11529696732759476,0.39071744680404663,-0.3093837797641754,0.45965006947517395,0.08468663692474365,0.23761582374572754,0.08486149460077286,-0.3057671785354614,0.01698039285838604},{-0.3263758718967438,-0.22169296443462372,-0.26165667176246643,-0.07392239570617676,0.18745362758636475,0.4218967854976654,0.17603421211242676,-0.03236643224954605,0.1958242505788803,0.2430829107761383,-0.07617344707250595,0.008185486309230328,-0.10317963361740112,0.10593245178461075,0.2934678792953491,-0.22241367399692535},{-0.0024021111894398928,0.17333154380321503,0.24639366567134857,0.3650725185871124,0.07844429463148117,-0.30186399817466736,0.8977989554405212,-0.31742724776268005,-0.27031904458999634,0.013596143573522568,-0.03186231106519699,-0.25784191489219666,0.38715285062789917,0.6455159187316895,-0.5683886408805847,0.19174791872501373},{0.17175224423408508,-0.17404906451702118,-0.13791197538375854,0.0020867877174168825,-0.14855067431926727,0.1312362253665924,-0.07039651274681091,-0.2301837056875229,-0.007730841636657715,-0.06431930512189865,0.5920425653457642,-0.20765212178230286,-0.3412315249443054,-0.188718780875206,0.22962617874145508,-0.04569154232740402},{-0.17756249010562897,-0.029015151783823967,0.17461010813713074,-0.4104043245315552,0.47328880429267883,0.24899163842201233,0.2220321148633957,-0.2045890837907791,-0.19851209223270416,0.3004956841468811,-0.10407824069261551,-0.4276061952114105,-0.00846988894045353,-0.2133619636297226,0.4459454119205475,-0.0192536860704422},{-0.01702459156513214,-0.12951627373695374,-0.09426204860210419,-0.05952579155564308,0.04606013372540474,-0.23318098485469818,0.6005385518074036,-0.31949326395988464,-0.24312514066696167,-0.22753843665122986,0.13990874588489532,0.0615888386964798,0.3069174885749817,0.011880021542310715,0.3076593577861786,0.233100026845932},{-0.11747314035892487,0.28548532724380493,-0.030262330546975136,0.12205962091684341,-0.2824589014053345,-0.09679294377565384,-0.08158928900957108,0.024050259962677956,0.32637646794319153,0.2674102783203125,-0.32706624269485474,-0.12420160323381424,0.2404489517211914,-0.11320143193006516,-0.07277460396289825,0.21149417757987976},{-0.3741525411605835,0.25892147421836853,-0.03188934922218323,-0.32706496119499207,0.33097532391548157,-0.2975795269012451,-0.3678653836250305,-0.5544480681419373,-0.08975235372781754,-0.24613411724567413,0.5823192596435547,0.14625976979732513,-0.02890249527990818,0.5123240947723389,0.028741372749209404,0.6800915598869324},{0.2906465530395508,0.15765151381492615,-0.26510393619537354,0.016885722056031227,-0.6598094701766968,-0.5944295525550842,0.1649652123451233,-0.5997995138168335,-0.03687770664691925,-0.1901799738407135,0.3675021529197693,-0.6181703209877014,-0.5343372821807861,0.10372373461723328,0.03474665433168411,-0.3221934139728546},{0.6834444403648376,-0.9002783894538879,-0.41710540652275085,0.1197332888841629,0.16048407554626465,-0.3457144796848297,-0.007442275527864695,-0.19953976571559906,-0.41396230459213257,-0.0656035915017128,-0.296847403049469,-0.3512161672115326,0.5649732351303101,-0.3313719928264618,-0.7036667466163635,-0.3117236793041229},{0.3490135371685028,0.31062865257263184,-0.1351386308670044,0.09107609838247299,0.07072386890649796,-0.18026787042617798,-0.1074107438325882,0.1558905988931656,-0.04735799878835678,0.17770782113075256,0.1497800648212433,0.20858855545520782,-0.1378161460161209,0.11336230486631393,0.039116933941841125,-0.3763654828071594},{-0.43603917956352234,0.2761881351470947,0.6082619428634644,-0.9407031536102295,0.1491653323173523,0.2004932016134262,0.16385577619075775,0.3612719774246216,0.32513317465782166,0.47097188234329224,0.47942429780960083,-0.4263423979282379,0.3525095283985138,-0.21757324039936066,0.07016124576330185,-0.24050605297088623},{0.1504058539867401,-0.321021169424057,-0.29009193181991577,0.34958556294441223,-0.2038504183292389,-0.31222695112228394,-0.06169972941279411,0.3071351945400238,0.25541743636131287,-0.1536322832107544,-0.25365105271339417,0.27913782000541687,0.3851677179336548,0.3405703604221344,-0.22172407805919647,0.6325743198394775},{0.28603267669677734,0.30773571133613586,-0.32347893714904785,0.08580150455236435,-0.10419552028179169,-0.12311087548732758,-0.2735597789287567,0.21064938604831696,-0.23523688316345215,-0.3448086678981781,-0.062309544533491135,0.07668760418891907,-0.5699866414070129,-0.11487221717834473,-0.2985449433326721,-0.18222080171108246},{0.16509169340133667,0.5736262202262878,0.3662832975387573,-0.3865555226802826,-0.40620872378349304,0.2524684965610504,-0.10937344282865524,0.0390784852206707,0.5202293395996094,0.25556978583335876,-0.23323003947734833,0.1575312614440918,-0.21624203026294708,-0.37102609872817993,0.18183627724647522,-0.34947818517684937},{-0.3248252272605896,-0.05770077556371689,-0.0387420617043972,0.22413282096385956,-0.02033858932554722,0.01828048750758171,-0.15555249154567719,-0.00868754182010889,-0.3777427077293396,-0.10044260323047638,0.23989495635032654,0.07756257057189941,-0.18730011582374573,-0.2128005474805832,-0.37041401863098145,-0.10730651766061783},{-0.28306323289871216,0.1511443704366684,-0.17187242209911346,0.00018470211944077164,-0.114419125020504,0.3166046142578125,0.33780574798583984,0.1381569802761078,0.19733744859695435,-0.244563490152359,-0.05627753585577011,-0.10383555293083191,-0.014719905331730843,0.031112153083086014,-0.015465638600289822,-0.14920198917388916},{0.11520999670028687,-0.4092850387096405,0.13087491691112518,0.16782516241073608,0.0065308730117976665,0.28522732853889465,0.31272777915000916,0.12696360051631927,-0.13535858690738678,-0.23190857470035553,-0.09997578710317612,-0.14365659654140472,-0.12735366821289062,-0.37228742241859436,0.055840037763118744,0.011530140414834023}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1508456915616989,0.3116002678871155,0.3579017221927643,-0.06895752251148224,-0.17674218118190765,0.0277392715215683,0.07991351187229156,0.2512979805469513,-0.07538685202598572,0.3052676320075989,0.471383273601532,-0.36639606952667236,-0.10256697982549667,0.06978417932987213,0.011139762587845325,-0.04431376978754997},{-0.5277238488197327,0.236181378364563,-0.2845284640789032,0.27190813422203064,0.34941208362579346,-0.10909774154424667,-0.32314613461494446,-0.28372350335121155,0.2597425878047943,0.31679633259773254,-0.07543467730283737,0.21109996736049652,-0.30137908458709717,0.16064178943634033,-0.2741619646549225,0.4127019941806793},{-0.397294819355011,0.17955897748470306,-0.3433821499347687,0.057733356952667236,-0.40122708678245544,-0.28010180592536926,-0.11427948623895645,0.031061921268701553,-0.22849330306053162,0.3459094762802124,0.19541609287261963,-0.06161297857761383,0.22032977640628815,-0.3590843081474304,-0.041633374989032745,0.03447224944829941},{0.2285671830177307,-0.22160018980503082,0.08427192270755768,0.43662306666374207,-0.4542523920536041,-0.328062504529953,0.24980822205543518,0.12519371509552002,0.2969600260257721,-0.07373683154582977,0.2624497711658478,0.10740451514720917,-0.26052141189575195,-0.05939044430851936,-0.02281251735985279,-0.35244426131248474},{-0.32809457182884216,0.0038087244611233473,0.23316575586795807,-0.36055198311805725,0.12376881390810013,0.2909564971923828,-0.31854814291000366,0.25545066595077515,-0.2142665833234787,0.17639058828353882,-0.13514892756938934,0.004517336376011372,-0.16322539746761322,0.005497966427356005,-0.19549618661403656,-0.19393159449100494},{0.008098517544567585,-0.21397727727890015,-0.04353570565581322,-0.38335129618644714,0.2949507534503937,0.07961579412221909,-0.01521653775125742,-0.09400790184736252,-0.2035512626171112,0.35407745838165283,0.3172043263912201,-0.08891700208187103,-0.16977865993976593,0.24926146864891052,-0.07539200037717819,-0.3596642315387726},{0.2183866649866104,-0.1732090562582016,0.2818607687950134,-0.3048863112926483,-0.3767741620540619,-0.05403929948806763,-0.37850233912467957,0.34518536925315857,-0.14034254848957062,-0.25573670864105225,-0.25341975688934326,-0.02632564678788185,-0.06652242690324783,-0.06671029329299927,0.45920586585998535,-0.39585423469543457},{-0.2960908114910126,0.38321825861930847,-0.05117432400584221,0.223454549908638,0.015956399962306023,-0.23938365280628204,-0.12839752435684204,0.10229399055242538,-0.04618772491812706,0.4968777298927307,0.13389743864536285,-0.22472652792930603,0.06471357494592667,-0.10325877368450165,0.07392878085374832,0.17443692684173584},{0.15621556341648102,0.2752426266670227,-0.16385512053966522,-0.3545953631401062,0.37135380506515503,-0.19028395414352417,0.24802422523498535,-0.36693012714385986,0.05817848816514015,0.01387312076985836,0.13570719957351685,0.10885520279407501,-0.015047715976834297,-0.2381121814250946,-0.10543221235275269,0.1995687186717987},{-0.19057723879814148,-0.014649517834186554,-0.27806082367897034,-0.31438618898391724,0.2241200953722,-0.4545735716819763,-0.19124360382556915,0.26029229164123535,-0.08844416588544846,0.1719493418931961,0.01655656471848488,-0.0646265298128128,-0.36193984746932983,-0.0008113126968964934,-0.21705353260040283,-0.3582543432712555},{-0.2352091521024704,-0.09284628182649612,-0.10187418758869171,-0.3294840455055237,-0.32870349287986755,0.008630706928670406,0.13388529419898987,-0.46708759665489197,0.0005666603683494031,-0.04223890230059624,0.1349806785583496,-0.00724360067397356,0.38111844658851624,0.03163035213947296,0.20020775496959686,0.22101400792598724},{-0.20871123671531677,-0.05170682445168495,-0.4104384779930115,0.37294846773147583,0.12063046544790268,0.04505369812250137,0.15815286338329315,0.07293057441711426,-0.3686283528804779,0.2157183438539505,-0.38051703572273254,-0.13400019705295563,-0.3686467707157135,0.3898872435092926,-0.33550968766212463,0.09484988451004028},{-0.10873421281576157,-0.4475082755088806,-0.06862922757863998,0.1514488309621811,-0.1973787546157837,-0.08552180230617523,-0.06830618530511856,0.3511967360973358,0.41360312700271606,0.08539673686027527,-0.10179053246974945,-0.24661245942115784,0.1623905748128891,-0.32179778814315796,0.1526956707239151,-0.2075679898262024},{-0.2487732619047165,-0.4846225380897522,-0.17017175257205963,-0.1403139978647232,-0.47353556752204895,0.3523648977279663,-0.07979375869035721,0.20313259959220886,-0.19882738590240479,-0.33455756306648254,-0.28936392068862915,0.39530858397483826,-0.17550045251846313,0.08920082449913025,-0.2546370029449463,0.3504314720630646},{-0.3237762153148651,0.32762351632118225,-0.1705137938261032,0.0963519886136055,-0.36050838232040405,0.14787626266479492,0.06610097736120224,-0.3746059238910675,0.11164899170398712,0.1509459912776947,-0.11197434365749359,0.0759628564119339,0.281281441450119,-0.20939016342163086,-0.3278445899486542,-0.1600736528635025},{-0.16138730943202972,-0.37263765931129456,-0.514642059803009,0.2978486120700836,0.05822555348277092,0.11568326503038406,-0.2525406777858734,0.19113442301750183,-0.4182434380054474,-0.3017883598804474,-0.4032977819442749,0.24902792274951935,-0.24100416898727417,0.20279060304164886,0.09892073273658752,0.34648120403289795}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.06529506295919418,-0.09677822142839432,0.1534428745508194,-0.10267423838376999,-0.08820825815200806,0.12756158411502838,0.19699272513389587,-0.23668381571769714,-0.1911499947309494,0.28424063324928284,0.10245786607265472,0.11178062856197357,0.07310902327299118,0.13332392275333405,-0.17488951981067657,0.14355610311031342,0.1273413747549057,-0.2970336079597473,-0.1947982758283615,-0.07122116535902023,-0.17061445116996765,0.08956144750118256,-0.18385225534439087,0.34981173276901245,-0.17610307037830353,-0.053394924849271774,0.10067366808652878,0.1848701685667038,-0.1858358532190323,-0.1657070517539978,0.2106163203716278,0.24127197265625},{0.14915508031845093,-0.056095246225595474,0.1696338951587677,-0.10893703997135162,-0.07659082859754562,0.23129773139953613,0.04324813187122345,-0.046118732541799545,-0.037472665309906006,-0.06179709732532501,-0.09214885532855988,0.00398697704076767,0.3657420873641968,0.2198244333267212,0.10223403573036194,0.0332927480340004,-0.2345653623342514,-0.27094659209251404,0.12031475454568863,0.033512797206640244,0.10050904750823975,0.2836068272590637,0.2810142934322357,-0.1635262370109558,0.04706590995192528,0.27950000762939453,-0.3577798902988434,0.2054152488708496,0.024364212527871132,-0.2409888207912445,-0.08574799448251724,-0.01850549690425396},{-0.06613385677337646,-0.06971181184053421,0.21647979319095612,-0.17629197239875793,-0.14765581488609314,0.07489238679409027,-0.1962076872587204,0.21345266699790955,0.18701015412807465,0.01796667091548443,-0.18677198886871338,0.021094514057040215,0.3176770806312561,-0.2761293947696686,0.10616607964038849,-0.059607475996017456,-0.35129886865615845,0.25005507469177246,-0.3045317232608795,-0.05084555596113205,-0.045222241431474686,-0.11411917209625244,-0.035266581922769547,-0.04154813289642334,-0.03623007982969284,0.34345492720603943,-0.09035060554742813,0.09378387778997421,0.23138724267482758,-0.31854355335235596,-0.1393831968307495,-0.017537156119942665},{0.14310970902442932,-0.19460926949977875,0.005330847110599279,-0.365541934967041,0.06606405973434448,-0.14499637484550476,-0.0747424066066742,0.18934808671474457,0.05431922897696495,0.19639715552330017,0.05478082597255707,-0.10732044279575348,-0.20636093616485596,-0.017792563885450363,0.24024714529514313,-0.20709700882434845,0.044621001929044724,-0.08707350492477417,-0.14805568754673004,0.11701836436986923,-0.14758050441741943,0.12816950678825378,-0.2705504894256592,0.25865212082862854,-0.2298581302165985,0.07165423780679703,-0.05061148852109909,-0.2172916829586029,0.1524256020784378,-0.006584332790225744,0.2340143620967865,-0.1458696722984314},{0.2571887671947479,-0.05579638481140137,0.009901349432766438,0.24964293837547302,-0.31242209672927856,-0.09190940111875534,0.17053598165512085,-0.026589149609208107,0.13737210631370544,-0.1746639907360077,-0.0001227562897838652,-0.08142880350351334,-0.19334909319877625,-0.12464385479688644,0.2791695296764374,0.23160816729068756,-0.04202079027891159,-0.3065004348754883,0.1055460050702095,-0.12571270763874054,-0.13811880350112915,0.23642197251319885,0.2325403243303299,0.01902892254292965,-0.0980115756392479,-0.09978953003883362,0.05384732037782669,0.24373504519462585,0.16553865373134613,0.090506911277771,0.12222012877464294,-0.22250179946422577},{0.30824846029281616,-0.13793718814849854,0.009902279824018478,0.09362475574016571,-0.11329308897256851,-0.3122449815273285,-0.23075030744075775,-0.30685824155807495,-0.1923205405473709,0.02949867956340313,-0.022556334733963013,0.022709764540195465,-0.10030099004507065,-0.0825619101524353,-0.20071296393871307,-0.2591448128223419,0.1600189059972763,-0.005356286186724901,-0.32039543986320496,0.1979134976863861,-0.076353520154953,-0.20112000405788422,0.2058638632297516,-0.1508287489414215,-0.16854359209537506,-0.20963424444198608,-0.11440718919038773,0.08760517090559006,0.0439145527780056,0.2311701774597168,-0.2539474070072174,0.2041005939245224},{0.16928060352802277,0.0966152474284172,0.22171583771705627,-0.15918244421482086,0.24245451390743256,-0.21088944375514984,-0.28882530331611633,0.0037455789279192686,0.27360936999320984,0.11572519689798355,-0.14486123621463776,0.11626729369163513,0.05713214725255966,0.3033941090106964,0.0915333703160286,-0.05902114510536194,-0.18314258754253387,0.10729755461215973,-0.0036733399610966444,-0.05248519405722618,-0.05700597167015076,0.19092786312103271,0.17288251221179962,0.10663475096225739,-0.24570231139659882,-0.2002699077129364,-0.2626311182975769,-0.30723410844802856,0.12274400889873505,-0.1446024626493454,0.3153640329837799,0.17826087772846222},{0.30752095580101013,-0.35404419898986816,0.08032330125570297,-0.41058507561683655,-0.34235242009162903,0.27785786986351013,0.4014626741409302,0.1733652949333191,-0.06542759388685226,0.08420230448246002,0.1802656650543213,-0.13196392357349396,0.06598009914159775,0.31028056144714355,-0.0409725159406662,0.20679379999637604,0.3917909562587738,-0.2644132375717163,-0.06331782788038254,-0.36585402488708496,0.19835402071475983,0.21943522989749908,0.19254140555858612,0.14243048429489136,0.13602568209171295,0.11810450255870819,0.16685804724693298,0.258576363325119,-0.02609652280807495,-0.2780475914478302,0.23520857095718384,0.03657008334994316},{0.07196928560733795,-0.12506428360939026,0.22802414000034332,0.2518000900745392,-0.19418087601661682,-0.259272962808609,-0.06760222464799881,0.2519393563270569,-0.19741976261138916,-0.1483544111251831,-0.004823034629225731,0.07896510511636734,0.16438525915145874,-0.3254609704017639,0.16548800468444824,-0.1917586326599121,-0.19988945126533508,0.1829015016555786,-0.26369771361351013,0.2852938175201416,-0.3812168538570404,-0.26882368326187134,-0.30296286940574646,0.27452969551086426,0.07873120158910751,0.05303896218538284,0.29717501997947693,0.19145885109901428,-0.15254923701286316,-0.307516872882843,-0.15832427144050598,0.16707633435726166},{0.29955777525901794,0.04393664002418518,0.01416727527976036,0.23455706238746643,0.019924212247133255,0.22756478190422058,-0.07656430453062057,0.20516403019428253,-0.02863442152738571,0.026384718716144562,0.15575329959392548,0.1222529336810112,-0.0605974905192852,-0.2904296815395355,0.1770143061876297,0.1892675757408142,-0.019168013706803322,-0.13721852004528046,-0.034099068492650986,0.031000318005681038,0.07871005684137344,-0.29735273122787476,0.3395747244358063,0.04840520769357681,-0.030494291335344315,0.11130155622959137,-0.37653017044067383,-0.18015317618846893,-0.07009205222129822,-0.0004863095819018781,0.09076029062271118,0.19087103009223938},{-0.0828615352511406,0.09661915898323059,-0.0506545789539814,0.19100837409496307,-0.052963629364967346,0.3180772662162781,0.11282432824373245,-0.061317481100559235,0.24675710499286652,-0.30476051568984985,-0.15776537358760834,0.1367170214653015,-0.09579645097255707,0.05139891430735588,-0.2866409718990326,0.039905354380607605,0.07766944915056229,0.1534121185541153,0.11256391555070877,-0.12572139501571655,-0.2549186944961548,0.16519233584403992,0.2680555284023285,0.22106073796749115,-0.3275359869003296,0.3263644576072693,-0.18987937271595,0.03549328073859215,-0.11413620412349701,0.14669685065746307,0.20485618710517883,0.2556800842285156},{-0.16132669150829315,0.25131386518478394,-0.09168923646211624,-0.016523214057087898,-0.2153320461511612,-0.1257653832435608,0.1567087024450302,-0.2695671617984772,-0.01580054499208927,-0.1985207200050354,-0.25082927942276,-0.07578321546316147,0.1688116043806076,-0.3020986318588257,-0.10098028182983398,-0.37336084246635437,-0.15752781927585602,-0.013240109197795391,0.26070335507392883,-0.3023737072944641,0.04102155566215515,-0.1193084642291069,0.020559091120958328,0.2914077639579773,-0.16295582056045532,0.15092508494853973,0.2909364104270935,-0.1309654861688614,-0.08407764881849289,0.30902332067489624,-0.15178635716438293,-0.2537434995174408},{-0.058491967618465424,0.22866861522197723,0.24170713126659393,-0.34294721484184265,0.3186936378479004,0.03734995424747467,-0.11984214186668396,-0.008475731126964092,0.13188795745372772,-0.2991243600845337,-0.04631591960787773,0.018868565559387207,0.22361956536769867,0.0311611145734787,0.007225773762911558,-0.03360035642981529,0.2402815818786621,-0.28708237409591675,0.3388012945652008,0.0908413678407669,-0.176502525806427,0.20883940160274506,-0.08084499090909958,-0.2026934176683426,0.24666890501976013,-0.10289701074361801,-0.03481988608837128,-0.13368423283100128,0.0021404048893600702,-0.12147299200296402,0.2797650694847107,0.24525679647922516},{0.1243077740073204,-0.1686665117740631,-0.15579889714717865,0.11009460687637329,0.09695123136043549,0.28281545639038086,-0.10107923299074173,-0.22700782120227814,0.2625330686569214,0.04367492347955704,0.05125434324145317,0.05500645563006401,-0.22349204123020172,0.06494023650884628,-0.16178488731384277,-0.24397721886634827,0.051150135695934296,-0.04848935455083847,0.23182906210422516,0.3312458097934723,-0.2155856341123581,0.07337293773889542,-0.12151608616113663,0.003511608811095357,0.05206683650612831,-0.2634132504463196,-0.15069249272346497,-0.19963930547237396,-0.0467655211687088,-0.1292022168636322,0.2603427767753601,-0.29055163264274597},{-0.007706902921199799,0.30594220757484436,0.19933849573135376,-0.1732073873281479,-0.07573744654655457,-0.15118663012981415,0.17184069752693176,-0.06612639129161835,0.1770075410604477,0.007858382537961006,0.19649982452392578,0.1385883092880249,0.020349441096186638,0.033161710947752,-0.09203939139842987,0.22093823552131653,-0.21519775688648224,-0.37377431988716125,-0.22187401354312897,0.1515660136938095,0.0723235011100769,-0.23406673967838287,-0.288943886756897,-0.19309170544147491,-0.24956689774990082,0.018505331128835678,0.3181563913822174,0.0006416650139726698,-0.0539199523627758,0.14092573523521423,-0.16072282195091248,0.0667935386300087},{-0.1945345103740692,-0.18130405247211456,-0.2468155324459076,0.061511702835559845,-0.27026423811912537,-0.11892760545015335,-0.09816079586744308,-0.1131754070520401,-0.29048818349838257,-0.17696313560009003,0.09921751916408539,0.1725117415189743,-0.26375725865364075,0.2671317458152771,-0.03347207233309746,0.1893586665391922,0.047270260751247406,0.005671319551765919,0.03021343983709812,0.10909175127744675,0.15452879667282104,0.31756657361984253,0.08504853397607803,0.212863951921463,0.11423563212156296,-0.2319645881652832,-0.12410115450620651,0.26931032538414,0.027652960270643234,-0.22871986031532288,-0.1516161859035492,-0.1435285061597824},{-0.28973063826560974,-0.21884644031524658,-0.36693304777145386,0.07456493377685547,-0.13113905489444733,-0.09071265161037445,-0.14290504157543182,0.07164272665977478,-0.023697486147284508,0.1036684513092041,-0.2680334746837616,0.015981411561369896,0.14934208989143372,-0.04695998877286911,0.03393730893731117,0.19112348556518555,-0.16963021457195282,-0.0877918004989624,0.1401086151599884,0.10107044875621796,0.20257258415222168,0.016206620261073112,-0.27063673734664917,0.07244312763214111,0.1999519020318985,-0.3006986975669861,0.18373049795627594,-0.0014002160169184208,0.04479224607348442,-0.14060157537460327,0.20644262433052063,-0.08611630648374557},{0.2598292827606201,-0.05413016676902771,0.05557506904006004,0.1286882758140564,-0.30042728781700134,-0.010423991829156876,0.15258120000362396,0.2008187174797058,-0.07819736748933792,-0.11225694417953491,0.3141743540763855,-0.1679515689611435,-0.006855979561805725,-0.040398385375738144,-0.15296143293380737,0.2166913002729416,0.006095863878726959,-0.057409632951021194,0.11534307152032852,-0.27428358793258667,0.03655323013663292,-0.3087059557437897,-0.24650761485099792,0.2577628791332245,-0.12958455085754395,-0.13171635568141937,0.1699964851140976,-0.013753104023635387,-0.17499804496765137,-0.006622179877012968,-0.09020131081342697,-0.04689006507396698},{0.29937639832496643,-0.03439677506685257,0.052944980561733246,0.06838879734277725,-0.013804086484014988,-0.12687484920024872,0.14001071453094482,-0.2362496703863144,0.23611637949943542,0.271019846200943,0.012695642188191414,0.17959028482437134,0.24428965151309967,0.3284197151660919,-0.300326943397522,-0.2911887764930725,-0.3077984154224396,0.020965946838259697,-0.15356828272342682,-0.31306636333465576,-0.18171852827072144,0.2833019196987152,0.06649326533079147,0.11729469895362854,-0.13777147233486176,-0.06359027326107025,-0.14028717577457428,-0.18259145319461823,0.2686118483543396,0.1434815675020218,-0.2694401144981384,-0.132771298289299},{-0.11936005204916,0.1836443841457367,0.2850286662578583,-0.053351882845163345,-0.01943591982126236,0.043358806520700455,-0.016461223363876343,-0.32303133606910706,0.2006753385066986,0.22918929159641266,0.20153740048408508,0.2273794263601303,-0.26754826307296753,0.20632600784301758,-0.27933210134506226,0.3072616159915924,0.13303466141223907,-0.26081907749176025,0.25470250844955444,0.12200867384672165,-0.2813483476638794,0.27730944752693176,-0.3157874345779419,0.103516586124897,0.16683027148246765,0.23190757632255554,0.09897779673337936,0.11234255135059357,-0.23413147032260895,0.23846694827079773,-0.09199356287717819,0.10594546794891357},{-0.11306854337453842,-0.05227372422814369,0.07531704008579254,0.23775872588157654,0.01416073739528656,0.22856812179088593,-0.32000064849853516,-0.16589438915252686,-0.21477609872817993,-0.09442126750946045,-0.18809469044208527,-0.14081929624080658,0.06909848004579544,-0.1295831799507141,0.15231607854366302,-0.14144620299339294,0.11467833817005157,-0.015334663912653923,-0.27923694252967834,-0.2172529250383377,0.08335171639919281,0.20605699717998505,-0.13587450981140137,0.3396964371204376,-0.3258213996887207,0.04873405024409294,0.07435037195682526,-0.08502247184515,0.02676612138748169,-0.18828974664211273,0.3150874972343445,0.06027368828654289},{0.35141199827194214,-0.020007606595754623,0.05247344821691513,0.18279653787612915,-0.1428680717945099,0.2388020008802414,-0.0499725379049778,0.2304643988609314,0.15350495278835297,0.10277669131755829,0.055030614137649536,-0.37559774518013,-0.26731306314468384,-0.07957793772220612,0.08878442645072937,-0.10801123827695847,0.29085737466812134,0.16569069027900696,-0.1933622509241104,-0.21599601209163666,0.27575522661209106,0.2705588936805725,0.2775290608406067,0.1255418211221695,-0.07877475023269653,-0.0181395523250103,-0.10527448356151581,-0.20334842801094055,0.12192213535308838,0.06681599467992783,-0.1911831945180893,0.12340521067380905},{-0.02217761240899563,0.026025593280792236,-0.05276349559426308,-0.24069498479366302,-0.10298488289117813,-0.24043042957782745,-0.2215094119310379,-0.17737218737602234,0.011307713575661182,-0.019189845770597458,-0.2503582835197449,0.030985791236162186,-0.2470523715019226,-0.1515655219554901,0.0026134513318538666,0.08590950816869736,0.26593294739723206,-0.16915613412857056,-0.34838342666625977,0.27468472719192505,-0.1490936428308487,0.24956266582012177,-0.024043316021561623,-0.05381873995065689,0.04144907370209694,0.11987952142953873,-0.055775515735149384,-0.2782507538795471,0.2019929587841034,0.2593860626220703,-0.14766059815883636,0.18899491429328918},{-0.2810693681240082,-0.03210392966866493,0.03297245502471924,-0.012362628243863583,0.006267073098570108,0.08059390634298325,-0.1965792179107666,0.08042784035205841,-0.18673576414585114,-0.19882595539093018,0.10128048062324524,-0.12659159302711487,-0.15811210870742798,0.28219321370124817,0.005442366003990173,-0.009568372741341591,0.2050170749425888,-0.23443077504634857,-0.17809854447841644,0.2816738784313202,0.022375665605068207,0.22926877439022064,-0.017398156225681305,0.03016819804906845,-0.22095520794391632,-0.13231146335601807,0.029158057644963264,0.2898581922054291,0.012588854879140854,-0.024221450090408325,0.2667289674282074,0.28205564618110657}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10888388752937317,0.09152773022651672,0.2688470482826233,0.00994460191577673},{0.051987409591674805,-0.06935039162635803,0.02459222637116909,0.17238132655620575},{-0.12723498046398163,0.10759847611188889,0.06774742901325226,0.11711210012435913},{0.3291909694671631,0.05428604781627655,0.08971081674098969,0.395061731338501},{-0.05041031166911125,0.06706205755472183,0.2843341529369354,0.008911085315048695},{-0.13937842845916748,0.20628701150417328,0.19878548383712769,-0.015754902735352516},{-0.2630695104598999,-0.013719151727855206,0.02772064134478569,-0.09615463763475418},{-0.30610862374305725,-0.10582656413316727,0.299049437046051,-0.27450910210609436},{0.2725348174571991,-0.15029063820838928,-0.2383470982313156,-0.33121708035469055},{0.07456326484680176,0.24300655722618103,0.2894897758960724,-0.33163195848464966},{-0.10455290228128433,-0.14227654039859772,-0.12847483158111572,0.1145082637667656},{0.28292423486709595,-0.13887952268123627,0.0009057297720573843,0.14869935810565948},{0.2264203280210495,0.27118414640426636,-0.05738869681954384,0.11239377409219742},{-0.0010533963795751333,0.005257581360638142,-0.2770760655403137,0.05702865123748779},{0.09773727506399155,0.24471132457256317,0.2828430235385895,0.23477007448673248},{0.13864293694496155,0.01758730597794056,0.22124110162258148,0.24741441011428833},{-0.2304472178220749,-0.09811866283416748,-0.09787905216217041,-0.2076355367898941},{-0.12052199244499207,0.10936059802770615,-0.0986119881272316,-0.09843083471059799},{-0.2794191837310791,0.13184647262096405,0.13838350772857666,0.30920639634132385},{-0.026594320312142372,0.296432763338089,-0.14584456384181976,0.1526995152235031},{-0.21026575565338135,-0.30468064546585083,-0.12339825928211212,-0.005247429013252258},{0.2935448884963989,0.32521140575408936,0.03111898899078369,-0.2198755294084549},{-0.0029892828315496445,0.15205295383930206,0.18014289438724518,0.15447098016738892},{-0.07013581693172455,0.34062206745147705,-0.03805400803685188,-0.13626618683338165},{0.010960887186229229,-0.033193349838256836,-0.06973439455032349,-0.02522086724638939},{0.22846969962120056,-0.31497621536254883,-0.046881336718797684,0.03407428041100502},{-0.019361397251486778,-0.29330962896347046,-0.1535518318414688,-0.26668107509613037},{0.1247442290186882,-0.15167100727558136,0.19848628342151642,0.0940474197268486},{-0.0036311608273535967,-0.007952715270221233,0.003200925886631012,0.010345090180635452},{-0.3736596703529358,0.35616543889045715,0.19093678891658783,-0.001198116922751069},{0.32456985116004944,-0.14146631956100464,0.1782892644405365,-0.0404292494058609},{0.10348004847764969,-0.3307744562625885,0.3349642753601074,-0.2161192148923874}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.08743101358413696,-0.03880809247493744,0.012662667781114578,0.03458958864212036,-0.0697924867272377,-0.10330992192029953,0.03952007368206978,0.037259556353092194,0.016132045537233353,-0.014682483859360218,-0.04055214300751686,-0.0008779145427979529,0.05817272886633873,0.031938858330249786,-0.09543880075216293,-0.009166205301880836};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0261310413479805,0.00811218935996294,0.009470718912780285,0.003296064678579569,0.008624217472970486,0.003076244378462434,0.02611563727259636,0.032900746911764145,0.009092948399484158,0.032955240458250046,0.03058239445090294,-0.013684936799108982,0.040719445794820786,-0.027392691001296043,-0.047996945679187775,0.009545208886265755};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01227009017020464,0.011397579684853554,0.005118480417877436,-0.005151207558810711,0.01808040216565132,0.00418023020029068,0.0006167324027046561,0.022238297387957573,-0.036595419049263,-0.008532145991921425,-0.010035146027803421,-0.0009345134603790939,0.00653384393081069,-0.012450484558939934,0.005059410817921162,0.043790291994810104,-0.0006777149974368513,-0.029969507828354836,0.022453418001532555,-0.015509574674069881,-0.02664223685860634,0.001662895898334682,0.05494815856218338,0.01243885513395071,0.0018451764481142163,0.02770436368882656,-0.02979440614581108,0.0417519211769104,0.020092954859137535,-0.0019196143839508295,0.017688944935798645,0.018314339220523834};
static const float action_parameterization_distribution_linear_bias[4] = {-0.0016708668554201722,-0.013858097605407238,0.008893233723938465,0.0074773565866053104};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.04137587547302246,0.28677549958229065,-0.13494396209716797,0.17494253814220428,0.09541064500808716,0.04765177518129349,0.5796408653259277,-0.12445568293333054},{-0.14212219417095184,-0.03630760684609413,-0.2559235692024231,-0.21497049927711487,-0.4084141254425049,-0.26221445202827454,0.08404703438282013,-0.26050734519958496},{-0.20498721301555634,0.009093993343412876,0.27549952268600464,0.26105043292045593,0.21546734869480133,-0.04707297310233116,0.4261908233165741,-0.1638493835926056},{0.027149656787514687,0.08229534327983856,-0.11871620267629623,0.03631758689880371,-0.02078726887702942,-0.07805231213569641,0.392399400472641,-0.2473134696483612},{-0.2425140142440796,-0.1211940348148346,-0.18003028631210327,-0.11061742156744003,-0.06061461195349693,0.1616501659154892,0.2746104598045349,-0.08008940517902374},{-0.2949563264846802,-0.029955552890896797,0.4781150817871094,0.27038609981536865,0.14067469537258148,-0.12800288200378418,-0.0581805519759655,-0.17150995135307312},{-0.25367045402526855,0.008828290738165379,0.5289426445960999,-0.1599799394607544,-0.17092125117778778,-0.4377555847167969,-0.04584093764424324,-0.12967221438884735},{-0.2766142785549164,-0.3708288073539734,0.6377792954444885,-0.03136570006608963,-0.23863887786865234,0.21478654444217682,0.22364506125450134,-0.2520143985748291},{-0.36609524488449097,0.2976369857788086,-0.0686284676194191,0.3925563395023346,0.06717991083860397,-0.3342091143131256,0.05081098526716232,0.10392940044403076},{-0.4245004951953888,-0.3319227695465088,-0.10446420311927795,-0.2097017914056778,-0.5400401949882507,0.13942278921604156,-0.01277828961610794,0.17229419946670532},{0.08203345537185669,0.3174584209918976,0.2561962902545929,-0.024480009451508522,0.20045848190784454,0.16729509830474854,-0.1806386262178421,0.24268534779548645},{0.12332037836313248,0.011273420415818691,0.27590158581733704,0.2292601615190506,-0.3019854724407196,0.3408965468406677,0.02504567615687847,-0.21012486517429352},{0.04830749332904816,-0.3427293300628662,0.27485716342926025,-0.0751454085111618,-0.36495447158813477,-0.04992605000734329,-0.14370448887348175,-0.11231192201375961},{-0.26766204833984375,-0.2734270989894867,0.35524192452430725,0.3356654644012451,-0.2614077925682068,-0.04742501676082611,-0.26260921359062195,0.22955264151096344},{0.01610454171895981,-0.2204781472682953,0.17454376816749573,-0.2295752316713333,-0.2904455363750458,-0.10638319700956345,0.25452443957328796,0.022261396050453186},{0.14177966117858887,-0.1116514801979065,0.06495054066181183,-0.23551547527313232,0.058394644409418106,0.09561554342508316,0.09983383119106293,0.41882607340812683},{-0.0951000526547432,-0.3652772009372711,-0.14761437475681305,0.12146315723657608,-0.21176275610923767,-0.1285274475812912,-0.10279922187328339,0.14411431550979614},{-0.22821646928787231,-0.3442789316177368,0.045502305030822754,0.03122449479997158,0.10946760326623917,-0.1790970414876938,0.3769303858280182,0.16756971180438995},{-0.03447878733277321,0.08692791312932968,-0.24907559156417847,0.1039607897400856,0.09390593320131302,0.21056652069091797,-0.1863623857498169,0.3520765006542206},{0.08037205785512924,-0.05630955845117569,-0.351032018661499,0.09320862591266632,-0.07751625776290894,-0.00688600679859519,-0.26979321241378784,0.0016674255020916462},{0.024789664894342422,-0.1639346182346344,0.0823732540011406,-0.09053075313568115,0.32092708349227905,0.07079955190420151,0.044405654072761536,0.4066893756389618},{-0.05774777755141258,0.055470168590545654,-0.24678301811218262,0.2950447201728821,0.3629438281059265,0.3895808160305023,0.250524640083313,-0.2987419068813324},{-0.5130200386047363,-0.20344334840774536,0.16935497522354126,-0.08627317100763321,0.22735172510147095,-0.21334770321846008,0.30779460072517395,-0.2664431631565094},{-0.2542816698551178,-0.01906500570476055,-0.08022235333919525,-0.46087726950645447,0.25539037585258484,0.09070805460214615,-0.22456121444702148,0.1656557321548462},{-0.34481868147850037,-0.19566529989242554,-0.028647471219301224,-0.01778336800634861,-0.04670140892267227,0.23318003118038177,0.39480581879615784,-0.1401369273662567},{-0.31821081042289734,0.056458551436662674,-0.38156813383102417,-0.3468019962310791,0.16528433561325073,0.07328234612941742,-0.0017190937651321292,0.04611121490597725},{0.2708975076675415,0.38184699416160583,-0.29885241389274597,0.1540306657552719,0.21259677410125732,0.41998690366744995,-0.17873874306678772,-0.15934406220912933},{0.31661397218704224,0.2509746253490448,0.037836942821741104,0.042421262711286545,0.2892332673072815,0.22974224388599396,0.38097861409187317,0.35688695311546326},{-0.2001931369304657,0.3763715624809265,0.13371391594409943,-0.019600238651037216,0.236395001411438,0.08346430212259293,-0.23133371770381927,-0.30251607298851013},{-0.2848455607891083,-0.21642941236495972,0.05229322984814644,-0.29976004362106323,-0.29154902696609497,-0.12746624648571014,0.44768214225769043,-0.08029267191886902},{0.2983873188495636,-0.22945567965507507,0.3363063633441925,-0.35445520281791687,0.016619661822915077,0.2414538860321045,0.3644159138202667,-0.30529001355171204},{0.1113237515091896,0.4217361509799957,0.3997258245944977,-0.29866597056388855,-0.3044337034225464,0.04233429580926895,0.3934376537799835,-0.015099790878593922}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.007323067635297775,0.4424266219139099,-0.1574745774269104,0.17289918661117554,-0.4236210882663727,0.3163284361362457,0.3113739788532257,0.113344706594944},{-0.5135610699653625,-0.4185102880001068,-0.3616653084754944,-0.4579165279865265,-0.4742123782634735,0.4941388964653015,0.3383309543132782,-0.355185329914093},{0.1173505112528801,-0.1556824892759323,0.14896801114082336,0.20035742223262787,-0.012671825475990772,0.45286452770233154,-0.2840273976325989,-0.519894540309906},{0.4053947925567627,-0.09257984161376953,0.2066049575805664,-0.018952835351228714,0.46994906663894653,0.44983160495758057,0.5287024974822998,0.38718560338020325},{0.10672097653150558,0.16821503639221191,-0.13399569690227509,-0.23280343413352966,0.08052214980125427,-0.40972644090652466,-0.516614556312561,0.5601658225059509},{0.4579419493675232,0.12958915531635284,-0.02210943214595318,-0.32293564081192017,-0.4587589204311371,-0.4888055920600891,-0.11410129070281982,0.4085889458656311},{-0.4735111594200134,-0.31053856015205383,-0.12836627662181854,-0.22072440385818481,-0.012951335869729519,0.5234782099723816,-0.5103075504302979,0.4968698024749756},{0.1377962976694107,0.06805753707885742,-0.004863053094595671,0.014360304921865463,0.3305926024913788,-0.45249369740486145,0.29405832290649414,-0.35781946778297424}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07392611354589462,0.0249584149569273,0.053131259977817535,-0.029864277690649033,-0.05394335091114044,0.021592987701296806,0.058802224695682526,-0.016305308789014816};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.013311240822076797,0.014503194019198418,-0.059813324362039566,0.06869354844093323,-0.006577865686267614,-0.005934692919254303,0.036943159997463226,-0.09170994162559509};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

