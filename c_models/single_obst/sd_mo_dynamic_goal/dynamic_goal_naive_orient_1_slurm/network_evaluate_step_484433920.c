#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2856523394584656,0.021393408998847008,-0.14488542079925537,0.30368176102638245,0.25901907682418823,-0.19716282188892365,-0.21915249526500702,0.10337192565202713,0.27717453241348267,-0.32844653725624084,0.5748874545097351,-0.03872628137469292,0.2905552387237549,0.1156839057803154,-0.4359424114227295,0.0476282462477684},{-0.24495811760425568,-0.27657321095466614,-0.29547417163848877,-0.17135287821292877,0.08381688594818115,0.2668675184249878,0.07614663243293762,0.08005225658416748,0.22708652913570404,0.17222842574119568,-0.15933653712272644,-0.09244951605796814,-0.16587534546852112,0.08323801308870316,0.33362141251564026,-0.2910207211971283},{0.14582058787345886,0.2010364830493927,0.20708423852920532,0.34820958971977234,-0.10914511233568192,-0.23513051867485046,0.46414172649383545,-0.04060063138604164,-0.012536327354609966,-0.09781406074762344,-0.053110744804143906,-0.013457806780934334,0.06168551370501518,0.44787341356277466,-0.2623961269855499,-0.06543642282485962},{0.13238178193569183,-0.16259336471557617,-0.13529038429260254,-0.13069552183151245,0.0386156290769577,0.1010732650756836,0.06518835574388504,-0.20105591416358948,-0.16491201519966125,0.17734907567501068,0.5252691507339478,-0.22350600361824036,-0.16291555762290955,-0.15237826108932495,0.18157589435577393,0.11295764148235321},{-0.3132699728012085,0.05313941836357117,0.14203745126724243,-0.20653025805950165,0.2702728509902954,0.27643513679504395,0.14958049356937408,-0.2093273252248764,-0.13648928701877594,0.1415163278579712,-0.14571765065193176,-0.38456976413726807,-0.026926754042506218,-0.16463325917720795,0.3104965090751648,-0.04457905516028404},{0.011236985214054585,-0.01937060058116913,-0.009990835562348366,-0.03636399656534195,0.10374218970537186,-0.13657206296920776,0.4038273096084595,-0.3376365303993225,-0.13087895512580872,-0.17137788236141205,0.27534711360931396,0.019631631672382355,0.22384406626224518,0.08022259920835495,0.2895249128341675,0.2832457423210144},{-0.19818034768104553,0.1766538918018341,-0.05240343511104584,0.0636020079255104,-0.21266691386699677,-0.08364293724298477,-0.15984126925468445,-0.029711047187447548,0.13564513623714447,0.3624788820743561,-0.23868834972381592,-0.10229671001434326,0.2337539941072464,0.0723889172077179,-0.185268372297287,0.3180182874202728},{-0.13781918585300446,0.013764283619821072,-0.13869088888168335,-0.1949683278799057,0.38283035159111023,-0.28446164727211,-0.3020593225955963,-0.42095810174942017,-0.04338347166776657,-0.22200840711593628,0.4072806239128113,-0.0423402264714241,0.18103185296058655,0.16181662678718567,-0.20584040880203247,0.4094868004322052},{0.2297770380973816,0.06899130344390869,0.00034890431561507285,0.08560486882925034,-0.3907970190048218,-0.4359387159347534,0.33870968222618103,-0.2885597050189972,-0.13225530087947845,0.22792905569076538,0.18083056807518005,-0.28187400102615356,-0.16567468643188477,0.028777578845620155,0.16463454067707062,-0.031207341700792313},{0.47803980112075806,-0.5497570037841797,-0.08505553752183914,-0.0014554745284840465,0.22185051441192627,-0.13765010237693787,-0.2399044781923294,-0.13781358301639557,-0.17925675213336945,-0.009026733227074146,-0.02117125131189823,-0.19711008667945862,0.36790648102760315,-0.08405185490846634,-0.5051146745681763,-0.16989240050315857},{0.2538850009441376,0.18585051596164703,-0.3336963653564453,0.08310060203075409,0.0016872765263542533,-0.18512104451656342,-0.13260658085346222,0.1326998770236969,-0.1576414406299591,0.1643756628036499,0.16395384073257446,0.2257819026708603,-0.09829354286193848,0.2501802146434784,-0.04992155730724335,-0.24946066737174988},{-0.4228062629699707,0.26287195086479187,0.2359052151441574,-0.29851141571998596,-0.2860008776187897,0.31651413440704346,0.05120373144745827,0.34605681896209717,0.2135792225599289,0.14501626789569855,0.2487645149230957,-0.11879841983318329,0.15341439843177795,-0.06812863051891327,-0.07779732346534729,-0.15999168157577515},{0.10930284857749939,-0.23330752551555634,-0.20387323200702667,0.1928570419549942,-0.22217221558094025,-0.262592613697052,-0.1355319619178772,0.23106954991817474,0.3148878812789917,-0.1649249941110611,-0.11386635899543762,0.05311352014541626,0.2829981744289398,0.12183601409196854,-0.16660794615745544,0.3066159188747406},{0.2733544409275055,0.2064581960439682,-0.14444896578788757,-0.09486960619688034,0.08538419753313065,-0.08229857683181763,-0.12234736979007721,0.31612080335617065,-0.21424613893032074,-0.17189161479473114,-0.15683647990226746,0.02211286500096321,-0.21764758229255676,-0.11731697618961334,-0.21728256344795227,-0.03273666650056839},{0.17901559174060822,0.3664383292198181,0.4086577296257019,-0.3749999701976776,-0.3708277940750122,0.08438169211149216,0.04463997110724449,-0.16712428629398346,0.3717823028564453,0.36584708094596863,-0.16644392907619476,0.07879400998353958,-0.062425676733255386,-0.2983938157558441,0.05325297266244888,-0.11687318980693817},{-0.15801429748535156,-0.1843576282262802,-0.12420537322759628,0.43272870779037476,-0.24451351165771484,-0.21601417660713196,-0.21726441383361816,-0.2866440415382385,-0.5503094792366028,-0.27313363552093506,0.33982744812965393,0.26058951020240784,-0.6047677993774414,-0.35962238907814026,-0.6185628175735474,-0.14521723985671997},{-0.47059929370880127,0.18755076825618744,-0.3745797276496887,-0.16622847318649292,-0.4615463316440582,0.18500442802906036,0.48069658875465393,0.05273841693997383,0.4347110688686371,-0.4854075312614441,0.20936664938926697,-0.3779546618461609,-0.1928693652153015,0.02929791435599327,-0.1817990094423294,-0.2335393726825714},{0.34536731243133545,-0.5771311521530151,0.3100678324699402,0.248600572347641,-0.11758269369602203,0.47222697734832764,0.25630828738212585,0.2770969569683075,-0.0478467233479023,-0.2485540509223938,-0.10895538330078125,-0.187003955245018,-0.10330348461866379,-0.536125898361206,0.21081794798374176,-0.11083028465509415}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.051869943737983704,0.3066416084766388,0.23360978066921234,-0.15877202153205872,-0.18095538020133972,0.04490114003419876,-0.019250527024269104,0.24667400121688843,-0.06696058809757233,0.30905237793922424,0.48155057430267334,-0.38593149185180664,0.03823273256421089,0.054646704345941544,0.016226766631007195,-0.11223305016756058},{-0.4217909574508667,0.19071485102176666,-0.2004612386226654,0.3223491311073303,0.29065245389938354,-0.1573377400636673,-0.3232154846191406,-0.16357716917991638,0.37390244007110596,0.26157146692276,-0.051831845194101334,0.2404344379901886,-0.4045112133026123,0.17578616738319397,-0.22434566915035248,0.4452550411224365},{-0.27668556571006775,0.09952034056186676,-0.32865720987319946,0.18378201127052307,-0.47914761304855347,-0.23115362226963043,0.04436836019158363,0.1491732895374298,-0.21603728830814362,0.3807443380355835,0.2314854860305786,-0.14849890768527985,0.14607638120651245,-0.2688888609409332,-0.12460418045520782,-0.059934720396995544},{0.3261938691139221,-0.21739231050014496,0.10170053690671921,0.3977409303188324,-0.41124671697616577,-0.3077924847602844,0.2981574535369873,0.027993809431791306,0.2858332693576813,-0.10132695734500885,0.3286931812763214,0.08524458855390549,-0.19780924916267395,0.02744220569729805,-0.00026532754418440163,-0.42689913511276245},{-0.40732190012931824,-0.06369168311357498,0.16739384829998016,-0.27520042657852173,0.1533515751361847,0.38524559140205383,-0.2897028923034668,0.2851957380771637,-0.22953444719314575,0.21546705067157745,-0.0080018425360322,0.01883333921432495,-0.2626148760318756,-0.025313785299658775,-0.28492072224617004,-0.12325423210859299},{0.05195937678217888,-0.31435200572013855,-0.0022273268550634384,-0.3465285003185272,0.20328134298324585,0.05487656965851784,-0.14853323996067047,-0.054857101291418076,-0.15852808952331543,0.3896724283695221,0.2009410411119461,0.010545854456722736,-0.307174414396286,0.08201199769973755,0.016750065609812737,-0.28460922837257385},{0.2824440002441406,-0.18416562676429749,0.3396264612674713,-0.2198183536529541,-0.4218282699584961,-0.02029835805296898,-0.3497583568096161,0.34024807810783386,-0.10538571327924728,-0.24949242174625397,-0.2529243230819702,-0.01960018463432789,-0.062095727771520615,-0.08885779976844788,0.49562662839889526,-0.3855437636375427},{-0.3323829472064972,0.34474486112594604,-0.0847465917468071,0.18148978054523468,-0.06814078986644745,-0.2187764197587967,-0.23912590742111206,0.07537057250738144,-0.015837358310818672,0.5133990049362183,0.12008757889270782,-0.11995462328195572,0.05981351435184479,-0.2490909993648529,0.10009297728538513,0.15769565105438232},{0.10027186572551727,0.2819640636444092,-0.18349364399909973,-0.33192411065101624,0.35018354654312134,-0.19338296353816986,0.16455195844173431,-0.3154800534248352,0.0853978767991066,0.05665202811360359,0.08690551668405533,0.11736679822206497,0.03457361087203026,-0.4016285836696625,-0.06792284548282623,0.2098854035139084},{-0.2091371864080429,0.042947717010974884,-0.28411468863487244,-0.33805936574935913,0.22704048454761505,-0.4059958755970001,-0.12028666585683823,0.3145425617694855,-0.17844583094120026,0.1489691585302353,-0.028060389682650566,-0.1247197687625885,-0.37291219830513,0.10994336754083633,-0.2391684353351593,-0.3344830274581909},{-0.15658174455165863,-0.1690513789653778,0.01765429601073265,-0.25230464339256287,-0.32022711634635925,-0.0072708637453615665,0.14095856249332428,-0.3861086368560791,0.06764286011457443,-0.08570205420255661,0.28090766072273254,-0.051519181579351425,0.27441132068634033,0.15787959098815918,0.23465284705162048,0.25691667199134827},{-0.10356615483760834,-0.0302981398999691,-0.3929387032985687,0.31334900856018066,0.102834053337574,0.16430239379405975,0.2087048590183258,0.1797608882188797,-0.4307636618614197,0.20122675597667694,-0.3413650095462799,-0.22013835608959198,-0.34801599383354187,0.352877676486969,-0.3421473205089569,0.09167148172855377},{-0.22917918860912323,-0.48419880867004395,-0.11990493535995483,0.155884250998497,-0.22376446425914764,-0.031589776277542114,-0.11089059710502625,0.38754981756210327,0.4674079120159149,0.14421942830085754,-0.02004820667207241,-0.1732945740222931,0.15093424916267395,-0.41294804215431213,0.08756150305271149,-0.17446137964725494},{-0.25029098987579346,-0.4570763111114502,-0.15084224939346313,-0.13790665566921234,-0.48030292987823486,0.49353283643722534,-0.15269553661346436,0.19530868530273438,-0.13040505349636078,-0.24447931349277496,-0.3173734247684479,0.4171401560306549,-0.15458637475967407,-0.04629264399409294,-0.23440685868263245,0.3366827368736267},{-0.33708420395851135,0.35828956961631775,-0.2282242327928543,0.12343383580446243,-0.3807222843170166,0.16973797976970673,-0.03578435629606247,-0.30886995792388916,0.11087626218795776,0.21548280119895935,-0.2674613893032074,0.06780465692281723,0.22595827281475067,-0.3244040310382843,-0.34099024534225464,-0.1545715034008026},{-0.13541965186595917,-0.2812773287296295,-0.4394364058971405,0.2107686996459961,0.14281277358531952,0.04661097750067711,-0.24000614881515503,0.16679427027702332,-0.33385834097862244,-0.2596674859523773,-0.31838372349739075,0.21864980459213257,-0.18025833368301392,0.1342991292476654,0.04740900918841362,0.3048355281352997}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.0980319082736969,-0.05956592410802841,0.1761973351240158,-0.1458316445350647,-0.08922918885946274,0.10786153376102448,0.20919115841388702,-0.21107900142669678,-0.2009105384349823,0.2915855646133423,0.1208958551287651,0.11874591559171677,0.10354194790124893,0.17182853817939758,-0.14934973418712616,0.15893959999084473,0.11847440898418427,-0.3331550657749176,-0.178334578871727,-0.04925011843442917,-0.14997051656246185,0.10780980437994003,-0.19581134617328644,0.27806511521339417,-0.10460498929023743,-0.05595197528600693,0.1079300045967102,0.20234106481075287,-0.23992274701595306,-0.13976870477199554,0.19001033902168274,0.2681567966938019},{0.22815467417240143,-0.05311546102166176,0.14817531406879425,-0.1031104177236557,-0.1307896077632904,0.25548607110977173,-0.00918319821357727,-0.06471233069896698,-0.05039845407009125,0.0045177023857831955,-0.13721154630184174,0.013125712051987648,0.3905920684337616,0.16644132137298584,0.13292397558689117,0.08250895887613297,-0.24866235256195068,-0.36260074377059937,0.09051626175642014,0.04852748289704323,0.062397800385951996,0.29591143131256104,0.2236102819442749,-0.23736077547073364,0.04694639518857002,0.27115243673324585,-0.2928212583065033,0.18923136591911316,0.11761168390512466,-0.2331215739250183,-0.03565807268023491,0.0056804753839969635},{-0.10346584022045135,-0.05769483000040054,0.259731262922287,-0.23556376993656158,-0.1892799735069275,0.03497136011719704,-0.13717326521873474,0.24581846594810486,0.13220788538455963,-0.0055800024420022964,-0.1633765548467636,-0.0026081197429448366,0.2439211755990982,-0.22055284678936005,0.08477720618247986,-0.03795715793967247,-0.31585681438446045,0.2637380063533783,-0.2636342942714691,-0.04036936163902283,0.015410322695970535,-0.14177829027175903,-0.06804436445236206,-0.11568690091371536,-0.015312451869249344,0.31249505281448364,-0.05245835706591606,0.09273847192525864,0.26099124550819397,-0.265595018863678,-0.19045066833496094,-0.02218076027929783},{0.14668384194374084,-0.14385661482810974,0.07032469660043716,-0.353103369474411,0.1327633410692215,-0.13335157930850983,-0.062429945915937424,0.27176737785339355,0.01249762438237667,0.15700428187847137,0.1387103646993637,-0.10992535203695297,-0.20344261825084686,-0.0919685810804367,0.29742223024368286,-0.2383287101984024,0.040611278265714645,-0.12275560945272446,-0.12521736323833466,0.09151213616132736,-0.10804740339517593,0.05485134571790695,-0.20436330139636993,0.24402935802936554,-0.27526047825813293,0.08591721951961517,-0.0812387466430664,-0.19414661824703217,0.054050520062446594,0.01953267864882946,0.2377043068408966,-0.11753237992525101},{0.23081035912036896,0.02154776081442833,0.0432799756526947,0.26480409502983093,-0.24345175921916962,-0.07115683704614639,0.19719305634498596,-0.04568299278616905,0.10323063284158707,-0.19208727777004242,-0.0014384323731064796,-0.07827309519052505,-0.13437320291996002,-0.16441462934017181,0.2876704931259155,0.3208765685558319,-0.08684907108545303,-0.34929871559143066,0.17735153436660767,-0.12044207751750946,-0.12774410843849182,0.21066167950630188,0.28662362694740295,0.04221320152282715,-0.06723948568105698,-0.10206104815006256,-0.02921174466609955,0.27040642499923706,0.26777008175849915,0.13083112239837646,0.08613600581884384,-0.2609935402870178},{0.3171580135822296,-0.15283754467964172,0.036088112741708755,0.0900958776473999,-0.14750057458877563,-0.3151635527610779,-0.205388143658638,-0.30186665058135986,-0.22773759067058563,0.008711221627891064,-0.029556749388575554,-0.019425339996814728,-0.1593601107597351,-0.04595845565199852,-0.21615880727767944,-0.22592444717884064,0.17577354609966278,1.4436608580581378e-05,-0.29646649956703186,0.17089258134365082,-0.04785927012562752,-0.2273503690958023,0.18119628727436066,-0.16915930807590485,-0.14035312831401825,-0.23734112083911896,-0.09995917230844498,0.13887667655944824,0.10927333682775497,0.26566359400749207,-0.25497445464134216,0.17350701987743378},{0.1746179759502411,0.07760389894247055,0.26571401953697205,-0.1795019507408142,0.2267843782901764,-0.19763246178627014,-0.254136860370636,0.03909001871943474,0.2723800539970398,0.1399131566286087,-0.1148034930229187,0.09124233573675156,0.07285276055335999,0.3597458004951477,0.12987615168094635,-0.11555399000644684,-0.19849134981632233,0.14805801212787628,0.012342154048383236,0.03542569652199745,-0.07707051932811737,0.22850576043128967,0.16775387525558472,0.17537374794483185,-0.2302420288324356,-0.26457148790359497,-0.26401636004447937,-0.3759201169013977,0.004972938913851976,-0.09425674378871918,0.22611786425113678,0.14868700504302979},{0.30543485283851624,-0.3199490010738373,0.12653040885925293,-0.3803178668022156,-0.31270846724510193,0.28926506638526917,0.3771930932998657,0.14792382717132568,-0.10666855424642563,0.02847881056368351,0.21116428077220917,-0.13861383497714996,0.13416580855846405,0.32073408365249634,-0.020157363265752792,0.19997109472751617,0.3777400553226471,-0.19429051876068115,-0.04376640170812607,-0.30911314487457275,0.14876823127269745,0.21921531856060028,0.2517176568508148,0.12471692264080048,0.10050938278436661,0.11470604687929153,0.11753912270069122,0.2700018286705017,-0.20427171885967255,-0.2349054217338562,0.2582106292247772,-0.02235559932887554},{-0.009771622717380524,-0.06454148143529892,0.2506088316440582,0.23259800672531128,-0.18500308692455292,-0.32955288887023926,-0.06349100917577744,0.25285351276397705,-0.19305022060871124,-0.2922481298446655,0.09802224487066269,0.11401630938053131,0.11321856826543808,-0.27639201283454895,0.1169540137052536,-0.18577294051647186,-0.16173399984836578,0.17168660461902618,-0.23088625073432922,0.32498645782470703,-0.2764434516429901,-0.3546365797519684,-0.291848748922348,0.27582114934921265,0.12150130420923233,0.12375181913375854,0.2532631754875183,0.17565812170505524,-0.15608803927898407,-0.2864208221435547,-0.16771432757377625,0.1499086618423462},{0.3062790334224701,-0.012306512333452702,-0.03777823597192764,0.1551898717880249,0.0395694263279438,0.2491627037525177,0.005053502507507801,0.30954813957214355,-0.03240996599197388,0.07878441363573074,0.1816817969083786,0.048210762441158295,-0.2183576077222824,-0.3953581750392914,0.10346569865942001,0.14590628445148468,0.1168842613697052,-0.14196594059467316,-0.05409959331154823,-0.09860498458147049,0.15877702832221985,-0.3406371772289276,0.2669435739517212,0.03777938708662987,-0.04436521977186203,0.12984684109687805,-0.2840549349784851,-0.20155054330825806,0.012750576250255108,0.010292143560945988,0.14343366026878357,0.2539236545562744},{-0.12898169457912445,0.09216827154159546,-0.1250786930322647,0.16121771931648254,-0.12906049191951752,0.26111114025115967,0.1234610378742218,-0.016734827309846878,0.3020036518573761,-0.3023647367954254,-0.13612622022628784,0.16044658422470093,-0.18724195659160614,0.047145672142505646,-0.3163946270942688,-0.04563954845070839,0.11245684325695038,0.16129760444164276,0.05793376639485359,-0.15812921524047852,-0.20991550385951996,0.18641652166843414,0.17493829131126404,0.17785751819610596,-0.26491159200668335,0.3675723671913147,-0.07739631831645966,-0.02720032073557377,-0.12761661410331726,0.12429314106702805,0.21876485645771027,0.2916310727596283},{-0.210300475358963,0.3131738007068634,-0.05839570611715317,0.007675477769225836,-0.20142486691474915,-0.18640859425067902,0.12546341121196747,-0.3335827589035034,-0.04745464026927948,-0.28249168395996094,-0.2067524939775467,-0.02937030792236328,0.20448453724384308,-0.24652205407619476,-0.12544099986553192,-0.2806912064552307,-0.19647535681724548,-0.054013948887586594,0.3090512454509735,-0.2681092917919159,0.08275622874498367,-0.19082261621952057,0.060169924050569534,0.2987891733646393,-0.1468943953514099,0.1824367344379425,0.21921269595623016,-0.08824718743562698,-0.014742235653102398,0.2983924448490143,-0.15175852179527283,-0.29452869296073914},{-0.04607473686337471,0.1942172646522522,0.21014243364334106,-0.2682640254497528,0.2611500322818756,-0.002482903189957142,-0.1327788084745407,-0.026198474690318108,0.15427282452583313,-0.28967440128326416,-0.06900561600923538,0.028569210320711136,0.1555076688528061,0.03356108441948891,0.04541698470711708,-0.09100694209337234,0.22234126925468445,-0.25607866048812866,0.3298454284667969,0.07604308426380157,-0.16870518028736115,0.22278641164302826,-0.14083640277385712,-0.2084028273820877,0.25185447931289673,-0.11131155490875244,0.03448208048939705,-0.1500168740749359,0.050986696034669876,-0.1435050666332245,0.26657360792160034,0.23635779321193695},{0.05255028232932091,-0.19041097164154053,-0.1867530345916748,0.06218245252966881,-0.020603125914931297,0.2800478935241699,-0.11666718125343323,-0.30937570333480835,0.32128801941871643,0.029905449599027634,0.050857290625572205,0.07374271005392075,-0.11482483893632889,0.16013331711292267,-0.22354120016098022,-0.32000061869621277,0.010412446223199368,-0.007392608094960451,0.16794537007808685,0.4285462498664856,-0.2370958775281906,0.14001260697841644,-0.14934411644935608,0.052547045052051544,0.15475240349769592,-0.3237358033657074,-0.14731013774871826,-0.2806093692779541,-0.1402493715286255,-0.19264495372772217,0.1551971733570099,-0.36551374197006226},{-0.12057008594274521,0.33690938353538513,0.10383500903844833,-0.1890367865562439,-0.13013894855976105,-0.24364496767520905,0.1491256058216095,-0.0776713490486145,0.2506484389305115,-0.05779111385345459,0.22209304571151733,0.20117883384227753,-0.03038710542023182,0.060261424630880356,-0.1354658007621765,0.1539941430091858,-0.18945439159870148,-0.37674644589424133,-0.2656850218772888,0.10835901647806168,0.15342815220355988,-0.23189406096935272,-0.349452406167984,-0.26325833797454834,-0.15095068514347076,0.11411194503307343,0.3641783595085144,-0.0006782085984013975,-0.08616206049919128,0.06916992366313934,-0.12551963329315186,0.09541122615337372},{-0.23040038347244263,-0.16651923954486847,-0.1967589110136032,0.03132840245962143,-0.23500633239746094,-0.12647132575511932,-0.055679772049188614,-0.04910111427307129,-0.30826056003570557,-0.26246941089630127,0.21088312566280365,0.15606434643268585,-0.3064042031764984,0.24360871315002441,-0.06311795115470886,0.15579383075237274,0.09489745646715164,0.023516904562711716,0.04639953374862671,0.12956072390079498,0.2394634634256363,0.23116496205329895,0.13347136974334717,0.251956969499588,0.10046784579753876,-0.21330173313617706,-0.1723402738571167,0.24448752403259277,-0.02626272663474083,-0.18845783174037933,-0.1773921549320221,-0.1486421376466751},{-0.2794509828090668,-0.2124962955713272,-0.3499704599380493,0.06314219534397125,-0.1019883081316948,-0.055664047598838806,-0.09674953669309616,0.13091538846492767,-0.08619286864995956,0.07672584801912308,-0.21247558295726776,0.010243607684969902,0.1493341475725174,-0.1109594851732254,0.04417334869503975,0.20455700159072876,-0.10543318837881088,-0.12880846858024597,0.17061077058315277,0.03333587571978569,0.20636317133903503,-0.03093806467950344,-0.21416674554347992,0.05825820937752724,0.20004010200500488,-0.253904789686203,0.16038987040519714,0.060287464410066605,0.09084156155586243,-0.14716848731040955,0.23238612711429596,-0.054755035787820816},{0.25369754433631897,0.00123825971968472,0.021333366632461548,0.18298795819282532,-0.3483348488807678,-0.04046224057674408,0.06894730031490326,0.15484529733657837,-0.06896136701107025,-0.14493484795093536,0.3000389039516449,-0.0903552770614624,0.0649530366063118,-0.03583844006061554,-0.12400157004594803,0.2753790616989136,-0.05891133472323418,-0.13623765110969543,0.09684110432863235,-0.30331113934516907,-0.04020966589450836,-0.2590183615684509,-0.19727438688278198,0.22352378070354462,-0.05328505113720894,-0.03872190788388252,0.14401111006736755,0.055197540670633316,-0.1626899391412735,-0.08605298399925232,-0.021696031093597412,-0.07047958672046661},{0.30038222670555115,-0.07276377826929092,0.06477826088666916,0.060442034155130386,-0.02963164635002613,-0.0857599675655365,0.19437158107757568,-0.2370070070028305,0.25804492831230164,0.2899934649467468,0.03557324782013893,0.13756829500198364,0.2343330830335617,0.32667383551597595,-0.2893923223018646,-0.35312411189079285,-0.23726437985897064,0.08151381462812424,-0.16303299367427826,-0.31659096479415894,-0.16559532284736633,0.2503097951412201,0.06252878904342651,0.15678828954696655,-0.14794835448265076,-0.1259821355342865,-0.13687893748283386,-0.24298930168151855,0.25548607110977173,0.18916770815849304,-0.3301272988319397,-0.14270266890525818},{-0.10398970544338226,0.14739780128002167,0.2708054184913635,-0.034061748534440994,-0.028478257358074188,0.08043438196182251,-0.017187150195240974,-0.3284376263618469,0.19075147807598114,0.2532970607280731,0.16385459899902344,0.2230490744113922,-0.2299911081790924,0.18619301915168762,-0.2573816776275635,0.3017808794975281,0.16875293850898743,-0.2593495845794678,0.24454396963119507,0.06744539737701416,-0.34970739483833313,0.31559085845947266,-0.2459569275379181,0.1604219526052475,0.21019287407398224,0.2609609067440033,0.056366704404354095,0.13336247205734253,-0.16433598101139069,0.23823709785938263,-0.04632776975631714,0.1024329885840416},{-0.13011132180690765,-0.11509568989276886,0.011193952523171902,0.18605183064937592,0.02500305324792862,0.22584529221057892,-0.26544877886772156,-0.11495283991098404,-0.15272127091884613,-0.0839538723230362,-0.13403284549713135,-0.18924321234226227,0.015565994195640087,-0.19514402747154236,0.09776446968317032,-0.2029580920934677,0.24555280804634094,-0.020724652335047722,-0.2990081012248993,-0.2911757230758667,0.1275731325149536,0.16239935159683228,-0.15870094299316406,0.3304581940174103,-0.2587197721004486,0.03858790546655655,0.09572355449199677,-0.10585348308086395,0.1639038324356079,-0.20681774616241455,0.29024738073349,0.11936108022928238},{0.31467390060424805,0.06187048554420471,0.0657615065574646,0.2277963012456894,-0.22442208230495453,0.16664792597293854,-0.08771225810050964,0.16700318455696106,0.11089145392179489,0.029682863503694534,0.08951770514249802,-0.3136182725429535,-0.2601723074913025,0.019804643467068672,0.08282377570867538,-0.07438979297876358,0.26534849405288696,0.14001767337322235,-0.184414342045784,-0.22565539181232452,0.3356754183769226,0.18763867020606995,0.23943640291690826,0.07949245721101761,-0.01864347606897354,0.062064941972494125,-0.058818280696868896,-0.15603280067443848,0.2793237566947937,0.026812369003891945,-0.17868547141551971,0.12098680436611176},{-0.01567963697016239,0.020773084834218025,-0.034555818885564804,-0.26735422015190125,-0.08840984106063843,-0.21800106763839722,-0.21564719080924988,-0.13776831328868866,-0.034821175038814545,-0.019506065174937248,-0.25773856043815613,0.018414538353681564,-0.2390318512916565,-0.16510066390037537,0.01120708230882883,0.10397573560476303,0.26645174622535706,-0.177001491189003,-0.32502999901771545,0.2520378828048706,-0.17817114293575287,0.2621922791004181,0.03840251266956329,-0.031402457505464554,0.01330009289085865,0.1625095158815384,-0.07997459173202515,-0.25828033685684204,0.22778008878231049,0.26027151942253113,-0.12110109627246857,0.18333904445171356},{-0.23047314584255219,-0.026990588754415512,0.0402221605181694,-0.0330190546810627,0.10524020344018936,0.13763798773288727,-0.1952757090330124,0.11498919874429703,-0.15875624120235443,-0.135508731007576,0.061460934579372406,-0.13492149114608765,-0.1955012083053589,0.24589130282402039,0.016501542180776596,0.04226228594779968,0.18896475434303284,-0.26178136467933655,-0.17045792937278748,0.29725033044815063,0.023182470351457596,0.2663293182849884,-0.059626951813697815,0.015650004148483276,-0.2618881165981293,-0.18329526484012604,0.007148949895054102,0.30192282795906067,-0.008366754278540611,0.0015202290378510952,0.3017682731151581,0.31619173288345337}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.11533226817846298,0.15569765865802765,0.3418257534503937,-0.009547705762088299},{0.09907842427492142,-0.07313649356365204,0.05521181970834732,0.18438264727592468},{-0.15573669970035553,0.2007547914981842,0.11337041109800339,0.1458687037229538},{0.33247074484825134,0.01697404496371746,0.06648626178503036,0.4096371531486511},{-0.1158752292394638,0.09444404393434525,0.2891583740711212,-0.028028329834342003},{-0.12485755980014801,0.21470223367214203,0.22266601026058197,-0.09395048022270203},{-0.25386324524879456,-0.004043262917548418,0.0008654908742755651,-0.11779257655143738},{-0.3705252707004547,-0.1443467140197754,0.3588137924671173,-0.291064977645874},{0.32245123386383057,-0.17187030613422394,-0.28508421778678894,-0.3742542862892151},{0.049949321895837784,0.29141587018966675,0.3354034721851349,-0.42181360721588135},{-0.1504703015089035,-0.16911746561527252,-0.2013985514640808,0.1944597363471985},{0.2982645332813263,-0.18107032775878906,0.001866437029093504,0.19620421528816223},{0.29984989762306213,0.2943556606769562,-0.07280883193016052,0.10092512518167496},{0.01667637564241886,0.08439340442419052,-0.2935101389884949,0.020735984668135643},{0.10854806751012802,0.2902143895626068,0.36117202043533325,0.3272947371006012},{0.15224914252758026,0.037209343165159225,0.289087176322937,0.24058453738689423},{-0.2253233641386032,-0.10199970006942749,-0.1264062374830246,-0.22202171385288239},{-0.18969464302062988,0.11338582634925842,-0.15935903787612915,-0.1260410100221634},{-0.1713511347770691,0.18230319023132324,0.15878631174564362,0.2895547151565552},{-0.03690464794635773,0.3383179306983948,-0.17836220562458038,0.0727560818195343},{-0.25385352969169617,-0.3747261166572571,-0.11882904917001724,0.011234789155423641},{0.30817756056785583,0.43292972445487976,0.044434309005737305,-0.25854218006134033},{-0.023574717342853546,0.1615109145641327,0.201029434800148,0.16294971108436584},{-0.09370759129524231,0.37654510140419006,-0.06531403213739395,-0.14354369044303894},{0.03118642419576645,-0.03621382266283035,-0.07510680705308914,-0.007085741963237524},{0.26995640993118286,-0.40678688883781433,-0.030694885179400444,0.03652234375476837},{0.010335182771086693,-0.3205638825893402,-0.19662803411483765,-0.23382651805877686},{0.1127193421125412,-0.11587078869342804,0.2317732572555542,0.13483448326587677},{0.000365438056178391,-0.05825812742114067,0.09493692219257355,0.02733607217669487},{-0.3341899812221527,0.3488805890083313,0.23857490718364716,-0.09029094874858856},{0.31793320178985596,-0.13667237758636475,0.18252207338809967,-0.042195506393909454},{0.04663633182644844,-0.34952953457832336,0.38585591316223145,-0.279318630695343}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.04638437181711197,-0.029734954237937927,0.023028675466775894,-0.02955702133476734,-0.045743588358163834,-0.15947496891021729,0.008002787828445435,0.05154953896999359,0.009048952721059322,-0.08275575935840607,0.12143062800168991,0.07027247548103333,-0.01810610108077526,-0.05210299789905548,0.0730985775589943,-0.03223798796534538};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0700475201010704,0.047122709453105927,0.04060724005103111,0.030178766697645187,0.04905571788549423,0.004095894284546375,0.05789243429899216,-0.010282779112458229,-0.0008941632113419473,0.00634891027584672,-0.04213815554976463,-0.03401480242609978,0.05958560109138489,-0.02607569843530655,-0.029998328536748886,-0.020542722195386887};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07362517714500427,0.06700380891561508,0.015641434118151665,0.06607325375080109,0.04310669004917145,-0.020810171961784363,-0.04494756460189819,-0.011724160984158516,-0.030184701085090637,0.0009277983335778117,-0.048887256532907486,0.05538810044527054,0.05420507863163948,-0.06452977657318115,0.07366982847452164,0.07469889521598816,-0.06684888899326324,-0.0642809197306633,0.00942985713481903,0.016246266663074493,-0.03534873574972153,0.0020156819373369217,0.06085943803191185,0.003212180221453309,-0.018467582762241364,0.013569045811891556,-0.03881985321640968,0.05789455026388168,0.03571075573563576,-0.0004016851889900863,0.03455832973122597,0.03614550083875656};
static const float action_parameterization_distribution_linear_bias[4] = {0.04645907133817673,0.004948860965669155,0.053997576236724854,0.047397587448358536};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.022380108013749123,0.2536318004131317,-0.08243678510189056,0.16587737202644348,0.24308712780475616,0.14655284583568573,0.27271026372909546,0.049277164041996},{-0.19090071320533752,-0.06813709437847137,-0.2136555165052414,-0.2762035131454468,-0.2821851670742035,-0.15421994030475616,-0.159759983420372,-0.14277583360671997},{-0.2661705017089844,0.02550586126744747,0.2608943283557892,0.1923968642950058,0.24852877855300903,0.008413810282945633,0.19665169715881348,-0.07149584591388702},{-0.005823561456054449,0.09583445638418198,-0.162131205201149,-0.009037917479872704,0.0024575600400567055,-0.062160082161426544,0.20851348340511322,-0.1369875818490982},{-0.28338101506233215,-0.12206517159938812,-0.21112169325351715,-0.13721705973148346,-0.04317430779337883,0.17396411299705505,0.12671113014221191,0.019438648596405983},{-0.34022992849349976,0.03227352723479271,0.35883021354675293,0.25616854429244995,0.17984654009342194,-0.08246151357889175,-0.11085435003042221,-0.09026667475700378},{-0.23284576833248138,0.09497273713350296,0.34044456481933594,-0.1927158683538437,-0.11164992302656174,-0.37990525364875793,-0.06790311634540558,-0.12500295042991638},{-0.4297066330909729,-0.34324872493743896,0.5204468965530396,-0.03837180137634277,-0.2432568222284317,0.16204749047756195,0.17571398615837097,-0.17335101962089539},{-0.31914398074150085,0.21890003979206085,-0.17996449768543243,0.4201972782611847,0.10556787997484207,-0.3928523361682892,0.08798928558826447,0.12085631489753723},{-0.31316110491752625,-0.3598904013633728,-0.1609906256198883,-0.13907375931739807,-0.48405760526657104,0.03799961879849434,-0.029285844415426254,0.15766505897045135},{0.16581220924854279,0.32500943541526794,0.18994982540607452,0.007451318204402924,0.2209390550851822,0.05644240975379944,-0.2615721821784973,0.24485817551612854},{0.21203258633613586,0.00337718497030437,0.25650790333747864,0.26051679253578186,-0.18173661828041077,0.2746967077255249,-0.029582234099507332,-0.2014184445142746},{0.1053229570388794,-0.2626595199108124,0.24551254510879517,-0.02532831020653248,-0.15940196812152863,-0.050212498754262924,-0.14561761915683746,-0.15164689719676971},{-0.22463615238666534,-0.10839272290468216,0.3260267972946167,0.40432989597320557,-0.06304749101400375,-0.05384960398077965,-0.2338203638792038,0.12296264618635178},{-0.0346057154238224,-0.15187591314315796,0.07477826625108719,-0.1638851910829544,-0.33070018887519836,-0.13170680403709412,0.22197428345680237,-0.024879775941371918},{0.04550657793879509,-0.036577776074409485,-0.04747988283634186,-0.30839458107948303,-0.09052237123250961,0.0774751603603363,-0.025643132627010345,0.37633681297302246},{-0.011389525607228279,-0.19488096237182617,-0.20732393860816956,0.04067651554942131,-0.15640170872211456,-0.11877166479825974,-0.11545522511005402,0.057619620114564896},{-0.2066677361726761,-0.2510067820549011,0.06878535449504852,0.00314771244302392,0.13004054129123688,-0.20815549790859222,0.3627232015132904,0.15334005653858185},{0.009379519149661064,0.15832939743995667,-0.21576295793056488,0.12018676102161407,0.096187062561512,0.1167803406715393,-0.18589776754379272,0.2912871837615967},{0.14460444450378418,-0.05655708909034729,-0.37422457337379456,0.07759158313274384,-0.08321596682071686,-0.11831995099782944,-0.271172434091568,0.0010348998475819826},{0.010842215269804,-0.16580776870250702,0.031800758093595505,-0.12189978361129761,0.25328895449638367,-0.08436869829893112,-0.042704470455646515,0.42826926708221436},{-0.02580064907670021,0.0824216678738594,-0.3223608136177063,0.1826169788837433,0.2578871548175812,0.27578872442245483,0.10878090560436249,-0.27661195397377014},{-0.4008499085903168,-0.1351931393146515,0.09440039843320847,-0.12834103405475616,0.13851912319660187,-0.34465473890304565,0.13437139987945557,-0.25108662247657776},{-0.10385457426309586,0.11200827360153198,-0.08773531019687653,-0.49607551097869873,0.23181381821632385,0.04123923182487488,-0.35923826694488525,0.14408724009990692},{-0.15856802463531494,-0.16654515266418457,-0.11204396188259125,0.0789756253361702,0.09029560536146164,0.3049415946006775,0.29289817810058594,-0.06657905131578445},{-0.17851059138774872,0.08195814490318298,-0.33271077275276184,-0.25317397713661194,0.11399175971746445,0.02467481978237629,-0.05416962131857872,0.05393404886126518},{0.3009001910686493,0.37496253848075867,-0.22751173377037048,0.24187946319580078,0.05944610387086868,0.2936630845069885,-0.2887863516807556,-0.1777808964252472},{0.38934460282325745,0.2646179497241974,0.11207833886146545,0.09296262264251709,0.20604777336120605,0.0696912631392479,0.22827501595020294,0.3640859127044678},{-0.11314143240451813,0.380197674036026,0.1517123281955719,0.04460494965314865,0.2659437954425812,0.014508097432553768,-0.4009186625480652,-0.2857191264629364},{-0.15791018307209015,-0.2396235466003418,0.01894865371286869,-0.16763965785503387,-0.24239857494831085,-0.1993931084871292,0.22654646635055542,-0.008029821328818798},{0.4143736958503723,-0.2884814739227295,0.2674873471260071,-0.24909460544586182,0.12815402448177338,0.2408883273601532,0.08814450353384018,-0.15500959753990173},{0.20602113008499146,0.36619630455970764,0.44444602727890015,-0.22383250296115875,-0.1808430701494217,0.08118598163127899,0.21165531873703003,0.06564771384000778}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.004051652271300554,0.3985536992549896,-0.17940466105937958,0.2544746696949005,-0.3726423382759094,0.22655606269836426,0.43994614481925964,0.04814658313989639},{-0.4201478064060211,-0.45935729146003723,-0.345447838306427,-0.398907333612442,-0.4142439365386963,0.4000850319862366,0.47472065687179565,-0.4110589921474457},{0.0064312610775232315,-0.14093828201293945,0.1004917323589325,0.013265007175505161,-0.08007468283176422,0.4163834750652313,-0.31349286437034607,-0.32094642519950867},{0.43242180347442627,-0.009446950629353523,0.07066044211387634,-0.0013022160856053233,0.5464629530906677,0.36386924982070923,0.4149218201637268,0.44500187039375305},{0.07696829736232758,0.21679003536701202,-0.12729638814926147,-0.057420264929533005,0.12841719388961792,-0.32053086161613464,-0.3681216239929199,0.45566582679748535},{0.4079909324645996,0.10367715358734131,0.018678588792681694,-0.34864547848701477,-0.39237087965011597,-0.46624261140823364,-0.10262925177812576,0.47718545794487},{-0.35639044642448425,-0.2857321500778198,-0.012270360253751278,-0.20589272677898407,0.06732442229986191,0.34355682134628296,-0.5078040361404419,0.5721642971038818},{0.16711466014385223,0.06427574902772903,0.020344629883766174,-0.0540461428463459,0.32678115367889404,-0.5153658986091614,0.3752693831920624,-0.488741934299469}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.04425935819745064,0.028852442279458046,0.09232332557439804,-0.034731827676296234,-0.03515611216425896,-0.038666389882564545,0.07797417789697647,-0.03271450474858284};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03618519380688667,-0.023515649139881134,0.03668710216879845,-0.11151617020368576,-0.004370182286947966,0.006581688765436411,-0.0017914760392159224,-0.06470344215631485};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

