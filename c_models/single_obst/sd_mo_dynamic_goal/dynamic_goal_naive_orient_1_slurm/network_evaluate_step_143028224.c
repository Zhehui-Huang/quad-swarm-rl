#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3119436204433441,0.06996260583400726,0.008618486113846302,0.24245016276836395,0.37522047758102417,-0.27746617794036865,-0.303882896900177,0.1540769785642624,0.3511274755001068,-0.28164252638816833,0.4354969263076782,0.034609533846378326,0.29236987233161926,0.12119293957948685,-0.2738531231880188,0.047108422964811325},{-0.33206865191459656,-0.19338902831077576,-0.29604437947273254,-0.1371825486421585,0.1954411119222641,0.35253429412841797,0.13370785117149353,0.027068356052041054,0.15289470553398132,0.20704735815525055,-0.1448308676481247,0.023041078820824623,-0.07529036700725555,0.15538284182548523,0.2886578142642975,-0.22250701487064362},{0.07358594238758087,0.29408663511276245,0.13400086760520935,0.24775980412960052,-0.04430961608886719,-0.2421046942472458,0.5996726155281067,-0.17536400258541107,-0.06952986121177673,-0.09141741693019867,-0.049979317933321,-0.14250394701957703,0.11104448139667511,0.5076737403869629,-0.4099292755126953,0.024329977110028267},{0.14648795127868652,-0.16182909905910492,-0.12151332944631577,-0.05158123001456261,-0.2030176818370819,0.038250941783189774,-0.01989118754863739,-0.26397478580474854,-0.049582093954086304,-0.1019209697842598,0.5656339526176453,-0.2755134105682373,-0.313482403755188,-0.14817456901073456,0.2182028442621231,-0.026108790189027786},{-0.23194284737110138,-0.0325506255030632,0.2334403395652771,-0.44758325815200806,0.46596667170524597,0.17543832957744598,0.23009739816188812,-0.18722593784332275,-0.1646348536014557,0.24614445865154266,-0.05619954690337181,-0.4133942425251007,0.00460216635838151,-0.2522444725036621,0.43662697076797485,-0.03555886074900627},{-0.03762774169445038,-0.08915789425373077,-0.09192156791687012,-0.15358635783195496,0.12400682270526886,-0.2839093804359436,0.524127185344696,-0.291385293006897,-0.1638338714838028,-0.21471185982227325,0.24033570289611816,0.07663210481405258,0.33852246403694153,0.022644158452749252,0.3522917330265045,0.2755577266216278},{-0.259839802980423,0.34521758556365967,0.0005143555463291705,0.03290726989507675,-0.27749404311180115,-0.09487324208021164,-0.17084719240665436,0.0027216512244194746,0.2914773225784302,0.3781161606311798,-0.27911779284477234,-0.07785987854003906,0.289095938205719,0.00625603087246418,-0.11106355488300323,0.3176451325416565},{-0.1968967318534851,0.08951622247695923,0.011091725900769234,-0.22662700712680817,0.3309350609779358,-0.2525966763496399,-0.24631743133068085,-0.43650615215301514,-0.08597365766763687,-0.2832351326942444,0.5318062901496887,0.10086341947317123,0.06771821528673172,0.3042562007904053,0.009267013520002365,0.5420888662338257},{0.21931563317775726,0.18874701857566833,-0.06256084144115448,-0.01353126484900713,-0.506618320941925,-0.5199552774429321,0.12897120416164398,-0.5732539892196655,-0.042727939784526825,-0.07258843630552292,0.311629980802536,-0.5326272249221802,-0.4924260377883911,0.13573476672172546,0.14848023653030396,-0.2681438624858856},{0.4921334981918335,-0.7215902209281921,-0.2788339853286743,0.058622799813747406,0.23207959532737732,-0.3016180098056793,-0.19748127460479736,-0.2201254516839981,-0.31771352887153625,0.02452356182038784,-0.2817072570323944,-0.27006763219833374,0.5957619547843933,-0.18666689097881317,-0.6611946225166321,-0.16621099412441254},{0.25056737661361694,0.3584511876106262,-0.15081250667572021,0.11539177596569061,-0.020472563803195953,-0.21611137688159943,-0.23133499920368195,0.14609059691429138,-0.07801080495119095,0.24253928661346436,0.16345709562301636,0.32303959131240845,-0.12323223054409027,0.20162992179393768,0.02252301201224327,-0.25715887546539307},{-0.368438720703125,0.2087971717119217,0.4263869822025299,-0.6551888585090637,-0.11577463895082474,0.06715638190507889,0.006739734672009945,0.2485084980726242,0.3029758632183075,0.35532593727111816,0.37583503127098083,-0.1487925797700882,0.13192163407802582,-0.1823553889989853,0.08407967537641525,-0.2012351155281067},{0.1835068315267563,-0.3679034113883972,-0.26444584131240845,0.41743701696395874,-0.2119683176279068,-0.31629446148872375,0.014125112444162369,0.3740285038948059,0.0815676748752594,-0.09037262201309204,-0.442791223526001,0.2870626747608185,0.5435223579406738,0.35326525568962097,-0.26026809215545654,0.6643721461296082},{0.24635417759418488,0.23173892498016357,-0.38321682810783386,0.10917413979768753,-0.04483591020107269,-0.18814218044281006,-0.2234565019607544,0.1348908692598343,-0.3720967471599579,-0.3855845034122467,-0.10640712827444077,0.07147499173879623,-0.5658935308456421,-0.05286253243684769,-0.3811545968055725,-0.11292027682065964},{0.11437234282493591,0.6184011101722717,0.5100963115692139,-0.5356529951095581,-0.2611643671989441,0.3098449110984802,-0.07612867653369904,0.07285893708467484,0.5479072332382202,0.374051570892334,-0.11318661272525787,0.07779624313116074,-0.11743345111608505,-0.4051770269870758,0.20956844091415405,-0.3539109230041504},{-0.35018351674079895,-0.083722785115242,-0.04220312833786011,0.2683148682117462,-0.08722782880067825,0.04200663045048714,-0.20754118263721466,-0.060053396970033646,-0.36850547790527344,-0.12111934274435043,0.3161439895629883,0.1867845356464386,-0.26085129380226135,-0.2473982572555542,-0.41549089550971985,-0.13647668063640594},{-0.3609274923801422,0.1598895788192749,-0.28528422117233276,0.0077202944085001945,-0.12769410014152527,0.34343451261520386,0.37701162695884705,0.19214923679828644,0.26306360960006714,-0.22522668540477753,-0.06818444281816483,-0.11094047129154205,0.018179092556238174,0.06352940946817398,-0.03312177583575249,-0.14869143068790436},{0.15886647999286652,-0.44210290908813477,0.18479201197624207,0.20979495346546173,-0.011025692336261272,0.3122999668121338,0.34641191363334656,0.155257448554039,-0.17337870597839355,-0.26612070202827454,-0.14103379845619202,-0.08227106928825378,-0.14170566201210022,-0.39516541361808777,0.09494366496801376,0.04089874029159546}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14888930320739746,0.29897674918174744,0.34239840507507324,-0.10210331529378891,-0.2580447494983673,0.09139205515384674,0.009458538144826889,0.2904042899608612,-0.028249481692910194,0.2842634320259094,0.47261255979537964,-0.3580160140991211,-0.09148001670837402,0.04241444543004036,0.04983168840408325,-0.05067713186144829},{-0.5541889071464539,0.25893428921699524,-0.3032868504524231,0.2618231475353241,0.37805885076522827,-0.18693740665912628,-0.33409222960472107,-0.2933148443698883,0.3401350677013397,0.3007636070251465,-0.04948211833834648,0.25759708881378174,-0.38484451174736023,0.1662125289440155,-0.2854073941707611,0.4708649218082428},{-0.3707534968852997,0.22060242295265198,-0.35907408595085144,0.027277356013655663,-0.41826847195625305,-0.2977025806903839,-0.08656008541584015,0.003391785081475973,-0.23049205541610718,0.3649907112121582,0.2578364908695221,-0.0964418426156044,0.27645647525787354,-0.3300737738609314,-0.0792725458741188,-0.009884832426905632},{0.2988429367542267,-0.2491290271282196,0.09229303896427155,0.4534694254398346,-0.43829789757728577,-0.4357982575893402,0.2789548933506012,0.12209612876176834,0.2687651515007019,-0.10702011734247208,0.33581775426864624,0.09490678459405899,-0.2721690535545349,-0.018234895542263985,-0.013245990499854088,-0.3888224959373474},{-0.4059138596057892,0.04173315316438675,0.24018320441246033,-0.37746661901474,0.16485987603664398,0.37425100803375244,-0.3149392306804657,0.2166232466697693,-0.21152931451797485,0.20820352435112,-0.08807964622974396,-0.006433525588363409,-0.11532583087682724,-0.032768383622169495,-0.19258807599544525,-0.15518729388713837},{0.013946790248155594,-0.2508047819137573,-0.01254595723003149,-0.3463616669178009,0.29999059438705444,0.07248560339212418,-0.03652757778763771,-0.07227377593517303,-0.22412925958633423,0.3792743682861328,0.27938076853752136,-0.08913853019475937,-0.19092504680156708,0.21005596220493317,-0.0538104884326458,-0.35885900259017944},{0.24553212523460388,-0.12588505446910858,0.34935423731803894,-0.30281075835227966,-0.35250604152679443,-0.024438917636871338,-0.3756238520145416,0.35738301277160645,-0.09395227581262589,-0.2359672337770462,-0.261762410402298,-0.041811294853687286,-0.03669517859816551,-0.11074198782444,0.4749428629875183,-0.36041581630706787},{-0.27847790718078613,0.34641972184181213,-0.1004205048084259,0.31777486205101013,0.007689450401812792,-0.26774272322654724,-0.11862935870885849,0.16241909563541412,-0.09821990132331848,0.4788705110549927,0.13538731634616852,-0.20723971724510193,-0.04724929854273796,-0.0883893221616745,0.029004184529185295,0.1330939084291458},{0.07845903187990189,0.27958157658576965,-0.18199492990970612,-0.36686745285987854,0.37696170806884766,-0.20654891431331635,0.15381722152233124,-0.34724265336990356,0.13627798855304718,0.03610428050160408,0.10274316370487213,0.15718713402748108,-0.026354607194662094,-0.33979469537734985,-0.059134259819984436,0.23345346748828888},{-0.2459246963262558,0.005805761553347111,-0.31477871537208557,-0.32755863666534424,0.24062232673168182,-0.4297369718551636,-0.1745847910642624,0.27687641978263855,-0.13060255348682404,0.23876073956489563,-0.038882624357938766,-0.10796988755464554,-0.3404291272163391,0.0003269303124397993,-0.2614699602127075,-0.33917534351348877},{-0.2507845461368561,-0.0934065654873848,-0.07584317028522491,-0.34829801321029663,-0.32999029755592346,-0.03619237244129181,0.1619519293308258,-0.5291318297386169,0.01111182663589716,-0.052509088069200516,0.20455187559127808,-0.003863660618662834,0.4430447518825531,0.06190012767910957,0.2117740660905838,0.23862716555595398},{-0.17472128570079803,-0.06002777814865112,-0.42549747228622437,0.33767062425613403,0.11667400598526001,-0.08353038877248764,0.17879462242126465,0.10744553804397583,-0.42587095499038696,0.20676662027835846,-0.2983153164386749,-0.16468915343284607,-0.3959799110889435,0.4331691265106201,-0.35099005699157715,0.08089897781610489},{-0.20044048130512238,-0.4479513168334961,-0.14872953295707703,0.16430120170116425,-0.17670559883117676,-0.11023564636707306,-0.13641628623008728,0.423152357339859,0.4316537082195282,0.09143979847431183,-0.09656243771314621,-0.24870967864990234,0.1789911836385727,-0.40167054533958435,0.13427986204624176,-0.22985440492630005},{-0.2932577133178711,-0.43999364972114563,-0.19526484608650208,-0.09232452511787415,-0.4480550289154053,0.437959760427475,-0.06853976845741272,0.20256352424621582,-0.1746208220720291,-0.3379471004009247,-0.3167232573032379,0.4247828722000122,-0.24896852672100067,0.0706087201833725,-0.29974785447120667,0.40350255370140076},{-0.37538981437683105,0.3477235436439514,-0.17931979894638062,0.1104298084974289,-0.3958248794078827,0.3183608055114746,0.0008282632334157825,-0.36588627099990845,0.1291264146566391,0.19946828484535217,-0.22399955987930298,0.09283296763896942,0.28624603152275085,-0.286141574382782,-0.3360324800014496,-0.14700764417648315},{-0.13560809195041656,-0.4005790650844574,-0.5384194254875183,0.31293579936027527,-0.023735536262392998,0.15234270691871643,-0.3221203088760376,0.23598612844944,-0.4274660646915436,-0.33387207984924316,-0.416949063539505,0.25044190883636475,-0.20901191234588623,0.17009782791137695,0.12104922533035278,0.2723250687122345}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07875298708677292,-0.1282045692205429,0.08632422238588333,-0.15878388285636902,-0.10671515762805939,0.09213642030954361,0.18939372897148132,-0.21295787394046783,-0.07507003098726273,0.3142031133174896,0.08305414766073227,0.13624683022499084,0.07492100447416306,0.14941708743572235,-0.2194254845380783,0.13319699466228485,0.13394780457019806,-0.30904677510261536,-0.2923165261745453,-0.12174851447343826,-0.159951314330101,0.12597930431365967,-0.2549079954624176,0.35624390840530396,-0.15893927216529846,-0.0068047228269279,0.1523834615945816,0.17511369287967682,-0.2661411166191101,-0.2265399694442749,0.244778573513031,0.3137589395046234},{0.1683608591556549,-0.023222368210554123,0.17039628326892853,-0.04973898455500603,-0.12570980191230774,0.20758752524852753,-0.01622948981821537,-0.09798061847686768,-0.058251477777957916,-0.07422081381082535,-0.09755758941173553,0.044220734387636185,0.394662469625473,0.22173981368541718,0.13715025782585144,0.06841611862182617,-0.26633596420288086,-0.3152238130569458,0.10619816184043884,0.05419851839542389,0.07169747352600098,0.26648828387260437,0.2608989477157593,-0.1849203109741211,0.05401225388050079,0.31111449003219604,-0.33618950843811035,0.21449550986289978,0.13795994222164154,-0.24586181342601776,-0.0709443986415863,-0.028190895915031433},{-0.09620268642902374,-0.03788197785615921,0.15080216526985168,-0.14354203641414642,-0.21783511340618134,-0.023534003645181656,-0.2830076515674591,0.1583864390850067,0.2828579843044281,-0.0186392143368721,-0.21069803833961487,0.12087509781122208,0.361924409866333,-0.20593300461769104,0.07736390829086304,-0.02334502525627613,-0.4141307771205902,0.21007448434829712,-0.3889188766479492,-0.059908024966716766,-0.04590686783194542,-0.08806224167346954,-0.08802473545074463,-0.08837708085775375,0.006515865214169025,0.42736953496932983,-0.039930425584316254,0.12415902316570282,0.29214146733283997,-0.4218251407146454,-0.09176550805568695,0.020709851756691933},{0.1929156482219696,-0.2810615301132202,0.018930768594145775,-0.43563443422317505,0.13747712969779968,-0.061080921441316605,-0.010735898278653622,0.2578536570072174,0.060779597610235214,0.2801186442375183,0.03391849994659424,-0.19077472388744354,-0.22989428043365479,-0.09730691462755203,0.24433565139770508,-0.25043466687202454,0.09218716621398926,-0.055539343506097794,-0.1670226901769638,0.08330946415662766,-0.15621739625930786,0.17471164464950562,-0.24924913048744202,0.33237919211387634,-0.2974928021430969,0.008679825812578201,-0.061611358076334,-0.26886966824531555,-0.023877644911408424,0.06547018885612488,0.21914593875408173,-0.13175071775913239},{0.27437347173690796,-0.020014002919197083,0.06266297399997711,0.2662397623062134,-0.24445582926273346,-0.071265310049057,0.18542177975177765,-0.00016293507360387594,0.0979289710521698,-0.18435165286064148,0.0035339263267815113,-0.08185014128684998,-0.2011106014251709,-0.16756318509578705,0.32241642475128174,0.2901601195335388,-0.06275825202465057,-0.3348533511161804,0.17080403864383698,-0.11868200451135635,-0.128553107380867,0.21410727500915527,0.27654749155044556,0.018442856147885323,-0.11861857771873474,-0.12168432772159576,-0.006324041169136763,0.26596105098724365,0.2658780813217163,0.12630067765712738,0.12116039544343948,-0.23629482090473175},{0.2632007598876953,-0.16572736203670502,0.020142322406172752,0.09153369814157486,-0.18439334630966187,-0.33486369252204895,-0.24239562451839447,-0.3605937361717224,-0.18983124196529388,-0.002976973308250308,-0.023655300959944725,0.000840070890262723,-0.0671815574169159,0.005888500716537237,-0.22193872928619385,-0.29641303420066833,0.1721978783607483,0.04725321754813194,-0.31371811032295227,0.27328285574913025,-0.07949940860271454,-0.20092813670635223,0.1939031183719635,-0.12196969985961914,-0.12821140885353088,-0.24565479159355164,-0.1222270131111145,0.05858667567372322,0.07497511059045792,0.2334303855895996,-0.32050034403800964,0.13905562460422516},{0.19649872183799744,0.0702521800994873,0.2422439008951187,-0.15931738913059235,0.24752147495746613,-0.19591635465621948,-0.30064114928245544,-0.010428781621158123,0.29472097754478455,0.1503591388463974,-0.17169159650802612,0.12025372684001923,0.08184674382209778,0.3127968907356262,0.12089388072490692,-0.04359414428472519,-0.23251569271087646,0.1366797238588333,-0.008199487812817097,-0.03748561441898346,-0.09529966861009598,0.24036312103271484,0.17314259707927704,0.14856988191604614,-0.30574291944503784,-0.2325732707977295,-0.27763259410858154,-0.3588561415672302,0.036180224269628525,-0.11479765921831131,0.2874666154384613,0.13836610317230225},{0.34007927775382996,-0.430627703666687,0.05353379249572754,-0.4809040129184723,-0.28995004296302795,0.3502614200115204,0.4730634391307831,0.26646944880485535,-0.053549833595752716,0.1398213654756546,0.18543174862861633,-0.19502970576286316,0.007962980307638645,0.2438090294599533,-0.07500778138637543,0.15639862418174744,0.4977816045284271,-0.25554296374320984,-0.0984433963894844,-0.43037503957748413,0.21873368322849274,0.23885975778102875,0.1897144317626953,0.13734261691570282,0.1412680447101593,0.10649342834949493,0.20824657380580902,0.2786216735839844,-0.12996649742126465,-0.2527596354484558,0.26824790239334106,0.12333615124225616},{0.03299419581890106,-0.0553259551525116,0.19495710730552673,0.287853866815567,-0.2290223240852356,-0.35273778438568115,-0.10866916179656982,0.21987013518810272,-0.17511942982673645,-0.24157732725143433,0.04550110176205635,0.15964248776435852,0.14660464227199554,-0.3006191551685333,0.13752149045467377,-0.15431584417819977,-0.23615998029708862,0.13564017415046692,-0.2865298092365265,0.27062010765075684,-0.3227924108505249,-0.3184705972671509,-0.3142118453979492,0.20991624891757965,0.11368750780820847,0.12387675046920776,0.31347736716270447,0.23583243787288666,-0.1382310688495636,-0.35413676500320435,-0.12441699951887131,0.1637750118970871},{0.3844504952430725,0.05511989817023277,0.06811564415693283,0.22683224081993103,0.10325019061565399,0.28998589515686035,-0.0239756777882576,0.2901940643787384,-0.12636764347553253,0.059646692126989365,0.1628974825143814,0.09019718319177628,-0.1231497973203659,-0.4088023006916046,0.22786806523799896,0.2356509119272232,0.02019314281642437,-0.18534380197525024,0.027297919616103172,-0.014276769943535328,0.08850404620170593,-0.33873918652534485,0.41165801882743835,0.01979232393205166,-0.08601681888103485,0.09942026436328888,-0.3787389397621155,-0.1342734396457672,0.07755148410797119,0.061198730021715164,0.13028092682361603,0.2520359456539154},{-0.08504211157560349,0.09884025156497955,-0.09158098697662354,0.20819471776485443,-0.10447663813829422,0.27551886439323425,0.06934598833322525,-0.09502413123846054,0.2964516878128052,-0.3040689527988434,-0.1697940081357956,0.18749558925628662,-0.0836569145321846,0.06280424445867538,-0.30226436257362366,0.04207168519496918,0.04375937208533287,0.14635105431079865,0.06065581738948822,-0.14102615416049957,-0.26572391390800476,0.18962475657463074,0.22427038848400116,0.20955903828144073,-0.32636451721191406,0.3671480119228363,-0.12991675734519958,-0.0020664918702095747,-0.12100816518068314,0.11647047847509384,0.2237626612186432,0.25829073786735535},{-0.24722495675086975,0.2925221621990204,-0.08105936646461487,0.0006546543445438147,-0.2683179974555969,-0.20292136073112488,0.1367112100124359,-0.34365591406822205,-0.0208010021597147,-0.2794470489025116,-0.20496191084384918,-0.06604232639074326,0.20583531260490417,-0.2030019462108612,-0.12805211544036865,-0.3871559500694275,-0.174306258559227,0.02080542966723442,0.30389800667762756,-0.22364267706871033,0.06842013448476791,-0.15655992925167084,0.009458928368985653,0.3133874237537384,-0.11591089516878128,0.13152791559696198,0.24987243115901947,-0.15106520056724548,-0.09732571244239807,0.2906937897205353,-0.2282096892595291,-0.3732655942440033},{-0.041129883378744125,0.29380813241004944,0.2600937783718109,-0.2885020077228546,0.2961156964302063,0.004715286195278168,-0.14172440767288208,-0.023802757263183594,0.1037955954670906,-0.32227104902267456,-0.03860241174697876,0.06676654517650604,0.21307195723056793,0.03467932716012001,0.03421802818775177,0.003918064758181572,0.18984094262123108,-0.3341715931892395,0.34378376603126526,0.06241539865732193,-0.16689226031303406,0.15693902969360352,-0.07741910964250565,-0.27442479133605957,0.24214258790016174,-0.05641475319862366,-0.008690538816154003,-0.08984753489494324,0.08430249989032745,-0.13565129041671753,0.3147554397583008,0.28770431876182556},{0.08757346868515015,-0.25564393401145935,-0.19771632552146912,0.06110687553882599,0.06760340183973312,0.2924492359161377,-0.11811588704586029,-0.2725124955177307,0.3551586866378784,0.09204578399658203,-0.0024057389236986637,0.023318327963352203,-0.17857834696769714,0.10874481499195099,-0.20195715129375458,-0.3188207745552063,0.05849157273769379,0.03010433167219162,0.16984032094478607,0.37325459718704224,-0.2596992254257202,0.17885646224021912,-0.17505867779254913,0.10322654247283936,0.05465145409107208,-0.3130723536014557,-0.15203352272510529,-0.32179251313209534,-0.13472846150398254,-0.14059974253177643,0.2043321281671524,-0.35699084401130676},{-0.08813583850860596,0.3348679840564728,0.10761358588933945,-0.2019725888967514,-0.15213152766227722,-0.2409377098083496,0.15101034939289093,-0.08213494718074799,0.2771545648574829,-0.05532250553369522,0.2511151432991028,0.19606685638427734,-0.01555538922548294,0.077670618891716,-0.18756447732448578,0.1808905005455017,-0.19687698781490326,-0.40110310912132263,-0.31003639101982117,0.09677127003669739,0.1535288393497467,-0.2756463289260864,-0.3556629419326782,-0.2473176121711731,-0.17461277544498444,0.11268800497055054,0.3957096040248871,0.013434858992695808,-0.12628036737442017,0.04049686715006828,-0.1278252750635147,0.12784656882286072},{-0.20783525705337524,-0.18061967194080353,-0.24691416323184967,0.0908690094947815,-0.294564813375473,-0.13727223873138428,-0.14111563563346863,-0.18005993962287903,-0.292093962430954,-0.20145738124847412,0.10400684177875519,0.1882757991552353,-0.23732958734035492,0.28198662400245667,-0.02832980267703533,0.17636926472187042,0.019225796684622765,0.025901559740304947,0.02976398728787899,0.1466522216796875,0.14213769137859344,0.33247965574264526,0.09867877513170242,0.2393220216035843,0.10137581825256348,-0.24499113857746124,-0.14652705192565918,0.2377861738204956,-0.05270295590162277,-0.21125905215740204,-0.15992364287376404,-0.22971656918525696},{-0.31500083208084106,-0.1934403032064438,-0.39331313967704773,0.10421506315469742,-0.13031449913978577,-0.10465215146541595,-0.1524900197982788,0.06067195534706116,-0.02845367230474949,0.07298780232667923,-0.2423468679189682,0.043790191411972046,0.152827650308609,-0.07150685042142868,0.03070513904094696,0.19262252748012543,-0.15746286511421204,-0.13796870410442352,0.14533944427967072,0.08338409662246704,0.21104741096496582,-0.003495345823466778,-0.27534428238868713,0.03270178660750389,0.24975761771202087,-0.2633821964263916,0.17721237242221832,0.0264427550137043,0.08661724627017975,-0.18231484293937683,0.22948096692562103,-0.07339873909950256},{0.2684505879878998,-0.06525448709726334,0.044435665011405945,0.09263492375612259,-0.27111637592315674,0.01045682281255722,0.17625300586223602,0.24342119693756104,-0.08969788253307343,-0.0963280200958252,0.30449846386909485,-0.2015015035867691,-0.037523623555898666,-0.089487224817276,-0.15016797184944153,0.21696241199970245,0.03385515883564949,-0.07529677450656891,0.12840071320533752,-0.3015730082988739,0.03857847675681114,-0.30751797556877136,-0.23105397820472717,0.2563028633594513,-0.13592411577701569,-0.1327439695596695,0.166049063205719,-0.009660250507295132,-0.16099384427070618,-0.007037603762000799,-0.09820199012756348,-0.00892076175659895},{0.32658183574676514,-0.05541287735104561,0.09052707999944687,0.08145952224731445,-0.004175973124802113,-0.09633885324001312,0.1525869220495224,-0.23878920078277588,0.22290077805519104,0.29626166820526123,-0.003924531862139702,0.1743731051683426,0.2670884430408478,0.3261670172214508,-0.2820437252521515,-0.2916470468044281,-0.30815380811691284,0.044945210218429565,-0.14646480977535248,-0.2925932705402374,-0.20610933005809784,0.29805952310562134,0.07523874193429947,0.1446199268102646,-0.1528550535440445,-0.08757493644952774,-0.15176130831241608,-0.18564338982105255,0.2666090428829193,0.17340165376663208,-0.256885290145874,-0.1490817815065384},{-0.12154174596071243,0.12729047238826752,0.25115543603897095,-0.09213872998952866,-0.03365045413374901,0.051515255123376846,-0.0026390952989459038,-0.30624040961265564,0.22821494936943054,0.2685689330101013,0.15575316548347473,0.20247216522693634,-0.26342880725860596,0.17684870958328247,-0.304099440574646,0.25932228565216064,0.18113984167575836,-0.23824524879455566,0.22234825789928436,0.11563584208488464,-0.30456414818763733,0.30900901556015015,-0.3400365114212036,0.13572365045547485,0.215637668967247,0.24013009667396545,0.12627826631069183,0.09288853406906128,-0.19236329197883606,0.21633410453796387,-0.07387488335371017,0.13777215778827667},{-0.16527913510799408,-0.04468090459704399,-0.02562273107469082,0.25321125984191895,-0.040610410273075104,0.14980190992355347,-0.3670496940612793,-0.20211929082870483,-0.12878693640232086,-0.13115909695625305,-0.17537370324134827,-0.09137511998414993,0.07742161303758621,-0.11661870032548904,0.08930651843547821,-0.19381622970104218,0.15792256593704224,-0.04192960634827614,-0.34400299191474915,-0.24208608269691467,0.10437504202127457,0.19264978170394897,-0.21500353515148163,0.29708051681518555,-0.22694699466228485,0.12952642142772675,0.13583196699619293,-0.07223693281412125,0.13756392896175385,-0.2870299518108368,0.36494606733322144,0.08665946125984192},{0.35220688581466675,-0.06051452457904816,0.0879712924361229,0.15921273827552795,-0.17426913976669312,0.23982040584087372,-0.021478869020938873,0.23676349222660065,0.1433809995651245,0.1172385960817337,0.036871518939733505,-0.4104478657245636,-0.2670436203479767,-0.04128537327051163,0.07699571549892426,-0.13490675389766693,0.313299298286438,0.23190250992774963,-0.19535139203071594,-0.1894635111093521,0.28114646673202515,0.27320796251296997,0.2749388515949249,0.1678447276353836,-0.06764432787895203,-0.04503219202160835,-0.0893871933221817,-0.23327690362930298,0.21379436552524567,0.10206277668476105,-0.2165292352437973,0.10670250654220581},{-0.03319097310304642,0.013135142624378204,-0.07869593054056168,-0.26975420117378235,-0.1022343635559082,-0.24213390052318573,-0.2146580070257187,-0.16018544137477875,0.018016213551163673,-0.013931261375546455,-0.2612960934638977,0.008106491528451443,-0.2638780474662781,-0.17109110951423645,-0.008114784955978394,0.07172105461359024,0.29162731766700745,-0.1744060069322586,-0.3513236939907074,0.26330578327178955,-0.14718583226203918,0.255732923746109,-0.024876607581973076,-0.051717694848775864,0.06106724962592125,0.12497323751449585,-0.05016728490591049,-0.28754186630249023,0.2235681712627411,0.24571917951107025,-0.16154693067073822,0.21037329733371735},{-0.24425244331359863,0.0021214184816926718,0.07298485189676285,0.006053171120584011,0.07277292013168335,0.1139153465628624,-0.17764711380004883,0.11505217105150223,-0.22395899891853333,-0.2033817172050476,0.13602614402770996,-0.12236115336418152,-0.18411797285079956,0.24216578900814056,0.0358131118118763,0.03323172777891159,0.1925448775291443,-0.2713140547275543,-0.1364099234342575,0.24909256398677826,0.038593702018260956,0.19956447184085846,0.010717279277741909,0.005277806892991066,-0.3010377585887909,-0.14156566560268402,-0.0034551287535578012,0.33325618505477905,0.019184885546565056,0.006970648653805256,0.28983235359191895,0.29734671115875244}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.042392440140247345,0.21488958597183228,0.46228501200675964,-0.10237061232328415},{0.09223248809576035,-0.1496170163154602,0.01614300347864628,0.34620827436447144},{-0.14157536625862122,0.12349650263786316,0.15808871388435364,0.14294491708278656},{0.3916173577308655,0.06411133706569672,0.053500887006521225,0.5631283521652222},{-0.06697572767734528,0.10433991253376007,0.3558008670806885,0.03293514624238014},{-0.15035107731819153,0.2542712092399597,0.29241228103637695,-0.09376062452793121},{-0.4331860840320587,-0.05155973136425018,0.10501804947853088,-0.2024916708469391},{-0.4196299910545349,-0.15836982429027557,0.4927622079849243,-0.31797856092453003},{0.3344791829586029,-0.1453198939561844,-0.3077004551887512,-0.43842223286628723},{0.05737316235899925,0.3431287407875061,0.3761201500892639,-0.5607343912124634},{-0.28863704204559326,-0.24961721897125244,-0.09504374116659164,0.09761730581521988},{0.49688947200775146,-0.22096338868141174,-0.07733528316020966,0.24910056591033936},{0.3173367977142334,0.27523520588874817,-0.0734233632683754,0.17830069363117218},{0.0017185888718813658,0.04346640408039093,-0.32356375455856323,0.05102013051509857},{0.09370721876621246,0.30536386370658875,0.45977261662483215,0.35959506034851074},{0.15554451942443848,-0.037726085633039474,0.32754549384117126,0.2768396735191345},{-0.33383727073669434,-0.12317483872175217,-0.08352028578519821,-0.33678269386291504},{-0.13921797275543213,0.23729698359966278,-0.1786910593509674,-0.09184447675943375},{-0.36332905292510986,0.2315855622291565,0.2119162231683731,0.42845699191093445},{-0.023160219192504883,0.3775714337825775,-0.21960754692554474,0.2051926553249359},{-0.3064195215702057,-0.39975425601005554,-0.12868110835552216,0.040625691413879395},{0.3692314922809601,0.47141823172569275,0.03153382986783981,-0.3541189432144165},{-0.018561571836471558,0.22655853629112244,0.24101930856704712,0.23859891295433044},{-0.06970240920782089,0.4380009174346924,-0.055617570877075195,-0.2599525451660156},{0.0020698991138488054,-0.09556485712528229,-0.13002441823482513,0.003939629066735506},{0.3656940162181854,-0.4988425076007843,-0.05131230875849724,0.00694006122648716},{-0.038128286600112915,-0.4222159683704376,-0.20174311101436615,-0.31659674644470215},{0.16522139310836792,-0.244176983833313,0.24169296026229858,0.17383113503456116},{0.045804522931575775,-0.05817491561174393,0.07167422026395798,0.07316230982542038},{-0.4790441393852234,0.4380017817020416,0.2275419533252716,-0.01247324701398611},{0.37641042470932007,-0.1870259940624237,0.2395702600479126,-0.06460519880056381},{0.12715931236743927,-0.4947769343852997,0.4343460202217102,-0.28735271096229553}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.037424683570861816,-0.016195859760046005,0.023277387022972107,0.036274246871471405,-0.07915038615465164,-0.07938511669635773,0.019389858469367027,0.046154655516147614,0.09141194075345993,-0.014599456451833248,-0.03537306562066078,-0.02769778110086918,0.03652537986636162,-0.015144692733883858,-0.045893412083387375,-0.037085048854351044};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.028209663927555084,0.007762680295854807,0.0030062117148190737,0.016703760251402855,0.019591953605413437,-0.009667931124567986,0.030679818242788315,0.004936091136187315,0.014630048535764217,0.019421594217419624,0.040590424090623856,0.00228984490968287,0.052575528621673584,-0.03702361509203911,-0.03310065716505051,-0.0009584048530086875};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01166457124054432,0.00958381686359644,0.02452217787504196,0.004381537903100252,0.010346055962145329,0.0040528299286961555,0.009967696852982044,0.011934264563024044,-0.033833641558885574,-0.012985317036509514,0.009298289194703102,0.005177180282771587,0.011634774506092072,0.014768058434128761,-0.0023578351829200983,0.03267887979745865,-0.0002026274596573785,-0.007406152784824371,0.021852130070328712,-0.002668019849807024,-0.017649607732892036,-0.008350220508873463,0.03814530372619629,0.015974584966897964,-0.0030542677268385887,0.015428412705659866,-0.021227924153208733,0.033814530819654465,-0.007519297301769257,0.016018640249967575,0.0166766457259655,-0.0075470274314284325};
static const float action_parameterization_distribution_linear_bias[4] = {-0.012210237793624401,-0.004858244210481644,-0.003006773767992854,0.010768363252282143};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.07212934643030167,0.23660843074321747,-0.17918814718723297,0.21834558248519897,0.09190671890974045,0.0508987233042717,0.3491344153881073,-0.04178033024072647},{-0.27658143639564514,-0.03606153652071953,-0.31301558017730713,-0.1989418864250183,-0.39974164962768555,-0.2604040503501892,-0.028771162033081055,-0.2473575621843338},{-0.28055837750434875,0.03312905505299568,0.21374011039733887,0.25969064235687256,0.237829327583313,-0.04478774219751358,0.3846588134765625,-0.17570708692073822},{0.021281741559505463,0.10906197130680084,-0.19915182888507843,0.022052844986319542,0.015553642064332962,-0.06811263412237167,0.34775349497795105,-0.25684261322021484},{-0.31692856550216675,-0.12379740178585052,-0.25770968198776245,-0.1179581955075264,-0.022663285955786705,0.1763259917497635,0.18720200657844543,-0.062227457761764526},{-0.33461445569992065,-0.029800133779644966,0.36319538950920105,0.24775393307209015,0.19032502174377441,-0.10788994282484055,-0.13202887773513794,-0.15247608721256256},{-0.2721596956253052,0.019297102466225624,0.39389488101005554,-0.20050616562366486,-0.10204551368951797,-0.40652936697006226,-0.11445123702287674,-0.11153077334165573},{-0.2868078351020813,-0.3386368751525879,0.46180352568626404,-0.10771805793046951,-0.13304553925991058,0.2774137854576111,0.16831693053245544,-0.24088624119758606},{-0.35479724407196045,0.32282915711402893,-0.20475025475025177,0.3185272812843323,0.1899069994688034,-0.24435535073280334,0.012115352787077427,0.13259156048297882},{-0.3969387412071228,-0.2896404266357422,-0.17232491075992584,-0.238184854388237,-0.47983118891716003,0.1736936867237091,-0.03783842548727989,0.17233406007289886},{0.09165731072425842,0.3614286184310913,0.1997426301240921,-0.037714600563049316,0.22113464772701263,0.1730310469865799,-0.20806261897087097,0.2326761782169342},{0.14242517948150635,0.039696089923381805,0.25378313660621643,0.2547454833984375,-0.32201963663101196,0.3011707067489624,-0.004734405782073736,-0.21715959906578064},{0.07263129204511642,-0.33410683274269104,0.2568598985671997,-0.04198344424366951,-0.38522836565971375,-0.09065814316272736,-0.18427743017673492,-0.0958840399980545},{-0.22939381003379822,-0.2624334990978241,0.3208363950252533,0.3560383915901184,-0.267137348651886,-0.07199385017156601,-0.304597944021225,0.2521262764930725},{0.0730208158493042,-0.17105987668037415,0.1310342401266098,-0.22727392613887787,-0.28559377789497375,-0.12612037360668182,0.258797824382782,0.01815458945930004},{0.2052244395017624,-0.010534500703215599,0.011048036627471447,-0.24215498566627502,0.0668809786438942,0.06640215963125229,0.1546221673488617,0.3711220622062683},{-0.014712640084326267,-0.2977581024169922,-0.17474789917469025,0.131214439868927,-0.2108076810836792,-0.14846700429916382,-0.12836124002933502,0.13321828842163086},{-0.17507004737854004,-0.33192041516304016,0.021809659898281097,0.06570006161928177,0.11956347525119781,-0.20081868767738342,0.32776185870170593,0.1994108408689499},{0.0007280493737198412,0.08191785961389542,-0.275724321603775,0.14136871695518494,0.1133839339017868,0.18764455616474152,-0.26130878925323486,0.39726871252059937},{0.11436039209365845,-0.04564971476793289,-0.3906269669532776,0.11733056604862213,-0.048006754368543625,-0.03159883990883827,-0.34115368127822876,0.03189761936664581},{0.04511671140789986,-0.13122451305389404,0.0415397547185421,-0.0735238716006279,0.3536864221096039,0.04964779317378998,-0.03513724356889725,0.42450565099716187},{-0.0032178093679249287,0.1288866251707077,-0.2763041853904724,0.3209930956363678,0.376221626996994,0.33976301550865173,0.21688368916511536,-0.31785446405410767},{-0.4584115743637085,-0.13169755041599274,0.15984104573726654,-0.018318135291337967,0.2115301936864853,-0.29803118109703064,0.28163960576057434,-0.29053521156311035},{-0.24926695227622986,0.01278427243232727,-0.07060638070106506,-0.3352881073951721,0.20797698199748993,-0.032368484884500504,-0.2863430976867676,0.17511606216430664},{-0.31650885939598083,-0.18992264568805695,0.019163228571414948,0.07557062804698944,-0.12314517796039581,0.10137180984020233,0.3446253538131714,-0.13401660323143005},{-0.2971874177455902,0.059575505554676056,-0.3834715485572815,-0.31196510791778564,0.15378236770629883,0.017442142590880394,-0.05877680703997612,0.07174491137266159},{0.24760374426841736,0.387559711933136,-0.31344306468963623,0.16580569744110107,0.2207648605108261,0.39144593477249146,-0.27192071080207825,-0.13771027326583862},{0.28539612889289856,0.25516197085380554,0.0403871014714241,0.06351388990879059,0.2878251075744629,0.2039714902639389,0.28157663345336914,0.3757556676864624},{-0.2255139946937561,0.3947448134422302,0.15782374143600464,0.004974196664988995,0.21312813460826874,0.04370744526386261,-0.31118035316467285,-0.3058968782424927},{-0.3127373158931732,-0.21287880837917328,0.08533813059329987,-0.2505071461200714,-0.32380568981170654,-0.17741748690605164,0.3469332754611969,-0.07313752174377441},{0.27890869975090027,-0.2447081059217453,0.34049272537231445,-0.31349050998687744,0.008122534491121769,0.2204281985759735,0.23051990568637848,-0.2692982256412506},{0.09535398334264755,0.3805070221424103,0.38578349351882935,-0.24412651360034943,-0.285299688577652,0.035298947244882584,0.2273005098104477,0.0641586109995842}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.005852928385138512,0.46973761916160583,-0.19552475214004517,0.20860183238983154,-0.41774269938468933,0.3225812315940857,0.3417620360851288,0.07559512555599213},{-0.511974573135376,-0.41127851605415344,-0.37303370237350464,-0.44501471519470215,-0.5106847882270813,0.49001067876815796,0.39411428570747375,-0.420867383480072},{0.10138589143753052,-0.19180455803871155,0.15099473297595978,0.16749286651611328,-0.0249605905264616,0.4504331052303314,-0.3423691689968109,-0.4628734588623047},{0.48495233058929443,0.0038198945112526417,0.14018264412879944,0.01565311849117279,0.5063239336013794,0.40799418091773987,0.462605357170105,0.36842337250709534},{0.08698292821645737,0.20990177989006042,-0.1931798756122589,-0.3135744035243988,0.07156667858362198,-0.5065740942955017,-0.4948234260082245,0.6370575428009033},{0.4332714080810547,0.061562128365039825,0.025624848902225494,-0.3803136646747589,-0.48368367552757263,-0.5158216953277588,-0.12550115585327148,0.4488261938095093},{-0.4755110740661621,-0.3614751994609833,-0.09151411801576614,-0.25499624013900757,-0.013220041990280151,0.5170373320579529,-0.5570860505104065,0.537164568901062},{0.2708006203174591,0.09680357575416565,-0.03432604297995567,0.061494842171669006,0.43997249007225037,-0.5974631309509277,0.4306497871875763,-0.35870447754859924}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.10291847586631775,0.018862470984458923,0.027468867599964142,-0.016280464828014374,-0.04133562371134758,0.02504623495042324,0.00025039640604518354,0.008570710197091103};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.013447880744934082,-0.013715582899749279,-0.01930762082338333,0.03417324274778366,-0.010886739939451218,-0.011505785398185253,0.011663291603326797,-0.05577199533581734};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

