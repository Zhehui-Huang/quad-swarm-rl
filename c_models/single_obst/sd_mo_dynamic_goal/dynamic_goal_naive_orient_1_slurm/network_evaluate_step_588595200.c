#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3337632119655609,-0.08224017918109894,0.2877182960510254,0.15284846723079681,-0.27297037839889526,0.2931928336620331,-0.03354218602180481,-0.14018425345420837,0.12250901758670807,0.3409200608730316,0.09462650865316391,0.0367792472243309,0.23812586069107056,-0.2581498324871063,0.2704518735408783,-0.04633943364024162},{-0.18101076781749725,-0.4094482362270355,0.33328551054000854,0.09301026910543442,-0.2208910435438156,0.17245031893253326,-0.3918232023715973,-0.05851154401898384,-0.0996176153421402,-0.1985795646905899,0.04599470645189285,-0.19989286363124847,0.007917409762740135,-0.32972270250320435,-0.26307839155197144,0.11769887804985046},{-0.08677005022764206,-0.23068667948246002,-0.4676581919193268,0.1567998081445694,0.24530953168869019,0.5678635239601135,0.016342999413609505,-0.048063572496175766,0.0872604176402092,-0.49027764797210693,-0.4004567563533783,0.8036045432090759,-0.21917375922203064,-0.3027198910713196,-0.39330384135246277,0.26895207166671753},{0.15665030479431152,0.27451634407043457,0.3618544340133667,-0.021039322018623352,-0.39547109603881836,-0.00989274587482214,0.25018733739852905,0.06804963201284409,0.3207413852214813,-0.33162635564804077,0.004981853533536196,0.4150090217590332,-0.22196173667907715,-0.008533952757716179,0.48930010199546814,-0.4714740514755249},{-0.07391104102134705,0.007563650142401457,0.31737807393074036,-0.06780990958213806,0.30483609437942505,0.4297123849391937,0.17431457340717316,-0.020357511937618256,0.1339069902896881,0.2097083181142807,0.2568803131580353,-0.3483229875564575,-0.19549141824245453,-0.41725409030914307,0.39801838994026184,0.09848898649215698},{-0.2587446868419647,-0.19040139019489288,-0.17777326703071594,-0.047091711312532425,0.21486587822437286,0.18664605915546417,0.040717173367738724,-0.11668871343135834,0.3435512185096741,-0.30677157640457153,-0.46792852878570557,0.22750595211982727,0.1058363988995552,-0.14570114016532898,-0.012264570221304893,0.07812725007534027},{0.06642227619886398,0.07735297828912735,0.02443281002342701,-0.4354206919670105,0.21853457391262054,-0.042892783880233765,0.04977274313569069,0.3902503252029419,0.33164310455322266,0.07676215469837189,-0.4635127782821655,-0.03305528312921524,-0.021321721374988556,0.15191632509231567,-0.20714424550533295,-0.24537736177444458},{-0.2744206190109253,0.45882532000541687,0.40298229455947876,0.36941656470298767,-0.49203795194625854,-0.06951823830604553,0.5845367312431335,0.5370137095451355,-0.25097164511680603,0.37333205342292786,-0.7249061465263367,-0.4365241825580597,0.4533522129058838,0.13395282626152039,0.27209407091140747,0.4518664479255676},{0.3615572154521942,-0.27713489532470703,0.631939709186554,0.10200098901987076,0.0062176743522286415,0.0625782161951065,0.14435501396656036,-0.6264848113059998,-0.2525891959667206,-0.4563971757888794,-0.18199537694454193,-0.006129894871264696,-0.08128158003091812,0.6953611969947815,0.4752744138240814,-0.3091624081134796},{0.22676146030426025,-0.5625454187393188,-0.6392073035240173,-0.3506855368614197,-0.26094865798950195,0.23589643836021423,0.16543714702129364,0.17148679494857788,0.6116005778312683,0.2712629735469818,0.19621507823467255,-0.26949092745780945,-0.10724461078643799,0.41431641578674316,-0.20608073472976685,-0.5460071563720703},{0.20455554127693176,0.38358113169670105,0.39192044734954834,-0.6468741297721863,-0.3206813931465149,0.12717917561531067,0.14366412162780762,0.40004563331604004,-0.37240564823150635,0.05108025670051575,-0.12647509574890137,0.012745951302349567,-0.1645110547542572,-0.18534941971302032,0.23409953713417053,-0.36331942677497864},{-0.05552002415060997,-0.4214409291744232,0.18270547688007355,0.6351319551467896,0.7781439423561096,0.44249555468559265,0.40341177582740784,0.41519761085510254,0.04672107845544815,-0.02705971524119377,0.27823197841644287,-0.46674874424934387,-0.5896735191345215,-0.4281468093395233,0.7543027997016907,-0.05869313329458237},{-0.2617988884449005,0.41789132356643677,-0.05154668167233467,-0.6203975081443787,0.14889171719551086,0.06013985350728035,0.19930888712406158,0.1818271428346634,0.06669138371944427,0.06315658986568451,0.03340431675314903,0.20535452663898468,0.4229935109615326,0.37529456615448,-0.08713487535715103,-0.11806175857782364},{0.058237556368112564,-0.38934221863746643,-0.25491294264793396,-0.19822610914707184,-0.45953765511512756,0.013486114330589771,-0.26728981733322144,-0.27220264077186584,-0.2168963998556137,-0.05351544916629791,-0.4629615247249603,-0.026806868612766266,-0.18821533024311066,0.4182022511959076,0.1612137407064438,0.00018138927407562733},{0.05018598958849907,-0.2870942950248718,-0.2218380719423294,0.17852012813091278,-0.0929509848356247,-0.4591737985610962,0.2842482626438141,-0.07914289832115173,-0.04262550547719002,0.37837639451026917,0.04933495447039604,0.05652742087841034,0.29117557406425476,0.007196156773716211,-0.29900598526000977,0.2302994728088379},{0.3903605043888092,-0.009676989167928696,-0.2246987372636795,-0.18109279870986938,-0.33331891894340515,0.15256772935390472,0.3231293559074402,-0.07733123749494553,0.22319182753562927,0.3586196005344391,-0.14853352308273315,0.07186364382505417,-0.1969296932220459,0.24181589484214783,-0.08640646934509277,-0.01449527870863676},{-0.2243911325931549,-0.17298108339309692,0.22975654900074005,0.11888100951910019,-0.20407603681087494,0.07816138863563538,-0.16634517908096313,-0.0938170850276947,-0.20764103531837463,-0.2555620074272156,-0.04228552430868149,-0.2633224427700043,0.09002785384654999,-0.20588740706443787,0.04304859787225723,-0.22223487496376038},{-0.23728349804878235,0.2642378509044647,-0.3395420014858246,-0.2215510606765747,0.06566643714904785,0.33079764246940613,-0.21501696109771729,-0.2183464914560318,0.14792045950889587,0.16257940232753754,0.3125285804271698,-0.12970459461212158,-0.32476767897605896,0.3198941648006439,0.013408358208835125,-0.41873225569725037}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.046820711344480515,-0.042840130627155304,-0.10197900980710983,-0.3446725606918335,0.31093889474868774,0.29923486709594727,0.07889693230390549,0.04512492194771767,-0.08639511466026306,-0.1631150245666504,-0.015951117500662804,0.0720900446176529,0.20273375511169434,0.3466964364051819,0.10876570641994476,0.07536569982767105},{-0.17471611499786377,-0.3101259768009186,-0.06636283546686172,0.05608068406581879,0.22825144231319427,-0.3017811179161072,0.02977854013442993,0.059399642050266266,-0.05670144036412239,0.26224836707115173,-0.2504623830318451,0.3102931082248688,-0.38283467292785645,0.20506775379180908,-0.35672128200531006,-0.34739404916763306},{0.03411276638507843,0.20531846582889557,-0.3726796507835388,-0.5194594860076904,0.20221249759197235,0.4451434314250946,-0.0880824401974678,0.06323789805173874,-0.2742702066898346,-0.29860571026802063,-0.008734188973903656,0.3292344808578491,-0.2816363573074341,-0.16522639989852905,0.10278129577636719,-0.07172846794128418},{0.1573321521282196,-0.061320483684539795,0.08394952863454819,0.21026331186294556,-0.4695281982421875,-0.013045444153249264,0.08816687762737274,-0.1885971575975418,0.29340285062789917,0.35862982273101807,-0.16518950462341309,-0.14082661271095276,-0.41377493739128113,-0.40058544278144836,0.19348587095737457,0.17342446744441986},{-0.07332376390695572,0.1472690999507904,0.002876780228689313,0.24977467954158783,-0.22792276740074158,0.09044962376356125,-0.015577835030853748,0.1689138114452362,0.24597421288490295,-0.23922088742256165,0.17893214523792267,0.25636693835258484,0.17848874628543854,-0.4395914375782013,0.019483577460050583,0.00599473062902689},{0.21524323523044586,0.26516878604888916,-0.0234703179448843,0.1828143149614334,-0.5002270340919495,-0.43264544010162354,0.26775938272476196,0.3077356219291687,0.09654772281646729,0.37486037611961365,0.23661033809185028,-0.2240741103887558,-0.007851168513298035,-0.1441311240196228,-0.09396784007549286,0.29799365997314453},{-0.11685950309038162,0.25791293382644653,0.2839829623699188,-0.3656969368457794,-0.25231093168258667,0.006439875811338425,-0.35759615898132324,-0.04326719045639038,0.19132204353809357,0.07094064354896545,-0.14516519010066986,-0.2189166247844696,-0.3178176283836365,-0.024483991786837578,0.1931135654449463,0.031323496252298355},{-0.1400614231824875,-0.1541110724210739,-0.4674181640148163,0.297439843416214,-0.31449219584465027,-0.229563370347023,-0.24629269540309906,-0.392530232667923,0.14554478228092194,-0.24029068648815155,0.05283259227871895,0.07656724005937576,-0.1531704217195511,0.4538198411464691,-0.06934546679258347,-0.31977617740631104},{-0.33151775598526,0.2609736919403076,-0.018642449751496315,-0.03615085035562515,0.2773941457271576,-0.27019786834716797,0.28892695903778076,0.14000532031059265,0.35460036993026733,0.2938202917575836,0.24915340542793274,0.318816602230072,0.17132143676280975,-0.055337514728307724,0.27328282594680786,0.10128911584615707},{0.06413375586271286,-0.2724846303462982,-0.16532737016677856,-0.12819308042526245,0.2525624930858612,-0.16497227549552917,-0.29985302686691284,-0.16076037287712097,0.07283157855272293,-0.3689876198768616,-0.2755155563354492,0.34160780906677246,0.12444020807743073,0.14632295072078705,-0.37730830907821655,0.23520363867282867},{-0.063426174223423,-0.452201247215271,0.3031620979309082,0.2933818995952606,0.2468073070049286,0.14289477467536926,0.17328982055187225,-0.12875086069107056,0.22143419086933136,-0.2558429539203644,0.19544701278209686,0.33803701400756836,0.5070608854293823,0.11599947512149811,-0.10317390412092209,0.09449321776628494},{0.06304061412811279,-0.006339074578136206,0.41094228625297546,-0.014825170859694481,-0.24300014972686768,-0.17025405168533325,0.42940717935562134,0.3029056787490845,-0.24572807550430298,-0.19265925884246826,-0.07256920635700226,-0.35445913672447205,-0.020609354600310326,-0.28142204880714417,-0.37364959716796875,0.08039811253547668},{-0.12347385287284851,-0.3090071976184845,0.4250966012477875,-0.2296556681394577,0.36910274624824524,-0.30313819646835327,-0.44954225420951843,0.07491672039031982,0.07546702027320862,0.06650769710540771,-0.3351885974407196,0.12178841233253479,0.09883776307106018,-0.30852264165878296,-0.3350348472595215,-3.640175054897554e-05},{0.3730366826057434,-0.338080495595932,0.4488102197647095,0.0856582522392273,-0.09623473882675171,0.3351684808731079,-0.11679581552743912,-0.22753959894180298,-0.40474656224250793,0.11499925702810287,0.012497308664023876,-0.36126700043678284,-0.11903367191553116,0.12252037972211838,0.3018743097782135,0.0356273390352726},{-0.10155045986175537,0.22033332288265228,0.10323730856180191,-0.4866088926792145,-0.2099015712738037,0.19443990290164948,0.24414710700511932,-0.25492987036705017,0.21571850776672363,-0.30857688188552856,0.02170490100979805,0.11611112952232361,-0.07472844421863556,0.1910371482372284,0.045979466289281845,0.0724191665649414},{-0.14811930060386658,0.4249207675457001,-0.44752028584480286,0.37436729669570923,0.1002003625035286,-0.3868694305419922,-0.02838851697742939,-0.0747731477022171,-0.31048426032066345,0.406106561422348,-0.32763782143592834,0.2891794741153717,-0.09132412075996399,-0.33768436312675476,-0.20544135570526123,-0.4805199205875397}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1505574882030487,0.11481120437383652,-0.014993647113442421,-0.04773522540926933,-0.11606769263744354,0.022792348638176918,0.271162748336792,0.08535761386156082,-0.18509671092033386,-0.15854854881763458,0.13445386290550232,-0.2829405963420868,-0.22948618233203888,0.24423848092556,0.21151243150234222,0.3182312846183777,-0.26774612069129944,-0.28153592348098755,-0.19760747253894806,0.12084835767745972,-0.06790302693843842,-0.3175658881664276,-0.24366645514965057,-0.2816358506679535,-0.24399252235889435,0.14284072816371918,-0.2103498876094818,-0.04028137028217316,-0.0505140945315361,-0.020291220396757126,0.22471801936626434,-0.21960487961769104},{0.2928851246833801,0.15311256051063538,0.1764492690563202,-0.09646236151456833,0.15169717371463776,-0.12915410101413727,0.38116249442100525,0.13594494760036469,-0.1353684663772583,-0.09099322557449341,-0.12682954967021942,-0.2801746726036072,-0.16785001754760742,0.2588006556034088,-0.26128771901130676,-0.20495395362377167,-0.029245441779494286,0.20757094025611877,-0.3696328103542328,-0.23444516956806183,-0.039080895483493805,0.22763852775096893,0.027337167412042618,0.027957599610090256,0.22065788507461548,-0.34420743584632874,-0.05587309971451759,0.08037091046571732,0.1768137514591217,-0.11712721735239029,-0.054388005286455154,0.19834211468696594},{0.16529317200183868,0.04044656082987785,-0.14624826610088348,0.1382368803024292,-0.16031381487846375,-0.1661718785762787,-0.20615850389003754,0.05427350848913193,-0.15693683922290802,0.35981664061546326,-0.3147541284561157,-0.2878601551055908,0.15942507982254028,-0.39605483412742615,-0.16493459045886993,0.10319625586271286,-0.10183537006378174,-0.12323790788650513,0.17217834293842316,-0.09432440996170044,0.23695717751979828,0.283141165971756,-0.2441791296005249,0.0265172328799963,-0.2698156535625458,-0.014024389907717705,0.12146291136741638,-0.07648909837007523,-0.03921576216816902,-0.23205183446407318,-0.12706837058067322,-0.09014680236577988},{0.41807472705841064,0.04944543540477753,0.1589253693819046,-0.18062174320220947,-0.2572000324726105,-0.0508861280977726,-0.1518356055021286,0.2931382954120636,0.24946534633636475,-0.30860236287117004,-0.07881123572587967,0.2953529953956604,0.1113036721944809,-0.03419909626245499,-0.24476538598537445,0.2996526062488556,-0.2954252362251282,0.26074254512786865,0.03913293033838272,0.13035236299037933,-0.09626546502113342,-0.11198738217353821,0.28265073895454407,0.1650065928697586,0.1868637204170227,-0.3873087465763092,0.26251646876335144,-0.21635212004184723,-0.0652538314461708,0.09386862069368362,-0.19431571662425995,0.13772882521152496},{-0.06693249195814133,-0.07529262453317642,-0.11409956961870193,0.12510976195335388,0.21432270109653473,-0.15257981419563293,-0.41277429461479187,-0.08544875681400299,-0.10671058297157288,-0.3058590590953827,0.1379302740097046,0.24211625754833221,-0.040394946932792664,-0.11438339203596115,-0.09949710965156555,0.12527869641780853,-0.021813906729221344,-0.04420316219329834,-0.3133566379547119,-0.1938641220331192,-0.16453015804290771,-0.36270490288734436,0.1403551548719406,0.14694593846797943,-0.10226986557245255,0.3547384440898895,-0.17920567095279694,0.201032355427742,0.32366883754730225,0.38421201705932617,-0.03619564697146416,0.3835487961769104},{-0.29695263504981995,0.013111226260662079,-0.22915121912956238,-0.05720387026667595,-0.20926181972026825,0.24233584105968475,0.20009741187095642,0.0124129056930542,0.26054707169532776,0.23836426436901093,0.33613818883895874,-0.23001612722873688,-0.2638503909111023,0.19246642291545868,0.33626604080200195,-0.3337329924106598,-0.12927976250648499,-0.2620868384838104,0.22027932107448578,0.0923524871468544,0.09248828142881393,0.18075305223464966,0.07179997116327286,-0.08077023178339005,-0.3589215874671936,0.3663961887359619,-0.14582134783267975,0.20879636704921722,0.3516334593296051,0.18523547053337097,0.05707719922065735,0.021711504086852074},{0.21075257658958435,-0.1563960313796997,-0.11907288432121277,-0.33298593759536743,-0.04150024428963661,0.23456402122974396,0.32020941376686096,0.18596279621124268,0.0920676440000534,0.34608668088912964,-0.01193926390260458,-0.03459465876221657,-0.43290045857429504,-0.15933673083782196,-0.17042753100395203,0.1692599505186081,-0.2655600607395172,-0.21479329466819763,0.2120678424835205,-0.07224618643522263,-0.1399414837360382,-0.1473756730556488,-0.24298492074012756,-0.2048484981060028,0.1550782322883606,-0.24090039730072021,-0.09124591946601868,-0.20108437538146973,0.2894383370876312,0.12125159800052643,-0.15787288546562195,-0.313782662153244},{0.010938907042145729,0.1507357507944107,0.05505688861012459,-0.010857203043997288,0.12100815027952194,-0.33328619599342346,-0.11616344749927521,-0.17414972186088562,-0.018075617030262947,-0.22415797412395477,-0.31816190481185913,-0.05846560746431351,-0.12491780519485474,-0.017914965748786926,-0.12771180272102356,0.37584543228149414,-0.023643026128411293,-0.16888172924518585,0.10177665203809738,0.3383351266384125,-0.10225602239370346,-0.24449355900287628,0.25680074095726013,0.10104919970035553,-0.043861519545316696,-0.31303563714027405,-0.30962851643562317,-0.32048648595809937,-0.33785444498062134,-0.2543453574180603,0.030549386516213417,-0.3067226707935333},{0.10123348981142044,0.31765416264533997,-0.2523516118526459,-0.3235582709312439,-0.2225884199142456,0.08020248264074326,0.06092028692364693,0.08257836848497391,0.13855785131454468,-0.29784420132637024,-0.2008393257856369,0.3361179828643799,-0.23569226264953613,-0.1926058828830719,0.19652315974235535,-0.27481746673583984,0.27608156204223633,0.16234521567821503,0.35472598671913147,0.029205910861492157,0.2051115781068802,0.06405667215585709,0.26340416073799133,-0.09208891540765762,0.38527241349220276,-0.2266857922077179,0.12396512925624847,0.3376586437225342,-0.29134082794189453,0.2316550761461258,0.0020768120884895325,0.15197211503982544},{-0.16747978329658508,0.1261594146490097,-0.22996065020561218,-0.1726503223180771,0.19095830619335175,-0.1494368314743042,0.10487043857574463,0.007672234438359737,0.15043772757053375,-0.049816589802503586,-0.2805691063404083,-0.2963159680366516,-0.32188764214515686,-0.0442352332174778,-0.2584441006183624,0.11328736692667007,0.07731086760759354,-0.18524742126464844,0.26445531845092773,0.11812994629144669,-0.012569475919008255,-0.0027485552709549665,0.2726981043815613,-0.18900835514068604,0.326465904712677,0.08220649510622025,-0.26401686668395996,0.021039091050624847,-0.049188531935214996,0.1338849514722824,-0.10576213896274567,0.07879074662923813},{0.08929773420095444,0.021022148430347443,0.2070605605840683,-0.2788935899734497,-0.3312806487083435,-0.24324238300323486,-0.2717392146587372,0.008753051981329918,-0.22084690630435944,0.4487566649913788,0.15263769030570984,-0.24474896490573883,-0.3869870603084564,-0.04904285818338394,-0.2101261466741562,-0.09190403670072556,0.2055075615644455,-0.16539262235164642,0.2769377827644348,-0.15303809940814972,-0.18302609026432037,0.001357073662802577,0.17406205832958221,0.23213836550712585,0.17190246284008026,-0.1304207444190979,0.0024720020592212677,-0.08844039589166641,-0.05823509022593498,0.021155722439289093,-0.030843187123537064,0.12296207249164581},{-0.16664831340312958,-0.1404329389333725,0.21914590895175934,0.28854843974113464,0.27578845620155334,-0.047443997114896774,0.07101961225271225,-0.22409746050834656,-0.01462594699114561,-0.2716453969478607,0.2591118812561035,-0.22302916646003723,-0.18805722892284393,-0.19665110111236572,0.24062873423099518,-0.0034633588511496782,-0.0023809808772057295,0.021373510360717773,0.35692495107650757,0.043655868619680405,-0.17783688008785248,0.2128424346446991,0.09833115339279175,-0.05734141543507576,0.24172590672969818,-0.09579765051603317,-0.17891663312911987,0.2077280730009079,0.15319877862930298,0.01965242438018322,-0.3022030293941498,-0.23018379509449005},{0.29769372940063477,-0.26667535305023193,-0.0012426759349182248,-0.31519800424575806,-0.025282593443989754,-0.16356688737869263,0.1114329919219017,0.16004784405231476,0.2168741077184677,0.07311676442623138,0.18577639758586884,0.250975102186203,-0.4330035150051117,-0.36365869641304016,-0.03761953487992287,-0.21721325814723969,-0.2621821165084839,-0.3142634332180023,0.32245907187461853,-0.18045325577259064,0.33988305926322937,-0.10545482486486435,0.012645093724131584,0.19627510011196136,0.12778495252132416,-0.10807310789823532,0.1294718235731125,0.029736999422311783,0.10434494912624359,-0.015068797394633293,-0.2817809581756592,0.0028122004587203264},{0.26787295937538147,-0.03909642621874809,-0.013911070302128792,0.3553597629070282,-0.09557655453681946,-0.17222106456756592,-0.03235041722655296,0.1714651733636856,0.1915070116519928,0.24863287806510925,0.12336958199739456,-0.11892061680555344,0.06163830682635307,0.21029527485370636,-0.11770446598529816,0.11945237964391708,0.23444829881191254,-0.23657584190368652,0.11617238074541092,-0.33989495038986206,0.25585687160491943,0.15224385261535645,-0.09739531576633453,0.20528513193130493,0.2509405314922333,0.07862836867570877,0.1504090577363968,0.09041163325309753,0.07583070546388626,-0.14005425572395325,0.025386640802025795,0.3631381094455719},{0.07589788734912872,-0.19890372455120087,0.011956481263041496,0.09966707229614258,-0.27651360630989075,0.00783625990152359,0.04087383672595024,-0.21040689945220947,-0.1631605476140976,-0.03296405449509621,0.18244704604148865,0.2104950100183487,0.1013917550444603,0.25091591477394104,-0.03440045192837715,-0.034428615123033524,-0.2109178602695465,0.266560822725296,-0.060551322996616364,-0.22315147519111633,-0.21665193140506744,-0.09954341500997543,0.14024920761585236,0.042117878794670105,0.0006271455204114318,-0.14607465267181396,-0.17794908583164215,0.22713688015937805,0.05453970655798912,-0.13599349558353424,0.2770966589450836,0.1625191867351532},{0.17529729008674622,-0.23147360980510712,0.0215284526348114,-0.1932908147573471,-0.011298500001430511,0.15905329585075378,0.07225269824266434,0.2714180648326874,-0.10068953782320023,-0.02763417549431324,0.2253342717885971,0.11523549258708954,0.05896788835525513,-0.09827638417482376,-0.015185205265879631,0.2060343325138092,-0.33774152398109436,-0.18809746205806732,-0.03386766090989113,0.07813278585672379,0.03250693902373314,0.25311535596847534,0.1502203792333603,0.1886686533689499,0.06533677130937576,0.17447584867477417,-0.02198154293000698,-0.055603645741939545,0.08870881050825119,-0.10023336857557297,-0.24761459231376648,0.3105459213256836},{0.14851810038089752,0.023966534063220024,-0.37096795439720154,0.11237797141075134,0.05114472284913063,-0.03255750983953476,0.3387959599494934,0.10520346462726593,0.09701269119977951,-0.1105254516005516,0.20848222076892853,-0.2598367929458618,-0.42342129349708557,0.25015735626220703,0.0860949382185936,0.056724973022937775,-0.014614103361964226,-0.0927848219871521,-0.1601598858833313,0.061403483152389526,-0.04397809877991676,0.23309294879436493,0.09687671065330505,-0.1693931221961975,-0.08350382000207901,-0.21571652591228485,0.06683891266584396,0.340398907661438,0.2223551720380783,-0.20774954557418823,0.1852707862854004,0.1713934987783432},{-0.07303841412067413,0.005658323410898447,-0.07951442152261734,-0.07698697596788406,-0.23124033212661743,-0.03556497395038605,0.22104211151599884,0.17248745262622833,0.1416250467300415,0.010865293443202972,0.1796340048313141,-0.009608789347112179,0.2367536574602127,0.2066379189491272,0.1712218075990677,-0.10370991379022598,0.1211312860250473,0.19588063657283783,0.21277855336666107,0.04990847036242485,0.19266080856323242,0.27860376238822937,0.07753689587116241,0.16792422533035278,-0.02967183291912079,-0.06657183915376663,-0.13852863013744354,-0.2470909208059311,0.13449257612228394,-0.2737869918346405,0.031025392934679985,-0.06611064076423645},{-0.3423641324043274,0.03649080544710159,-0.34252119064331055,-0.3330647051334381,0.0378313772380352,-0.007722142618149519,0.1339818388223648,-0.16961519420146942,0.06435103714466095,0.35549962520599365,0.017142586410045624,-0.23677487671375275,0.05953168123960495,-0.18826544284820557,-0.3192443549633026,0.02056698314845562,-0.17447248101234436,0.12315001338720322,-0.07939828932285309,0.005407669581472874,-0.29756271839141846,0.1584589034318924,0.1040373295545578,0.05133706331253052,-0.08478715270757675,0.3493069112300873,0.0428597666323185,-0.2055281549692154,-0.20207306742668152,0.007784807588905096,-0.21239514648914337,-0.2648621201515198},{-0.009550362825393677,-0.26135337352752686,-0.2843128740787506,-0.050448741763830185,-0.32668009400367737,-0.14616109430789948,0.1840696483850479,-0.2791844606399536,-0.22402805089950562,0.17892853915691376,0.1969636231660843,0.08775559067726135,0.11732158809900284,-0.15057480335235596,0.27901777625083923,-0.2683427631855011,0.09408863633871078,0.25950711965560913,0.0469055138528347,0.2775307297706604,0.009532371535897255,-0.11685831844806671,-0.2810095250606537,0.2240220606327057,-0.1147414892911911,-0.15731796622276306,0.11939777433872223,0.0423983670771122,-0.11888989061117172,-0.3296571373939514,-0.034287936985492706,-0.19011764228343964},{0.21828864514827728,0.09725788980722427,-0.06453350931406021,0.23073457181453705,-0.24081385135650635,0.0952005386352539,-0.0912100151181221,-0.2100580334663391,-0.08487828820943832,0.21766267716884613,-0.3435651361942291,-0.14607246220111847,0.027960235252976418,-0.2071423977613449,-0.3878602087497711,-0.17497602105140686,-0.11399523168802261,-0.32988837361335754,-0.26769158244132996,0.21087156236171722,0.15776382386684418,0.07960963249206543,-0.38113999366760254,0.3214581608772278,0.13529033958911896,0.316740483045578,-0.3182031810283661,-0.11840179562568665,0.09543627500534058,-0.21186530590057373,0.09987162798643112,0.17934168875217438},{-0.05250193178653717,-0.3028581142425537,-0.04515247419476509,-0.30847683548927307,-0.07123808562755585,0.2960183322429657,0.20669235289096832,0.033470459282398224,-0.10446757823228836,0.01315868180245161,-0.15625137090682983,0.0994492694735527,0.10248886048793793,0.06093587726354599,0.11788168549537659,0.03588411584496498,-0.08003182709217072,0.14303989708423615,-0.115136057138443,0.15161971747875214,0.1883944422006607,0.25619566440582275,-0.03546326607465744,-0.24710793793201447,0.16899645328521729,0.15693309903144836,0.28064700961112976,0.1684170812368393,0.024453675374388695,0.10844824463129044,0.016864079982042313,-0.10412289202213287},{-0.02321716584265232,-0.20047800242900848,0.2240644246339798,0.058219265192747116,0.27138128876686096,-0.016822198405861855,-0.13055552542209625,-0.19061633944511414,0.1229618489742279,-0.041794635355472565,0.09338202327489853,0.00914935301989317,-0.32885459065437317,0.054812461137771606,-0.08551271259784698,-0.256564199924469,-0.047212596982717514,-0.06268251687288284,0.18197402358055115,0.19422242045402527,0.024317173287272453,0.05632064491510391,0.17480362951755524,0.29148632287979126,-0.18698331713676453,-0.04530554637312889,0.17874841392040253,-0.0633908212184906,-0.13891364634037018,-0.2625647783279419,0.30244681239128113,0.018287746235728264},{0.1885998398065567,-0.07950472086668015,0.03790025785565376,0.10191226750612259,-0.02182845026254654,0.05051496997475624,-0.23003149032592773,0.3021179139614105,-0.11790470778942108,-0.0265300702303648,0.11861700564622879,-0.3158170282840729,0.06364133954048157,-0.053096216171979904,-0.12594640254974365,0.31887754797935486,-0.08218427747488022,-0.1694488525390625,0.016990814357995987,0.01506375428289175,-0.18474933505058289,0.18042835593223572,0.21567843854427338,0.2494770586490631,-0.26738622784614563,0.1207520067691803,-0.07949599623680115,0.07284294068813324,-0.269196480512619,0.23922400176525116,-0.057357463985681534,0.025018496438860893}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.23722954094409943,-0.1261315792798996,0.08414269238710403,-0.15803484618663788},{0.20473414659500122,-0.24921981990337372,0.2740328907966614,0.22961090505123138},{-0.27828896045684814,0.04444102570414543,0.11648356169462204,-0.03744896128773689},{0.303035169839859,0.44554319977760315,0.31729191541671753,0.029800958931446075},{-0.28060653805732727,0.1545805186033249,-0.27485227584838867,0.12812447547912598},{0.012969670817255974,-0.09259513765573502,0.09123045951128006,0.32052621245384216},{-0.11362281441688538,-0.1848217397928238,-0.3792254626750946,-0.026275837793946266},{-0.12128293514251709,-0.35958588123321533,0.155213862657547,-0.06097685173153877},{-0.12107273191213608,0.16245579719543457,-0.08455166965723038,-0.10630738735198975},{0.2540757954120636,-0.010771512053906918,-0.11514026671648026,-0.19473198056221008},{0.23001249134540558,-0.20429988205432892,0.30644360184669495,0.24230259656906128},{-0.04830346629023552,0.0034308137837797403,0.40990445017814636,-0.09514258056879044},{-0.30925217270851135,0.2423897087574005,-0.040252041071653366,-0.08736086636781693},{-0.17555077373981476,0.00681954575702548,-0.2201305329799652,0.0636996179819107},{0.20180191099643707,-0.04380164295434952,0.23389938473701477,0.08356671035289764},{-0.14475654065608978,-0.2885179817676544,-0.127360001206398,-0.08681245148181915},{-0.2718890309333801,0.05185140669345856,-0.051766932010650635,0.3022911846637726},{-0.2834072411060333,-0.13906899094581604,-0.22551009058952332,0.20068441331386566},{-0.0846017524600029,-0.12480682879686356,0.38909608125686646,0.06898510456085205},{-0.14441651105880737,-0.16993819177150726,-0.017898596823215485,-0.1778893619775772},{0.16067703068256378,0.12767921388149261,0.1283465474843979,-0.1625320464372635},{-0.007538165431469679,-0.26682108640670776,-0.1622309684753418,0.2790592908859253},{0.286877304315567,-0.16243380308151245,0.18523508310317993,0.03718924894928932},{-0.2762618064880371,-0.07257643342018127,-0.2903149425983429,-0.23854900896549225},{-0.2679787576198578,-0.17177872359752655,0.003281651297584176,-0.12638287246227264},{0.20803411304950714,0.19703997671604156,-0.07369942218065262,0.15133655071258545},{0.18671660125255585,-0.21233637630939484,0.23756296932697296,0.08360327780246735},{-0.04842418432235718,-0.16258180141448975,0.01639939844608307,0.31348079442977905},{0.06253144890069962,0.04505455493927002,0.028490416705608368,0.022592995315790176},{-0.1767316460609436,0.10214164108037949,0.26141974329948425,0.016272732987999916},{-0.1414114534854889,-0.14269405603408813,0.09712619334459305,0.209150493144989},{0.19890888035297394,0.22079022228717804,0.26384103298187256,-0.020909637212753296}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05123794078826904,0.0002708975225687027,-0.011064257472753525,0.046812787652015686,0.041169971227645874,-0.05734936520457268,-0.013659989461302757,0.061732035130262375,-0.06951863318681717,-0.06527084857225418,-0.0004349167866166681,0.04192868992686272,-0.025590697303414345,0.05137871578335762,-0.022456306964159012,-0.028143346309661865};
static const float actor_encoder_self_encoder_2_bias[16] = {0.00928815919905901,-0.011706199496984482,-0.012533419765532017,-0.005342395976185799,-0.04870587959885597,0.019564995542168617,-0.0281184334307909,-0.007018466014415026,0.021702367812395096,-0.03459744155406952,0.004758120514452457,-0.015218924731016159,-0.012659890577197075,-0.030975190922617912,-0.011620131321251392,-0.03521370515227318};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0003414521343074739,0.06076963245868683,-0.018572449684143066,0.013702724128961563,-0.015858905389904976,0.02897677943110466,-0.04162080958485603,-0.011789842508733273,-0.017650434747338295,-0.024169383570551872,-0.003182621207088232,0.030529696494340897,0.01008030865341425,0.010066746734082699,0.048701077699661255,-0.046624891459941864,0.013138200156390667,-0.00747024267911911,0.019581779837608337,-0.03536234796047211,-0.005194696597754955,0.02876324951648712,0.0014468790031969547,-0.04406041279435158,-0.055279381573200226,0.01908354088664055,0.024134812876582146,0.029475415125489235,-0.00919029675424099,0.024866372346878052,0.029767556115984917,0.0019115704344585538};
static const float action_parameterization_distribution_linear_bias[4] = {0.007211759686470032,0.013739796355366707,0.0115009481087327,0.03480563312768936};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.39681047201156616,-0.37974631786346436,-0.1413203626871109,0.22468523681163788,-0.20393025875091553,0.1048629879951477,-0.3291197717189789,0.043930534273386},{0.1984141767024994,0.11080099642276764,0.40072211623191833,0.3818027973175049,-0.12470180541276932,-0.3409433364868164,0.3103475868701935,0.39561235904693604},{0.06796742230653763,0.1698935627937317,0.11135933548212051,-0.0428958535194397,0.33241918683052063,0.22388237714767456,-0.012250123545527458,0.24074749648571014},{0.11605954170227051,-0.36865320801734924,0.33843275904655457,-0.15128731727600098,-0.22739112377166748,0.10578513890504837,0.31779563426971436,0.25462356209754944},{-0.24773752689361572,-0.08316262066364288,-0.042074933648109436,-0.26373690366744995,0.14802497625350952,0.13065725564956665,0.3572721779346466,0.28529423475265503},{-0.05141143128275871,0.19233334064483643,-0.002350127324461937,-0.19114616513252258,0.3478263020515442,0.12460395693778992,0.12260251492261887,-0.16006094217300415},{0.009119541384279728,0.16136115789413452,0.14452190697193146,-0.13975471258163452,0.43680688738822937,-0.10634436458349228,0.16141383349895477,0.10316147655248642},{0.05628608539700508,-0.44895756244659424,-0.0335083082318306,-0.22225171327590942,0.2893463671207428,0.04520751163363457,-0.15853291749954224,-0.3353116810321808},{-0.26077303290367126,0.1583707630634308,-0.000531652185600251,-0.07656005769968033,0.01618478260934353,0.4545614421367645,0.3847024142742157,0.2933972179889679},{-0.0032898576464504004,-0.1431581825017929,-0.27241256833076477,0.28177398443222046,0.2945202589035034,0.32274892926216125,0.35889503359794617,-0.3215692639350891},{-0.16270582377910614,-0.38272562623023987,0.3595584034919739,0.18350745737552643,0.01931065507233143,-0.2606855034828186,0.042576998472213745,-0.335111528635025},{0.24059799313545227,0.03495139628648758,0.41145363450050354,0.40857401490211487,-0.10771458595991135,0.333607941865921,0.22470642626285553,-0.3340175449848175},{-0.3832884132862091,0.13987679779529572,-0.351820707321167,0.4418949484825134,-0.02005755342543125,0.4301920533180237,0.01431670319288969,0.2597056031227112},{-0.06366458535194397,0.1683335304260254,-0.13501444458961487,-0.11374933272600174,0.0157245434820652,0.15901987254619598,0.28443482518196106,-0.004268747288733721},{0.11305694282054901,-0.3508228063583374,-0.354610800743103,-0.17251569032669067,0.1283569633960724,-0.1465238332748413,0.10489153116941452,-0.11365380138158798},{-0.4723154902458191,-0.3536840081214905,-0.2841014862060547,-0.011525477282702923,-0.05073186382651329,0.22935737669467926,0.1816428303718567,-0.11108480393886566},{-0.18523746728897095,-0.330885648727417,0.22860188782215118,-0.36318060755729675,-0.005550823640078306,0.04437026008963585,-0.4423938989639282,-0.30218037962913513},{0.05885671079158783,0.20755894482135773,0.13103801012039185,0.19215834140777588,-0.12189079076051712,0.3355635702610016,0.2583826184272766,-0.22009870409965515},{0.06128419190645218,-0.3506566882133484,-0.08182705193758011,-0.05687857046723366,-0.15165013074874878,-0.3419623374938965,0.022521253675222397,-0.31209796667099},{-0.029451852664351463,-0.006283084861934185,0.10378145426511765,-0.2995833456516266,0.04205185920000076,0.11563394963741302,0.0626758560538292,-0.13829877972602844},{0.10070645064115524,-0.11351960897445679,0.06574591249227524,-0.25438839197158813,-0.006950227543711662,-0.005123733542859554,-0.03791997581720352,-0.25763848423957825},{-0.3068816065788269,0.17442211508750916,0.13750050961971283,-0.23166008293628693,-0.4730897843837738,0.006865662522614002,0.12656456232070923,-0.004735902883112431},{0.2999514639377594,0.10667338222265244,-0.42480507493019104,0.1299845427274704,-0.06711511313915253,0.2202141284942627,0.23085765540599823,0.2806418836116791},{0.02623218297958374,-0.12291242182254791,-0.02275843918323517,0.3212931752204895,-0.319907546043396,-0.0700472965836525,-0.15736401081085205,-0.3259272873401642},{0.22725319862365723,0.07771708816289902,-0.4677460193634033,0.3425976037979126,-0.30775848031044006,-0.3509446680545807,-0.3343104422092438,0.16379503905773163},{0.06332966685295105,0.35134655237197876,-0.3262360394001007,-0.045394446700811386,0.07547742128372192,-0.25673219561576843,0.32506051659584045,-0.2913711369037628},{-0.05521235242486,0.056755181401968,-0.1675177812576294,-0.13228797912597656,0.03125885874032974,-0.18698538839817047,-0.08483298867940903,-0.13801711797714233},{0.1617622822523117,-0.1861434131860733,-0.06260064989328384,-0.08723153173923492,0.006057743914425373,0.0011690827086567879,-0.19063401222229004,0.09113527834415436},{0.3738876283168793,0.040988266468048096,-0.4044061601161957,-0.18103452026844025,-0.25303950905799866,0.10203611105680466,0.2423023283481598,0.07851262390613556},{0.41472476720809937,-0.3100668787956238,-0.03742126375436783,-0.026887327432632446,0.1130676344037056,-0.12810270488262177,0.22079624235630035,0.3423428535461426},{-0.22274164855480194,-0.16840368509292603,0.028657812625169754,-0.2330254167318344,0.3304200768470764,-0.2589340806007385,0.05594155564904213,0.092930369079113},{0.2148815542459488,0.018038306385278702,-0.14818517863750458,0.36211153864860535,0.09327523410320282,0.00814973283559084,-0.02749854326248169,0.03812406584620476}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24343004822731018,0.4056186079978943,-0.6070114970207214,-0.5599238276481628,-0.2640044391155243,0.055102888494729996,-0.4187344014644623,0.5461813807487488},{-0.035644493997097015,0.5403462648391724,-0.2178058624267578,0.5146281719207764,-0.015366647392511368,0.04031600058078766,-0.24379226565361023,-0.002193799940869212},{-0.46225082874298096,-0.2011905163526535,-0.16358016431331635,-0.23589687049388885,0.5258310437202454,0.18006116151809692,0.008024419657886028,0.4296998977661133},{-0.4762730896472931,-0.4459564983844757,0.2889898717403412,0.3683311641216278,-0.5268352031707764,-0.17833088338375092,0.480616956949234,0.2054329812526703},{-0.2933087646961212,-0.3216279447078705,-0.29654842615127563,-0.29427433013916016,0.32024189829826355,-0.2812752425670624,0.49185606837272644,-0.4362953305244446},{-0.0814957246184349,0.16249653697013855,0.30299055576324463,-0.5588569045066833,0.539789080619812,-0.3161914646625519,-0.4185829162597656,-0.3033880293369293},{-0.41334831714630127,0.16080433130264282,0.07469729334115982,-0.35748112201690674,-0.026906294748187065,-0.539703369140625,0.5004709362983704,0.07404201477766037},{-0.3952343165874481,-0.3146822452545166,-0.22425571084022522,-0.42976459860801697,-0.3046402335166931,0.0923718512058258,0.4757069945335388,-0.31242817640304565}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.02836287021636963,-0.04949832707643509,-0.017917629331350327,0.016198616474866867,-0.03480500355362892,-0.01409023255109787,-0.09073437750339508,0.015290924347937107};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012003392912447453,-0.047492194920778275,-0.01214064285159111,0.06395607441663742,-0.02936621569097042,0.032893504947423935,-0.04026627540588379,0.048516809940338135};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

