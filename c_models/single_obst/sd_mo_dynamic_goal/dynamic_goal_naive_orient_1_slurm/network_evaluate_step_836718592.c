#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3715532124042511,-0.21846053004264832,0.36663246154785156,0.15543261170387268,-0.42006775736808777,0.11564706265926361,0.012932167388498783,-0.2064179927110672,0.10884997993707657,0.46188458800315857,0.09589873999357224,-0.01734224706888199,0.16237907111644745,-0.14409944415092468,0.40710124373435974,-0.12875232100486755},{-0.3722069263458252,-0.1883472502231598,0.289264053106308,0.13978512585163116,-0.26958292722702026,-0.006360400468111038,-0.36164039373397827,0.05857762694358826,-0.17644765973091125,-0.1091165840625763,0.1142762303352356,-0.1488998383283615,0.18944773077964783,-0.3407706916332245,-0.2546999752521515,0.103797547519207},{0.16419996321201324,-0.24799323081970215,-0.2448560893535614,0.023089498281478882,0.10638286918401718,0.15404076874256134,-0.07750928401947021,-0.00541662098839879,-0.08412112295627594,-0.19515551626682281,-0.20306800305843353,0.39747118949890137,0.013401865027844906,-0.1539849489927292,-0.34434694051742554,0.21093696355819702},{0.19625410437583923,0.22358816862106323,0.31424272060394287,-0.10369068384170532,-0.32787635922431946,0.005294880364090204,0.1186617910861969,0.11277008056640625,0.5174499154090881,-0.3707445561885834,0.021636566147208214,0.11045762151479721,-0.2737347483634949,-0.08958360552787781,0.3027491867542267,-0.37234196066856384},{-0.0524069108068943,0.12968751788139343,0.21701683104038239,-0.09802964329719543,0.23195748031139374,0.2665233910083771,0.23360198736190796,-0.05113140866160393,-0.09224890172481537,0.23948045074939728,0.3060566186904907,-0.09214150905609131,-0.0802798718214035,-0.35721513628959656,0.34131911396980286,0.1192658543586731},{-0.045169979333877563,-0.17494454979896545,-0.15689758956432343,-0.28581544756889343,0.11721864342689514,0.03478331118822098,-0.04317396879196167,-0.15578272938728333,0.22968214750289917,-0.2141648679971695,-0.32716789841651917,0.19091202318668365,0.37457913160324097,-0.035139381885528564,-0.08419566601514816,0.18773210048675537},{-0.09763048589229584,0.09691116958856583,0.06426091492176056,-0.22282898426055908,0.24712395668029785,0.028494184836745262,0.057364579290151596,0.39700934290885925,0.2646104395389557,-0.0064888084307312965,-0.3679174482822418,0.2897176444530487,-0.041873808950185776,0.17748217284679413,-0.17377519607543945,-0.16850125789642334},{0.02108883671462536,-0.0871901661157608,0.2015073150396347,0.2298356592655182,-0.34968993067741394,0.01194456871598959,0.2742765247821808,0.3422364294528961,-0.023646682500839233,0.18955253064632416,-0.4320169687271118,-0.26710012555122375,0.24022604525089264,0.2420976758003235,0.21373791992664337,0.15630945563316345},{0.35093754529953003,-0.1883232444524765,0.361542671918869,-0.04708053916692734,0.11358363181352615,0.12385691702365875,-0.24720503389835358,-0.24213483929634094,0.20286311209201813,-0.2675755023956299,0.015510586090385914,-0.2830490171909332,-0.19116559624671936,0.3040083050727844,0.15592361986637115,-0.09662216901779175},{0.04712597653269768,-0.18826989829540253,-0.4522099494934082,-0.07939881831407547,-0.3245793581008911,0.2095695585012436,0.3968624770641327,0.1664595752954483,0.4461672008037567,0.427187442779541,0.0038389787077903748,-0.3156598210334778,0.07532577961683273,0.3126274347305298,-0.12423550337553024,-0.3904097080230713},{0.039439838379621506,0.27406013011932373,0.3508252203464508,-0.25260263681411743,-0.29338890314102173,0.21338066458702087,0.21420429646968842,0.32680603861808777,-0.2820897698402405,-0.024613013491034508,-0.03514975309371948,0.17510886490345,-0.2745699882507324,-0.1948367953300476,0.33551663160324097,-0.3769582509994507},{-0.006015531253069639,-0.16624175012111664,0.006904290523380041,0.17082084715366364,0.3509843647480011,0.32219836115837097,0.4196808636188507,-0.03436883166432381,0.012364091351628304,-0.061521466821432114,0.29782360792160034,-0.17105412483215332,0.01766425184905529,-0.25310346484184265,0.3062284588813782,0.2918614149093628},{-0.09688986092805862,0.24184581637382507,0.09098994731903076,-0.3236304521560669,0.0908445492386818,0.10404862463474274,0.35095399618148804,-0.04078561067581177,0.08521872758865356,0.006350046955049038,-0.09854868054389954,0.15831665694713593,0.12697455286979675,0.27593764662742615,0.13724906742572784,-0.30188629031181335},{-0.22597607970237732,-0.25053873658180237,-0.24881459772586823,0.018314816057682037,-0.19155453145503998,0.08881296962499619,-0.2829962968826294,0.0877523347735405,-0.003137953346595168,-0.0512748546898365,-0.27995848655700684,-0.047865867614746094,-0.37528401613235474,0.07573600113391876,0.213395893573761,0.09289409220218658},{-0.2583558261394501,-0.31738755106925964,-0.26579758524894714,0.33644866943359375,0.13655498623847961,-0.3658277988433838,0.2665705680847168,-0.12051399052143097,0.08783628046512604,0.3088725209236145,0.0833849310874939,0.1888197511434555,0.18591736257076263,-0.032087039202451706,-0.20999787747859955,0.23492959141731262},{0.4093649089336395,-0.050854429602622986,-0.2604549527168274,-0.37457993626594543,-0.597098171710968,0.2925962209701538,0.49759116768836975,-0.2913321554660797,0.1353156715631485,0.08001892268657684,-0.28808364272117615,0.10274661332368851,-0.48339101672172546,0.553203821182251,-0.27841901779174805,-0.012937387451529503},{-0.3989683985710144,-0.36750712990760803,0.3932350277900696,0.34256550669670105,-0.2795845568180084,0.24860118329524994,-0.0857478603720665,-0.24404650926589966,0.28159207105636597,-0.41162705421447754,-0.3054446578025818,-0.6566093564033508,-0.2945961356163025,-0.4349309206008911,0.07987571507692337,-0.20641979575157166},{-0.33525988459587097,0.29141223430633545,-0.5467177629470825,-0.01961619220674038,-0.0015679539646953344,0.36182230710983276,-0.38283032178878784,-0.39464932680130005,0.22963927686214447,0.1738036870956421,0.3971947133541107,-0.03222507983446121,-0.23414750397205353,0.24500764906406403,0.18434344232082367,-0.48646119236946106}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06020326167345047,-0.10245639830827713,-0.20972514152526855,-0.41492757201194763,0.35197681188583374,0.2905689775943756,0.06594221293926239,0.07031616568565369,-0.20593562722206116,-0.10997966676950455,-0.06993600726127625,0.059865325689315796,0.2146979570388794,0.43315353989601135,0.0862894207239151,0.0970088317990303},{-0.1555788516998291,-0.22961807250976562,-0.033092889934778214,0.13392046093940735,0.3149779736995697,-0.22436624765396118,0.13165849447250366,0.05098682641983032,-0.05293261632323265,0.2520655691623688,-0.13832911849021912,0.34095877408981323,-0.35426974296569824,0.19507186114788055,-0.33047348260879517,-0.25995269417762756},{0.12155406922101974,0.1863703429698944,-0.31306323409080505,-0.6057676672935486,0.17653930187225342,0.41652536392211914,-0.08270350843667984,0.11704929172992706,-0.25543323159217834,-0.23348692059516907,-0.01953972317278385,0.2705122232437134,-0.2624242901802063,-0.23506012558937073,0.09007217735052109,-0.03154943883419037},{0.18995840847492218,-0.03444080427289009,0.03450501710176468,0.15040850639343262,-0.49907419085502625,0.00806089024990797,0.05672551319003105,-0.27530810236930847,0.3149983882904053,0.3407958149909973,-0.11736695468425751,-0.19721899926662445,-0.42011672258377075,-0.35179635882377625,0.2026977688074112,0.23161378502845764},{-0.10420205444097519,0.07648482173681259,0.03607733175158501,0.33403027057647705,-0.2521589994430542,0.010485568083822727,-0.02433965913951397,0.2190638929605484,0.219606414437294,-0.2867100238800049,0.023726921528577805,0.3701682984828949,0.11624657362699509,-0.4313223361968994,-0.07411938905715942,-0.13011260330677032},{0.15861715376377106,0.12462727725505829,-0.01629106141626835,0.16265951097011566,-0.3398212194442749,-0.40976956486701965,0.18245866894721985,0.2692717909812927,0.13677750527858734,0.40405896306037903,0.21360723674297333,-0.2569437325000763,0.020285209640860558,-0.16979660093784332,-0.08010675013065338,0.29315170645713806},{-0.04478808119893074,0.1445184201002121,0.34570708870887756,-0.34982213377952576,-0.1473376303911209,0.07541573792695999,-0.28242459893226624,-0.05985831841826439,0.13930179178714752,0.07566417753696442,-0.10132256895303726,-0.28828516602516174,-0.21410100162029266,0.0072794342413544655,0.1482621431350708,0.0856638178229332},{-0.15014812350273132,-0.15588271617889404,-0.35267215967178345,0.3033806085586548,-0.22725120186805725,-0.32251691818237305,-0.15416981279850006,-0.32757094502449036,0.0420350655913353,-0.1439763754606247,-0.11705996096134186,0.14679965376853943,-0.197197824716568,0.4243887662887573,-0.08966553956270218,-0.3671814203262329},{-0.18538936972618103,0.27703043818473816,-0.008840031921863556,-0.02693770080804825,0.3126954436302185,-0.20613138377666473,0.40130817890167236,0.11816231906414032,0.2325509488582611,0.3905956745147705,0.23191004991531372,0.3133702576160431,0.2425583153963089,-0.028449110686779022,0.24771758913993835,0.12902092933654785},{0.10114265233278275,-0.2793554663658142,-0.022195786237716675,-0.1255141943693161,0.3241702616214752,-0.04739462584257126,-0.30842676758766174,-0.23693206906318665,0.06295319646596909,-0.44662871956825256,-0.1387888640165329,0.1916884481906891,0.1347820907831192,0.17307668924331665,-0.2922975718975067,0.30412814021110535},{-0.10297690331935883,-0.3376546800136566,0.44420161843299866,0.2374958097934723,0.2333420366048813,0.15016019344329834,0.08128707110881805,-0.14861677587032318,0.116056427359581,-0.19243016839027405,0.012653689831495285,0.40075284242630005,0.25222504138946533,0.13413536548614502,-0.2055654376745224,-0.015575080178678036},{-0.004368089139461517,-0.11443962156772614,0.2710525095462799,0.004461735486984253,-0.1462836116552353,-0.22299031913280487,0.46782419085502625,0.3060874938964844,-0.2639404833316803,-0.36339089274406433,-0.09941896796226501,-0.3333899676799774,0.037715889513492584,-0.34280306100845337,-0.34412169456481934,0.000795622996520251},{-0.0695069208741188,-0.30124855041503906,0.3067835867404938,-0.20507098734378815,0.316266804933548,-0.3088352382183075,-0.333732545375824,0.16636398434638977,0.06646087765693665,-0.06333553791046143,-0.26678353548049927,0.04950098693370819,0.08759313076734543,-0.23471829295158386,-0.33738651871681213,0.01900925301015377},{0.3031061291694641,-0.2877253293991089,0.4372748136520386,0.16961733996868134,0.03660321608185768,0.3105006217956543,-0.06926426291465759,-0.20847569406032562,-0.5000866651535034,0.11802283674478531,0.03939900919795036,-0.37137851119041443,0.003439765190705657,0.20686934888362885,0.33733683824539185,0.046844352036714554},{-0.24194417893886566,0.14233683049678802,0.11974932998418808,-0.31303784251213074,-0.19519685208797455,0.028823833912611008,0.21527689695358276,-0.11655229330062866,0.17290009558200836,-0.3499642610549927,-0.011867612600326538,0.06246274709701538,-0.01774611882865429,0.05573517456650734,-0.11298763006925583,0.025334710255265236},{-0.23504622280597687,0.2927970290184021,-0.3105844259262085,0.34730714559555054,0.1253238022327423,-0.36479824781417847,-0.08418649435043335,-0.10228168964385986,-0.35646358132362366,0.2758573591709137,-0.3041972219944,0.30872225761413574,-0.05718303471803665,-0.1989501714706421,-0.2697356045246124,-0.5196330547332764}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12851107120513916,0.0022940360940992832,-0.04762409254908562,-0.04707397520542145,-0.12134549766778946,0.023358309641480446,0.2787626385688782,0.07061807811260223,-0.12629713118076324,-0.2236790508031845,0.12696969509124756,-0.2693319618701935,-0.17111791670322418,0.22132544219493866,0.22573618590831757,0.28985098004341125,-0.23366910219192505,-0.3211122155189514,-0.17329277098178864,0.0644688606262207,-0.03971479833126068,-0.35645928978919983,-0.24880686402320862,-0.2685144245624542,-0.30167683959007263,0.20005789399147034,-0.2108636498451233,-0.030683333054184914,-0.014044774696230888,0.029114874079823494,0.24021148681640625,-0.16678236424922943},{0.28627339005470276,0.2162763923406601,0.15432217717170715,-0.06420566886663437,0.10389192402362823,-0.0985499769449234,0.27326294779777527,0.13966603577136993,-0.1870155781507492,-0.16886357963085175,-0.04938175901770592,-0.23862458765506744,-0.16827142238616943,0.16704173386096954,-0.19985467195510864,-0.3127876818180084,-0.05630682408809662,0.13447093963623047,-0.27851828932762146,-0.2732158303260803,0.022076623514294624,0.228232279419899,0.10528366267681122,-0.12084123492240906,0.16118690371513367,-0.28649017214775085,0.04093172773718834,0.07073667645454407,0.22581066191196442,-0.10434789955615997,-0.03055226057767868,0.2757645845413208},{0.23287448287010193,0.08752366155385971,-0.03552181273698807,0.09877417236566544,-0.1557958424091339,-0.14314767718315125,-0.21958838403224945,0.13794371485710144,-0.12633323669433594,0.35252243280410767,-0.29257798194885254,-0.21516962349414825,0.16940253973007202,-0.33717143535614014,-0.17587538063526154,0.13064390420913696,-0.08484534174203873,-0.10178927332162857,0.22779347002506256,-0.022095995023846626,0.18281850218772888,0.288776695728302,-0.26655057072639465,0.06514842063188553,-0.17044200003147125,-0.1086440160870552,0.12048754841089249,-0.0402241013944149,-0.08425206691026688,-0.16458335518836975,-0.040455855429172516,-0.15586553514003754},{0.3201901316642761,0.04850424453616142,0.09327719360589981,-0.1373288780450821,-0.2593393325805664,-0.0882309153676033,-0.12589731812477112,0.20946218073368073,0.2400706261396408,-0.19679783284664154,-0.1268206685781479,0.2539242208003998,0.12708552181720734,-0.09688298404216766,-0.2382955402135849,0.31698867678642273,-0.3134068548679352,0.27095717191696167,-0.04867956414818764,0.040659237653017044,-0.06379147619009018,-0.1069827750325203,0.2759348452091217,0.1686231940984726,0.15729543566703796,-0.31079861521720886,0.2919026017189026,-0.20403233170509338,-0.03695867210626602,0.005607013124972582,-0.318325012922287,0.14832836389541626},{-0.029230017215013504,-0.021798783913254738,-0.090796560049057,0.042238056659698486,0.20036356151103973,-0.15364086627960205,-0.37823328375816345,0.013563718646764755,-0.14253832399845123,-0.19682741165161133,0.1644669473171234,0.2266618013381958,-0.10123980045318604,-0.09224879741668701,-0.07419545203447342,0.22027066349983215,-0.041401997208595276,-0.001182463369332254,-0.3349185883998871,-0.03879236429929733,-0.18764670193195343,-0.3261009752750397,0.17415077984333038,0.2340501993894577,-0.060405582189559937,0.2710508406162262,-0.1636970043182373,0.2477046400308609,0.28303730487823486,0.34933412075042725,0.00631781667470932,0.28768807649612427},{-0.2110428363084793,-0.10855209827423096,-0.11303934454917908,-0.0866335779428482,-0.10145407170057297,0.22166910767555237,0.22175832092761993,0.04984106495976448,0.3329319953918457,0.11850845813751221,0.27608057856559753,-0.21807721257209778,-0.13950037956237793,0.2443201243877411,0.24630464613437653,-0.33439674973487854,-0.07603971660137177,-0.23956330120563507,0.23476462066173553,0.1665569394826889,0.06253156810998917,0.13341569900512695,-0.02053694799542427,-0.005993999540805817,-0.3416064977645874,0.3072091341018677,-0.1997939795255661,0.15867319703102112,0.3158862888813019,0.2305411994457245,0.10345382243394852,0.037131693214178085},{0.16198429465293884,-0.127507746219635,-0.13636921346187592,-0.3304404020309448,0.011702717281877995,0.23883987963199615,0.279654860496521,0.12040910124778748,0.10037597268819809,0.2952924966812134,0.0026188897900283337,0.0008046258590184152,-0.443049818277359,-0.12318835407495499,-0.13954609632492065,0.03675570711493492,-0.26617613434791565,-0.21612973511219025,0.17683281004428864,-0.09705212712287903,-0.11947407573461533,-0.1349974125623703,-0.21794576942920685,-0.2607220709323883,0.1814359873533249,-0.26547175645828247,-0.12397421151399612,-0.20248831808567047,0.33485960960388184,0.12121760100126266,-0.17451970279216766,-0.2789807617664337},{0.07694815844297409,0.18789398670196533,0.05393553525209427,-0.11531266570091248,0.1506565809249878,-0.28427332639694214,-0.05513283237814903,-0.14374572038650513,0.009200647473335266,-0.2981715798377991,-0.29293763637542725,-0.08488517254590988,-0.12869982421398163,0.05195292830467224,-0.11481300741434097,0.39430052042007446,0.012307042255997658,-0.1467290222644806,0.13713397085666656,0.32826799154281616,-0.17273962497711182,-0.1965639293193817,0.2786068618297577,0.07822136580944061,0.002202743897214532,-0.3504520356655121,-0.3237646222114563,-0.22399617731571198,-0.3584804832935333,-0.25048330426216125,0.10942481458187103,-0.3659215569496155},{0.034174755215644836,0.37757810950279236,-0.36273717880249023,-0.35201987624168396,-0.26013419032096863,0.05736314132809639,0.08632770925760269,0.08513139188289642,0.13316220045089722,-0.20490379631519318,-0.22785960137844086,0.2705104947090149,-0.3298860788345337,-0.16437050700187683,0.17415989935398102,-0.22747740149497986,0.2116578370332718,0.11307185888290405,0.2696668803691864,0.059633683413267136,0.21882010996341705,0.09663437306880951,0.3115130662918091,-0.11841042339801788,0.4591993987560272,-0.17026948928833008,0.17234575748443604,0.30115318298339844,-0.1947772353887558,0.1055094450712204,-0.00694013899192214,0.0932546928524971},{-0.18256564438343048,0.09856124222278595,-0.3100389242172241,-0.16820544004440308,0.10601179301738739,-0.18454661965370178,0.08316030353307724,0.017380690202116966,0.1583227664232254,0.0055077276192605495,-0.23659762740135193,-0.30837196111679077,-0.3968536853790283,-0.12991516292095184,-0.22009187936782837,0.07913397997617722,-0.004194566048681736,-0.2510151267051697,0.2489783614873886,0.08035477995872498,0.07751157879829407,-0.025930119678378105,0.35826048254966736,-0.2386239916086197,0.32350751757621765,0.1426832675933838,-0.20942173898220062,0.0722808986902237,0.029397111386060715,0.0852033868432045,-0.15793080627918243,0.1525220423936844},{0.07505527883768082,-0.04016277566552162,0.19648700952529907,-0.2630783021450043,-0.22631385922431946,-0.22456610202789307,-0.25143352150917053,-0.09734193980693817,-0.15253689885139465,0.3088482618331909,0.11157296597957611,-0.27988219261169434,-0.3306422531604767,-0.00440590362995863,-0.21164757013320923,-0.2009635865688324,0.26924458146095276,-0.1559346318244934,0.2656048536300659,-0.21635885536670685,-0.18740108609199524,-0.0019467195961624384,0.15212050080299377,0.16962911188602448,0.16564753651618958,-0.13982874155044556,-0.07470602542161942,-0.07716018706560135,-0.061868250370025635,0.03006088361144066,-0.07270130515098572,0.1669178456068039},{-0.21883687376976013,-0.03422359377145767,0.24321888387203217,0.3395780622959137,0.26570814847946167,-0.011696550995111465,0.046724386513233185,-0.2158326953649521,-0.09351523220539093,-0.18324851989746094,0.2848488688468933,-0.24302835762500763,-0.21722136437892914,-0.20857423543930054,0.28447771072387695,0.006073553115129471,-0.02347853220999241,0.019683148711919785,0.3254232406616211,0.08108428865671158,-0.17214490473270416,0.2185039222240448,0.11238140612840652,-0.10834261775016785,0.19281361997127533,-0.09984981268644333,-0.14260165393352509,0.2131335586309433,0.20671233534812927,-0.021547839045524597,-0.27138039469718933,-0.24752195179462433},{0.22721810638904572,-0.2315826117992401,-0.0051541016437113285,-0.34507063031196594,0.1441897451877594,-0.04706565663218498,0.1764269471168518,0.07959312945604324,0.23936831951141357,0.05444757640361786,0.1501317173242569,0.18671771883964539,-0.3742391765117645,-0.22020229697227478,-0.05607815831899643,-0.2170761078596115,-0.11453475058078766,-0.2051483392715454,0.25074824690818787,-0.22741498053073883,0.2537868022918701,0.019673412665724754,-0.009810550138354301,0.1860012263059616,0.1213466003537178,-0.0815340206027031,0.12584896385669708,0.15959987044334412,0.13660520315170288,-0.07344820350408554,-0.1950160264968872,-0.10000953078269958},{0.22062529623508453,-0.03572535514831543,-0.04826601594686508,0.41218459606170654,-0.10353823006153107,-0.1830683797597885,-0.07377496361732483,0.10367004573345184,0.16478051245212555,0.2891898453235626,0.1278616040945053,-0.15172332525253296,0.02110935002565384,0.19869031012058258,-0.09302809089422226,0.058255504816770554,0.21041801571846008,-0.23660919070243835,0.05422361195087433,-0.32784709334373474,0.31150615215301514,0.1626279503107071,-0.05903932452201843,0.18532991409301758,0.18551544845104218,0.08111554384231567,0.0948142483830452,0.07174958288669586,0.05750752240419388,-0.155410036444664,-0.035200584679841995,0.3933309316635132},{0.0358554907143116,-0.27363941073417664,-0.07698388397693634,0.11248660832643509,-0.24658435583114624,-0.010687625966966152,0.059870168566703796,-0.2618969678878784,-0.1592671424150467,-0.06754826754331589,0.1845424324274063,0.15050116181373596,0.08621689677238464,0.257082998752594,-0.05405968800187111,-0.0964542105793953,-0.22611689567565918,0.2596209645271301,-0.08597834408283234,-0.2642902433872223,-0.18595215678215027,-0.08043255656957626,0.1747117042541504,-0.011467061005532742,-0.03973435238003731,-0.07927308976650238,-0.19705452024936676,0.2249281406402588,0.06577688455581665,-0.16757462918758392,0.223138228058815,0.19659516215324402},{0.13946282863616943,-0.22681692242622375,-0.0781523808836937,-0.1851632446050644,-0.08759231865406036,0.16751253604888916,0.035546280443668365,0.24122127890586853,-0.08269111812114716,-0.01012517511844635,0.2637842297554016,0.12144963443279266,-0.037945348769426346,-0.11079037189483643,0.050391849130392075,0.14401371777057648,-0.38948681950569153,-0.28923988342285156,-0.053890641778707504,0.05286813899874687,0.10981953889131546,0.23314949870109558,0.262851357460022,0.14914454519748688,0.04936367645859718,0.22905319929122925,0.019644351676106453,-0.06639653444290161,0.19472497701644897,-0.10494332760572433,-0.23704944550991058,0.3639747202396393},{0.20569413900375366,-0.03825110197067261,-0.2290615290403366,0.15705086290836334,0.08541562408208847,-0.05585309490561485,0.2730179727077484,0.1172267347574234,0.11748379468917847,-0.21512287855148315,0.20707572996616364,-0.17024505138397217,-0.3277073800563812,0.2474679797887802,0.06462923437356949,0.050444163382053375,0.06856651604175568,-0.04323943704366684,-0.13808821141719818,0.0792190209031105,-0.07416237145662308,0.17690932750701904,0.03899902105331421,-0.1289198100566864,0.04134067893028259,-0.32807013392448425,0.02891162596642971,0.4007401466369629,0.20349907875061035,-0.12726587057113647,0.21168000996112823,0.17129023373126984},{-0.09579837322235107,-0.044883791357278824,-0.11069225519895554,-0.04122410714626312,-0.2489195615053177,-0.04403163120150566,0.20869168639183044,0.14930102229118347,0.14568071067333221,0.02586389146745205,0.24055808782577515,-0.0021666809916496277,0.20451708137989044,0.1697116494178772,0.17482692003250122,-0.10783848166465759,0.11205418407917023,0.15808433294296265,0.2253163754940033,0.054965950548648834,0.18137629330158234,0.23622561991214752,0.06108248233795166,0.1347654014825821,-0.02799084410071373,-0.08957428485155106,-0.1056281328201294,-0.2600405514240265,0.16986989974975586,-0.24440932273864746,-0.014620470814406872,-0.020668013021349907},{-0.2749655246734619,0.10712642967700958,-0.2546624541282654,-0.34213531017303467,-0.023127684369683266,0.07456400990486145,0.10082358121871948,-0.08205924928188324,-0.014321851544082165,0.2747496962547302,0.0654771700501442,-0.1935720592737198,0.1222221776843071,-0.1965259164571762,-0.3008353114128113,-0.03503841161727905,-0.1725669503211975,0.16088302433490753,-0.008685419335961342,-0.03863701969385147,-0.3090679943561554,0.1654997020959854,0.10773295164108276,0.02585632912814617,-0.011528597213327885,0.24718435108661652,0.03004201501607895,-0.130349799990654,-0.17830200493335724,0.04333723708987236,-0.10611306130886078,-0.23986610770225525},{0.0070262388326227665,-0.21082137525081635,-0.21589194238185883,-0.015130411833524704,-0.3622785210609436,-0.14211009442806244,0.15953028202056885,-0.2948453724384308,-0.1984962373971939,0.18710801005363464,0.15405286848545074,0.12664569914340973,0.1411709487438202,-0.12142185866832733,0.3167935311794281,-0.32173535227775574,0.0827917754650116,0.24423007667064667,0.06253768503665924,0.23924292623996735,0.04687829315662384,-0.10585437715053558,-0.28160908818244934,0.18593458831310272,-0.1873016357421875,-0.18112464249134064,0.10343965142965317,0.04437556117773056,-0.1135004311800003,-0.28937768936157227,-0.019636545330286026,-0.14011384546756744},{0.24053961038589478,0.20690970122814178,-0.0738639086484909,0.174433633685112,-0.28693854808807373,0.17703372240066528,-0.06885550171136856,-0.12415993213653564,-0.19057555496692657,0.1868867129087448,-0.2577850818634033,-0.15755391120910645,-0.03611662611365318,-0.19945694506168365,-0.36127734184265137,-0.1123235896229744,-0.07827284187078476,-0.2685472369194031,-0.23811094462871552,0.2765004336833954,0.0964413657784462,0.12503699958324432,-0.332903653383255,0.33167320489883423,0.19271333515644073,0.2419578582048416,-0.2820942997932434,-0.02182624489068985,0.06705401837825775,-0.2534630000591278,0.1375705450773239,0.09985429048538208},{-0.0007359785959124565,-0.3262784779071808,0.0244514849036932,-0.2491823136806488,-0.08758213371038437,0.2685209810733795,0.14614121615886688,0.015693416818976402,-0.039280276745557785,-0.003560085082426667,-0.19323430955410004,0.19432751834392548,0.16056033968925476,0.09424035996198654,0.17524272203445435,-0.031261853873729706,-0.07692446559667587,0.09530177712440491,-0.07317099720239639,0.1598118245601654,0.23921746015548706,0.21348246932029724,-0.06690086424350739,-0.2717444598674774,0.06589371711015701,0.09476479887962341,0.2812458574771881,0.12259893119335175,-0.015796490013599396,0.21846245229244232,0.03213745355606079,-0.0954708606004715},{0.024319831281900406,-0.1728963702917099,0.23174570500850677,0.010091083124279976,0.30282899737358093,-0.03166457265615463,-0.11267437040805817,-0.16080030798912048,0.13062043488025665,-0.07188618928194046,0.07042878121137619,0.00019674981012940407,-0.31057846546173096,0.02013675682246685,-0.10153274983167648,-0.2357819527387619,-0.05061957240104675,-0.054624803364276886,0.21580857038497925,0.24265702068805695,0.03780435770750046,0.04025134816765785,0.1808440089225769,0.3437398374080658,-0.150884211063385,-0.041680727154016495,0.2071518450975418,-0.1137671172618866,-0.19863969087600708,-0.2437407225370407,0.29856225848197937,-0.003034283872693777},{0.18126900494098663,-0.07818620651960373,0.018635518848896027,0.14874477684497833,-0.030232129618525505,0.04979746788740158,-0.26785001158714294,0.25005075335502625,-0.05315099284052849,-0.02167419344186783,0.10075534880161285,-0.2833443284034729,-0.023824920877814293,-0.010919230058789253,-0.10191066563129425,0.2621581256389618,-0.09109432250261307,-0.20215556025505066,0.0297032929956913,-0.03099847584962845,-0.17142120003700256,0.20414595305919647,0.2253783941268921,0.20755933225154877,-0.2961139976978302,0.1278405338525772,-0.06933093816041946,0.07926459610462189,-0.28329652547836304,0.26134541630744934,-0.04202250763773918,0.051407549530267715}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.16689468920230865,-0.08717577904462814,0.05657009780406952,-0.11486691236495972},{0.18839101493358612,-0.29615309834480286,0.235566645860672,0.20991364121437073},{-0.1892823427915573,0.08583126962184906,0.03402378410100937,-0.0117403045296669},{0.2808757424354553,0.42979782819747925,0.31629547476768494,0.036511145532131195},{-0.23857921361923218,0.11134962737560272,-0.26783663034439087,0.0782553181052208},{-0.0367993526160717,-0.029799768701195717,0.05239466577768326,0.30575236678123474},{-0.11690690368413925,-0.07632158696651459,-0.2834760248661041,-0.005990135483443737},{-0.12773992121219635,-0.21450011432170868,0.11870276182889938,-0.06336532533168793},{-0.029491877183318138,0.08250747621059418,-0.06075551360845566,-0.07626890391111374},{0.17156177759170532,0.008189312182366848,-0.07764977961778641,-0.11571640521287918},{0.13414067029953003,-0.10092044621706009,0.27278971672058105,0.23168356716632843},{0.023828355595469475,-0.0034711696207523346,0.26279327273368835,-0.08099541068077087},{-0.30856388807296753,0.1926928609609604,-0.02216922864317894,-0.1269349306821823},{-0.15028773248195648,0.085563525557518,-0.1891166716814041,0.06937312334775925},{0.16125285625457764,0.04798673838376999,0.22626827657222748,0.07877252995967865},{-0.11858133226633072,-0.3486234247684479,-0.11784998327493668,-0.08689521253108978},{-0.21069419384002686,0.05157878249883652,-0.09225092083215714,0.24241112172603607},{-0.21499182283878326,-0.11616547405719757,-0.20474521815776825,0.1647518128156662},{-0.06354197859764099,-0.053266674280166626,0.2918298542499542,0.0789572075009346},{-0.16151656210422516,-0.12065631151199341,0.015507562085986137,-0.16457697749137878},{0.1359185129404068,0.09426530450582504,0.10301438719034195,-0.12379984557628632},{-0.0425434410572052,-0.19556429982185364,-0.0809168592095375,0.23075984418392181},{0.3474314212799072,-0.16823115944862366,0.12828874588012695,0.02170235849916935},{-0.29910409450531006,-0.12075532972812653,-0.3068062365055084,-0.3013816773891449},{-0.12694796919822693,-0.14124776422977448,-0.0639365166425705,-0.09340538084506989},{0.11228229105472565,0.09219545125961304,-0.025559263303875923,0.09425659477710724},{0.14213410019874573,-0.15667656064033508,0.2193557471036911,0.06735607236623764},{-0.08171142637729645,-0.12888967990875244,-0.007109120488166809,0.22696453332901},{0.07526467740535736,0.018617071211338043,0.05105011537671089,0.04494042694568634},{-0.12674947082996368,0.11027951538562775,0.19513386487960815,-0.003077511442825198},{-0.19216765463352203,-0.10989045351743698,0.06746941804885864,0.16207018494606018},{0.21380984783172607,0.19853299856185913,0.23166772723197937,-0.038811713457107544}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11882103234529495,-0.0895288959145546,0.03447408601641655,0.09368328750133514,0.09630138427019119,-0.09127414971590042,0.07640165090560913,-0.011487395502626896,-0.061557237058877945,-0.10112437605857849,-0.004137025680392981,0.0682608038187027,-0.024467917159199715,0.06197626143693924,0.09011060744524002,-0.04309257119894028};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02482282742857933,0.058639947324991226,0.03965871036052704,-0.013063647784292698,-0.027672741562128067,0.05985945835709572,-0.058235879987478256,-0.07718582451343536,0.05079852417111397,0.003649687860161066,-0.028128132224082947,-0.03920801728963852,0.014169585891067982,-0.07355973869562149,0.008415997959673405,-0.06576056778430939};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0440666638314724,0.004875784274190664,-0.04950053617358208,0.03366068750619888,0.002469676313921809,0.012626366689801216,-0.05280320346355438,-0.04023802652955055,-0.02093622088432312,-0.016570111736655235,0.015610158443450928,0.040390752255916595,0.04394567385315895,-0.045872800052165985,0.03130996599793434,-0.08274008333683014,-0.008699784986674786,-0.037047162652015686,0.032561857253313065,-0.051525745540857315,0.024439053609967232,-0.00600207457318902,0.03201211616396904,-0.07016055285930634,-0.05823998898267746,0.062245674431324005,0.048418983817100525,-0.028819536790251732,0.07821160554885864,0.031031735241413116,-0.0033272635191679,0.05896756052970886};
static const float action_parameterization_distribution_linear_bias[4] = {0.03542814776301384,0.06749669462442398,0.01246859971433878,0.03297104686498642};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3210274875164032,-0.14324349164962769,-0.012391691096127033,0.1398172378540039,0.015997884795069695,0.008800476789474487,-0.214137464761734,0.045817356556653976},{0.028135767206549644,0.10803928971290588,0.3310074806213379,0.30859166383743286,-0.0936586931347847,-0.22841918468475342,0.29634007811546326,0.11315052956342697},{-0.00030271176365204155,0.20006074011325836,0.020052878186106682,-0.04482408985495567,0.29259535670280457,0.2460528016090393,-0.10825605690479279,0.06171576678752899},{0.09816186875104904,-0.24051210284233093,0.2816254794597626,-0.21707861125469208,-0.3191371262073517,0.021753625944256783,0.19009196758270264,0.16570360958576202},{-0.21919573843479156,0.024966266006231308,0.01861528493463993,-0.2998942732810974,0.07128895819187164,0.025682969018816948,0.2452031373977661,0.27460235357284546},{-0.06119262054562569,0.2933991253376007,-0.06101125106215477,-0.23611332476139069,0.14351396262645721,0.006221303716301918,0.034100960940122604,-0.18964971601963043},{-0.015011289156973362,0.3198438286781311,0.17030659317970276,-0.18855519592761993,0.2119472175836563,-0.2655715048313141,0.25257694721221924,0.06268708407878876},{0.0015562527114525437,-0.18836937844753265,0.100519560277462,-0.08895281702280045,0.32228538393974304,-0.13568814098834991,0.022245241329073906,-0.291427344083786},{-0.16668270528316498,0.2977971136569977,0.15562595427036285,0.028634756803512573,0.04850127920508385,0.21183866262435913,0.41863274574279785,0.3434964418411255},{0.054258305579423904,-0.0542043074965477,-0.2547157108783722,0.4120362102985382,0.26612675189971924,0.15339595079421997,0.18340075016021729,-0.27521470189094543},{-0.12533240020275116,-0.3020882308483124,0.3430376350879669,0.27845489978790283,-0.025636229664087296,-0.3765663504600525,-0.11663985997438431,-0.2866699993610382},{0.3182312250137329,0.06398315727710724,0.3390503525733948,0.4852220118045807,-0.1460902988910675,0.1906200498342514,0.10639327019453049,-0.31580832600593567},{-0.2961845397949219,0.16459231078624725,-0.3606890141963959,0.4005528688430786,-0.03784596174955368,0.2412061095237732,0.005493056960403919,0.25511619448661804},{-0.00990369077771902,0.190773606300354,-0.11957193911075592,-0.1907598078250885,0.034051280468702316,0.07850228995084763,0.31327003240585327,-0.036689095199108124},{0.16181950271129608,-0.3019658923149109,-0.2813599407672882,-0.2162131369113922,0.20913909375667572,-0.16118748486042023,0.22754056751728058,-0.14505748450756073},{-0.3339526355266571,-0.35673609375953674,-0.28453749418258667,-0.06029325723648071,0.01542094349861145,0.12333390861749649,0.17988571524620056,-0.02103985846042633},{-0.23525536060333252,-0.2642340064048767,0.14642156660556793,-0.21795205771923065,0.06032199785113335,0.06568991392850876,-0.40848308801651,-0.25810301303863525},{0.007263083942234516,0.24493154883384705,0.0648360401391983,0.233341246843338,-0.11292341351509094,0.32072484493255615,0.2692681550979614,-0.16597038507461548},{-0.02735200524330139,-0.29536986351013184,-0.08986927568912506,0.03577587008476257,-0.07081222534179688,-0.34208691120147705,0.1041114404797554,-0.23112840950489044},{-0.12531107664108276,0.009262599982321262,0.09667843580245972,-0.23071569204330444,0.11776399612426758,0.03295999765396118,0.08987073600292206,-0.012996300123631954},{0.020310290157794952,-0.059311069548130035,0.08514778316020966,-0.11208713054656982,0.04122119024395943,-0.038109857589006424,0.06355872005224228,-0.1962977945804596},{-0.2909125089645386,0.21185849606990814,0.2013532668352127,-0.2586683928966522,-0.38379979133605957,-0.03941217437386513,0.17249931395053864,0.008617069572210312},{0.28717875480651855,0.050732143223285675,-0.3902929127216339,0.0010599556844681501,-0.10588015615940094,0.2134043276309967,0.15753768384456635,0.24871842563152313},{0.004882464651018381,-0.2358493059873581,-0.0485818088054657,0.1292421668767929,-0.3599625527858734,-0.09223514050245285,-0.3384384512901306,-0.33964255452156067},{0.13470135629177094,-0.09756047278642654,-0.3499144911766052,0.36353611946105957,-0.3172133266925812,-0.12152601778507233,-0.45629268884658813,0.09043025970458984},{-0.004897696897387505,0.2970218360424042,-0.15556104481220245,-0.048884760588407516,0.09269724041223526,-0.15030308067798615,0.24630428850650787,-0.303194522857666},{-0.11444976180791855,0.1021001935005188,-0.04845874756574631,-0.2198350727558136,0.039599962532520294,-0.1397997885942459,-0.1496516317129135,-0.10113321244716644},{0.08818475902080536,-0.16854900121688843,0.0330500490963459,-0.12659941613674164,0.06279932707548141,0.07061629742383957,-0.2743702828884125,0.13222216069698334},{0.20063850283622742,0.0251002199947834,-0.2959803342819214,-0.17555487155914307,-0.1913347989320755,0.16500212252140045,0.174570232629776,0.06539972126483917},{0.28018292784690857,-0.37999317049980164,0.031930360943078995,-0.07414849102497101,0.0841275230050087,-0.10478625446557999,0.13264687359333038,0.22299808263778687},{-0.2946949601173401,-0.22993043065071106,0.04534973204135895,-0.3717969059944153,0.24250401556491852,-0.3870009779930115,-0.0802564024925232,0.0779043510556221},{0.28934788703918457,0.20171426236629486,0.02065565437078476,0.18685583770275116,0.08460144698619843,-0.22651496529579163,-0.07042503356933594,0.1496388465166092}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.20292432606220245,0.40093663334846497,-0.4351465702056885,-0.5019828677177429,-0.16681019961833954,-0.11375030875205994,-0.3585943579673767,0.4678932726383209},{0.0014738953905180097,0.3828943371772766,-0.22136864066123962,0.49044036865234375,-0.030678492039442062,-0.07484723627567291,-0.3199417293071747,-0.03395215421915054},{-0.2967005968093872,-0.2262449711561203,-0.1568414568901062,-0.15529729425907135,0.3993208408355713,0.17674964666366577,-0.0944739282131195,0.39295512437820435},{-0.4643278121948242,-0.4415716528892517,0.29896101355552673,0.19134990870952606,-0.5016041994094849,-0.1958569437265396,0.4012702703475952,0.2009718269109726},{-0.2590004503726959,-0.23564103245735168,-0.2919158935546875,-0.1916828155517578,0.32806435227394104,-0.21966439485549927,0.44741252064704895,-0.3352143466472626},{-0.04501598700881004,0.2802153527736664,0.11852949857711792,-0.5867938995361328,0.5164432525634766,-0.21624669432640076,-0.5045209527015686,-0.34574440121650696},{-0.26306647062301636,0.0907633826136589,0.0509035661816597,-0.4215521812438965,0.05185060575604439,-0.47738927602767944,0.4149826169013977,0.0869414433836937},{-0.306565523147583,-0.16238152980804443,-0.12269875407218933,-0.3586106300354004,-0.3600428104400635,0.08699782192707062,0.5502846837043762,-0.31605008244514465}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.05248807370662689,-0.07794643938541412,-0.09991133958101273,0.02477301098406315,0.13599130511283875,0.031028052791953087,0.10331069678068161,0.0253798458725214};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.017036935314536095,0.012052295729517937,-0.019487492740154266,-0.08126460015773773,-0.06519263982772827,-0.039223890751600266,0.02189985103905201,-0.15639452636241913};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

