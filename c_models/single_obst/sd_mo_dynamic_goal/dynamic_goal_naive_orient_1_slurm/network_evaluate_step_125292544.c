#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3018399477005005,-0.013066486455500126,-0.09793788939714432,0.315319687128067,0.26547756791114807,-0.26028135418891907,-0.33742642402648926,0.09294233471155167,0.29069891571998596,-0.3167773485183716,0.5247877836227417,-0.046166323125362396,0.2507498264312744,0.15032440423965454,-0.4125969707965851,0.045227739959955215},{-0.2541341185569763,-0.2745124399662018,-0.29771503806114197,-0.21556799113750458,0.09040757268667221,0.3318995535373688,0.12021908909082413,0.0991632491350174,0.2131555676460266,0.15953075885772705,-0.11500933766365051,-0.05268052592873573,-0.12216302007436752,0.05972995609045029,0.3153570890426636,-0.30239298939704895},{0.13799582421779633,0.24072334170341492,0.2136532962322235,0.30397605895996094,-0.09348712116479874,-0.18225891888141632,0.3825719356536865,-0.0463428869843483,0.025081906467676163,-0.06855413317680359,-0.09251962602138519,-0.00601588049903512,0.04805752635002136,0.3756730854511261,-0.2736884653568268,-0.12839572131633759},{0.14129069447517395,-0.17237183451652527,-0.11393935233354568,-0.14735926687717438,0.0760507732629776,0.07797780632972717,0.0672122985124588,-0.1935274451971054,-0.16669818758964539,0.13575637340545654,0.45328405499458313,-0.22126814723014832,-0.20335711538791656,-0.11880860477685928,0.20400285720825195,0.1224406287074089},{-0.32709887623786926,-0.009522073902189732,0.11500328779220581,-0.22801266610622406,0.2751760184764862,0.3305452764034271,0.13690578937530518,-0.21879518032073975,-0.17107757925987244,0.15049459040164948,-0.11933103948831558,-0.3816734254360199,-0.054391827434301376,-0.1648298054933548,0.28013908863067627,-0.014048142358660698},{0.036718226969242096,-0.05613123998045921,-0.011604273691773415,-0.08110637217760086,0.12597806751728058,-0.15097777545452118,0.43124181032180786,-0.3160373568534851,-0.14084996283054352,-0.17962490022182465,0.3085061013698578,0.07948336005210876,0.26106247305870056,0.03711138293147087,0.2914541959762573,0.26202088594436646},{-0.25359082221984863,0.18291249871253967,-0.08917640149593353,0.031204383820295334,-0.23420950770378113,-0.1145506277680397,-0.1690380573272705,-0.015539172105491161,0.16986820101737976,0.33859989047050476,-0.32042524218559265,-0.09841198474168777,0.22988751530647278,0.08915272355079651,-0.20138207077980042,0.34562918543815613},{-0.10242031514644623,-0.020647674798965454,-0.08479868620634079,-0.12945060431957245,0.3599449098110199,-0.25661227107048035,-0.251374214887619,-0.4015767574310303,-0.1700664907693863,-0.25677698850631714,0.3541654646396637,-0.00859812367707491,0.19706818461418152,0.16905109584331512,-0.18231134116649628,0.38791629672050476},{0.23302771151065826,0.10341891646385193,0.04195807874202728,0.040050819516181946,-0.3711686432361603,-0.44285348057746887,0.31338831782341003,-0.3399446904659271,-0.1810731440782547,0.1978432983160019,0.1531894952058792,-0.3288460969924927,-0.18645355105400085,0.12100200355052948,0.16973145306110382,-0.010440332815051079},{0.396033376455307,-0.5391794443130493,-0.1793309599161148,-0.0772334635257721,0.17616750299930573,-0.26016050577163696,-0.2541355490684509,-0.24554447829723358,-0.14939744770526886,-0.006924732122570276,-0.03437954932451248,-0.18860021233558655,0.3840133547782898,-0.09772882610559464,-0.4838677644729614,-0.11837729811668396},{0.19131842255592346,0.1957579106092453,-0.30400896072387695,0.11626284569501877,-0.014140760526061058,-0.2813161015510559,-0.15786586701869965,0.11790896952152252,-0.19127602875232697,0.16566477715969086,0.11877936869859695,0.3002355992794037,-0.15022261440753937,0.30957895517349243,-0.09306318312883377,-0.16978885233402252},{-0.4367276132106781,0.24908244609832764,0.2423194944858551,-0.28964394330978394,-0.3925568163394928,0.27274346351623535,0.021762026473879814,0.2774564027786255,0.17253927886486053,0.21145014464855194,0.3252516984939575,-0.05208775773644447,0.046137887984514236,-0.07781537622213364,-0.11825111508369446,-0.15083391964435577},{0.14820030331611633,-0.26349422335624695,-0.21111737191677094,0.2710282504558563,-0.18463842570781708,-0.2657787799835205,-0.17197419703006744,0.30650126934051514,0.26099228858947754,-0.16521576046943665,-0.17876245081424713,0.12052439898252487,0.32481375336647034,0.13404284417629242,-0.175357848405838,0.35492759943008423},{0.30634650588035583,0.1929284781217575,-0.19514894485473633,-0.09494607150554657,0.13022874295711517,-0.13129141926765442,-0.08939974009990692,0.29123371839523315,-0.24866215884685516,-0.2061670869588852,-0.13518695533275604,-0.007740997243672609,-0.2499319612979889,-0.12269237637519836,-0.2738087475299835,-0.05163179337978363},{0.15907113254070282,0.3718818724155426,0.42043057084083557,-0.4260562062263489,-0.3753003180027008,0.05654332786798477,0.08786407113075256,-0.07474756985902786,0.3577771782875061,0.34221798181533813,-0.2085607647895813,0.11226075142621994,-0.01995657943189144,-0.3232552707195282,0.014757316559553146,-0.11983464658260345},{-0.19129003584384918,-0.21603240072727203,-0.14197151362895966,0.39601483941078186,-0.2471407800912857,-0.1668172925710678,-0.2564021050930023,-0.29017534852027893,-0.5976117253303528,-0.2050953209400177,0.3789205551147461,0.31860947608947754,-0.6217083930969238,-0.3570708930492401,-0.6389304399490356,-0.12731754779815674},{-0.5211371183395386,0.16501367092132568,-0.4299737811088562,-0.06850304454565048,-0.41898781061172485,0.24304573237895966,0.4830014407634735,0.11055422574281693,0.450613796710968,-0.43626850843429565,0.17581559717655182,-0.34675493836402893,-0.14225473999977112,-0.023079736158251762,-0.16725881397724152,-0.21077217161655426},{0.2931843101978302,-0.5961939692497253,0.2989373505115509,0.33655357360839844,-0.12318045645952225,0.49941307306289673,0.317878782749176,0.2798580527305603,-0.13351663947105408,-0.3270251750946045,-0.12788531184196472,-0.16883546113967896,-0.05012879893183708,-0.48972007632255554,0.1730266809463501,-0.09192720055580139}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04811180382966995,0.312872976064682,0.2385644167661667,-0.12874510884284973,-0.22239747643470764,0.07212521135807037,-0.03141475096344948,0.30897051095962524,-0.09629497677087784,0.32581639289855957,0.45972952246665955,-0.3823641240596771,0.0020669857040047646,0.037469685077667236,0.024298716336488724,-0.12519598007202148},{-0.4840371906757355,0.19806057214736938,-0.24602095782756805,0.28857696056365967,0.28451067209243774,-0.18225686252117157,-0.3252568244934082,-0.2024574726819992,0.35171857476234436,0.2539149820804596,-0.06357551366090775,0.2668127417564392,-0.42132875323295593,0.19913263618946075,-0.2548912465572357,0.4779329001903534},{-0.3074381649494171,0.12781782448291779,-0.36411482095718384,0.1789635270833969,-0.45819514989852905,-0.30368292331695557,0.08820416033267975,0.1329921931028366,-0.2781565487384796,0.42565280199050903,0.27766719460487366,-0.20256294310092926,0.1994699090719223,-0.2984350919723511,-0.17308805882930756,-0.10374415665864944},{0.3624463975429535,-0.24764424562454224,0.13182984292507172,0.41853490471839905,-0.42110520601272583,-0.3171911835670471,0.30269479751586914,0.055636897683143616,0.29116857051849365,-0.07561808079481125,0.354367733001709,0.08499814569950104,-0.21079428493976593,-0.022316932678222656,0.01803252287209034,-0.46252429485321045},{-0.40763363242149353,-0.059119515120983124,0.1674429476261139,-0.2858319878578186,0.15758001804351807,0.4726112484931946,-0.27398982644081116,0.2986823618412018,-0.22384211421012878,0.2246430218219757,-0.03770304471254349,0.0015407424652948976,-0.2448459267616272,-0.017367517575621605,-0.279636949300766,-0.13139532506465912},{0.08184945583343506,-0.3194654583930969,0.017240159213542938,-0.33648955821990967,0.21798057854175568,0.043053701519966125,-0.15720108151435852,-0.059595413506031036,-0.12978246808052063,0.4090098738670349,0.23521463572978973,-0.02412189356982708,-0.2783261239528656,0.07518840581178665,0.023818768560886383,-0.3111104965209961},{0.2800036668777466,-0.15698060393333435,0.3575717508792877,-0.2819811999797821,-0.3978530764579773,-0.08225488662719727,-0.3695457875728607,0.34463611245155334,-0.08094783127307892,-0.24903321266174316,-0.21920709311962128,-0.01742931455373764,-0.03749940171837807,-0.1068115159869194,0.501768171787262,-0.35954606533050537},{-0.289238303899765,0.38126954436302185,-0.05343310907483101,0.18710868060588837,-0.0376846082508564,-0.22531381249427795,-0.20747490227222443,0.060874003916978836,0.021965116262435913,0.5305533409118652,0.1246078610420227,-0.11538814753293991,0.06570923328399658,-0.2348410040140152,0.12705183029174805,0.15746387839317322},{0.09671172499656677,0.2720000743865967,-0.16324709355831146,-0.35611480474472046,0.3582096993923187,-0.2002750039100647,0.12063553929328918,-0.3176310658454895,0.1642443835735321,0.12157852947711945,0.08956332504749298,0.13790790736675262,0.0450783409178257,-0.4575304687023163,-0.017710406333208084,0.1957300901412964},{-0.2862491011619568,0.07077047973871231,-0.3194500803947449,-0.365885853767395,0.23274807631969452,-0.40535691380500793,-0.16999195516109467,0.2926352322101593,-0.17680519819259644,0.14599952101707458,-0.04811416566371918,-0.08941154927015305,-0.3883315920829773,0.09980367124080658,-0.26898643374443054,-0.2795920670032501},{-0.13343150913715363,-0.1450243443250656,0.0016794485272839665,-0.23539714515209198,-0.3138338029384613,-0.0436498261988163,0.17803095281124115,-0.431947261095047,-0.001751646981574595,-0.12377870827913284,0.2775959074497223,-0.07559163123369217,0.3138587176799774,0.1971132904291153,0.2151889055967331,0.231204092502594},{-0.060127995908260345,-0.02443302795290947,-0.4053939878940582,0.32828253507614136,0.11215938627719879,0.1099858433008194,0.26493874192237854,0.16564752161502838,-0.4513375163078308,0.17455369234085083,-0.3114801049232483,-0.23044900596141815,-0.34335386753082275,0.4115317165851593,-0.34939825534820557,0.06705033034086227},{-0.20785270631313324,-0.5019316077232361,-0.13505150377750397,0.18040378391742706,-0.22262921929359436,-0.03227430582046509,-0.0844794288277626,0.39869990944862366,0.48113974928855896,0.15534168481826782,-0.021024176850914955,-0.20080357789993286,0.173086479306221,-0.4068368673324585,0.11211050301790237,-0.22390347719192505},{-0.32041841745376587,-0.44005221128463745,-0.19382824003696442,-0.16374847292900085,-0.4451275169849396,0.5329903364181519,-0.16278232634067535,0.20694221556186676,-0.10871905833482742,-0.23734307289123535,-0.3640202581882477,0.4599814713001251,-0.20317989587783813,-0.06589338928461075,-0.2759974002838135,0.37816768884658813},{-0.41936302185058594,0.32133811712265015,-0.23414456844329834,0.1198640912771225,-0.41147327423095703,0.2240649312734604,-0.12918101251125336,-0.27296239137649536,0.15129336714744568,0.27346882224082947,-0.2889070212841034,0.08460333943367004,0.20783916115760803,-0.40771111845970154,-0.33448269963264465,-0.14268174767494202},{-0.143008753657341,-0.3657999038696289,-0.47681480646133423,0.258226215839386,0.07977801561355591,0.08555769920349121,-0.2576736807823181,0.21992024779319763,-0.35590848326683044,-0.2592845857143402,-0.31860098242759705,0.22448161244392395,-0.195914164185524,0.13220417499542236,0.07355460524559021,0.2762252688407898}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10490778833627701,-0.06337212026119232,0.07904283702373505,-0.15022380650043488,-0.13312575221061707,0.09500149637460709,0.1698635220527649,-0.23744164407253265,-0.10149836540222168,0.29553306102752686,0.09095632284879684,0.16419807076454163,0.11618462949991226,0.18724195659160614,-0.19509361684322357,0.1377003788948059,0.11980163305997849,-0.36463770270347595,-0.2911219596862793,-0.10425165295600891,-0.16357675194740295,0.13330183923244476,-0.2479121834039688,0.29170554876327515,-0.07183527946472168,0.006373283918946981,0.17188335955142975,0.18810272216796875,-0.26747697591781616,-0.22610026597976685,0.25369992852211,0.3019794523715973},{0.2391338050365448,-0.03895540162920952,0.15722982585430145,-0.0924685075879097,-0.1267518252134323,0.254894495010376,-0.020449163392186165,-0.07311180979013443,-0.05620884895324707,-0.016605662181973457,-0.13079777359962463,0.02672046609222889,0.4083172678947449,0.1716914027929306,0.15681973099708557,0.10555394738912582,-0.2700941860675812,-0.36239033937454224,0.12061232328414917,0.026644831523299217,0.051992785185575485,0.2982844412326813,0.23219801485538483,-0.2467285394668579,0.07128751277923584,0.28818753361701965,-0.3035378158092499,0.1934562623500824,0.14967039227485657,-0.23349586129188538,-0.04144439101219177,-0.011486799456179142},{-0.12708717584609985,-0.03580299764871597,0.20857080817222595,-0.1991703063249588,-0.2585567831993103,-0.003627360798418522,-0.19997838139533997,0.1971968710422516,0.19549182057380676,-0.04596621170639992,-0.13464802503585815,0.05515911802649498,0.30059921741485596,-0.1746368557214737,0.07203912734985352,-0.04769958555698395,-0.3433971405029297,0.24774904549121857,-0.31454792618751526,-0.036245815455913544,0.0020222223829478025,-0.1312352418899536,-0.08441249281167984,-0.11935292929410934,0.046056944876909256,0.36753737926483154,-0.024545129388570786,0.07841379195451736,0.24118685722351074,-0.3461776375770569,-0.17411333322525024,-0.03603013977408409},{0.16905823349952698,-0.19162707030773163,0.06529820710420609,-0.3830834925174713,0.17712704837322235,-0.08490031212568283,-0.040793277323246,0.25674664974212646,0.04349837824702263,0.22054775059223175,0.069529689848423,-0.15075142681598663,-0.20701275765895844,-0.09494854509830475,0.29739439487457275,-0.24310466647148132,0.061496302485466,-0.10286923497915268,-0.14654873311519623,0.10024575144052505,-0.14861150085926056,0.10165294259786606,-0.1956527829170227,0.29096755385398865,-0.3248193562030792,0.047584157437086105,-0.09482201933860779,-0.22609330713748932,0.02166389301419258,0.059212133288383484,0.24197539687156677,-0.10785360634326935},{0.2306542843580246,0.0011421811068430543,0.03547385334968567,0.27188289165496826,-0.283334344625473,-0.07363490015268326,0.15176978707313538,-0.0969521552324295,0.09450705349445343,-0.20741601288318634,0.0043478477746248245,-0.05114089697599411,-0.10948151350021362,-0.09429775178432465,0.29802078008651733,0.3189210295677185,-0.10970152914524078,-0.34340688586235046,0.17860348522663116,-0.07630817592144012,-0.14527490735054016,0.22716157138347626,0.27494654059410095,0.05730942264199257,-0.037804752588272095,-0.10814125090837479,-0.03531758859753609,0.25592803955078125,0.24049851298332214,0.1004779040813446,0.07921338826417923,-0.29874691367149353},{0.2974297106266022,-0.17779219150543213,0.07531740516424179,0.06960660964250565,-0.16138991713523865,-0.29647886753082275,-0.17021508514881134,-0.2804293632507324,-0.26601430773735046,-0.017233023419976234,0.026010660454630852,-0.053658343851566315,-0.17587634921073914,-0.024439672008156776,-0.22718150913715363,-0.25784850120544434,0.20192097127437592,0.048980966210365295,-0.2666025459766388,0.22619745135307312,-0.007971515879034996,-0.25110989809036255,0.20718254148960114,-0.14219269156455994,-0.1458955705165863,-0.27155765891075134,-0.10404845327138901,0.1054973304271698,0.09229104220867157,0.2774420976638794,-0.3220381736755371,0.15041382610797882},{0.22315573692321777,0.03170163556933403,0.24414514005184174,-0.19360584020614624,0.2536970376968384,-0.14128290116786957,-0.2705863118171692,0.01472062524408102,0.3050333857536316,0.21977384388446808,-0.19571708142757416,0.07090643793344498,0.09452042728662491,0.3375825881958008,0.13582880795001984,-0.10806003957986832,-0.2015901505947113,0.14396484196186066,-0.023034442216157913,0.014478437602519989,-0.14193002879619598,0.28473758697509766,0.1841200888156891,0.21642981469631195,-0.29351508617401123,-0.2789367139339447,-0.28098806738853455,-0.39870595932006836,-0.008548441343009472,-0.08494794368743896,0.27644655108451843,0.15430031716823578},{0.3339996039867401,-0.3560071587562561,0.14943981170654297,-0.41151025891304016,-0.2513786256313324,0.34876853227615356,0.42074063420295715,0.19153626263141632,-0.10466877371072769,0.06470430642366409,0.173625648021698,-0.18002167344093323,0.11488114297389984,0.29502955079078674,-0.017714977264404297,0.2039661407470703,0.41383418440818787,-0.18508291244506836,-0.04745060205459595,-0.2977316677570343,0.15387938916683197,0.24115337431430817,0.286923885345459,0.1829213798046112,0.05686487630009651,0.07013323158025742,0.09814765304327011,0.24447757005691528,-0.20516175031661987,-0.18974006175994873,0.2394031286239624,0.01114095002412796},{-0.06316310912370682,-0.0037097057793289423,0.22608625888824463,0.2617037296295166,-0.21799083054065704,-0.4049552381038666,-0.06322570890188217,0.22121460735797882,-0.20354564487934113,-0.35451674461364746,0.1569976657629013,0.15540489554405212,0.08508334308862686,-0.286349356174469,0.1030891090631485,-0.16837473213672638,-0.16781288385391235,0.13396859169006348,-0.24352316558361053,0.28464797139167786,-0.2243322730064392,-0.44111743569374084,-0.3222774565219879,0.18760935962200165,0.15091854333877563,0.16737619042396545,0.28209391236305237,0.23149055242538452,-0.14079558849334717,-0.3359564542770386,-0.1694371998310089,0.15371187031269073},{0.37985679507255554,-0.002011388773098588,-0.006504311691969633,0.13637162744998932,0.1065749004483223,0.2820100486278534,0.01865256205201149,0.3717617988586426,-0.07166022807359695,0.12082293629646301,0.13582132756710052,0.04983432963490486,-0.24058203399181366,-0.468535453081131,0.13945350050926208,0.19734863936901093,0.10754392296075821,-0.16501587629318237,-0.032889820635318756,-0.12592630088329315,0.16180261969566345,-0.35380953550338745,0.292792946100235,0.017200330272316933,-0.10447447001934052,0.1422041952610016,-0.30031874775886536,-0.15133260190486908,0.07853752374649048,0.03769668936729431,0.1691499799489975,0.32656317949295044},{-0.1009003221988678,0.07887587696313858,-0.16048097610473633,0.17051295936107635,-0.13956782221794128,0.2643915116786957,0.07394633442163467,-0.06128815934062004,0.34751325845718384,-0.2639828026294708,-0.17925578355789185,0.18238221108913422,-0.1405765265226364,0.03897666558623314,-0.3157588839530945,-0.033212997019290924,0.09750690311193466,0.14195796847343445,0.012373428791761398,-0.16600467264652252,-0.2603815197944641,0.21879898011684418,0.1723092645406723,0.19819462299346924,-0.2776576280593872,0.388663113117218,-0.07850954681634903,-0.040959689766168594,-0.1387745589017868,0.09738023579120636,0.25940996408462524,0.2871943414211273},{-0.2901538610458374,0.35320958495140076,-0.018269561231136322,0.0204487144947052,-0.23008790612220764,-0.24642464518547058,0.17345266044139862,-0.31665414571762085,-0.11970384418964386,-0.3882853090763092,-0.1007210910320282,-0.039515893906354904,0.15192660689353943,-0.23061394691467285,-0.13566133379936218,-0.3025757074356079,-0.18209898471832275,-0.034940410405397415,0.3728547692298889,-0.26245617866516113,0.1707703322172165,-0.2919788956642151,0.0548139251768589,0.2504536807537079,-0.11583107709884644,0.17661118507385254,0.23461602628231049,-0.06078638508915901,-0.006416755262762308,0.30181458592414856,-0.23701868951320648,-0.3193928301334381},{-0.01182442158460617,0.22809170186519623,0.16400708258152008,-0.26031115651130676,0.257924348115921,0.0025525304954499006,-0.17092344164848328,-0.01580558717250824,0.19595462083816528,-0.23826740682125092,-0.10612396150827408,0.06552810221910477,0.16571198403835297,-0.02007400617003441,0.05160962790250778,-0.06652659177780151,0.20017260313034058,-0.3172852396965027,0.27929314970970154,0.021772418171167374,-0.19785688817501068,0.24308790266513824,-0.1482500582933426,-0.2616652846336365,0.24519295990467072,-0.046927276998758316,0.0440029576420784,-0.10898183286190033,0.093023382127285,-0.17700371146202087,0.3610369563102722,0.2997646927833557},{0.03488864749670029,-0.28032004833221436,-0.21207575500011444,0.05119418352842331,-0.05873645469546318,0.29447534680366516,-0.1497116982936859,-0.3959430158138275,0.3870237469673157,0.06708640605211258,0.023994212970137596,0.04009448364377022,-0.040236443281173706,0.2756718397140503,-0.2419251948595047,-0.3846513330936432,0.02093367464840412,0.07165033370256424,0.14430463314056396,0.5111604332923889,-0.32272669672966003,0.2458581030368805,-0.17270943522453308,0.16174712777137756,0.18168576061725616,-0.37827423214912415,-0.16200262308120728,-0.4002649486064911,-0.24369294941425323,-0.1765684336423874,0.12992919981479645,-0.467290997505188},{-0.14039765298366547,0.37758445739746094,-0.016333242878317833,-0.1464158296585083,-0.20789344608783722,-0.3112993538379669,0.0638866126537323,-0.15826822817325592,0.37885093688964844,-0.05577443912625313,0.19829024374485016,0.28929200768470764,0.010196542367339134,0.09301786124706268,-0.17518994212150574,0.15452298521995544,-0.21547634899616241,-0.44167086482048035,-0.39779597520828247,0.07853395491838455,0.11625222116708755,-0.19913294911384583,-0.42275646328926086,-0.29295167326927185,-0.08011358976364136,0.2056116908788681,0.428254097700119,0.015790294855833054,-0.12348364293575287,-0.04098690301179886,-0.02934575453400612,0.11362363398075104},{-0.2466522604227066,-0.18526166677474976,-0.191216841340065,0.06602980941534042,-0.2654265761375427,-0.1471574902534485,-0.09367400407791138,-0.1559794545173645,-0.31298550963401794,-0.26398444175720215,0.20002858340740204,0.15842701494693756,-0.2654908001422882,0.2962079644203186,-0.05075511336326599,0.1610606610774994,0.07229786366224289,0.03602413833141327,0.06071560084819794,0.1845286637544632,0.18884766101837158,0.26528680324554443,0.12662410736083984,0.27549293637275696,0.11359189450740814,-0.24111251533031464,-0.1896379441022873,0.22381483018398285,-0.07209934294223785,-0.19041360914707184,-0.18913833796977997,-0.22962091863155365},{-0.25927138328552246,-0.18972337245941162,-0.3439563810825348,0.11419384181499481,-0.079854317009449,-0.058657754212617874,-0.1105872243642807,0.13015598058700562,-0.08118632435798645,0.08320804685354233,-0.2354118973016739,0.021560944616794586,0.16841235756874084,-0.10374610126018524,0.06292938441038132,0.2327824831008911,-0.1342022567987442,-0.15673358738422394,0.18690015375614166,0.058400023728609085,0.19337183237075806,-0.016104253008961678,-0.19342876970767975,0.04068261384963989,0.20400020480155945,-0.25803229212760925,0.13053256273269653,0.08629737794399261,0.09724082052707672,-0.1463259756565094,0.24339742958545685,-0.05254914239048958},{0.24189502000808716,-0.032656192779541016,0.017758779227733612,0.15844137966632843,-0.3244498670101166,-0.020370034500956535,0.12252134084701538,0.19215013086795807,-0.07073104381561279,-0.14658507704734802,0.3160868287086487,-0.13939373195171356,0.036060310900211334,-0.02451246790587902,-0.16138271987438202,0.2345140427350998,-0.009479984641075134,-0.09101489931344986,0.10520341247320175,-0.2833596467971802,-0.002398774726316333,-0.2667864263057709,-0.20837907493114471,0.2523762881755829,-0.06177010014653206,-0.07294315844774246,0.14796312153339386,0.022574445232748985,-0.1846035122871399,-0.053097743541002274,-0.07029429078102112,-0.0720972791314125},{0.31250977516174316,-0.06803742796182632,0.09912247955799103,0.0373435840010643,-0.020992062985897064,-0.09109224379062653,0.19753161072731018,-0.22594662010669708,0.25314998626708984,0.3015715777873993,0.02808891423046589,0.13537858426570892,0.23233424127101898,0.3373960256576538,-0.2866826355457306,-0.3331755995750427,-0.25475358963012695,0.07350847125053406,-0.14946261048316956,-0.2804015576839447,-0.16241224110126495,0.25724175572395325,0.06253579258918762,0.13659922778606415,-0.14761264622211456,-0.12188313901424408,-0.13822007179260254,-0.22881415486335754,0.2581176161766052,0.1929791122674942,-0.31598374247550964,-0.12757804989814758},{-0.12731319665908813,0.15403033792972565,0.26462337374687195,-0.05806351453065872,-0.05363006889820099,0.04303660988807678,-0.015426736325025558,-0.32244959473609924,0.20510438084602356,0.22983597218990326,0.18552565574645996,0.23229393362998962,-0.23293280601501465,0.22306951880455017,-0.2954857349395752,0.28695884346961975,0.17524398863315582,-0.25240081548690796,0.23165561258792877,0.1068594753742218,-0.316582053899765,0.3100874722003937,-0.28992342948913574,0.13748985528945923,0.2548442482948303,0.27800533175468445,0.09107744693756104,0.13739807903766632,-0.18731938302516937,0.21197792887687683,-0.057379283010959625,0.10961165279150009},{-0.11309462785720825,-0.11350065469741821,0.005459409672766924,0.17466458678245544,0.028237786144018173,0.21752001345157623,-0.27328526973724365,-0.08400513976812363,-0.12914036214351654,-0.07085118442773819,-0.16794846951961517,-0.1777580976486206,0.01570003107190132,-0.1976493000984192,0.09015507251024246,-0.20102937519550323,0.24655401706695557,-0.036026731133461,-0.3235197961330414,-0.2836436927318573,0.12790745496749878,0.16469775140285492,-0.18881945312023163,0.2984391450881958,-0.2586953043937683,0.06729400157928467,0.1193341463804245,-0.08394822478294373,0.16155104339122772,-0.21790987253189087,0.3221498429775238,0.16727401316165924},{0.32977479696273804,0.04088282585144043,0.11489065736532211,0.1929033249616623,-0.21312877535820007,0.1853807419538498,-0.06537188589572906,0.1875220239162445,0.07985982298851013,0.05150363966822624,0.09358280152082443,-0.34613606333732605,-0.2747439742088318,0.012567060999572277,0.10877328366041183,-0.07080431282520294,0.2685680091381073,0.1591319441795349,-0.16028271615505219,-0.22375580668449402,0.3264426290988922,0.1832519918680191,0.27458181977272034,0.09184891730546951,-0.04420579969882965,0.03544294834136963,-0.07641357183456421,-0.1582939475774765,0.29145893454551697,0.05181167647242546,-0.1950182467699051,0.11913391947746277},{-0.014096428640186787,0.017949093133211136,-0.05999194085597992,-0.23414257168769836,-0.08795724809169769,-0.22640961408615112,-0.22923028469085693,-0.1475498229265213,-0.008138278499245644,-0.013960701413452625,-0.27430659532546997,0.023130664601922035,-0.2212449312210083,-0.14565040171146393,0.006279978901147842,0.0992933139204979,0.2669885456562042,-0.18062524497509003,-0.3376815915107727,0.2590186893939972,-0.18659701943397522,0.28789541125297546,0.022738538682460785,-0.0312986858189106,0.039813823997974396,0.15473276376724243,-0.08426861464977264,-0.2555578351020813,0.21964147686958313,0.2449341118335724,-0.12541182339191437,0.18102848529815674},{-0.264994740486145,-0.03613733872771263,0.03708828240633011,-0.03635979816317558,0.08741729706525803,0.12842699885368347,-0.1724701076745987,0.11944004893302917,-0.1692313402891159,-0.18067920207977295,0.11728735268115997,-0.14024096727371216,-0.20775839686393738,0.23252101242542267,0.0007063522934913635,0.010891544632613659,0.2124866396188736,-0.23594239354133606,-0.1637112945318222,0.2732425332069397,0.04842490330338478,0.21445655822753906,-0.047667745500802994,0.013773595914244652,-0.2763633728027344,-0.17925812304019928,0.02316240966320038,0.2834594249725342,-0.007569503504782915,0.010123622603714466,0.2655014991760254,0.29357150197029114}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.05574767664074898,0.24530573189258575,0.4574573040008545,-0.06568209081888199},{0.14319555461406708,-0.16497735679149628,0.06550715863704681,0.24825097620487213},{-0.1847834587097168,0.17111165821552277,0.15441080927848816,0.14193719625473022},{0.3072434663772583,0.012363235466182232,0.05788214132189751,0.4894806742668152},{-0.11407238990068436,0.10704725235700607,0.4039496183395386,-0.08534809201955795},{-0.11330706626176834,0.28178587555885315,0.27293866872787476,-0.15938153862953186},{-0.33796313405036926,-0.03304841369390488,0.022490395233035088,-0.13311520218849182},{-0.4243822693824768,-0.170308917760849,0.4643668532371521,-0.3216148912906647},{0.4240940809249878,-0.14632602035999298,-0.330780029296875,-0.459648072719574},{0.06699631363153458,0.34449198842048645,0.3976605236530304,-0.5228589177131653},{-0.22811450064182281,-0.20585961639881134,-0.2618163228034973,0.1972847431898117},{0.474763423204422,-0.22757694125175476,-0.059062473475933075,0.2227865308523178},{0.3423757553100586,0.28285133838653564,-0.0578608401119709,0.13507013022899628},{0.034072790294885635,0.1439518928527832,-0.36230581998825073,-0.020242741331458092},{0.12053858488798141,0.3302138149738312,0.46639078855514526,0.35716691613197327},{0.2012600600719452,0.021334292367100716,0.3273743689060211,0.2701926827430725},{-0.29950210452079773,-0.10662544518709183,-0.10332439094781876,-0.3119998574256897},{-0.26603013277053833,0.16584515571594238,-0.17257772386074066,-0.10708555579185486},{-0.25658419728279114,0.2560447156429291,0.19681338965892792,0.3732563257217407},{-0.02898222953081131,0.386726051568985,-0.24620921909809113,0.09084252268075943},{-0.3500468134880066,-0.42880475521087646,-0.07962117344141006,0.07322180271148682},{0.41946786642074585,0.5626900792121887,0.029582593590021133,-0.37927141785621643},{-0.08343987911939621,0.2362673133611679,0.27655455470085144,0.19459979236125946},{-0.12110337615013123,0.42422476410865784,-0.07441585510969162,-0.18337805569171906},{0.05631891265511513,-0.0512627549469471,-0.14000187814235687,0.05408133566379547},{0.3370891511440277,-0.5377406477928162,-0.010132620111107826,0.054595597088336945},{0.007610898464918137,-0.4449264705181122,-0.24237671494483948,-0.22749797999858856},{0.11051316559314728,-0.2107113003730774,0.20648929476737976,0.25397270917892456},{0.001756843295879662,-0.0707804262638092,0.15754158794879913,0.07312824577093124},{-0.43674299120903015,0.3730247914791107,0.26679015159606934,-0.05858580768108368},{0.4042753279209137,-0.14249300956726074,0.24244308471679688,-0.13652034103870392},{0.0953252986073494,-0.4868519604206085,0.48215076327323914,-0.3617158830165863}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.05998922511935234,-0.023528896272182465,0.049276839941740036,-0.04276217892765999,-0.02984422817826271,-0.13343337178230286,-0.12986651062965393,0.051263172179460526,0.053245607763528824,-0.007041944656521082,0.08451791852712631,0.05935246869921684,-0.08904073387384415,-0.12547266483306885,0.06677017360925674,-0.08296597748994827};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06999912112951279,0.07257610559463501,0.02604035474359989,0.013899321667850018,0.08018393069505692,-0.019150443375110626,0.09727711975574493,-0.03132658079266548,-0.030521655455231667,0.01313022617250681,-0.01614569127559662,-0.03882206231355667,0.06732487678527832,-0.029304062947630882,-0.04488737881183624,-0.022876447066664696};
static const float actor_encoder_feed_forward_0_bias[32] = {0.0710747018456459,0.06330779939889908,0.025218022987246513,0.07520511001348495,0.04564056172966957,-0.004387738648802042,-0.04890909045934677,-0.030825313180685043,-0.02482564002275467,0.01123143918812275,-0.061417173594236374,0.03725018352270126,0.06872360408306122,-0.05823389068245888,0.09087607264518738,0.08018365502357483,-0.07782723754644394,-0.06010613590478897,0.030460724607110023,0.015959931537508965,-0.06350938975811005,0.025206683203577995,0.08441687375307083,0.005498229525983334,-0.026376618072390556,-0.0018036096589639783,-0.06793969124555588,0.04470287635922432,0.03886500746011734,0.015750836580991745,0.032138265669345856,0.019960302859544754};
static const float action_parameterization_distribution_linear_bias[4] = {0.04449612647294998,0.03228537365794182,0.05137363821268082,0.05106090381741524};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.027788911014795303,0.21298739314079285,-0.17109128832817078,0.20911985635757446,0.22625577449798584,0.08500748127698898,0.30115216970443726,-0.027433378621935844},{-0.2613691985607147,-0.09576404839754105,-0.3197871744632721,-0.22873862087726593,-0.3048486113548279,-0.21769921481609344,-0.10404564440250397,-0.20545169711112976},{-0.30942094326019287,-0.01253148727118969,0.2041255682706833,0.2259332239627838,0.26076510548591614,-0.03681560233235359,0.27540063858032227,-0.13851627707481384},{-0.032193392515182495,0.053773876279592514,-0.20771518349647522,-0.00961338821798563,0.0002779213828034699,-0.07001857459545135,0.2718938887119293,-0.21808770298957825},{-0.3513953387737274,-0.16284450888633728,-0.24580654501914978,-0.13854560256004333,-0.028956888243556023,0.15663282573223114,0.172415629029274,-0.06274047493934631},{-0.3339967429637909,-0.04207507520914078,0.36645975708961487,0.24120476841926575,0.19713094830513,-0.13319632411003113,-0.13742105662822723,-0.14289477467536926},{-0.2195487767457962,0.028103593736886978,0.3924770653247833,-0.21772867441177368,-0.08412512391805649,-0.41948553919792175,-0.08971654623746872,-0.14404937624931335},{-0.2991583049297333,-0.377027302980423,0.47747692465782166,-0.10392092168331146,-0.183742955327034,0.21151089668273926,0.1755639612674713,-0.24765092134475708},{-0.31650006771087646,0.2653084099292755,-0.1929635852575302,0.35607707500457764,0.11589974910020828,-0.343548983335495,0.06511884182691574,0.0621543787419796},{-0.3084578812122345,-0.3274442255496979,-0.17619866132736206,-0.21166303753852844,-0.5026566982269287,0.10273011028766632,-0.014040530659258366,0.11394697427749634},{0.17377634346485138,0.33575865626335144,0.21293021738529205,-0.024108074605464935,0.18730424344539642,0.10718441009521484,-0.2189273089170456,0.18025758862495422},{0.19844332337379456,0.040705129504203796,0.2932535707950592,0.2505577802658081,-0.2973068952560425,0.2758449912071228,0.0027375477366149426,-0.26274269819259644},{0.11217086017131805,-0.293785959482193,0.27714991569519043,-0.03432701900601387,-0.3280473053455353,-0.09378916025161743,-0.17646512389183044,-0.1395222246646881},{-0.210368350148201,-0.18972648680210114,0.29918646812438965,0.351455956697464,-0.2315613329410553,-0.07447689026594162,-0.3152385652065277,0.1980288028717041},{0.042947281152009964,-0.16271300613880157,0.05801784619688988,-0.23883472383022308,-0.3514287769794464,-0.13896866142749786,0.20743055641651154,0.02498079277575016},{0.16788777709007263,-0.01894320547580719,-0.07044824212789536,-0.2993754744529724,-0.04855399578809738,0.062106356024742126,0.003041887190192938,0.4068554639816284},{-0.004005752969533205,-0.20983269810676575,-0.19541426002979279,0.06798996031284332,-0.14849774539470673,-0.10786515474319458,-0.12116149812936783,0.07804200053215027},{-0.16390903294086456,-0.2633521258831024,0.05539459362626076,0.02851119264960289,0.17657318711280823,-0.1925690770149231,0.36940664052963257,0.1287842094898224},{0.04087589308619499,0.12374190986156464,-0.23837056756019592,0.11056017130613327,0.1398254781961441,0.19005870819091797,-0.2113737165927887,0.3125435709953308},{0.16832926869392395,-0.03569220378994942,-0.347886323928833,0.07462448626756668,-0.038498613983392715,-0.046361930668354034,-0.3068193197250366,-0.03243245556950569},{0.0688609629869461,-0.12346228957176208,0.06210320070385933,-0.1239551305770874,0.3219251036643982,0.027297673746943474,-0.06782201677560806,0.4099058210849762},{0.027727102860808372,0.15277114510536194,-0.2532523274421692,0.2197127640247345,0.31952497363090515,0.32377585768699646,0.15999877452850342,-0.32649919390678406},{-0.3967857360839844,-0.09948330372571945,0.16700462996959686,-0.08689621835947037,0.2088519185781479,-0.31392160058021545,0.18536485731601715,-0.26712286472320557},{-0.13997533917427063,0.06544969975948334,-0.043592244386672974,-0.39198732376098633,0.24351951479911804,-0.022549297660589218,-0.3720509707927704,0.1959693431854248},{-0.20725853741168976,-0.1723393350839615,-0.007831186056137085,0.10867001861333847,-0.049630306661129,0.14196036756038666,0.27127015590667725,-0.06647665798664093},{-0.21485839784145355,0.0666249617934227,-0.36295464634895325,-0.2615624964237213,0.1446923166513443,-0.0029337401501834393,-0.10967978835105896,0.10492026060819626},{0.3182346820831299,0.3902305066585541,-0.2803584039211273,0.18296849727630615,0.18143869936466217,0.3454423248767853,-0.30537348985671997,-0.13004827499389648},{0.3692428171634674,0.25753435492515564,0.07843440771102905,0.07604269683361053,0.23327702283859253,0.13725905120372772,0.22190621495246887,0.38620907068252563},{-0.12854979932308197,0.3915634751319885,0.17119035124778748,0.002986355684697628,0.20832206308841705,0.0382913276553154,-0.38471731543540955,-0.29301145672798157},{-0.16905857622623444,-0.2201964557170868,0.07901663333177567,-0.23560622334480286,-0.30971547961235046,-0.17251823842525482,0.26533305644989014,-0.049647942185401917},{0.3949897289276123,-0.27762484550476074,0.30473238229751587,-0.27463671565055847,0.07392016798257828,0.2684437334537506,0.14732249081134796,-0.20456279814243317},{0.23341061174869537,0.3905900716781616,0.35457929968833923,-0.23583199083805084,-0.16613483428955078,0.11396929621696472,0.20662473142147064,0.08329132944345474}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.029920950531959534,0.41548317670822144,-0.18840593099594116,0.23627425730228424,-0.42135781049728394,0.25649604201316833,0.414897084236145,0.05313060060143471},{-0.426797091960907,-0.5071913003921509,-0.376163512468338,-0.4470943808555603,-0.4363502562046051,0.3825482428073883,0.4634920358657837,-0.4239223599433899},{-0.0022703076247125864,-0.15427212417125702,0.1100395992398262,0.07181548327207565,-0.07453794032335281,0.44100695848464966,-0.360079288482666,-0.3718154728412628},{0.507187008857727,0.02508814074099064,0.08394945412874222,-0.0283961184322834,0.5562329292297363,0.4043409526348114,0.3379473090171814,0.39770421385765076},{0.07688012719154358,0.25203484296798706,-0.12375283241271973,-0.09483438730239868,0.08181166648864746,-0.38886114954948425,-0.3656359016895294,0.45116692781448364},{0.3924071788787842,0.06698313355445862,0.04276649281382561,-0.3997398316860199,-0.429186075925827,-0.49906566739082336,-0.10776667296886444,0.5267132520675659},{-0.4839867949485779,-0.3394351601600647,-0.061480168253183365,-0.2526038885116577,0.0036449769977480173,0.46572279930114746,-0.5474529266357422,0.5933293104171753},{0.2725759446620941,0.09222748130559921,-0.012713534757494926,-0.02168274112045765,0.41088297963142395,-0.5919934511184692,0.43559160828590393,-0.4027077853679657}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.056567080318927765,0.008408169262111187,0.03506343066692352,-0.012855724431574345,-0.02843482978641987,0.009466417133808136,0.0004544922849163413,0.024755563586950302};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.024089816957712173,-0.04862058907747269,0.03001170977950096,-0.06737801432609558,0.000568291696254164,-0.03147169575095177,-0.014805096201598644,-0.07383266091346741};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

