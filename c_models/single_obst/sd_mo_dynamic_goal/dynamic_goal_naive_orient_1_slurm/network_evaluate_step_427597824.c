#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.33259424567222595,-0.22837090492248535,0.3323967456817627,0.15990613400936127,-0.3844999670982361,0.13166114687919617,0.013970386236906052,-0.22953329980373383,0.07541178911924362,0.46724528074264526,0.11021488159894943,0.018783966079354286,0.157506063580513,-0.14381350576877594,0.33978909254074097,-0.1107400432229042},{-0.35152414441108704,-0.2760200500488281,0.28364187479019165,0.16923929750919342,-0.2486467957496643,-0.014880492351949215,-0.33710572123527527,0.06371147930622101,-0.21165712177753448,-0.1184360682964325,0.15229737758636475,-0.1493278443813324,0.20583979785442352,-0.38944095373153687,-0.2088802456855774,0.08816487342119217},{0.1479843556880951,-0.2525632977485657,-0.25498318672180176,0.05297522246837616,0.12659446895122528,0.15509063005447388,-0.07700520008802414,0.001393814105540514,-0.10980348289012909,-0.1882655769586563,-0.195408895611763,0.406498521566391,-0.010879779234528542,-0.15810713171958923,-0.3932897746562958,0.22537080943584442},{0.15429836511611938,0.15467076003551483,0.3311489522457123,-0.07290668040513992,-0.3307523727416992,-0.029271189123392105,0.1614479422569275,0.12512531876564026,0.48236778378486633,-0.38714051246643066,0.012236407026648521,0.14400792121887207,-0.2891429662704468,-0.05406849831342697,0.3407256305217743,-0.40055710077285767},{-0.03825521469116211,0.09948534518480301,0.22929678857326508,-0.12004462629556656,0.2432914674282074,0.24095040559768677,0.25406840443611145,-0.057999007403850555,-0.038448844105005264,0.2210673689842224,0.3129166066646576,-0.16133344173431396,-0.09580790996551514,-0.3430783152580261,0.3734202980995178,0.13732101023197174},{-0.02751917764544487,-0.2105027586221695,-0.1412421464920044,-0.2310812771320343,0.11013592034578323,0.057964034378528595,-0.0287337563931942,-0.16627755761146545,0.19322651624679565,-0.23037587106227875,-0.3008125424385071,0.2030617892742157,0.37985125184059143,-0.021040786057710648,-0.05421106144785881,0.150628924369812},{-0.08733197301626205,-0.004187118262052536,0.06417308002710342,-0.23923569917678833,0.2040306180715561,0.03695306554436684,0.07813369482755661,0.33718547224998474,0.28960707783699036,0.01843159832060337,-0.3211982846260071,0.2310323566198349,-0.09593511372804642,0.20452645421028137,-0.18127228319644928,-0.16802679002285004},{-0.01574558950960636,-0.0019067928660660982,0.256451815366745,0.2037259191274643,-0.38224703073501587,0.011471845209598541,0.31548041105270386,0.29220813512802124,-0.05276922881603241,0.1822066307067871,-0.48143577575683594,-0.30699318647384644,0.23025113344192505,0.2743026316165924,0.22160905599594116,0.1862485557794571},{0.3185584843158722,-0.26699015498161316,0.3519102931022644,-0.014564208686351776,0.15881961584091187,0.09815429896116257,-0.16457167267799377,-0.22034089267253876,0.13739655911922455,-0.28838083148002625,0.027268867939710617,-0.308223158121109,-0.18146003782749176,0.29440784454345703,0.16304035484790802,-0.1022442951798439},{0.07371020317077637,-0.31987297534942627,-0.48785513639450073,-0.0374930165708065,-0.3317926526069641,0.21443510055541992,0.3836316466331482,0.18456216156482697,0.44250044226646423,0.3700372576713562,0.022541359066963196,-0.2795957326889038,0.10187269002199173,0.3089554011821747,-0.08929029107093811,-0.384495347738266},{0.02380295842885971,0.235144704580307,0.4093780517578125,-0.29880091547966003,-0.3019544780254364,0.21845118701457977,0.18108069896697998,0.3459436595439911,-0.2997948229312897,-0.03993156552314758,-0.02261003479361534,0.15415620803833008,-0.305831640958786,-0.207394540309906,0.3584064841270447,-0.3426295220851898},{0.11173484474420547,-0.10663649439811707,-0.013379378244280815,0.17385587096214294,0.3397603929042816,0.3128172755241394,0.451946496963501,-0.022897513583302498,0.04142145439982414,-0.04024828225374222,0.26978620886802673,-0.14174368977546692,-0.05815492197871208,-0.2412337213754654,0.2693723142147064,0.2694149315357208},{-0.1302253156900406,0.26679372787475586,0.12824463844299316,-0.29755035042762756,0.08959122747182846,0.13900727033615112,0.3276634216308594,-0.053935084491968155,0.12443825602531433,-0.020584870129823685,-0.1058669462800026,0.13493318855762482,0.17040398716926575,0.28406620025634766,0.13232339918613434,-0.28290295600891113},{-0.2568349540233612,-0.2521698474884033,-0.2151561677455902,-0.017385195940732956,-0.18817375600337982,0.1002451628446579,-0.338113933801651,0.07689494639635086,-0.04117082059383392,-0.06315188109874725,-0.2799544632434845,-0.06409171968698502,-0.36601367592811584,0.08993352949619293,0.22747428715229034,0.11364443600177765},{-0.19447040557861328,-0.3952292203903198,-0.235137477517128,0.36218997836112976,0.06797676533460617,-0.3401801884174347,0.3202337324619293,-0.11205271631479263,0.015045389533042908,0.2920033037662506,0.10606250166893005,0.17424912750720978,0.16466496884822845,-0.01701226830482483,-0.17955736815929413,0.2030773162841797},{0.4831331670284271,-0.0219771396368742,-0.24121497571468353,-0.40042972564697266,-0.566794216632843,0.2764222025871277,0.4472956657409668,-0.2788454294204712,0.14124330878257751,0.09453018754720688,-0.272384375333786,0.06858235597610474,-0.5273736715316772,0.5233474373817444,-0.274496465921402,0.012630007229745388},{-0.3821718990802765,-0.33324873447418213,0.401214599609375,0.36279502511024475,-0.30824220180511475,0.34011390805244446,-0.09543758630752563,-0.3104567527770996,0.27760636806488037,-0.4372329115867615,-0.3123584985733032,-0.6682838201522827,-0.28666505217552185,-0.44824135303497314,-0.00269298255443573,-0.17959584295749664},{-0.423959344625473,0.2562909424304962,-0.537363588809967,-0.027313439175486565,0.010365801863372326,0.35333195328712463,-0.3560239374637604,-0.4137997627258301,0.24604083597660065,0.24591544270515442,0.42259863018989563,-0.06270107626914978,-0.21048107743263245,0.3008962571620941,0.14456315338611603,-0.5068181157112122}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.09912809729576111,-0.11204445362091064,-0.17526550590991974,-0.40459972620010376,0.39749976992607117,0.26248088479042053,0.05696921795606613,0.0916350781917572,-0.26014840602874756,-0.11996404826641083,-0.10611222684383392,0.005800415761768818,0.22777149081230164,0.48377564549446106,0.12810955941677094,0.07969819009304047},{-0.18398933112621307,-0.2685769498348236,-0.016794653609395027,0.14414836466312408,0.3189411163330078,-0.24111045897006989,0.1493448168039322,0.03956522420048714,-0.07616543024778366,0.2552201747894287,-0.1436000019311905,0.3588370680809021,-0.35849541425704956,0.2249906361103058,-0.3515055179595947,-0.25906139612197876},{0.1584305465221405,0.22723498940467834,-0.39112693071365356,-0.5964621901512146,0.17631079256534576,0.46330150961875916,-0.10784094035625458,0.10588904470205307,-0.2683195173740387,-0.23545117676258087,-0.031856849789619446,0.2770271301269531,-0.32148295640945435,-0.2682238221168518,0.1499333530664444,-0.042473744601011276},{0.2017316371202469,-0.05104736611247063,0.07939565926790237,0.16145609319210052,-0.5003381967544556,0.02940293215215206,0.03300757706165314,-0.274608314037323,0.3320258557796478,0.34845468401908875,-0.13506951928138733,-0.20303812623023987,-0.4030565023422241,-0.3503957688808441,0.209819957613945,0.22956311702728271},{-0.1885576844215393,0.05940650776028633,0.05684126913547516,0.30949831008911133,-0.2529125213623047,0.002991184126585722,-0.03238772973418236,0.21074733138084412,0.23657575249671936,-0.29150450229644775,0.034700360149145126,0.39371317625045776,0.13887539505958557,-0.4159644544124603,-0.09206611663103104,-0.12972493469715118},{0.23777249455451965,0.203170046210289,-0.016442155465483665,0.17687946557998657,-0.34789955615997314,-0.40522703528404236,0.2328052967786789,0.2762826085090637,0.10346490889787674,0.4729402959346771,0.25238025188446045,-0.2589297294616699,0.02525039203464985,-0.15101981163024902,-0.04206090793013573,0.3328983783721924},{-0.04274825379252434,0.1481887549161911,0.3787180781364441,-0.3423702120780945,-0.1528237909078598,0.05993069335818291,-0.2994592487812042,-0.060983311384916306,0.10256283730268478,0.10514853149652481,-0.12225572019815445,-0.2836044430732727,-0.26204267144203186,0.06153229624032974,0.18692652881145477,0.08042474091053009},{-0.16114875674247742,-0.15210501849651337,-0.40286001563072205,0.26775625348091125,-0.2753676772117615,-0.31341752409935,-0.1715637892484665,-0.3354685306549072,0.02202168107032776,-0.17541177570819855,-0.11797740310430527,0.1679552048444748,-0.2218349575996399,0.4150807857513428,-0.11529754102230072,-0.39457839727401733},{-0.23652330040931702,0.27856674790382385,0.012678157538175583,-0.02119801566004753,0.3150325417518616,-0.23247691988945007,0.4089314937591553,0.1300235390663147,0.2585262954235077,0.383649080991745,0.2844828963279724,0.27303212881088257,0.2665594518184662,-0.03322036936879158,0.2879216969013214,0.13774646818637848},{0.12466548383235931,-0.29810211062431335,-0.011898180469870567,-0.1216040849685669,0.3255503177642822,-0.050490234047174454,-0.2928882837295532,-0.23165567219257355,0.05106426775455475,-0.4606766700744629,-0.1764710545539856,0.2120264768600464,0.15119324624538422,0.18468371033668518,-0.31718599796295166,0.28149428963661194},{-0.15856705605983734,-0.3571817874908447,0.465850293636322,0.22293603420257568,0.2336200475692749,0.16623258590698242,0.09867922961711884,-0.16634374856948853,0.14045648276805878,-0.22163139283657074,0.005663936957716942,0.43314018845558167,0.3305232524871826,0.13649973273277283,-0.20220732688903809,-0.0032068132422864437},{0.02396693080663681,-0.16139066219329834,0.2845526337623596,0.020305290818214417,-0.13236843049526215,-0.225118950009346,0.4618381857872009,0.2946246266365051,-0.272901713848114,-0.38987812399864197,-0.11872150003910065,-0.31598830223083496,0.0016016436275094748,-0.33234861493110657,-0.36483484506607056,-0.006783721037209034},{-0.02734101377427578,-0.3099554479122162,0.3018864691257477,-0.21609030663967133,0.28344354033470154,-0.3053247034549713,-0.3696953356266022,0.17285288870334625,0.0961885154247284,-0.028832275420427322,-0.2903956472873688,0.08999994397163391,0.06724026054143906,-0.2876189947128296,-0.3674984872341156,-0.009171741083264351},{0.3094416558742523,-0.28679996728897095,0.45556187629699707,0.15228095650672913,0.033183787018060684,0.2891879081726074,-0.06284764409065247,-0.20532631874084473,-0.5194640755653381,0.11894205212593079,0.016825184226036072,-0.38528797030448914,0.00484872329980135,0.2240070104598999,0.3318277895450592,0.04046202823519707},{-0.23862026631832123,0.15876008570194244,0.11523539572954178,-0.3218787610530853,-0.2149871587753296,0.042765162885189056,0.24301661550998688,-0.1302705705165863,0.16327357292175293,-0.3608646094799042,-0.0031652902252972126,0.05743205174803734,-0.025622984394431114,0.059059854596853256,-0.09263508766889572,0.0022325967438519},{-0.20550809800624847,0.3210279941558838,-0.3275904655456543,0.33288782835006714,0.1517888754606247,-0.36404716968536377,-0.14215460419654846,-0.08424050360918045,-0.3968348503112793,0.2836206257343292,-0.3819272220134735,0.31616443395614624,-0.07031845301389694,-0.15784594416618347,-0.2776774764060974,-0.532993733882904}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.16007767617702484,0.022488337010145187,-0.06954716891050339,-0.028642764315009117,-0.11719559133052826,0.020045068114995956,0.286793977022171,0.03904500603675842,-0.12597814202308655,-0.2004963606595993,0.11684492975473404,-0.3048461675643921,-0.2131294459104538,0.22800873219966888,0.21383017301559448,0.28550758957862854,-0.25765591859817505,-0.30855968594551086,-0.20725850760936737,0.037712667137384415,-0.035746052861213684,-0.3527858555316925,-0.23436403274536133,-0.2842260003089905,-0.3084530234336853,0.21896818280220032,-0.24259567260742188,-0.04426656663417816,-0.013566461391746998,0.00028142277733422816,0.20889049768447876,-0.16382744908332825},{0.2569030225276947,0.2304115891456604,0.1282120794057846,-0.07734748721122742,0.09656420350074768,-0.08410096168518066,0.2863636016845703,0.12058685719966888,-0.19701257348060608,-0.15209296345710754,-0.05272301658987999,-0.2685887813568115,-0.17074532806873322,0.1888986974954605,-0.20500466227531433,-0.3173965513706207,-0.04708535969257355,0.14984290301799774,-0.33227062225341797,-0.29400399327278137,0.009055676870048046,0.25523316860198975,0.12966305017471313,-0.11060015112161636,0.14912447333335876,-0.27350249886512756,0.028511755168437958,0.09336069971323013,0.21151962876319885,-0.13081352412700653,-0.030540363863110542,0.24788258969783783},{0.24424099922180176,0.07200143486261368,-0.05142882838845253,0.13310645520687103,-0.17742903530597687,-0.17548513412475586,-0.2555173933506012,0.1502455472946167,-0.12436885386705399,0.3732006847858429,-0.28795796632766724,-0.18448056280612946,0.14798857271671295,-0.3856823444366455,-0.1527189314365387,0.12088901549577713,-0.13060340285301208,-0.13211588561534882,0.26670998334884644,-0.03604903072118759,0.2192114144563675,0.24964569509029388,-0.25251492857933044,0.028498094528913498,-0.1871320903301239,-0.10643867403268814,0.1461157351732254,-0.0777319073677063,-0.06774850189685822,-0.16215413808822632,-0.0676424652338028,-0.11737179756164551},{0.33311113715171814,0.07922451198101044,0.08856242150068283,-0.13946552574634552,-0.2625369429588318,-0.07360918074846268,-0.14409328997135162,0.25038546323776245,0.23995256423950195,-0.21556955575942993,-0.0949808657169342,0.2862399220466614,0.10538910329341888,-0.1230202242732048,-0.23123516142368317,0.309902548789978,-0.30894529819488525,0.2379685491323471,-0.008976250886917114,0.056316882371902466,-0.059607360512018204,-0.10033632814884186,0.2770402133464813,0.16381804645061493,0.17087122797966003,-0.32376453280448914,0.3250393569469452,-0.1953105628490448,-0.02163393422961235,0.028205297887325287,-0.29604020714759827,0.1591988205909729},{-0.02309124730527401,-0.0556647926568985,-0.07264092564582825,0.05795435234904289,0.1973762810230255,-0.18449103832244873,-0.3752320110797882,-0.011168618686497211,-0.12933199107646942,-0.18989913165569305,0.14559783041477203,0.23170864582061768,-0.06589500606060028,-0.08197476714849472,-0.0761798769235611,0.21262328326702118,-0.05477917194366455,-0.006252049934118986,-0.33226895332336426,-0.05205636844038963,-0.17092682421207428,-0.3624718189239502,0.16705156862735748,0.23561517894268036,-0.06856270879507065,0.2779114246368408,-0.17464002966880798,0.21885497868061066,0.2941146492958069,0.36523133516311646,-0.0136570418253541,0.3012443780899048},{-0.22073939442634583,-0.10317596793174744,-0.15241365134716034,-0.05340797081589699,-0.1511087715625763,0.22919709980487823,0.2123604565858841,0.03596063330769539,0.31785422563552856,0.13058529794216156,0.2847670912742615,-0.2158260941505432,-0.16551600396633148,0.23760519921779633,0.27694812417030334,-0.3479294180870056,-0.10892446339130402,-0.2419966161251068,0.2240448147058487,0.1302483230829239,0.09350382536649704,0.12508517503738403,0.011115503497421741,-0.024139633402228355,-0.360573947429657,0.30807632207870483,-0.20264150202274323,0.14553874731063843,0.3451305329799652,0.22695313394069672,0.08005903661251068,0.06542268395423889},{0.17965368926525116,-0.14372925460338593,-0.12571074068546295,-0.34089967608451843,0.008618033491075039,0.2231956124305725,0.27987486124038696,0.1285327672958374,0.11349315196275711,0.3176012933254242,-0.01046801172196865,0.0012767370790243149,-0.3990512490272522,-0.1273794323205948,-0.1536472588777542,0.050361111760139465,-0.28133073449134827,-0.21156978607177734,0.16414451599121094,-0.08474602550268173,-0.12338966131210327,-0.14455366134643555,-0.23160552978515625,-0.2486150860786438,0.19732335209846497,-0.27164608240127563,-0.12515108287334442,-0.21824699640274048,0.32520055770874023,0.11909060180187225,-0.17467960715293884,-0.28443628549575806},{0.06441563367843628,0.17800003290176392,0.0584103986620903,-0.1322467029094696,0.15618664026260376,-0.2912668287754059,-0.053030308336019516,-0.16601893305778503,0.008694552816450596,-0.2801034450531006,-0.3090636432170868,-0.10396161675453186,-0.11029326170682907,0.06624055653810501,-0.13363434374332428,0.40234965085983276,0.009524327702820301,-0.13745173811912537,0.113710418343544,0.325600802898407,-0.19958053529262543,-0.18464519083499908,0.2800695598125458,0.07740490883588791,0.004679767414927483,-0.3329794704914093,-0.334185928106308,-0.21431554853916168,-0.3862166106700897,-0.2687574625015259,0.10771629214286804,-0.3850862681865692},{0.043796852231025696,0.43314340710639954,-0.39176133275032043,-0.3654601275920868,-0.3107104003429413,0.12332270294427872,0.0584661103785038,0.13906975090503693,0.051608823239803314,-0.24008075892925262,-0.16321945190429688,0.3110351264476776,-0.37824201583862305,-0.2304120659828186,0.21179094910621643,-0.2293950468301773,0.2223552167415619,0.1184493824839592,0.34432992339134216,0.06590345501899719,0.20741719007492065,0.15882767736911774,0.3561846613883972,-0.15147536993026733,0.45688802003860474,-0.20034900307655334,0.24053873121738434,0.36944448947906494,-0.18069668114185333,0.11811953037977219,0.03265346214175224,0.11400135606527328},{-0.24577836692333221,0.10043937712907791,-0.3896702527999878,-0.17811784148216248,0.10829471796751022,-0.24096991121768951,0.12656985223293304,-0.031814903020858765,0.19299021363258362,0.08640222996473312,-0.27109819650650024,-0.3620924651622772,-0.4386691451072693,-0.11583472043275833,-0.25779780745506287,0.10410068184137344,-0.04803703725337982,-0.27123257517814636,0.17242839932441711,0.0568603053689003,0.09004819393157959,-0.02148214355111122,0.3942437767982483,-0.20071154832839966,0.3301547169685364,0.18409276008605957,-0.23457595705986023,0.03492667153477669,0.014424034394323826,0.015727311372756958,-0.2269824743270874,0.1358247697353363},{0.0961621105670929,-0.007493157871067524,0.15695253014564514,-0.28950628638267517,-0.26612770557403564,-0.22619245946407318,-0.2532815635204315,-0.0535808689892292,-0.18240509927272797,0.3443116247653961,0.1355447918176651,-0.27332666516304016,-0.35540786385536194,-0.03909355401992798,-0.21989688277244568,-0.14917562901973724,0.23009710013866425,-0.15334515273571014,0.26660776138305664,-0.20109546184539795,-0.19641640782356262,0.037396494299173355,0.1997521072626114,0.1701756864786148,0.20594258606433868,-0.15766993165016174,-0.040047742426395416,-0.06354697793722153,-0.0556931234896183,0.0047164615243673325,-0.06603802740573883,0.16445280611515045},{-0.21609918773174286,-0.04569334536790848,0.23138485848903656,0.3104029595851898,0.26470863819122314,0.0019271236378699541,0.07137449830770493,-0.21419669687747955,-0.10092202574014664,-0.19656455516815186,0.28524547815322876,-0.2394450604915619,-0.2055238038301468,-0.19022731482982635,0.28716376423835754,0.0022318612318485975,-0.0036638332530856133,0.025301853194832802,0.3353584408760071,0.08686317503452301,-0.18738748133182526,0.24623748660087585,0.10991854965686798,-0.08462506532669067,0.21036440134048462,-0.11122677475214005,-0.13317321240901947,0.24159248173236847,0.20759934186935425,-0.015879401937127113,-0.2658466398715973,-0.25946807861328125},{0.24688509106636047,-0.247598335146904,-0.00722872419282794,-0.35691240429878235,0.1292964667081833,-0.08957699686288834,0.16347575187683105,0.08633149415254593,0.25899064540863037,0.08324360102415085,0.1266816258430481,0.19688256084918976,-0.356175035238266,-0.25115272402763367,-0.09111040830612183,-0.2029045671224594,-0.14209775626659393,-0.20376640558242798,0.2537176311016083,-0.22925682365894318,0.26668035984039307,-0.0009719292866066098,-0.0146566703915596,0.19309216737747192,0.14693577587604523,-0.10582713782787323,0.12060239166021347,0.14258262515068054,0.12634095549583435,-0.07645957916975021,-0.22078821063041687,-0.09963858127593994},{0.23576003313064575,-0.06716244667768478,-0.038679298013448715,0.43134424090385437,-0.10228558629751205,-0.22024871408939362,-0.06752210110425949,0.10049788653850555,0.18781569600105286,0.3201175630092621,0.11753091961145401,-0.1455291211605072,0.050705473870038986,0.19956962764263153,-0.09755995869636536,0.06428436189889908,0.1875396966934204,-0.24046730995178223,0.05028829723596573,-0.33414486050605774,0.3369784355163574,0.1258115917444229,-0.06836262345314026,0.19299624860286713,0.17633633315563202,0.09804241359233856,0.09330375492572784,0.03615012764930725,0.08606717735528946,-0.14584793150424957,-0.0545010045170784,0.4165123403072357},{0.028548479080200195,-0.2683681845664978,-0.08925574272871017,0.11231136322021484,-0.254819393157959,-0.008572421967983246,0.06017344817519188,-0.27080848813056946,-0.14604339003562927,-0.0571480430662632,0.17661640048027039,0.1408926248550415,0.08814055472612381,0.2548065185546875,-0.06707025319337845,-0.08898596465587616,-0.2280205339193344,0.27020010352134705,-0.1121879518032074,-0.2801670730113983,-0.1817660629749298,-0.07650645822286606,0.18558929860591888,-0.005691187921911478,-0.03808658570051193,-0.07397047430276871,-0.21220465004444122,0.2184668332338333,0.06336092203855515,-0.18475458025932312,0.2272828370332718,0.1951545774936676},{0.13428565859794617,-0.21927012503147125,-0.10615982860326767,-0.17611707746982574,-0.11401571333408356,0.1390455812215805,0.02830779366195202,0.23432767391204834,-0.09840256720781326,0.03646539896726608,0.25577762722969055,0.11142712831497192,-0.059078995138406754,-0.14598214626312256,0.0423269048333168,0.15547393262386322,-0.43941283226013184,-0.28387367725372314,-0.061525098979473114,0.042033854871988297,0.12869524955749512,0.23074236512184143,0.29666441679000854,0.1327013522386551,0.0493897944688797,0.22279474139213562,0.01707792468369007,-0.0904773622751236,0.19717338681221008,-0.13234376907348633,-0.27742719650268555,0.3821899890899658},{0.19033898413181305,-0.005636333487927914,-0.24993924796581268,0.1661984622478485,0.10079923272132874,-0.03204173222184181,0.2682815194129944,0.11502834409475327,0.1087421104311943,-0.22635623812675476,0.22002634406089783,-0.1849919855594635,-0.3669492304325104,0.2429848462343216,0.0641268938779831,0.06075774505734444,0.07689587771892548,-0.03191320598125458,-0.13064764440059662,0.051382627338171005,-0.08405279368162155,0.21230469644069672,0.051398709416389465,-0.15356957912445068,0.036368269473314285,-0.27229541540145874,0.02928302250802517,0.42873090505599976,0.23806370794773102,-0.13920924067497253,0.2267264425754547,0.18425574898719788},{-0.0413084477186203,-0.025943540036678314,-0.09264863282442093,-0.025978555902838707,-0.2486029416322708,-0.03813521936535835,0.18060733377933502,0.1938873827457428,0.13587605953216553,-0.011324265040457249,0.24001188576221466,0.021500427275896072,0.2093553990125656,0.15365706384181976,0.1768479198217392,-0.08255065977573395,0.12132000178098679,0.1646171659231186,0.25526195764541626,0.07748332619667053,0.19125115871429443,0.2376069873571396,0.0639684721827507,0.12767039239406586,-0.005750285927206278,-0.09946044534444809,-0.08950595557689667,-0.2539794147014618,0.17996357381343842,-0.22682735323905945,0.03017541579902172,-0.019984863698482513},{-0.3352786600589752,0.10340163111686707,-0.30409491062164307,-0.352880597114563,-0.015156032517552376,0.0634448230266571,0.1370190680027008,-0.12327861785888672,-0.005897616036236286,0.31443414092063904,0.06399352103471756,-0.22467532753944397,0.03972043842077255,-0.16433417797088623,-0.3133492171764374,-0.02943171188235283,-0.18150097131729126,0.1481412798166275,-0.03006909042596817,-0.07566136866807938,-0.3253154158592224,0.19443312287330627,0.1362214982509613,0.025703901425004005,-0.019693877547979355,0.29147088527679443,0.018886910751461983,-0.11925525963306427,-0.17680911719799042,0.001379660447128117,-0.15292349457740784,-0.2584230303764343},{-0.008601128123700619,-0.21885733306407928,-0.23623983561992645,-0.030467577278614044,-0.3594259023666382,-0.1694168746471405,0.1619197130203247,-0.3006904721260071,-0.1993708461523056,0.20500345528125763,0.14900797605514526,0.11567787081003189,0.1324312686920166,-0.12499310076236725,0.3153689205646515,-0.32167699933052063,0.0581720732152462,0.21544910967350006,0.05209970101714134,0.23795188963413239,0.05552159994840622,-0.12224087864160538,-0.2831162214279175,0.19988858699798584,-0.18339675664901733,-0.14992129802703857,0.09366306662559509,0.02461358904838562,-0.11729230731725693,-0.30362436175346375,-0.05281791090965271,-0.13452722132205963},{0.22413064539432526,0.18721447885036469,-0.08078347891569138,0.15260785818099976,-0.27594098448753357,0.17862746119499207,-0.05712350085377693,-0.13575270771980286,-0.19679604470729828,0.20576626062393188,-0.25797122716903687,-0.1660110354423523,-0.04524125158786774,-0.18097619712352753,-0.37694182991981506,-0.13337062299251556,-0.08326789736747742,-0.2712644934654236,-0.2341168075799942,0.29377663135528564,0.08980107307434082,0.13207615911960602,-0.33213117718696594,0.3390084505081177,0.20114263892173767,0.257063090801239,-0.28179651498794556,-0.018146274611353874,0.07229714095592499,-0.2657510042190552,0.12344575673341751,0.09183984994888306},{0.017449069768190384,-0.34091219305992126,0.03300115466117859,-0.28970634937286377,-0.06374917179346085,0.2577410936355591,0.1712784618139267,0.02353389747440815,-0.02378210797905922,-0.009545436128973961,-0.22355520725250244,0.16518357396125793,0.17733074724674225,0.10482572019100189,0.14642561972141266,0.016942253336310387,-0.06595855206251144,0.12781701982021332,-0.09567180275917053,0.1835547834634781,0.21664896607398987,0.22867286205291748,-0.09848804771900177,-0.2385348528623581,0.10966932028532028,0.09657396376132965,0.2541016936302185,0.12539538741111755,-0.03972437232732773,0.20276890695095062,0.04216388985514641,-0.11428458243608475},{0.02643544413149357,-0.18771016597747803,0.24400612711906433,-0.00346642779186368,0.30262452363967896,-0.036919351667165756,-0.1048939973115921,-0.16379787027835846,0.14891274273395538,-0.06370697915554047,0.06187248229980469,0.0026179275009781122,-0.27108192443847656,0.03126480430364609,-0.1104634553194046,-0.24468819797039032,-0.0462956503033638,-0.04319944605231285,0.20616482198238373,0.25675249099731445,0.027874810621142387,0.037392228841781616,0.17763584852218628,0.35500940680503845,-0.1583147794008255,-0.08134211599826813,0.20194017887115479,-0.11933792382478714,-0.22061318159103394,-0.24429912865161896,0.30197465419769287,-0.011187384836375713},{0.19906219840049744,-0.06315933912992477,0.040634311735630035,0.14479109644889832,-0.046657513827085495,0.05668212100863457,-0.28458526730537415,0.2744502127170563,-0.08440665900707245,-0.04437289386987686,0.11548265814781189,-0.2599351108074188,-0.0038464951794594526,-0.034959759563207626,-0.08021809160709381,0.26792266964912415,-0.09230348467826843,-0.21146129071712494,0.05060898885130882,-0.024064457044005394,-0.151051864027977,0.19887244701385498,0.24046553671360016,0.20101036131381989,-0.2962396442890167,0.11692158877849579,-0.05429281294345856,0.08110716193914413,-0.27344098687171936,0.29427778720855713,-0.03022954612970352,0.06738551706075668}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.23308709263801575,-0.1054898276925087,0.11726857721805573,-0.16105589270591736},{0.21000096201896667,-0.3252759575843811,0.2808563709259033,0.258365660905838},{-0.28863266110420227,0.10679899156093597,0.06407205015420914,-0.01698283478617668},{0.28046149015426636,0.49744439125061035,0.3700249493122101,0.04066633805632591},{-0.2735454738140106,0.14868512749671936,-0.3177204430103302,0.08915725350379944},{-0.06860772520303726,-0.05990104749798775,0.07481357455253601,0.4133767783641815},{-0.10957067459821701,-0.1017598807811737,-0.36696723103523254,0.015934091061353683},{-0.16845703125,-0.257735937833786,0.2043033391237259,-0.07055897265672684},{-0.07663602381944656,0.09752696007490158,-0.09559724479913712,-0.11586502939462662},{0.2529248595237732,0.01766902208328247,-0.10932762175798416,-0.20739848911762238},{0.16764476895332336,-0.11223013699054718,0.3098876178264618,0.2599043548107147},{-0.05774104967713356,0.013172942213714123,0.39440980553627014,-0.1003609225153923},{-0.3635250926017761,0.22603370249271393,-0.013273934833705425,-0.13274087011814117},{-0.1895681917667389,0.10276679694652557,-0.22458624839782715,0.09784234315156937},{0.17176368832588196,0.0428289957344532,0.2852833867073059,0.10768775641918182},{-0.15525388717651367,-0.3441844582557678,-0.13128560781478882,-0.1024244949221611},{-0.3144065737724304,0.037358663976192474,-0.08722452074289322,0.313753604888916},{-0.2702564597129822,-0.13289807736873627,-0.21351151168346405,0.21155959367752075},{-0.0672493427991867,-0.12386783212423325,0.37863925099372864,0.06064486503601074},{-0.2010670006275177,-0.15229950845241547,0.01710963435471058,-0.19235867261886597},{0.16121451556682587,0.122402623295784,0.1683902144432068,-0.19947020709514618},{-0.04847178980708122,-0.3054041862487793,-0.10704807192087173,0.30268946290016174},{0.4239782691001892,-0.23202157020568848,0.14826799929141998,0.06517541408538818},{-0.3268100619316101,-0.11408336460590363,-0.3166075050830841,-0.3531937301158905},{-0.1618659496307373,-0.23143577575683594,-0.09537281095981598,-0.08990072458982468},{0.1637759953737259,0.14384226500988007,-0.054921481758356094,0.08165030181407928},{0.1281559318304062,-0.20392848551273346,0.2886665463447571,0.07806582748889923},{-0.086824432015419,-0.1556635946035385,-0.024601152166724205,0.3075172007083893},{0.11767526715993881,0.03784884512424469,0.07460702210664749,0.04474785923957825},{-0.1689128875732422,0.13101068139076233,0.2652767300605774,0.011337374337017536},{-0.2587665319442749,-0.09617696702480316,0.08552367240190506,0.23592929542064667},{0.2788010537624359,0.20813176035881042,0.29299020767211914,-0.045943766832351685}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.10034242272377014,-0.1086602434515953,0.06238944083452225,0.08917573094367981,0.10253815352916718,-0.14512424170970917,0.0826544314622879,0.00925576314330101,-0.0650552287697792,-0.08967083692550659,0.006949495989829302,0.047739919275045395,-0.009980903938412666,0.07929727435112,0.09845774620771408,-0.034301724284887314};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0011644024634733796,0.0631188303232193,0.052089061588048935,-0.024835212156176567,-0.037550680339336395,0.05880897864699364,-0.050349194556474686,-0.07899642735719681,0.04091504216194153,-0.00837964378297329,-0.029919587075710297,-0.025483310222625732,-0.012564283795654774,-0.07699577510356903,0.03411346301436424,-0.08203212916851044};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05312955006957054,-0.005428113508969545,-0.06863950192928314,0.04230332747101784,0.0025826296769082546,0.01364079024642706,-0.05326719582080841,-0.05008068308234215,-0.01641159877181053,-0.013904834166169167,0.010584170930087566,0.03272485360503197,0.019981713965535164,-0.04402213916182518,0.03114076517522335,-0.07499135285615921,-0.01029184740036726,-0.03426224738359451,0.019633403047919273,-0.06504420936107635,0.02383498288691044,-0.01572917029261589,0.027332104742527008,-0.06567279249429703,-0.06499762088060379,0.06988366693258286,0.038616281002759933,-0.0364043153822422,0.06802967190742493,0.012874680571258068,-0.015376455150544643,0.05509373918175697};
static const float action_parameterization_distribution_linear_bias[4] = {0.03830315172672272,0.05618070438504219,0.004012134857475758,0.03120522014796734};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3298112154006958,-0.21007786691188812,-0.05663418024778366,0.1660989224910736,-0.042599648237228394,0.07076706737279892,-0.1975446343421936,-0.027195144444704056},{0.048554230481386185,0.08538792282342911,0.33912381529808044,0.34300175309181213,-0.0851033478975296,-0.2399863600730896,0.3566703200340271,0.1350017637014389},{0.006372232921421528,0.18387331068515778,0.04809737950563431,-0.043648749589920044,0.32755085825920105,0.2542075216770172,-0.01657499559223652,0.07656201720237732},{0.08490319550037384,-0.277214914560318,0.28477349877357483,-0.23419800400733948,-0.28310927748680115,0.04110739007592201,0.2161787748336792,0.16698488593101501},{-0.22063712775707245,-0.02638355642557144,-0.04895906150341034,-0.29618027806282043,0.04915776476264,0.04947509989142418,0.24614325165748596,0.23951706290245056},{-0.06649510562419891,0.28613024950027466,-0.07716861367225647,-0.2362184077501297,0.16220827400684357,0.01582961529493332,0.021128205582499504,-0.20159468054771423},{0.0007848934619687498,0.31140390038490295,0.1332070529460907,-0.1360311359167099,0.2610284984111786,-0.24275518953800201,0.2239404022693634,0.08205319941043854},{0.02691895142197609,-0.1969534009695053,0.04748209938406944,-0.08064822107553482,0.3493961989879608,-0.12252236902713776,-0.01796482689678669,-0.28130194544792175},{-0.16657069325447083,0.30920031666755676,0.1327495127916336,-0.028482763096690178,0.00911762099713087,0.22005529701709747,0.4487243592739105,0.3772633671760559},{0.06288813799619675,-0.04692857339978218,-0.2893736660480499,0.35370907187461853,0.24940554797649384,0.16433337330818176,0.2110268771648407,-0.2698185443878174},{-0.11705700308084488,-0.32779446244239807,0.34204092621803284,0.23538270592689514,-0.042411889880895615,-0.38816046714782715,-0.11454568058252335,-0.33263927698135376},{0.3108932673931122,0.060840725898742676,0.38552290201187134,0.45219969749450684,-0.17890261113643646,0.19398438930511475,0.14165179431438446,-0.39630618691444397},{-0.30682453513145447,0.1668110489845276,-0.3216158151626587,0.44514477252960205,-0.057679690420627594,0.26153698563575745,0.013172072358429432,0.23141713440418243},{-0.019999971613287926,0.20010431110858917,-0.07675660401582718,-0.15031887590885162,0.03518577665090561,0.04382679611444473,0.3200930058956146,-0.009236455895006657},{0.1295386403799057,-0.30041396617889404,-0.2569529712200165,-0.1670229583978653,0.22505417466163635,-0.1897234171628952,0.26001104712486267,-0.10955293476581573},{-0.3949353098869324,-0.35490918159484863,-0.2331143170595169,0.018822863698005676,0.06695912778377533,0.1209353506565094,0.2907235026359558,0.010810443200170994},{-0.19740431010723114,-0.22449122369289398,0.15977710485458374,-0.30926749110221863,0.10748937726020813,0.0681595727801323,-0.4022648334503174,-0.24327988922595978},{0.04850158467888832,0.26030445098876953,0.06028077378869057,0.16555073857307434,-0.05451829358935356,0.31166908144950867,0.2927747368812561,-0.1530638337135315},{-0.001795663614757359,-0.31220731139183044,-0.14959627389907837,-0.0365232490003109,-0.03966296464204788,-0.35734879970550537,0.10148968547582626,-0.22079384326934814},{-0.10490892827510834,-0.026744874194264412,0.029962388798594475,-0.28795647621154785,0.12636075913906097,0.09298006445169449,0.12526002526283264,-0.021226026117801666},{0.0349847637116909,-0.09340321272611618,0.022588340565562248,-0.18488362431526184,0.04961710050702095,-0.03888032212853432,0.09312592446804047,-0.15667198598384857},{-0.32288244366645813,0.1637457311153412,0.13845516741275787,-0.2598438262939453,-0.37144985795021057,-0.02718741074204445,0.21086908876895905,0.04332681745290756},{0.2756148874759674,0.03498174622654915,-0.4250872731208801,0.015154195949435234,-0.03510800749063492,0.21069064736366272,0.2588885724544525,0.31551817059516907},{0.015719937160611153,-0.22315368056297302,-0.07041101157665253,0.14199042320251465,-0.28906047344207764,-0.09125392884016037,-0.20583891868591309,-0.27662163972854614},{0.10817285627126694,-0.10454998165369034,-0.42548099160194397,0.35097819566726685,-0.33147457242012024,-0.11098635941743851,-0.4611756503582001,0.08106576651334763},{-0.01491040550172329,0.3018937408924103,-0.19811372458934784,-0.07822445780038834,0.10908156633377075,-0.12704682350158691,0.28650423884391785,-0.29279330372810364},{-0.09224318712949753,0.09006646275520325,-0.07385768741369247,-0.2580883502960205,0.04755619168281555,-0.12006472051143646,-0.13533160090446472,-0.0888170450925827},{0.07563409209251404,-0.16012345254421234,0.03875912353396416,-0.1424213945865631,0.08092508465051651,0.07889848202466965,-0.21246013045310974,0.11137449741363525},{0.22070452570915222,0.021619008854031563,-0.3109806180000305,-0.2158692330121994,-0.1956944465637207,0.1616269052028656,0.2070930153131485,0.04963438957929611},{0.3225213885307312,-0.35716161131858826,-0.0005352423177100718,-0.04964442551136017,0.09334699809551239,-0.10451951622962952,0.16660451889038086,0.2616834342479706},{-0.2704786956310272,-0.2066720575094223,0.03711904585361481,-0.3654407560825348,0.25256940722465515,-0.34119585156440735,-0.03467271476984024,0.0860988199710846},{0.23503634333610535,0.18535812199115753,-0.03569306805729866,0.23704108595848083,0.07072396576404572,-0.1511068046092987,-0.03678285330533981,0.1343330293893814}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23543155193328857,0.41785749793052673,-0.49050846695899963,-0.5222252607345581,-0.18383462727069855,-0.08980649709701538,-0.3865574300289154,0.5294446349143982},{-0.038106366991996765,0.45496970415115356,-0.2572770416736603,0.5804990530014038,-0.025801340118050575,-0.04642577841877937,-0.3408999443054199,0.02041606418788433},{-0.3525789678096771,-0.18051661550998688,-0.13748008012771606,-0.08678191900253296,0.45129626989364624,0.2295977622270584,-0.05315544083714485,0.4318079650402069},{-0.4968355894088745,-0.5224489569664001,0.33943405747413635,0.31197211146354675,-0.4781394302845001,-0.22536727786064148,0.42035168409347534,0.22993506491184235},{-0.30381736159324646,-0.27777841687202454,-0.30639180541038513,-0.1899585723876953,0.35866472125053406,-0.23711097240447998,0.491994708776474,-0.4052424430847168},{-0.030881129205226898,0.25584158301353455,0.13961690664291382,-0.549696147441864,0.547422468662262,-0.25345098972320557,-0.5049408674240112,-0.3632843792438507},{-0.3012445569038391,0.12782113254070282,0.0750822201371193,-0.4852314293384552,0.025750843808054924,-0.5068892240524292,0.4697929322719574,0.06237970292568207},{-0.34577038884162903,-0.14211900532245636,-0.13523593544960022,-0.3529956042766571,-0.375469833612442,0.13502207398414612,0.570033609867096,-0.2959471642971039}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.01917111687362194,-0.11044541746377945,-0.10299281775951385,0.016424866393208504,0.1789611428976059,0.050975218415260315,0.14373385906219482,0.053582727909088135};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0038122376427054405,-0.02294793352484703,-0.014623047783970833,-0.09842998534440994,-0.06301525980234146,-0.07749883830547333,0.01041752751916647,-0.17609156668186188};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

