#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2775510847568512,0.02683994732797146,-0.13236655294895172,0.3133924603462219,0.27755680680274963,-0.18985658884048462,-0.2319624274969101,0.10869947820901871,0.2891899347305298,-0.32416555285453796,0.5596001148223877,-0.05124795809388161,0.2924882173538208,0.119140625,-0.4251422882080078,0.04732651636004448},{-0.24614933133125305,-0.2793017029762268,-0.2934137284755707,-0.1988704651594162,0.07814674079418182,0.2919430136680603,0.07778255641460419,0.09418236464262009,0.22814348340034485,0.17718088626861572,-0.1551523357629776,-0.08410178124904633,-0.15297624468803406,0.08285202831029892,0.32133832573890686,-0.27934530377388},{0.149250790476799,0.20608079433441162,0.21054935455322266,0.3300812244415283,-0.11240900307893753,-0.22537477314472198,0.44560134410858154,-0.03499465808272362,-0.005606391467154026,-0.09219764918088913,-0.05574697256088257,-0.005163069348782301,0.06265026330947876,0.4255836606025696,-0.2536649703979492,-0.08328795433044434},{0.14575879275798798,-0.1620170921087265,-0.12811416387557983,-0.13781090080738068,0.050631675869226456,0.0963544026017189,0.07775849103927612,-0.1975681036710739,-0.14924873411655426,0.16060896217823029,0.5435760021209717,-0.22740182280540466,-0.18068604171276093,-0.17567764222621918,0.1946583092212677,0.09953000396490097},{-0.30059900879859924,0.026014111936092377,0.12615056335926056,-0.2168312817811966,0.2630203068256378,0.2998686730861664,0.13431498408317566,-0.2046169936656952,-0.1417226493358612,0.13754041492938995,-0.13796518743038177,-0.39502978324890137,-0.025213725864887238,-0.15908384323120117,0.3080442249774933,-0.035473935306072235},{0.008745015598833561,-0.03245333582162857,-0.0063089425675570965,-0.053665366023778915,0.10769864916801453,-0.1420581042766571,0.41925305128097534,-0.3468621075153351,-0.13231627643108368,-0.1569640189409256,0.2710838317871094,0.043722476810216904,0.2446906864643097,0.05934197083115578,0.28990602493286133,0.26749545335769653},{-0.22418834269046783,0.20660753548145294,-0.08754407614469528,0.035001739859580994,-0.22361914813518524,-0.06779585033655167,-0.1597922295331955,-0.03176259621977806,0.14514051377773285,0.36408206820487976,-0.26362326741218567,-0.11514627188444138,0.2384364753961563,0.07822778075933456,-0.17079152166843414,0.3298821449279785},{-0.12631617486476898,0.0338020958006382,-0.13850997388362885,-0.19111745059490204,0.37675541639328003,-0.2780628502368927,-0.27360185980796814,-0.41576290130615234,-0.08636654168367386,-0.24738986790180206,0.3890172839164734,-0.04502686858177185,0.20421074330806732,0.18146593868732452,-0.20111167430877686,0.4089745581150055},{0.23643319308757782,0.0843878835439682,0.003646420780569315,0.08855258673429489,-0.3843175768852234,-0.45439478754997253,0.3384380042552948,-0.29221677780151367,-0.15568925440311432,0.19705888628959656,0.1723211258649826,-0.2944260835647583,-0.1516091674566269,0.030133971944451332,0.17141789197921753,-0.03676867485046387},{0.4381644129753113,-0.5427068471908569,-0.12524235248565674,-0.012970594689249992,0.20540349185466766,-0.16122636198997498,-0.24991412460803986,-0.16360296308994293,-0.1449098289012909,-0.05319216847419739,-0.02133844420313835,-0.21779508888721466,0.37353235483169556,-0.09139486402273178,-0.4768826961517334,-0.15600068867206573},{0.21125692129135132,0.20917949080467224,-0.35371530055999756,0.0801711305975914,-0.013735068030655384,-0.22430862486362457,-0.1284499168395996,0.11962172389030457,-0.16465763747692108,0.17033354938030243,0.16283518075942993,0.23662222921848297,-0.11312917619943619,0.26830920577049255,-0.04564611241221428,-0.20347516238689423},{-0.4095076322555542,0.2620503008365631,0.24516303837299347,-0.2714281678199768,-0.29694193601608276,0.32293540239334106,0.04708709940314293,0.33171433210372925,0.19177615642547607,0.1725202202796936,0.24767771363258362,-0.11089792847633362,0.16521553695201874,-0.05240660905838013,-0.08705704659223557,-0.1338714361190796},{0.10992509871721268,-0.2549649178981781,-0.19045916199684143,0.206987202167511,-0.2181713730096817,-0.271147221326828,-0.1237725093960762,0.25079426169395447,0.32130950689315796,-0.1471538245677948,-0.11394226551055908,0.05321577191352844,0.2810245752334595,0.13973790407180786,-0.18867971003055573,0.31367987394332886},{0.2817668616771698,0.20257818698883057,-0.14797507226467133,-0.10751017183065414,0.10143230855464935,-0.07121329009532928,-0.11901195347309113,0.33277711272239685,-0.21979539096355438,-0.18891404569149017,-0.1529122143983841,0.021305928006768227,-0.20238161087036133,-0.12230534106492996,-0.20789383351802826,-0.042046502232551575},{0.18213701248168945,0.362064391374588,0.4014248549938202,-0.38978153467178345,-0.3827381432056427,0.09968405216932297,0.07590781152248383,-0.1392538845539093,0.36806100606918335,0.3820914030075073,-0.18355223536491394,0.06168634817004204,-0.042611707001924515,-0.33258309960365295,0.06457488983869553,-0.1328824758529663},{-0.15523305535316467,-0.21704114973545074,-0.13432341814041138,0.4268088638782501,-0.23702694475650787,-0.16143560409545898,-0.24012373387813568,-0.2630311846733093,-0.5529710054397583,-0.24857504665851593,0.3575461506843567,0.2642817497253418,-0.6040297150611877,-0.35420843958854675,-0.6385706067085266,-0.14550328254699707},{-0.5099524855613708,0.17945066094398499,-0.3911052346229553,-0.13667185604572296,-0.47306743264198303,0.1914832592010498,0.46546146273612976,0.06301663815975189,0.4371112585067749,-0.46280378103256226,0.1767900586128235,-0.3562975227832794,-0.19910097122192383,0.031924642622470856,-0.15780071914196014,-0.21877838671207428},{0.3442235589027405,-0.5961283445358276,0.30847564339637756,0.25742867588996887,-0.1210610419511795,0.46324586868286133,0.27917101979255676,0.2757550776004791,-0.049996376037597656,-0.27101612091064453,-0.1289801448583603,-0.17393583059310913,-0.06100781261920929,-0.5282793641090393,0.2085282951593399,-0.11920288950204849}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.0566355437040329,0.3217407763004303,0.2461116909980774,-0.16840563714504242,-0.1897718757390976,0.038100846111774445,-0.03389139100909233,0.25405654311180115,-0.058538246899843216,0.31271788477897644,0.48053401708602905,-0.3753211200237274,0.030828189104795456,0.04539763927459717,0.033824291080236435,-0.1200781986117363},{-0.4520260989665985,0.18323096632957458,-0.21739014983177185,0.31994393467903137,0.2761261761188507,-0.15304367244243622,-0.3304907977581024,-0.16995084285736084,0.37206539511680603,0.24797764420509338,-0.07052014768123627,0.25629058480262756,-0.4179960787296295,0.1821855753660202,-0.22793680429458618,0.4586642384529114},{-0.2771304249763489,0.09684258699417114,-0.3463180959224701,0.19416306912899017,-0.4893319308757782,-0.25446727871894836,0.064753957092762,0.15669851005077362,-0.2355322688817978,0.3957637548446655,0.2482863813638687,-0.17629095911979675,0.1762278825044632,-0.28658443689346313,-0.1363358199596405,-0.07919720560312271},{0.3389076888561249,-0.21891175210475922,0.10741636902093887,0.41026076674461365,-0.39979076385498047,-0.3109753727912903,0.30949899554252625,0.027156323194503784,0.28614580631256104,-0.09279268234968185,0.34280627965927124,0.08529950678348541,-0.20997929573059082,0.021607644855976105,0.0028152023442089558,-0.4397915005683899},{-0.3963664770126343,-0.05484970659017563,0.15898041427135468,-0.28295013308525085,0.17111895978450775,0.4069162905216217,-0.28169652819633484,0.2866751253604889,-0.23976236581802368,0.21983516216278076,-0.018922345712780952,0.015895003452897072,-0.26006361842155457,-0.0171873327344656,-0.3010016977787018,-0.13218289613723755},{0.056143928319215775,-0.3232441246509552,0.005895446985960007,-0.3387658894062042,0.21384495496749878,0.05561479181051254,-0.14406488835811615,-0.054961785674095154,-0.16149750351905823,0.39893972873687744,0.21116790175437927,-0.0067305113188922405,-0.29965752363204956,0.07437079399824142,0.0065550049766898155,-0.2906041741371155},{0.28980758786201477,-0.1706823706626892,0.3439003527164459,-0.22732138633728027,-0.42800408601760864,-0.040038321167230606,-0.341167151927948,0.34968990087509155,-0.10294981300830841,-0.25714433193206787,-0.24543306231498718,-0.031138917431235313,-0.039173539727926254,-0.08091841638088226,0.491277813911438,-0.37003448605537415},{-0.3320102095603943,0.36434313654899597,-0.07321051508188248,0.17954324185848236,-0.04995371401309967,-0.21760307252407074,-0.23496663570404053,0.06592573970556259,0.0008163757156580687,0.5201874375343323,0.12180310487747192,-0.11027803272008896,0.047291629016399384,-0.25711581110954285,0.10498767346143723,0.1509564369916916},{0.08370034396648407,0.2803320586681366,-0.17287598550319672,-0.3479000926017761,0.35262739658355713,-0.19314810633659363,0.13654835522174835,-0.32993775606155396,0.12249559164047241,0.06869138032197952,0.08441895991563797,0.13908751308918,0.02191840298473835,-0.41346967220306396,-0.04187248647212982,0.21209324896335602},{-0.23162221908569336,0.04665478691458702,-0.29379478096961975,-0.34220319986343384,0.21741734445095062,-0.40757492184638977,-0.13484133780002594,0.32011887431144714,-0.17776085436344147,0.14829488098621368,-0.03277392312884331,-0.11540882289409637,-0.36174339056015015,0.11062799394130707,-0.24608522653579712,-0.311701238155365},{-0.15047705173492432,-0.1614190936088562,0.0011898670345544815,-0.2485773116350174,-0.32379406690597534,-0.027574779465794563,0.14806155860424042,-0.40416356921195984,0.04177464544773102,-0.09362773597240448,0.27369412779808044,-0.05684159696102142,0.28540244698524475,0.1617332398891449,0.23248159885406494,0.23262663185596466},{-0.09627626836299896,-0.030531611293554306,-0.3988952934741974,0.3130379915237427,0.10314705967903137,0.1554841697216034,0.23316825926303864,0.15727832913398743,-0.43260255455970764,0.1849241405725479,-0.32401910424232483,-0.20672191679477692,-0.35588228702545166,0.37778010964393616,-0.3450528085231781,0.09360873699188232},{-0.2345067858695984,-0.4908701181411743,-0.14635242521762848,0.16405054926872253,-0.22982905805110931,-0.02948399819433689,-0.10988742113113403,0.3856934607028961,0.4706260859966278,0.15433569252490997,-0.03002334199845791,-0.17799769341945648,0.14922915399074554,-0.41733264923095703,0.09150820225477219,-0.20350298285484314},{-0.2770835757255554,-0.4539565443992615,-0.16718944907188416,-0.14763973653316498,-0.47840893268585205,0.5127774477005005,-0.1660347282886505,0.19734391570091248,-0.11236761510372162,-0.25473058223724365,-0.335863322019577,0.4509270191192627,-0.1787293702363968,-0.03494463860988617,-0.24350807070732117,0.3701552450656891},{-0.3480781018733978,0.3580111265182495,-0.2249203622341156,0.11764664202928543,-0.39239823818206787,0.16983826458454132,-0.05088912695646286,-0.284705251455307,0.11065290868282318,0.2307581603527069,-0.2658225893974304,0.06262162327766418,0.24476908147335052,-0.33295243978500366,-0.3424871265888214,-0.14223505556583405},{-0.13766323029994965,-0.29150474071502686,-0.45183807611465454,0.19873912632465363,0.13221736252307892,0.042540911585092545,-0.2548902630805969,0.18101531267166138,-0.3395574986934662,-0.2484133392572403,-0.3013509511947632,0.22077131271362305,-0.17118681967258453,0.12713541090488434,0.0653185099363327,0.2890874147415161}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1015431135892868,-0.06546859443187714,0.138998880982399,-0.14440204203128815,-0.10944565385580063,0.10774233192205429,0.1938749998807907,-0.2142157256603241,-0.16373790800571442,0.29047900438308716,0.1119520366191864,0.1308240294456482,0.10225863754749298,0.17355594038963318,-0.16472728550434113,0.14550602436065674,0.11318063735961914,-0.3402869999408722,-0.2169567048549652,-0.06626235693693161,-0.15799137949943542,0.12040753662586212,-0.22199025750160217,0.28044119477272034,-0.09318431466817856,-0.03654273599386215,0.13174793124198914,0.1963941901922226,-0.24801434576511383,-0.1676759421825409,0.21269528567790985,0.28249838948249817},{0.22838012874126434,-0.04751456528902054,0.141523540019989,-0.10652242600917816,-0.13427790999412537,0.24816562235355377,-0.01593446172773838,-0.06376541405916214,-0.03559882193803787,-0.0031810759101063013,-0.1274682730436325,0.02497396431863308,0.40128156542778015,0.1629294753074646,0.13522259891033173,0.09405279159545898,-0.2581191956996918,-0.3700343668460846,0.08854998648166656,0.03313111886382103,0.06338952481746674,0.29445162415504456,0.22218462824821472,-0.25301796197891235,0.052668023854494095,0.2834416925907135,-0.29054832458496094,0.19660545885562897,0.13677139580249786,-0.2412632554769516,-0.03573647886514664,0.011881853453814983},{-0.10153075307607651,-0.06263710558414459,0.24534767866134644,-0.22644507884979248,-0.20811766386032104,0.037787072360515594,-0.1574866622686386,0.23461848497390747,0.15566910803318024,-0.004459573421627283,-0.1668500006198883,0.00843328982591629,0.26444166898727417,-0.20761719346046448,0.08045264333486557,-0.04065263643860817,-0.32934340834617615,0.2592678368091583,-0.28409063816070557,-0.04197479039430618,-0.00035524810664355755,-0.12730245292186737,-0.07400129735469818,-0.10740434378385544,-0.007837378419935703,0.3237767517566681,-0.04421250522136688,0.08086798340082169,0.257066935300827,-0.2846486270427704,-0.18034516274929047,-0.018338089808821678},{0.15025678277015686,-0.14914461970329285,0.07266011834144592,-0.3587605357170105,0.14406581223011017,-0.12184908986091614,-0.054022908210754395,0.2752775549888611,0.016074685379862785,0.17094466090202332,0.128593310713768,-0.12004663795232773,-0.21238142251968384,-0.09481459110975266,0.3014860153198242,-0.24275124073028564,0.046043720096349716,-0.11322695016860962,-0.12687645852565765,0.09117205440998077,-0.11346088349819183,0.06285709142684937,-0.21000847220420837,0.25377318263053894,-0.2892635762691498,0.07878763228654861,-0.08429695665836334,-0.19632123410701752,0.050210900604724884,0.033105913549661636,0.23813505470752716,-0.11295498162508011},{0.22410094738006592,0.01939765363931656,0.04490477964282036,0.26268234848976135,-0.2545550763607025,-0.07377815991640091,0.20007258653640747,-0.051146093755960464,0.09210258722305298,-0.19550484418869019,0.007924392819404602,-0.0771903246641159,-0.144340381026268,-0.1570069044828415,0.2909180819988251,0.32036370038986206,-0.08815750479698181,-0.34245187044143677,0.18049995601177216,-0.12092464417219162,-0.1196470633149147,0.20249365270137787,0.29263001680374146,0.031495604664087296,-0.06529206782579422,-0.10479289293289185,-0.033977314829826355,0.2634705901145935,0.2676062285900116,0.12791675329208374,0.07215101271867752,-0.2679872214794159},{0.3137534558773041,-0.17216479778289795,0.044375140219926834,0.09067182242870331,-0.15787577629089355,-0.3064393103122711,-0.20079082250595093,-0.30897247791290283,-0.23462723195552826,0.009500225074589252,-0.02668866701424122,-0.032486312091350555,-0.1554306596517563,-0.028933947905898094,-0.2260119616985321,-0.23736990988254547,0.1855814903974533,0.0182882659137249,-0.291867196559906,0.1888175904750824,-0.0506574921309948,-0.22187991440296173,0.19069595634937286,-0.1502431333065033,-0.13467486202716827,-0.24854692816734314,-0.09878568351268768,0.11338147521018982,0.09638616442680359,0.2650893032550812,-0.26802858710289,0.15815694630146027},{0.1772010773420334,0.06572314351797104,0.25223687291145325,-0.18087878823280334,0.2282293289899826,-0.18701253831386566,-0.25625279545783997,0.03284652531147003,0.28653064370155334,0.1552255004644394,-0.12352248281240463,0.0870530754327774,0.06718086451292038,0.35320845246315,0.13032712042331696,-0.1215558648109436,-0.19876043498516083,0.15354691445827484,-0.002863513771444559,0.02739662490785122,-0.08558588474988937,0.23803821206092834,0.15784189105033875,0.18417708575725555,-0.2411421835422516,-0.2621999979019165,-0.25866374373435974,-0.3791337013244629,0.00048769006389193237,-0.09104518592357635,0.24033546447753906,0.15127527713775635},{0.326003760099411,-0.31952664256095886,0.1401737928390503,-0.37591415643692017,-0.2864636480808258,0.315774530172348,0.37960195541381836,0.1604435294866562,-0.1186688020825386,0.035705458372831345,0.18939849734306335,-0.14627821743488312,0.13856802880764008,0.3020839989185333,-0.010650595650076866,0.20961999893188477,0.37988096475601196,-0.19734583795070648,-0.03284967318177223,-0.3028680980205536,0.14127877354621887,0.22911882400512695,0.2732650339603424,0.15122315287590027,0.08448946475982666,0.0995040163397789,0.10222885757684708,0.27102065086364746,-0.19325904548168182,-0.22280393540859222,0.26120907068252563,-0.01137469056993723},{-0.027879223227500916,-0.04892311245203018,0.2560538649559021,0.22739724814891815,-0.186906635761261,-0.3415757417678833,-0.05138733237981796,0.2522265911102295,-0.21099933981895447,-0.30829936265945435,0.1255245953798294,0.11585918813943863,0.0982326939702034,-0.27604708075523376,0.11877083033323288,-0.1839810013771057,-0.16211560368537903,0.17173300683498383,-0.21914084255695343,0.3231182396411896,-0.2537519335746765,-0.390570729970932,-0.29767483472824097,0.2499695122241974,0.11670688539743423,0.1261371374130249,0.2564425766468048,0.18406881392002106,-0.15793955326080322,-0.29052865505218506,-0.1838390976190567,0.13849104940891266},{0.32431572675704956,-0.001007767510600388,-0.028689060360193253,0.1483330875635147,0.05837889015674591,0.25563570857048035,0.011415933258831501,0.33313116431236267,-0.04603898152709007,0.08832225203514099,0.16977380216121674,0.05204673856496811,-0.22385457158088684,-0.4190782606601715,0.11441618949174881,0.16257502138614655,0.11492832005023956,-0.15071280300617218,-0.046540893614292145,-0.11589682102203369,0.16735802590847015,-0.3500160276889801,0.2844807803630829,0.025765106081962585,-0.06603597104549408,0.13456466794013977,-0.2914416790008545,-0.17737793922424316,0.03884197026491165,0.02269461750984192,0.1496295928955078,0.28041958808898926},{-0.12534581124782562,0.09389405697584152,-0.1316392868757248,0.16593217849731445,-0.12799791991710663,0.2644538879394531,0.11903432756662369,-0.01830477826297283,0.3073972165584564,-0.29100051522254944,-0.13812750577926636,0.1625376045703888,-0.18985259532928467,0.038275547325611115,-0.31185999512672424,-0.0378921739757061,0.1073254644870758,0.15748849511146545,0.04861096292734146,-0.17500264942646027,-0.21151228249073029,0.18215304613113403,0.17673282325267792,0.1805913895368576,-0.27644792199134827,0.3747362494468689,-0.07523486018180847,-0.02106957696378231,-0.1182420402765274,0.12655889987945557,0.2249615639448166,0.29790323972702026},{-0.2341347634792328,0.3124142587184906,-0.04482843726873398,-0.0027625879738479853,-0.21885506808757782,-0.20319616794586182,0.14148499071598053,-0.3366895914077759,-0.0654202327132225,-0.31129270792007446,-0.17871347069740295,-0.03749801963567734,0.19402697682380676,-0.22902600467205048,-0.13944219052791595,-0.29784324765205383,-0.1860083043575287,-0.0394514761865139,0.3284324109554291,-0.25147974491119385,0.10734265297651291,-0.2128070890903473,0.051403339952230453,0.29181793332099915,-0.13284464180469513,0.17597272992134094,0.22393392026424408,-0.1027892455458641,-0.032476577907800674,0.29409530758857727,-0.18426334857940674,-0.3179454207420349},{-0.028079804033041,0.20892396569252014,0.19665952026844025,-0.25894907116889954,0.27668195962905884,0.007450506556779146,-0.14692947268486023,-0.018108418211340904,0.1606321781873703,-0.26936060190200806,-0.08467359095811844,0.04229585826396942,0.1495705544948578,0.012038854882121086,0.05915939807891846,-0.06856189668178558,0.20693141222000122,-0.28675577044487,0.3164719343185425,0.04210461303591728,-0.1815229058265686,0.22598308324813843,-0.13546739518642426,-0.2307867556810379,0.24136245250701904,-0.0867404118180275,0.04095706716179848,-0.11776052415370941,0.07934778183698654,-0.14848223328590393,0.30880895256996155,0.2750811278820038},{0.04165495187044144,-0.21950791776180267,-0.1951218545436859,0.0606301873922348,-0.03798270970582962,0.27676424384117126,-0.11749035120010376,-0.33397233486175537,0.3496394753456116,0.040618449449539185,0.05438133701682091,0.05943482369184494,-0.09944691509008408,0.19186577200889587,-0.23276011645793915,-0.340112566947937,0.0221402570605278,0.021218737587332726,0.15300723910331726,0.4490937292575836,-0.2556133568286896,0.16661041975021362,-0.16529856622219086,0.08294372260570526,0.16720552742481232,-0.3401392102241516,-0.1461002379655838,-0.3180703818798065,-0.17031912505626678,-0.1836661994457245,0.13669167459011078,-0.39844298362731934},{-0.11990419030189514,0.3549940586090088,0.07032330334186554,-0.16918106377124786,-0.14468657970428467,-0.2540299892425537,0.12113115191459656,-0.09000447392463684,0.27471184730529785,-0.0522024966776371,0.2112671583890915,0.22345909476280212,-0.02600775472819805,0.06431455165147781,-0.13768495619297028,0.1610787957906723,-0.20708921551704407,-0.40148529410362244,-0.2993910014629364,0.0894332230091095,0.13980796933174133,-0.22391192615032196,-0.3697873055934906,-0.2728108763694763,-0.14119790494441986,0.14345459640026093,0.3808034062385559,0.016331730410456657,-0.08416134864091873,0.040454261004924774,-0.08960755914449692,0.11048620194196701},{-0.24946637451648712,-0.16260071098804474,-0.19803009927272797,0.0408581979572773,-0.2512708008289337,-0.14860254526138306,-0.059599027037620544,-0.07908828556537628,-0.31272315979003906,-0.2768862247467041,0.231587216258049,0.16036292910575867,-0.3093329071998596,0.256634920835495,-0.0675545334815979,0.15643280744552612,0.09520918875932693,0.03259950503706932,0.05284584313631058,0.13437646627426147,0.24826666712760925,0.21636910736560822,0.12482716888189316,0.24436335265636444,0.10847002267837524,-0.20558498799800873,-0.16780425608158112,0.23911546170711517,-0.03273607790470123,-0.1969616711139679,-0.1840054839849472,-0.1800590455532074},{-0.2761281728744507,-0.19868674874305725,-0.34905940294265747,0.07571452111005783,-0.10247453302145004,-0.06483934074640274,-0.10911878198385239,0.12688234448432922,-0.08979582041501999,0.06952249258756638,-0.22025465965270996,0.020730596035718918,0.15562275052070618,-0.10968839377164841,0.04889165237545967,0.21255451440811157,-0.11696092039346695,-0.14034229516983032,0.17772337794303894,0.04399415850639343,0.19962696731090546,-0.02814028039574623,-0.21117332577705383,0.04871463030576706,0.20809204876422882,-0.2492111176252365,0.152089461684227,0.06703872233629227,0.08951497822999954,-0.15229979157447815,0.24522694945335388,-0.05634558945894241},{0.2601810693740845,-0.0034860633313655853,0.03740191087126732,0.1854095757007599,-0.33591461181640625,-0.027285946533083916,0.07754221558570862,0.1675063520669937,-0.08653338253498077,-0.14442718029022217,0.2939716577529907,-0.10276736319065094,0.06451591104269028,-0.04361604154109955,-0.11506550014019012,0.2787137031555176,-0.05896652117371559,-0.12770329415798187,0.11585696041584015,-0.2948977053165436,-0.04821610078215599,-0.2552313208580017,-0.18655730783939362,0.23829878866672516,-0.06087591499090195,-0.0549723282456398,0.12808527052402496,0.05335058271884918,-0.16480711102485657,-0.06772685796022415,-0.0278158001601696,-0.07626906782388687},{0.296978235244751,-0.06788955628871918,0.07480008155107498,0.05077365040779114,-0.038148608058691025,-0.10017894953489304,0.19203712046146393,-0.24746230244636536,0.25715726613998413,0.28379520773887634,0.033995259553194046,0.13955406844615936,0.23946191370487213,0.34443309903144836,-0.293976366519928,-0.359406054019928,-0.24059660732746124,0.08124984800815582,-0.16473880410194397,-0.2907167375087738,-0.16501790285110474,0.25338780879974365,0.06040659919381142,0.1570020318031311,-0.13949955999851227,-0.13156822323799133,-0.13402576744556427,-0.24792514741420746,0.2414504587650299,0.1825091689825058,-0.33220550417900085,-0.14649845659732819},{-0.10485029965639114,0.15759459137916565,0.2784801125526428,-0.026255063712596893,-0.03915682062506676,0.06692300736904144,-0.027181634679436684,-0.3389609158039093,0.1874295026063919,0.24506837129592896,0.15781521797180176,0.23126961290836334,-0.2159983366727829,0.19777747988700867,-0.2560095191001892,0.302205890417099,0.16125811636447906,-0.26360616087913513,0.24609512090682983,0.08711656928062439,-0.3572744131088257,0.3248611092567444,-0.24888506531715393,0.15898065268993378,0.22287555038928986,0.25883790850639343,0.05612392723560333,0.13619978725910187,-0.17583975195884705,0.2303517609834671,-0.04384845867753029,0.09655647724866867},{-0.12001083791255951,-0.1088360846042633,-0.002480702009052038,0.18239115178585052,0.02139231562614441,0.2168567031621933,-0.2753940522670746,-0.11193349212408066,-0.13570649921894073,-0.07543235272169113,-0.1514115184545517,-0.1768442988395691,0.017952989786863327,-0.2008841186761856,0.08948028832674026,-0.20869527757167816,0.24725830554962158,-0.03311321884393692,-0.3194166421890259,-0.29341384768486023,0.1259661167860031,0.1694149374961853,-0.17068549990653992,0.3131839632987976,-0.2537785768508911,0.05637362226843834,0.10935743153095245,-0.09770496934652328,0.16118228435516357,-0.2189938873052597,0.30859941244125366,0.14446325600147247},{0.3102545142173767,0.05609889701008797,0.0745897963643074,0.22252257168293,-0.22688961029052734,0.16787096858024597,-0.08508358150720596,0.16052822768688202,0.10856875032186508,0.035751551389694214,0.09531588852405548,-0.32058218121528625,-0.25425615906715393,0.033811699599027634,0.08502910286188126,-0.07413546741008759,0.2649158537387848,0.14387117326259613,-0.18137119710445404,-0.21820105612277985,0.3344663679599762,0.18726585805416107,0.2443842589855194,0.07703737169504166,-0.02216786891222,0.05664536729454994,-0.05846988409757614,-0.15955546498298645,0.27754977345466614,0.028862372040748596,-0.18809622526168823,0.1145973950624466},{-0.0161676537245512,0.0215508621186018,-0.044352322816848755,-0.2622852325439453,-0.09173315763473511,-0.22205671668052673,-0.22275808453559875,-0.1384371519088745,-0.03039873205125332,-0.021329130977392197,-0.2624005973339081,0.020841393619775772,-0.23420365154743195,-0.16907961666584015,0.009856709279119968,0.10474686324596405,0.2678018808364868,-0.1779680997133255,-0.32343974709510803,0.2520041763782501,-0.18082982301712036,0.2676744759082794,0.028123343363404274,-0.03707756847143173,0.02461273781955242,0.17025239765644073,-0.07916202396154404,-0.25549110770225525,0.23005104064941406,0.2541660964488983,-0.11257700622081757,0.18710832297801971},{-0.23110134899616241,-0.027514461427927017,0.04365884140133858,-0.019659239798784256,0.10498600453138351,0.14194291830062866,-0.2004423439502716,0.10952935367822647,-0.15677109360694885,-0.13813859224319458,0.07250066846609116,-0.13019028306007385,-0.18207967281341553,0.25036782026290894,0.024374404922127724,0.04450209438800812,0.17952461540699005,-0.2594326436519623,-0.16363586485385895,0.2954625189304352,0.01521451398730278,0.2613629102706909,-0.0523209273815155,0.016392691060900688,-0.27031275629997253,-0.18316179513931274,-0.0016738722333684564,0.2958036959171295,-0.007118691224604845,0.006958267651498318,0.2923974394798279,0.3057425916194916}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.0901012271642685,0.1830655187368393,0.3751579225063324,-0.02322579175233841},{0.10876335203647614,-0.09362351149320602,0.06433873623609543,0.20259520411491394},{-0.1515476554632187,0.20867247879505157,0.12890073657035828,0.13646505773067474},{0.3188275396823883,0.016387367621064186,0.056380823254585266,0.4306989908218384},{-0.1113523542881012,0.09284147620201111,0.3259381949901581,-0.049593210220336914},{-0.11032508313655853,0.23115606606006622,0.24256998300552368,-0.11439314484596252},{-0.2900771200656891,-0.006236447487026453,0.011572226881980896,-0.11142502725124359},{-0.39084097743034363,-0.14912597835063934,0.3969632089138031,-0.29199689626693726},{0.34581565856933594,-0.1644592434167862,-0.2937542200088501,-0.3991811275482178},{0.06686622649431229,0.30906152725219727,0.3429758548736572,-0.4515811800956726},{-0.17168119549751282,-0.1638515144586563,-0.21002940833568573,0.20758666098117828},{0.33095458149909973,-0.2031785547733307,-0.009237131103873253,0.21093083918094635},{0.3130400776863098,0.29211872816085815,-0.070109061896801,0.10750818252563477},{0.027535121887922287,0.09860005974769592,-0.31693539023399353,0.01819673366844654},{0.10227012634277344,0.28208187222480774,0.3957362174987793,0.3391052782535553},{0.16134369373321533,0.03412574902176857,0.31695014238357544,0.2650511562824249},{-0.23188361525535583,-0.10277918726205826,-0.1131366416811943,-0.24584901332855225},{-0.21617022156715393,0.13010413944721222,-0.17756648361682892,-0.13009941577911377},{-0.20871277153491974,0.20051278173923492,0.17123758792877197,0.32928919792175293},{-0.03727048262953758,0.3485710620880127,-0.19414068758487701,0.07797666639089584},{-0.27166539430618286,-0.3958654999732971,-0.11829186230897903,0.024717142805457115},{0.35116514563560486,0.4483926594257355,0.03665648773312569,-0.28719139099121094},{-0.04849051311612129,0.17266987264156342,0.21856948733329773,0.17188818752765656},{-0.10442941635847092,0.3836641311645508,-0.0793011486530304,-0.14598853886127472},{0.035602424293756485,-0.04005264490842819,-0.09023100882768631,0.01567974127829075},{0.2849421501159668,-0.44167083501815796,-0.01210095826536417,0.04000090807676315},{0.011822293512523174,-0.3378199636936188,-0.20127329230308533,-0.2303081601858139},{0.11255426704883575,-0.1261289268732071,0.23522210121154785,0.17371582984924316},{0.006833977531641722,-0.0681605339050293,0.09949031472206116,0.029676413163542747},{-0.36085641384124756,0.363315612077713,0.23949699103832245,-0.08100282400846481},{0.3453463912010193,-0.14749382436275482,0.2078331857919693,-0.0634770467877388},{0.07322634011507034,-0.38539379835128784,0.42340001463890076,-0.31284478306770325}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.05381474271416664,-0.024982202798128128,0.029647856950759888,-0.027706842869520187,-0.04175363481044769,-0.1538613736629486,-0.028952471911907196,0.05621321499347687,0.02696317434310913,-0.06454040110111237,0.11283362656831741,0.06930489838123322,-0.03881847858428955,-0.07954653352499008,0.08800298720598221,-0.04629845917224884};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.07040159404277802,0.0483495369553566,0.0341930165886879,0.03217829763889313,0.05521669238805771,-0.00036542079760693014,0.06668754667043686,-0.01738165132701397,0.0009572468115948141,0.010335206054151058,-0.028405362740159035,-0.03647417202591896,0.06833142787218094,-0.021970676258206367,-0.030842166393995285,-0.02492092177271843};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06975557655096054,0.06312476098537445,0.019435495138168335,0.05970039591193199,0.045617979019880295,-0.018399089574813843,-0.040873657912015915,-0.014165498316287994,-0.029301904141902924,-0.00148166180588305,-0.04250518977642059,0.05017523095011711,0.051859091967344284,-0.06385739892721176,0.07527972012758255,0.06860948354005814,-0.06744105368852615,-0.05938420444726944,0.014338327571749687,0.019817044958472252,-0.032855696976184845,0.0009642689255997539,0.05696967989206314,0.006256911903619766,-0.02010628953576088,0.013811547309160233,-0.04063532501459122,0.05389706790447235,0.03793928399682045,0.0024188202805817127,0.03320636600255966,0.04122554883360863};
static const float action_parameterization_distribution_linear_bias[4] = {0.03893963247537613,0.004917471203953028,0.050687551498413086,0.05023343488574028};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.006585250608623028,0.276144415140152,-0.093609519302845,0.15021876990795135,0.2732640206813812,0.1481536328792572,0.2762954533100128,0.03709521144628525},{-0.19098766148090363,-0.058055680245161057,-0.22682838141918182,-0.2800076901912689,-0.2672405242919922,-0.15207362174987793,-0.16100618243217468,-0.14352785050868988},{-0.24299480020999908,0.03360376134514809,0.27216917276382446,0.188106968998909,0.2536742389202118,0.003733451245352626,0.220404252409935,-0.09174130856990814},{0.036111120134592056,0.09709377586841583,-0.16130168735980988,-0.03795838728547096,-0.014592321589589119,-0.05560847371816635,0.21222235262393951,-0.1633036732673645},{-0.24071595072746277,-0.11870056390762329,-0.23563018441200256,-0.14333513379096985,-0.04900210723280907,0.1595066785812378,0.13485710322856903,-0.0021348572336137295},{-0.28150832653045654,0.0360318087041378,0.3565380871295929,0.2499920129776001,0.18669259548187256,-0.12487529963254929,-0.13408298790454865,-0.107502780854702},{-0.20726977288722992,0.09530895948410034,0.324634850025177,-0.20280280709266663,-0.09464159607887268,-0.405941903591156,-0.10338428616523743,-0.11631805449724197},{-0.4211057424545288,-0.3477934002876282,0.49734655022621155,-0.05200772359967232,-0.23444201052188873,0.1456465721130371,0.1424274444580078,-0.18186631798744202},{-0.3385804295539856,0.23488709330558777,-0.1681993305683136,0.44137099385261536,0.06877294182777405,-0.39649537205696106,0.06975220888853073,0.12491792440414429},{-0.32708632946014404,-0.3368433117866516,-0.13585267961025238,-0.1311074197292328,-0.5224283933639526,0.040790632367134094,-0.02060592919588089,0.14122062921524048},{0.15431374311447144,0.33768966794013977,0.2095937430858612,0.022489523515105247,0.19142302870750427,0.06288602203130722,-0.24187496304512024,0.21377095580101013},{0.21558444201946259,0.02030637487769127,0.28038501739501953,0.26393142342567444,-0.22005882859230042,0.2838287651538849,-0.012535136193037033,-0.23422783613204956},{0.1265541911125183,-0.2519501745700836,0.27698829770088196,-0.03307948634028435,-0.209716334939003,-0.04599394276738167,-0.15300613641738892,-0.15111154317855835},{-0.20334839820861816,-0.12299182265996933,0.3234832286834717,0.3893238306045532,-0.10970725864171982,-0.043664269149303436,-0.2665480673313141,0.15488006174564362},{0.0029043175745755434,-0.15050888061523438,0.0846601352095604,-0.18539027869701385,-0.34030184149742126,-0.11514046043157578,0.22259046137332916,-0.014523535966873169},{0.08894304186105728,-0.06064591929316521,-0.05004682391881943,-0.2903619408607483,-0.10322500020265579,0.07309199869632721,-0.036134134978055954,0.3906700015068054},{-0.02670367620885372,-0.21143187582492828,-0.203885018825531,0.0394207201898098,-0.14030133187770844,-0.1356281042098999,-0.11497489362955093,0.08447247743606567},{-0.21385350823402405,-0.26517680287361145,0.06491722166538239,0.005424285773187876,0.16087816655635834,-0.21504013240337372,0.3683064877986908,0.14445990324020386},{0.013048707507550716,0.1458360254764557,-0.2284618765115738,0.0893402174115181,0.1352156698703766,0.14462733268737793,-0.18604497611522675,0.285334974527359},{0.15954473614692688,-0.06133345887064934,-0.35735347867012024,0.07464899867773056,-0.08113384991884232,-0.10955873876810074,-0.28607672452926636,-0.00748063251376152},{0.03490670397877693,-0.15134704113006592,0.023937765508890152,-0.1138581782579422,0.24866557121276855,-0.07149949669837952,-0.06086070463061333,0.43242719769477844},{0.010125583037734032,0.1074129268527031,-0.328701913356781,0.21831749379634857,0.25147169828414917,0.26710596680641174,0.10529038310050964,-0.27371615171432495},{-0.40312767028808594,-0.11459571123123169,0.09891371428966522,-0.09230241924524307,0.13483597338199615,-0.35545265674591064,0.1291029006242752,-0.24479594826698303},{-0.09944619238376617,0.1102626621723175,-0.0859377384185791,-0.4561831057071686,0.21850408613681793,0.031676072627305984,-0.3670470118522644,0.15179386734962463},{-0.1914176493883133,-0.1904635727405548,-0.07918975502252579,0.06822911649942398,0.060788240283727646,0.27039963006973267,0.2794840633869171,-0.059902485460042953},{-0.2040250450372696,0.05889168381690979,-0.318545937538147,-0.26328423619270325,0.1254446655511856,0.01069365069270134,-0.08713008463382721,0.08036906272172928},{0.2930968701839447,0.3652646541595459,-0.21811676025390625,0.22768445312976837,0.08834341168403625,0.29027193784713745,-0.2968226671218872,-0.15622104704380035},{0.3863620460033417,0.2391987442970276,0.12427827715873718,0.10917427390813828,0.1861351877450943,0.05292560160160065,0.22832609713077545,0.3793064057826996},{-0.12433341145515442,0.37133410573005676,0.19469286501407623,0.05415825918316841,0.21540462970733643,-0.010585029609501362,-0.38264867663383484,-0.2754438817501068},{-0.15995576977729797,-0.23118643462657928,0.05646853893995285,-0.16542354226112366,-0.2813715636730194,-0.2141629457473755,0.24761268496513367,-0.013585969805717468},{0.4180617332458496,-0.2804476320743561,0.2868330478668213,-0.253452330827713,0.1044684424996376,0.24515314400196075,0.10799247026443481,-0.15903441607952118},{0.216593936085701,0.38609713315963745,0.4268781542778015,-0.2300686240196228,-0.1818288415670395,0.0778319463133812,0.2331283986568451,0.07476387172937393}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.0002976454852614552,0.39532843232154846,-0.17833656072616577,0.24880799651145935,-0.39754951000213623,0.24537286162376404,0.43216049671173096,0.05890733003616333},{-0.422035276889801,-0.472060889005661,-0.3620395362377167,-0.41150522232055664,-0.41255468130111694,0.40860801935195923,0.45758041739463806,-0.402964323759079},{-0.016943344846367836,-0.14833606779575348,0.10797040164470673,0.0069154431112110615,-0.08293809741735458,0.43073615431785583,-0.3242112100124359,-0.3333854079246521},{0.46616411209106445,0.0014068989548832178,0.0745563730597496,0.004238707013428211,0.5503994226455688,0.3539607524871826,0.3890797197818756,0.43302372097969055},{0.08352905511856079,0.22416552901268005,-0.13722680509090424,-0.06008652225136757,0.1194482073187828,-0.32611772418022156,-0.3679102063179016,0.46440133452415466},{0.3994447588920593,0.09926149249076843,0.020904002711176872,-0.36448240280151367,-0.4162384569644928,-0.46069610118865967,-0.11414340138435364,0.49066174030303955},{-0.3922809660434723,-0.3188282251358032,-0.015122165903449059,-0.21471261978149414,0.051068395376205444,0.38010549545288086,-0.518972635269165,0.5828197598457336},{0.17858150601387024,0.06390713155269623,0.020455429330468178,-0.048428166657686234,0.3465651571750641,-0.5267179608345032,0.4082879424095154,-0.45635131001472473}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.06389037519693375,0.04054638370871544,0.0816817507147789,-0.032044023275375366,-0.04926640912890434,-0.04161956161260605,0.08719785511493683,-0.028592541813850403};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.041772983968257904,-0.03305159509181976,0.03291478380560875,-0.11161526292562485,-0.007738000247627497,0.009676417335867882,0.0009284663829021156,-0.05543667450547218};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

