#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3222554326057434,0.03781522437930107,0.06290315091609955,0.26460355520248413,0.2847840487957001,-0.220123291015625,-0.30913957953453064,0.12785246968269348,0.38007140159606934,-0.3032892048358917,0.4557912349700928,0.08652511984109879,0.25026023387908936,0.08585750311613083,-0.3154134452342987,0.01501149870455265},{-0.32458174228668213,-0.21322180330753326,-0.24565865099430084,-0.07741952687501907,0.18043045699596405,0.4116331934928894,0.17859134078025818,-0.017157524824142456,0.20016396045684814,0.24615155160427094,-0.07670675218105316,0.0003768962051253766,-0.09711417555809021,0.10282519459724426,0.30204734206199646,-0.21894419193267822},{-0.006989651825278997,0.1917901486158371,0.2460889369249344,0.341332346200943,0.06692308932542801,-0.3017042875289917,0.8802096843719482,-0.2930653393268585,-0.24094192683696747,0.00431167334318161,-0.028485609218478203,-0.2504509687423706,0.36854466795921326,0.632461667060852,-0.5478997230529785,0.17697127163410187},{0.16953247785568237,-0.16170327365398407,-0.14482784271240234,-0.011803870089352131,-0.16383007168769836,0.11870844662189484,-0.06528197973966599,-0.22823479771614075,0.0036798990331590176,-0.08193591237068176,0.6007401943206787,-0.21821971237659454,-0.3522452116012573,-0.1896878480911255,0.22901923954486847,-0.048484768718481064},{-0.1791170984506607,-0.028167830780148506,0.17263707518577576,-0.42142626643180847,0.473359078168869,0.2424076497554779,0.23083116114139557,-0.1991378664970398,-0.19159074127674103,0.2950243651866913,-0.08015187084674835,-0.43511727452278137,-0.011904124170541763,-0.22181974351406097,0.42757943272590637,-0.023491844534873962},{-0.03203397989273071,-0.13919545710086823,-0.08394747972488403,-0.06981790065765381,0.05204235762357712,-0.23597872257232666,0.6012030243873596,-0.31454718112945557,-0.24205495417118073,-0.23101527988910675,0.159315824508667,0.05283466354012489,0.3046174645423889,0.02134671062231064,0.3038382828235626,0.24484916031360626},{-0.12826207280158997,0.2687917649745941,-0.016983715817332268,0.11606678366661072,-0.2754538357257843,-0.09800715744495392,-0.06960254162549973,0.030760999768972397,0.3307812809944153,0.2914280295372009,-0.3237350881099701,-0.14301632344722748,0.25452154874801636,-0.0967395082116127,-0.08311119675636292,0.22843153774738312},{-0.38228800892829895,0.2554095387458801,-0.018722238019108772,-0.3202793598175049,0.3414854407310486,-0.2963077127933502,-0.36963751912117004,-0.5538696050643921,-0.08486148715019226,-0.23928764462471008,0.5758878588676453,0.1685035675764084,-0.023474086076021194,0.5089759230613708,0.04393122345209122,0.6864886283874512},{0.30572381615638733,0.1444217711687088,-0.2414681315422058,0.030220378190279007,-0.6400761008262634,-0.5992557406425476,0.1820824146270752,-0.5984395742416382,-0.053826265037059784,-0.18000175058841705,0.3559449315071106,-0.6232767701148987,-0.518206775188446,0.10198897868394852,0.04142667353153229,-0.3319784700870514},{0.685663640499115,-0.8887316584587097,-0.4071887135505676,0.11303449422121048,0.17150723934173584,-0.341145783662796,-0.0102918716147542,-0.2021755576133728,-0.42848655581474304,-0.048132073134183884,-0.30108290910720825,-0.32834914326667786,0.5691033601760864,-0.3185199499130249,-0.7078622579574585,-0.3038349747657776},{0.3296520709991455,0.30812206864356995,-0.12393210083246231,0.08916392177343369,0.06392474472522736,-0.1840951144695282,-0.11905592679977417,0.16225697100162506,-0.03856880962848663,0.1963275521993637,0.16765016317367554,0.22138114273548126,-0.14437714219093323,0.1237039789557457,0.046462755650281906,-0.3599110245704651},{-0.43562084436416626,0.2776772081851959,0.6061273813247681,-0.9353354573249817,0.1637662947177887,0.1897742599248886,0.16079320013523102,0.35547685623168945,0.3187713027000427,0.48337703943252563,0.4733882546424866,-0.4012230634689331,0.34135517477989197,-0.21660415828227997,0.06744726747274399,-0.23127733170986176},{0.12608025968074799,-0.3138529658317566,-0.28769052028656006,0.32751017808914185,-0.2141040712594986,-0.2998266816139221,-0.06845855712890625,0.31974732875823975,0.2664843499660492,-0.15229439735412598,-0.2368478626012802,0.27194032073020935,0.3780507445335388,0.33509910106658936,-0.21510279178619385,0.6385464072227478},{0.2592256963253021,0.30244722962379456,-0.31697317957878113,0.08178923279047012,-0.10573485493659973,-0.12039822340011597,-0.27109014987945557,0.21943475306034088,-0.24266107380390167,-0.35504525899887085,-0.060978714376688004,0.08578468859195709,-0.5699977278709412,-0.11493849009275436,-0.2811262905597687,-0.17651382088661194},{0.15760543942451477,0.5787723064422607,0.37388911843299866,-0.404518723487854,-0.39530208706855774,0.2582675516605377,-0.10476081818342209,0.041834164410829544,0.5201095938682556,0.2578546702861786,-0.220228374004364,0.14102555811405182,-0.23463234305381775,-0.35686689615249634,0.1750081181526184,-0.34632590413093567},{-0.3109528720378876,-0.04411866515874863,-0.033264949917793274,0.2233573943376541,-0.02036629617214203,0.025546450167894363,-0.14697693288326263,-0.009578889235854149,-0.370470255613327,-0.09075182676315308,0.24780027568340302,0.08390189707279205,-0.19294923543930054,-0.22170288860797882,-0.3887760639190674,-0.09991489350795746},{-0.2851658761501312,0.15254873037338257,-0.18437077105045319,0.004982508718967438,-0.12040675431489944,0.32886508107185364,0.3175326883792877,0.14079615473747253,0.22240012884140015,-0.23966284096240997,-0.052335627377033234,-0.10970435291528702,-0.017032312229275703,0.03518003225326538,-0.012512280605733395,-0.14669130742549896},{0.1289815455675125,-0.4235510230064392,0.1501770168542862,0.17649130523204803,0.016549203544855118,0.28117626905441284,0.3219287395477295,0.1256154626607895,-0.12778382003307343,-0.234090194106102,-0.11023512482643127,-0.1367553174495697,-0.12899655103683472,-0.38580459356307983,0.06409260630607605,0.021943451836705208}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14689141511917114,0.3121272921562195,0.3536595404148102,-0.0766742005944252,-0.1779508888721466,0.03521856665611267,0.08029992133378983,0.24816745519638062,-0.06556805968284607,0.3004377782344818,0.4719526767730713,-0.36427396535873413,-0.11106330901384354,0.07035399973392487,0.011672540567815304,-0.03439122065901756},{-0.5273107290267944,0.2371174395084381,-0.28092700242996216,0.2689158618450165,0.35084113478660583,-0.12092938274145126,-0.3177250623703003,-0.28680360317230225,0.26895108819007874,0.3152267634868622,-0.07280299067497253,0.2113220989704132,-0.3143102526664734,0.17252683639526367,-0.269839346408844,0.4144507348537445},{-0.3956177234649658,0.18302591145038605,-0.3437958061695099,0.050249483436346054,-0.3955853283405304,-0.28574565052986145,-0.107404425740242,0.02829136699438095,-0.22288338840007782,0.3428475856781006,0.20298349857330322,-0.06260225921869278,0.22059835493564606,-0.349620521068573,-0.05206984281539917,0.03398379310965538},{0.2295706868171692,-0.22091972827911377,0.08188123255968094,0.4411364495754242,-0.45978447794914246,-0.33414962887763977,0.25301262736320496,0.1276395618915558,0.30595606565475464,-0.07444127649068832,0.2682061493396759,0.10375808924436569,-0.2543800473213196,-0.060103293508291245,-0.017918366938829422,-0.3529515862464905},{-0.3359605669975281,0.0018426482565701008,0.22734186053276062,-0.35389214754104614,0.12538276612758636,0.2932431399822235,-0.3170240521430969,0.25931212306022644,-0.21414636075496674,0.1799720972776413,-0.13490787148475647,0.0002783944655675441,-0.16017070412635803,0.003618864808231592,-0.19740749895572662,-0.1922483891248703},{0.004012161400169134,-0.21441048383712769,-0.04031051695346832,-0.3733079731464386,0.2887093126773834,0.07839547842741013,-0.018805470317602158,-0.09241492301225662,-0.21578827500343323,0.35583725571632385,0.3133434057235718,-0.08555613458156586,-0.1627834439277649,0.24821104109287262,-0.07195901870727539,-0.3641815781593323},{0.21586254239082336,-0.1651432365179062,0.29075244069099426,-0.3070971965789795,-0.3811885714530945,-0.04661322012543678,-0.3819081783294678,0.34277260303497314,-0.13822506368160248,-0.2577095627784729,-0.25548380613327026,-0.024498572573065758,-0.054587725549936295,-0.06762074679136276,0.459859162569046,-0.3919234871864319},{-0.3038271963596344,0.3822397291660309,-0.0565781444311142,0.24115563929080963,0.005007725674659014,-0.2470960170030594,-0.1212395653128624,0.10237196087837219,-0.0544305257499218,0.49345457553863525,0.13288430869579315,-0.21862046420574188,0.054202668368816376,-0.09157375991344452,0.06879377365112305,0.16362106800079346},{0.14807678759098053,0.2738092243671417,-0.16719627380371094,-0.3545951843261719,0.3701784610748291,-0.2107701152563095,0.2467310130596161,-0.36512258648872375,0.06906797736883163,0.021029530093073845,0.1338631510734558,0.10394468158483505,-0.00816746149212122,-0.2512427866458893,-0.09795885533094406,0.20223915576934814},{-0.19521257281303406,-0.011137930676341057,-0.28092414140701294,-0.32380250096321106,0.23946447670459747,-0.45417752861976624,-0.19798453152179718,0.25485795736312866,-0.09589263796806335,0.1822950392961502,0.015890643000602722,-0.06716658920049667,-0.3625761866569519,-0.006801974028348923,-0.21796634793281555,-0.3519311845302582},{-0.24002137780189514,-0.09657837450504303,-0.10119526833295822,-0.3326747417449951,-0.3338155150413513,-0.0009189300471916795,0.13345101475715637,-0.4670698344707489,0.006616425700485706,-0.04998810216784477,0.1387154459953308,-0.0040242429822683334,0.387474924325943,0.03510027751326561,0.2082483321428299,0.23221571743488312},{-0.2195582389831543,-0.05233709141612053,-0.42066580057144165,0.38052916526794434,0.12166116386651993,0.03788769617676735,0.15844929218292236,0.06566736102104187,-0.3707900643348694,0.21682222187519073,-0.38065046072006226,-0.1377977728843689,-0.36495134234428406,0.3978496491909027,-0.33468741178512573,0.10312746465206146},{-0.12181726843118668,-0.44900891184806824,-0.07558639347553253,0.14925888180732727,-0.19689059257507324,-0.09943962097167969,-0.0713365375995636,0.35894882678985596,0.42340677976608276,0.08609440177679062,-0.09948541969060898,-0.25448524951934814,0.1699184775352478,-0.3308659493923187,0.15948785841464996,-0.20973701775074005},{-0.24850551784038544,-0.48201337456703186,-0.17656798660755157,-0.12374459952116013,-0.47396597266197205,0.34902963042259216,-0.0672350600361824,0.20127741992473602,-0.19881030917167664,-0.3326314091682434,-0.29218703508377075,0.39234068989753723,-0.17576490342617035,0.08664022386074066,-0.26251521706581116,0.35022082924842834},{-0.32702264189720154,0.32428452372550964,-0.1708977222442627,0.09097231179475784,-0.362752765417099,0.15488743782043457,0.05275567248463631,-0.37532663345336914,0.10529419779777527,0.15433891117572784,-0.12207702547311783,0.07833622395992279,0.289798378944397,-0.22092461585998535,-0.32869696617126465,-0.15611526370048523},{-0.16301824152469635,-0.37628403306007385,-0.5184435844421387,0.293251633644104,0.05437494441866875,0.12607406079769135,-0.2551618218421936,0.18822208046913147,-0.41137558221817017,-0.3159652352333069,-0.4027215242385864,0.252453088760376,-0.23710182309150696,0.20432022213935852,0.09443145245313644,0.3547224700450897}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.060124970972537994,-0.09002900123596191,0.15219497680664062,-0.10284435003995895,-0.08348239213228226,0.12427670508623123,0.19273529946804047,-0.23738409578800201,-0.1916998028755188,0.28057512640953064,0.10235096514225006,0.11907406896352768,0.08009233325719833,0.1333255022764206,-0.17311516404151917,0.15341182053089142,0.11980345845222473,-0.30521202087402344,-0.2007269263267517,-0.07674305886030197,-0.16873440146446228,0.0865376740694046,-0.18079015612602234,0.3469941318035126,-0.18087749183177948,-0.04476159065961838,0.10048287361860275,0.19073182344436646,-0.20298327505588531,-0.16861891746520996,0.21601390838623047,0.25155240297317505},{0.1541978269815445,-0.0608920156955719,0.17068073153495789,-0.10861137509346008,-0.07356470823287964,0.23605674505233765,0.04627734050154686,-0.04350600764155388,-0.03904900699853897,-0.05421100929379463,-0.09593158215284348,-0.001921646180562675,0.37052926421165466,0.21054597198963165,0.10565821826457977,0.032622549682855606,-0.23324204981327057,-0.2659475803375244,0.12321287393569946,0.03344101458787918,0.09678135812282562,0.2844902575016022,0.28154456615448,-0.15743817389011383,0.04444965347647667,0.2765958905220032,-0.35952919721603394,0.20340745151042938,0.04056442901492119,-0.23328228294849396,-0.09241494536399841,-0.02296404354274273},{-0.058912452310323715,-0.07266085594892502,0.2183825522661209,-0.18038959801197052,-0.14460070431232452,0.07538342475891113,-0.19602446258068085,0.21310557425022125,0.18812887370586395,0.023621635511517525,-0.19528385996818542,0.01960110105574131,0.3254057466983795,-0.2682683765888214,0.10731055587530136,-0.056426454335451126,-0.3572823405265808,0.2522500455379486,-0.3107551634311676,-0.05054619535803795,-0.05033073574304581,-0.10791608691215515,-0.03729229047894478,-0.039066825062036514,-0.04038485139608383,0.34525248408317566,-0.08900904655456543,0.09083841741085052,0.22889433801174164,-0.3158680200576782,-0.14428743720054626,-0.015394804999232292},{0.1451198309659958,-0.20465479791164398,0.0030419377144426107,-0.36707907915115356,0.06850571185350418,-0.13811643421649933,-0.07325873523950577,0.19076299667358398,0.05725693330168724,0.20142441987991333,0.05204694718122482,-0.11098256707191467,-0.20446372032165527,-0.02641700953245163,0.24120476841926575,-0.21178078651428223,0.04739414155483246,-0.0837181806564331,-0.15187504887580872,0.11911027133464813,-0.1490291804075241,0.1330849528312683,-0.26783427596092224,0.26568010449409485,-0.23279239237308502,0.06564463675022125,-0.05103788152337074,-0.2191145420074463,0.14118194580078125,-0.0034517550375312567,0.23532888293266296,-0.14432962238788605},{0.26297229528427124,-0.05134381353855133,0.012558923102915287,0.2521663308143616,-0.3064676523208618,-0.086691714823246,0.1741454303264618,-0.017745034769177437,0.13319960236549377,-0.17449048161506653,-0.000191644809092395,-0.08280805498361588,-0.19910956919193268,-0.13194935023784637,0.2822847366333008,0.2382245510816574,-0.04343251511454582,-0.31248074769973755,0.11089009791612625,-0.12713481485843658,-0.13637614250183105,0.23303340375423431,0.24069590866565704,0.018146034330129623,-0.10416314005851746,-0.1013982817530632,0.04778357222676277,0.24568673968315125,0.18756525218486786,0.09589114785194397,0.12448429316282272,-0.22011743485927582},{0.30479303002357483,-0.14443743228912354,0.013793649151921272,0.08764036744832993,-0.11470254510641098,-0.31049230694770813,-0.22805902361869812,-0.3076152205467224,-0.19305160641670227,0.032801494002342224,-0.026915380731225014,0.01686893217265606,-0.10251317173242569,-0.07872274518013,-0.20291203260421753,-0.2633734941482544,0.16183145344257355,0.0014576137764379382,-0.3218022584915161,0.20079919695854187,-0.07853573560714722,-0.19485102593898773,0.20445643365383148,-0.1476806104183197,-0.16572043299674988,-0.21787557005882263,-0.11630256474018097,0.08080650866031647,0.055429648607969284,0.23520365357398987,-0.25983142852783203,0.2000938206911087},{0.1721978485584259,0.09617625921964645,0.22493599355220795,-0.16108438372612,0.24546276032924652,-0.2116396725177765,-0.28539466857910156,0.008464143611490726,0.26993733644485474,0.11612312495708466,-0.14185810089111328,0.12023777514696121,0.05588604509830475,0.29900023341178894,0.09310577064752579,-0.05171796679496765,-0.18389485776424408,0.10045427083969116,-0.0034834148827940226,-0.0595766045153141,-0.05189526453614235,0.18524454534053802,0.17104169726371765,0.10487481206655502,-0.25351399183273315,-0.20012906193733215,-0.25855451822280884,-0.30491122603416443,0.1315038800239563,-0.14503297209739685,0.322588175535202,0.18115198612213135},{0.31457456946372986,-0.35551080107688904,0.08374206721782684,-0.40495532751083374,-0.3389277160167694,0.282272607088089,0.3966081142425537,0.17132887244224548,-0.06975220888853073,0.08683546632528305,0.17494334280490875,-0.13099989295005798,0.06978566199541092,0.30169257521629333,-0.03553527221083641,0.20942363142967224,0.38673973083496094,-0.2657124698162079,-0.061047058552503586,-0.3643019497394562,0.188386008143425,0.22606465220451355,0.19718116521835327,0.14162880182266235,0.13305695354938507,0.11544299125671387,0.16244103014469147,0.2677886486053467,-0.05184900388121605,-0.2729649543762207,0.23803967237472534,0.03812612220644951},{0.07079799473285675,-0.11437597870826721,0.2215464860200882,0.25545910000801086,-0.2010570615530014,-0.26688963174819946,-0.06555698812007904,0.2573621869087219,-0.19279775023460388,-0.15779276192188263,0.006353499833494425,0.08864627033472061,0.15726067125797272,-0.3226635158061981,0.15970711410045624,-0.1864231526851654,-0.1969994604587555,0.17051418125629425,-0.26665636897087097,0.27691328525543213,-0.3686569333076477,-0.2822021245956421,-0.3096172511577606,0.26234543323516846,0.08168890327215195,0.06634270399808884,0.3082442283630371,0.2000182420015335,-0.1482100635766983,-0.3186466097831726,-0.15400820970535278,0.175464928150177},{0.3067203462123871,0.04400307685136795,0.020084958523511887,0.23364129662513733,0.027744721621274948,0.23637787997722626,-0.06571772694587708,0.21589598059654236,-0.03481674939393997,0.02838888391852379,0.15908654034137726,0.1171286478638649,-0.06443509459495544,-0.2980710566043854,0.1808575838804245,0.18945211172103882,-0.01614830642938614,-0.13810041546821594,-0.023712502792477608,0.031735725700855255,0.08112432062625885,-0.3034849166870117,0.3430696725845337,0.04715443029999733,-0.03982534259557724,0.10869342088699341,-0.3789009749889374,-0.17982995510101318,-0.04611397907137871,0.006022601388394833,0.08875850588083267,0.18916955590248108},{-0.07980377972126007,0.09270418435335159,-0.048853904008865356,0.19038088619709015,-0.05291752517223358,0.3174974322319031,0.11357252299785614,-0.06355727463960648,0.2478371113538742,-0.3000369966030121,-0.1599850058555603,0.13609622418880463,-0.08913778513669968,0.05548594146966934,-0.2842600643634796,0.0412399061024189,0.07444994896650314,0.15651777386665344,0.11044633388519287,-0.12461355328559875,-0.2571292519569397,0.16692540049552917,0.2628838121891022,0.22671975195407867,-0.3332386016845703,0.32597261667251587,-0.1868051290512085,0.029316425323486328,-0.1089264526963234,0.14932243525981903,0.20218302309513092,0.2519853711128235},{-0.16695329546928406,0.2515110671520233,-0.09512078762054443,-0.01961047761142254,-0.21805450320243835,-0.12904983758926392,0.1551564335823059,-0.2685854136943817,-0.010312815196812153,-0.19740541279315948,-0.25337904691696167,-0.0755121111869812,0.16498392820358276,-0.29971009492874146,-0.10474229604005814,-0.37700650095939636,-0.1541575789451599,-0.014021643437445164,0.25707969069480896,-0.3033676743507385,0.042092569172382355,-0.11776205152273178,0.01886066235601902,0.2929331958293915,-0.15733188390731812,0.14885170757770538,0.29259029030799866,-0.13326683640480042,-0.08761844784021378,0.3019544184207916,-0.14877371490001678,-0.2503855228424072},{-0.05864948406815529,0.22793054580688477,0.23807263374328613,-0.34895214438438416,0.32078567147254944,0.03475508838891983,-0.11610296368598938,-0.00558844581246376,0.13482333719730377,-0.2933471202850342,-0.048725735396146774,0.018989110365509987,0.2206626832485199,0.03139813244342804,0.004515735898166895,-0.03657056391239166,0.2421264350414276,-0.285512775182724,0.33301135897636414,0.08151751011610031,-0.17237219214439392,0.20698824524879456,-0.0871196836233139,-0.20751921832561493,0.24935485422611237,-0.09874847531318665,-0.027488259598612785,-0.1308283805847168,0.013151581399142742,-0.12200647592544556,0.2822912335395813,0.24982444941997528},{0.11191630363464355,-0.18027888238430023,-0.15965712070465088,0.1057315543293953,0.08637405186891556,0.2796737253665924,-0.10719718784093857,-0.2413673847913742,0.2713008522987366,0.0404471829533577,0.05179138481616974,0.04959757998585701,-0.2149745374917984,0.08116158097982407,-0.1689336597919464,-0.2555113434791565,0.052331991493701935,-0.034774988889694214,0.22334600985050201,0.3483011722564697,-0.21792055666446686,0.08464351296424866,-0.12264539301395416,0.017866823822259903,0.059192124754190445,-0.27147558331489563,-0.15484048426151276,-0.2237415313720703,-0.04339507594704628,-0.12871257960796356,0.24866168200969696,-0.3045429587364197},{-0.016165537759661674,0.30424490571022034,0.1872044801712036,-0.17719008028507233,-0.08262932300567627,-0.15903237462043762,0.1663503646850586,-0.07600224763154984,0.19129329919815063,0.0019009438110515475,0.19923056662082672,0.14184895157814026,0.02806059643626213,0.049589719623327255,-0.10146813839673996,0.21219778060913086,-0.21403808891773224,-0.3697815239429474,-0.2362280637025833,0.1551784723997116,0.07819420099258423,-0.23300795257091522,-0.2958202660083771,-0.1934189647436142,-0.24028447270393372,0.027930494397878647,0.3253636062145233,-0.004559308290481567,-0.07855499535799026,0.1314292848110199,-0.16440925002098083,0.0685473382472992},{-0.19605451822280884,-0.1869875192642212,-0.24727444350719452,0.06503469496965408,-0.2751089334487915,-0.11849415302276611,-0.10171781480312347,-0.1155225932598114,-0.2877589464187622,-0.17279765009880066,0.09726445376873016,0.17276665568351746,-0.2627386450767517,0.26462939381599426,-0.0318695567548275,0.18698672950267792,0.04766165465116501,0.007740676868706942,0.029877057299017906,0.11185985803604126,0.15164166688919067,0.321704238653183,0.0837448239326477,0.2180602103471756,0.11393394321203232,-0.23774190247058868,-0.12343322485685349,0.2671947479248047,0.03134545311331749,-0.22900213301181793,-0.1502004861831665,-0.14831210672855377},{-0.3024575412273407,-0.21986545622348785,-0.36984580755233765,0.06772274523973465,-0.13946691155433655,-0.09361319988965988,-0.13791200518608093,0.06892435997724533,-0.021079840138554573,0.09321268647909164,-0.256613552570343,0.0119353411719203,0.14938504993915558,-0.038508590310811996,0.02435273490846157,0.17930901050567627,-0.16115792095661163,-0.0806160718202591,0.14210228621959686,0.10394871979951859,0.20850102603435516,0.010808049701154232,-0.27383583784103394,0.07137712836265564,0.21106210350990295,-0.3012353479862213,0.18534761667251587,-0.008455715142190456,0.0441136434674263,-0.1437089890241623,0.1973862648010254,-0.09678404778242111},{0.26317763328552246,-0.051183100789785385,0.054708417505025864,0.12823759019374847,-0.296593576669693,-0.008500231429934502,0.15366071462631226,0.2044999748468399,-0.07967128604650497,-0.11194635182619095,0.31403177976608276,-0.16940462589263916,-0.01163655798882246,-0.04632788151502609,-0.15147681534290314,0.21914666891098022,0.00796776544302702,-0.061643682420253754,0.11833730340003967,-0.2757830321788788,0.0377095490694046,-0.30996325612068176,-0.24246270954608917,0.256755530834198,-0.1329103708267212,-0.1299719363451004,0.16766928136348724,-0.010340099222958088,-0.17653323709964752,-0.005556029267609119,-0.09019799530506134,-0.04209548234939575},{0.29815226793289185,-0.03772112727165222,0.05927300080657005,0.06769488751888275,-0.01373138464987278,-0.12317308783531189,0.14477193355560303,-0.23557238280773163,0.23242413997650146,0.27217480540275574,0.012644494883716106,0.17588023841381073,0.2482575625181198,0.33215630054473877,-0.29945844411849976,-0.29395219683647156,-0.307941198348999,0.0270841084420681,-0.1501503437757492,-0.3105070888996124,-0.18390250205993652,0.2841563820838928,0.06653768569231033,0.11984652280807495,-0.13712124526500702,-0.0698108896613121,-0.14178860187530518,-0.18594548106193542,0.2684382200241089,0.14727671444416046,-0.2734091877937317,-0.13888688385486603},{-0.11204498261213303,0.18704064190387726,0.2941695749759674,-0.04590573161840439,-0.013832789845764637,0.0509454719722271,-0.013657880015671253,-0.3202362358570099,0.19319593906402588,0.23260030150413513,0.19801878929138184,0.2251703143119812,-0.26429376006126404,0.2051248699426651,-0.2716875970363617,0.31144192814826965,0.12940603494644165,-0.2612939774990082,0.2630164325237274,0.12475063651800156,-0.28705066442489624,0.2806317210197449,-0.30923032760620117,0.1045469418168068,0.16298803687095642,0.22754383087158203,0.09135797619819641,0.11557941138744354,-0.23540198802947998,0.24443237483501434,-0.09360398352146149,0.10457292944192886},{-0.1296679526567459,-0.05214305594563484,0.06331434100866318,0.23642119765281677,-0.005820717662572861,0.21502485871315002,-0.3297288119792938,-0.18178105354309082,-0.20035342872142792,-0.10766464471817017,-0.17890360951423645,-0.1357221156358719,0.07574602216482162,-0.10957324504852295,0.13950985670089722,-0.1537281572818756,0.11926639080047607,-0.009425072930753231,-0.2882160246372223,-0.20991015434265137,0.08655101805925369,0.20723573863506317,-0.14746622741222382,0.3379928171634674,-0.30614614486694336,0.05534704774618149,0.07979188859462738,-0.09521519392728806,0.03378742188215256,-0.2022686004638672,0.309291273355484,0.0476817712187767},{0.35527995228767395,-0.02798350900411606,0.06143415719270706,0.17984779179096222,-0.14356254041194916,0.24627655744552612,-0.04379621148109436,0.2319636046886444,0.14838963747024536,0.1105591431260109,0.04715660214424133,-0.38662394881248474,-0.2638338804244995,-0.07078015804290771,0.09295599162578583,-0.1096281036734581,0.2925649881362915,0.17670869827270508,-0.19008632004261017,-0.209513857960701,0.2708633244037628,0.2774007022380829,0.2756359279155731,0.13681843876838684,-0.0828976184129715,-0.02801734395325184,-0.10809990763664246,-0.2127237468957901,0.13549119234085083,0.07574368268251419,-0.20159326493740082,0.11794553697109222},{-0.02019050158560276,0.026947567239403725,-0.05659400671720505,-0.24042631685733795,-0.10316857695579529,-0.24066253006458282,-0.22454434633255005,-0.178081214427948,0.013825441710650921,-0.018357202410697937,-0.2525158226490021,0.030568651854991913,-0.24802522361278534,-0.15299144387245178,0.0030293052550405264,0.08663798868656158,0.26683831214904785,-0.1712140291929245,-0.3499239683151245,0.27576959133148193,-0.15004196763038635,0.2523634433746338,-0.022559070959687233,-0.05237464979290962,0.041200462728738785,0.122230663895607,-0.05731812119483948,-0.2783273458480835,0.20159490406513214,0.25858020782470703,-0.14776264131069183,0.19115708768367767},{-0.2837042212486267,-0.025072354823350906,0.04528636857867241,-0.018377000465989113,0.014841083437204361,0.08708426356315613,-0.18286196887493134,0.09116562455892563,-0.2033618539571762,-0.2069101482629776,0.11435024440288544,-0.13127285242080688,-0.1710304170846939,0.2740604281425476,0.006615060847252607,-0.005743714049458504,0.20879089832305908,-0.23832303285598755,-0.15858249366283417,0.2758369743824005,0.03313396871089935,0.20995274186134338,-0.010867474600672722,0.02322252094745636,-0.2328946441411972,-0.13724270462989807,0.024625567719340324,0.29621434211730957,0.0254934374243021,-0.018135182559490204,0.2611992061138153,0.2829955816268921}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10489903390407562,0.10933379828929901,0.29793059825897217,0.003577152267098427},{0.054296500980854034,-0.07790546864271164,0.029267065227031708,0.17716479301452637},{-0.12948709726333618,0.1071237102150917,0.08204503357410431,0.12116328626871109},{0.32502511143684387,0.05405443161725998,0.08405835181474686,0.40766018629074097},{-0.05132858455181122,0.06662362068891525,0.28626978397369385,0.009107273072004318},{-0.14388765394687653,0.21959686279296875,0.20012210309505463,-0.012507461942732334},{-0.2668551206588745,-0.013774441555142403,0.03721635043621063,-0.09669321775436401},{-0.3201868236064911,-0.11375922709703445,0.31649401783943176,-0.2772916853427887},{0.27622565627098083,-0.14629779756069183,-0.24097676575183868,-0.34186792373657227},{0.07649402320384979,0.2543206214904785,0.2924180030822754,-0.33538126945495605},{-0.11511163413524628,-0.1488063782453537,-0.12225328385829926,0.12392285466194153},{0.2963593900203705,-0.147663876414299,-0.0008538364199921489,0.15280626714229584},{0.23136623203754425,0.27255403995513916,-0.0597691610455513,0.11178842931985855},{-0.002957482123747468,0.009144560433924198,-0.2778446078300476,0.058549944311380386},{0.09513423591852188,0.24149762094020844,0.29390180110931396,0.23789332807064056},{0.14010843634605408,0.013837164267897606,0.23381838202476501,0.2559932470321655},{-0.2322963923215866,-0.09648988395929337,-0.09720025211572647,-0.21022579073905945},{-0.1200927197933197,0.1152847483754158,-0.10421764850616455,-0.10413520038127899},{-0.2865040898323059,0.13694459199905396,0.1438884437084198,0.31290721893310547},{-0.029222389683127403,0.29722920060157776,-0.15224070847034454,0.15499648451805115},{-0.21617989242076874,-0.3036155700683594,-0.12932366132736206,-0.0041898759081959724},{0.2986214756965637,0.34795060753822327,0.029825987294316292,-0.22627505660057068},{-0.007246996741741896,0.15930142998695374,0.1881958693265915,0.15962648391723633},{-0.0718032717704773,0.34656819701194763,-0.04107052832841873,-0.1384642869234085},{0.016816597431898117,-0.0350104495882988,-0.07295126467943192,-0.025819936767220497},{0.2411165088415146,-0.32141441106796265,-0.041211824864149094,0.030784962698817253},{-0.015444379299879074,-0.30488893389701843,-0.1594921052455902,-0.26886653900146484},{0.12565699219703674,-0.15850397944450378,0.2079893797636032,0.10148908942937851},{-0.0021279933862388134,-0.0020693200640380383,0.0027224242221564054,0.007861258462071419},{-0.37730956077575684,0.3623894155025482,0.19494333863258362,-0.000713382672984153},{0.3256072998046875,-0.14913314580917358,0.1794455349445343,-0.039771903306245804},{0.1028006300330162,-0.3410476744174957,0.3463311493396759,-0.21607370674610138}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.08411010354757309,-0.03419678285717964,0.017517555505037308,0.038778942078351974,-0.07166946679353714,-0.10452336072921753,0.039877668023109436,0.038281526416540146,0.019841544330120087,-0.016096707433462143,-0.03244509920477867,-0.0038388450630009174,0.06365545094013214,0.029708048328757286,-0.0984131395816803,-0.009359135292470455};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02828659862279892,0.005025928374379873,0.0064354464411735535,0.005956380162388086,0.006604834459722042,-0.0034558323677629232,0.02420230023562908,0.03271947056055069,0.013754024170339108,0.030253982171416283,0.02577250264585018,-0.009507209062576294,0.04305463656783104,-0.029362671077251434,-0.04791397228837013,0.011264833621680737};
static const float actor_encoder_feed_forward_0_bias[32] = {0.008817756548523903,0.009323524311184883,0.0072142924182116985,-0.0061388337053358555,0.016187693923711777,0.00310008367523551,0.0027248018886893988,0.021614443510770798,-0.03696534410119057,-0.009683575481176376,-0.007982910610735416,-0.00043889324297197163,0.008274293504655361,-0.008980778977274895,0.003185667796060443,0.041388049721717834,-0.0008717374876141548,-0.02665329910814762,0.02181512676179409,-0.015956664457917213,-0.02572733350098133,-7.744773029116914e-05,0.05181416496634483,0.011591795831918716,0.004161973018199205,0.02580646052956581,-0.0271602850407362,0.04007187485694885,0.020481133833527565,-0.0022536159958690405,0.017374278977513313,0.015005535446107388};
static const float action_parameterization_distribution_linear_bias[4] = {-0.002153994981199503,-0.01313644926995039,0.005985493306070566,0.0062868632376194};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.021215351298451424,0.28386667370796204,-0.13769713044166565,0.17660526931285858,0.09421573579311371,0.049592871218919754,0.5460866689682007,-0.11752963811159134},{-0.1607052981853485,-0.03836008161306381,-0.2552267014980316,-0.21313467621803284,-0.40975260734558105,-0.26215553283691406,0.060075946152210236,-0.25598567724227905},{-0.22804684937000275,0.0073618157766759396,0.2725275754928589,0.2617822587490082,0.21588900685310364,-0.04732470586895943,0.40533173084259033,-0.160341277718544},{0.014199258759617805,0.08506854623556137,-0.12342335283756256,0.033865805715322495,-0.020003236830234528,-0.07908231765031815,0.37606126070022583,-0.24730470776557922},{-0.26626163721084595,-0.12007398903369904,-0.17995384335517883,-0.109934501349926,-0.06263331323862076,0.16033701598644257,0.2491261214017868,-0.07955367118120193},{-0.3143514394760132,-0.028866756707429886,0.4731447994709015,0.2671290636062622,0.14025291800498962,-0.1281774640083313,-0.0839962512254715,-0.1713908165693283},{-0.27238836884498596,0.011454775929450989,0.529387891292572,-0.16380535066127777,-0.17098329961299896,-0.4377005100250244,-0.06585637480020523,-0.13082611560821533},{-0.3041313886642456,-0.3688025176525116,0.6360745429992676,-0.037845589220523834,-0.23613391816616058,0.21684765815734863,0.20140761137008667,-0.25026705861091614},{-0.38220787048339844,0.28923270106315613,-0.07015961408615112,0.3942272663116455,0.07087177038192749,-0.3371294140815735,0.03892570734024048,0.10746488720178604},{-0.441965252161026,-0.3371334671974182,-0.09641988575458527,-0.20588022470474243,-0.5406216979026794,0.13368259370326996,-0.027181491255760193,0.173623725771904},{0.05749629810452461,0.315863698720932,0.26017117500305176,-0.025299105793237686,0.20007845759391785,0.16342248022556305,-0.19316911697387695,0.2430359274148941},{0.10073169320821762,0.010366631671786308,0.276852011680603,0.2294417768716812,-0.30324262380599976,0.3366006016731262,0.009006178006529808,-0.20983916521072388},{0.01976373791694641,-0.3447544574737549,0.27541273832321167,-0.07741133868694305,-0.3613402843475342,-0.0483282096683979,-0.1613246351480484,-0.1078936979174614},{-0.2926269769668579,-0.26943957805633545,0.35612356662750244,0.3345586657524109,-0.26073959469795227,-0.050900571048259735,-0.2783038020133972,0.23141558468341827},{-0.006162075325846672,-0.21671493351459503,0.17980505526065826,-0.22471636533737183,-0.2938936650753021,-0.11259114742279053,0.24037082493305206,0.023061662912368774},{0.11630208045244217,-0.10705249011516571,0.07388895750045776,-0.23225395381450653,0.05470169335603714,0.0898919627070427,0.08688511699438095,0.41793766617774963},{-0.10545458644628525,-0.36288249492645264,-0.15672148764133453,0.11745823919773102,-0.20813438296318054,-0.12108994275331497,-0.11799450218677521,0.14530375599861145},{-0.23580536246299744,-0.346668541431427,0.036942657083272934,0.03236794471740723,0.11196527630090714,-0.17689953744411469,0.36092260479927063,0.172495037317276},{-0.04781602323055267,0.08477015048265457,-0.25799205899238586,0.10548028349876404,0.09806916117668152,0.21092592179775238,-0.20075802505016327,0.3575909733772278},{0.06904049217700958,-0.05420808866620064,-0.3571038246154785,0.09229069203138351,-0.07409094274044037,-0.008673724718391895,-0.28444576263427734,0.0036489292979240417},{0.009362571872770786,-0.16031640768051147,0.07566168159246445,-0.09268518537282944,0.32348817586898804,0.07027501612901688,0.03165050223469734,0.4067147672176361},{-0.06434280425310135,0.06654958426952362,-0.2540549337863922,0.2925797998905182,0.3651159107685089,0.38695573806762695,0.2403871715068817,-0.3057697117328644},{-0.5155704617500305,-0.18920424580574036,0.1616102010011673,-0.08285173028707504,0.22655904293060303,-0.22360162436962128,0.30310216546058655,-0.2768695056438446},{-0.2642289102077484,-0.009383045136928558,-0.08867111802101135,-0.45500999689102173,0.25360018014907837,0.08146688342094421,-0.23737671971321106,0.15814240276813507},{-0.35861772298812866,-0.19492696225643158,-0.026182319968938828,-0.014150363393127918,-0.050692200660705566,0.22467200458049774,0.3818295896053314,-0.1377720683813095},{-0.3385333716869354,0.05299416929483414,-0.38326770067214966,-0.3486267030239105,0.16544923186302185,0.07176640629768372,-0.02217375487089157,0.0528920441865921},{0.2509481608867645,0.37885427474975586,-0.3011091351509094,0.15722887217998505,0.2109224945306778,0.41239306330680847,-0.19906289875507355,-0.15560543537139893},{0.2980867922306061,0.24894563853740692,0.03716423735022545,0.045291319489479065,0.2876847982406616,0.22288933396339417,0.3560604751110077,0.3582982122898102},{-0.21415546536445618,0.3761826157569885,0.13216589391231537,-0.01843058131635189,0.2352655678987503,0.07735112309455872,-0.25161728262901306,-0.30329617857933044},{-0.3025674819946289,-0.2166658192873001,0.0506385862827301,-0.2984553277492523,-0.29298925399780273,-0.1343836635351181,0.4306865930557251,-0.0819099172949791},{0.2832639217376709,-0.2316497266292572,0.33041122555732727,-0.35503870248794556,0.017447400838136673,0.2395358681678772,0.34638217091560364,-0.30395931005477905},{0.09767083078622818,0.41826483607292175,0.3920113444328308,-0.2981269061565399,-0.30268609523773193,0.04181959107518196,0.3611298203468323,-0.010135145857930183}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.01022779755294323,0.44342705607414246,-0.16096463799476624,0.1742793768644333,-0.4202762544155121,0.3167583644390106,0.30518943071365356,0.11467915773391724},{-0.5111170411109924,-0.4199879467487335,-0.35980844497680664,-0.45149150490760803,-0.46722280979156494,0.49337121844291687,0.34647804498672485,-0.35426291823387146},{0.11753124743700027,-0.1565362960100174,0.15229643881320953,0.19829286634922028,-0.01671646721661091,0.455356627702713,-0.28153088688850403,-0.5221760272979736},{0.4118402302265167,-0.09169357270002365,0.20771300792694092,-0.008432373404502869,0.4753918945789337,0.4446297585964203,0.5246198177337646,0.38473746180534363},{0.10248814523220062,0.17549318075180054,-0.14331431686878204,-0.2424405813217163,0.07560841739177704,-0.41450679302215576,-0.5267435312271118,0.568145215511322},{0.45843377709388733,0.1287316530942917,-0.019923154264688492,-0.3295154571533203,-0.4633985161781311,-0.48773103952407837,-0.10869674384593964,0.40845802426338196},{-0.4708075225353241,-0.3116885721683502,-0.12482083588838577,-0.2221779227256775,-0.01609322428703308,0.5233117938041687,-0.5040393471717834,0.4954683482646942},{0.16058655083179474,0.06254216283559799,0.00037201325176283717,0.0328965038061142,0.3450048863887787,-0.46537885069847107,0.3157297968864441,-0.3571337163448334}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09048289805650711,0.020533952862024307,0.05072404816746712,-0.02837623842060566,-0.05519094318151474,0.020814375951886177,0.043410107493400574,-0.011451227590441704};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.01636623404920101,0.013250328600406647,-0.05595119670033455,0.06747261434793472,-0.009778613224625587,-0.006147115025669336,0.04416525736451149,-0.09336826950311661};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

