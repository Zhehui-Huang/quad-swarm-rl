#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.33429571986198425,0.039283569902181625,0.08000063896179199,0.2673244774341583,0.25960248708724976,-0.21130768954753876,-0.3255364000797272,0.10905132442712784,0.3958805203437805,-0.3086860775947571,0.4497515857219696,0.08585502952337265,0.23307624459266663,0.08229102939367294,-0.3059620261192322,0.0327160507440567},{-0.32267045974731445,-0.22212469577789307,-0.25271669030189514,-0.08450708538293839,0.18533524870872498,0.42417988181114197,0.1744793951511383,-0.010338477790355682,0.19125860929489136,0.25000205636024475,-0.07157709449529648,0.009033042006194592,-0.1099422425031662,0.09531703591346741,0.28811943531036377,-0.22547399997711182},{-0.011498779989778996,0.1474825143814087,0.2564352750778198,0.3684704005718231,0.08896694332361221,-0.3084176480770111,0.9083377122879028,-0.31558600068092346,-0.2919047474861145,0.013609649613499641,-0.0465933196246624,-0.26952385902404785,0.41350433230400085,0.6572025418281555,-0.5886833667755127,0.20889323949813843},{0.1501014083623886,-0.17477759718894958,-0.1311449408531189,0.00654481491073966,-0.11267036199569702,0.1314946711063385,-0.06870044767856598,-0.21847476065158844,-0.029229966923594475,-0.02764764614403248,0.5687559843063354,-0.18897591531276703,-0.3452387750148773,-0.17150840163230896,0.23397909104824066,-0.032473236322402954},{-0.18955367803573608,-0.02791975624859333,0.17888842523097992,-0.4065910875797272,0.4499761760234833,0.2524126470088959,0.2135981321334839,-0.19516144692897797,-0.19255360960960388,0.3051524758338928,-0.11113527417182922,-0.41300851106643677,-0.007976457476615906,-0.2203797996044159,0.4518771171569824,-0.011085983365774155},{-0.036045141518116,-0.11295342445373535,-0.09292099624872208,-0.07203210145235062,0.07759106904268265,-0.21150583028793335,0.5986307263374329,-0.30971044301986694,-0.2468061000108719,-0.1886247843503952,0.10442637652158737,0.06699848920106888,0.3193986117839813,0.01768369972705841,0.30136194825172424,0.2517293393611908},{-0.10274498164653778,0.3088645935058594,-0.05537879094481468,0.10265807807445526,-0.25767600536346436,-0.0687994509935379,-0.09683071076869965,0.033843059092760086,0.3391295075416565,0.2565357983112335,-0.3335811197757721,-0.1274336874485016,0.24814282357692719,-0.10673384368419647,-0.07752985507249832,0.20105642080307007},{-0.34512656927108765,0.25150007009506226,-0.051967352628707886,-0.32417619228363037,0.31266072392463684,-0.2827977240085602,-0.37750449776649475,-0.5397815108299255,-0.1044163629412651,-0.24929040670394897,0.5852456092834473,0.13829438388347626,-0.041285619139671326,0.5033456683158875,0.020091984421014786,0.6798157095909119},{0.29035431146621704,0.14723381400108337,-0.2767268121242523,0.011145242489874363,-0.6717346906661987,-0.6121540665626526,0.1606261283159256,-0.6074055433273315,-0.02022469788789749,-0.19410613179206848,0.3883829116821289,-0.622456967830658,-0.5355874300003052,0.11957192420959473,0.04499898850917816,-0.32320597767829895},{0.676683783531189,-0.9239392876625061,-0.43316033482551575,0.13966944813728333,0.1715642213821411,-0.36541303992271423,0.02520793490111828,-0.19328440725803375,-0.3934907019138336,-0.08603627234697342,-0.2995234429836273,-0.3706940710544586,0.5637338757514954,-0.35753968358039856,-0.7248126268386841,-0.32523733377456665},{0.35882869362831116,0.313546746969223,-0.15053969621658325,0.07605519145727158,0.10590986907482147,-0.12841376662254333,-0.12321166694164276,0.18189410865306854,-0.034882765263319016,0.19227974116802216,0.1292787492275238,0.20958422124385834,-0.12556171417236328,0.10894320160150528,0.03248671069741249,-0.40091341733932495},{-0.40412604808807373,0.28388360142707825,0.6147496104240417,-0.966356635093689,0.17279446125030518,0.22181037068367004,0.1687677800655365,0.37137654423713684,0.3391377627849579,0.4785101115703583,0.4879002273082733,-0.4488757848739624,0.33975425362586975,-0.24240703880786896,0.070372074842453,-0.2590149939060211},{0.14212006330490112,-0.33311668038368225,-0.27927908301353455,0.3576526343822479,-0.1930120587348938,-0.2972077429294586,-0.04574597626924515,0.31569623947143555,0.23582753539085388,-0.1369916945695877,-0.2933569550514221,0.2775414288043976,0.38800904154777527,0.3309090733528137,-0.2285737693309784,0.6297212243080139},{0.26422786712646484,0.2981957495212555,-0.3217509090900421,0.08030153810977936,-0.12218569219112396,-0.14406229555606842,-0.27685046195983887,0.21631230413913727,-0.240583136677742,-0.3524170517921448,-0.0631924569606781,0.07226978242397308,-0.548046350479126,-0.11799953877925873,-0.28139400482177734,-0.20009802281856537},{0.13829340040683746,0.568891704082489,0.3333718180656433,-0.39898914098739624,-0.39742645621299744,0.2626572549343109,-0.10655970126390457,0.02914314530789852,0.5098125338554382,0.2511417865753174,-0.23590800166130066,0.15336865186691284,-0.1948632001876831,-0.35614013671875,0.1534438580274582,-0.3314356207847595},{-0.3242870569229126,-0.04162100329995155,-0.03156428784132004,0.2224484235048294,-0.03054325468838215,0.006240767892450094,-0.17318317294120789,-0.024633482098579407,-0.38356783986091614,-0.12739375233650208,0.23803232610225677,0.07422013580799103,-0.1550888866186142,-0.21842673420906067,-0.3790760040283203,-0.0984768494963646},{-0.2853640019893646,0.1484086662530899,-0.14485308527946472,0.0018497532000765204,-0.10769998282194138,0.3133540451526642,0.3484692871570587,0.12730145454406738,0.17318783700466156,-0.24554358422756195,-0.04101033881306648,-0.10347955673933029,-0.00870803464204073,0.027007902041077614,-0.008536792360246181,-0.13969165086746216},{0.15675698220729828,-0.40958866477012634,0.11376871168613434,0.13776321709156036,0.009073629975318909,0.29309913516044617,0.2896312475204468,0.12762951850891113,-0.1335933804512024,-0.21757423877716064,-0.09662889689207077,-0.15556630492210388,-0.11937565356492996,-0.3766176402568817,0.05337132513523102,0.020711824297904968}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15047916769981384,0.3117430508136749,0.3498201072216034,-0.06287358701229095,-0.1702805906534195,0.02119201049208641,0.08215335011482239,0.24655365943908691,-0.08716284483671188,0.31039249897003174,0.4607791304588318,-0.35838934779167175,-0.10338140279054642,0.08331438153982162,0.011533208191394806,-0.041074249893426895},{-0.5143115520477295,0.23491254448890686,-0.27419865131378174,0.26745912432670593,0.34378448128700256,-0.0948231965303421,-0.3143188953399658,-0.2721389830112457,0.2616518437862396,0.3041555881500244,-0.08314262330532074,0.20976833999156952,-0.26672375202178955,0.16748414933681488,-0.2663331925868988,0.412041038274765},{-0.38287314772605896,0.17648456990718842,-0.3257823586463928,0.05649976432323456,-0.4152488708496094,-0.2722697854042053,-0.10547905415296555,0.03543846309185028,-0.22353573143482208,0.33052077889442444,0.20056116580963135,-0.052477139979600906,0.21660207211971283,-0.3383922874927521,-0.035464465618133545,0.042942073196172714},{0.22474412620067596,-0.21965591609477997,0.08334901928901672,0.4371388852596283,-0.46047449111938477,-0.31423497200012207,0.2426944375038147,0.13139797747135162,0.28682035207748413,-0.08050228655338287,0.24697452783584595,0.10887844860553741,-0.25021272897720337,-0.07019565254449844,-0.023570116609334946,-0.3625819981098175},{-0.30668479204177856,0.014584488235414028,0.23631712794303894,-0.34302952885627747,0.12838399410247803,0.2554301917552948,-0.3036904036998749,0.2598889470100403,-0.21918761730194092,0.1835918128490448,-0.11941231042146683,-0.010269654914736748,-0.15501876175403595,0.010122138075530529,-0.2114398181438446,-0.1946335881948471},{-0.008615965023636818,-0.20992611348628998,-0.05628303065896034,-0.38479799032211304,0.3108147382736206,0.05271872878074646,-0.014827454462647438,-0.1046241968870163,-0.19919918477535248,0.35734426975250244,0.3206193745136261,-0.09062743186950684,-0.14339281618595123,0.2386225312948227,-0.08065536618232727,-0.3613167405128479},{0.21407951414585114,-0.18432658910751343,0.2780974209308624,-0.3178800046443939,-0.3699960708618164,-0.08007533848285675,-0.3832658529281616,0.34371739625930786,-0.13344302773475647,-0.26160928606987,-0.250881165266037,-0.023381926119327545,-0.07600968331098557,-0.06583978235721588,0.46505820751190186,-0.3880116641521454},{-0.3073607087135315,0.38512787222862244,-0.04770960658788681,0.2228054404258728,0.010921003296971321,-0.23296205699443817,-0.12628956139087677,0.09436070919036865,-0.05709485709667206,0.4837275743484497,0.11581823974847794,-0.2143499255180359,0.10917630046606064,-0.09747622907161713,0.07439189404249191,0.16666604578495026},{0.15549121797084808,0.2713656425476074,-0.1751718521118164,-0.3442329168319702,0.37282606959342957,-0.21233484148979187,0.24400940537452698,-0.3644455671310425,0.04542136937379837,0.013651055283844471,0.12060181796550751,0.11084837466478348,0.001353797153569758,-0.23104830086231232,-0.10333382338285446,0.20417997241020203},{-0.17568224668502808,-0.023712193593382835,-0.26773974299430847,-0.31690603494644165,0.22529490292072296,-0.4491318166255951,-0.19568325579166412,0.26243969798088074,-0.07018700242042542,0.17643754184246063,0.03222610428929329,-0.06895184516906738,-0.3780519962310791,-0.0007562332320958376,-0.2054663449525833,-0.34954798221588135},{-0.22714731097221375,-0.07888287305831909,-0.09982816129922867,-0.32126742601394653,-0.3227899968624115,0.0043443008325994015,0.1430990993976593,-0.4627065360546112,-0.005737970117479563,-0.030597345903515816,0.1426185816526413,-0.020647741854190826,0.36166366934776306,0.025192346423864365,0.1849364936351776,0.21184557676315308},{-0.21118634939193726,-0.053515125066041946,-0.40045613050460815,0.3694842457771301,0.10790246725082397,0.06408428400754929,0.14580020308494568,0.07978428900241852,-0.36320760846138,0.2042529135942459,-0.39896371960639954,-0.1306522935628891,-0.35564497113227844,0.37198635935783386,-0.3260532319545746,0.07712007313966751},{-0.1033814549446106,-0.44352787733078003,-0.07052197307348251,0.14033983647823334,-0.19323907792568207,-0.08407504111528397,-0.07315463572740555,0.3448012173175812,0.4093974232673645,0.08650112897157669,-0.11421430855989456,-0.2462601512670517,0.17583662271499634,-0.31071582436561584,0.15947988629341125,-0.20729698240756989},{-0.26063984632492065,-0.4776689112186432,-0.1780240833759308,-0.13909408450126648,-0.47072967886924744,0.3329926133155823,-0.08134537190198898,0.19820746779441833,-0.21423450112342834,-0.3240504562854767,-0.28871801495552063,0.39190417528152466,-0.14900074899196625,0.09562788158655167,-0.2539534270763397,0.35619866847991943},{-0.33693161606788635,0.31975141167640686,-0.18443496525287628,0.09807740151882172,-0.35290437936782837,0.1201195940375328,0.061461448669433594,-0.38606885075569153,0.113712377846241,0.15537479519844055,-0.11081326752901077,0.08542287349700928,0.2615722715854645,-0.19983062148094177,-0.3296288251876831,-0.14179405570030212},{-0.15775124728679657,-0.37072649598121643,-0.5083494782447815,0.29951921105384827,0.059041209518909454,0.10259777307510376,-0.2449314296245575,0.1876453459262848,-0.42228564620018005,-0.3042948246002197,-0.3960363268852234,0.2532986104488373,-0.260713666677475,0.2159266471862793,0.09334161132574081,0.34697797894477844}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07492827624082565,-0.09010717272758484,0.1582396775484085,-0.10300880670547485,-0.09609057754278183,0.11900822818279266,0.20589227974414825,-0.2371000200510025,-0.1955767571926117,0.27128875255584717,0.11504895240068436,0.10777536779642105,0.061604470014572144,0.13199348747730255,-0.1798512190580368,0.14215247333049774,0.13948656618595123,-0.2974368631839752,-0.1942676156759262,-0.08022414147853851,-0.15572489798069,0.07607351988554001,-0.18943074345588684,0.34403300285339355,-0.1619298905134201,-0.05544891953468323,0.10767120122909546,0.18743014335632324,-0.1430179327726364,-0.15774303674697876,0.1992322951555252,0.2358645498752594},{0.14237773418426514,-0.067344069480896,0.1679406315088272,-0.13102032244205475,-0.07542537897825241,0.23569509387016296,0.05292555317282677,-0.04087761044502258,-0.03107048198580742,-0.05041459575295448,-0.09535112231969833,-0.0032165853772312403,0.36121803522109985,0.212992861866951,0.09398264437913895,0.021701455116271973,-0.22059796750545502,-0.25802335143089294,0.11101184040307999,0.029746156185865402,0.10119675099849701,0.28747496008872986,0.2698530852794647,-0.15497121214866638,0.05115809291601181,0.2731494903564453,-0.3456122875213623,0.19413110613822937,-0.003765807254239917,-0.23921844363212585,-0.09043582528829575,-0.015142066404223442},{-0.058138616383075714,-0.07939082384109497,0.22293925285339355,-0.17627473175525665,-0.1382923126220703,0.08552832901477814,-0.18964889645576477,0.21778260171413422,0.18341325223445892,0.027641840279102325,-0.19233553111553192,0.012729980051517487,0.32131227850914,-0.2881357669830322,0.11430633068084717,-0.056365590542554855,-0.34972426295280457,0.2519330382347107,-0.2990628778934479,-0.050339363515377045,-0.050365179777145386,-0.10560420900583267,-0.024730142205953598,-0.031803641468286514,-0.034291982650756836,0.3280929625034332,-0.09912353754043579,0.096201591193676,0.22466504573822021,-0.2999905049800873,-0.14231975376605988,-0.01860583759844303},{0.14275218546390533,-0.18088282644748688,0.009317909367382526,-0.35972556471824646,0.06174150109291077,-0.146437406539917,-0.08824767172336578,0.18103089928627014,0.05182861536741257,0.19280774891376495,0.054982494562864304,-0.10349836945533752,-0.20103785395622253,-0.00725081842392683,0.24200843274593353,-0.2056976705789566,0.042577970772981644,-0.09252528101205826,-0.14575934410095215,0.12272287160158157,-0.14818021655082703,0.12572072446346283,-0.27122318744659424,0.25298863649368286,-0.22603033483028412,0.07539055496454239,-0.05134625360369682,-0.2161831259727478,0.14047780632972717,-0.013229915872216225,0.22890838980674744,-0.14910343289375305},{0.258642315864563,-0.05671773478388786,0.01025705598294735,0.244578555226326,-0.3087397515773773,-0.08947715908288956,0.1716952621936798,-0.023488717153668404,0.13784202933311462,-0.16523867845535278,-0.005543735809624195,-0.08233492076396942,-0.18735352158546448,-0.13592450320720673,0.2795346677303314,0.22904908657073975,-0.039376694709062576,-0.3040641248226166,0.09863189607858658,-0.1238081306219101,-0.14204661548137665,0.2388506829738617,0.22716586291790009,0.02602768875658512,-0.09961623698472977,-0.10480519384145737,0.06281428039073944,0.2402794510126114,0.12621943652629852,0.09529709070920944,0.12414227426052094,-0.21914467215538025},{0.32138508558273315,-0.14715106785297394,0.01245152298361063,0.09393048286437988,-0.09732295572757721,-0.305336594581604,-0.2161807119846344,-0.2888851463794708,-0.1996796578168869,0.034867335110902786,-0.028422227129340172,0.01513505820184946,-0.10512540489435196,-0.09487061947584152,-0.19207961857318878,-0.2497214823961258,0.16033683717250824,-0.005950992926955223,-0.3071165978908539,0.18877433240413666,-0.07894472032785416,-0.19744785130023956,0.21982276439666748,-0.14763611555099487,-0.1826595515012741,-0.20679552853107452,-0.12608423829078674,0.09765343368053436,0.010659570805728436,0.24275557696819305,-0.24610435962677002,0.2146957516670227},{0.16801054775714874,0.10576821863651276,0.23447047173976898,-0.1659015566110611,0.24623394012451172,-0.20628826320171356,-0.2793022692203522,0.014668815769255161,0.25831207633018494,0.11069727689027786,-0.1402502954006195,0.10934263467788696,0.04907697066664696,0.303146094083786,0.09214618802070618,-0.054169926792383194,-0.17571799457073212,0.10184754431247711,0.008725001476705074,-0.05549898371100426,-0.046855438500642776,0.17582468688488007,0.17563121020793915,0.10160753130912781,-0.24091100692749023,-0.20072053372859955,-0.26256901025772095,-0.2982802391052246,0.11362328380346298,-0.1379251927137375,0.29854774475097656,0.18260382115840912},{0.30566734075546265,-0.35242316126823425,0.07705970108509064,-0.40467312932014465,-0.3478785455226898,0.27787598967552185,0.3973860740661621,0.1680745929479599,-0.05932306870818138,0.0795181468129158,0.1779681146144867,-0.12947677075862885,0.05990734323859215,0.31569159030914307,-0.047655049711465836,0.20478348433971405,0.3888789415359497,-0.2697085440158844,-0.07126845419406891,-0.36760538816452026,0.19914336502552032,0.22388260066509247,0.1904519498348236,0.13763806223869324,0.13264170289039612,0.11817754060029984,0.16451407968997955,0.257093220949173,0.003640491282567382,-0.2845626771450043,0.23526829481124878,0.034025225788354874},{0.06541765481233597,-0.1132478341460228,0.2396736741065979,0.2461409866809845,-0.20023541152477264,-0.26176974177360535,-0.06708139181137085,0.2451188564300537,-0.20821118354797363,-0.15302708745002747,0.0056582908146083355,0.07491392642259598,0.16587643325328827,-0.3226275146007538,0.16792862117290497,-0.19203810393810272,-0.18944019079208374,0.18128295242786407,-0.26015833020210266,0.29049357771873474,-0.376620352268219,-0.28065192699432373,-0.30788683891296387,0.26923868060112,0.08158421516418457,0.0484405942261219,0.2994627058506012,0.18796129524707794,-0.14257730543613434,-0.3081030547618866,-0.1639942079782486,0.16011613607406616},{0.2900574207305908,0.0415797233581543,0.01968143880367279,0.22345048189163208,0.01931602507829666,0.23200735449790955,-0.0793253630399704,0.19615674018859863,-0.022718772292137146,0.032073862850666046,0.15420463681221008,0.12049011886119843,-0.04673279449343681,-0.28439077734947205,0.17227864265441895,0.17767006158828735,-0.017939073964953423,-0.12582899630069733,-0.034415267407894135,0.04750260338187218,0.07241345942020416,-0.29122260212898254,0.3281309902667999,0.06052779406309128,-0.021410932764410973,0.09876734018325806,-0.37017688155174255,-0.19748049974441528,-0.10113875567913055,0.0005118834087625146,0.07977985590696335,0.17811110615730286},{-0.08045563846826553,0.10805736482143402,-0.04074889421463013,0.19417840242385864,-0.048406410962343216,0.32239675521850586,0.10451004654169083,-0.0682789757847786,0.2408202439546585,-0.30601179599761963,-0.15578214824199677,0.14540591835975647,-0.08728022873401642,0.04891404137015343,-0.2796785831451416,0.05052047222852707,0.06790909171104431,0.14468024671077728,0.12134501338005066,-0.12077175080776215,-0.2574450671672821,0.1640116274356842,0.27355772256851196,0.22122150659561157,-0.321232408285141,0.3204444944858551,-0.19513042271137238,0.04182291775941849,-0.11323283612728119,0.14836221933364868,0.2009495198726654,0.25236961245536804},{-0.15427494049072266,0.24323545396327972,-0.10458941012620926,-0.019803205505013466,-0.21019728481769562,-0.13055194914340973,0.15906190872192383,-0.2591620087623596,-0.013642814010381699,-0.1960328221321106,-0.25470593571662903,-0.07602664828300476,0.1624889224767685,-0.30867114663124084,-0.09946704655885696,-0.37110596895217896,-0.1528698056936264,-0.014368138276040554,0.2539648413658142,-0.31440043449401855,0.041446756571531296,-0.1181635782122612,0.02410047873854637,0.2885385751724243,-0.1696648746728897,0.16478727757930756,0.291107714176178,-0.12647727131843567,-0.0751500055193901,0.30425068736076355,-0.13476377725601196,-0.2394985407590866},{-0.06064513698220253,0.22002963721752167,0.249018594622612,-0.3418665826320648,0.31404975056648254,0.04060191288590431,-0.12007925659418106,-0.011420817114412785,0.13093046844005585,-0.2979564070701599,-0.04523978382349014,0.012684869579970837,0.23767465353012085,0.03631793335080147,0.010360635817050934,-0.034494273364543915,0.23759761452674866,-0.2765651345252991,0.350015252828598,0.1028953343629837,-0.1822691410779953,0.21459364891052246,-0.07528518885374069,-0.19234371185302734,0.24913917481899261,-0.11428947001695633,-0.04212702065706253,-0.13993170857429504,-0.010494989342987537,-0.1140618771314621,0.2711731195449829,0.23265667259693146},{0.13820786774158478,-0.16083258390426636,-0.1600831300020218,0.11296771466732025,0.11224497109651566,0.2824971079826355,-0.09921585768461227,-0.20758235454559326,0.2593107521533966,0.049999136477708817,0.04556602984666824,0.060036368668079376,-0.23470823466777802,0.048430945724248886,-0.15776938199996948,-0.23603390157222748,0.05166797712445259,-0.06338077783584595,0.23293635249137878,0.3122399151325226,-0.20855307579040527,0.0654509961605072,-0.11577209830284119,-0.007552001159638166,0.049931600689888,-0.24871201813220978,-0.14599880576133728,-0.1773800253868103,-0.09358483552932739,-0.12772685289382935,0.2706351578235626,-0.26512882113456726},{-5.57700805075001e-05,0.2982446551322937,0.19350972771644592,-0.1641118973493576,-0.0768170952796936,-0.15248918533325195,0.1618608832359314,-0.06809361279010773,0.1880272924900055,0.017753461375832558,0.1876932680606842,0.1395094096660614,0.02982439287006855,0.03130325302481651,-0.08733883500099182,0.2189023494720459,-0.22027155756950378,-0.37526267766952515,-0.22826126217842102,0.1495673656463623,0.0648990049958229,-0.21946340799331665,-0.28869614005088806,-0.19061526656150818,-0.24166235327720642,0.01431664451956749,0.31832191348075867,0.00468769995495677,-0.02094716764986515,0.14168019592761993,-0.14640302956104279,0.06669802963733673},{-0.18900232017040253,-0.1809314340353012,-0.2426973432302475,0.056255314499139786,-0.2672556936740875,-0.11166579276323318,-0.10018680989742279,-0.10863150656223297,-0.2944492995738983,-0.1699197143316269,0.09185144305229187,0.16736359894275665,-0.2599179446697235,0.2690607011318207,-0.029265493154525757,0.19158720970153809,0.04914099723100662,0.005183192901313305,0.03321314975619316,0.1117447018623352,0.14910508692264557,0.3214453458786011,0.0885133296251297,0.21486534178256989,0.10983552783727646,-0.23116272687911987,-0.12891089916229248,0.27018406987190247,0.011579442769289017,-0.23348785936832428,-0.1502910703420639,-0.140376478433609},{-0.2834167182445526,-0.2027466744184494,-0.3448128402233124,0.08601074665784836,-0.11730476468801498,-0.08248979598283768,-0.14034757018089294,0.0697237104177475,-0.04720509424805641,0.09538787603378296,-0.26253581047058105,0.01655452325940132,0.14460310339927673,-0.05261939764022827,0.045627694576978683,0.20703591406345367,-0.18252824246883392,-0.09611615538597107,0.16206344962120056,0.10982567816972733,0.20036400854587555,0.006372073665261269,-0.25667664408683777,0.06531890481710434,0.18031080067157745,-0.3088609278202057,0.1686611920595169,-0.002290204167366028,0.05008156970143318,-0.1275913417339325,0.1979598104953766,-0.08995728939771652},{0.2547629773616791,-0.05523586645722389,0.057100534439086914,0.12974610924720764,-0.30330953001976013,-0.009862116537988186,0.1583252102136612,0.1977202594280243,-0.07682972401380539,-0.11419102549552917,0.3196401596069336,-0.16854651272296906,-0.006259994115680456,-0.036395635455846786,-0.15474435687065125,0.2104024887084961,0.006507862359285355,-0.051504313945770264,0.11507097631692886,-0.27138733863830566,0.03859346732497215,-0.3110945522785187,-0.24818925559520721,0.2570594251155853,-0.12219295650720596,-0.13382834196090698,0.1702108234167099,-0.0181598924100399,-0.17291657626628876,-0.005496193654835224,-0.09011011570692062,-0.051224641501903534},{0.3011415898799896,-0.030069032683968544,0.055255185812711716,0.06863316148519516,-0.009718656539916992,-0.1291191577911377,0.1375642716884613,-0.2348044514656067,0.2301197052001953,0.26654407382011414,0.013249416835606098,0.1798962950706482,0.2394629567861557,0.3250146508216858,-0.29863426089286804,-0.28403496742248535,-0.30874496698379517,0.015506606549024582,-0.1481105238199234,-0.31308481097221375,-0.18124543130397797,0.28005990386009216,0.06705132871866226,0.11467945575714111,-0.14900168776512146,-0.062223102897405624,-0.14192920923233032,-0.18118208646774292,0.2696077823638916,0.14412467181682587,-0.2724708616733551,-0.1314690113067627},{-0.12471836805343628,0.17603589594364166,0.2991560101509094,-0.06322716176509857,-0.009830945171415806,0.04855508357286453,0.002358783036470413,-0.3167593479156494,0.18504281342029572,0.22348544001579285,0.2070409506559372,0.20931574702262878,-0.2761859595775604,0.20182010531425476,-0.2767948508262634,0.3045160174369812,0.140144944190979,-0.2474927008152008,0.27097073197364807,0.133998841047287,-0.2805755138397217,0.2704038918018341,-0.3150203227996826,0.11061490327119827,0.14916853606700897,0.2173203080892563,0.09208062291145325,0.09946781396865845,-0.23305001854896545,0.25645166635513306,-0.10726979374885559,0.0952417254447937},{-0.107103131711483,-0.05567373335361481,0.07214558124542236,0.23629146814346313,0.02582857757806778,0.22744940221309662,-0.31262171268463135,-0.15689541399478912,-0.21581138670444489,-0.09186205267906189,-0.1895505040884018,-0.13728348910808563,0.05709191411733627,-0.14191845059394836,0.15261945128440857,-0.13984742760658264,0.11088769137859344,-0.019184550270438194,-0.28296831250190735,-0.22797250747680664,0.08512603491544724,0.2065882682800293,-0.13776610791683197,0.33229660987854004,-0.33388009667396545,0.051601819694042206,0.07674746960401535,-0.08038242906332016,0.007061943411827087,-0.18524092435836792,0.3242202699184418,0.07315098494291306},{0.3477630019187927,-0.006436181720346212,0.04715513437986374,0.19338606297969818,-0.14790712296962738,0.2262655794620514,-0.059395626187324524,0.22090892493724823,0.1520203799009323,0.08768357336521149,0.06764703243970871,-0.36049509048461914,-0.2651752531528473,-0.0816890150308609,0.09116226434707642,-0.09773681312799454,0.2828313410282135,0.15444399416446686,-0.1886923462152481,-0.21554215252399445,0.27927300333976746,0.25952431559562683,0.2747364938259125,0.1171603575348854,-0.08147616684436798,-0.006534019019454718,-0.10684970021247864,-0.19131670892238617,0.08406709879636765,0.058474574238061905,-0.17891494929790497,0.12203730642795563},{-0.025569351390004158,0.028031090274453163,-0.050159186124801636,-0.23774710297584534,-0.10329923033714294,-0.24002651870250702,-0.21554942429065704,-0.17884069681167603,0.009712236002087593,-0.022528450936079025,-0.2435164898633957,0.03254370763897896,-0.24795392155647278,-0.15100552141666412,0.0028173215687274933,0.08312927186489105,0.2645449638366699,-0.16692203283309937,-0.345406174659729,0.27550575137138367,-0.14597487449645996,0.2439594566822052,-0.023863565176725388,-0.05711284279823303,0.045696403831243515,0.11938581615686417,-0.05672622099518776,-0.2780080735683441,0.19869552552700043,0.26091641187667847,-0.14442414045333862,0.1870751529932022},{-0.2666013538837433,-0.034790243953466415,0.04118236154317856,-0.011550825089216232,0.012155303731560707,0.09824052453041077,-0.19446198642253876,0.08506153523921967,-0.1929427683353424,-0.1832674890756607,0.0870758667588234,-0.13246102631092072,-0.1527440994977951,0.2780543267726898,0.012889442965388298,-0.0036446002777665854,0.19986288249492645,-0.23414447903633118,-0.17487956583499908,0.28346019983291626,0.01274118758738041,0.23896344006061554,-0.007230021059513092,0.038597945123910904,-0.2208559662103653,-0.1426442265510559,0.023229705169796944,0.2915104627609253,0.010083755478262901,-0.017098598182201385,0.25831183791160583,0.284798800945282}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10631580650806427,0.07203563302755356,0.23600170016288757,0.013686439022421837},{0.050366852432489395,-0.056245703250169754,0.015864495187997818,0.15721477568149567},{-0.13212421536445618,0.1029166504740715,0.05191795155405998,0.10600519925355911},{0.3235093951225281,0.051010455936193466,0.09348820149898529,0.3813292682170868},{-0.048328690230846405,0.06672395765781403,0.2764105796813965,0.008532990701496601},{-0.12724480032920837,0.1968546062707901,0.18505190312862396,-0.020909832790493965},{-0.2389286309480667,-0.012918230146169662,0.01617555133998394,-0.09915052354335785},{-0.2841588854789734,-0.09443878382444382,0.27611473202705383,-0.26146677136421204},{0.2671562433242798,-0.1461767703294754,-0.2297951877117157,-0.30919480323791504},{0.06848034262657166,0.22791635990142822,0.2776576578617096,-0.31691813468933105},{-0.09156353026628494,-0.12708963453769684,-0.12700045108795166,0.10135269165039062},{0.25551915168762207,-0.12280885130167007,0.004363390617072582,0.13830290734767914},{0.2212114930152893,0.26478198170661926,-0.05913250893354416,0.10219507664442062},{-0.0018757726065814495,0.0030809452291578054,-0.2695310115814209,0.0527370311319828},{0.10286790132522583,0.2361573576927185,0.2666448652744293,0.22395940124988556},{0.13041669130325317,0.025419682264328003,0.2036118358373642,0.2363714873790741},{-0.22423692047595978,-0.09664244949817657,-0.09737257659435272,-0.19599491357803345},{-0.10952487587928772,0.09941208362579346,-0.09063926339149475,-0.0833478793501854},{-0.27136966586112976,0.13176602125167847,0.13381393253803253,0.29854562878608704},{-0.02960735559463501,0.29378262162208557,-0.13553540408611298,0.1524345427751541},{-0.18192295730113983,-0.2877688407897949,-0.12078114598989487,-0.01793532259762287},{0.2744796872138977,0.3060360848903656,0.04015655070543289,-0.20100919902324677},{0.004241960123181343,0.14897847175598145,0.17321744561195374,0.14317458868026733},{-0.07671010494232178,0.3135429322719574,-0.03287038579583168,-0.11364317685365677},{0.004690531175583601,-0.016226110979914665,-0.06312616169452667,-0.022127661854028702},{0.22523567080497742,-0.2923514246940613,-0.056799910962581635,0.028429174795746803},{-0.016149872913956642,-0.28361979126930237,-0.15077824890613556,-0.26134997606277466},{0.12406186759471893,-0.13996237516403198,0.19529668986797333,0.07954245805740356},{0.007884516380727291,-0.0021260527428239584,0.0015024639433249831,0.00421646935865283},{-0.36868545413017273,0.34940677881240845,0.1862192153930664,0.0046667237766087055},{0.31334394216537476,-0.1355396956205368,0.1761416345834732,-0.03618576377630234},{0.08987767994403839,-0.3195416331291199,0.32019785046577454,-0.20336569845676422}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0900895744562149,-0.03920790180563927,0.012960202991962433,0.03804314136505127,-0.06706562638282776,-0.1119743138551712,0.050517573952674866,0.033468205481767654,0.010990145616233349,-0.017458342015743256,-0.03879377245903015,-0.0018922992749139667,0.05727143958210945,0.034828249365091324,-0.10527369379997253,-0.011452605947852135};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02246696501970291,0.015381385572254658,0.01431485079228878,-0.0019381486345082521,0.006499391049146652,0.011501835659146309,0.028375379741191864,0.03033834509551525,0.004811349790543318,0.0359286367893219,0.034510254859924316,-0.019583044573664665,0.027189867570996284,-0.02586538903415203,-0.051519718021154404,0.012457230128347874};
static const float actor_encoder_feed_forward_0_bias[32] = {0.018634077161550522,0.011177293956279755,0.003444443456828594,-0.005124285351485014,0.02096134051680565,0.004727229941636324,-0.007481162436306477,0.023602955043315887,-0.0369318425655365,-0.004197794012725353,-0.0184947419911623,-0.00042121903970837593,0.008495219983160496,-0.015572256408631802,0.0077703348360955715,0.05000279098749161,-0.002945701824501157,-0.03481298312544823,0.02085229568183422,-0.016617340967059135,-0.03177227824926376,0.008169112727046013,0.05742615461349487,0.015215964056551456,-0.00540740555152297,0.02843089960515499,-0.031070081517100334,0.0441061407327652,0.022735459730029106,-0.002781705232337117,0.01700219325721264,0.02140275575220585};
static const float action_parameterization_distribution_linear_bias[4] = {0.006127251777797937,-0.012112845666706562,0.013815155252814293,0.005487955175340176};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.035373505204916,0.29257264733314514,-0.12860539555549622,0.18210473656654358,0.08433334529399872,0.03591161221265793,0.6115500330924988,-0.14060215651988983},{-0.13168279826641083,-0.03124895878136158,-0.26287534832954407,-0.2179846167564392,-0.41442739963531494,-0.2664683759212494,0.10533028841018677,-0.2736664414405823},{-0.189966082572937,0.013987613841891289,0.2663532495498657,0.2530656158924103,0.21466967463493347,-0.04557814449071884,0.430409699678421,-0.17055568099021912},{0.022861987352371216,0.08331924676895142,-0.11754932254552841,0.033023688942193985,-0.024493593722581863,-0.07820931822061539,0.3849022686481476,-0.2536604702472687},{-0.23713456094264984,-0.11886349320411682,-0.18411757051944733,-0.11754650622606277,-0.0627608671784401,0.163522869348526,0.25633665919303894,-0.08499239385128021},{-0.30233731865882874,-0.03150429204106331,0.4766974151134491,0.26290106773376465,0.13833166658878326,-0.12518785893917084,-0.08292023092508316,-0.17444659769535065},{-0.251656711101532,0.006750287488102913,0.5298225283622742,-0.165242537856102,-0.1732933670282364,-0.4353114664554596,-0.06261356920003891,-0.1331309825181961},{-0.290432333946228,-0.3720449209213257,0.6444846987724304,-0.030904866755008698,-0.2504710853099823,0.2122364640235901,0.21391963958740234,-0.2569236755371094},{-0.39478397369384766,0.28525450825691223,-0.06730512529611588,0.39910632371902466,0.059861138463020325,-0.33807820081710815,0.03136054053902626,0.09941058605909348},{-0.4526790380477905,-0.34776782989501953,-0.11798983812332153,-0.20807810127735138,-0.5391215085983276,0.14165619015693665,-0.03103349730372429,0.176025390625},{0.06197267398238182,0.29558125138282776,0.2322549670934677,-0.029941478744149208,0.2076197862625122,0.17719675600528717,-0.20132111012935638,0.2507580816745758},{0.09589828550815582,-0.011789456941187382,0.2575269639492035,0.2244999259710312,-0.2971419095993042,0.348776251077652,0.004664600361138582,-0.20153899490833282},{0.03387044370174408,-0.3574455678462982,0.26242688298225403,-0.08038808405399323,-0.36183664202690125,-0.044373102486133575,-0.1609847992658615,-0.11191868782043457},{-0.2837679088115692,-0.2840196192264557,0.35111895203590393,0.3325140178203583,-0.26215049624443054,-0.04653807356953621,-0.28038036823272705,0.22722040116786957},{0.006877575069665909,-0.22012658417224884,0.16685010492801666,-0.236359104514122,-0.2885679006576538,-0.10494564473628998,0.2343636006116867,0.01595262624323368},{0.12998929619789124,-0.124054916203022,0.06105192378163338,-0.24028243124485016,0.06083528697490692,0.0992506742477417,0.07648646086454391,0.4165198504924774},{-0.11172354221343994,-0.36388710141181946,-0.1405249536037445,0.12308231741189957,-0.22080597281455994,-0.12956944108009338,-0.1211685910820961,0.13442759215831757},{-0.24180038273334503,-0.3393380343914032,0.04877385497093201,0.029039442539215088,0.1017686277627945,-0.1776275336742401,0.35791125893592834,0.15688611567020416},{-0.052434585988521576,0.08786515891551971,-0.2460603564977646,0.10476720333099365,0.08604639023542404,0.20881494879722595,-0.20685024559497833,0.3414728045463562},{0.047930240631103516,-0.06293211877346039,-0.3499462604522705,0.09397387504577637,-0.0847480446100235,-0.012078330852091312,-0.2887200117111206,-0.0073388563469052315},{-0.01105109229683876,-0.17409566044807434,0.08306462317705154,-0.08936700224876404,0.31159573793411255,0.06918056309223175,0.027422012761235237,0.39892441034317017},{-0.08477425575256348,0.045926932245492935,-0.24389879405498505,0.29123279452323914,0.35461997985839844,0.39004427194595337,0.23234787583351135,-0.3063984811306},{-0.5378848314285278,-0.2163819968700409,0.17091195285320282,-0.09326598048210144,0.22036325931549072,-0.21241146326065063,0.29260990023612976,-0.27113476395606995},{-0.2840832769870758,-0.031515832990407944,-0.08509030938148499,-0.4766116142272949,0.25267305970191956,0.0926947221159935,-0.23466287553310394,0.1603529304265976},{-0.3482127785682678,-0.20038342475891113,-0.03927316144108772,-0.04348877817392349,-0.035815801471471786,0.24938935041427612,0.34841716289520264,-0.1370128095149994},{-0.3286924362182617,0.05247123911976814,-0.38649532198905945,-0.3636854290962219,0.1693333238363266,0.08530610799789429,-0.048440173268318176,0.047190096229314804},{0.2614288032054901,0.38070225715637207,-0.299433171749115,0.14198525249958038,0.21111011505126953,0.42728692293167114,-0.2141425907611847,-0.1643817126750946},{0.3110547959804535,0.24772940576076508,0.04669520631432533,0.043008074164390564,0.2811591625213623,0.23083405196666718,0.3567010462284088,0.35069000720977783},{-0.1993817389011383,0.3719101548194885,0.1412404477596283,-0.021666567772626877,0.23036892712116241,0.09167713671922684,-0.2517690360546112,-0.3049694299697876},{-0.2933324873447418,-0.2201995700597763,0.06723383814096451,-0.2941656708717346,-0.3048408627510071,-0.12548917531967163,0.42140206694602966,-0.08486875146627426},{0.29270094633102417,-0.23028995096683502,0.3543930947780609,-0.349117249250412,0.00038833494181744754,0.2440916746854782,0.35072022676467896,-0.31637775897979736},{0.10928191989660263,0.4219323992729187,0.422768235206604,-0.291915625333786,-0.3258044719696045,0.04142481088638306,0.38567423820495605,-0.03081807866692543}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.005341035779565573,0.43829312920570374,-0.15454280376434326,0.17792390286922455,-0.43050119280815125,0.3160449266433716,0.30388039350509644,0.11305922269821167},{-0.5033596158027649,-0.4261796474456787,-0.3607684373855591,-0.45112907886505127,-0.47205495834350586,0.49270787835121155,0.3286336660385132,-0.35133394598960876},{0.11507625132799149,-0.14603734016418457,0.14574940502643585,0.1945621818304062,-0.011778177693486214,0.45159590244293213,-0.278495728969574,-0.5203306078910828},{0.3999847173690796,-0.10082275420427322,0.2043822556734085,-0.020368371158838272,0.46638941764831543,0.44431859254837036,0.5070374011993408,0.3908541202545166},{0.10567398369312286,0.1648913472890854,-0.12744972109794617,-0.22007808089256287,0.07650956511497498,-0.39437398314476013,-0.5126256346702576,0.55078125},{0.45807093381881714,0.13384918868541718,-0.023767543956637383,-0.3216880261898041,-0.4527279734611511,-0.49095502495765686,-0.10184526443481445,0.40477484464645386},{-0.4751071631908417,-0.30556800961494446,-0.13113631308078766,-0.226063534617424,-0.006662505678832531,0.5245003700256348,-0.4995761513710022,0.49722084403038025},{0.1303311437368393,0.05125785991549492,0.0030913071241229773,0.021640345454216003,0.32865938544273376,-0.4451456665992737,0.2975325286388397,-0.34838786721229553}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.08583659678697586,0.021169669926166534,0.054102253168821335,-0.031240146607160568,-0.05874045938253403,0.02035985328257084,0.041744597256183624,-0.021457893773913383};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011831446550786495,0.018516825512051582,-0.06282123923301697,0.06411372870206833,0.0005578246200457215,-0.006043585482984781,0.044688787311315536,-0.09097002446651459};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

