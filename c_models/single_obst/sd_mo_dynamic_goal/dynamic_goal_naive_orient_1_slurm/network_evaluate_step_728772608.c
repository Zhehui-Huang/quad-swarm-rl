#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3580723702907562,-0.2464502900838852,0.34579285979270935,0.17558139562606812,-0.42538127303123474,0.11622267961502075,0.031055670231580734,-0.21286967396736145,0.09551575034856796,0.4760335683822632,0.0972478911280632,-0.011171589605510235,0.151353657245636,-0.13967424631118774,0.40157610177993774,-0.13387084007263184},{-0.37902170419692993,-0.22712208330631256,0.29902878403663635,0.1408032923936844,-0.25235825777053833,-0.016348039731383324,-0.39674443006515503,0.06150553748011589,-0.19668278098106384,-0.09645874053239822,0.11955153942108154,-0.14317402243614197,0.18724355101585388,-0.36614835262298584,-0.26174211502075195,0.0876687690615654},{0.1708356738090515,-0.25179728865623474,-0.24853943288326263,0.03025997243821621,0.10703615099191666,0.15307898819446564,-0.0726572573184967,0.0028575300239026546,-0.10536573082208633,-0.19180868566036224,-0.20661576092243195,0.3966144025325775,-0.007392247673124075,-0.1481255292892456,-0.35708191990852356,0.22527603805065155},{0.18105347454547882,0.21526411175727844,0.310473769903183,-0.10625413805246353,-0.32763928174972534,-0.006301236338913441,0.13959245383739471,0.11767156422138214,0.5063957571983337,-0.37112924456596375,0.018354546278715134,0.13135908544063568,-0.28817254304885864,-0.08295594900846481,0.3059234321117401,-0.36068055033683777},{-0.04963606223464012,0.1605939120054245,0.21797846257686615,-0.09731035679578781,0.23400680720806122,0.2625482976436615,0.2199617475271225,-0.04332191124558449,-0.061752449721097946,0.23806658387184143,0.3131906986236572,-0.09874740988016129,-0.1027507409453392,-0.3470383286476135,0.3502282202243805,0.12288791686296463},{-0.05135031417012215,-0.17599010467529297,-0.15417329967021942,-0.2757769227027893,0.1282057911157608,0.044478338211774826,-0.03817249834537506,-0.1608695536851883,0.24209733307361603,-0.2173977941274643,-0.3043217062950134,0.1926337480545044,0.3782183527946472,-0.03588058799505234,-0.06167957931756973,0.177127406001091},{-0.07963044941425323,0.07394015789031982,0.07251803576946259,-0.2553125023841858,0.2392907440662384,0.02590119279921055,0.05694601684808731,0.4069948196411133,0.28919699788093567,-0.01882760226726532,-0.3694107234477997,0.2836504280567169,-0.055860262364149094,0.183951735496521,-0.17733734846115112,-0.1898214966058731},{0.008607612922787666,-0.030727477744221687,0.23013418912887573,0.2101181298494339,-0.3415162265300751,0.015925953164696693,0.30144327878952026,0.3220018446445465,-0.03154175728559494,0.18331319093704224,-0.4687221348285675,-0.27538391947746277,0.2679368853569031,0.2410002499818802,0.2136983573436737,0.14734292030334473},{0.3522855043411255,-0.1887035369873047,0.3582160472869873,-0.028043393045663834,0.12245230376720428,0.11215180903673172,-0.21941865980625153,-0.23798029124736786,0.1940813809633255,-0.274282306432724,0.025229239836335182,-0.29618561267852783,-0.19868023693561554,0.29920679330825806,0.15106332302093506,-0.0912250354886055},{0.06627457588911057,-0.20104648172855377,-0.45233216881752014,-0.06572829186916351,-0.33361366391181946,0.20801152288913727,0.39664748311042786,0.15180912613868713,0.44306087493896484,0.3969186246395111,0.006161774508655071,-0.31095635890960693,0.1008458063006401,0.31664133071899414,-0.11954579502344131,-0.3775046765804291},{0.04994775354862213,0.2561374604701996,0.3545984625816345,-0.2680226266384125,-0.28203269839286804,0.22393594682216644,0.20267799496650696,0.35144129395484924,-0.28009217977523804,-0.03573068231344223,-0.04066215828061104,0.16533763706684113,-0.28966325521469116,-0.19266338646411896,0.33408769965171814,-0.3883076012134552},{0.027385689318180084,-0.15456664562225342,0.0035079868976026773,0.1688380092382431,0.3472124934196472,0.3241015076637268,0.41328632831573486,-0.03425276279449463,0.021551376208662987,-0.056111741811037064,0.2816142141819,-0.18890540301799774,0.014284759759902954,-0.25761473178863525,0.27796846628189087,0.2961815893650055},{-0.10942188650369644,0.2682141065597534,0.09619072079658508,-0.338115930557251,0.08741164952516556,0.09560924768447876,0.3689939081668854,-0.03818858787417412,0.09504766017198563,-0.0021348365116864443,-0.10250992327928543,0.15042418241500854,0.15653587877750397,0.28174248337745667,0.13532379269599915,-0.30379852652549744},{-0.23728930950164795,-0.25176092982292175,-0.2452276349067688,0.0073048705235123634,-0.18316397070884705,0.07993029803037643,-0.29514145851135254,0.09032066911458969,-0.003039625706151128,-0.05351972207427025,-0.26224908232688904,-0.033406395465135574,-0.3582136929035187,0.07180556654930115,0.22260914742946625,0.10071827471256256},{-0.23186208307743073,-0.3122306168079376,-0.2653978168964386,0.32338887453079224,0.11804332584142685,-0.3532339334487915,0.25767210125923157,-0.10405976325273514,0.07816506922245026,0.29790040850639343,0.09374460577964783,0.1984316110610962,0.1824127435684204,-0.03558053821325302,-0.2111864686012268,0.20274563133716583},{0.4360371232032776,-0.043893881142139435,-0.24585573375225067,-0.3780091404914856,-0.5869606137275696,0.29545989632606506,0.46320223808288574,-0.26923757791519165,0.12831206619739532,0.0747794359922409,-0.2769428789615631,0.07611653208732605,-0.4882568120956421,0.5553936958312988,-0.2844763994216919,-0.019170941784977913},{-0.3888823986053467,-0.3724268674850464,0.41104981303215027,0.3318198621273041,-0.2894667983055115,0.2772969603538513,-0.08066685497760773,-0.2767707407474518,0.26414063572883606,-0.4367770850658417,-0.32064664363861084,-0.6630804538726807,-0.2915736734867096,-0.4065588414669037,0.06158691644668579,-0.20318546891212463},{-0.34756821393966675,0.27594172954559326,-0.5488848686218262,-0.04010908678174019,0.005871267057955265,0.38150960206985474,-0.3603438138961792,-0.40132346749305725,0.23614537715911865,0.22256866097450256,0.38518714904785156,-0.030765201896429062,-0.2326032817363739,0.25094735622406006,0.16424237191677094,-0.4906436800956726}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.07981128990650177,-0.10430841892957687,-0.2035796046257019,-0.4122525751590729,0.357843279838562,0.27987104654312134,0.060852792114019394,0.07135892659425735,-0.2242370992898941,-0.10842156410217285,-0.08410487323999405,0.04380474612116814,0.21227377653121948,0.448363333940506,0.09976855665445328,0.09009356051683426},{-0.1726134866476059,-0.23499897122383118,-0.037117499858140945,0.1407671719789505,0.32095056772232056,-0.22786864638328552,0.13906006515026093,0.04776908829808235,-0.055825695395469666,0.2635011374950409,-0.11847922205924988,0.3381952941417694,-0.3486272692680359,0.21057936549186707,-0.34306150674819946,-0.2520187795162201},{0.1297849863767624,0.2026815563440323,-0.3341525197029114,-0.5978694558143616,0.17218095064163208,0.4314219653606415,-0.09338738769292831,0.11118505150079727,-0.25334978103637695,-0.2447211593389511,-0.013904981315135956,0.2706564664840698,-0.27005937695503235,-0.24391326308250427,0.09564177691936493,-0.03634357079863548},{0.21847419440746307,-0.03733421117067337,0.05271891504526138,0.14580728113651276,-0.5071597099304199,0.022427871823310852,0.05141398310661316,-0.27089783549308777,0.3256594240665436,0.3531228005886078,-0.12322651594877243,-0.18308715522289276,-0.40547001361846924,-0.34814202785491943,0.19887225329875946,0.23896373808383942},{-0.13504210114479065,0.08637762814760208,0.04368235170841217,0.32322701811790466,-0.2549094259738922,-0.006636987905949354,-0.02777329832315445,0.23168273270130157,0.21403197944164276,-0.271755576133728,0.017513949424028397,0.3682290315628052,0.12346816807985306,-0.42577967047691345,-0.0809953510761261,-0.14428752660751343},{0.19145065546035767,0.14979538321495056,-0.015573815442621708,0.18039953708648682,-0.337782621383667,-0.4173775315284729,0.19558487832546234,0.26730087399482727,0.13204018771648407,0.4183047413825989,0.21495679020881653,-0.2612813115119934,0.014203633181750774,-0.16447462141513824,-0.07503896206617355,0.31008797883987427},{-0.05809551849961281,0.14923949539661407,0.366529256105423,-0.34602445363998413,-0.1421625018119812,0.05381180718541145,-0.29899275302886963,-0.052161358296871185,0.129594087600708,0.08875933289527893,-0.11541590839624405,-0.29847368597984314,-0.23251917958259583,0.013844910077750683,0.1407565027475357,0.08161071687936783},{-0.15683090686798096,-0.15308935940265656,-0.37730592489242554,0.27741023898124695,-0.23308011889457703,-0.31329426169395447,-0.17881684005260468,-0.33104079961776733,0.038143374025821686,-0.1623476892709732,-0.1342741847038269,0.16196633875370026,-0.2227163165807724,0.4222560524940491,-0.09575565904378891,-0.3833310306072235},{-0.21432416141033173,0.27862969040870667,-7.225559966173023e-05,-0.019019685685634613,0.317581444978714,-0.2189038246870041,0.4023768901824951,0.12343776226043701,0.23356901109218597,0.3851451277732849,0.24588988721370697,0.2998165488243103,0.24924153089523315,-0.03777970373630524,0.2563019096851349,0.11985476315021515},{0.11637184023857117,-0.28994622826576233,-0.015080601908266544,-0.11901266127824783,0.32248255610466003,-0.06057862192392349,-0.30352094769477844,-0.23341061174869537,0.06730815023183823,-0.4506077468395233,-0.16038037836551666,0.18940240144729614,0.13225679099559784,0.17202065885066986,-0.30989518761634827,0.30261629819869995},{-0.11243639886379242,-0.33774590492248535,0.4321059286594391,0.24276503920555115,0.23530079424381256,0.15406912565231323,0.07247107475996017,-0.1488252729177475,0.11739129573106766,-0.19507168233394623,-0.0008430136367678642,0.41169923543930054,0.25908952951431274,0.13925082981586456,-0.21717552840709686,-0.012226979248225689},{-0.0021006069146096706,-0.137837216258049,0.2794815003871918,0.006795987486839294,-0.14377617835998535,-0.23175013065338135,0.4546073377132416,0.29998135566711426,-0.2741689085960388,-0.38301119208335876,-0.11460884660482407,-0.3485848307609558,0.009189864620566368,-0.3425426483154297,-0.3471554219722748,-0.010678162798285484},{-0.05898751690983772,-0.314933717250824,0.3238441050052643,-0.22257176041603088,0.3039712607860565,-0.3164718449115753,-0.34463486075401306,0.17319995164871216,0.07878876477479935,-0.04752432182431221,-0.27245455980300903,0.058266110718250275,0.07767129689455032,-0.2576151192188263,-0.3647412359714508,0.015896139666438103},{0.2993687093257904,-0.2875276505947113,0.44245678186416626,0.15276497602462769,0.03589590638875961,0.3017665147781372,-0.06263807415962219,-0.20306164026260376,-0.5075001120567322,0.12517674267292023,0.03039105422794819,-0.3680676221847534,0.009094602428376675,0.2121884673833847,0.34381982684135437,0.03380276635289192},{-0.24206936359405518,0.14867214858531952,0.12237344682216644,-0.3100276589393616,-0.18891213834285736,0.03511853143572807,0.22119086980819702,-0.13069123029708862,0.17178930342197418,-0.34129849076271057,0.007716349326074123,0.06432957202196121,-0.016293229535222054,0.06910491734743118,-0.10585296154022217,0.022771377116441727},{-0.2136525958776474,0.28743886947631836,-0.3010316491127014,0.3532198965549469,0.13078124821186066,-0.3674719035625458,-0.09694121032953262,-0.10245602577924728,-0.36613786220550537,0.27376800775527954,-0.3462378978729248,0.31569018959999084,-0.06895982474088669,-0.17934368550777435,-0.2816113233566284,-0.5186266303062439}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.13965559005737305,0.0040603503584861755,-0.053974129259586334,-0.04596725106239319,-0.116461381316185,0.028852339833974838,0.2842642366886139,0.06272492557764053,-0.13199277222156525,-0.21896319091320038,0.126050665974617,-0.2766270637512207,-0.18328426778316498,0.22706162929534912,0.22625534236431122,0.2952917516231537,-0.2354349046945572,-0.3136850893497467,-0.17640690505504608,0.05681097134947777,-0.037749066948890686,-0.34874099493026733,-0.2454529106616974,-0.26994478702545166,-0.30864736437797546,0.20259396731853485,-0.2169472873210907,-0.027750665321946144,-0.013685250654816628,0.021401923149824142,0.23650945723056793,-0.16738758981227875},{0.2846844494342804,0.22255940735340118,0.1500101089477539,-0.06814571470022202,0.09784623235464096,-0.10289076715707779,0.27068832516670227,0.14081992208957672,-0.18937037885189056,-0.16371269524097443,-0.05176544189453125,-0.2403283268213272,-0.16073736548423767,0.17319253087043762,-0.20016272366046906,-0.31426727771759033,-0.06042412295937538,0.1370236873626709,-0.2867191433906555,-0.27505674958229065,0.02232334576547146,0.22703085839748383,0.10649015754461288,-0.116544209420681,0.15942470729351044,-0.2903948724269867,0.04214293137192726,0.07096628099679947,0.2250504493713379,-0.10624775290489197,-0.03431502729654312,0.2689497172832489},{0.23722995817661285,0.08816532045602798,-0.03325648605823517,0.10739205032587051,-0.15755674242973328,-0.15480227768421173,-0.23177365958690643,0.14094609022140503,-0.1216798797249794,0.3566838204860687,-0.29689592123031616,-0.2067861706018448,0.16095180809497833,-0.35449522733688354,-0.17180395126342773,0.13225069642066956,-0.09925271570682526,-0.10634256154298782,0.2311762124300003,-0.01811235025525093,0.19592906534671783,0.2749478816986084,-0.2587551176548004,0.05474722012877464,-0.1657952070236206,-0.10767365992069244,0.12609629333019257,-0.05667642876505852,-0.08482460677623749,-0.16326120495796204,-0.04612385109066963,-0.14320437610149384},{0.3217412829399109,0.059196241199970245,0.09605497866868973,-0.1308477222919464,-0.2553322911262512,-0.08290699124336243,-0.13061274588108063,0.21626177430152893,0.2441462278366089,-0.20754685997962952,-0.11988445371389389,0.2618996798992157,0.11759253591299057,-0.10178536176681519,-0.23673047125339508,0.313923180103302,-0.3127371668815613,0.26045405864715576,-0.03817173093557358,0.03936026245355606,-0.062088340520858765,-0.10706877708435059,0.27993521094322205,0.16857796907424927,0.15923185646533966,-0.309395432472229,0.29665684700012207,-0.20327052474021912,-0.03358735889196396,0.012860918417572975,-0.31249377131462097,0.14928866922855377},{-0.02456982247531414,-0.03703426942229271,-0.08165571093559265,0.04156523570418358,0.19993922114372253,-0.15651589632034302,-0.37483686208724976,0.012427816167473793,-0.13755837082862854,-0.196669340133667,0.16033633053302765,0.22602610290050507,-0.08880991488695145,-0.08575752377510071,-0.07902605086565018,0.21781791746616364,-0.03816604241728783,-0.0005765487439930439,-0.3331887125968933,-0.03433197736740112,-0.18913359940052032,-0.3338412642478943,0.16699643433094025,0.2342885583639145,-0.057852853089571,0.269519180059433,-0.1664334386587143,0.24556870758533478,0.27869531512260437,0.3531292974948883,0.006319599691778421,0.289791077375412},{-0.21072445809841156,-0.11202038079500198,-0.11890915781259537,-0.08210453391075134,-0.10362821072340012,0.22128315269947052,0.23000839352607727,0.05023882910609245,0.3317858576774597,0.1209704801440239,0.28212836384773254,-0.21890585124492645,-0.1440698653459549,0.24642135202884674,0.2500854432582855,-0.3397189974784851,-0.08155214786529541,-0.23128196597099304,0.2327018678188324,0.16325858235359192,0.0681241899728775,0.1329253762960434,-0.017946692183613777,-0.00891431886702776,-0.34130245447158813,0.30952727794647217,-0.20382767915725708,0.16295352578163147,0.3224666714668274,0.23499982059001923,0.0960514098405838,0.04593031108379364},{0.16070304811000824,-0.135736882686615,-0.13852070271968842,-0.32920193672180176,0.004058689810335636,0.23635327816009521,0.2723110616207123,0.1122032031416893,0.10396561026573181,0.2974684536457062,0.000987428822554648,0.0004617067170329392,-0.4296853542327881,-0.12094441056251526,-0.144412100315094,0.028776833787560463,-0.2724146246910095,-0.21839654445648193,0.17114345729351044,-0.10223653167486191,-0.11568131297826767,-0.14285942912101746,-0.2222108542919159,-0.26485198736190796,0.1792222261428833,-0.25963783264160156,-0.11953295767307281,-0.20679707825183868,0.3442371189594269,0.12358492612838745,-0.17888616025447845,-0.2768254280090332},{0.07241685688495636,0.17875124514102936,0.05804000422358513,-0.12760108709335327,0.14778029918670654,-0.28790605068206787,-0.06019705906510353,-0.15432067215442657,0.00937532726675272,-0.2933931052684784,-0.30572447180747986,-0.08905084431171417,-0.11138781905174255,0.06017881631851196,-0.12190152704715729,0.39505618810653687,0.010731121525168419,-0.14228452742099762,0.12986144423484802,0.32638201117515564,-0.17826688289642334,-0.19648003578186035,0.27248403429985046,0.07764780521392822,0.003025742946192622,-0.34899336099624634,-0.3225593864917755,-0.22451695799827576,-0.3657963275909424,-0.25824084877967834,0.10990732908248901,-0.36931851506233215},{0.031506605446338654,0.3967950642108917,-0.37466228008270264,-0.36278820037841797,-0.2769543528556824,0.08038575947284698,0.08182671666145325,0.10274253785610199,0.10862694680690765,-0.21335338056087494,-0.21442753076553345,0.2734192907810211,-0.3488197922706604,-0.1830569952726364,0.18033026158809662,-0.22445933520793915,0.21402868628501892,0.11169282346963882,0.27530786395072937,0.05614577978849411,0.20927774906158447,0.1206756979227066,0.32524335384368896,-0.12666121125221252,0.4588811993598938,-0.1698969453573227,0.18917980790138245,0.32547155022621155,-0.1885453462600708,0.09982310980558395,-0.0003458071732893586,0.09286986291408539},{-0.1965096890926361,0.11188046634197235,-0.33159780502319336,-0.16473819315433502,0.10341117531061172,-0.19542507827281952,0.08613623678684235,0.013658961281180382,0.15439337491989136,0.023999901488423347,-0.23946349322795868,-0.3126794397830963,-0.4217548370361328,-0.12793897092342377,-0.21683794260025024,0.08101917803287506,-0.02403147891163826,-0.2654462456703186,0.2432616949081421,0.07226035743951797,0.09126477688550949,-0.02964339219033718,0.3804980516433716,-0.23209375143051147,0.3143790364265442,0.1488552689552307,-0.20523342490196228,0.061256710439920425,0.034281179308891296,0.07494964450597763,-0.17737087607383728,0.15455469489097595},{0.0758129432797432,-0.03760906308889389,0.18320047855377197,-0.275540828704834,-0.23473508656024933,-0.22595717012882233,-0.2487933486700058,-0.09315714985132217,-0.16014054417610168,0.3138209879398346,0.11562644690275192,-0.2836189866065979,-0.33398517966270447,-0.0063547310419380665,-0.22585807740688324,-0.19484439492225647,0.2602092921733856,-0.14938540756702423,0.25834131240844727,-0.21859559416770935,-0.18959510326385498,0.007144913077354431,0.16467180848121643,0.1714320331811905,0.17239029705524445,-0.1344580054283142,-0.0656856819987297,-0.06971856206655502,-0.0535242073237896,0.022274356335401535,-0.07247576862573624,0.16609829664230347},{-0.21272295713424683,-0.03639120236039162,0.24538464844226837,0.3342002034187317,0.2632639408111572,-0.009485920891165733,0.05364694446325302,-0.2081933468580246,-0.09102064371109009,-0.18787917494773865,0.28749415278434753,-0.24363087117671967,-0.21082277595996857,-0.2079816460609436,0.28261515498161316,0.002769595943391323,-0.020384497940540314,0.016716474667191505,0.3259304463863373,0.08509720861911774,-0.1795816719532013,0.22123722732067108,0.10817871987819672,-0.10224343836307526,0.2015020251274109,-0.10201466828584671,-0.14166177809238434,0.22068051993846893,0.2030573934316635,-0.01846277341246605,-0.2720525860786438,-0.25143882632255554},{0.22195027768611908,-0.2452300786972046,-0.006403155624866486,-0.34840714931488037,0.14155811071395874,-0.05313032865524292,0.16962431371212006,0.07499998807907104,0.2517021894454956,0.06113826483488083,0.13860104978084564,0.18568623065948486,-0.3609136641025543,-0.2196519523859024,-0.07091846317052841,-0.21229025721549988,-0.11944110691547394,-0.1965021938085556,0.2418421506881714,-0.23076991736888885,0.2573862671852112,0.016035037115216255,-0.017028596252202988,0.17974577844142914,0.13070614635944366,-0.07697826623916626,0.12481677532196045,0.1599602997303009,0.13289442658424377,-0.0787365511059761,-0.2048751562833786,-0.10193322598934174},{0.22903576493263245,-0.041213616728782654,-0.048081353306770325,0.4245855212211609,-0.10214627534151077,-0.1898287683725357,-0.07382035255432129,0.10323894768953323,0.16916534304618835,0.2911796271800995,0.13614250719547272,-0.14607815444469452,0.023055600002408028,0.19586192071437836,-0.09659962356090546,0.05213566869497299,0.20685747265815735,-0.24123910069465637,0.05739111453294754,-0.32850325107574463,0.32216352224349976,0.14972902834415436,-0.056040551513433456,0.1792972832918167,0.18414849042892456,0.08811523765325546,0.09802999347448349,0.06403312087059021,0.067784883081913,-0.14563095569610596,-0.0370921827852726,0.40432822704315186},{0.030853427946567535,-0.2712736427783966,-0.0844489187002182,0.11594412475824356,-0.24379734694957733,-0.013895745389163494,0.061510682106018066,-0.2679511308670044,-0.15785597264766693,-0.05907004699110985,0.18117065727710724,0.14636044204235077,0.08189032226800919,0.2613213360309601,-0.05531841143965721,-0.10465938597917557,-0.23203140497207642,0.2634252905845642,-0.09053217619657516,-0.27291250228881836,-0.17899373173713684,-0.08175209909677505,0.18199653923511505,-0.01126822829246521,-0.043618347495794296,-0.07052437961101532,-0.19968187808990479,0.22547578811645508,0.07032142579555511,-0.16995464265346527,0.21724046766757965,0.20134064555168152},{0.13682453334331512,-0.23147894442081451,-0.0865081325173378,-0.19203393161296844,-0.09524911642074585,0.16273614764213562,0.03345341607928276,0.2414986789226532,-0.08931241929531097,0.001184253254905343,0.2598440945148468,0.11769542843103409,-0.04311918839812279,-0.11649300903081894,0.04520280659198761,0.15613746643066406,-0.4004017114639282,-0.28232765197753906,-0.06024404242634773,0.054240260273218155,0.11535841226577759,0.2354157567024231,0.26785460114479065,0.1449459046125412,0.050264980643987656,0.22422246634960175,0.02104533649981022,-0.06887678802013397,0.19447194039821625,-0.11569162458181381,-0.24617786705493927,0.36581936478614807},{0.20547045767307281,-0.02643970027565956,-0.23015591502189636,0.15881119668483734,0.08674360066652298,-0.045878563076257706,0.26546064019203186,0.119895339012146,0.11146294325590134,-0.22519661486148834,0.20913320779800415,-0.17143163084983826,-0.3397766053676605,0.24643009901046753,0.06810951232910156,0.05558697134256363,0.07361526042222977,-0.03957817703485489,-0.1284368932247162,0.07629702240228653,-0.07379996031522751,0.18735194206237793,0.0453299880027771,-0.13678842782974243,0.0462678000330925,-0.3177705407142639,0.03370150923728943,0.41132599115371704,0.2069881111383438,-0.12676922976970673,0.2251572161912918,0.17381176352500916},{-0.08663937449455261,-0.041487760841846466,-0.1107851192355156,-0.04450118541717529,-0.2444082349538803,-0.047503162175416946,0.2114788442850113,0.15683898329734802,0.1489940881729126,0.017877694219350815,0.23102863132953644,-0.0050521125085651875,0.2138901948928833,0.17302332818508148,0.17042666673660278,-0.09032164514064789,0.11756665259599686,0.15729261934757233,0.22645895183086395,0.06512123346328735,0.1776513010263443,0.24297164380550385,0.05594797432422638,0.1411290317773819,-0.01448778621852398,-0.0948086678981781,-0.10346510261297226,-0.2548859715461731,0.15887701511383057,-0.2489936351776123,-0.004864430520683527,-0.0340665839612484},{-0.28905120491981506,0.10861410945653915,-0.26083195209503174,-0.3418768048286438,-0.019617808982729912,0.07850059866905212,0.10886538773775101,-0.09263093024492264,-0.012460718862712383,0.280911386013031,0.06908014416694641,-0.1996687650680542,0.09079392999410629,-0.18999579548835754,-0.3049187660217285,-0.03712386637926102,-0.17046329379081726,0.16058865189552307,-0.00887902732938528,-0.050901446491479874,-0.31384891271591187,0.17598530650138855,0.11898048222064972,0.021754181012511253,-0.010556239634752274,0.26297658681869507,0.029242582619190216,-0.12354637682437897,-0.17601919174194336,0.03518671169877052,-0.11339495331048965,-0.24189776182174683},{0.002400384284555912,-0.21308773756027222,-0.21460914611816406,-0.018724747002124786,-0.357831209897995,-0.14964644610881805,0.15612249076366425,-0.29695695638656616,-0.2024366706609726,0.18697302043437958,0.149164080619812,0.12702399492263794,0.14936044812202454,-0.11715243011713028,0.322468101978302,-0.32431772351264954,0.08079290390014648,0.23955823481082916,0.06308304518461227,0.24349388480186462,0.050657905638217926,-0.11022987216711044,-0.28340861201286316,0.18554195761680603,-0.18182967603206635,-0.17415675520896912,0.1057446151971817,0.04038542881608009,-0.11707083880901337,-0.2896800935268402,-0.024195531383156776,-0.13599632680416107},{0.24062302708625793,0.20383737981319427,-0.07285229116678238,0.1695726066827774,-0.28637829422950745,0.17326197028160095,-0.06744571030139923,-0.1260547786951065,-0.18764980137348175,0.1984507292509079,-0.2576224207878113,-0.16172537207603455,-0.04106983169913292,-0.19539791345596313,-0.3686686158180237,-0.11708179861307144,-0.08386901021003723,-0.27389559149742126,-0.23533561825752258,0.278373658657074,0.09607306122779846,0.1193017065525055,-0.3330889046192169,0.3350905478000641,0.19803975522518158,0.2501297891139984,-0.27941831946372986,-0.02774936892092228,0.06547748297452927,-0.2583989202976227,0.13170889019966125,0.09084334969520569},{0.0016916521126404405,-0.3256601393222809,0.020606646314263344,-0.2556324005126953,-0.08420318365097046,0.2690925598144531,0.14511306583881378,0.01670548878610134,-0.04376780614256859,-0.00835262332111597,-0.20298458635807037,0.19036495685577393,0.16332334280014038,0.09783708304166794,0.17718279361724854,-0.016672145575284958,-0.07632043957710266,0.10470617562532425,-0.07439209520816803,0.16637316346168518,0.2389833629131317,0.21897098422050476,-0.0692727342247963,-0.2672107219696045,0.0729132741689682,0.09301237016916275,0.27868008613586426,0.12514737248420715,-0.02122153528034687,0.2163999378681183,0.03874561935663223,-0.09590215981006622},{0.029474835842847824,-0.17572112381458282,0.23715472221374512,0.004889162257313728,0.29870161414146423,-0.03188050910830498,-0.11277473717927933,-0.15296012163162231,0.13426326215267181,-0.0696219801902771,0.07452976703643799,0.001742420019581914,-0.3003786504268646,0.018245385959744453,-0.10632501542568207,-0.2389885038137436,-0.050102174282073975,-0.049297891557216644,0.2124655693769455,0.2442575842142105,0.03618600219488144,0.03744102641940117,0.17591986060142517,0.34447410702705383,-0.15526483952999115,-0.052493877708911896,0.20076705515384674,-0.11645571887493134,-0.19617749750614166,-0.2406919002532959,0.30162450671195984,-0.0023088434245437384},{0.18596746027469635,-0.07664996385574341,0.017154360190033913,0.1391901820898056,-0.027159539982676506,0.05570971965789795,-0.2666734457015991,0.259766161441803,-0.07029596716165543,-0.029119912534952164,0.10542954504489899,-0.2812580168247223,-0.019640672951936722,-0.010719443671405315,-0.09836643189191818,0.2736029326915741,-0.09338878095149994,-0.200022354722023,0.03616458550095558,-0.01813868246972561,-0.17374056577682495,0.21454362571239471,0.23816536366939545,0.20786118507385254,-0.28788548707962036,0.12439583241939545,-0.0582754984498024,0.09075223654508591,-0.27872276306152344,0.26265332102775574,-0.03673495352268219,0.04914592579007149}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.18029099702835083,-0.08116508275270462,0.07235810160636902,-0.12953996658325195},{0.194996640086174,-0.3040095567703247,0.24737997353076935,0.21772906184196472},{-0.2148040384054184,0.09673599153757095,0.038570623844861984,-0.01741708442568779},{0.2769279181957245,0.4404495358467102,0.33369389176368713,0.029273746535182},{-0.24768906831741333,0.11738263070583344,-0.27483686804771423,0.07812908291816711},{-0.04160573333501816,-0.03960716351866722,0.0537385419011116,0.3362780511379242},{-0.11023880541324615,-0.07895093411207199,-0.2991245985031128,-2.3824486561352387e-05},{-0.13532093167304993,-0.23334765434265137,0.13527263700962067,-0.05997982248663902},{-0.03836095333099365,0.09273141622543335,-0.07056426256895065,-0.07609770447015762},{0.19338415563106537,0.01810707524418831,-0.08388525992631912,-0.1350078284740448},{0.13248610496520996,-0.10878273844718933,0.2801693379878998,0.24227608740329742},{0.008734194561839104,0.011586323380470276,0.28604456782341003,-0.0782449021935463},{-0.3201899826526642,0.1957090049982071,-0.020814180374145508,-0.131308913230896},{-0.15668252110481262,0.08907009661197662,-0.2001793086528778,0.07620514184236526},{0.1639711856842041,0.03455222025513649,0.23991097509860992,0.08519969880580902},{-0.13079923391342163,-0.34893596172332764,-0.12363961338996887,-0.08800620585680008},{-0.23875553905963898,0.041308820247650146,-0.09230351448059082,0.2571776211261749},{-0.22675247490406036,-0.11652199178934097,-0.2079038918018341,0.1736423522233963},{-0.06065143644809723,-0.0668947622179985,0.3051254451274872,0.07878232002258301},{-0.17615382373332977,-0.13235799968242645,0.016209300607442856,-0.17295020818710327},{0.14578643441200256,0.09414228796958923,0.1208876520395279,-0.14965437352657318},{-0.047304872423410416,-0.23608168959617615,-0.08694322407245636,0.2392047494649887},{0.366168737411499,-0.19556160271167755,0.1356959044933319,0.03564130514860153},{-0.3121434152126312,-0.11759217828512192,-0.31225430965423584,-0.31461817026138306},{-0.1341691017150879,-0.14849138259887695,-0.06635095924139023,-0.09128762781620026},{0.12449204921722412,0.08960358798503876,-0.029136862605810165,0.0938221663236618},{0.14046503603458405,-0.1647571623325348,0.23595796525478363,0.07790372520685196},{-0.08526737987995148,-0.1466912478208542,-0.008313282392919064,0.2474391758441925},{0.07624538242816925,0.021153366193175316,0.05841962248086929,0.04514171555638313},{-0.13483983278274536,0.10119980573654175,0.21241295337677002,0.010867324657738209},{-0.21350766718387604,-0.1118437871336937,0.07172229886054993,0.17533791065216064},{0.22902809083461761,0.18880650401115417,0.25021791458129883,-0.040603380650281906}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.10754562169313431,-0.10001115500926971,0.04192487895488739,0.09679817408323288,0.10658690333366394,-0.09432046860456467,0.08588436990976334,-0.018832672387361526,-0.05740700662136078,-0.09777265787124634,0.0030601290054619312,0.0610540397465229,-0.016740236431360245,0.05896957963705063,0.09512250125408173,-0.03753805533051491};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.03174540027976036,0.06032316014170647,0.055669091641902924,-0.026865532621741295,-0.03273018077015877,0.05489922687411308,-0.058434970676898956,-0.07588139176368713,0.054553769528865814,-7.116034248610958e-05,-0.03192823380231857,-0.03163300082087517,0.008276439271867275,-0.07685878872871399,0.011640079319477081,-0.06679072231054306};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04339993745088577,0.008089362643659115,-0.05316303297877312,0.03449195623397827,0.001429265714250505,0.013712707906961441,-0.052961304783821106,-0.03822262957692146,-0.019588109105825424,-0.018826261162757874,0.013891080394387245,0.04166592285037041,0.041142068803310394,-0.05301623046398163,0.033995747566223145,-0.07931438088417053,-0.0059394994750618935,-0.03348209708929062,0.02632824331521988,-0.05135861784219742,0.02270606718957424,-0.004263554699718952,0.02823822945356369,-0.06749992072582245,-0.054421231150627136,0.05449451506137848,0.04565178602933884,-0.028762629255652428,0.07314981520175934,0.030262375250458717,-0.004484895151108503,0.056840334087610245};
static const float action_parameterization_distribution_linear_bias[4] = {0.03182171285152435,0.06037230044603348,0.010980059392750263,0.03358951956033707};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3270094692707062,-0.16890062391757965,-0.0003997794119641185,0.17659005522727966,0.026198577135801315,0.031013771891593933,-0.1975991427898407,0.03884228318929672},{0.04229075834155083,0.09890855103731155,0.32554131746292114,0.3291390538215637,-0.08298803120851517,-0.2296893447637558,0.3024502694606781,0.12928803265094757},{0.0016112717567011714,0.20322932302951813,0.020489957183599472,-0.03642360866069794,0.3184282183647156,0.2545715272426605,-0.10716882348060608,0.06931699812412262},{0.10012352466583252,-0.24279449880123138,0.2737058401107788,-0.2107352912425995,-0.2910861372947693,0.03400329872965813,0.20052111148834229,0.1769917756319046},{-0.20753955841064453,0.021349120885133743,-0.004586320836097002,-0.2930121421813965,0.07485853135585785,0.0329606868326664,0.24496689438819885,0.2613500654697418},{-0.07289598137140274,0.3118913471698761,-0.06459560245275497,-0.24787341058254242,0.14677108824253082,-0.002679870231077075,0.02270366996526718,-0.19517390429973602},{-0.00886090099811554,0.35264191031455994,0.14245018362998962,-0.1670362651348114,0.20379626750946045,-0.27704504132270813,0.2360219955444336,0.060890570282936096},{-0.0012579421745613217,-0.18728123605251312,0.05962497740983963,-0.07569731026887894,0.28455933928489685,-0.12707361578941345,0.013437388464808464,-0.29784271121025085},{-0.15738359093666077,0.28701967000961304,0.18428388237953186,-0.001499056234024465,0.030253075063228607,0.20083308219909668,0.44642141461372375,0.3595350384712219},{0.05545387789607048,-0.06164978817105293,-0.23219311237335205,0.3833865225315094,0.26263532042503357,0.14600364863872528,0.21032068133354187,-0.273608535528183},{-0.122231125831604,-0.31395843625068665,0.36207377910614014,0.23642542958259583,-0.03213433921337128,-0.3861018419265747,-0.11265406757593155,-0.3021559417247772},{0.30940496921539307,0.07987231761217117,0.36379021406173706,0.4884348213672638,-0.15780693292617798,0.17868879437446594,0.10530724376440048,-0.347152441740036},{-0.306209921836853,0.16616292297840118,-0.35041993856430054,0.4087909162044525,-0.04482653737068176,0.2444576770067215,-0.004349918570369482,0.2390872836112976},{-0.0109427310526371,0.2159923017024994,-0.0944182276725769,-0.18813979625701904,0.03245037794113159,0.06697665899991989,0.2907847464084625,-0.029984163120388985},{0.16557539999485016,-0.27904462814331055,-0.2787158787250519,-0.2093629091978073,0.21869264543056488,-0.18267805874347687,0.2109631597995758,-0.14027729630470276},{-0.35487502813339233,-0.3654726445674896,-0.2754598557949066,-0.04898364096879959,0.023463545367121696,0.11277938634157181,0.1913902461528778,-0.016284368932247162},{-0.21090157330036163,-0.23930101096630096,0.1423637866973877,-0.2536635100841522,0.0617147758603096,0.055929481983184814,-0.39496979117393494,-0.2642384469509125},{0.020617322996258736,0.26042237877845764,0.0517362579703331,0.2096152901649475,-0.09500150382518768,0.33108097314834595,0.2753690481185913,-0.17243260145187378},{-0.014595001004636288,-0.27886316180229187,-0.10260766744613647,0.005444038659334183,-0.052061669528484344,-0.33461934328079224,0.10989821702241898,-0.2054402083158493},{-0.1270940601825714,0.015489249490201473,0.09385593235492706,-0.24872709810733795,0.13530047237873077,0.06788834929466248,0.1065206378698349,0.008495342917740345},{0.022631844505667686,-0.05769970640540123,0.08726471662521362,-0.13270050287246704,0.045396674424409866,-0.026170628145337105,0.0959283858537674,-0.17487922310829163},{-0.30250006914138794,0.21811655163764954,0.20401740074157715,-0.2896011173725128,-0.3725149929523468,-0.014948274940252304,0.1950550377368927,0.01878759264945984},{0.2911536991596222,0.06554534286260605,-0.3668387532234192,-0.013014188036322594,-0.07509613782167435,0.2300788015127182,0.1830688714981079,0.26601362228393555},{0.013915826566517353,-0.21327218413352966,-0.038028787821531296,0.10314737260341644,-0.3360004723072052,-0.0746416300535202,-0.3119630813598633,-0.3198222219944},{0.12795908749103546,-0.08064921945333481,-0.38913241028785706,0.3564682900905609,-0.3208138942718506,-0.11044836044311523,-0.4561985433101654,0.09260381758213043},{-0.016557011753320694,0.3030334711074829,-0.20335011184215546,-0.07079164683818817,0.10126973688602448,-0.1294175237417221,0.2464541494846344,-0.2972150146961212},{-0.11026374250650406,0.08500662446022034,-0.09760572761297226,-0.2505306005477905,0.03650684282183647,-0.12018690258264542,-0.1588614284992218,-0.10197863727807999},{0.08187524229288101,-0.18459947407245636,0.01625838130712509,-0.13009074330329895,0.07202444970607758,0.0940726026892662,-0.2732568085193634,0.11653406172990799},{0.19942159950733185,0.005569267086684704,-0.304569274187088,-0.17221590876579285,-0.18605495989322662,0.18310384452342987,0.18522045016288757,0.04918038845062256},{0.28500545024871826,-0.3823680877685547,0.017667429521679878,-0.06285351514816284,0.09231869131326675,-0.08787873387336731,0.11737285554409027,0.22470730543136597},{-0.28809916973114014,-0.23027218878269196,0.04819732531905174,-0.3660186529159546,0.26904934644699097,-0.35203975439071655,-0.0787002220749855,0.07899928092956543},{0.28386735916137695,0.19444356858730316,0.011954079382121563,0.21658898890018463,0.08917324244976044,-0.19991563260555267,-0.087029829621315,0.15030555427074432}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.20762184262275696,0.4166698157787323,-0.44859451055526733,-0.501015841960907,-0.16953405737876892,-0.11618940532207489,-0.3745306730270386,0.4855509102344513},{-0.008152038790285587,0.41049256920814514,-0.23739613592624664,0.539609968662262,-0.03211991861462593,-0.062484804540872574,-0.3365536630153656,-0.027997903525829315},{-0.3175036609172821,-0.2232166826725006,-0.15852075815200806,-0.14495527744293213,0.40238550305366516,0.184919074177742,-0.07818196713924408,0.4083639979362488},{-0.47515490651130676,-0.46440666913986206,0.31380802392959595,0.22747313976287842,-0.5006212592124939,-0.19867444038391113,0.43248870968818665,0.20142078399658203},{-0.26091206073760986,-0.24460949003696442,-0.28796201944351196,-0.19163209199905396,0.33863818645477295,-0.21901442110538483,0.44790786504745483,-0.3486728370189667},{-0.05345489829778671,0.26095473766326904,0.12763993442058563,-0.5688592791557312,0.5299908518791199,-0.23720526695251465,-0.48060497641563416,-0.35921353101730347},{-0.26840418577194214,0.0971621423959732,0.05727437883615494,-0.4438951015472412,0.04599720612168312,-0.4845436215400696,0.43835535645484924,0.08347847312688828},{-0.31008949875831604,-0.14627492427825928,-0.12848035991191864,-0.35003748536109924,-0.36563146114349365,0.09373196214437485,0.5407561659812927,-0.30497580766677856}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.052486252039670944,-0.07783477008342743,-0.10477423667907715,0.03228430822491646,0.14939412474632263,0.021984994411468506,0.13495168089866638,0.04155919328331947};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.01616034097969532,0.009076937101781368,-0.019352896139025688,-0.08778055757284164,-0.06702447682619095,-0.05738602578639984,0.016062522307038307,-0.1597936600446701};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

