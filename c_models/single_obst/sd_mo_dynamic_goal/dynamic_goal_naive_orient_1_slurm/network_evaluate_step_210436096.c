#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2671135365962982,-0.09164617955684662,0.2762945890426636,0.16163915395736694,-0.31650426983833313,0.2626730799674988,-0.07273165881633759,-0.1533530056476593,0.14066454768180847,0.28860408067703247,0.11421389877796173,0.04832405969500542,0.25653839111328125,-0.25835224986076355,0.2592105269432068,-0.05677264928817749},{-0.16101154685020447,-0.3677825331687927,0.331952840089798,0.15037456154823303,-0.2820304334163666,0.14466018974781036,-0.40803608298301697,-0.014522317796945572,-0.09876013547182083,-0.19452062249183655,0.047112464904785156,-0.24398799240589142,0.0021484680473804474,-0.32421255111694336,-0.2584116756916046,0.09446538239717484},{-0.03750741481781006,-0.2464267611503601,-0.3566802740097046,0.1607288271188736,0.1834159791469574,0.47241249680519104,0.08573758602142334,-0.06682740896940231,-0.010378232225775719,-0.4344184100627899,-0.412932813167572,0.7135574817657471,-0.137448251247406,-0.2670038640499115,-0.3331146836280823,0.24234870076179504},{0.15170815587043762,0.23251084983348846,0.3969017267227173,-0.026030221953988075,-0.43124720454216003,-0.011492659337818623,0.29175105690956116,0.04584917426109314,0.28589776158332825,-0.39878562092781067,0.008020147681236267,0.42356690764427185,-0.25803086161613464,0.08421342819929123,0.45482805371284485,-0.4683229625225067},{-0.09597896784543991,-0.04705730453133583,0.31766870617866516,-0.045678794384002686,0.34402769804000854,0.44241780042648315,0.21938931941986084,-0.005888340529054403,0.15250727534294128,0.23155158758163452,0.3174164593219757,-0.3588140904903412,-0.2892003059387207,-0.40699151158332825,0.44030439853668213,0.06689512729644775},{-0.17882069945335388,-0.20817895233631134,-0.21075637638568878,-0.1175326257944107,0.16162420809268951,0.15431371331214905,0.055843621492385864,-0.14616939425468445,0.3568117022514343,-0.29717254638671875,-0.4054701626300812,0.22778929769992828,0.20627139508724213,-0.11548226326704025,-0.06862207502126694,0.06079929694533348},{0.06122327223420143,0.026104168966412544,0.06227736920118332,-0.457783579826355,0.21430358290672302,-0.013276797719299793,0.08095015585422516,0.39976561069488525,0.3327537775039673,0.08210950344800949,-0.43916770815849304,0.004408278502523899,-0.03469770774245262,0.1470654010772705,-0.15979743003845215,-0.2642492651939392},{-0.2815192639827728,0.2976844310760498,0.300470232963562,0.41715744137763977,-0.4599851667881012,-0.07403579354286194,0.44964465498924255,0.46302738785743713,-0.16716639697551727,0.3920113444328308,-0.618391752243042,-0.33857426047325134,0.35052523016929626,0.17682579159736633,0.2840752899646759,0.34185609221458435},{0.32897868752479553,-0.26938924193382263,0.6227865815162659,0.12681527435779572,0.03000371903181076,0.08933865278959274,0.19713765382766724,-0.5152981281280518,-0.1429276317358017,-0.474037766456604,-0.17096249759197235,-0.04780476167798042,-0.14077883958816528,0.6359705328941345,0.48392707109451294,-0.2839996814727783},{0.23928022384643555,-0.600476861000061,-0.56190425157547,-0.2253953069448471,-0.24218763411045074,0.25885009765625,0.21520374715328217,0.19658631086349487,0.576227068901062,0.23627489805221558,0.10358620434999466,-0.2990507185459137,-0.07580776512622833,0.37599503993988037,-0.14462634921073914,-0.48953285813331604},{0.20575596392154694,0.35399961471557617,0.44455617666244507,-0.6261158585548401,-0.35642656683921814,0.1334761679172516,0.17663834989070892,0.46390318870544434,-0.36361807584762573,0.05209950730204582,-0.13809232413768768,0.008130650967359543,-0.1766200065612793,-0.2000451534986496,0.2986435890197754,-0.37141624093055725},{-0.06905804574489594,-0.3826899230480194,0.1894274801015854,0.5258910655975342,0.7079524993896484,0.46452462673187256,0.37224316596984863,0.3724358081817627,0.0016994752222672105,0.028347592800855637,0.2283879667520523,-0.3884371817111969,-0.5511211156845093,-0.45449304580688477,0.6500417590141296,0.001749803894199431},{-0.2789761424064636,0.4307171106338501,-0.011683134362101555,-0.6041220426559448,0.13267669081687927,0.01847379095852375,0.1635865420103073,0.1583012193441391,0.08119912445545197,0.11408399790525436,0.008293521590530872,0.17133267223834991,0.4359593689441681,0.35149624943733215,-0.03187825158238411,-0.13588592410087585},{0.06411316990852356,-0.35904738306999207,-0.26262444257736206,-0.1578543484210968,-0.46544045209884644,0.02484731934964657,-0.2317693829536438,-0.2299545407295227,-0.1880146563053131,-0.0818803533911705,-0.42620983719825745,-0.003124060807749629,-0.2075914591550827,0.5033290982246399,0.21393819153308868,-0.01579202152788639},{0.05661804974079132,-0.32376566529273987,-0.26415157318115234,0.18348686397075653,-0.09137833118438721,-0.4140951633453369,0.26887431740760803,-0.06847690045833588,0.017148464918136597,0.32807502150535583,0.10555640608072281,0.0935119092464447,0.3151470720767975,-0.038695450872182846,-0.322655588388443,0.23539148271083832},{0.34293311834335327,0.005507063120603561,-0.22070233523845673,-0.21901924908161163,-0.34592151641845703,0.22149856388568878,0.3497294783592224,-0.10022971779108047,0.2019597440958023,0.38266050815582275,-0.15315496921539307,0.0783509686589241,-0.24295438826084137,0.2603038549423218,-0.10035929828882217,-0.022188572213053703},{-0.23345792293548584,-0.20586085319519043,0.2210250347852707,0.14835283160209656,-0.2196536362171173,0.10987700521945953,-0.22258232533931732,-0.14095893502235413,-0.2300015091896057,-0.26922255754470825,-0.0841890424489975,-0.27742359042167664,0.10937003046274185,-0.24242420494556427,0.023868372663855553,-0.20712566375732422},{-0.29356905817985535,0.21666036546230316,-0.36888590455055237,-0.22026167809963226,0.03393121063709259,0.3392782211303711,-0.2626599669456482,-0.2426687777042389,0.1918754279613495,0.18126334249973297,0.37097659707069397,-0.09246008843183517,-0.3726657032966614,0.3200347125530243,0.030789757147431374,-0.4374411702156067}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06146080419421196,-0.02404630184173584,-0.11300425976514816,-0.3413962423801422,0.33100172877311707,0.30172866582870483,0.09429541230201721,0.04553850367665291,-0.12302353978157043,-0.1361500769853592,-0.0428733229637146,0.07082593441009521,0.18579250574111938,0.37863293290138245,0.08293445408344269,0.07589293271303177},{-0.2070179134607315,-0.30215689539909363,-0.04904335364699364,0.08605784177780151,0.23268890380859375,-0.3257681727409363,0.07343239337205887,0.06308291852474213,-0.0822233334183693,0.24978649616241455,-0.24306954443454742,0.3032074272632599,-0.36269161105155945,0.19376562535762787,-0.41369709372520447,-0.33873122930526733},{0.09787878394126892,0.21612955629825592,-0.35142844915390015,-0.520982563495636,0.16183693706989288,0.4976606070995331,-0.10156648606061935,0.07089042663574219,-0.2655636966228485,-0.2957058250904083,-0.0022830693051218987,0.34156015515327454,-0.31975796818733215,-0.2210521548986435,0.11446195095777512,-0.0777382105588913},{0.1918150633573532,-0.04889175668358803,0.07900653034448624,0.18954689800739288,-0.5228567123413086,0.006678579840809107,0.08930745720863342,-0.17900405824184418,0.3066604733467102,0.38082215189933777,-0.1793023943901062,-0.12171578407287598,-0.4447939693927765,-0.446583092212677,0.1586335301399231,0.17679207026958466},{-0.145704984664917,0.12807096540927887,-0.017455819994211197,0.2524198293685913,-0.24759390950202942,0.06059782952070236,0.0013290907954797149,0.1398598998785019,0.2904183268547058,-0.304613322019577,0.19760183990001678,0.3118322193622589,0.1988181471824646,-0.4565007984638214,0.03077603690326214,-0.009818450547754765},{0.24930517375469208,0.2604365050792694,-0.0517813041806221,0.1941719949245453,-0.47221407294273376,-0.4142470061779022,0.2399093061685562,0.2738047242164612,0.13324181735515594,0.35080236196517944,0.2398674339056015,-0.2081942856311798,-0.023889869451522827,-0.156016007065773,-0.02884777821600437,0.29035624861717224},{-0.09942466765642166,0.27009424567222595,0.27373066544532776,-0.3761359751224518,-0.24882087111473083,0.025552866980433464,-0.34599119424819946,-0.07641715556383133,0.1679185926914215,0.07750672847032547,-0.15681153535842896,-0.20068924129009247,-0.33993375301361084,-0.018455812707543373,0.21836112439632416,0.03308534622192383},{-0.18326209485530853,-0.14850658178329468,-0.49841809272766113,0.2904660105705261,-0.3470618724822998,-0.2565855085849762,-0.25360894203186035,-0.4193599820137024,0.13797329366207123,-0.28204941749572754,0.02848542295396328,0.12152136862277985,-0.18620625138282776,0.4280739426612854,-0.07158136367797852,-0.3712356388568878},{-0.3223353922367096,0.27620458602905273,0.005232605151832104,-0.01482469029724598,0.2713686525821686,-0.2673313021659851,0.3338448703289032,0.15125955641269684,0.32502806186676025,0.3042900562286377,0.25816819071769714,0.3150418698787689,0.1839194893836975,-0.04102152958512306,0.27192744612693787,0.11490347236394882},{0.037734948098659515,-0.27275165915489197,-0.20717062056064606,-0.09189727902412415,0.27978238463401794,-0.18551431596279144,-0.29772859811782837,-0.1857529729604721,0.09819678217172623,-0.39728057384490967,-0.288470596075058,0.37207895517349243,0.12209431827068329,0.17122651636600494,-0.37838658690452576,0.23402708768844604},{-0.09321632981300354,-0.46187904477119446,0.335554301738739,0.31377390027046204,0.2252698689699173,0.1656232476234436,0.1989169865846634,-0.1470932513475418,0.27142399549484253,-0.30767810344696045,0.214407280087471,0.40902280807495117,0.5127720236778259,0.09468559175729752,-0.13689564168453217,0.10176105797290802},{0.07054518163204193,0.0079759880900383,0.39390474557876587,-0.022220365703105927,-0.25227758288383484,-0.17096656560897827,0.43993619084358215,0.2941385507583618,-0.27622225880622864,-0.19300195574760437,-0.10763227939605713,-0.33049216866493225,-0.04479598253965378,-0.2917945683002472,-0.39917194843292236,0.0447411984205246},{-0.09504452347755432,-0.3170899450778961,0.41210296750068665,-0.2147607058286667,0.3581601679325104,-0.30754056572914124,-0.4660309851169586,0.09152472019195557,0.07237851619720459,0.07791781425476074,-0.3378220498561859,0.12038019299507141,0.09597781300544739,-0.2890244722366333,-0.41514328122138977,-0.0015340963145717978},{0.3366388976573944,-0.33932438492774963,0.46123698353767395,0.07899226993322372,-0.06286121904850006,0.30858972668647766,-0.10398199409246445,-0.2370435744524002,-0.43784332275390625,0.11468825489282608,-0.0012607387034222484,-0.37273886799812317,-0.09254758805036545,0.15825523436069489,0.3053477108478546,0.041485745459795},{-0.10580001026391983,0.2343914806842804,0.11621934920549393,-0.41265761852264404,-0.22768834233283997,0.20247037708759308,0.29162484407424927,-0.24058641493320465,0.19809822738170624,-0.34094762802124023,0.04864715784788132,0.10925181955099106,-0.05661376193165779,0.1624169796705246,0.015101565048098564,0.10356006771326065},{-0.22988028824329376,0.3889581561088562,-0.4309713542461395,0.3706146776676178,0.14090462028980255,-0.43003952503204346,-0.03504098579287529,-0.07869602739810944,-0.3142527937889099,0.36713850498199463,-0.36290255188941956,0.30823561549186707,-0.07044786214828491,-0.2900165319442749,-0.27314937114715576,-0.51606285572052}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.18321634829044342,0.14411649107933044,-0.04910670593380928,-0.036108843982219696,-0.1289125382900238,0.05586705356836319,0.27930811047554016,0.09173779934644699,-0.22538110613822937,-0.16420288383960724,0.1624784618616104,-0.30848464369773865,-0.24965424835681915,0.22019216418266296,0.24687626957893372,0.32767006754875183,-0.2653707265853882,-0.2940005362033844,-0.20303429663181305,0.09328936040401459,-0.07854484766721725,-0.29194095730781555,-0.20761296153068542,-0.31528887152671814,-0.28917011618614197,0.19490909576416016,-0.183883935213089,0.0059784185141325,-0.01075214333832264,-0.037782423198223114,0.23559653759002686,-0.22421935200691223},{0.27555930614471436,0.17123885452747345,0.1624976098537445,-0.12548260390758514,0.1718587875366211,-0.10271111130714417,0.4096314609050751,0.12828269600868225,-0.16264601051807404,-0.09636536240577698,-0.1206691637635231,-0.30562624335289,-0.1526152640581131,0.2785222828388214,-0.25027167797088623,-0.21241331100463867,-0.009299831464886665,0.23307257890701294,-0.3865280747413635,-0.23531372845172882,-0.0597173348069191,0.266389399766922,0.03804820775985718,0.01759491115808487,0.21286393702030182,-0.3513467609882355,-0.05694061145186424,0.10184603184461594,0.17019791901111603,-0.13950201869010925,-0.027986550703644753,0.15856651961803436},{0.1296125054359436,0.01906784065067768,-0.18388484418392181,0.14208287000656128,-0.19473959505558014,-0.2009326070547104,-0.19215001165866852,0.04075565189123154,-0.14874820411205292,0.4271489083766937,-0.29975250363349915,-0.30945631861686707,0.09215107560157776,-0.4031507968902588,-0.17681926488876343,0.115410715341568,-0.15588805079460144,-0.15132567286491394,0.1454087346792221,-0.11896751821041107,0.25439882278442383,0.28369638323783875,-0.22912883758544922,0.023727528750896454,-0.28389501571655273,0.015329282730817795,0.13126713037490845,-0.115155890583992,-0.013306666165590286,-0.29059121012687683,-0.17835064232349396,-0.0712999776005745},{0.4551469683647156,0.051804862916469574,0.179978147149086,-0.14614032208919525,-0.2923415005207062,-0.057219795882701874,-0.19792307913303375,0.3201262354850769,0.25794368982315063,-0.3299931287765503,-0.07294531911611557,0.358315110206604,0.09726329147815704,-0.09409478306770325,-0.2210511565208435,0.288910448551178,-0.3051973283290863,0.2358647733926773,0.0825342908501625,0.14435981214046478,-0.05755822733044624,-0.1513182520866394,0.30466562509536743,0.16432715952396393,0.2148992419242859,-0.41903233528137207,0.2950664460659027,-0.22561237215995789,-0.07933936268091202,0.1570757031440735,-0.19661366939544678,0.17004729807376862},{-0.057870443910360336,-0.0956934317946434,-0.11350462585687637,0.16736647486686707,0.19481727480888367,-0.21630539000034332,-0.4479594826698303,-0.09490261226892471,-0.0791274830698967,-0.2560567855834961,0.0989392027258873,0.2630542516708374,-0.014223972335457802,-0.15666510164737701,-0.09601645916700363,0.11120922118425369,-0.08158622682094574,-0.10673338919878006,-0.31849950551986694,-0.18527530133724213,-0.08829549700021744,-0.4409020245075226,0.15292321145534515,0.16271208226680756,-0.12343692779541016,0.36790934205055237,-0.1930399239063263,0.13241206109523773,0.36828896403312683,0.3916706144809723,-0.10886936634778976,0.43168237805366516},{-0.3432464003562927,0.04635518789291382,-0.28498515486717224,-0.07230737060308456,-0.24055063724517822,0.2662199139595032,0.2279006540775299,0.033940140157938004,0.20434324443340302,0.2710401117801666,0.3640388548374176,-0.26649966835975647,-0.31086742877960205,0.17443086206912994,0.3638691306114197,-0.3174399435520172,-0.15400099754333496,-0.2644442915916443,0.20913687348365784,0.11044535040855408,0.084819495677948,0.2196653038263321,0.11747515201568604,-0.09756102412939072,-0.4045087993144989,0.4065527617931366,-0.11773016303777695,0.2339874655008316,0.3875565528869629,0.13539165258407593,0.055106572806835175,0.008425738662481308},{0.1938009113073349,-0.14831706881523132,-0.15260711312294006,-0.37055110931396484,-0.06679488718509674,0.20761416852474213,0.3565070629119873,0.19055743515491486,0.06241650506854057,0.41995319724082947,-0.015862105414271355,-0.05040019750595093,-0.44968658685684204,-0.16849350929260254,-0.16249701380729675,0.18452221155166626,-0.32654377818107605,-0.23258532583713531,0.18678268790245056,-0.056230004876852036,-0.13329027593135834,-0.13374114036560059,-0.20915843546390533,-0.1957421451807022,0.15547919273376465,-0.2569725513458252,-0.0917738676071167,-0.23953762650489807,0.293875128030777,0.05044418200850487,-0.19995413720607758,-0.32373178005218506},{0.005481180734932423,0.14761793613433838,0.03356824442744255,-0.0406697653234005,0.13191518187522888,-0.35486462712287903,-0.08287923783063889,-0.19615520536899567,-0.027048707008361816,-0.1874881088733673,-0.34019729495048523,-0.09815538674592972,-0.10967082530260086,0.007517163176089525,-0.1397952437400818,0.39245954155921936,-0.04910764470696449,-0.18396823108196259,0.06967134773731232,0.3336710035800934,-0.11311767995357513,-0.23888461291790009,0.2647046446800232,0.11092690378427505,-0.05174138769507408,-0.3133869767189026,-0.33326900005340576,-0.3302968442440033,-0.33849605917930603,-0.30998677015304565,0.006876903586089611,-0.3265092372894287},{0.1115034893155098,0.3963414430618286,-0.2722432017326355,-0.36586514115333557,-0.2579026222229004,0.13138744235038757,0.058903638273477554,0.12796081602573395,0.056892432272434235,-0.3110741674900055,-0.12769992649555206,0.3455372154712677,-0.28984543681144714,-0.18567606806755066,0.22396109998226166,-0.25852078199386597,0.27784475684165955,0.18316392600536346,0.40508776903152466,0.04310612007975578,0.16501836478710175,0.13044486939907074,0.30655330419540405,-0.12840524315834045,0.4105183184146881,-0.2740441560745239,0.1776452362537384,0.37561747431755066,-0.29815950989723206,0.2198828011751175,0.05158000811934471,0.12975092232227325},{-0.18595795333385468,0.09153483808040619,-0.27262577414512634,-0.15618622303009033,0.1903357058763504,-0.1971994936466217,0.11965802311897278,-0.02049054205417633,0.17214377224445343,-0.006335644517093897,-0.3128341734409332,-0.33002233505249023,-0.33730074763298035,-0.05925000086426735,-0.26723477244377136,0.11592217534780502,0.038864292204380035,-0.2210550606250763,0.21529607474803925,0.11681296676397324,0.024196675047278404,-0.03132542967796326,0.27975723147392273,-0.16983351111412048,0.3069814145565033,0.11138807237148285,-0.28352922201156616,-0.008389567956328392,-0.029871612787246704,0.0946662425994873,-0.1637132316827774,0.07185833156108856},{0.1216982752084732,0.09153352677822113,0.18045258522033691,-0.29052871465682983,-0.4136941730976105,-0.23125319182872772,-0.2929050028324127,0.06375245749950409,-0.3144491910934448,0.47376883029937744,0.21366672217845917,-0.20245440304279327,-0.4425681233406067,-0.12376347929239273,-0.13924658298492432,-0.08609910309314728,0.14889076352119446,-0.19761814177036285,0.3384738266468048,-0.12228882312774658,-0.1591978669166565,0.016544239595532417,0.2679394781589508,0.20509721338748932,0.1825629025697708,-0.18774636089801788,0.07288996130228043,-0.08549480140209198,-0.041585396975278854,0.022546209394931793,-0.02774367667734623,0.13518750667572021},{-0.1546274572610855,-0.08691965043544769,0.2310665249824524,0.2786064147949219,0.26369646191596985,-0.005310149863362312,0.053178999572992325,-0.19243434071540833,-0.05941265821456909,-0.2999532222747803,0.283147931098938,-0.19595572352409363,-0.18455320596694946,-0.20036183297634125,0.2672385573387146,-0.0063049388118088245,0.012330735102295876,0.041137248277664185,0.3983834981918335,0.07006142288446426,-0.19120869040489197,0.23589561879634857,0.11979398876428604,-0.07709875702857971,0.25694540143013,-0.1306353509426117,-0.14970310032367706,0.23253487050533295,0.1485007405281067,0.04290277883410454,-0.26058250665664673,-0.23253792524337769},{0.377346932888031,-0.23034009337425232,0.03213893622159958,-0.26451683044433594,-0.10112503170967102,-0.19018344581127167,0.014223022386431694,0.21730266511440277,0.18774676322937012,0.07376765459775925,0.2181473821401596,0.36701247096061707,-0.4328942596912384,-0.48541009426116943,0.023019853979349136,-0.23785701394081116,-0.3248812258243561,-0.39408883452415466,0.4209422469139099,-0.1726120263338089,0.42327696084976196,-0.18057881295681,0.09000840783119202,0.17126333713531494,0.1646248996257782,-0.17883101105690002,0.1912379413843155,-0.01628788933157921,0.13538958132266998,0.07426358014345169,-0.3078698515892029,0.07769796997308731},{0.278211385011673,-0.045840367674827576,0.009170213714241982,0.38154682517051697,-0.10020102560520172,-0.18941237032413483,-0.058104533702135086,0.16476266086101532,0.2094840556383133,0.2500649392604828,0.1217229813337326,-0.08759654313325882,0.07427655160427094,0.19219902157783508,-0.10739511996507645,0.10453985631465912,0.23026546835899353,-0.24947808682918549,0.12580420076847076,-0.3579098880290985,0.2857292592525482,0.1273227483034134,-0.10421310365200043,0.20476968586444855,0.25541386008262634,0.07635436952114105,0.15031586587429047,0.06409838050603867,0.09004634618759155,-0.12013977766036987,0.013008706271648407,0.3948049545288086},{0.043374545872211456,-0.1783410757780075,-0.03366616740822792,0.09024189412593842,-0.2887519299983978,0.04199467599391937,0.05848051607608795,-0.2013382762670517,-0.2133132964372635,-0.026226624846458435,0.22034448385238647,0.17997661232948303,0.05078974738717079,0.23991917073726654,-0.00871527660638094,-0.033163320273160934,-0.20730911195278168,0.28623780608177185,-0.06485109776258469,-0.22705671191215515,-0.231782466173172,-0.04807367920875549,0.1775718480348587,0.021016716957092285,-0.024862997233867645,-0.12083178758621216,-0.14988280832767487,0.2629077434539795,0.07793328911066055,-0.16419512033462524,0.29605573415756226,0.13269883394241333},{0.17595237493515015,-0.19676902890205383,0.0022146261762827635,-0.2050481140613556,-0.034960635006427765,0.16920427978038788,0.07269977778196335,0.288839727640152,-0.15007293224334717,-0.010887548327445984,0.2582278847694397,0.10938382148742676,0.043991073966026306,-0.1109485849738121,0.008248547092080116,0.21964922547340393,-0.360927015542984,-0.20555537939071655,-0.02178705669939518,0.06915801018476486,0.02765788324177265,0.27562782168388367,0.18838727474212646,0.16466566920280457,0.05552929267287254,0.17218539118766785,0.003955086227506399,-0.047184113413095474,0.11250418424606323,-0.12525635957717896,-0.24749328196048737,0.3062511086463928},{0.14185838401317596,0.02279837615787983,-0.3840066194534302,0.11368238180875778,0.06160975992679596,-0.0077283005230128765,0.3559873104095459,0.09410727024078369,0.09168960899114609,-0.12052563577890396,0.21395081281661987,-0.2774963974952698,-0.4554603695869446,0.27730515599250793,0.08520710468292236,0.0797664001584053,0.01457437127828598,-0.07866137474775314,-0.17214255034923553,0.04920054227113724,-0.06780517846345901,0.2567783296108246,0.08324361592531204,-0.17247143387794495,-0.08686380833387375,-0.20457521080970764,0.05720677599310875,0.3713226318359375,0.22836650907993317,-0.21417398750782013,0.20384520292282104,0.15411485731601715},{-0.0547482967376709,-0.007207850925624371,-0.07077772170305252,-0.09323946386575699,-0.2374504804611206,-0.02163945697247982,0.24143265187740326,0.1904611587524414,0.14815692603588104,-0.008145807310938835,0.19654305279254913,-0.007050929591059685,0.21921102702617645,0.21397380530834198,0.16777010262012482,-0.06711043417453766,0.1341610699892044,0.1962721347808838,0.22487173974514008,0.053698454052209854,0.15933780372142792,0.2908371686935425,0.07350102812051773,0.17057304084300995,-0.004358850419521332,-0.08862187713384628,-0.13155686855316162,-0.22116877138614655,0.12119979411363602,-0.26714617013931274,0.054843053221702576,-0.08145161718130112},{-0.36592093110084534,0.020007574930787086,-0.39047324657440186,-0.3414466977119446,0.03177345171570778,-0.016511263325810432,0.16223984956741333,-0.19245126843452454,0.0684906542301178,0.3917580246925354,0.00963433738797903,-0.2725156545639038,0.03770008683204651,-0.17789147794246674,-0.3326411545276642,0.029385913163423538,-0.20003528892993927,0.11762845516204834,-0.11742742359638214,-0.003773454111069441,-0.2923048138618469,0.16563209891319275,0.10677195340394974,0.06764527410268784,-0.09439706802368164,0.3584310710430145,0.040611185133457184,-0.21250617504119873,-0.19555245339870453,-0.028257504105567932,-0.23306269943714142,-0.28334084153175354},{-0.003166226204484701,-0.2610134780406952,-0.2819216251373291,-0.050537098199129105,-0.32088980078697205,-0.15374885499477386,0.17952704429626465,-0.2784380614757538,-0.22842203080654144,0.18471930921077728,0.18316452205181122,0.08541692793369293,0.1124006062746048,-0.14142581820487976,0.2775425910949707,-0.2596750557422638,0.0966193750500679,0.2679954767227173,0.04363204911351204,0.28828155994415283,0.019690534099936485,-0.11672450602054596,-0.2880747318267822,0.2310626059770584,-0.1141376867890358,-0.1561049073934555,0.11170411854982376,0.03521236404776573,-0.12219464033842087,-0.3330700695514679,-0.04186025634407997,-0.18856047093868256},{0.2119600474834442,0.08253896981477737,-0.09006708115339279,0.2226247936487198,-0.23619064688682556,0.06123947352170944,-0.07784930616617203,-0.24352404475212097,-0.06207682192325592,0.2559472918510437,-0.3820289373397827,-0.16457776725292206,0.05071902275085449,-0.18945813179016113,-0.41890108585357666,-0.19602830708026886,-0.13053138554096222,-0.3330169916152954,-0.3116525411605835,0.2495029866695404,0.17789767682552338,0.057619087398052216,-0.40014347434043884,0.3572854697704315,0.12708961963653564,0.3160156011581421,-0.3579314053058624,-0.15587854385375977,0.09914132207632065,-0.23669889569282532,0.06790940463542938,0.15356633067131042},{-0.056625258177518845,-0.29893267154693604,-0.04067142307758331,-0.31039848923683167,-0.052662141621112823,0.3023560047149658,0.20695894956588745,0.02869228832423687,-0.10991171002388,0.00808042660355568,-0.16855290532112122,0.09032244980335236,0.10269711911678314,0.07992524653673172,0.11645059287548065,0.039470452815294266,-0.05964551866054535,0.1632918119430542,-0.11978691071271896,0.15526673197746277,0.18278133869171143,0.2679939866065979,-0.04777814820408821,-0.24821609258651733,0.16224472224712372,0.16758744418621063,0.26693275570869446,0.17463870346546173,0.019850537180900574,0.10372236371040344,0.021370191127061844,-0.1078278049826622},{-0.003032709239050746,-0.2238018810749054,0.2706584334373474,0.0635627806186676,0.30363690853118896,-0.06000068783760071,-0.14923438429832458,-0.19884003698825836,0.1592511236667633,-0.049458470195531845,0.047842979431152344,0.024829953908920288,-0.24112634360790253,0.05617548152804375,-0.11949123442173004,-0.2942827045917511,-0.05355602130293846,-0.05908546969294548,0.17456938326358795,0.2099674791097641,0.051720257848501205,0.011105510406196117,0.14561854302883148,0.32461073994636536,-0.17184533178806305,-0.05184975266456604,0.14540238678455353,-0.112721748650074,-0.1583435833454132,-0.2389172911643982,0.27710676193237305,0.0275279451161623},{0.21299141645431519,-0.08700402826070786,0.06845049560070038,0.10485917329788208,-0.02797708846628666,0.059803254902362823,-0.24768169224262238,0.3242528736591339,-0.1109931543469429,-0.051517728716135025,0.12147970497608185,-0.2870425581932068,0.04153125733137131,-0.05680827051401138,-0.1132928654551506,0.34175905585289,-0.06301257014274597,-0.17355060577392578,0.05108204111456871,0.022621499374508858,-0.18727543950080872,0.1798325926065445,0.20876523852348328,0.2415027916431427,-0.24995552003383636,0.1020834669470787,-0.06577711552381516,0.0855194628238678,-0.29414600133895874,0.27339786291122437,-0.0421731136739254,0.039032213389873505}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.29563108086586,-0.14702121913433075,0.17811055481433868,-0.219419464468956},{0.21410803496837616,-0.270232230424881,0.27398738265037537,0.2508089244365692},{-0.39308103919029236,0.07798981666564941,0.22833161056041718,-0.03105703368782997},{0.28397998213768005,0.5544223785400391,0.3466790020465851,0.03085283190011978},{-0.3375921845436096,0.23493033647537231,-0.3185015022754669,0.1340498924255371},{-0.005971674341708422,-0.1568300426006317,0.06505099684000015,0.4724132716655731},{-0.10529012978076935,-0.2510972023010254,-0.49663084745407104,0.05279796943068504},{-0.14103570580482483,-0.4228910207748413,0.2373555302619934,-0.06188996508717537},{-0.15258334577083588,0.1973891258239746,-0.0742139220237732,-0.14436623454093933},{0.36053910851478577,-0.037624292075634,-0.19732849299907684,-0.27279216051101685},{0.2584581673145294,-0.27925777435302734,0.4128294289112091,0.3053921163082123},{-0.1137014627456665,0.017905158922076225,0.5685710906982422,-0.1252642422914505},{-0.3952403962612152,0.30698859691619873,-0.052884940057992935,-0.07537518441677094},{-0.21573734283447266,0.010795924812555313,-0.28427746891975403,0.13813689351081848},{0.2105874866247177,-0.08603082597255707,0.2800523042678833,0.16240550577640533},{-0.15507872402668,-0.31418895721435547,-0.14201880991458893,-0.10698238015174866},{-0.4003406763076782,0.08348213136196136,-0.05762200802564621,0.38768619298934937},{-0.36297351121902466,-0.15437574684619904,-0.2532735764980316,0.27255311608314514},{-0.08618121594190598,-0.21025003492832184,0.5207931399345398,0.05700083076953888},{-0.17312344908714294,-0.1895642727613449,-0.04331053048372269,-0.19457273185253143},{0.18220475316047668,0.16361714899539948,0.18359783291816711,-0.21887099742889404},{-0.026614025235176086,-0.36511048674583435,-0.21898820996284485,0.39335504174232483},{0.3197881281375885,-0.2197359949350357,0.26000553369522095,0.061615947633981705},{-0.35128599405288696,-0.03904718533158302,-0.26136502623558044,-0.3952067494392395},{-0.32220956683158875,-0.20826655626296997,0.0660066232085228,-0.13417913019657135},{0.288943886756897,0.2772373855113983,-0.14235550165176392,0.15235790610313416},{0.17682704329490662,-0.22421756386756897,0.3103755712509155,0.09942106902599335},{-0.05868427827954292,-0.193820059299469,0.030691972002387047,0.40179356932640076},{0.1561874896287918,0.05777260288596153,0.045430444180965424,0.019257064908742905},{-0.21007221937179565,0.11523740738630295,0.37172046303749084,0.01549571007490158},{-0.20850837230682373,-0.1481589525938034,0.059954214841127396,0.30317559838294983},{0.22365237772464752,0.25716328620910645,0.36670926213264465,-0.05531981587409973}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.001109536737203598,-0.011988416314125061,-0.00010941112850559875,0.049695540219545364,0.048103705048561096,-0.07034211605787277,-0.036633215844631195,0.07543090730905533,-0.08867849409580231,-0.02260594256222248,0.010533998720347881,-0.01920841448009014,-0.03363021835684776,0.06777018308639526,-0.013161242939531803,-0.04573526605963707};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0017040049424394965,-0.009467316791415215,-0.014361764304339886,0.011098365299403667,-0.04946428909897804,0.028698328882455826,-0.030909886583685875,-0.00958342757076025,0.036800678819417953,-0.04983639717102051,0.011904806829988956,-0.018410921096801758,-0.005853110458701849,-0.026805564761161804,0.009270116686820984,-0.025347871705889702};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01989283785223961,0.04274401813745499,-0.0034287043381482363,0.0003533214039634913,-0.014317817986011505,0.02355063520371914,-0.030978385359048843,-0.00020475038036238402,0.0014710985124111176,-0.03637528792023659,-0.003696335945278406,0.03987519443035126,0.026157602667808533,0.007907433435320854,0.03276076167821884,-0.037376102060079575,0.012035800144076347,-0.01096232421696186,0.02430691570043564,-0.023819245398044586,-0.015550498850643635,0.019879715517163277,-0.007929135113954544,-0.02826322428882122,-0.029866855591535568,-0.004993962123990059,0.023021729663014412,0.02893795818090439,-0.02819165587425232,0.03815723583102226,0.03694191575050354,-0.009228812530636787};
static const float action_parameterization_distribution_linear_bias[4] = {-0.013132493942975998,0.0075284517370164394,0.012194795534014702,0.022975418716669083};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3679547905921936,-0.34654662013053894,-0.1644027978181839,0.1873941272497177,-0.2598252296447754,0.0835568755865097,-0.3244016766548157,0.03142109140753746},{0.19967035949230194,0.14870786666870117,0.39589428901672363,0.36871573328971863,-0.15490692853927612,-0.37756696343421936,0.3223767578601837,0.4207734167575836},{0.07502460479736328,0.21236024796962738,0.12286988645792007,-0.04230068624019623,0.32594695687294006,0.19346508383750916,0.0026387434918433428,0.28311029076576233},{0.10677997767925262,-0.3167397379875183,0.34478864073753357,-0.16828514635562897,-0.234871044754982,0.08900175988674164,0.3244814872741699,0.2823179364204407},{-0.2747476100921631,-0.05378914251923561,-0.042561084032058716,-0.29007548093795776,0.1440696269273758,0.12616616487503052,0.353985071182251,0.29940181970596313},{-0.08535168319940567,0.2253837138414383,-0.00026907335268333554,-0.22299247980117798,0.3509953022003174,0.12865811586380005,0.1294437199831009,-0.1479296237230301},{-0.010845636948943138,0.2050800770521164,0.14604879915714264,-0.17120182514190674,0.4431805908679962,-0.1126541867852211,0.17645694315433502,0.1237855777144432},{0.06358036398887634,-0.3718242943286896,-0.05401351675391197,-0.2568058669567108,0.27162599563598633,0.007294388487935066,-0.15306410193443298,-0.3074626922607422},{-0.26706239581108093,0.21173526346683502,-0.04863123595714569,-0.1198447048664093,-0.05706360563635826,0.42631134390830994,0.37937232851982117,0.2757941484451294},{-0.01039068028330803,-0.1139693483710289,-0.29304349422454834,0.2539322078227997,0.25609269738197327,0.3180358409881592,0.3724934458732605,-0.32418686151504517},{-0.17115642130374908,-0.36045971512794495,0.3545934557914734,0.16670824587345123,-0.004985797684639692,-0.25821954011917114,0.08572059869766235,-0.3313441872596741},{0.22598797082901,0.055394817143678665,0.39557695388793945,0.3950934112071991,-0.13364137709140778,0.3303300738334656,0.28318166732788086,-0.33332473039627075},{-0.3994257152080536,0.15836897492408752,-0.36086317896842957,0.42719581723213196,-0.04122946411371231,0.42465394735336304,0.08805464208126068,0.2698690891265869},{-0.061169251799583435,0.21113932132720947,-0.1399344950914383,-0.11452679336071014,-0.001427801325917244,0.12120813131332397,0.3633665442466736,0.027205759659409523},{0.1224362850189209,-0.29665878415107727,-0.3470313847064972,-0.162484273314476,0.12590467929840088,-0.19533966481685638,0.1689053177833557,-0.06351321190595627},{-0.4572465121746063,-0.30121344327926636,-0.24411560595035553,0.019037649035453796,-0.021428702399134636,0.19111868739128113,0.2654360234737396,-0.036663856357336044},{-0.15689586102962494,-0.26748618483543396,0.254778653383255,-0.33598682284355164,0.01783217303454876,-0.0020681556779891253,-0.3869986832141876,-0.22044877707958221},{0.06286489218473434,0.2376331090927124,0.1678209751844406,0.200731560587883,-0.09635382890701294,0.32436880469322205,0.3159739375114441,-0.1611427217721939},{0.058293070644140244,-0.3240225613117218,-0.05802305042743683,-0.06901516765356064,-0.1458674818277359,-0.34643808007240295,0.07209135591983795,-0.2770571708679199},{-0.03826842084527016,0.017687605693936348,0.13272742927074432,-0.3161807954311371,0.0430523082613945,0.1132599413394928,0.10931909829378128,-0.10397946834564209},{0.08432106673717499,-0.09209166467189789,0.09017722308635712,-0.2706335186958313,-0.007180970162153244,0.0003194349119439721,0.01507584284991026,-0.2301759570837021},{-0.328473299741745,0.20429416000843048,0.16874286532402039,-0.24645982682704926,-0.4740636944770813,0.017726533114910126,0.18741938471794128,0.019996242597699165},{0.27400919795036316,0.12721359729766846,-0.37634530663490295,0.12545520067214966,-0.053513020277023315,0.2402288317680359,0.29148420691490173,0.31456851959228516},{-0.016084928065538406,-0.11579061299562454,0.03381161764264107,0.3210979700088501,-0.29755833745002747,-0.04225188121199608,-0.0992514044046402,-0.29932504892349243},{0.20756328105926514,0.10005722939968109,-0.40512537956237793,0.3518105745315552,-0.28454867005348206,-0.33376091718673706,-0.2947273254394531,0.20349374413490295},{0.04028554633259773,0.3810824453830719,-0.2761884331703186,-0.050960417836904526,0.08412907272577286,-0.24291948974132538,0.3710172474384308,-0.265927255153656},{-0.07915742695331573,0.0849149152636528,-0.15240523219108582,-0.15734735131263733,0.020800944417715073,-0.1801299899816513,-0.05779341980814934,-0.12483944743871689},{0.13830561935901642,-0.17265528440475464,-0.04298119619488716,-0.10058990865945816,0.0037969539407640696,0.013790079392492771,-0.16130578517913818,0.109257772564888},{0.35753077268600464,0.049518369138240814,-0.3840538263320923,-0.18899589776992798,-0.24999001622200012,0.10905560106039047,0.26801440119743347,0.10372515022754669},{0.40165579319000244,-0.3072930574417114,-0.01434863917529583,-0.03230159729719162,0.12246165424585342,-0.12579308450222015,0.24072490632534027,0.37115439772605896},{-0.26578348875045776,-0.17807145416736603,0.0430736169219017,-0.26520830392837524,0.32418349385261536,-0.2413349449634552,0.09072337299585342,0.08751647919416428},{0.13565300405025482,-0.00712148891761899,-0.15413585305213928,0.29982781410217285,0.059377532452344894,0.04279375448822975,-0.0025065504014492035,-0.007275148760527372}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24491910636425018,0.4099997580051422,-0.6322962641716003,-0.5559112429618835,-0.2997174561023712,0.03885889798402786,-0.44474130868911743,0.5522995591163635},{-0.0307345949113369,0.5335222482681274,-0.2125314623117447,0.5494332909584045,-0.004247295670211315,0.058603692799806595,-0.23030172288417816,0.03790741786360741},{-0.46061742305755615,-0.20795421302318573,-0.16166268289089203,-0.21024590730667114,0.5405662059783936,0.20803898572921753,0.037204790860414505,0.4493888020515442},{-0.4837026596069336,-0.494671106338501,0.3601139783859253,0.33820071816444397,-0.5245659947395325,-0.20670145750045776,0.5303244590759277,0.22585564851760864},{-0.34043288230895996,-0.3394748270511627,-0.3260270953178406,-0.2923898994922638,0.37084001302719116,-0.3095274865627289,0.5436532497406006,-0.49892160296440125},{-0.0601714588701725,0.18837061524391174,0.32896751165390015,-0.5815461874008179,0.5279519557952881,-0.3234783113002777,-0.4490022361278534,-0.3374662399291992},{-0.4256409704685211,0.18119902908802032,0.07559353113174438,-0.38789498805999756,-0.037903472781181335,-0.5573474168777466,0.49435824155807495,0.03891971707344055},{-0.4092647433280945,-0.30580148100852966,-0.25360819697380066,-0.41665056347846985,-0.3423745632171631,0.14367960393428802,0.559257447719574,-0.3237428665161133}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03831038251519203,-0.01713811792433262,-0.0030128222424536943,0.01910298690199852,-0.03663751482963562,-0.008997620083391666,-0.03737901151180267,0.0400562658905983};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0017068653833121061,-0.02411382459104061,-0.009960860945284367,0.03541983664035797,-0.03962886705994606,0.019936848431825638,-0.04647618532180786,0.014184566214680672};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

