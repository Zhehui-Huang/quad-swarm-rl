#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2771594226360321,0.026776695623993874,-0.14378465712070465,0.30218908190727234,0.2651255130767822,-0.21551410853862762,-0.22532919049263,0.09803258627653122,0.2745612859725952,-0.31357479095458984,0.5761032104492188,-0.03625239059329033,0.2848379909992218,0.12066393345594406,-0.431159108877182,0.06311095505952835},{-0.2516077756881714,-0.28001731634140015,-0.3024379312992096,-0.18189722299575806,0.08530537784099579,0.2587853670120239,0.060728080570697784,0.06327683478593826,0.22513537108898163,0.1768007129430771,-0.16653764247894287,-0.08856651932001114,-0.17843939363956451,0.07975873351097107,0.320216566324234,-0.2900490462779999},{0.1427043229341507,0.19460465013980865,0.19997940957546234,0.34991613030433655,-0.10427314043045044,-0.2387075573205948,0.46542686223983765,-0.04849373176693916,-0.018892938271164894,-0.10364784300327301,-0.050610605627298355,-0.007833692245185375,0.06564673036336899,0.4532392621040344,-0.2706634998321533,-0.06549238413572311},{0.12231218814849854,-0.1650342494249344,-0.14092664420604706,-0.12699741125106812,0.05191832035779953,0.090519018471241,0.07106898725032806,-0.2042488008737564,-0.17264866828918457,0.176726296544075,0.5273862481117249,-0.21478421986103058,-0.1689436137676239,-0.14555177092552185,0.18490082025527954,0.12642598152160645},{-0.32046040892601013,0.05137232318520546,0.14329849183559418,-0.21013116836547852,0.26262181997299194,0.28034675121307373,0.1429932564496994,-0.20521843433380127,-0.1354227513074875,0.15808111429214478,-0.14488059282302856,-0.38263237476348877,-0.028737250715494156,-0.16114667057991028,0.32015174627304077,-0.029712950810790062},{0.0034691006876528263,-0.026637349277734756,-0.010725564323365688,-0.023058589547872543,0.0862424373626709,-0.12380607426166534,0.41358307003974915,-0.3407720923423767,-0.13715161383152008,-0.18253037333488464,0.28979000449180603,0.023031987249851227,0.21427424252033234,0.0829034298658371,0.2794182002544403,0.28767484426498413},{-0.18926149606704712,0.1774003952741623,-0.03607878088951111,0.06939337402582169,-0.21888841688632965,-0.08747530728578568,-0.16169245541095734,-0.022784758359193802,0.1472456008195877,0.35792866349220276,-0.23060554265975952,-0.08042124658823013,0.23568910360336304,0.07657784223556519,-0.17616596817970276,0.3139164447784424},{-0.11460372805595398,0.018995506688952446,-0.15174734592437744,-0.18627506494522095,0.3809605836868286,-0.29351016879081726,-0.294887900352478,-0.403531014919281,-0.05000491067767143,-0.2037370502948761,0.3966602683067322,-0.049925655126571655,0.19282254576683044,0.1432095319032669,-0.1890677958726883,0.4039423167705536},{0.24267829954624176,0.07836788147687912,-0.008699338883161545,0.08740566670894623,-0.4134797155857086,-0.4375283122062683,0.3510718047618866,-0.2834981083869934,-0.11858189851045609,0.2262393683195114,0.18674224615097046,-0.28470268845558167,-0.1440717726945877,0.0244505126029253,0.15486863255500793,-0.03490884229540825},{0.44368594884872437,-0.5501298904418945,-0.0837845578789711,-0.011336229741573334,0.2181185632944107,-0.12486828118562698,-0.22996361553668976,-0.13871680200099945,-0.19041834771633148,0.0024498733691871166,-0.02377130836248398,-0.20695453882217407,0.36044856905937195,-0.07878084480762482,-0.5332507491111755,-0.16722078621387482},{0.2607170343399048,0.18202410638332367,-0.3274742364883423,0.07564625144004822,0.004067899659276009,-0.17716440558433533,-0.12385707348585129,0.1550624817609787,-0.14860601723194122,0.15351234376430511,0.18195800483226776,0.22556650638580322,-0.0900016501545906,0.23961643874645233,-0.04836081713438034,-0.24746957421302795},{-0.42132312059402466,0.28391796350479126,0.23004263639450073,-0.2905791699886322,-0.2723047733306885,0.319221168756485,0.05759379640221596,0.3329195976257324,0.21818532049655914,0.13147468864917755,0.23491278290748596,-0.1242997869849205,0.16317851841449738,-0.07235715538263321,-0.08236999064683914,-0.17790493369102478},{0.09855107218027115,-0.24021509289741516,-0.21372640132904053,0.18529093265533447,-0.22059451043605804,-0.2543845474720001,-0.14893974363803864,0.23371772468090057,0.3000641167163849,-0.15662014484405518,-0.09578553587198257,0.04458747059106827,0.27960795164108276,0.13187631964683533,-0.15611514449119568,0.2943262755870819},{0.25812605023384094,0.19527266919612885,-0.14953157305717468,-0.10766522586345673,0.07504457980394363,-0.0894516259431839,-0.12745772302150726,0.3143821656703949,-0.20002233982086182,-0.17103368043899536,-0.1584881693124771,0.02852359600365162,-0.22042782604694366,-0.12265805155038834,-0.21025286614894867,-0.01849517412483692},{0.18414388597011566,0.3799291253089905,0.4060571789741516,-0.376392662525177,-0.36784812808036804,0.08756735175848007,0.03579049929976463,-0.16333040595054626,0.37392014265060425,0.3741399645805359,-0.1664341539144516,0.10842044651508331,-0.08162813633680344,-0.3087828457355499,0.05962211638689041,-0.11966108530759811},{-0.17633189260959625,-0.18606199324131012,-0.12217478454113007,0.4385001063346863,-0.24430085718631744,-0.2256561815738678,-0.20394907891750336,-0.30503547191619873,-0.5478655099868774,-0.25640401244163513,0.3364343047142029,0.27466294169425964,-0.6022095084190369,-0.35721877217292786,-0.6300506591796875,-0.1611488312482834},{-0.4927569627761841,0.1810365915298462,-0.34792980551719666,-0.15788346529006958,-0.4559843838214874,0.17458376288414001,0.46813082695007324,0.06220603734254837,0.439317911863327,-0.4975111186504364,0.21808850765228271,-0.36210137605667114,-0.19421757757663727,0.03659811243414879,-0.17895227670669556,-0.23201970756053925},{0.342140793800354,-0.567188560962677,0.2992018163204193,0.242984801530838,-0.11301217973232269,0.48275306820869446,0.2670421898365021,0.2847656011581421,-0.05569520592689514,-0.2472383975982666,-0.11069188266992569,-0.18586820363998413,-0.09822902828454971,-0.5388637781143188,0.23021841049194336,-0.10666186362504959}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.046007320284843445,0.3117082417011261,0.2273043543100357,-0.1448604166507721,-0.1796121746301651,0.04161350056529045,-0.016083640977740288,0.24889488518238068,-0.08510331064462662,0.30328649282455444,0.47626322507858276,-0.3801206648349762,0.030735302716493607,0.05330716446042061,0.010621590539813042,-0.108662910759449},{-0.4079352915287018,0.19362734258174896,-0.1912403702735901,0.32319965958595276,0.2822365164756775,-0.15401624143123627,-0.3268645107746124,-0.15362827479839325,0.37348467111587524,0.2619488835334778,-0.051608264446258545,0.23550373315811157,-0.4141770601272583,0.1754646897315979,-0.21458759903907776,0.4518466889858246},{-0.2688705325126648,0.10062368214130402,-0.315595418214798,0.1785428822040558,-0.4738495647907257,-0.23505890369415283,0.040769606828689575,0.14800098538398743,-0.20648717880249023,0.37513816356658936,0.22876080870628357,-0.14066436886787415,0.1456882655620575,-0.2643684446811676,-0.12116621434688568,-0.043706513941287994},{0.29978707432746887,-0.21847110986709595,0.10364749282598495,0.39928895235061646,-0.4139358401298523,-0.3107386827468872,0.2860381007194519,0.03319186344742775,0.2886245548725128,-0.09938924759626389,0.3375835120677948,0.08678679913282394,-0.1997065395116806,0.03185034543275833,-0.0021911493968218565,-0.425028920173645},{-0.4107028841972351,-0.07271048426628113,0.1633206009864807,-0.266488254070282,0.15485021471977234,0.3665487468242645,-0.28690198063850403,0.2845832407474518,-0.2329993098974228,0.2042825073003769,-0.0012781162513419986,0.02820480987429619,-0.2616893947124481,-0.018988680094480515,-0.2824960947036743,-0.12954267859458923},{0.05253630131483078,-0.3137750029563904,-0.004607995040714741,-0.35329586267471313,0.21046429872512817,0.048797182738780975,-0.1444455087184906,-0.06428391486406326,-0.15117725729942322,0.38926708698272705,0.19182604551315308,0.011133811436593533,-0.29184776544570923,0.08246913552284241,0.009825300425291061,-0.2882187068462372},{0.28571030497550964,-0.19255474209785461,0.3429190218448639,-0.21837176382541656,-0.425952285528183,0.004621666856110096,-0.3511056900024414,0.33670294284820557,-0.10024313628673553,-0.247501939535141,-0.2650570273399353,-0.015167362987995148,-0.0680321678519249,-0.08657462149858475,0.4979095160961151,-0.38231560587882996},{-0.3423381447792053,0.3521496057510376,-0.0976458191871643,0.17236052453517914,-0.06603511422872543,-0.22211958467960358,-0.24591957032680511,0.06568831205368042,-0.009206858463585377,0.5038539171218872,0.12261053174734116,-0.11184532195329666,0.06343129277229309,-0.24230444431304932,0.09946861118078232,0.1584000438451767},{0.11436278373003006,0.2879434823989868,-0.1835022270679474,-0.33069080114364624,0.34063777327537537,-0.1903112828731537,0.168808713555336,-0.3027961552143097,0.07000335305929184,0.04582671448588371,0.09476197510957718,0.11171727627515793,0.03604202717542648,-0.3902518153190613,-0.06323136389255524,0.20525623857975006},{-0.19911323487758636,0.03910413756966591,-0.280816912651062,-0.3440571427345276,0.22355373203754425,-0.38719049096107483,-0.11705289036035538,0.3007988929748535,-0.17531216144561768,0.14766991138458252,-0.04278801381587982,-0.12102265655994415,-0.37879443168640137,0.11040975153446198,-0.23576417565345764,-0.32374632358551025},{-0.16015087068080902,-0.16657671332359314,0.007669901009649038,-0.25063541531562805,-0.3179342448711395,-0.01111325528472662,0.13978885114192963,-0.3725763261318207,0.06141931191086769,-0.08730696886777878,0.27651286125183105,-0.05280280113220215,0.26895299553871155,0.15943293273448944,0.22672878205776215,0.264594167470932},{-0.1040288582444191,-0.025821266695857048,-0.3849203288555145,0.3177209496498108,0.09777532517910004,0.1604970395565033,0.20785251259803772,0.1825903356075287,-0.43101775646209717,0.19600607454776764,-0.3299194872379303,-0.22553780674934387,-0.35087528824806213,0.35901838541030884,-0.3368787467479706,0.09286433458328247},{-0.21451358497142792,-0.47338587045669556,-0.1134544387459755,0.1513056755065918,-0.2175888866186142,-0.04286254942417145,-0.11237923800945282,0.3845846951007843,0.4610970914363861,0.14218728244304657,-0.010448938235640526,-0.1745891273021698,0.1523919254541397,-0.41348057985305786,0.09173695743083954,-0.1795579046010971},{-0.2425316572189331,-0.45784541964530945,-0.14274616539478302,-0.13856914639472961,-0.4868088960647583,0.5137706398963928,-0.15563547611236572,0.195707306265831,-0.1304481327533722,-0.2430156171321869,-0.3149723410606384,0.4137101173400879,-0.1672801971435547,-0.0441260002553463,-0.2222919762134552,0.33922117948532104},{-0.33014675974845886,0.3612513840198517,-0.22706931829452515,0.12398867309093475,-0.36909547448158264,0.17740875482559204,-0.026912406086921692,-0.32193586230278015,0.11139646172523499,0.21796785295009613,-0.2752421796321869,0.07083481550216675,0.2348833680152893,-0.3252624273300171,-0.3428974747657776,-0.15567424893379211},{-0.1343759447336197,-0.2732960283756256,-0.4347444474697113,0.216715008020401,0.14881376922130585,0.03645705059170723,-0.23842567205429077,0.17127586901187897,-0.34021469950675964,-0.2536035180091858,-0.31499937176704407,0.21329982578754425,-0.17556491494178772,0.1330396980047226,0.046651821583509445,0.2944779098033905}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.09770937263965607,-0.05745832622051239,0.17626896500587463,-0.14959944784641266,-0.08649585396051407,0.10710303485393524,0.21604536473751068,-0.2017032951116562,-0.21076413989067078,0.28717830777168274,0.12653738260269165,0.11460870504379272,0.09188679605722427,0.1708945482969284,-0.15042085945606232,0.15693780779838562,0.12557245790958405,-0.33105412125587463,-0.17381106317043304,-0.0551128126680851,-0.14256049692630768,0.09724580496549606,-0.19126921892166138,0.2694135904312134,-0.105782650411129,-0.05923358350992203,0.1107187420129776,0.20104746520519257,-0.2274395227432251,-0.1340700387954712,0.18078219890594482,0.27418196201324463},{0.22725588083267212,-0.057697854936122894,0.14048385620117188,-0.10487541556358337,-0.13606016337871552,0.25521326065063477,-0.014228904619812965,-0.07534947246313095,-0.04540470615029335,0.009041781537234783,-0.13913019001483917,0.012405782006680965,0.39741551876068115,0.17703811824321747,0.1304609328508377,0.07350513339042664,-0.24495230615139008,-0.35882067680358887,0.08735482394695282,0.05190972983837128,0.05501997098326683,0.30196061730384827,0.21980397403240204,-0.22907473146915436,0.051565032452344894,0.2640051245689392,-0.29673582315444946,0.18332672119140625,0.10614608973264694,-0.23771797120571136,-0.04300592839717865,-0.008200190030038357},{-0.10095871984958649,-0.053746968507766724,0.26521065831184387,-0.24146553874015808,-0.1827324479818344,0.040733933448791504,-0.13149556517601013,0.250618040561676,0.12121168524026871,-0.0028942169155925512,-0.1632886379957199,-0.011129824444651604,0.2377740740776062,-0.22286105155944824,0.088568314909935,-0.0402541346848011,-0.3098078668117523,0.2679535150527954,-0.2553636133670807,-0.041739948093891144,0.01422172226011753,-0.14359857141971588,-0.05806376039981842,-0.11502468585968018,-0.020755266770720482,0.30027732253074646,-0.05654360353946686,0.09325563162565231,0.26394155621528625,-0.25711238384246826,-0.19775158166885376,-0.024145537987351418},{0.14188465476036072,-0.14315660297870636,0.06828747689723969,-0.35078439116477966,0.1270575374364853,-0.13980871438980103,-0.06464491039514542,0.2765876054763794,0.01743517816066742,0.1486116349697113,0.1454152911901474,-0.10447032004594803,-0.20742267370224,-0.08882393687963486,0.29605770111083984,-0.23425056040287018,0.039546724408864975,-0.12398715317249298,-0.12544754147529602,0.08866055309772491,-0.10510671883821487,0.05250483751296997,-0.20725896954536438,0.24358142912387848,-0.26987749338150024,0.0913572609424591,-0.07858286798000336,-0.1942492425441742,0.05993577465415001,0.016547612845897675,0.23916710913181305,-0.11621372401714325},{0.22867223620414734,0.016948029398918152,0.04071800038218498,0.2636150121688843,-0.24077816307544708,-0.07423913478851318,0.20156559348106384,-0.04381309822201729,0.11079757660627365,-0.18979838490486145,-0.006349871400743723,-0.07994727790355682,-0.13820882141590118,-0.16506199538707733,0.28164976835250854,0.3180824816226959,-0.08180228620767593,-0.34907594323158264,0.17343002557754517,-0.12390386313199997,-0.12495560199022293,0.2102278769016266,0.2796357572078705,0.04082868993282318,-0.06458891183137894,-0.10058729350566864,-0.024416955187916756,0.27111583948135376,0.26810890436172485,0.1279001235961914,0.09078580886125565,-0.256465882062912},{0.3182970881462097,-0.1528964787721634,0.03280436992645264,0.08743033558130264,-0.14375798404216766,-0.31751933693885803,-0.20055319368839264,-0.2986455261707306,-0.2195224165916443,0.018687373027205467,-0.03774228319525719,-0.023681515827775,-0.16301023960113525,-0.05051236227154732,-0.21709059178829193,-0.2312031239271164,0.17991456389427185,0.0024872126523405313,-0.30001476407051086,0.1646999716758728,-0.04708611220121384,-0.22636623680591583,0.17848064005374908,-0.17150560021400452,-0.14374133944511414,-0.23774951696395874,-0.09633976966142654,0.14347192645072937,0.11102799326181412,0.2686315178871155,-0.24332693219184875,0.18154126405715942},{0.1684030145406723,0.0732133612036705,0.2601434588432312,-0.18385612964630127,0.22508107125759125,-0.2005612701177597,-0.2507913410663605,0.04751458019018173,0.27757737040519714,0.13478073477745056,-0.11278935521841049,0.09085559099912643,0.06863424926996231,0.36509186029434204,0.12368631362915039,-0.11678248643875122,-0.19525808095932007,0.1508452147245407,0.009985094889998436,0.03299116715788841,-0.07248079031705856,0.2278478592634201,0.165458545088768,0.17383043467998505,-0.22239184379577637,-0.25970420241355896,-0.25828662514686584,-0.3817180395126343,0.01183121744543314,-0.09530606865882874,0.22522573173046112,0.15190094709396362},{0.2935198247432709,-0.30994880199432373,0.12490382045507431,-0.375858336687088,-0.3284399211406708,0.274879515171051,0.36990582942962646,0.13652829825878143,-0.10086074471473694,0.01691155880689621,0.2207304984331131,-0.13175417482852936,0.14191503822803497,0.32701998949050903,-0.020973222330212593,0.19753432273864746,0.3730194866657257,-0.19044126570224762,-0.046861860901117325,-0.3089895248413086,0.1487576812505722,0.21692635118961334,0.2442738562822342,0.12255364656448364,0.10455355793237686,0.11715132743120193,0.12293853610754013,0.272475004196167,-0.20524713397026062,-0.23652276396751404,0.2513377070426941,-0.03827810660004616},{-0.0006087906658649445,-0.06861034780740738,0.2576889991760254,0.22694183886051178,-0.18122991919517517,-0.32388466596603394,-0.05946514010429382,0.263572096824646,-0.1918773651123047,-0.2850470542907715,0.09917403012514114,0.10975394397974014,0.11106795817613602,-0.27637824416160583,0.11962590366601944,-0.1779206097126007,-0.16085462272167206,0.17327377200126648,-0.22640873491764069,0.32766425609588623,-0.2804569602012634,-0.3472296893596649,-0.28739845752716064,0.2847675681114197,0.11760497093200684,0.11923423409461975,0.25333553552627563,0.17398838698863983,-0.15728768706321716,-0.279615581035614,-0.17064888775348663,0.15256831049919128},{0.30436983704566956,-0.014974887482821941,-0.03227897360920906,0.16499915719032288,0.03102305345237255,0.24798448383808136,-0.00920948013663292,0.28855738043785095,-0.024981601163744926,0.07658270746469498,0.17489276826381683,0.052320461720228195,-0.1868913322687149,-0.38450872898101807,0.10826131701469421,0.14540360867977142,0.10413871705532074,-0.13900615274906158,-0.0539691336452961,-0.07903753966093063,0.1385689526796341,-0.3199012279510498,0.2631979286670685,0.054655883461236954,-0.040467262268066406,0.12376122176647186,-0.2949516773223877,-0.214533269405365,-0.006882704794406891,0.008194563910365105,0.13869306445121765,0.2269560545682907},{-0.13051314651966095,0.0967150330543518,-0.12137383967638016,0.1580921709537506,-0.12837974727153778,0.2661221921443939,0.12120665609836578,-0.01489792950451374,0.2970793843269348,-0.30637621879577637,-0.1377490758895874,0.16062848269939423,-0.18044167757034302,0.05058833956718445,-0.31247177720069885,-0.041960708796978,0.10843507200479507,0.1613314151763916,0.06441260129213333,-0.15422818064689636,-0.21363134682178497,0.19253239035606384,0.1813402622938156,0.17815788090229034,-0.26234230399131775,0.3672311305999756,-0.0833503007888794,-0.029321717098355293,-0.1242794618010521,0.1275303065776825,0.21694353222846985,0.2849274277687073},{-0.2042301595211029,0.3041370213031769,-0.05874071270227432,0.007537947967648506,-0.19675911962985992,-0.18561452627182007,0.13518026471138,-0.32684245705604553,-0.04355604946613312,-0.2727541923522949,-0.20708976686000824,-0.03503575921058655,0.1916949599981308,-0.2551427483558655,-0.1297132521867752,-0.2838810086250305,-0.18790802359580994,-0.05311359092593193,0.30339741706848145,-0.2737789452075958,0.08931539952754974,-0.19429735839366913,0.05787818133831024,0.2994749844074249,-0.1522388905286789,0.18255776166915894,0.22443199157714844,-0.0858943834900856,-0.014577233232557774,0.29768338799476624,-0.14785411953926086,-0.27958834171295166},{-0.04458589479327202,0.20043785870075226,0.21720172464847565,-0.27074024081230164,0.26596975326538086,0.0032996470108628273,-0.1375579982995987,-0.02587072364985943,0.1426277756690979,-0.2914898991584778,-0.06923914700746536,0.02852610871195793,0.16037730872631073,0.037867072969675064,0.055033475160598755,-0.08498270064592361,0.2185116410255432,-0.25619593262672424,0.34188467264175415,0.08570540696382523,-0.17266398668289185,0.22590559720993042,-0.12824897468090057,-0.20573411881923676,0.2517538368701935,-0.1155066266655922,0.027196846902370453,-0.1550751030445099,0.05022004619240761,-0.13715305924415588,0.2669409513473511,0.23133456707000732},{0.05166023597121239,-0.1875350922346115,-0.190479576587677,0.05909263715147972,-0.013401025906205177,0.28550130128860474,-0.11275480687618256,-0.29670047760009766,0.3148011267185211,0.02773355133831501,0.047940224409103394,0.07320006936788559,-0.13052690029144287,0.15100476145744324,-0.22437165677547455,-0.3158630132675171,0.013935036025941372,-0.014223912730813026,0.17178559303283691,0.41107720136642456,-0.2295117825269699,0.13018271327018738,-0.14494894444942474,0.04277867451310158,0.15559996664524078,-0.3189506530761719,-0.149306520819664,-0.271075576543808,-0.12493927031755447,-0.19342152774333954,0.16048629581928253,-0.3564980626106262},{-0.11090020835399628,0.33540433645248413,0.1170072853565216,-0.19437573850154877,-0.11975403130054474,-0.23070433735847473,0.15340113639831543,-0.06636955589056015,0.23144057393074036,-0.05374177172780037,0.21534089744091034,0.19310006499290466,-0.029857132583856583,0.05799531564116478,-0.12519025802612305,0.16425707936286926,-0.1912379115819931,-0.37554892897605896,-0.2517089247703552,0.11576221883296967,0.14763294160366058,-0.2274535596370697,-0.3330477774143219,-0.2620004713535309,-0.1568763703107834,0.10423808544874191,0.35586026310920715,-0.006499258801341057,-0.08088992536067963,0.08493781834840775,-0.13320305943489075,0.09615256637334824},{-0.2269897758960724,-0.1757623553276062,-0.19619430601596832,0.025341004133224487,-0.23298843204975128,-0.12437344342470169,-0.04880847409367561,-0.03837534040212631,-0.299187570810318,-0.25324517488479614,0.20354674756526947,0.15104863047599792,-0.3054605722427368,0.24846628308296204,-0.06586761027574539,0.1602068692445755,0.09718956798315048,0.025749964639544487,0.04458947107195854,0.13374534249305725,0.23860478401184082,0.23994722962379456,0.13152757287025452,0.26037320494651794,0.10279540717601776,-0.2145158052444458,-0.17225977778434753,0.24216361343860626,-0.026985744014382362,-0.18499529361724854,-0.17258508503437042,-0.14459148049354553},{-0.2829779386520386,-0.21808196604251862,-0.3449118435382843,0.05879742652177811,-0.1046060249209404,-0.05540132522583008,-0.09138329327106476,0.13319750130176544,-0.08437738567590714,0.08066432923078537,-0.2064805030822754,0.0048921434208750725,0.14886809885501862,-0.11384358257055283,0.04080476239323616,0.19731742143630981,-0.09794898331165314,-0.11928679794073105,0.167185977101326,0.03692103922367096,0.2059185951948166,-0.032477106899023056,-0.21962368488311768,0.06444739550352097,0.19623978435993195,-0.2564731538295746,0.16336965560913086,0.05757531151175499,0.08216644078493118,-0.14034871757030487,0.22572743892669678,-0.056214701384305954},{0.24994060397148132,0.0004732788656838238,0.028508983552455902,0.18511752784252167,-0.3526563048362732,-0.04299350455403328,0.06689709424972534,0.15443043410778046,-0.06788812577724457,-0.14837883412837982,0.30424779653549194,-0.09084630757570267,0.06760074198246002,-0.03731445595622063,-0.12106253951787949,0.2719653844833374,-0.058975234627723694,-0.12756720185279846,0.09744743257761002,-0.29661229252815247,-0.04375123232603073,-0.2587760090827942,-0.19835497438907623,0.22864744067192078,-0.05639192461967468,-0.04085066542029381,0.140258327126503,0.05258265882730484,-0.16663376986980438,-0.07952883094549179,-0.030759721994400024,-0.07858116924762726},{0.301547646522522,-0.07240056991577148,0.07037145644426346,0.05949145182967186,-0.025539563968777657,-0.07932110875844955,0.20168688893318176,-0.23612700402736664,0.25545361638069153,0.29152074456214905,0.03668510913848877,0.13388507068157196,0.2331296056509018,0.322862833738327,-0.288980096578598,-0.3563865125179291,-0.2343759685754776,0.08189298957586288,-0.16431841254234314,-0.3184744119644165,-0.16218547523021698,0.24529701471328735,0.06104351207613945,0.15731701254844666,-0.15146344900131226,-0.12781785428524017,-0.1365063339471817,-0.2418898344039917,0.25055745244026184,0.1942058801651001,-0.3352149724960327,-0.1408715546131134},{-0.10244892537593842,0.1494694948196411,0.2808264493942261,-0.03339093178510666,-0.027133556082844734,0.0864863321185112,-0.01336385402828455,-0.33027154207229614,0.18654535710811615,0.25113463401794434,0.16709035634994507,0.22042147815227509,-0.2310587614774704,0.18188722431659698,-0.25273397564888,0.29697534441947937,0.1687587946653366,-0.2544548809528351,0.24716420471668243,0.06930878013372421,-0.3479291796684265,0.3099968731403351,-0.244873046875,0.16151483356952667,0.20378878712654114,0.2570461630821228,0.05086176097393036,0.13299578428268433,-0.16892942786216736,0.2456628978252411,-0.05343075096607208,0.09993239492177963},{-0.12692101299762726,-0.10820888727903366,0.016132233664393425,0.19190910458564758,0.02333153784275055,0.2227497398853302,-0.26466476917266846,-0.11960134655237198,-0.1553317755460739,-0.08425288647413254,-0.12915657460689545,-0.18792808055877686,0.01596830040216446,-0.1973128318786621,0.09914346784353256,-0.2038644552230835,0.24260540306568146,-0.022968489676713943,-0.297638863325119,-0.2906511723995209,0.12994660437107086,0.15603290498256683,-0.158029705286026,0.33246737718582153,-0.25902873277664185,0.041596267372369766,0.0948617160320282,-0.10173362493515015,0.15882615745067596,-0.20351450145244598,0.288863867521286,0.11668552458286285},{0.30790287256240845,0.06008249893784523,0.0581202507019043,0.2253284752368927,-0.22966954112052917,0.16518867015838623,-0.08568987995386124,0.15855169296264648,0.11309784650802612,0.024506263434886932,0.09403723478317261,-0.3125768005847931,-0.25880172848701477,0.029827410355210304,0.07527805864810944,-0.08119256049394608,0.27009353041648865,0.1423838883638382,-0.18702933192253113,-0.22058793902397156,0.3417526185512543,0.18561995029449463,0.2331484705209732,0.07519891858100891,-0.00898294523358345,0.05968791991472244,-0.05360036715865135,-0.16261576116085052,0.27197039127349854,0.015305950306355953,-0.17882049083709717,0.11848946660757065},{-0.018051614984869957,0.019127774983644485,-0.032997772097587585,-0.2618800103664398,-0.09435315430164337,-0.22446957230567932,-0.219619020819664,-0.1431964933872223,-0.033841777592897415,-0.01949337124824524,-0.2511426508426666,0.021386779844760895,-0.23363210260868073,-0.1631486415863037,0.012827732600271702,0.10230204463005066,0.26494860649108887,-0.17199450731277466,-0.32489803433418274,0.2571510076522827,-0.18248507380485535,0.26384472846984863,0.03635289892554283,-0.02799607813358307,0.01177245657891035,0.16116797924041748,-0.0816139206290245,-0.2623580992221832,0.21967554092407227,0.25881361961364746,-0.12372976541519165,0.17883974313735962},{-0.23537875711917877,-0.025052057579159737,0.04346486181020737,-0.029974978417158127,0.1032923236489296,0.13319970667362213,-0.19256871938705444,0.11356262117624283,-0.1649380922317505,-0.13917475938796997,0.06309966742992401,-0.13835503160953522,-0.19368143379688263,0.25057315826416016,0.015595879405736923,0.041423309594392776,0.18954633176326752,-0.2582134008407593,-0.16241899132728577,0.3077787756919861,0.025826163589954376,0.264765202999115,-0.05702092498540878,0.01978987269103527,-0.2561223804950714,-0.1869458556175232,0.003900467650964856,0.30160969495773315,-0.007108692545443773,0.005571514833718538,0.30001649260520935,0.30896660685539246}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.12469273060560226,0.15287460386753082,0.31695953011512756,-0.011893944814801216},{0.09100964665412903,-0.06482528895139694,0.05704719200730324,0.1767665594816208},{-0.15607129037380219,0.1964702010154724,0.10974743217229843,0.14980261027812958},{0.3305204510688782,0.019233237951993942,0.06240425258874893,0.3990171551704407},{-0.11011183261871338,0.08924737572669983,0.28552472591400146,-0.020237285643815994},{-0.125915989279747,0.2128840684890747,0.20990245044231415,-0.08439532667398453},{-0.2443545162677765,-0.006730681750923395,0.004753968212753534,-0.1134733334183693},{-0.36007267236709595,-0.1348523199558258,0.3440406024456024,-0.2823887765407562},{0.3178635537624359,-0.16975882649421692,-0.2763712406158447,-0.3654281497001648},{0.04657154157757759,0.2797592878341675,0.3286277651786804,-0.4138425588607788},{-0.14685802161693573,-0.15928906202316284,-0.19809181988239288,0.19690535962581635},{0.2863498628139496,-0.16848842799663544,0.010216047056019306,0.18611888587474823},{0.293583482503891,0.2879524827003479,-0.0687040239572525,0.09439225494861603},{0.010782265104353428,0.07931667566299438,-0.2888926565647125,0.021931366994976997},{0.11786369234323502,0.2854458689689636,0.3418131470680237,0.318876177072525},{0.15090571343898773,0.04956457018852234,0.27447134256362915,0.2412632405757904},{-0.2142399698495865,-0.09849933534860611,-0.13270235061645508,-0.198732390999794},{-0.18205301463603973,0.09978517889976501,-0.14620685577392578,-0.12950588762760162},{-0.1654927283525467,0.17682035267353058,0.1579705774784088,0.2733137011528015},{-0.03449265658855438,0.3373545706272125,-0.1710272580385208,0.06669344753026962},{-0.2421392947435379,-0.3671981394290924,-0.12375563383102417,0.0027950454968959093},{0.3006815016269684,0.4192405343055725,0.03479916229844093,-0.24753917753696442},{-0.013512665405869484,0.1587519496679306,0.1856129914522171,0.15000122785568237},{-0.09327252209186554,0.37162989377975464,-0.06939707696437836,-0.13843776285648346},{0.030182918533682823,-0.029775310307741165,-0.06613154709339142,-0.012700917199254036},{0.26998862624168396,-0.3860739767551422,-0.03630881384015083,0.047030214220285416},{0.0016627220902591944,-0.3191338777542114,-0.18586236238479614,-0.22879718244075775},{0.10227242857217789,-0.10793353617191315,0.2301996499300003,0.12983980774879456},{0.0026105002034455538,-0.055859845131635666,0.08405448496341705,0.018664106726646423},{-0.3289659321308136,0.3431192636489868,0.23666153848171234,-0.0899815633893013},{0.3129288852214813,-0.1367124766111374,0.17482928931713104,-0.02978508546948433},{0.05084788799285889,-0.3298957347869873,0.369256854057312,-0.2590675354003906}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.03927367553114891,-0.026053864508867264,0.021389814093708992,-0.0338224396109581,-0.04555230587720871,-0.15920627117156982,0.015104579739272594,0.04590709134936333,0.007878287695348263,-0.08344925194978714,0.1161077618598938,0.0737304538488388,-0.008814889937639236,-0.039479661732912064,0.07599668949842453,-0.020628442987799644};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.07065219432115555,0.04019607603549957,0.03557031974196434,0.03012998402118683,0.04688195139169693,0.00955114047974348,0.05593958869576454,-0.007193455938249826,0.001273628557100892,0.004251159727573395,-0.04748311638832092,-0.03034384362399578,0.04847945272922516,-0.021692080423235893,-0.03299374133348465,-0.013538878411054611};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07053940743207932,0.06121841073036194,0.015853626653552055,0.06567336618900299,0.04342034086585045,-0.023510700091719627,-0.0430588535964489,-0.010067678056657314,-0.02999916486442089,0.001278263982385397,-0.045693255960941315,0.05415277183055878,0.05342155322432518,-0.06355899572372437,0.07175596058368683,0.07388988137245178,-0.06394420564174652,-0.061404917389154434,0.007210233714431524,0.019636191427707672,-0.03587662801146507,0.002601669868454337,0.06071856990456581,0.009504158981144428,-0.016584815457463264,0.009074023924767971,-0.036915600299835205,0.05303842946887016,0.03326297178864479,-0.001992525765672326,0.029806144535541534,0.03231439366936684};
static const float action_parameterization_distribution_linear_bias[4] = {0.04598891735076904,0.0064849830232560635,0.05087802931666374,0.045063380151987076};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.006148720160126686,0.2497284859418869,-0.08568985015153885,0.1670173853635788,0.24710018932819366,0.17153286933898926,0.2733357548713684,0.02449861913919449},{-0.20815669000148773,-0.08558870106935501,-0.20862986147403717,-0.2650897204875946,-0.2800586223602295,-0.14608967304229736,-0.17306558787822723,-0.14969120919704437},{-0.29217323660850525,0.019205542281270027,0.25376567244529724,0.2053842842578888,0.23758141696453094,0.00784930307418108,0.19966013729572296,-0.08921381086111069},{-0.0383734330534935,0.0799776092171669,-0.1644187718629837,-0.004299211781471968,-0.0056193796917796135,-0.06328724324703217,0.2071879804134369,-0.1400669664144516},{-0.3032834827899933,-0.13965056836605072,-0.2228212207555771,-0.1393493115901947,-0.04134713485836983,0.18236956000328064,0.14062833786010742,0.010016865096986294},{-0.33677974343299866,0.015789825469255447,0.3371843993663788,0.2580368220806122,0.1919613778591156,-0.05725724622607231,-0.1031191274523735,-0.09019286185503006},{-0.22474095225334167,0.0898144543170929,0.33554545044898987,-0.18832926452159882,-0.08750759065151215,-0.3557647168636322,-0.06879328936338425,-0.11812131851911545},{-0.4422019124031067,-0.3374614417552948,0.5387577414512634,-0.02169608883559704,-0.22526268661022186,0.16692209243774414,0.1838645339012146,-0.16852813959121704},{-0.2978954017162323,0.2193918526172638,-0.15302108228206635,0.4388117790222168,0.09503322094678879,-0.4031015634536743,0.09055516123771667,0.12640969455242157},{-0.28311625123023987,-0.3590037226676941,-0.14454899728298187,-0.13572973012924194,-0.47891324758529663,0.03464733809232712,-0.012105478905141354,0.14351046085357666},{0.17973864078521729,0.3102516829967499,0.19430677592754364,0.005948512349277735,0.21832047402858734,0.04083164408802986,-0.25445494055747986,0.25009533762931824},{0.2299921065568924,-0.014661443419754505,0.244617760181427,0.27126872539520264,-0.17601415514945984,0.2695991098880768,-0.008088704198598862,-0.21187631785869598},{0.11310180276632309,-0.2621886730194092,0.25434398651123047,-0.011095798574388027,-0.16940881311893463,-0.05432959645986557,-0.11656591296195984,-0.174833744764328},{-0.21775230765342712,-0.09915848076343536,0.3131055235862732,0.41341668367385864,-0.06831290572881699,-0.04734029993414879,-0.21739985048770905,0.09608221799135208},{-0.03434060886502266,-0.14328177273273468,0.08835073560476303,-0.1616782695055008,-0.3398720622062683,-0.12768521904945374,0.22785113751888275,-0.05040682107210159},{0.022027140483260155,-0.057267431169748306,-0.03268111124634743,-0.2982538640499115,-0.12018632143735886,0.06288102269172668,-0.03214990347623825,0.37759897112846375},{-0.016785580664873123,-0.20275215804576874,-0.2030942440032959,0.029025258496403694,-0.15533961355686188,-0.10368774831295013,-0.09395184367895126,0.0324673093855381},{-0.188440203666687,-0.24924951791763306,0.06222810596227646,0.007112592458724976,0.12379936873912811,-0.1997329145669937,0.3891714811325073,0.11927356570959091},{0.04061572626233101,0.13314585387706757,-0.2450145035982132,0.13385848701000214,0.1019337922334671,0.1237364336848259,-0.16221174597740173,0.27867797017097473},{0.15754252672195435,-0.0785873681306839,-0.3731740415096283,0.0882745236158371,-0.09193605929613113,-0.12552379071712494,-0.26321494579315186,0.006532316096127033},{0.04963850602507591,-0.1737825721502304,0.03841114789247513,-0.1190938800573349,0.2548716366291046,-0.10045003145933151,-0.04479822888970375,0.4428841769695282},{-0.016118045896291733,0.07917813956737518,-0.31807446479797363,0.2049294412136078,0.2490665167570114,0.25214412808418274,0.10589887946844101,-0.2659631073474884},{-0.405631959438324,-0.12342816591262817,0.08060946315526962,-0.1064155101776123,0.14692339301109314,-0.35976916551589966,0.1281203329563141,-0.2463807910680771},{-0.09187915176153183,0.11758416146039963,-0.10758651047945023,-0.47579193115234375,0.2426358312368393,0.03541029244661331,-0.36756837368011475,0.13749732077121735},{-0.15327413380146027,-0.16767752170562744,-0.12826719880104065,0.058024823665618896,0.08642830699682236,0.32420614361763,0.26391854882240295,-0.05356831103563309},{-0.18064038455486298,0.08442246168851852,-0.3402549922466278,-0.2606182098388672,0.12907040119171143,0.03530184179544449,-0.0753512978553772,0.058652620762586594},{0.29494407773017883,0.38292405009269714,-0.21874167025089264,0.2391972839832306,0.06434580683708191,0.30573272705078125,-0.30290332436561584,-0.1761821210384369},{0.3776642978191376,0.26749804615974426,0.12973862886428833,0.09344306588172913,0.18885372579097748,0.06574958562850952,0.21180596947669983,0.36574724316596985},{-0.12084678560495377,0.38172098994255066,0.15979567170143127,0.04442208260297775,0.26380449533462524,0.01987455226480961,-0.4064423143863678,-0.2878410518169403},{-0.181695356965065,-0.24374833703041077,0.009818170219659805,-0.1705511510372162,-0.24994409084320068,-0.1645653396844864,0.22502239048480988,-0.012245165184140205},{0.4000019431114197,-0.29825612902641296,0.276117742061615,-0.25002217292785645,0.11679988354444504,0.26543813943862915,0.0857151672244072,-0.1644182801246643},{0.21164964139461517,0.36357808113098145,0.4458015263080597,-0.21207867562770844,-0.1959189921617508,0.1100052073597908,0.2117403745651245,0.04935113713145256}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.011392330750823021,0.3856663703918457,-0.1646324098110199,0.25612738728523254,-0.3822721838951111,0.22283130884170532,0.4370332658290863,0.04281329736113548},{-0.4024203419685364,-0.45559555292129517,-0.3413887023925781,-0.3899652659893036,-0.40841996669769287,0.39140743017196655,0.47084498405456543,-0.4194070100784302},{0.0016848657978698611,-0.1469760239124298,0.10632868111133575,0.01175014954060316,-0.07701586931943893,0.4187685251235962,-0.3000781536102295,-0.30601564049720764},{0.42415836453437805,-0.013987691141664982,0.07573522627353668,0.001337603316642344,0.5371027588844299,0.36886224150657654,0.41690459847450256,0.4337241053581238},{0.0806303545832634,0.22751209139823914,-0.1356819123029709,-0.05999177321791649,0.12843236327171326,-0.32535800337791443,-0.3728475570678711,0.4454139471054077},{0.41669681668281555,0.09849141538143158,0.02635004185140133,-0.3398514986038208,-0.3816959261894226,-0.4641062915325165,-0.1085427850484848,0.47821691632270813},{-0.3523964583873749,-0.28044024109840393,-0.004542745649814606,-0.20220166444778442,0.060136694461107254,0.33426356315612793,-0.5034268498420715,0.5768526196479797},{0.14194002747535706,0.051365237683057785,0.02436733990907669,-0.05443115904927254,0.31556180119514465,-0.4999273419380188,0.3814072012901306,-0.4914591312408447}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.04826309159398079,0.02527884766459465,0.09530621767044067,-0.05202320218086243,-0.03357592970132828,-0.051009345799684525,0.07416317611932755,-0.0243741013109684};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03969119116663933,-0.027815528213977814,0.04015104100108147,-0.1076817587018013,-0.006638582330197096,0.007260390091687441,-0.003560613840818405,-0.07196574658155441};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

