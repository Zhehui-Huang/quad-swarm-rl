#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3626607358455658,-0.2475680708885193,0.35175588726997375,0.17748050391674042,-0.40873804688453674,0.11501237004995346,0.01034174207597971,-0.20965352654457092,0.08737422525882721,0.48198577761650085,0.10604611039161682,-0.004989352077245712,0.15363872051239014,-0.14840097725391388,0.38536280393600464,-0.13500364124774933},{-0.3534131646156311,-0.21202132105827332,0.29763686656951904,0.13836908340454102,-0.24396632611751556,-0.022316278889775276,-0.3988015055656433,0.061484940350055695,-0.20268909633159637,-0.0999293401837349,0.12413056194782257,-0.13990144431591034,0.18281131982803345,-0.3731940686702728,-0.25581634044647217,0.08773572742938995},{0.16730843484401703,-0.26238059997558594,-0.24634036421775818,0.038274090737104416,0.10781890153884888,0.1505286991596222,-0.08481764793395996,0.009135575033724308,-0.10151375830173492,-0.1786423623561859,-0.19893518090248108,0.3932722508907318,-0.0034434630069881678,-0.14614562690258026,-0.3721913993358612,0.2215421050786972},{0.1851109117269516,0.18620215356349945,0.30957651138305664,-0.11319610476493835,-0.32751351594924927,-0.006811203900724649,0.14506906270980835,0.1114022508263588,0.4995296895503998,-0.37395232915878296,0.007697712630033493,0.13555094599723816,-0.28124967217445374,-0.08426002413034439,0.323709100484848,-0.36278998851776123},{-0.054878342896699905,0.14290231466293335,0.2155260443687439,-0.1019836813211441,0.22673067450523376,0.2649012506008148,0.21333453059196472,-0.04826738312840462,-0.050531648099422455,0.22431717813014984,0.3122437298297882,-0.11090132594108582,-0.11506401747465134,-0.356783002614975,0.35766270756721497,0.1262628734111786},{-0.05875740572810173,-0.1902947723865509,-0.151773601770401,-0.2771141231060028,0.12709645926952362,0.048192381858825684,-0.03433912619948387,-0.1674947589635849,0.2362668663263321,-0.2253524661064148,-0.3113064169883728,0.19079674780368805,0.3804969787597656,-0.033521562814712524,-0.048484086990356445,0.1741933971643448},{-0.08301923424005508,0.05245466157793999,0.07867787778377533,-0.25444599986076355,0.23646396398544312,0.021266788244247437,0.07488780468702316,0.4021805226802826,0.2752961814403534,-0.017585812136530876,-0.35801100730895996,0.27741438150405884,-0.06393057852983475,0.20941001176834106,-0.16939204931259155,-0.1766914278268814},{-0.012040121480822563,-0.03667773678898811,0.23590759932994843,0.22142288088798523,-0.35546883940696716,0.03329144045710564,0.32578030228614807,0.3336687386035919,-0.024077873677015305,0.19532503187656403,-0.47455689311027527,-0.300080269575119,0.27739882469177246,0.2550112009048462,0.21593114733695984,0.14780424535274506},{0.3421507477760315,-0.21714043617248535,0.3534836769104004,-0.034703049808740616,0.11338485032320023,0.11810529232025146,-0.20359310507774353,-0.232942596077919,0.17970781028270721,-0.2723222076892853,0.02203655056655407,-0.29744377732276917,-0.20387981832027435,0.29499551653862,0.1428990364074707,-0.08969282358884811},{0.08016109466552734,-0.19830743968486786,-0.44492313265800476,-0.07326682657003403,-0.3318837881088257,0.21137908101081848,0.39376598596572876,0.15763284265995026,0.45139941573143005,0.39444032311439514,0.0023724918719381094,-0.2958363890647888,0.08292751759290695,0.3224461078643799,-0.12240134179592133,-0.3885731101036072},{0.04800993949174881,0.26363131403923035,0.3591420650482178,-0.2600627839565277,-0.2766571640968323,0.23758195340633392,0.2141183763742447,0.3367358446121216,-0.28449878096580505,-0.05160190910100937,-0.039229534566402435,0.15487703680992126,-0.2883875072002411,-0.18453660607337952,0.3393988013267517,-0.3736209571361542},{0.02462773583829403,-0.1642056256532669,0.0016844362253323197,0.1753772795200348,0.34473931789398193,0.3194097876548767,0.41117063164711,-0.025958340615034103,0.019269205629825592,-0.04561864957213402,0.2712048888206482,-0.1907605230808258,0.012038437649607658,-0.24393713474273682,0.2655481696128845,0.2876143455505371},{-0.0924653485417366,0.2837531268596649,0.10296598076820374,-0.32338327169418335,0.08579321950674057,0.10728184878826141,0.37315183877944946,-0.039140135049819946,0.09184224903583527,-0.012836730107665062,-0.10116937756538391,0.14741374552249908,0.16014018654823303,0.2812938392162323,0.1460121124982834,-0.2971675992012024},{-0.24063816666603088,-0.2578330338001251,-0.248643696308136,0.006696839816868305,-0.1867506206035614,0.0814342349767685,-0.29927170276641846,0.08604361861944199,-0.008762973360717297,-0.05853058025240898,-0.2621868848800659,-0.03881159424781799,-0.36186087131500244,0.06849625706672668,0.2292490303516388,0.12011143565177917},{-0.2068917155265808,-0.30878278613090515,-0.2671181261539459,0.3112871050834656,0.09583264589309692,-0.3608900308609009,0.2798782289028168,-0.10858580470085144,0.05926039069890976,0.29576411843299866,0.10112584382295609,0.1949145346879959,0.17842359840869904,-0.0022485910449177027,-0.21810480952262878,0.2132335901260376},{0.4294794797897339,-0.05720923840999603,-0.2296537160873413,-0.400778591632843,-0.6000072360038757,0.279917448759079,0.4361836910247803,-0.26668721437454224,0.12991708517074585,0.06760610640048981,-0.26238325238227844,0.079771488904953,-0.4986453950405121,0.5557323694229126,-0.2831922173500061,-0.020343951880931854},{-0.40808534622192383,-0.35796451568603516,0.4231855273246765,0.33920860290527344,-0.28598812222480774,0.2849372327327728,-0.0687238946557045,-0.28855645656585693,0.257824182510376,-0.43644535541534424,-0.3046894967556,-0.6581096649169922,-0.2952995300292969,-0.3984052538871765,0.049961693584918976,-0.203206405043602},{-0.3680693507194519,0.2899892330169678,-0.5539968609809875,-0.03454802185297012,0.01684393733739853,0.3907853066921234,-0.3462156355381012,-0.40225422382354736,0.23308606445789337,0.2232515960931778,0.39730384945869446,-0.03658437356352806,-0.2099020630121231,0.2505398988723755,0.18792563676834106,-0.4977862238883972}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.09208069741725922,-0.1024225652217865,-0.19980552792549133,-0.40899354219436646,0.3585330843925476,0.2718775272369385,0.07131007313728333,0.08330373466014862,-0.2332141250371933,-0.11148925125598907,-0.08062520623207092,0.03299761191010475,0.2245272994041443,0.4545375108718872,0.09955856204032898,0.09480516612529755},{-0.17422987520694733,-0.2334924340248108,-0.030507702380418777,0.13609753549098969,0.31406062841415405,-0.22860971093177795,0.14556355774402618,0.04670672118663788,-0.05773315206170082,0.26169103384017944,-0.12224430590867996,0.34185320138931274,-0.3453989028930664,0.20957857370376587,-0.3427104651927948,-0.2543378472328186},{0.14730621874332428,0.20493543148040771,-0.34721672534942627,-0.6063469648361206,0.17425617575645447,0.438909649848938,-0.09494704753160477,0.10885092616081238,-0.2511407136917114,-0.24398179352283478,-0.025301828980445862,0.2760254442691803,-0.277948796749115,-0.24783647060394287,0.10449273884296417,-0.030825434252619743},{0.20929421484470367,-0.04876460134983063,0.058903224766254425,0.15022531151771545,-0.5056233406066895,0.01687866449356079,0.0410727895796299,-0.2728765606880188,0.32876884937286377,0.3454723358154297,-0.136789008975029,-0.18668895959854126,-0.41449442505836487,-0.3430076241493225,0.19936975836753845,0.23814396560192108},{-0.14021402597427368,0.08666836470365524,0.03960731625556946,0.31342682242393494,-0.2541055381298065,0.005258254241198301,-0.026461536064743996,0.22271154820919037,0.21492484211921692,-0.27165916562080383,0.023152930662035942,0.3752772808074951,0.1174008920788765,-0.41283127665519714,-0.07050209492444992,-0.1472824066877365},{0.20921944081783295,0.1630879044532776,-0.016075624153017998,0.1832427680492401,-0.34059152007102966,-0.41767922043800354,0.21144865453243256,0.27310264110565186,0.13115668296813965,0.42773517966270447,0.2311704456806183,-0.25751549005508423,0.022751614451408386,-0.16560602188110352,-0.07705861330032349,0.3191238045692444},{-0.05077788978815079,0.15078023076057434,0.37438297271728516,-0.3484058380126953,-0.15051433444023132,0.054552674293518066,-0.2900424897670746,-0.04849020391702652,0.11732743680477142,0.0944492444396019,-0.10675932466983795,-0.3063315153121948,-0.22835414111614227,0.026368791237473488,0.14631715416908264,0.07666923850774765},{-0.15505309402942657,-0.15367625653743744,-0.3741333484649658,0.2770882248878479,-0.23807917535305023,-0.3115951120853424,-0.18689188361167908,-0.33314934372901917,0.04207838326692581,-0.15643392503261566,-0.1306808590888977,0.15833497047424316,-0.21676868200302124,0.4262307286262512,-0.09702136367559433,-0.3823513984680176},{-0.20955196022987366,0.2785378694534302,-0.002205584431067109,-0.025891488417983055,0.32665419578552246,-0.2121526449918747,0.3917594254016876,0.12349212914705276,0.23263199627399445,0.3747192919254303,0.24831393361091614,0.3030794560909271,0.24064621329307556,-0.027890602126717567,0.26687437295913696,0.12186799943447113},{0.12015452235937119,-0.2835727334022522,-0.023839406669139862,-0.11872503906488419,0.3172130584716797,-0.055840909481048584,-0.30840614438056946,-0.23911193013191223,0.06728870421648026,-0.4521007835865021,-0.15785041451454163,0.1990259736776352,0.13935163617134094,0.16595828533172607,-0.30933326482772827,0.3005307614803314},{-0.11797474324703217,-0.3396000266075134,0.4319150447845459,0.24592351913452148,0.2369481921195984,0.1513185352087021,0.09050964564085007,-0.1498631089925766,0.1240614578127861,-0.1962355226278305,0.003000070573762059,0.4082532823085785,0.2810017466545105,0.131245419383049,-0.22040021419525146,-0.011009808629751205},{0.00029032971360720694,-0.14078959822654724,0.27469080686569214,0.006613115314394236,-0.1439528912305832,-0.22745417058467865,0.4551883041858673,0.2982313930988312,-0.2773904800415039,-0.3880837559700012,-0.11777863651514053,-0.34898510575294495,0.017110897228121758,-0.34391820430755615,-0.34570565819740295,-0.011912963353097439},{-0.0546799898147583,-0.32136818766593933,0.31971219182014465,-0.21134045720100403,0.3066615164279938,-0.3128185570240021,-0.3437495231628418,0.16810989379882812,0.08602157235145569,-0.032951511442661285,-0.2802303731441498,0.061811745166778564,0.09201506525278091,-0.26345157623291016,-0.37586188316345215,0.018929120153188705},{0.30473780632019043,-0.2843589186668396,0.45788079500198364,0.14966389536857605,0.03528449684381485,0.30242934823036194,-0.06593319773674011,-0.2061595916748047,-0.5087383389472961,0.1282864212989807,0.037274494767189026,-0.36466893553733826,0.0007100845105014741,0.219125434756279,0.34692472219467163,0.042262546718120575},{-0.24426956474781036,0.1521618515253067,0.1342114359140396,-0.30679771304130554,-0.19321535527706146,0.03153113275766373,0.21810282766819,-0.1291085034608841,0.17707256972789764,-0.3574441373348236,0.00826790276914835,0.06805373728275299,-0.019709816202521324,0.06313847750425339,-0.11566690355539322,0.023930393159389496},{-0.21566037833690643,0.2973196506500244,-0.3053114116191864,0.3543582558631897,0.12752504646778107,-0.3740154504776001,-0.09527399390935898,-0.09942315518856049,-0.36727645993232727,0.28042224049568176,-0.3416597843170166,0.3142831027507782,-0.06773989647626877,-0.17623525857925415,-0.2903995215892792,-0.516930878162384}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.14459039270877838,-0.0002909636532422155,-0.05537504330277443,-0.045177217572927475,-0.1138763353228569,0.03013545647263527,0.2865341603755951,0.05982647091150284,-0.13354142010211945,-0.21436643600463867,0.11742856353521347,-0.2842150926589966,-0.18601715564727783,0.22644883394241333,0.21695423126220703,0.2966574728488922,-0.23740315437316895,-0.3098791837692261,-0.1826843023300171,0.05688980221748352,-0.0383361354470253,-0.3449496328830719,-0.24038924276828766,-0.27285081148147583,-0.3059147000312805,0.20841336250305176,-0.22360752522945404,-0.025528378784656525,-0.014447457157075405,0.013952127657830715,0.23706790804862976,-0.16796784102916718},{0.27999234199523926,0.22644472122192383,0.1473102867603302,-0.06816697120666504,0.09627728909254074,-0.0996866524219513,0.27015551924705505,0.13554397225379944,-0.18735143542289734,-0.16142058372497559,-0.05013633891940117,-0.24937286972999573,-0.15536025166511536,0.1779964566230774,-0.20192424952983856,-0.31190526485443115,-0.05483396351337433,0.14207883179187775,-0.2985627353191376,-0.278922975063324,0.016597948968410492,0.2328806221485138,0.10429263859987259,-0.10974963009357452,0.16036918759346008,-0.28623685240745544,0.033720217645168304,0.07678770273923874,0.2224627137184143,-0.1107044667005539,-0.03496139869093895,0.2621966302394867},{0.24174758791923523,0.08462630212306976,-0.0368480384349823,0.11171060800552368,-0.16462507843971252,-0.1650124043226242,-0.23681585490703583,0.14372901618480682,-0.12076622247695923,0.36423981189727783,-0.296002060174942,-0.19986622035503387,0.15740486979484558,-0.3586149215698242,-0.16659805178642273,0.12592604756355286,-0.11209283769130707,-0.1176074743270874,0.23934844136238098,-0.02063826099038124,0.20477834343910217,0.26665082573890686,-0.25744733214378357,0.05035039782524109,-0.1694105863571167,-0.11329662054777145,0.13266418874263763,-0.06324294954538345,-0.08526343107223511,-0.1593295931816101,-0.057168006896972656,-0.1361510157585144},{0.32616934180259705,0.06425249576568604,0.0934755951166153,-0.13270489871501923,-0.2565195858478546,-0.08397765457630157,-0.13029761612415314,0.21718472242355347,0.2451893389225006,-0.20232918858528137,-0.11578470468521118,0.2625318467617035,0.11831637471914291,-0.10317018628120422,-0.2396445870399475,0.31286540627479553,-0.3139277398586273,0.26055118441581726,-0.03741201385855675,0.03837494179606438,-0.0637977197766304,-0.1032181903719902,0.28312399983406067,0.16716253757476807,0.16160576045513153,-0.3059614300727844,0.2979201078414917,-0.20566798746585846,-0.03237888216972351,0.012469860725104809,-0.3136325776576996,0.1505577713251114},{-0.0268365778028965,-0.04073457047343254,-0.07864002883434296,0.04029017314314842,0.20336072146892548,-0.1630236655473709,-0.3737383782863617,0.010532633401453495,-0.1372765302658081,-0.19747063517570496,0.15804098546504974,0.22988353669643402,-0.09269695729017258,-0.08427230268716812,-0.07591742277145386,0.22082635760307312,-0.04241744801402092,-0.00411621667444706,-0.3280979096889496,-0.034167807549238205,-0.1864829808473587,-0.3408394753932953,0.16560107469558716,0.23367877304553986,-0.05853034928441048,0.26600754261016846,-0.1647903323173523,0.24138548970222473,0.27927249670028687,0.35379287600517273,0.00020282888726796955,0.29067936539649963},{-0.223778635263443,-0.1170554831624031,-0.12776623666286469,-0.07388202846050262,-0.10645660012960434,0.2206069678068161,0.22874301671981812,0.040066394954919815,0.32889553904533386,0.12469960004091263,0.27304139733314514,-0.22214435040950775,-0.15227295458316803,0.24813558161258698,0.24568942189216614,-0.34162065386772156,-0.08637203276157379,-0.2332795411348343,0.2254076898097992,0.15070754289627075,0.07123862951993942,0.13196918368339539,-0.014661094173789024,-0.009948051534593105,-0.34588170051574707,0.3183538019657135,-0.20679184794425964,0.159190833568573,0.31776753067970276,0.22520855069160461,0.08763483166694641,0.04530355706810951},{0.16500186920166016,-0.13568063080310822,-0.1340601146221161,-0.33125603199005127,0.004767762962728739,0.23774594068527222,0.26920321583747864,0.11492034792900085,0.10674857348203659,0.29363811016082764,0.002216793829575181,0.0002560403954703361,-0.4211968779563904,-0.12240172177553177,-0.14372986555099487,0.03299659118056297,-0.2704576849937439,-0.21531876921653748,0.16975240409374237,-0.10059133172035217,-0.12145154923200607,-0.14123474061489105,-0.23231276869773865,-0.2614389657974243,0.18020378053188324,-0.2695766091346741,-0.12120218575000763,-0.20395700633525848,0.33843886852264404,0.12549513578414917,-0.1751227229833603,-0.2801463007926941},{0.06873390823602676,0.17375735938549042,0.05355224758386612,-0.13247062265872955,0.15070079267024994,-0.2916119396686554,-0.0576317124068737,-0.16336318850517273,0.018538594245910645,-0.28501448035240173,-0.3056347072124481,-0.09649538993835449,-0.11018656939268112,0.06500755250453949,-0.12192356586456299,0.3961602747440338,0.011586482636630535,-0.1399204283952713,0.12317945808172226,0.32443174719810486,-0.18474292755126953,-0.19743937253952026,0.26761654019355774,0.08204234391450882,-0.0020371864084154367,-0.3453731834888458,-0.3308476209640503,-0.22508780658245087,-0.36840322613716125,-0.26260384917259216,0.10339996963739395,-0.37342920899391174},{0.03474242612719536,0.40019869804382324,-0.3657812774181366,-0.357326865196228,-0.28008922934532166,0.09017255902290344,0.0784548968076706,0.109624944627285,0.10474278777837753,-0.2266951948404312,-0.20240312814712524,0.2815806567668915,-0.3492334485054016,-0.18582898378372192,0.19211408495903015,-0.23315680027008057,0.22149509191513062,0.11496132612228394,0.28694796562194824,0.05660036578774452,0.20990733802318573,0.11798711866140366,0.32396578788757324,-0.13082411885261536,0.45783841609954834,-0.1846071034669876,0.19721481204032898,0.32963019609451294,-0.18449260294437408,0.11207938939332962,0.010472584515810013,0.09601321071386337},{-0.20303504168987274,0.11470744758844376,-0.3383355140686035,-0.16410908102989197,0.10198502987623215,-0.20485888421535492,0.09278617799282074,0.007992123253643513,0.1618576943874359,0.04101474955677986,-0.24531356990337372,-0.32422396540641785,-0.41788190603256226,-0.12252375483512878,-0.22471801936626434,0.09048677235841751,-0.026631439104676247,-0.2609575390815735,0.22825099527835846,0.07071252167224884,0.08736473321914673,-0.025711307302117348,0.38280075788497925,-0.2261410504579544,0.32169026136398315,0.15457071363925934,-0.21681156754493713,0.05982271209359169,0.02548312209546566,0.06396089494228363,-0.1882612407207489,0.1485806554555893},{0.07341475784778595,-0.030559003353118896,0.17693129181861877,-0.2714245915412903,-0.2380828708410263,-0.2217763215303421,-0.2557787299156189,-0.09570098668336868,-0.16194115579128265,0.3154911994934082,0.12302728742361069,-0.2852340042591095,-0.33899974822998047,-0.012137711979448795,-0.2212681770324707,-0.19176940619945526,0.25503817200660706,-0.1499577909708023,0.2559832036495209,-0.22733591496944427,-0.19242097437381744,0.011319861747324467,0.16864827275276184,0.16864049434661865,0.16825392842292786,-0.13987550139427185,-0.06582972407341003,-0.0663551613688469,-0.05080798268318176,0.01992649771273136,-0.07424651831388474,0.16604141891002655},{-0.21544551849365234,-0.029444495216012,0.24440987408161163,0.33325493335723877,0.262164443731308,-0.0025614427868276834,0.05570182949304581,-0.2084169238805771,-0.09745977073907852,-0.19548897445201874,0.2932533919811249,-0.23825260996818542,-0.21810393035411835,-0.20595362782478333,0.28907516598701477,-0.0017085936851799488,-0.015687087550759315,0.017564840614795685,0.33229291439056396,0.08054119348526001,-0.18022656440734863,0.22449813783168793,0.10894826054573059,-0.10566733032464981,0.19948099553585052,-0.09964848309755325,-0.13532520830631256,0.2225666046142578,0.20561571419239044,-0.015112748369574547,-0.27039802074432373,-0.25237780809402466},{0.22244705259799957,-0.24857383966445923,-0.004545536357909441,-0.3532072901725769,0.14640283584594727,-0.05417909845709801,0.16568371653556824,0.06802350282669067,0.25277262926101685,0.06311894953250885,0.13664737343788147,0.1840507984161377,-0.35952505469322205,-0.22238734364509583,-0.0713440328836441,-0.21288567781448364,-0.12033084779977798,-0.19837303459644318,0.2453353852033615,-0.2367148995399475,0.25553151965141296,0.013935861177742481,-0.0187270138412714,0.17819328606128693,0.13121765851974487,-0.0796600803732872,0.12099436670541763,0.16197530925273895,0.13112346827983856,-0.07997778803110123,-0.20841151475906372,-0.10122694820165634},{0.23168396949768066,-0.04455716535449028,-0.04665682464838028,0.41993194818496704,-0.09685932844877243,-0.19512654840946198,-0.06941022723913193,0.10553166270256042,0.17026031017303467,0.2903887629508972,0.12998107075691223,-0.14725852012634277,0.020410068333148956,0.19713619351387024,-0.10020170360803604,0.06297498941421509,0.20589138567447662,-0.24386189877986908,0.0594138540327549,-0.3275080621242523,0.32253387570381165,0.1525568664073944,-0.05785209685564041,0.18296748399734497,0.18829475343227386,0.08183269947767258,0.09853429347276688,0.06551142781972885,0.06382207572460175,-0.1472659856081009,-0.03763985261321068,0.4030183255672455},{0.02872231975197792,-0.26836201548576355,-0.08270677924156189,0.12452394515275955,-0.24646872282028198,-0.01234008464962244,0.05270121991634369,-0.2731626331806183,-0.1554488241672516,-0.059050023555755615,0.18261493742465973,0.14593496918678284,0.08714989572763443,0.2585811913013458,-0.054951246827840805,-0.10494529455900192,-0.23239624500274658,0.2611806392669678,-0.09421972185373306,-0.28125178813934326,-0.17909224331378937,-0.08450568467378616,0.181357741355896,-0.013814903795719147,-0.04744190350174904,-0.071946881711483,-0.20529566705226898,0.22334831953048706,0.06870780140161514,-0.17006562650203705,0.21837392449378967,0.20246490836143494},{0.130128875374794,-0.23868025839328766,-0.08609931170940399,-0.18776965141296387,-0.09445871412754059,0.1607087254524231,0.03272003307938576,0.2350831925868988,-0.08862201869487762,0.005293561145663261,0.25485214591026306,0.11298903077840805,-0.0457405224442482,-0.12030106782913208,0.043516963720321655,0.15253044664859772,-0.4043629467487335,-0.2827926576137543,-0.06137567386031151,0.05018916353583336,0.11825518310070038,0.23271319270133972,0.2703457474708557,0.1423206627368927,0.04845631122589111,0.22302262485027313,0.01656537689268589,-0.06946505606174469,0.1958920657634735,-0.1192479133605957,-0.25068461894989014,0.3691015839576721},{0.2062510848045349,-0.02528971992433071,-0.23380641639232635,0.15787942707538605,0.0926821380853653,-0.04408241808414459,0.2653684616088867,0.12066581845283508,0.11105569452047348,-0.22596138715744019,0.21004511415958405,-0.17306824028491974,-0.3461783826351166,0.2457943856716156,0.06416773051023483,0.06017032265663147,0.07411422580480576,-0.04136640578508377,-0.1248236820101738,0.07560095191001892,-0.07623349875211716,0.19642966985702515,0.046950291842222214,-0.14117668569087982,0.044118985533714294,-0.3153173327445984,0.0370202362537384,0.4153524339199066,0.2120523303747177,-0.12837105989456177,0.22618089616298676,0.1742943376302719},{-0.07629869133234024,-0.043488759547472,-0.10398194938898087,-0.03719616308808327,-0.24599000811576843,-0.05504036322236061,0.19501949846744537,0.16092680394649506,0.15328536927700043,0.006097801495343447,0.22967840731143951,0.0006109897512942553,0.2203698307275772,0.16496872901916504,0.17298589646816254,-0.09586501866579056,0.11251719295978546,0.1524025946855545,0.23136645555496216,0.0678446888923645,0.18560396134853363,0.2320065051317215,0.049556974321603775,0.13746118545532227,-0.017209993675351143,-0.09774261713027954,-0.10324464738368988,-0.26484593749046326,0.165899857878685,-0.23992763459682465,-0.0033526925835758448,-0.030459683388471603},{-0.30096572637557983,0.10890597105026245,-0.273466020822525,-0.34454861283302307,-0.017704810947179794,0.08035750687122345,0.11826033145189285,-0.10086098313331604,-0.012467174790799618,0.29322096705436707,0.06907495856285095,-0.2054089456796646,0.07770392298698425,-0.18287144601345062,-0.308678537607193,-0.035043906420469284,-0.17165660858154297,0.15873514115810394,-0.012528246268630028,-0.05765622854232788,-0.31734541058540344,0.18511465191841125,0.12907706201076508,0.020833753049373627,-0.015398483723402023,0.2770560681819916,0.03088405355811119,-0.11905714869499207,-0.17434285581111908,0.028512699529528618,-0.11979750543832779,-0.24558809399604797},{-0.0030895222444087267,-0.21410109102725983,-0.22191844880580902,-0.021246252581477165,-0.35778650641441345,-0.15040577948093414,0.16076262295246124,-0.2988506257534027,-0.20174813270568848,0.19245843589305878,0.14757618308067322,0.12343315035104752,0.14241380989551544,-0.11404366791248322,0.3148503601551056,-0.32279595732688904,0.08085091412067413,0.23682084679603577,0.061412084847688675,0.23661132156848907,0.0459413155913353,-0.10808371007442474,-0.28654173016548157,0.1874341070652008,-0.18092411756515503,-0.17037540674209595,0.10500644892454147,0.04052935913205147,-0.11535851657390594,-0.2950792908668518,-0.027284234762191772,-0.14115004241466522},{0.23569519817829132,0.20507171750068665,-0.07693860679864883,0.17342957854270935,-0.28629544377326965,0.17412684857845306,-0.06642753630876541,-0.1291104555130005,-0.188702791929245,0.20009790360927582,-0.25460827350616455,-0.16134828329086304,-0.05225856602191925,-0.19258569180965424,-0.36769601702690125,-0.12367870658636093,-0.08604740351438522,-0.2733071744441986,-0.233865424990654,0.27938133478164673,0.09758573770523071,0.1210969090461731,-0.33106255531311035,0.3330062925815582,0.19301243126392365,0.2533717155456543,-0.2775159478187561,-0.030557651072740555,0.07041499763727188,-0.25903889536857605,0.13099268078804016,0.09127184748649597},{-0.0019741649739444256,-0.3279191255569458,0.019641533493995667,-0.2579345703125,-0.08154427260160446,0.2660181522369385,0.14549319446086884,0.013681638985872269,-0.04191146045923233,-0.0032535609789192677,-0.20499922335147858,0.18608970940113068,0.16081932187080383,0.09780743718147278,0.17352326214313507,-0.015514427796006203,-0.07800869643688202,0.1031084880232811,-0.07683219015598297,0.15890157222747803,0.2380763292312622,0.2206236869096756,-0.07103836536407471,-0.26789742708206177,0.07359674572944641,0.09785502403974533,0.2760505974292755,0.12499339133501053,-0.019766438752412796,0.21223285794258118,0.032960016280412674,-0.09613603353500366},{0.03420168533921242,-0.17473366856575012,0.24281421303749084,0.004863076377660036,0.29834017157554626,-0.02557169832289219,-0.1096717044711113,-0.15011103451251984,0.13207140564918518,-0.07359311729669571,0.07680302858352661,0.0053567043505609035,-0.29506343603134155,0.017761148512363434,-0.1045343354344368,-0.2382025420665741,-0.04518275335431099,-0.045168906450271606,0.21518613398075104,0.25100377202033997,0.0343979075551033,0.03671091049909592,0.17672015726566315,0.3459581434726715,-0.15284301340579987,-0.06343970447778702,0.20106878876686096,-0.11264464259147644,-0.20274779200553894,-0.24021388590335846,0.3072405159473419,-0.0003900592273566872},{0.18555337190628052,-0.07217778265476227,0.02280019223690033,0.14029821753501892,-0.03342688828706741,0.055466681718826294,-0.27128756046295166,0.26467716693878174,-0.07374154776334763,-0.030387891456484795,0.10713494569063187,-0.2761317789554596,-0.012181206606328487,-0.014022134244441986,-0.09533804655075073,0.2731093168258667,-0.092475026845932,-0.20301538705825806,0.03845110535621643,-0.021098874509334564,-0.17067915201187134,0.2115471363067627,0.23693525791168213,0.20613811910152435,-0.28735512495040894,0.12531447410583496,-0.05931977927684784,0.09014889597892761,-0.274990051984787,0.26879769563674927,-0.0345035046339035,0.05117197334766388}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.19188715517520905,-0.0828506126999855,0.0777386873960495,-0.13939280807971954},{0.1944841742515564,-0.31298404932022095,0.2531260848045349,0.2194328010082245},{-0.2253304421901703,0.0966183990240097,0.0443522147834301,-0.018290981650352478},{0.27878642082214355,0.44049662351608276,0.34196799993515015,0.026259714737534523},{-0.2528102993965149,0.11551285535097122,-0.2793089747428894,0.08420676738023758},{-0.04374634101986885,-0.038013286888599396,0.05930299684405327,0.3553006649017334},{-0.11405781656503677,-0.07843799889087677,-0.31036633253097534,0.009972966276109219},{-0.1455986499786377,-0.23386117815971375,0.1445186883211136,-0.06850283592939377},{-0.0497780479490757,0.09126950055360794,-0.0778205543756485,-0.08212405443191528},{0.20531047880649567,0.015747440978884697,-0.08835521340370178,-0.14500249922275543},{0.1376677006483078,-0.1053684800863266,0.28418609499931335,0.2485940307378769},{-0.0016249282052740455,0.018288562074303627,0.30329447984695435,-0.08481205999851227},{-0.322230726480484,0.19902972877025604,-0.017557969316840172,-0.1376824676990509},{-0.16364572942256927,0.0927247479557991,-0.20336198806762695,0.07857344299554825},{0.16638943552970886,0.038831207901239395,0.24690453708171844,0.08679252117872238},{-0.1371183693408966,-0.35143154859542847,-0.1271064728498459,-0.09598225355148315},{-0.2541155219078064,0.040295522660017014,-0.08666689693927765,0.2616010308265686},{-0.23432938754558563,-0.11783143132925034,-0.20672373473644257,0.18013830482959747},{-0.06329432874917984,-0.06251514703035355,0.3189873993396759,0.08063828200101852},{-0.177348792552948,-0.13569775223731995,0.017908448353409767,-0.17800270020961761},{0.14714941382408142,0.10161669552326202,0.13013404607772827,-0.16423973441123962},{-0.04411814734339714,-0.23912252485752106,-0.08572448045015335,0.25023728609085083},{0.374655544757843,-0.1916031837463379,0.1371792107820511,0.04110497981309891},{-0.31332138180732727,-0.11473017185926437,-0.3128145635128021,-0.3197031617164612},{-0.13995052874088287,-0.15664790570735931,-0.06796308606863022,-0.08893407881259918},{0.13722394406795502,0.09105799347162247,-0.03363370522856712,0.09281203895807266},{0.13972429931163788,-0.17774698138237,0.2454560399055481,0.07590679824352264},{-0.08705347776412964,-0.14702798426151276,-0.005743242334574461,0.2603239417076111},{0.08220823854207993,0.025529557839035988,0.061323076486587524,0.044571734964847565},{-0.138117715716362,0.10183776170015335,0.22107599675655365,0.011121639050543308},{-0.22308975458145142,-0.11379452049732208,0.0772639662027359,0.18479114770889282},{0.23391634225845337,0.19036252796649933,0.25757116079330444,-0.04423621669411659}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11682692170143127,-0.10821996629238129,0.04442846402525902,0.09245558828115463,0.10390187799930573,-0.10391504317522049,0.0903744250535965,-0.013584146276116371,-0.06682100892066956,-0.09761736541986465,-0.0014223955804482102,0.06274539977312088,-0.012550542131066322,0.05213102325797081,0.09947513788938522,-0.033145103603601456};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.028616229072213173,0.059575874358415604,0.05702999606728554,-0.023871656507253647,-0.036377787590026855,0.04957424849271774,-0.05495769530534744,-0.07461544126272202,0.0541420616209507,-0.002341956365853548,-0.028651168569922447,-0.035535603761672974,0.004827368073165417,-0.0846613422036171,0.0127275250852108,-0.06554008275270462};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.047201067209243774,0.00782984122633934,-0.06204448640346527,0.03322194144129753,-0.00038676970871165395,0.014838382601737976,-0.053964365273714066,-0.03769831359386444,-0.02322026900947094,-0.016891807317733765,0.01134566217660904,0.03993542119860649,0.037328120321035385,-0.05143420398235321,0.035898271948099136,-0.07958795130252838,-0.008958954364061356,-0.034565094858407974,0.021067902445793152,-0.05505039542913437,0.023578699678182602,-0.004130793735384941,0.03246060386300087,-0.06688516587018967,-0.05355393514037132,0.055876724421978,0.04759981483221054,-0.027574388310313225,0.0705142393708229,0.02558177150785923,-0.0088596036657691,0.05529081076383591};
static const float action_parameterization_distribution_linear_bias[4] = {0.037164874374866486,0.053139351308345795,0.009932732209563255,0.033104632049798965};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3301985263824463,-0.16521184146404266,-0.0025122815277427435,0.1737113893032074,0.03243220970034599,0.030127432197332382,-0.1832219809293747,0.014904535375535488},{0.04334944486618042,0.10434675961732864,0.31404298543930054,0.33542466163635254,-0.08578096330165863,-0.23164567351341248,0.31306543946266174,0.11923374980688095},{0.002058375161141157,0.20214468240737915,0.02029549889266491,-0.05638829618692398,0.31013840436935425,0.25067591667175293,-0.08649667352437973,0.06963608413934708},{0.10342434793710709,-0.24314887821674347,0.2773633897304535,-0.22930794954299927,-0.3049568235874176,0.03832618519663811,0.2192186415195465,0.1845506727695465},{-0.2089896947145462,0.013993076048791409,-0.0074570756405591965,-0.3037005066871643,0.06806662678718567,0.038660015910863876,0.2555427849292755,0.25569289922714233},{-0.07102201879024506,0.3000805079936981,-0.06914543360471725,-0.2550716698169708,0.14883746206760406,0.009872418828308582,0.029865246266126633,-0.19542095065116882},{0.0008599976426921785,0.33776065707206726,0.13429999351501465,-0.16713657975196838,0.19775605201721191,-0.2610292136669159,0.2335844188928604,0.06740530580282211},{0.02191341482102871,-0.19218802452087402,0.03724522143602371,-0.06238962709903717,0.2645801305770874,-0.12621821463108063,0.0022935690358281136,-0.2861076295375824},{-0.15777821838855743,0.2979890704154968,0.17427314817905426,0.0036086856853216887,0.014361259527504444,0.1947597712278366,0.4565233886241913,0.3696346879005432},{0.04768092930316925,-0.058819256722927094,-0.2291393280029297,0.3580690920352936,0.2579732835292816,0.1498042643070221,0.21223163604736328,-0.2734581530094147},{-0.131378173828125,-0.31333497166633606,0.3727651834487915,0.2269146889448166,-0.040309663861989975,-0.3920125961303711,-0.08327440172433853,-0.3184809982776642},{0.3045431673526764,0.07855077087879181,0.3821512460708618,0.48883405327796936,-0.15866605937480927,0.177455872297287,0.12178600579500198,-0.36505749821662903},{-0.3016185164451599,0.16399243474006653,-0.3295600116252899,0.4129887521266937,-0.04240046814084053,0.23773597180843353,0.005999264307320118,0.2500488758087158},{-0.012242465279996395,0.21002498269081116,-0.07832522690296173,-0.18079107999801636,0.03562607243657112,0.06229117885231972,0.29972928762435913,-0.020340824499726295},{0.15112169086933136,-0.29038485884666443,-0.2826042175292969,-0.19727903604507446,0.2149866819381714,-0.17314085364341736,0.22941461205482483,-0.14047224819660187},{-0.36244672536849976,-0.36562883853912354,-0.28080543875694275,-0.0322660431265831,0.015345192514359951,0.11728327721357346,0.22515417635440826,-0.018417228013277054},{-0.22058768570423126,-0.23558157682418823,0.13503526151180267,-0.2840157449245453,0.07147646695375443,0.0637459084391594,-0.39068517088890076,-0.2562694847583771},{0.027308320626616478,0.2686655819416046,0.04712914302945137,0.167105033993721,-0.09336360543966293,0.32419052720069885,0.2711118757724762,-0.16492824256420135},{-0.003660907968878746,-0.27283528447151184,-0.10717952996492386,-0.033400505781173706,-0.04378117620944977,-0.34571969509124756,0.10438253730535507,-0.21030013263225555},{-0.11381414532661438,0.020568745210766792,0.09496238827705383,-0.26262322068214417,0.13194026052951813,0.06199854984879494,0.11210991442203522,-0.0001205744338221848},{0.02604593150317669,-0.058938801288604736,0.08755539357662201,-0.16307200491428375,0.04471537470817566,-0.03597631677985191,0.09563950449228287,-0.1746259480714798},{-0.3048292398452759,0.19471651315689087,0.19109925627708435,-0.2848653495311737,-0.39199844002723694,-0.025804495438933372,0.2101294845342636,0.02857821248471737},{0.28434741497039795,0.05955396220088005,-0.3640643358230591,-0.013459617272019386,-0.07427693903446198,0.24040085077285767,0.21825750172138214,0.284166544675827},{0.008368046022951603,-0.20941969752311707,-0.04208929091691971,0.10695042461156845,-0.3347872197628021,-0.0714196264743805,-0.2772916257381439,-0.3094245493412018},{0.12216590344905853,-0.07748005539178848,-0.38416367769241333,0.35141921043395996,-0.3334323465824127,-0.11586803197860718,-0.46313026547431946,0.09283414483070374},{-0.01029517687857151,0.30785495042800903,-0.20080748200416565,-0.08334653079509735,0.08901922404766083,-0.1361595243215561,0.23222307860851288,-0.29212674498558044},{-0.11107146739959717,0.07759534567594528,-0.1096869632601738,-0.23458318412303925,0.024647127836942673,-0.1122683435678482,-0.16819462180137634,-0.10626757889986038},{0.09436514228582382,-0.18288789689540863,0.013997780159115791,-0.1265929639339447,0.05997584015130997,0.09797035902738571,-0.26645854115486145,0.11242355406284332},{0.19325770437717438,-0.005100655369460583,-0.31375470757484436,-0.1736048310995102,-0.18460355699062347,0.19134698808193207,0.1998935341835022,0.037177830934524536},{0.29142212867736816,-0.383502721786499,0.013813715428113937,-0.05517606437206268,0.09466487914323807,-0.08493649959564209,0.13481028378009796,0.22175003588199615},{-0.28887036442756653,-0.2471316158771515,0.042764194309711456,-0.35935407876968384,0.263727068901062,-0.3342905640602112,-0.059871360659599304,0.07422391325235367},{0.27426600456237793,0.19592151045799255,0.00680825999006629,0.21683308482170105,0.0911145880818367,-0.19041432440280914,-0.07161182910203934,0.1565718650817871}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.22318467497825623,0.41377225518226624,-0.46114397048950195,-0.49787676334381104,-0.16496925055980682,-0.11320306360721588,-0.3916521370410919,0.4902091324329376},{-0.02457713708281517,0.41274312138557434,-0.2387920767068863,0.5625242590904236,-0.02119036763906479,-0.06659690290689468,-0.34552615880966187,-0.025400130078196526},{-0.3276793956756592,-0.2150903195142746,-0.15050643682479858,-0.12586481869220734,0.40640726685523987,0.19067512452602386,-0.08610104769468307,0.4093019962310791},{-0.4785420000553131,-0.4607972204685211,0.3190825581550598,0.2400599718093872,-0.49356698989868164,-0.19615504145622253,0.42950454354286194,0.20584708452224731},{-0.2671110928058624,-0.23373036086559296,-0.2852562367916107,-0.17943723499774933,0.3353884518146515,-0.22393226623535156,0.46939700841903687,-0.36220303177833557},{-0.050375014543533325,0.25749143958091736,0.12693223357200623,-0.5634244084358215,0.5304022431373596,-0.23868675529956818,-0.47912681102752686,-0.35767030715942383},{-0.2741858959197998,0.11148525774478912,0.058609072118997574,-0.4493750333786011,0.04474788159132004,-0.49230775237083435,0.4442592263221741,0.08003261685371399},{-0.32817521691322327,-0.16974593698978424,-0.1384747177362442,-0.3524256646633148,-0.3751610219478607,0.08672600984573364,0.5349446535110474,-0.3100898861885071}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04579051956534386,-0.08613336086273193,-0.09530051797628403,0.03351638838648796,0.16662707924842834,0.024417981505393982,0.14676745235919952,0.03174041584134102};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.02072077803313732,0.0028672958724200726,-0.020255155861377716,-0.09003590792417526,-0.059340156614780426,-0.05711442977190018,0.01549709402024746,-0.16226327419281006};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

