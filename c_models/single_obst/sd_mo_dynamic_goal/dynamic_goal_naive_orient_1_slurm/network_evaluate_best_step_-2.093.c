#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3313451111316681,-0.08754177391529083,0.2854558527469635,0.1488957405090332,-0.28095507621765137,0.29658234119415283,-0.028509218245744705,-0.13915002346038818,0.12038683891296387,0.34421464800834656,0.10245981812477112,0.039399486035108566,0.22958309948444366,-0.2497911900281906,0.2632300555706024,-0.046923305839300156},{-0.18093809485435486,-0.42418384552001953,0.340411901473999,0.0914725735783577,-0.22708359360694885,0.16804179549217224,-0.40075451135635376,-0.06539233773946762,-0.09654482454061508,-0.20187482237815857,0.04065745323896408,-0.19966307282447815,-0.0010460427729412913,-0.3327092230319977,-0.27156302332878113,0.12086384743452072},{-0.10271193087100983,-0.21411587297916412,-0.47069263458251953,0.17288555204868317,0.24826842546463013,0.5756107568740845,0.028311410918831825,-0.03575272858142853,0.0934482142329216,-0.5002952814102173,-0.408718079328537,0.8052907586097717,-0.22279049456119537,-0.31402215361595154,-0.3965143859386444,0.2884838581085205},{0.16473735868930817,0.2738700807094574,0.3588155508041382,-0.006663736887276173,-0.38830193877220154,-0.013270863331854343,0.2540479898452759,0.07792359590530396,0.32455936074256897,-0.32356640696525574,0.005511792842298746,0.42232704162597656,-0.2376532256603241,-0.01832091435790062,0.4806370139122009,-0.46959438920021057},{-0.07114284485578537,0.012871497310698032,0.31411227583885193,-0.0673913061618805,0.31239229440689087,0.43617188930511475,0.16926607489585876,-0.025583842769265175,0.12925243377685547,0.1974780261516571,0.2580599784851074,-0.3457530438899994,-0.19321218132972717,-0.42323005199432373,0.3841668665409088,0.09680968523025513},{-0.25878915190696716,-0.19029855728149414,-0.19129179418087006,-0.04921587556600571,0.22079211473464966,0.1914266049861908,0.025882648304104805,-0.1264759749174118,0.3403615355491638,-0.299452543258667,-0.4657415449619293,0.23806419968605042,0.11345887184143066,-0.14492447674274445,-0.030190303921699524,0.08289818465709686},{0.06624416261911392,0.08817631751298904,0.019645441323518753,-0.4256765842437744,0.22965466976165771,-0.030426058918237686,0.05929797142744064,0.3896940052509308,0.3401367664337158,0.07499077171087265,-0.4487466812133789,-0.05340520665049553,-0.012500635348260403,0.14330890774726868,-0.21921056509017944,-0.24649864435195923},{-0.280913382768631,0.46286115050315857,0.3959473669528961,0.3708229064941406,-0.4812893569469452,-0.06812261790037155,0.5855963826179504,0.5379161238670349,-0.24626947939395905,0.36207443475723267,-0.7185108065605164,-0.43853333592414856,0.45266616344451904,0.11170533299446106,0.2788984477519989,0.455583781003952},{0.36172401905059814,-0.2691516876220703,0.632677435874939,0.09380766749382019,-0.002798645757138729,0.06668812036514282,0.13991251587867737,-0.637442946434021,-0.25995299220085144,-0.44978201389312744,-0.17836114764213562,-0.00570070743560791,-0.07046268880367279,0.6978671550750732,0.4549104869365692,-0.3070148825645447},{0.21968205273151398,-0.5647289156913757,-0.6355151534080505,-0.3656961917877197,-0.26131370663642883,0.22119013965129852,0.15406548976898193,0.16720455884933472,0.6133776307106018,0.2781464457511902,0.19421395659446716,-0.28722673654556274,-0.09596239775419235,0.4121447503566742,-0.2125660479068756,-0.557479739189148},{0.22216027975082397,0.39904436469078064,0.4051496982574463,-0.6529167294502258,-0.3232129216194153,0.12353968620300293,0.16524891555309296,0.3888319730758667,-0.38587597012519836,0.06097445636987686,-0.1082727313041687,-0.01323671080172062,-0.14276736974716187,-0.1789533495903015,0.24735349416732788,-0.3793596923351288},{-0.05574508756399155,-0.4367366433143616,0.18712124228477478,0.6302021741867065,0.7985212802886963,0.4432821571826935,0.40807467699050903,0.40477102994918823,0.04029529169201851,-0.033147335052490234,0.2677250802516937,-0.4531875550746918,-0.586935818195343,-0.4118700325489044,0.756200909614563,-0.06276856362819672},{-0.2569773197174072,0.4109881520271301,-0.055236849933862686,-0.6055416464805603,0.16589532792568207,0.06305044144392014,0.20290029048919678,0.17833931744098663,0.07621542364358902,0.052323583513498306,0.03484836593270302,0.20318934321403503,0.4035096764564514,0.37174519896507263,-0.08012539148330688,-0.11944001913070679},{0.06861013174057007,-0.4032006859779358,-0.2568003535270691,-0.19474457204341888,-0.46790647506713867,0.01243838481605053,-0.27286070585250854,-0.2976211607456207,-0.22718757390975952,-0.051245637238025665,-0.4507824778556824,-0.028055833652615547,-0.19028012454509735,0.43869274854660034,0.17431509494781494,-0.015788225457072258},{0.06140821799635887,-0.2836916446685791,-0.22460904717445374,0.18438361585140228,-0.07816221565008163,-0.45735853910446167,0.2838740348815918,-0.08783824741840363,-0.03338515758514404,0.3736352324485779,0.054820653051137924,0.039559412747621536,0.29955941438674927,0.0034295462537556887,-0.2915140688419342,0.21733862161636353},{0.3816441595554352,-0.01729826256632805,-0.22152931988239288,-0.1828417330980301,-0.3239891231060028,0.15227042138576508,0.32725176215171814,-0.06972882151603699,0.2136620134115219,0.3431893587112427,-0.15291061997413635,0.06230704113841057,-0.187506303191185,0.24466121196746826,-0.08316946029663086,-0.012285461649298668},{-0.23513785004615784,-0.17191077768802643,0.22606369853019714,0.12097818404436111,-0.20784316956996918,0.0799894854426384,-0.1669810712337494,-0.08497487008571625,-0.20308873057365417,-0.2613596022129059,-0.04123257100582123,-0.2632903456687927,0.09075334668159485,-0.20584933459758759,0.05855904147028923,-0.20312677323818207},{-0.22929610311985016,0.27313658595085144,-0.33045077323913574,-0.21722127497196198,0.05984945967793465,0.32518452405929565,-0.19183042645454407,-0.21194441616535187,0.14477261900901794,0.16508479416370392,0.3160918354988098,-0.12030147016048431,-0.3213141858577728,0.31459808349609375,0.01491975411772728,-0.41711634397506714}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04077962040901184,-0.04467139393091202,-0.10365363210439682,-0.34380292892456055,0.31115370988845825,0.2982665002346039,0.07616711407899857,0.04509634152054787,-0.07999276369810104,-0.1644456684589386,-0.0166772473603487,0.06996190547943115,0.20018255710601807,0.3432236313819885,0.11174720525741577,0.06687440723180771},{-0.17750653624534607,-0.30907657742500305,-0.06603813171386719,0.05234972760081291,0.2252565324306488,-0.2984248101711273,0.025275936350226402,0.058391522616147995,-0.05422891303896904,0.2633810341358185,-0.2537466585636139,0.3169287145137787,-0.38923826813697815,0.20015393197536469,-0.3537285029888153,-0.35011062026023865},{0.03284372016787529,0.20562365651130676,-0.3783051371574402,-0.5135705471038818,0.20280741155147552,0.44611236453056335,-0.08670569211244583,0.06471949815750122,-0.27628445625305176,-0.29783836007118225,-0.012728818692266941,0.33456823229789734,-0.28268253803253174,-0.1592269390821457,0.10319603979587555,-0.07017473131418228},{0.1598280817270279,-0.06426145136356354,0.09057982265949249,0.2071225941181183,-0.46968695521354675,-0.010770994238555431,0.09133413434028625,-0.18789535760879517,0.28514647483825684,0.35863447189331055,-0.1635870635509491,-0.14955970644950867,-0.41124293208122253,-0.3951781690120697,0.18504387140274048,0.17574970424175262},{-0.07238958030939102,0.15198484063148499,0.004901180975139141,0.25946781039237976,-0.23757416009902954,0.0822300985455513,-0.00711095193400979,0.18002156913280487,0.2424844354391098,-0.23548516631126404,0.18059514462947845,0.2466224730014801,0.1796697974205017,-0.4443369209766388,0.013575327582657337,0.016784630715847015},{0.2147311419248581,0.2646399140357971,-0.024143245071172714,0.1885998249053955,-0.49523410201072693,-0.43565791845321655,0.2672259509563446,0.3136967420578003,0.09289737790822983,0.3773198425769806,0.23602600395679474,-0.23065243661403656,-0.00542994262650609,-0.14668497443199158,-0.10245303064584732,0.2969561517238617},{-0.11438951641321182,0.2603614330291748,0.2863806486129761,-0.36623191833496094,-0.25328540802001953,0.007770777214318514,-0.3580540716648102,-0.04364166408777237,0.19460269808769226,0.07465720921754837,-0.1440861076116562,-0.21982839703559875,-0.32034116983413696,-0.031727224588394165,0.1918925940990448,0.027107302099466324},{-0.13543051481246948,-0.14947251975536346,-0.4612555503845215,0.28907468914985657,-0.3131418526172638,-0.22503992915153503,-0.24477578699588776,-0.3945566713809967,0.14428618550300598,-0.2357334941625595,0.051513880491256714,0.08147764205932617,-0.15280471742153168,0.45349493622779846,-0.0654575452208519,-0.3125280439853668},{-0.329112708568573,0.261368066072464,-0.01665017381310463,-0.03453831747174263,0.27671104669570923,-0.2726926803588867,0.29032227396965027,0.14244873821735382,0.3529740273952484,0.30172982811927795,0.2517447769641876,0.31050577759742737,0.1721908003091812,-0.058148398995399475,0.26913607120513916,0.10216683894395828},{0.06592639535665512,-0.26955005526542664,-0.16107836365699768,-0.12738581001758575,0.24819935858249664,-0.16615447402000427,-0.29737943410873413,-0.15587332844734192,0.07510840147733688,-0.3639780580997467,-0.2694911062717438,0.33502674102783203,0.1245349794626236,0.1399262547492981,-0.3789791464805603,0.23592227697372437},{-0.05653946101665497,-0.45289719104766846,0.29773393273353577,0.2850967049598694,0.2510300278663635,0.14828325808048248,0.16813161969184875,-0.129701167345047,0.22095850110054016,-0.25608670711517334,0.19426509737968445,0.3397713601589203,0.5034182071685791,0.11783181130886078,-0.10448633134365082,0.09242463111877441},{0.06120767444372177,-0.006627970840781927,0.41263410449028015,-0.011766888201236725,-0.25337639451026917,-0.17018164694309235,0.43293842673301697,0.3022482693195343,-0.242065891623497,-0.1873820424079895,-0.06829556077718735,-0.35716402530670166,-0.01952987164258957,-0.2853621244430542,-0.3707088828086853,0.08225098252296448},{-0.12834179401397705,-0.31322845816612244,0.42823511362075806,-0.22467157244682312,0.371583491563797,-0.3014063835144043,-0.44790273904800415,0.07443936914205551,0.07479248195886612,0.0664549171924591,-0.33286789059638977,0.1215883120894432,0.10444817692041397,-0.29793861508369446,-0.32605209946632385,0.004328411538153887},{0.36948832869529724,-0.33820265531539917,0.45031872391700745,0.08190669864416122,-0.09915415197610855,0.330409973859787,-0.11606057733297348,-0.22387239336967468,-0.402314156293869,0.11417803913354874,0.01682892069220543,-0.3674483299255371,-0.11648427695035934,0.12119443714618683,0.2982523739337921,0.03402645140886307},{-0.0993824452161789,0.2109677791595459,0.11649636179208755,-0.48296919465065,-0.20331764221191406,0.20368315279483795,0.24330121278762817,-0.2520080506801605,0.21251170337200165,-0.30560752749443054,0.023567410185933113,0.10779975354671478,-0.06878404319286346,0.20086567103862762,0.03370881453156471,0.0770685225725174},{-0.14654943346977234,0.422708660364151,-0.4450514614582062,0.3708624541759491,0.10081764310598373,-0.385124146938324,-0.02567679062485695,-0.06854663044214249,-0.3143250048160553,0.3992946445941925,-0.32365652918815613,0.2730957269668579,-0.08768326789140701,-0.3332463204860687,-0.2019096463918686,-0.4729487895965576}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.14869217574596405,0.11049201339483261,-0.010258245281875134,-0.05416317284107208,-0.11308915913105011,0.01942826621234417,0.27016666531562805,0.08438561856746674,-0.1801580935716629,-0.16026900708675385,0.12936359643936157,-0.27812260389328003,-0.22699619829654694,0.24580101668834686,0.21089287102222443,0.3172760307788849,-0.2659347951412201,-0.27418801188468933,-0.19644182920455933,0.12329272925853729,-0.06701423972845078,-0.3214391767978668,-0.2481870800256729,-0.2785041928291321,-0.23882268369197845,0.14111746847629547,-0.2118629813194275,-0.045863643288612366,-0.05326452851295471,-0.01930813677608967,0.22313986718654633,-0.2184770703315735},{0.29916617274284363,0.14807522296905518,0.1788509041070938,-0.09402304142713547,0.14259697496891022,-0.138027623295784,0.3813915252685547,0.13691669702529907,-0.12833000719547272,-0.08804473280906677,-0.1300947368144989,-0.2725644111633301,-0.17080824077129364,0.25676631927490234,-0.2632044851779938,-0.19749632477760315,-0.03784480690956116,0.19958677887916565,-0.37022003531455994,-0.2286379337310791,-0.03530571237206459,0.22028830647468567,0.02433636039495468,0.03265587240457535,0.2198614627122879,-0.34597381949424744,-0.05623363330960274,0.07324334979057312,0.17153732478618622,-0.11379557102918625,-0.06080963835120201,0.19971713423728943},{0.166769877076149,0.045261699706315994,-0.14662860333919525,0.13538973033428192,-0.16222946345806122,-0.16357146203517914,-0.2084009051322937,0.056198012083768845,-0.16010700166225433,0.3584598898887634,-0.31596946716308594,-0.2854233682155609,0.16153131425380707,-0.4011354148387909,-0.1603170931339264,0.10223828256130219,-0.09921346604824066,-0.12451768666505814,0.17611977458000183,-0.09505417943000793,0.24268004298210144,0.2828635573387146,-0.2397395223379135,0.024026554077863693,-0.2677663266658783,-0.016917759552598,0.12462769448757172,-0.07399474084377289,-0.03837836533784866,-0.23041178286075592,-0.1253746896982193,-0.08669648319482803},{0.41423362493515015,0.049055274575948715,0.15562795102596283,-0.1844407171010971,-0.2535178065299988,-0.049565255641937256,-0.1458624005317688,0.2910989224910736,0.24474358558654785,-0.30455127358436584,-0.07578931748867035,0.2859456539154053,0.1119205579161644,-0.03158547356724739,-0.24782061576843262,0.30135416984558105,-0.29619503021240234,0.2641333341598511,0.027732577174901962,0.12978233397006989,-0.1021650955080986,-0.10695064067840576,0.28222107887268066,0.16600416600704193,0.18286505341529846,-0.38326773047447205,0.2617136836051941,-0.2136126309633255,-0.0651245042681694,0.08362177014350891,-0.19614717364311218,0.13390512764453888},{-0.06767456233501434,-0.07349195331335068,-0.11210194230079651,0.12547749280929565,0.2180260270833969,-0.1485048234462738,-0.4168175458908081,-0.08774559944868088,-0.10615337640047073,-0.31020015478134155,0.1424940526485443,0.2446269690990448,-0.03827650099992752,-0.111712746322155,-0.09714733809232712,0.11898041516542435,-0.017765330150723457,-0.04230312258005142,-0.30850204825401306,-0.19818802177906036,-0.16656401753425598,-0.3631379008293152,0.14023208618164062,0.14261536300182343,-0.10108652710914612,0.35221344232559204,-0.18018010258674622,0.20467258989810944,0.3241082727909088,0.38871046900749207,-0.03018857352435589,0.3856370151042938},{-0.2958979904651642,0.017823105677962303,-0.22793464362621307,-0.05260305479168892,-0.20817358791828156,0.2421410232782364,0.1991676241159439,0.014000561088323593,0.25900107622146606,0.23621805012226105,0.3349400758743286,-0.22728675603866577,-0.26571276783943176,0.19124175608158112,0.3346427083015442,-0.33322975039482117,-0.1273527592420578,-0.25817686319351196,0.2246963530778885,0.09403406083583832,0.09018150717020035,0.17882533371448517,0.06979403644800186,-0.08145853877067566,-0.35637128353118896,0.36505812406539917,-0.14274463057518005,0.20697377622127533,0.3529227674007416,0.18477480113506317,0.0575866624712944,0.022254489362239838},{0.20892317593097687,-0.15386442840099335,-0.12170194834470749,-0.325818806886673,-0.04524463042616844,0.23204420506954193,0.3151533901691437,0.17993168532848358,0.09515129774808884,0.3470587432384491,-0.013157155364751816,-0.028581781312823296,-0.4367118775844574,-0.16392691433429718,-0.16564178466796875,0.16463306546211243,-0.2645626366138458,-0.2213072031736374,0.21123847365379333,-0.07232402265071869,-0.13192303478717804,-0.1531466692686081,-0.24170775711536407,-0.20796920359134674,0.1467769294977188,-0.23616956174373627,-0.09091930091381073,-0.20350927114486694,0.29214608669281006,0.12534968554973602,-0.1649935245513916,-0.3049578070640564},{0.021837975829839706,0.14937083423137665,0.06611401587724686,-0.01718277856707573,0.1253826767206192,-0.32690054178237915,-0.11705277115106583,-0.16670052707195282,-0.01379238348454237,-0.24005429446697235,-0.3196299374103546,-0.04979691281914711,-0.12110891193151474,-0.011582530103623867,-0.1324067860841751,0.3824548125267029,-0.012231719680130482,-0.15848572552204132,0.11073776334524155,0.3414470851421356,-0.10941649228334427,-0.24123023450374603,0.24973085522651672,0.10325919091701508,-0.037995461374521255,-0.3189193308353424,-0.31273597478866577,-0.314107745885849,-0.3495045304298401,-0.2417086958885193,0.041065290570259094,-0.31157955527305603},{0.09467814117670059,0.3201043903827667,-0.2613801658153534,-0.3171152174472809,-0.22535932064056396,0.07392677664756775,0.06298532336950302,0.07720373570919037,0.13913384079933167,-0.2872861623764038,-0.20688852667808533,0.33337336778640747,-0.24108265340328217,-0.1963489055633545,0.19847281277179718,-0.2724916636943817,0.2706654965877533,0.15747958421707153,0.3462943732738495,0.03250926360487938,0.21347792446613312,0.06102275103330612,0.2640599012374878,-0.09080379456281662,0.37687602639198303,-0.21868538856506348,0.12251432240009308,0.33288538455963135,-0.28862470388412476,0.22507473826408386,-0.009153918363153934,0.15534281730651855},{-0.1740580052137375,0.11796022206544876,-0.23013566434383392,-0.1736338883638382,0.1913297325372696,-0.15329845249652863,0.09795897454023361,-0.004148824140429497,0.1572997272014618,-0.04502502456307411,-0.28036561608314514,-0.29271507263183594,-0.31893011927604675,-0.04881846159696579,-0.25491079688072205,0.1025945395231247,0.07228801399469376,-0.19078361988067627,0.25903376936912537,0.11002089828252792,-0.003669148311018944,-0.012802166864275932,0.2703573703765869,-0.19185929000377655,0.31773900985717773,0.09362756460905075,-0.26725438237190247,0.013782400637865067,-0.04342205077409744,0.13296836614608765,-0.11287978291511536,0.08886367082595825},{0.08944451063871384,0.021972613409161568,0.2078118473291397,-0.27572256326675415,-0.32843026518821716,-0.2441994547843933,-0.2701604962348938,0.004246412310749292,-0.21846076846122742,0.4424351751804352,0.14991314709186554,-0.24551475048065186,-0.3908589780330658,-0.045596808195114136,-0.21664392948150635,-0.08919434249401093,0.20868125557899475,-0.16056545078754425,0.270103394985199,-0.14972852170467377,-0.18740738928318024,0.0023494127672165632,0.16698057949543,0.23399439454078674,0.16753627359867096,-0.12676003575325012,-0.0006523910560645163,-0.08942171931266785,-0.06156791001558304,0.021054530516266823,-0.034616004675626755,0.12257423996925354},{-0.16586117446422577,-0.1393587440252304,0.2196786254644394,0.29351696372032166,0.27552440762519836,-0.053334981203079224,0.07203506678342819,-0.22260890901088715,-0.013921506702899933,-0.26765120029449463,0.2577762305736542,-0.22222726047039032,-0.1874447613954544,-0.19635608792304993,0.23984269797801971,-0.001039828173816204,-0.006278501823544502,0.018346071243286133,0.35566774010658264,0.050311408936977386,-0.17810307443141937,0.2094026505947113,0.09762933850288391,-0.05471356585621834,0.2403019368648529,-0.09691447019577026,-0.18176022171974182,0.2048368602991104,0.1510658711194992,0.019648578017950058,-0.30628812313079834,-0.23058103024959564},{0.30159512162208557,-0.2647959291934967,0.0017018804792314768,-0.31773948669433594,-0.026903435587882996,-0.16491536796092987,0.11034891754388809,0.16047947108745575,0.21759653091430664,0.0705631822347641,0.18725162744522095,0.25635281205177307,-0.4326261878013611,-0.3602096438407898,-0.036662060767412186,-0.21387754380702972,-0.2610704302787781,-0.31148651242256165,0.3202437460422516,-0.174220010638237,0.33830124139785767,-0.10728642344474792,0.00968775525689125,0.19666841626167297,0.12978415191173553,-0.11416424065828323,0.1275496482849121,0.030039582401514053,0.09800883382558823,-0.012420909479260445,-0.2816675007343292,0.004197818227112293},{0.26332977414131165,-0.037111856043338776,-0.01566160097718239,0.3550684452056885,-0.09352822601795197,-0.16753259301185608,-0.032874271273612976,0.1678272783756256,0.191236674785614,0.24369730055332184,0.12591136991977692,-0.12329277396202087,0.06022452563047409,0.21263659000396729,-0.11640049517154694,0.11549098044633865,0.23869845271110535,-0.23524464666843414,0.11707358062267303,-0.34461548924446106,0.2541806399822235,0.15815843641757965,-0.09497399628162384,0.2024374157190323,0.2490510195493698,0.07906576991081238,0.15181122720241547,0.09725069999694824,0.07848676294088364,-0.1368786245584488,0.030027691274881363,0.362819105386734},{0.07551833242177963,-0.20162944495677948,0.010889503173530102,0.10146395117044449,-0.2790513336658478,4.5284937755241117e-07,0.04220344126224518,-0.21594740450382233,-0.15780717134475708,-0.030026661232113838,0.1778472661972046,0.21109585464000702,0.09778480231761932,0.24924500286579132,-0.03879059478640556,-0.03336601331830025,-0.21654489636421204,0.2648811340332031,-0.06632582098245621,-0.22135010361671448,-0.21307967603206635,-0.10566852986812592,0.13525094091892242,0.04492280259728432,-0.001030611339956522,-0.14375707507133484,-0.17803025245666504,0.21895113587379456,0.054261986166238785,-0.13987194001674652,0.269207626581192,0.1655963957309723},{0.17353780567646027,-0.23138201236724854,0.019648123532533646,-0.19520823657512665,-0.011176740750670433,0.15655013918876648,0.07159153372049332,0.26790452003479004,-0.0962642952799797,-0.027018053457140923,0.2200433760881424,0.11896022409200668,0.055520929396152496,-0.09692950546741486,-0.013340918347239494,0.20695768296718597,-0.3361814618110657,-0.18503694236278534,-0.03474435210227966,0.08045763522386551,0.037118639796972275,0.2510444223880768,0.14748986065387726,0.18969617784023285,0.06410039961338043,0.1766195297241211,-0.02365812472999096,-0.05735050514340401,0.08593402057886124,-0.09943325817584991,-0.25050753355026245,0.31302163004875183},{0.1557781994342804,0.021481862291693687,-0.3623596727848053,0.11213938891887665,0.05183667689561844,-0.038859833031892776,0.3343196511268616,0.11079905927181244,0.09902215003967285,-0.11040128767490387,0.20917189121246338,-0.2541559934616089,-0.4111773371696472,0.24707315862178802,0.08344680815935135,0.06012130156159401,-0.01780991442501545,-0.09368845820426941,-0.1587468981742859,0.06831114739179611,-0.04047580808401108,0.2274094521999359,0.09653759747743607,-0.16672448813915253,-0.07648610323667526,-0.22585149109363556,0.06602345407009125,0.3353494703769684,0.2183607965707779,-0.20193734765052795,0.1849098801612854,0.1720268279314041},{-0.07294660806655884,0.004473358392715454,-0.07729008048772812,-0.07491106539964676,-0.2303016632795334,-0.03741837665438652,0.21706748008728027,0.17289714515209198,0.14116023480892181,0.012268715538084507,0.1806396096944809,-0.007090607658028603,0.2438315749168396,0.2046915888786316,0.17182877659797668,-0.10437413305044174,0.12117016315460205,0.1952226459980011,0.21278564631938934,0.05006926506757736,0.19650517404079437,0.2770221531391144,0.0778602734208107,0.16769501566886902,-0.028095120564103127,-0.06991370767354965,-0.13879378139972687,-0.24986158311367035,0.13508492708206177,-0.2732001543045044,0.03057641163468361,-0.06238880753517151},{-0.3418516218662262,0.03664979711174965,-0.33717989921569824,-0.3315095901489258,0.03949464485049248,-0.006985302083194256,0.13292425870895386,-0.16831345856189728,0.06485144793987274,0.353290319442749,0.017078274860978127,-0.23386399447917938,0.0624970979988575,-0.18701526522636414,-0.31670594215393066,0.019187474623322487,-0.1719452142715454,0.12494385987520218,-0.07787542790174484,0.009490365162491798,-0.29975461959838867,0.1587461233139038,0.10178670287132263,0.05254322290420532,-0.0848221555352211,0.3453652262687683,0.04154354706406593,-0.20501422882080078,-0.2013595551252365,0.010086088441312313,-0.21149899065494537,-0.26422908902168274},{-0.00850034598261118,-0.26083338260650635,-0.2841656804084778,-0.05067967623472214,-0.3263501524925232,-0.14571596682071686,0.1837044209241867,-0.27893176674842834,-0.22370439767837524,0.17752951383590698,0.1986795961856842,0.08833573758602142,0.11796383559703827,-0.15115810930728912,0.27873334288597107,-0.2692393660545349,0.09281707555055618,0.25880205631256104,0.04717625677585602,0.27675479650497437,0.009768097661435604,-0.11828160285949707,-0.2798425555229187,0.22284777462482452,-0.11500822752714157,-0.15578240156173706,0.11969725787639618,0.04375284165143967,-0.11894835531711578,-0.32753244042396545,-0.03245201334357262,-0.19075657427310944},{0.22517412900924683,0.09808402508497238,-0.05728207156062126,0.22700925171375275,-0.2357914298772812,0.09249751269817352,-0.08801402151584625,-0.2021094113588333,-0.08252836018800735,0.21543362736701965,-0.3466949462890625,-0.145342618227005,0.029240215197205544,-0.20652256906032562,-0.39493528008461,-0.16275252401828766,-0.11476577073335648,-0.3237500786781311,-0.2659819722175598,0.2197754979133606,0.15162253379821777,0.07975634932518005,-0.3873649835586548,0.3277736306190491,0.14073479175567627,0.307512491941452,-0.32016468048095703,-0.11828554421663284,0.08565500378608704,-0.20867609977722168,0.10072296112775803,0.17369061708450317},{-0.050972986966371536,-0.3025120198726654,-0.04612540453672409,-0.3098929524421692,-0.0714503824710846,0.2954900860786438,0.2073897272348404,0.034394919872283936,-0.10427159816026688,0.013160345144569874,-0.15525038540363312,0.09907021373510361,0.10237425565719604,0.060231756418943405,0.11668456345796585,0.03693818673491478,-0.08245781809091568,0.14212489128112793,-0.11541780829429626,0.15103599429130554,0.18906813859939575,0.25493425130844116,-0.03404931724071503,-0.2473335862159729,0.16949471831321716,0.1580321341753006,0.28117838501930237,0.16914117336273193,0.023238148540258408,0.10902994126081467,0.018017446622252464,-0.10538051277399063},{-0.02838672325015068,-0.2011723816394806,0.2168206423521042,0.06038674712181091,0.2670074701309204,-0.015713676810264587,-0.1278790980577469,-0.19650843739509583,0.12381879985332489,-0.03981521725654602,0.09049021452665329,0.005309420637786388,-0.3406740427017212,0.055068258196115494,-0.08446038514375687,-0.26033443212509155,-0.047569140791893005,-0.06570645421743393,0.18020427227020264,0.19040942192077637,0.02398228459060192,0.05716327205300331,0.17551839351654053,0.2893202006816864,-0.19234825670719147,-0.037319011986255646,0.17868560552597046,-0.06430880725383759,-0.13451449573040009,-0.26612111926078796,0.2980285882949829,0.018385669216513634},{0.18809810280799866,-0.08259779214859009,0.03832801431417465,0.10405591875314713,-0.022322220727801323,0.0446891188621521,-0.23423850536346436,0.2991091012954712,-0.11470954865217209,-0.020749837160110474,0.11668167263269424,-0.3133144676685333,0.07624443620443344,-0.05514313653111458,-0.12274236232042313,0.31402289867401123,-0.08761574327945709,-0.1757398098707199,0.01391725242137909,0.013435961678624153,-0.17617814242839813,0.1729792356491089,0.2173164039850235,0.25029224157333374,-0.2680007815361023,0.12151984870433807,-0.08153010904788971,0.06666834652423859,-0.26703277230262756,0.23757219314575195,-0.061159633100032806,0.03077966906130314}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.23144663870334625,-0.12729312479496002,0.0814911276102066,-0.15954607725143433},{0.2036389708518982,-0.24928627908229828,0.2727305591106415,0.22737731039524078},{-0.27275481820106506,0.04012211039662361,0.1066165566444397,-0.03561791777610779},{0.29633811116218567,0.43964940309524536,0.3194947838783264,0.03543497249484062},{-0.27719613909721375,0.15631988644599915,-0.272316038608551,0.12674540281295776},{0.02070434018969536,-0.09145914763212204,0.0866587832570076,0.3064671754837036},{-0.11231564730405807,-0.18395964801311493,-0.37134283781051636,-0.037531547248363495},{-0.11520451307296753,-0.3557921350002289,0.1510588675737381,-0.06232646107673645},{-0.11552035808563232,0.16009677946567535,-0.08624660223722458,-0.103184275329113},{0.24737417697906494,-0.012189331464469433,-0.10767882317304611,-0.18817882239818573},{0.2296605110168457,-0.19807074964046478,0.3053719401359558,0.24059472978115082},{-0.04106677696108818,0.0018588221864774823,0.3975279629230499,-0.08795620501041412},{-0.30691391229629517,0.23803038895130157,-0.03975195065140724,-0.08453939110040665},{-0.17314589023590088,0.007131057325750589,-0.21821561455726624,0.06215101480484009},{0.20176999270915985,-0.04298447072505951,0.23338539898395538,0.08159491419792175},{-0.1448519229888916,-0.2840392291545868,-0.1248968243598938,-0.08099330216646194},{-0.2644922137260437,0.05326475948095322,-0.050059329718351364,0.3037913739681244},{-0.2752656638622284,-0.1386997252702713,-0.22687023878097534,0.1962190717458725},{-0.076229028403759,-0.11953949183225632,0.38027262687683105,0.06951555609703064},{-0.14468137919902802,-0.17040938138961792,-0.020455755293369293,-0.17596536874771118},{0.1611189991235733,0.124055877327919,0.12772779166698456,-0.15819929540157318},{-0.004520106595009565,-0.2675061523914337,-0.15843059122562408,0.2653506398200989},{0.2861178517341614,-0.15813271701335907,0.17904818058013916,0.03483651578426361},{-0.27653542160987854,-0.0752587839961052,-0.2889479994773865,-0.2272428572177887},{-0.26023200154304504,-0.17092518508434296,-0.001717720297165215,-0.12727054953575134},{0.19872525334358215,0.19433008134365082,-0.06947354972362518,0.1545630693435669},{0.1913568377494812,-0.21314352750778198,0.23205126821994781,0.08595923334360123},{-0.0451994314789772,-0.15968981385231018,0.016741767525672913,0.3077499568462372},{0.05872449278831482,0.04463658481836319,0.03288267180323601,0.019055163487792015},{-0.16606123745441437,0.10532698780298233,0.2530688941478729,0.01663103513419628},{-0.13892748951911926,-0.13914792239665985,0.09618707001209259,0.2061937302350998},{0.20016930997371674,0.22077538073062897,0.2548956274986267,-0.02171793021261692}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05522215738892555,-1.2142320883867797e-05,-0.005533004179596901,0.045809876173734665,0.04110082983970642,-0.05559641122817993,-0.00560747878625989,0.06199982762336731,-0.06929579377174377,-0.07049909979104996,-0.004297698847949505,0.04714610055088997,-0.023481976240873337,0.05212002620100975,-0.021884189918637276,-0.028059083968400955};
static const float actor_encoder_self_encoder_2_bias[16] = {0.006637547165155411,-0.013588910922408104,-0.014464614912867546,-0.006544496398419142,-0.051436543464660645,0.01851331628859043,-0.02792193368077278,-0.005414353683590889,0.02095506340265274,-0.03636196255683899,0.003570505417883396,-0.015810202807188034,-0.011914219707250595,-0.02860904671251774,-0.01480927225202322,-0.03571252524852753};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0017289267852902412,0.06054650992155075,-0.018552308902144432,0.015347059816122055,-0.017345882952213287,0.028093881905078888,-0.04288867861032486,-0.012315639294683933,-0.018208879977464676,-0.022195616737008095,-0.004001001827418804,0.031291037797927856,0.009950668551027775,0.009345119819045067,0.05047545209527016,-0.047265537083148956,0.013575345277786255,-0.008423545397818089,0.01968337409198284,-0.034570254385471344,-0.004316455218940973,0.029024705290794373,0.0013020890764892101,-0.043756429105997086,-0.05555073544383049,0.017540523782372475,0.024376487359404564,0.027198094874620438,-0.007914599031209946,0.02340116538107395,0.027270814403891563,0.003998492378741503};
static const float action_parameterization_distribution_linear_bias[4] = {0.008096965029835701,0.014488033019006252,0.012541444040834904,0.033242594450712204};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4023846983909607,-0.3862095773220062,-0.13609327375888824,0.22459210455417633,-0.20235013961791992,0.10738147795200348,-0.3187989890575409,0.043393682688474655},{0.19976073503494263,0.10552673786878586,0.4018910527229309,0.37805700302124023,-0.12593458592891693,-0.34020620584487915,0.31564047932624817,0.39357104897499084},{0.06538458913564682,0.16193756461143494,0.11376796662807465,-0.048527464270591736,0.33029159903526306,0.22654318809509277,-0.008956131525337696,0.23671749234199524},{0.1137884259223938,-0.3815367519855499,0.3406510353088379,-0.15529540181159973,-0.22999830543994904,0.10726141929626465,0.32016417384147644,0.2514910399913788},{-0.24760432541370392,-0.09610333293676376,-0.03959113359451294,-0.2671014964580536,0.1453389674425125,0.13214436173439026,0.3593088388442993,0.28134775161743164},{-0.047396913170814514,0.18235214054584503,0.001274855574592948,-0.1919524222612381,0.3458889424800873,0.1264730542898178,0.13043949007987976,-0.16152864694595337},{0.01114596426486969,0.14547136425971985,0.1484881490468979,-0.14125365018844604,0.4348134696483612,-0.10240725427865982,0.16891473531723022,0.0991113930940628},{0.05660654231905937,-0.4669175148010254,-0.027211397886276245,-0.22329920530319214,0.2889167070388794,0.04996613413095474,-0.15625718235969543,-0.33883312344551086},{-0.258741170167923,0.14746326208114624,0.004546452313661575,-0.07509562373161316,0.016079407185316086,0.4563705027103424,0.39264172315597534,0.2894989848136902},{-0.002368952613323927,-0.15620645880699158,-0.271744042634964,0.2831706702709198,0.2916124165058136,0.32175198197364807,0.3612591028213501,-0.32615914940834045},{-0.1605282872915268,-0.39539244771003723,0.3612343668937683,0.18700507283210754,0.019621215760707855,-0.26518434286117554,0.0477900505065918,-0.3337436020374298},{0.24153059720993042,0.016631653532385826,0.4115599989891052,0.41154035925865173,-0.10785578936338425,0.3299032747745514,0.22866538166999817,-0.3324107229709625},{-0.38096684217453003,0.12540872395038605,-0.34914860129356384,0.4439452588558197,-0.020770590752363205,0.425151526927948,0.014939352869987488,0.2614154815673828},{-0.06012612208724022,0.1623813509941101,-0.13249017298221588,-0.11170221865177155,0.015065629966557026,0.15824314951896667,0.29246166348457336,-0.002430929336696863},{0.11662924289703369,-0.3551182448863983,-0.3551189601421356,-0.17051374912261963,0.12504050135612488,-0.14960555732250214,0.10559401661157608,-0.1127002164721489},{-0.4707818031311035,-0.352844774723053,-0.28590214252471924,-0.01201284397393465,-0.057503633201122284,0.2261982411146164,0.1769898384809494,-0.11573111265897751},{-0.18205370008945465,-0.33853521943092346,0.23179630935192108,-0.35986414551734924,-0.005323341581970453,0.045932184904813766,-0.43071964383125305,-0.3033376634120941},{0.06375814229249954,0.20146259665489197,0.1359565258026123,0.19792063534259796,-0.12025013566017151,0.3374355137348175,0.27448445558547974,-0.2186451554298401},{0.06593292951583862,-0.353950172662735,-0.07926639914512634,-0.05215926840901375,-0.15082363784313202,-0.3406429588794708,0.03618477284908295,-0.3119506239891052},{-0.02841779589653015,-0.017104540020227432,0.1027621328830719,-0.2975614368915558,0.0401189923286438,0.11686205863952637,0.07444220036268234,-0.14319108426570892},{0.10186632722616196,-0.12338704615831375,0.06185505539178848,-0.25317445397377014,-0.01217056903988123,-0.005720510147511959,-0.03194398060441017,-0.26631686091423035},{-0.30660247802734375,0.15797001123428345,0.1330001801252365,-0.23099511861801147,-0.4781193137168884,0.007140152156352997,0.1329885870218277,-0.01424221508204937},{0.30098575353622437,0.0926726832985878,-0.43252646923065186,0.13069817423820496,-0.07395316660404205,0.21935483813285828,0.23564989864826202,0.2715265154838562},{0.028689753264188766,-0.13629662990570068,-0.030787983909249306,0.3226356506347656,-0.32744100689888,-0.07265222072601318,-0.15429159998893738,-0.3342631459236145},{0.22735923528671265,0.05998847261071205,-0.4696979522705078,0.338822603225708,-0.3091958463191986,-0.3501313626766205,-0.333717942237854,0.15867562592029572},{0.06484261900186539,0.3323184847831726,-0.32602575421333313,-0.047794148325920105,0.07565245777368546,-0.2543400228023529,0.3279259204864502,-0.29399245977401733},{-0.05318119749426842,0.03876379132270813,-0.1650698184967041,-0.13173089921474457,0.03265316039323807,-0.18418416380882263,-0.08191946148872375,-0.14045193791389465},{0.16773077845573425,-0.20139171183109283,-0.06132090464234352,-0.08211009949445724,0.006535599008202553,0.00015300801896955818,-0.18821246922016144,0.09133940935134888},{0.3789480924606323,0.02692631632089615,-0.4007266163825989,-0.1755806803703308,-0.2531488537788391,0.10180079936981201,0.24591964483261108,0.07674403488636017},{0.4194057285785675,-0.3222126066684723,-0.03563002869486809,-0.022942980751395226,0.11100242286920547,-0.12902921438217163,0.221763014793396,0.3403310179710388},{-0.21528300642967224,-0.1802702397108078,0.03150791674852371,-0.22556692361831665,0.329012006521225,-0.2610678970813751,0.05978221073746681,0.09331812709569931},{0.22403432428836823,0.011187338270246983,-0.1451587677001953,0.3701304495334625,0.09105753153562546,0.00505455955862999,-0.022262118756771088,0.03938397020101547}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24398735165596008,0.4032628536224365,-0.6101405024528503,-0.5552473664283752,-0.26394596695899963,0.055672407150268555,-0.4163227677345276,0.5400196313858032},{-0.03521314635872841,0.5409680604934692,-0.21467573940753937,0.5075278282165527,-0.015268704853951931,0.038244571536779404,-0.24562087655067444,-0.0019766760524362326},{-0.46199771761894226,-0.19833295047283173,-0.1612689048051834,-0.23842744529247284,0.5259303450584412,0.1785513460636139,0.002809428609907627,0.43371811509132385},{-0.4772874712944031,-0.45083460211753845,0.279617041349411,0.37764444947242737,-0.5270952582359314,-0.17507636547088623,0.4827447533607483,0.18876118957996368},{-0.29463860392570496,-0.3302288055419922,-0.30038386583328247,-0.30499961972236633,0.3226636052131653,-0.27767813205718994,0.4837939441204071,-0.43515950441360474},{-0.08162146806716919,0.16157415509223938,0.29934921860694885,-0.5514572262763977,0.5376309156417847,-0.3127959966659546,-0.41596707701683044,-0.302883118391037},{-0.4133577346801758,0.15949967503547668,0.07200878113508224,-0.3508724570274353,-0.02652759663760662,-0.5380022525787354,0.5034990906715393,0.07297015190124512},{-0.3893723785877228,-0.3098697066307068,-0.21875730156898499,-0.43228796124458313,-0.3042789399623871,0.09984175860881805,0.47039347887039185,-0.3084903359413147}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.02633301168680191,-0.06473001837730408,-0.0158732607960701,0.015900110825896263,-0.03585393354296684,-0.013712205924093723,-0.08401831239461899,0.012540156953036785};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011797918938100338,-0.049240127205848694,-0.015212209895253181,0.070773646235466,-0.028726376593112946,0.033189401030540466,-0.03764253854751587,0.047344010323286057};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

