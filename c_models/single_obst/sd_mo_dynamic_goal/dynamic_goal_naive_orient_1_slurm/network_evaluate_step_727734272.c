#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.33355435729026794,-0.10826893150806427,0.29974615573883057,0.1351572871208191,-0.2800450921058655,0.2972998023033142,0.00045442150440067053,-0.13410751521587372,0.12152942270040512,0.3258877694606781,0.11182218790054321,0.02531035989522934,0.22225438058376312,-0.23391222953796387,0.2772475779056549,-0.038223348557949066},{-0.1833842545747757,-0.4281558096408844,0.32592901587486267,0.08394024521112442,-0.2099580615758896,0.1620337814092636,-0.41985026001930237,-0.05164448916912079,-0.099148228764534,-0.18950997292995453,0.03613646328449249,-0.19729314744472504,-0.005529622547328472,-0.32516810297966003,-0.28264036774635315,0.1221628487110138},{-0.11254695057868958,-0.23214003443717957,-0.46761831641197205,0.179510697722435,0.25133034586906433,0.584690272808075,0.04581448808312416,-0.04441572725772858,0.12159287184476852,-0.5233323574066162,-0.3945856988430023,0.8118323683738708,-0.2433868944644928,-0.30322742462158203,-0.388566792011261,0.2837873101234436},{0.17203167080879211,0.2543853521347046,0.36510568857192993,-0.013342228718101978,-0.38307586312294006,-0.01800118386745453,0.26727747917175293,0.07598648965358734,0.32050439715385437,-0.3163580298423767,0.008746018633246422,0.4242437183856964,-0.2494857758283615,-0.01461107563227415,0.48321470618247986,-0.4592582881450653},{-0.06978600472211838,0.018321288749575615,0.30684131383895874,-0.0681576058268547,0.3153870701789856,0.4442872703075409,0.15513697266578674,-0.019815683364868164,0.1295497715473175,0.2049654871225357,0.26933953166007996,-0.3403266668319702,-0.18530958890914917,-0.4349595010280609,0.3758741319179535,0.09655195474624634},{-0.2785399854183197,-0.18862806260585785,-0.20951610803604126,-0.0562124140560627,0.19121143221855164,0.2111448496580124,0.03130381181836128,-0.12922145426273346,0.3391677737236023,-0.3233611285686493,-0.4434782564640045,0.2493668794631958,0.10818744450807571,-0.13529446721076965,-0.03348052501678467,0.08458295464515686},{0.060378298163414,0.11391278356313705,0.019571764394640923,-0.4215501546859741,0.20801138877868652,-0.02557314746081829,0.06811341643333435,0.37436819076538086,0.34436294436454773,0.054522931575775146,-0.41541290283203125,-0.057134609669446945,-0.024801669642329216,0.1463388055562973,-0.22787407040596008,-0.23805546760559082},{-0.2805939018726349,0.4632555842399597,0.4138505458831787,0.36576828360557556,-0.5055246949195862,-0.0876636877655983,0.5641065835952759,0.5459117889404297,-0.23510676622390747,0.3395395278930664,-0.7112847566604614,-0.4561067521572113,0.47536683082580566,0.09041187912225723,0.29656991362571716,0.44823288917541504},{0.3824400007724762,-0.2797633409500122,0.6264011859893799,0.07271048426628113,-0.008513808250427246,0.05533362925052643,0.10092940926551819,-0.6682487726211548,-0.25127843022346497,-0.4248713254928589,-0.17284974455833435,0.020919112488627434,-0.03845875710248947,0.7306317687034607,0.4391106069087982,-0.30080410838127136},{0.22328072786331177,-0.5626170635223389,-0.643751323223114,-0.38495349884033203,-0.2411058396100998,0.24195192754268646,0.14211255311965942,0.13884295523166656,0.6002032160758972,0.26712557673454285,0.20201747119426727,-0.2759818732738495,-0.11376398801803589,0.4617501497268677,-0.21096037328243256,-0.5986339449882507},{0.23518885672092438,0.4184175431728363,0.38061127066612244,-0.6494092345237732,-0.3422064185142517,0.14331993460655212,0.1717180609703064,0.3806537091732025,-0.4027552604675293,0.037478968501091,-0.07210896164178848,-0.028417399153113365,-0.13323794305324554,-0.1634199321269989,0.23731911182403564,-0.4094184339046478},{-0.0656198039650917,-0.4499334692955017,0.18074928224086761,0.6461575031280518,0.8192417025566101,0.47055959701538086,0.4442860782146454,0.42340517044067383,0.0521715022623539,-0.04994622990489006,0.25523093342781067,-0.45249873399734497,-0.6243639588356018,-0.43639522790908813,0.7798856496810913,-0.046004828065633774},{-0.23997779190540314,0.39151570200920105,-0.04770812392234802,-0.5784204006195068,0.1781301349401474,0.06876462697982788,0.22294725477695465,0.20234493911266327,0.046796321868896484,0.025459375232458115,0.04015873745083809,0.2057606428861618,0.33655846118927,0.3478747308254242,-0.0936492383480072,-0.11493265628814697},{0.07221554964780807,-0.3830064535140991,-0.26659712195396423,-0.19825951755046844,-0.47120508551597595,0.011423350311815739,-0.30844646692276,-0.2920563817024231,-0.2290320247411728,-0.006218180991709232,-0.4588661193847656,-0.028464075177907944,-0.17876145243644714,0.3971881866455078,0.14775647222995758,-0.01719064451754093},{0.060830358415842056,-0.27739495038986206,-0.24445956945419312,0.18121199309825897,-0.11629847437143326,-0.44532471895217896,0.28935298323631287,-0.11156850308179855,-0.029859531670808792,0.3592105507850647,0.08881133049726486,0.0492468997836113,0.298989474773407,0.02350430004298687,-0.2927705943584442,0.19541099667549133},{0.3792291581630707,-0.010409465059638023,-0.22490103542804718,-0.1745898723602295,-0.31851062178611755,0.16373080015182495,0.31947803497314453,-0.07134457677602768,0.20446112751960754,0.35943084955215454,-0.15123602747917175,0.05688048154115677,-0.17812320590019226,0.23684196174144745,-0.0829162746667862,-0.017044303938746452},{-0.24107949435710907,-0.1886197328567505,0.23886460065841675,0.1292790323495865,-0.2040860503911972,0.07081285864114761,-0.14460797607898712,-0.09174845367670059,-0.19612924754619598,-0.26778438687324524,-0.02942715398967266,-0.2651059627532959,0.08363352715969086,-0.20105887949466705,0.06532830744981766,-0.22220152616500854},{-0.20970574021339417,0.255814790725708,-0.3106900155544281,-0.2079184353351593,0.05068383738398552,0.30919399857521057,-0.18255460262298584,-0.1989780068397522,0.1440436691045761,0.14225426316261292,0.33590835332870483,-0.12935423851013184,-0.31572261452674866,0.31273892521858215,0.01239097025245428,-0.4009498953819275}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.040450319647789,-0.045277297496795654,-0.09233294427394867,-0.35319840908050537,0.30738428235054016,0.2968973219394684,0.07470948249101639,0.044339582324028015,-0.08292403817176819,-0.1571340262889862,-0.009472583420574665,0.07787173241376877,0.1927419900894165,0.33526304364204407,0.11838413029909134,0.05260680615901947},{-0.17073024809360504,-0.3075060546398163,-0.05747978016734123,0.04235761612653732,0.232421413064003,-0.29883870482444763,0.028742734342813492,0.058359693735837936,-0.05440385639667511,0.2668602764606476,-0.2419312447309494,0.31747275590896606,-0.38887614011764526,0.19335263967514038,-0.31286707520484924,-0.3584643602371216},{0.03865054249763489,0.2142019122838974,-0.3836469352245331,-0.5082406997680664,0.20068825781345367,0.4401780068874359,-0.08509380370378494,0.06678009033203125,-0.2725636959075928,-0.27840355038642883,-0.014673573896288872,0.3303985595703125,-0.28290581703186035,-0.15231899917125702,0.10033667087554932,-0.06551974266767502},{0.15686649084091187,-0.06329160183668137,0.08849544823169708,0.19051997363567352,-0.4599596858024597,-0.0085354158654809,0.0770147517323494,-0.19019556045532227,0.28290867805480957,0.36556577682495117,-0.16879799962043762,-0.15168151259422302,-0.41451969742774963,-0.38813257217407227,0.20134882628917694,0.17307281494140625},{-0.059235528111457825,0.15261469781398773,0.008398767560720444,0.2629890441894531,-0.23297704756259918,0.09115783125162125,-0.010473470203578472,0.17566706240177155,0.2442510575056076,-0.22945857048034668,0.18595369160175323,0.2342347353696823,0.18151269853115082,-0.446688711643219,0.03420199081301689,0.020743107423186302},{0.20409920811653137,0.26907020807266235,-0.03037136048078537,0.185438334941864,-0.49055418372154236,-0.43796446919441223,0.26667192578315735,0.31634634733200073,0.08973808586597443,0.3839690387248993,0.23102284967899323,-0.22264476120471954,-0.006237220950424671,-0.15697449445724487,-0.135704904794693,0.28601953387260437},{-0.11601413786411285,0.2630293667316437,0.2938053607940674,-0.37020665407180786,-0.2555396258831024,0.008474212139844894,-0.35424238443374634,-0.041449565440416336,0.19515389204025269,0.08206252008676529,-0.13610605895519257,-0.21463055908679962,-0.3200068771839142,-0.049857914447784424,0.18684186041355133,0.01720442622900009},{-0.11023903638124466,-0.13919639587402344,-0.45459502935409546,0.2842436134815216,-0.32813677191734314,-0.22662487626075745,-0.23794884979724884,-0.3909590542316437,0.14485155045986176,-0.22648601233959198,0.05957314372062683,0.07616081833839417,-0.15761105716228485,0.43870818614959717,-0.0310351625084877,-0.3095712661743164},{-0.32016751170158386,0.2612692713737488,-0.004202541895210743,-0.04589848965406418,0.27578800916671753,-0.27168217301368713,0.2973140776157379,0.143624946475029,0.34339773654937744,0.31430453062057495,0.25810179114341736,0.3051062524318695,0.1736287772655487,-0.07035098224878311,0.25829795002937317,0.0996878445148468},{0.06437180191278458,-0.2669433653354645,-0.1520167738199234,-0.12858068943023682,0.24590811133384705,-0.16647210717201233,-0.29080715775489807,-0.14957191050052643,0.07080540060997009,-0.3530389666557312,-0.2624782621860504,0.33674901723861694,0.12080582976341248,0.12329786270856857,-0.38160449266433716,0.22308404743671417},{-0.04450434818863869,-0.4427732229232788,0.27402594685554504,0.2875126004219055,0.25453686714172363,0.15439873933792114,0.16381797194480896,-0.13430015742778778,0.23988768458366394,-0.24028529226779938,0.1952313780784607,0.35019803047180176,0.4943370819091797,0.10384683310985565,-0.06746964901685715,0.07712350785732269},{0.05751991271972656,-0.007908681407570839,0.42395681142807007,-0.016636084765195847,-0.2569778859615326,-0.1781255453824997,0.4332647919654846,0.3050229847431183,-0.24932557344436646,-0.18561451137065887,-0.06054581329226494,-0.3624715209007263,-0.02092152275145054,-0.2887326180934906,-0.33173906803131104,0.07998698949813843},{-0.13718146085739136,-0.315000057220459,0.4269499182701111,-0.2177702635526657,0.3673318922519684,-0.3041662871837616,-0.45195966958999634,0.07569771260023117,0.07914029806852341,0.05757348984479904,-0.32469040155410767,0.10797691345214844,0.11262590438127518,-0.2963791787624359,-0.2937908470630646,0.01611979678273201},{0.3674545884132385,-0.34229469299316406,0.4504604935646057,0.07365147769451141,-0.09463126212358475,0.33186963200569153,-0.11813755333423615,-0.2256326526403427,-0.4019458591938019,0.10773127526044846,0.014197209849953651,-0.35511651635169983,-0.12929879128932953,0.11248238384723663,0.30567267537117004,0.019103476777672768},{-0.10772830992937088,0.20428866147994995,0.11849308013916016,-0.48807790875434875,-0.19035226106643677,0.20215588808059692,0.2384158819913864,-0.25191256403923035,0.2254934310913086,-0.2771502435207367,0.043539829552173615,0.10654105246067047,-0.05894899368286133,0.2029723823070526,0.039093490689992905,0.07228326797485352},{-0.13282689452171326,0.41416433453559875,-0.4434241056442261,0.377554327249527,0.09343386441469193,-0.373302698135376,-0.02279435284435749,-0.0779334157705307,-0.30447596311569214,0.3860701024532318,-0.30955469608306885,0.28238338232040405,-0.0964147299528122,-0.3201201558113098,-0.16346438229084015,-0.47314175963401794}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.14523981511592865,0.10909987986087799,0.00036855574580840766,-0.04844275116920471,-0.08851370960474014,0.023224923759698868,0.2608356475830078,0.0709780901670456,-0.17038680613040924,-0.17639733850955963,0.12505866587162018,-0.2719155251979828,-0.211142897605896,0.2516991198062897,0.2185201197862625,0.30614835023880005,-0.25324785709381104,-0.27467799186706543,-0.18916387856006622,0.12116435915231705,-0.06889897584915161,-0.32747524976730347,-0.2585262656211853,-0.2811557948589325,-0.23334327340126038,0.13778714835643768,-0.2136605978012085,-0.04389870911836624,-0.05799463018774986,-0.0036476224195212126,0.2242279201745987,-0.21137961745262146},{0.29476985335350037,0.15924674272537231,0.1781850904226303,-0.08954383432865143,0.13741149008274078,-0.14162318408489227,0.37445929646492004,0.14601649343967438,-0.1334199607372284,-0.07819429785013199,-0.1236177608370781,-0.2643624246120453,-0.18286830186843872,0.2428782433271408,-0.25934797525405884,-0.19255055487155914,-0.04305827245116234,0.19667775928974152,-0.36163920164108276,-0.2215990126132965,-0.028948625549674034,0.21856290102005005,0.027425169944763184,0.029355237260460854,0.22005128860473633,-0.3369865119457245,-0.05231199041008949,0.07362783700227737,0.16992411017417908,-0.11076565831899643,-0.06607170403003693,0.19980107247829437},{0.16850662231445312,0.02861475758254528,-0.13794633746147156,0.1416349709033966,-0.15088634192943573,-0.15803532302379608,-0.21638500690460205,0.05106670781970024,-0.1576157808303833,0.34835779666900635,-0.32379287481307983,-0.28290414810180664,0.17819342017173767,-0.39870309829711914,-0.16041983664035797,0.09604299068450928,-0.08708475530147552,-0.12168532609939575,0.18187206983566284,-0.10030423849821091,0.23996208608150482,0.2762964963912964,-0.2352551519870758,0.024243194609880447,-0.2688851058483124,-0.01834297925233841,0.12605370581150055,-0.07535167038440704,-0.026808813214302063,-0.21896982192993164,-0.12007743120193481,-0.07913105934858322},{0.4078361690044403,0.05151841416954994,0.14939309656620026,-0.18359097838401794,-0.25535130500793457,-0.04259797930717468,-0.1431276649236679,0.2853912115097046,0.2383551448583603,-0.3068349063396454,-0.06464545428752899,0.27653682231903076,0.11909882724285126,-0.020872075110673904,-0.24011245369911194,0.29761505126953125,-0.29326772689819336,0.26395517587661743,0.01934976689517498,0.1195916160941124,-0.09785770624876022,-0.10227501392364502,0.28690993785858154,0.1612633466720581,0.1731531172990799,-0.3735384941101074,0.26621297001838684,-0.2099388986825943,-0.05138233304023743,0.07817477732896805,-0.19346843659877777,0.13423025608062744},{-0.06153680011630058,-0.06637094169855118,-0.11121534556150436,0.12221943587064743,0.2138494998216629,-0.1520097851753235,-0.41207271814346313,-0.08324278146028519,-0.10039742290973663,-0.30810225009918213,0.14332230389118195,0.248077392578125,-0.045846935361623764,-0.11374258995056152,-0.09868636727333069,0.12300664931535721,-0.023416418582201004,-0.04277348890900612,-0.30696240067481995,-0.1970645636320114,-0.16932761669158936,-0.3616960048675537,0.13390184938907623,0.14522860944271088,-0.10066160559654236,0.3423258066177368,-0.1848837286233902,0.2065340280532837,0.3108123540878296,0.3868684768676758,-0.028434161096811295,0.38374942541122437},{-0.2880282402038574,0.019158249720931053,-0.22716635465621948,-0.056138359010219574,-0.19948579370975494,0.24385906755924225,0.20436084270477295,0.011514210142195225,0.26059839129447937,0.2229337841272354,0.3346707224845886,-0.22819410264492035,-0.2676151692867279,0.20200806856155396,0.33310776948928833,-0.3349739611148834,-0.11688131839036942,-0.2536909580230713,0.2265840321779251,0.10026136040687561,0.08477891236543655,0.1828114539384842,0.062161851674318314,-0.0812394767999649,-0.34901362657546997,0.35697078704833984,-0.14010022580623627,0.21163654327392578,0.3361078202724457,0.18616895377635956,0.06351441144943237,0.02301625721156597},{0.19970160722732544,-0.15207070112228394,-0.12968122959136963,-0.30859026312828064,-0.0405353382229805,0.23534521460533142,0.3017706573009491,0.17536628246307373,0.08842313289642334,0.3500329554080963,-0.008631978183984756,-0.026689602062106133,-0.45274782180786133,-0.16885881125926971,-0.16043759882450104,0.16202275454998016,-0.260436087846756,-0.22162429988384247,0.2124813348054886,-0.08701621741056442,-0.12628871202468872,-0.15332958102226257,-0.23370110988616943,-0.21485362946987152,0.13805511593818665,-0.22043658792972565,-0.09019516408443451,-0.20579931139945984,0.296345055103302,0.12643444538116455,-0.16625840961933136,-0.297085165977478},{0.019584529101848602,0.15163995325565338,0.0666424036026001,-0.0066201211884617805,0.12835437059402466,-0.330702006816864,-0.12632621824741364,-0.1594453901052475,-0.01647663116455078,-0.23121359944343567,-0.31231728196144104,-0.03275220841169357,-0.12680131196975708,-0.026994427666068077,-0.124307781457901,0.3858239948749542,-0.019712967798113823,-0.16058598458766937,0.11944161355495453,0.34109044075012207,-0.09916278719902039,-0.2512081265449524,0.2536284327507019,0.1018858402967453,-0.04394695535302162,-0.3095972239971161,-0.31049469113349915,-0.3231408894062042,-0.346402645111084,-0.23574145138263702,0.03293357044458389,-0.30453935265541077},{0.09101707488298416,0.3155869245529175,-0.26399433612823486,-0.32129091024398804,-0.22432443499565125,0.06070097163319588,0.06587406247854233,0.07691065222024918,0.14129604399204254,-0.2763279378414154,-0.21865436434745789,0.33914509415626526,-0.24496786296367645,-0.2043912410736084,0.19279488921165466,-0.27313342690467834,0.26191645860671997,0.1494859755039215,0.33805176615715027,0.04176020994782448,0.22412525117397308,0.04801559820771217,0.27015212178230286,-0.087722547352314,0.37171706557273865,-0.21287526190280914,0.11520685255527496,0.319827139377594,-0.28822749853134155,0.2174888700246811,-0.02371738851070404,0.15599653124809265},{-0.1804211288690567,0.1272936910390854,-0.22471798956394196,-0.1565743237733841,0.19071786105632782,-0.14358651638031006,0.07816189527511597,-0.007507705129683018,0.15476027131080627,-0.0484628863632679,-0.2661323845386505,-0.2782306671142578,-0.31334206461906433,-0.05945461615920067,-0.2353988140821457,0.09206084161996841,0.07194758206605911,-0.20228177309036255,0.27663519978523254,0.09720274060964584,0.002148641040548682,-0.019573740661144257,0.2789303660392761,-0.20244421064853668,0.3093653619289398,0.10724597424268723,-0.25569450855255127,0.017187541350722313,-0.023048581555485725,0.14785051345825195,-0.11466722935438156,0.10323559492826462},{0.08614615350961685,0.019114520400762558,0.21284139156341553,-0.27590352296829224,-0.3022540509700775,-0.241694837808609,-0.2706166207790375,0.0008757408359088004,-0.21666286885738373,0.4300222396850586,0.14813579618930817,-0.2467140406370163,-0.38523364067077637,-0.03290385752916336,-0.22354374825954437,-0.09028665721416473,0.2220035046339035,-0.15915992856025696,0.2675759196281433,-0.14650404453277588,-0.19095192849636078,0.0014769593253731728,0.1589341014623642,0.23297929763793945,0.16487421095371246,-0.11533502489328384,-0.007484621834009886,-0.09028755128383636,-0.06373538821935654,0.02627471275627613,-0.03476967290043831,0.12003613263368607},{-0.1650691032409668,-0.12196514010429382,0.21360233426094055,0.2948801517486572,0.2568928301334381,-0.058506302535533905,0.0693901777267456,-0.21810443699359894,-0.016948698088526726,-0.2607244551181793,0.26426658034324646,-0.2138553261756897,-0.20821699500083923,-0.2069532573223114,0.2427261769771576,-0.004297408275306225,-0.016870399937033653,0.011312843300402164,0.3553515374660492,0.048009950667619705,-0.16798187792301178,0.20644055306911469,0.1008072942495346,-0.060476068407297134,0.23510611057281494,-0.09898442029953003,-0.18299485743045807,0.20342108607292175,0.14534619450569153,0.0167025588452816,-0.30718377232551575,-0.22780358791351318},{0.30181244015693665,-0.25110724568367004,0.006962873507291079,-0.32280078530311584,-0.013950583525002003,-0.1602521538734436,0.1103147566318512,0.16613438725471497,0.21632447838783264,0.060080740600824356,0.19445958733558655,0.2639460861682892,-0.4359011650085449,-0.35785382986068726,-0.02988075092434883,-0.21035929024219513,-0.2536170482635498,-0.3062003254890442,0.32399311661720276,-0.16983264684677124,0.3364151418209076,-0.10395068675279617,0.0065211639739573,0.19364497065544128,0.1253817081451416,-0.11469954997301102,0.12579238414764404,0.03893674910068512,0.08988213539123535,-0.007959993556141853,-0.2739317715167999,-0.00015704463294241577},{0.2593231499195099,-0.03755049407482147,-0.02094929851591587,0.35288524627685547,-0.09246600419282913,-0.16060853004455566,-0.031861208379268646,0.16548235714435577,0.18778659403324127,0.24305501580238342,0.12121633440256119,-0.1362752765417099,0.05676950141787529,0.21371133625507355,-0.12421014904975891,0.11547622829675674,0.2390301525592804,-0.2401915341615677,0.11700309067964554,-0.3462638258934021,0.2426247000694275,0.1667826920747757,-0.09021317958831787,0.19777226448059082,0.2504725158214569,0.07558988779783249,0.1553824543952942,0.10253521054983139,0.08321171253919601,-0.14092712104320526,0.03234672173857689,0.359287828207016},{0.07220084965229034,-0.2086096704006195,0.004276859574019909,0.09882991760969162,-0.26908937096595764,-0.0076564704068005085,0.049377962946891785,-0.2240193486213684,-0.153301402926445,-0.02484159916639328,0.1713966429233551,0.20168064534664154,0.10100171715021133,0.25461289286613464,-0.041503604501485825,-0.03489193692803383,-0.21944200992584229,0.2547400891780853,-0.07519859820604324,-0.21030089259147644,-0.2097911536693573,-0.10848211497068405,0.13539676368236542,0.047205809503793716,-0.001163775334134698,-0.13920195400714874,-0.17464539408683777,0.21397735178470612,0.050879232585430145,-0.1487017422914505,0.25471338629722595,0.16700512170791626},{0.1714860498905182,-0.23293104767799377,0.02541193924844265,-0.19385375082492828,0.010129162110388279,0.15230326354503632,0.06767864525318146,0.26247116923332214,-0.08810079097747803,-0.029908113181591034,0.211213156580925,0.12750321626663208,0.0558655709028244,-0.10199104249477386,-0.013730579987168312,0.20427356660366058,-0.332407146692276,-0.18533095717430115,-0.03209543973207474,0.08400662988424301,0.03582274168729782,0.2440284639596939,0.14302334189414978,0.1911037117242813,0.06320174038410187,0.17929261922836304,-0.031169207766652107,-0.06003224849700928,0.0768725797533989,-0.09390361607074738,-0.2565543055534363,0.315551221370697},{0.1702268272638321,-0.0013147875433787704,-0.343138724565506,0.11903407424688339,0.047602057456970215,-0.05500239506363869,0.32888108491897583,0.11025239527225494,0.1173153892159462,-0.11396763473749161,0.19746151566505432,-0.2407858520746231,-0.3843482732772827,0.23948723077774048,0.0770806223154068,0.05094381049275398,-0.028225388377904892,-0.1024414524435997,-0.15968915820121765,0.07082357257604599,-0.02679499052464962,0.20136737823486328,0.08861050009727478,-0.15816237032413483,-0.07181510329246521,-0.23946477472782135,0.055611032992601395,0.3130432367324829,0.21551984548568726,-0.18351858854293823,0.1737978458404541,0.17882812023162842},{-0.07057061791419983,0.0027634238358587027,-0.07974448055028915,-0.0743076503276825,-0.23788300156593323,-0.03534819185733795,0.21602533757686615,0.17926673591136932,0.1330706626176834,0.01516988966614008,0.18144820630550385,-0.00534429308027029,0.24371318519115448,0.20122285187244415,0.17759163677692413,-0.10364355891942978,0.11573213338851929,0.1917792409658432,0.21377013623714447,0.05261042341589928,0.1986514776945114,0.2756338119506836,0.08304260671138763,0.16774871945381165,-0.02741851843893528,-0.07525864243507385,-0.1304658055305481,-0.25199195742607117,0.1353103071451187,-0.27312448620796204,0.03052212856709957,-0.06062034144997597},{-0.3304767310619354,0.05366341769695282,-0.3289976716041565,-0.32526761293411255,0.024689432233572006,-0.006320602260529995,0.11634312570095062,-0.15745925903320312,0.05542707070708275,0.3519655168056488,0.02194681391119957,-0.2096465528011322,0.06788387894630432,-0.20278920233249664,-0.3002620041370392,0.013451017439365387,-0.17766806483268738,0.1081577017903328,-0.05993805080652237,0.01751081831753254,-0.2845879793167114,0.14375261962413788,0.10514026880264282,0.043306153267621994,-0.07906852662563324,0.33498549461364746,0.05087421461939812,-0.20733876526355743,-0.18990349769592285,0.02609582059085369,-0.20978643000125885,-0.25266605615615845},{-0.006594418548047543,-0.2631206214427948,-0.28065040707588196,-0.05156269297003746,-0.32774749398231506,-0.15154783427715302,0.18490251898765564,-0.27888286113739014,-0.2162233144044876,0.1765241175889969,0.20056116580963135,0.09134204685688019,0.11950374394655228,-0.15412931144237518,0.2746078670024872,-0.26950040459632874,0.08890486508607864,0.257750004529953,0.04630303010344505,0.2760167419910431,0.011551289819180965,-0.12133562564849854,-0.27808016538619995,0.22400742769241333,-0.11654075980186462,-0.156553253531456,0.1177273541688919,0.04024745151400566,-0.11940906941890717,-0.32530882954597473,-0.0340561717748642,-0.19078467786312103},{0.23744401335716248,0.11514053493738174,-0.04215224087238312,0.20247405767440796,-0.23462986946105957,0.11812571436166763,-0.0794556587934494,-0.17741306126117706,-0.10519567877054214,0.1878965198993683,-0.3297344446182251,-0.13798324763774872,0.021197160705924034,-0.19922085106372833,-0.3925839364528656,-0.15034620463848114,-0.09123504906892776,-0.30294570326805115,-0.24447812139987946,0.22470787167549133,0.12864336371421814,0.10240921378135681,-0.38797393441200256,0.32414934039115906,0.15715420246124268,0.29587122797966003,-0.3060793876647949,-0.08882851898670197,0.0659237802028656,-0.19682937860488892,0.13888904452323914,0.15251290798187256},{-0.051246508955955505,-0.3063927888870239,-0.043279312551021576,-0.30811476707458496,-0.07227911055088043,0.290288507938385,0.2067878395318985,0.03263934329152107,-0.09669525176286697,0.011242815293371677,-0.15267273783683777,0.1016080230474472,0.10329057276248932,0.05706062912940979,0.11327867954969406,0.03484483063220978,-0.08544180542230606,0.14144140481948853,-0.11558874696493149,0.14758706092834473,0.19082336127758026,0.2520214021205902,-0.03138922154903412,-0.24728016555309296,0.1663847118616104,0.15948574244976044,0.28006505966186523,0.1654689460992813,0.023046573624014854,0.1120263859629631,0.016628963872790337,-0.10346487909555435},{-0.03585480526089668,-0.2062644064426422,0.2111639678478241,0.0679037794470787,0.2767123878002167,-0.02434457093477249,-0.12910504639148712,-0.21213893592357635,0.13691473007202148,-0.03155449777841568,0.08127515017986298,-0.0020002969540655613,-0.34067291021347046,0.05840277299284935,-0.09138809889554977,-0.26431336998939514,-0.04751015454530716,-0.06639203429222107,0.1712222695350647,0.18628442287445068,0.02798020839691162,0.05342346429824829,0.16681060194969177,0.29166218638420105,-0.19587382674217224,-0.027193864807486534,0.16285260021686554,-0.07173176109790802,-0.13277292251586914,-0.27301472425460815,0.2842226028442383,0.022239694371819496},{0.1973342001438141,-0.08722073584794998,0.044715043157339096,0.0924302414059639,-0.01746068149805069,0.03943242132663727,-0.22062712907791138,0.3132232427597046,-0.11330404877662659,-0.021620498970150948,0.10837490856647491,-0.3193468153476715,0.08598597347736359,-0.048121292144060135,-0.12953172624111176,0.3341466784477234,-0.08888719975948334,-0.16873903572559357,0.0078091672621667385,0.02774517610669136,-0.18523094058036804,0.1780831515789032,0.21552398800849915,0.263359934091568,-0.2556915283203125,0.11102158576250076,-0.07896049320697784,0.06701421737670898,-0.27496278285980225,0.2321900576353073,-0.05674084648489952,0.02064121887087822}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.22023750841617584,-0.1271500289440155,0.06468908488750458,-0.13594336807727814},{0.20140396058559418,-0.2511938512325287,0.2732364535331726,0.22747176885604858},{-0.2492193877696991,0.030839193612337112,0.07883721590042114,-0.019130270928144455},{0.28767651319503784,0.4138423800468445,0.3038192391395569,0.04169648885726929},{-0.2607387900352478,0.15115056931972504,-0.2654852867126465,0.11753951758146286},{0.01686817966401577,-0.08559201657772064,0.07411655783653259,0.2883187234401703},{-0.10598213970661163,-0.1721704751253128,-0.3486790060997009,-0.047672633081674576},{-0.10772041231393814,-0.34655553102493286,0.14221952855587006,-0.05517728626728058},{-0.10297181457281113,0.1533103734254837,-0.08243951946496964,-0.09152907133102417},{0.22331658005714417,-0.013057555072009563,-0.09278417378664017,-0.16713972389698029},{0.22552599012851715,-0.1894703507423401,0.28941264748573303,0.22190751135349274},{-0.029745398089289665,0.0022781859152019024,0.36767417192459106,-0.08892257511615753},{-0.3018290102481842,0.2300073504447937,-0.03877416253089905,-0.08068425208330154},{-0.16022665798664093,0.01107637956738472,-0.22356699407100677,0.055477581918239594},{0.19801589846611023,-0.032339222729206085,0.21638032793998718,0.0677381083369255},{-0.13676322996616364,-0.27226492762565613,-0.11849402636289597,-0.07528355717658997},{-0.24714910984039307,0.043855663388967514,-0.05971634387969971,0.28110620379447937},{-0.2569115161895752,-0.1335952877998352,-0.22612963616847992,0.17725080251693726},{-0.06312721967697144,-0.10302936285734177,0.3603855073451996,0.0684632807970047},{-0.14325998723506927,-0.16495907306671143,-0.01498321071267128,-0.17125442624092102},{0.14861491322517395,0.11555083096027374,0.11747399717569351,-0.14393283426761627},{-0.010082789696753025,-0.2574635446071625,-0.13948801159858704,0.24539659917354584},{0.2852681875228882,-0.1460309624671936,0.1698894500732422,0.019834458827972412},{-0.2705189287662506,-0.09705362468957901,-0.2821543514728546,-0.20447345077991486},{-0.24286659061908722,-0.17040647566318512,-0.0009330302709713578,-0.11933926492929459},{0.16649872064590454,0.1733170598745346,-0.05552963539958,0.15279658138751984},{0.18938452005386353,-0.1981915533542633,0.21975718438625336,0.07981724292039871},{-0.045826658606529236,-0.15270143747329712,0.009342736564576626,0.2912572920322418},{0.04576678201556206,0.032123155891895294,0.025853348895907402,0.022202281281352043},{-0.1480928212404251,0.09834955632686615,0.23156893253326416,0.019008876755833626},{-0.13669800758361816,-0.1297895759344101,0.0760480985045433,0.19415119290351868},{0.18624576926231384,0.20460669696331024,0.22919723391532898,-0.013976589776575565}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05526845157146454,0.0035000036004930735,-0.008503827266395092,0.04615398868918419,0.041601087898015976,-0.04623696208000183,-0.007221841253340244,0.05639208108186722,-0.07347489893436432,-0.08050577342510223,-0.011870556510984898,0.057624805718660355,-0.02184182032942772,0.04781622439622879,-0.027965543791651726,-0.03011183999478817};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0064020766876637936,-0.00992443785071373,-0.01064295507967472,-0.00885673426091671,-0.05406295508146286,0.019947737455368042,-0.02374657429754734,-0.003604710102081299,0.018810005858540535,-0.031291086226701736,0.001211951719596982,-0.015779761597514153,-0.013043822720646858,-0.021730532869696617,-0.02404220961034298,-0.0368933379650116};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0032633410301059484,0.06166893243789673,-0.021548643708229065,0.016544383019208908,-0.015475894324481487,0.032781779766082764,-0.04336804896593094,-0.012775097973644733,-0.02419079840183258,-0.02012627013027668,-0.007614072412252426,0.027712566778063774,0.010406970977783203,0.011944964528083801,0.05412226542830467,-0.04695815220475197,0.016411032527685165,-0.00814752746373415,0.018610725179314613,-0.033398304134607315,-0.0051648663356900215,0.03079487942159176,-0.0016769799403846264,-0.04406038671731949,-0.05409163236618042,0.018145551905035973,0.02445775456726551,0.02935406006872654,-0.0065091452561318874,0.02058936282992363,0.02723068743944168,0.004131309222429991};
static const float action_parameterization_distribution_linear_bias[4] = {0.009028173983097076,0.014104013331234455,0.012411498464643955,0.03807942941784859};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4153987467288971,-0.38908082246780396,-0.13492543995380402,0.22896867990493774,-0.19148336350917816,0.1101662814617157,-0.3011837601661682,0.048599500209093094},{0.2102709710597992,0.10642951726913452,0.4008890390396118,0.37672993540763855,-0.11891355365514755,-0.33604151010513306,0.3292844891548157,0.39307287335395813},{0.07141668349504471,0.166531503200531,0.10846690088510513,-0.05409153550863266,0.32982513308525085,0.22740259766578674,-0.006962988525629044,0.23158776760101318},{0.12270917743444443,-0.3846018314361572,0.33775168657302856,-0.15641921758651733,-0.22997508943080902,0.10844258964061737,0.3349921405315399,0.2496563196182251},{-0.24057841300964355,-0.10203004628419876,-0.03715214133262634,-0.2689158618450165,0.14746996760368347,0.13496170938014984,0.369390606880188,0.27697259187698364},{-0.0417163148522377,0.17789147794246674,0.0032344344072043896,-0.1982441395521164,0.3436988592147827,0.12945425510406494,0.13177649676799774,-0.17212837934494019},{0.015073428861796856,0.1398547887802124,0.1533244252204895,-0.14731863141059875,0.4354758858680725,-0.0963769406080246,0.16768750548362732,0.08767012506723404},{0.06054805964231491,-0.468143492937088,-0.02029998041689396,-0.22902026772499084,0.29306700825691223,0.06022198125720024,-0.1540706902742386,-0.3480333089828491},{-0.25276511907577515,0.15198639035224915,0.009484588168561459,-0.07483386248350143,0.028622016310691833,0.4612763226032257,0.3815951943397522,0.29212552309036255},{0.0007100394577719271,-0.15475021302700043,-0.27167224884033203,0.27756983041763306,0.30039700865745544,0.3269531726837158,0.34387895464897156,-0.3251863718032837},{-0.15774063766002655,-0.3927411437034607,0.3581046760082245,0.1806451827287674,0.024715188890695572,-0.26653504371643066,0.02106829732656479,-0.33461999893188477},{0.24607795476913452,0.019368039444088936,0.41134321689605713,0.4066554307937622,-0.09924730658531189,0.32869812846183777,0.19608773291110992,-0.3298655152320862},{-0.37705084681510925,0.13122420012950897,-0.3495364487171173,0.43982601165771484,-0.011825541965663433,0.4197654128074646,-0.01998789981007576,0.26094916462898254},{-0.06003246083855629,0.16330304741859436,-0.12594197690486908,-0.11552099883556366,0.028373992070555687,0.16372250020503998,0.26468902826309204,-0.00394001929089427},{0.11276865005493164,-0.3670215308666229,-0.3580450415611267,-0.1704854667186737,0.13398495316505432,-0.14332950115203857,0.08753663301467896,-0.11991164833307266},{-0.4753044545650482,-0.36303091049194336,-0.297382652759552,-0.012853652238845825,-0.05377482995390892,0.22464607656002045,0.14723868668079376,-0.12353748083114624},{-0.17961445450782776,-0.32428503036499023,0.21958377957344055,-0.36302489042282104,-0.007776414975523949,0.04020445793867111,-0.43323269486427307,-0.3137592077255249},{0.06635083258152008,0.22084754705429077,0.12786979973316193,0.1956932693719864,-0.12084455788135529,0.33538103103637695,0.27581894397735596,-0.22903554141521454},{0.0711585134267807,-0.3379363417625427,-0.08626749366521835,-0.04930485412478447,-0.14838595688343048,-0.3436742126941681,0.033891890197992325,-0.31588032841682434},{-0.02476821467280388,-0.00940971914678812,0.10153334587812424,-0.2937535047531128,0.04444900527596474,0.12052290886640549,0.07131930440664291,-0.1488647311925888},{0.10792478919029236,-0.11417652666568756,0.06443340331315994,-0.24730543792247772,-0.0055104405619204044,-0.00431956397369504,-0.040672801434993744,-0.267497718334198},{-0.30031618475914,0.17167846858501434,0.13442011177539825,-0.23009547591209412,-0.47222405672073364,0.00930771604180336,0.11725164949893951,-0.017152294516563416},{0.3030897378921509,0.10875105857849121,-0.4352717399597168,0.12690165638923645,-0.07329148799180984,0.22108063101768494,0.2190505713224411,0.2620443105697632},{0.03067026101052761,-0.11669526249170303,-0.04046357795596123,0.31609562039375305,-0.33102187514305115,-0.07259060442447662,-0.17302094399929047,-0.34618911147117615},{0.22690705955028534,0.06753511726856232,-0.47817641496658325,0.3274911344051361,-0.310260146856308,-0.34492456912994385,-0.34153375029563904,0.14783619344234467},{0.06922843307256699,0.3388599753379822,-0.3283931612968445,-0.05438155680894852,0.07857584208250046,-0.2477734088897705,0.3228514790534973,-0.3019830882549286},{-0.04893552511930466,0.045987989753484726,-0.1664346605539322,-0.13466475903987885,0.038529932498931885,-0.17677143216133118,-0.08493856340646744,-0.1472940295934677},{0.17014838755130768,-0.20435981452465057,-0.07275985181331635,-0.08108356595039368,0.01030214224010706,0.0069208163768053055,-0.1921134889125824,0.08579520136117935},{0.3800389766693115,0.023343577980995178,-0.4086490273475647,-0.17354261875152588,-0.24702095985412598,0.10980695486068726,0.24510230123996735,0.07294288277626038},{0.4266054034233093,-0.3248279392719269,-0.045977622270584106,-0.017741048708558083,0.11399431526660919,-0.12528525292873383,0.21791931986808777,0.3388400375843048},{-0.20388653874397278,-0.1797647923231125,0.023427432402968407,-0.21958252787590027,0.3319185972213745,-0.2586906850337982,0.054232481867074966,0.097605861723423},{0.2433449923992157,0.013122783973813057,-0.14642898738384247,0.3800879120826721,0.0978650450706482,0.0038364212960004807,-0.025541583076119423,0.0501282624900341}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23728317022323608,0.39967378973960876,-0.6058933734893799,-0.5340083837509155,-0.2609146237373352,0.06625773012638092,-0.404171347618103,0.545272171497345},{-0.03645002469420433,0.5506805181503296,-0.21160989999771118,0.49189767241477966,-0.01772562973201275,0.029178405180573463,-0.2503838539123535,-0.003061862662434578},{-0.46056872606277466,-0.184202179312706,-0.16075894236564636,-0.26040589809417725,0.5175818800926208,0.17817135155200958,-0.005386656615883112,0.4351147711277008},{-0.47364792227745056,-0.44293782114982605,0.27067819237709045,0.38605380058288574,-0.5170643329620361,-0.18099024891853333,0.4105028808116913,0.1823834776878357},{-0.2774038314819336,-0.3160654604434967,-0.2807652950286865,-0.29200321435928345,0.3187064230442047,-0.2544230818748474,0.4607197046279907,-0.4129007160663605},{-0.07852283120155334,0.15277008712291718,0.29045867919921875,-0.5410112738609314,0.5326589345932007,-0.3019639551639557,-0.41776278614997864,-0.3001607358455658},{-0.41157227754592896,0.1502319723367691,0.06960836052894592,-0.3346005976200104,-0.023903165012598038,-0.5278295874595642,0.5077752470970154,0.07446768134832382},{-0.3875160217285156,-0.3138197064399719,-0.2168528437614441,-0.4532603919506073,-0.30414000153541565,0.07838080823421478,0.4738118052482605,-0.3159151077270508}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.020988916978240013,-0.05855085328221321,-0.01751488447189331,0.015813343226909637,-0.02990255318582058,-0.012924423441290855,-0.09313739091157913,0.012850465252995491};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.013306754641234875,-0.0588422492146492,-0.01802496798336506,0.08709896355867386,-0.02597828209400177,0.04304126650094986,-0.033190157264471054,0.048684705048799515};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

