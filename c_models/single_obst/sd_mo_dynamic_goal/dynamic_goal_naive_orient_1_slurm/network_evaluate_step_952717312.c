#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.27120357751846313,0.017446760088205338,-0.15897659957408905,0.2686014771461487,0.30030518770217896,-0.19368520379066467,-0.22385412454605103,0.11926161497831345,0.2387048900127411,-0.30678629875183105,0.6283165812492371,0.00010475784802110866,0.31924188137054443,0.09384136646986008,-0.4494732916355133,0.050579335540533066},{-0.22649648785591125,-0.27289047837257385,-0.31012219190597534,-0.18107278645038605,0.06797406822443008,0.2550412714481354,0.06480863690376282,0.06949983537197113,0.22961924970149994,0.20588520169258118,-0.19136226177215576,-0.0976172685623169,-0.18364068865776062,0.07205110043287277,0.3452538847923279,-0.3155827224254608},{0.11946862190961838,0.20196503400802612,0.21152174472808838,0.3454553186893463,-0.07979754358530045,-0.23774567246437073,0.5177661180496216,-0.021814968436956406,-0.02597629465162754,-0.1506432443857193,0.024685129523277283,-0.025731710717082024,0.06628068536520004,0.4769953787326813,-0.27942609786987305,-0.03626324608922005},{0.11507720500230789,-0.14793923497200012,-0.15344026684761047,-0.1015891283750534,0.02437582239508629,0.10964074730873108,0.09288525581359863,-0.1931532472372055,-0.16635428369045258,0.14501146972179413,0.5081406235694885,-0.21472850441932678,-0.17017482221126556,-0.1461939811706543,0.16786332428455353,0.14627966284751892},{-0.29963216185569763,0.0753140076994896,0.14706553518772125,-0.22103074193000793,0.3021506369113922,0.2927606701850891,0.1538839191198349,-0.19586217403411865,-0.11282982677221298,0.1667006015777588,-0.14353416860103607,-0.38057971000671387,-0.007559350226074457,-0.1405525505542755,0.31408265233039856,-0.030281737446784973},{-0.04319475591182709,0.022306108847260475,-0.014015155844390392,0.006319815292954445,0.0856553167104721,-0.04891994222998619,0.39490899443626404,-0.3577752709388733,-0.14156854152679443,-0.16195669770240784,0.3103356957435608,0.018320633098483086,0.19452494382858276,0.09487856924533844,0.24694426357746124,0.275242418050766},{-0.17975449562072754,0.1333330273628235,-0.008688262663781643,0.11183521896600723,-0.19594192504882812,-0.05366663262248039,-0.1465764045715332,-0.04512152448296547,0.13005730509757996,0.33469733595848083,-0.1592242270708084,-0.07130651921033859,0.22583958506584167,0.08010746538639069,-0.2016608566045761,0.25791195034980774},{-0.09540293365716934,-0.02393445372581482,-0.23202864825725555,-0.2239077091217041,0.38688161969184875,-0.32705503702163696,-0.29849135875701904,-0.41556060314178467,-0.06645239144563675,-0.20060142874717712,0.3607916235923767,-0.02398659661412239,0.24599388241767883,0.15163229405879974,-0.2575242221355438,0.437752366065979},{0.23302094638347626,0.06749984622001648,-0.047991301864385605,0.10901794582605362,-0.3752424716949463,-0.4199051260948181,0.36796194314956665,-0.3363429307937622,-0.15436317026615143,0.2062988132238388,0.18879324197769165,-0.3090282082557678,-0.13118287920951843,0.016028713434934616,0.17418107390403748,-0.0015761521644890308},{0.40571221709251404,-0.4898650646209717,-0.012360947206616402,0.008246111683547497,0.2615665793418884,-0.10813311487436295,-0.24386544525623322,-0.1187296211719513,-0.16831079125404358,0.02603079564869404,-0.008531688712537289,-0.18978355824947357,0.33913612365722656,-0.08139952272176743,-0.5520265698432922,-0.1622394323348999},{0.25821998715400696,0.14588230848312378,-0.29038378596305847,0.09216898679733276,0.04537532851099968,-0.15367864072322845,-0.1285085529088974,0.13835179805755615,-0.15231211483478546,0.10149877518415451,0.1923854500055313,0.24224145710468292,-0.11187301576137543,0.2560276389122009,-0.006063341628760099,-0.29857635498046875},{-0.4485374391078949,0.2751503586769104,0.2092820107936859,-0.2851946949958801,-0.26435866951942444,0.30687904357910156,0.0537882000207901,0.2926083505153656,0.23570187389850616,0.16434523463249207,0.204485222697258,-0.1364300549030304,0.16020110249519348,-0.08230596035718918,-0.06932368129491806,-0.16317559778690338},{0.08130599558353424,-0.26144587993621826,-0.20487980544567108,0.15897496044635773,-0.23125728964805603,-0.21081997454166412,-0.11266318708658218,0.22762228548526764,0.3311019539833069,-0.13968464732170105,-0.044095125049352646,0.06808412820100784,0.23696257174015045,0.14440038800239563,-0.1913570612668991,0.2740544080734253},{0.29660797119140625,0.18427179753780365,-0.12018069624900818,-0.10925304144620895,0.05966048315167427,-0.07897238433361053,-0.11965242028236389,0.2837521433830261,-0.21162590384483337,-0.1935206651687622,-0.18147408962249756,0.03512122854590416,-0.21077585220336914,-0.10913005471229553,-0.23423825204372406,-0.040062155574560165},{0.15155914425849915,0.4263342320919037,0.4105057418346405,-0.34574925899505615,-0.355013370513916,0.20717646181583405,-0.002852299716323614,-0.1592913120985031,0.4119936525821686,0.3810359835624695,-0.11959110200405121,0.11599627882242203,-0.10416778177022934,-0.3184638023376465,0.07859981060028076,-0.17422591149806976},{-0.21488164365291595,-0.1520288586616516,-0.11024846881628036,0.41659101843833923,-0.23318347334861755,-0.2218431979417801,-0.23649106919765472,-0.2952841818332672,-0.47923463582992554,-0.2330205738544464,0.3388240337371826,0.257400244474411,-0.539788544178009,-0.3337766230106354,-0.5332913994789124,-0.174834206700325},{-0.47672441601753235,0.17675170302391052,-0.2924504578113556,-0.1612248718738556,-0.4421226680278778,0.19939544796943665,0.5127883553504944,0.09013780951499939,0.42790424823760986,-0.48934513330459595,0.2346656322479248,-0.3424050509929657,-0.21316614747047424,0.0369868129491806,-0.16238760948181152,-0.21534979343414307},{0.36935707926750183,-0.5886799097061157,0.26697805523872375,0.22569185495376587,-0.13217918574810028,0.4531248211860657,0.21202203631401062,0.2901862561702728,-0.036612849682569504,-0.23825503885746002,-0.15313531458377838,-0.12181321531534195,-0.10777513682842255,-0.5202946066856384,0.2665726840496063,-0.11099611967802048}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.016328386962413788,0.2955119013786316,0.19556142389774323,-0.15287098288536072,-0.17886348068714142,0.041112422943115234,-0.01144411414861679,0.22110575437545776,-0.09275224059820175,0.30940982699394226,0.47480595111846924,-0.37893104553222656,0.04297753795981407,0.058505795896053314,0.0005651895189657807,-0.08375254273414612},{-0.34734776616096497,0.19162198901176453,-0.13343816995620728,0.32175734639167786,0.27733418345451355,-0.07769842445850372,-0.3110932409763336,-0.1541638821363449,0.3424358665943146,0.26100972294807434,-0.05859409272670746,0.21246938407421112,-0.36216044425964355,0.1632051169872284,-0.21060650050640106,0.43227702379226685},{-0.24673104286193848,0.13529886305332184,-0.2258465588092804,0.1486402451992035,-0.4284578859806061,-0.17177845537662506,0.027184413745999336,0.10860216617584229,-0.1589648425579071,0.35407641530036926,0.21919164061546326,-0.09467075020074844,0.15378819406032562,-0.26783764362335205,-0.10018645226955414,-0.019967691972851753},{0.18562358617782593,-0.23403695225715637,0.06332191079854965,0.38853582739830017,-0.42660319805145264,-0.30068516731262207,0.2367326319217682,0.03753900155425072,0.2701954245567322,-0.08551068603992462,0.305698424577713,0.10456258803606033,-0.18118740618228912,0.010540750809013844,-0.009779132902622223,-0.3705502450466156},{-0.3812233805656433,-0.09363676607608795,0.11276795715093613,-0.26178836822509766,0.13008354604244232,0.3092847168445587,-0.3099164068698883,0.31043609976768494,-0.20674045383930206,0.1997322291135788,-0.004434505011886358,0.05434389412403107,-0.2690376341342926,-0.00429567601531744,-0.2530548870563507,-0.08661829680204391},{0.0769425630569458,-0.29001280665397644,0.001880714320577681,-0.33091261982917786,0.21231484413146973,0.031475044786930084,-0.12321266531944275,-0.05677342042326927,-0.13113251328468323,0.3616946339607239,0.16823290288448334,0.0162961483001709,-0.30140140652656555,0.08195286989212036,0.013177727349102497,-0.3090375065803528},{0.2351752072572708,-0.23181334137916565,0.32107046246528625,-0.18176482617855072,-0.42711055278778076,0.03730512782931328,-0.35362598299980164,0.34695005416870117,-0.10145256668329239,-0.2677420377731323,-0.24568293988704681,-0.021739177405834198,-0.08783981949090958,-0.07279274612665176,0.49956148862838745,-0.36783841252326965},{-0.3553210198879242,0.3380284905433655,-0.09169487655162811,0.17258001863956451,-0.11453361064195633,-0.2154311090707779,-0.2081705927848816,0.08297578990459442,-0.05450214445590973,0.4410289525985718,0.07817763090133667,-0.1279800683259964,0.06852219253778458,-0.2075290083885193,0.052560631185770035,0.15916919708251953},{0.12102816253900528,0.261370986700058,-0.16110840439796448,-0.3054763078689575,0.30883851647377014,-0.17497240006923676,0.1934356689453125,-0.24971063435077667,-0.005531099624931812,0.018004843965172768,0.10172625631093979,0.06360933929681778,0.014179980382323265,-0.3600621223449707,-0.08265382051467896,0.1958305835723877},{-0.16125042736530304,0.029092146083712578,-0.2521015703678131,-0.29367440938949585,0.21997754275798798,-0.36727407574653625,-0.09872342646121979,0.2893102765083313,-0.1542557030916214,0.13010172545909882,-0.049773119390010834,-0.09798832982778549,-0.3598400950431824,0.09777016937732697,-0.2139127403497696,-0.3565730154514313},{-0.11657846719026566,-0.16534434258937836,0.029667705297470093,-0.2460089474916458,-0.3148585259914398,0.0366155169904232,0.13263419270515442,-0.3047047555446625,0.018744422122836113,-0.0851626843214035,0.25938525795936584,-0.06673531234264374,0.21756133437156677,0.1559455394744873,0.22468072175979614,0.25524473190307617},{-0.1435893476009369,-0.02481827326118946,-0.31185004115104675,0.30912700295448303,0.09191189706325531,0.15624846518039703,0.18596933782100677,0.14094990491867065,-0.40856051445007324,0.19565390050411224,-0.3576902747154236,-0.22605547308921814,-0.3269922733306885,0.334953635931015,-0.3359972834587097,0.09213049709796906},{-0.15599817037582397,-0.4387153685092926,-0.038965001702308655,0.1387595385313034,-0.22198249399662018,-0.041488274931907654,-0.08014078438282013,0.3873926103115082,0.4284611940383911,0.1225380152463913,0.00855273474007845,-0.19120118021965027,0.1589544266462326,-0.364206463098526,0.095731221139431,-0.15921121835708618},{-0.2692220211029053,-0.45086997747421265,-0.10960929095745087,-0.11918948590755463,-0.49438807368278503,0.4730850160121918,-0.14387568831443787,0.1893755942583084,-0.1450800895690918,-0.2309216856956482,-0.28634265065193176,0.3629346191883087,-0.12567231059074402,-0.02780301496386528,-0.206845223903656,0.3222057819366455},{-0.302937388420105,0.34666454792022705,-0.23732581734657288,0.15899279713630676,-0.35888567566871643,0.13733434677124023,0.001810226240195334,-0.3247833251953125,0.140204057097435,0.18739409744739532,-0.22728686034679413,0.06642164289951324,0.2277696281671524,-0.29686611890792847,-0.3254028558731079,-0.16212774813175201},{-0.13664241135120392,-0.28593680262565613,-0.3916783630847931,0.23210789263248444,0.13089574873447418,0.05174918845295906,-0.23238539695739746,0.1764902025461197,-0.3472827076911926,-0.23490051925182343,-0.2785475552082062,0.17874304950237274,-0.21823181211948395,0.1518637090921402,0.05033703148365021,0.2991553544998169}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11927609890699387,-0.049744799733161926,0.21586956083774567,-0.12838691473007202,-0.07771240919828415,0.0956839770078659,0.220992773771286,-0.19315482676029205,-0.2291570007801056,0.2571549713611603,0.1533445566892624,0.10998047888278961,0.057341668754816055,0.1756170094013214,-0.153068408370018,0.1656516045331955,0.14559447765350342,-0.340928852558136,-0.14617478847503662,-0.09712855517864227,-0.11194904148578644,0.03267806023359299,-0.17759625613689423,0.25816574692726135,-0.06470999866724014,-0.06996099650859833,0.10815242677927017,0.20340868830680847,-0.1948234587907791,-0.12513747811317444,0.16870437562465668,0.2406865805387497},{0.2145388126373291,-0.07715439051389694,0.13740167021751404,-0.12707756459712982,-0.12973153591156006,0.22325170040130615,-0.005323962774127722,-0.08152079582214355,-0.0436793714761734,0.01997571624815464,-0.14711721241474152,0.0009548182715661824,0.4050416946411133,0.1793740689754486,0.11072903126478195,0.05660072714090347,-0.21681474149227142,-0.3484782576560974,0.05907704308629036,0.033247292041778564,0.06188814714550972,0.29053962230682373,0.190970778465271,-0.22502358257770538,0.020006204023957253,0.25108757615089417,-0.26043954491615295,0.17512893676757812,0.08584976941347122,-0.22849072515964508,-0.06168590858578682,-0.03254340589046478},{-0.10050545632839203,-0.0697418823838234,0.31710487604141235,-0.23179206252098083,-0.14912141859531403,0.057439178228378296,-0.12367551028728485,0.2554675042629242,0.10118898749351501,0.001205465872772038,-0.17440731823444366,-0.032614413648843765,0.23528766632080078,-0.21288993954658508,0.10442811995744705,-0.030153993517160416,-0.2952702045440674,0.27255088090896606,-0.21870242059230804,-0.044745925813913345,0.005824308842420578,-0.150371253490448,-0.034544918686151505,-0.07795769721269608,-0.006640841253101826,0.26046282052993774,-0.07884275913238525,0.09289895743131638,0.24496106803417206,-0.2251535803079605,-0.21226438879966736,-0.06580392271280289},{0.1376660019159317,-0.09674915671348572,0.06151517480611801,-0.3180639147758484,0.10361658781766891,-0.15660515427589417,-0.07947715371847153,0.26487118005752563,0.02333679422736168,0.11495710164308548,0.15995576977729797,-0.0864456444978714,-0.1914064586162567,-0.08944913744926453,0.2978439927101135,-0.23498742282390594,0.03413092717528343,-0.1374978870153427,-0.12896835803985596,0.11174866557121277,-0.103976771235466,0.04041451960802078,-0.20568236708641052,0.21944689750671387,-0.21640744805335999,0.11073492467403412,-0.09113576263189316,-0.18740405142307281,0.1065962016582489,-0.01075590681284666,0.2562867999076843,-0.12324754148721695},{0.2156309187412262,-0.00019238691311329603,0.033738672733306885,0.23068660497665405,-0.23775054514408112,-0.08028222620487213,0.20618923008441925,-0.059338297694921494,0.1111215278506279,-0.17775025963783264,-0.0006814530352130532,-0.08653823286294937,-0.1545957624912262,-0.1730538159608841,0.2713508605957031,0.3109133541584015,-0.06425844877958298,-0.3356805741786957,0.1596039980649948,-0.12909673154354095,-0.11582420766353607,0.1979576200246811,0.2584897577762604,0.052917152643203735,-0.036679841578006744,-0.09214337170124054,-0.007385569158941507,0.2678458094596863,0.23424918949604034,0.13652831315994263,0.0910872295498848,-0.2383941113948822},{0.3307414650917053,-0.15366289019584656,-0.007028190419077873,0.10053517669439316,-0.13319851458072662,-0.3119378685951233,-0.2065928727388382,-0.297552227973938,-0.19181552529335022,0.032355666160583496,-0.05710281431674957,-0.011238896287977695,-0.15515200793743134,-0.04803002253174782,-0.21495825052261353,-0.21981287002563477,0.16847151517868042,-0.011876927688717842,-0.312519371509552,0.1656486541032791,-0.062450625002384186,-0.2093726247549057,0.17936085164546967,-0.14916235208511353,-0.1316305547952652,-0.22185048460960388,-0.10279282927513123,0.14266489446163177,0.0841202586889267,0.262077271938324,-0.22537288069725037,0.2082885354757309},{0.15240854024887085,0.10126713663339615,0.2695091962814331,-0.1865159571170807,0.23311486840248108,-0.22453956305980682,-0.23817135393619537,0.062184013426303864,0.2660266160964966,0.10090767592191696,-0.09616979211568832,0.10055597126483917,0.05151680111885071,0.3436201810836792,0.11383175849914551,-0.11232355237007141,-0.1801338493824005,0.13841572403907776,0.015399347059428692,-0.0036381075624376535,-0.03616071492433548,0.1802598387002945,0.1603100448846817,0.13310585916042328,-0.16124524176120758,-0.2383313775062561,-0.24811896681785583,-0.3570105731487274,0.08417187631130219,-0.11280492693185806,0.24332821369171143,0.16739751398563385},{0.2731436491012573,-0.2866326570510864,0.11479895561933517,-0.36363622546195984,-0.3502458333969116,0.24238789081573486,0.36998727917671204,0.13407190144062042,-0.09722699970006943,-0.0029210858047008514,0.22874906659126282,-0.12988415360450745,0.1482723355293274,0.3426375389099121,-0.031206119805574417,0.17935948073863983,0.36572641134262085,-0.1812780201435089,-0.03139575943350792,-0.26992371678352356,0.14494895935058594,0.20614969730377197,0.23084044456481934,0.11505106836557388,0.10650920122861862,0.11707548052072525,0.11290375143289566,0.25131475925445557,-0.18932628631591797,-0.24451173841953278,0.23875033855438232,-0.06533392518758774},{0.04520893469452858,-0.09645277261734009,0.2695222795009613,0.20725125074386597,-0.15886715054512024,-0.2765333950519562,-0.058225344866514206,0.2844929099082947,-0.17970433831214905,-0.23248587548732758,0.05283946543931961,0.09453849494457245,0.1140049397945404,-0.2811449468135834,0.12252092361450195,-0.1829695850610733,-0.15816189348697662,0.17952752113342285,-0.2388424575328827,0.31572917103767395,-0.3086449205875397,-0.2888597846031189,-0.26736775040626526,0.2975393533706665,0.11403783410787582,0.09696360677480698,0.24444450438022614,0.18420816957950592,-0.16095660626888275,-0.26833009719848633,-0.14338639378547668,0.17815884947776794},{0.26888537406921387,-0.016285814344882965,-0.05889038369059563,0.15849429368972778,-0.02454976737499237,0.19322513043880463,-0.04896765202283859,0.22288329899311066,-0.0025159171782433987,0.06261713802814484,0.1802019327878952,0.062138523906469345,-0.12326321750879288,-0.3403679430484772,0.10312838852405548,0.12151836603879929,0.08808239549398422,-0.11717741191387177,-0.08768703788518906,-0.028080245479941368,0.11247123032808304,-0.27983778715133667,0.21352089941501617,0.08004464954137802,-0.017344588413834572,0.1223115399479866,-0.26281312108039856,-0.24675793945789337,-0.060318998992443085,-0.02698000706732273,0.12418100982904434,0.16350342333316803},{-0.12704384326934814,0.1030619665980339,-0.08299089223146439,0.1552608758211136,-0.10589376837015152,0.2704465389251709,0.12591350078582764,-0.010594015941023827,0.2665121257305145,-0.30987149477005005,-0.14958667755126953,0.1505192667245865,-0.16975441575050354,0.04097708687186241,-0.2955508530139923,-0.03198854997754097,0.10708536952733994,0.1686406135559082,0.09452804923057556,-0.13397018611431122,-0.2186174839735031,0.198387011885643,0.1964021623134613,0.17971858382225037,-0.2355423867702484,0.3490905463695526,-0.1072634607553482,-0.019711563363671303,-0.08770398050546646,0.13945622742176056,0.2207227349281311,0.2690051794052124},{-0.16965416073799133,0.2966526746749878,-0.06859349459409714,0.00780718307942152,-0.16875921189785004,-0.13712693750858307,0.1372445970773697,-0.2981839179992676,-0.03778742626309395,-0.23612526059150696,-0.2162608802318573,-0.03718660771846771,0.16477617621421814,-0.2750125229358673,-0.11762303113937378,-0.269622802734375,-0.19844383001327515,-0.06696674227714539,0.299366295337677,-0.3072594404220581,0.08274878561496735,-0.1856461614370346,0.08344245702028275,0.302282452583313,-0.18249031901359558,0.18657082319259644,0.21587921679019928,-0.07101269066333771,-0.03152826428413391,0.3110860288143158,-0.13145232200622559,-0.23097187280654907},{-0.04419409856200218,0.14836442470550537,0.23419895768165588,-0.2799241244792938,0.2613675594329834,0.020426588132977486,-0.11836405098438263,-0.026366861537098885,0.16017884016036987,-0.28017574548721313,-0.09492304921150208,0.010264983400702477,0.16850000619888306,0.0547189898788929,0.028394896537065506,-0.11084987968206406,0.24403268098831177,-0.23344208300113678,0.3171161711215973,0.08314431458711624,-0.16901950538158417,0.24913623929023743,-0.1267170011997223,-0.1785641461610794,0.28745004534721375,-0.1421058177947998,0.02960667572915554,-0.17110136151313782,0.03177231177687645,-0.13412316143512726,0.260822057723999,0.21524988114833832},{0.07112934440374374,-0.13360348343849182,-0.16859960556030273,0.0677810087800026,0.03656996414065361,0.29957783222198486,-0.1003383919596672,-0.2513652443885803,0.2613564133644104,0.018876712769269943,0.053821638226509094,0.08764364570379257,-0.17328904569149017,0.06973741948604584,-0.18819455802440643,-0.26538053154945374,0.014150035567581654,-0.05974165350198746,0.216043621301651,0.37016794085502625,-0.20115245878696442,0.07666794210672379,-0.1213860809803009,-0.01557491160929203,0.11999758332967758,-0.29059305787086487,-0.17600536346435547,-0.2119782567024231,-0.02304515615105629,-0.1726587861776352,0.18044120073318481,-0.2959699332714081},{-0.07995614409446716,0.2731984257698059,0.16699720919132233,-0.20547769963741302,-0.08883175253868103,-0.16156302392482758,0.17842260003089905,-0.022980645298957825,0.22375772893428802,-0.003957328852266073,0.16450506448745728,0.14517885446548462,-0.039216309785842896,0.04613392427563667,-0.1226125955581665,0.1587856411933899,-0.1700456142425537,-0.35196977853775024,-0.24020302295684814,0.11193697899580002,0.12830482423305511,-0.1899043321609497,-0.29785579442977905,-0.21962891519069672,-0.12561631202697754,0.03836006298661232,0.3234671950340271,-0.011337049305438995,-0.06759282946586609,0.13220937550067902,-0.14438685774803162,0.09258796274662018},{-0.19439902901649475,-0.1792568564414978,-0.21528393030166626,0.0032292320393025875,-0.2157650738954544,-0.09096686542034149,-0.029360206797719002,-0.00914786383509636,-0.2916785478591919,-0.2127472162246704,0.17033153772354126,0.13458646833896637,-0.2972364127635956,0.22325076162815094,-0.06342782825231552,0.16182570159435272,0.09775213152170181,0.033038657158613205,0.03379394859075546,0.15373598039150238,0.22298714518547058,0.2795262038707733,0.1362917423248291,0.26236671209335327,0.13207535445690155,-0.2198827713727951,-0.18992023169994354,0.250230073928833,0.0015116839203983545,-0.17629757523536682,-0.1568741351366043,-0.09100265055894852},{-0.29411405324935913,-0.20622406899929047,-0.3314095139503479,0.05032344162464142,-0.1116275042295456,-0.05741041526198387,-0.08385276794433594,0.13943205773830414,-0.09069672226905823,0.07215824723243713,-0.17828041315078735,0.0036734582390636206,0.13585513830184937,-0.1083669364452362,0.0338076613843441,0.17989911139011383,-0.0873446986079216,-0.10693946480751038,0.16791963577270508,0.03651571646332741,0.22281406819820404,-0.0536561943590641,-0.21853107213974,0.060509681701660156,0.17377091944217682,-0.24871666729450226,0.1764204353094101,0.05343068763613701,0.07661653310060501,-0.14605091512203217,0.20263104140758514,-0.06302447617053986},{0.26578986644744873,0.017699573189020157,0.03559080883860588,0.205961674451828,-0.33823224902153015,-0.030945423990488052,0.06200951337814331,0.1684551239013672,-0.07271835207939148,-0.12904813885688782,0.2841598391532898,-0.09613466262817383,0.08225192129611969,-0.05812833830714226,-0.10756746679544449,0.27868780493736267,-0.07407930493354797,-0.1266285926103592,0.10188235342502594,-0.2824566662311554,-0.06107094883918762,-0.24962574243545532,-0.17451778054237366,0.22894087433815002,-0.08698190748691559,-0.04452113062143326,0.1278565526008606,0.060481615364551544,-0.13564608991146088,-0.07025793939828873,-0.03566927835345268,-0.08117454499006271},{0.2943477928638458,-0.06162111833691597,0.0637311115860939,0.05757296085357666,-0.027861760929226875,-0.0723847821354866,0.19109435379505157,-0.22469884157180786,0.24230362474918365,0.2810847759246826,0.04961204156279564,0.14449021220207214,0.20153331756591797,0.3090071976184845,-0.2897982895374298,-0.3499870300292969,-0.2338072955608368,0.07140573114156723,-0.16487455368041992,-0.3603692054748535,-0.14672772586345673,0.21566595137119293,0.06785259395837784,0.14416736364364624,-0.15975981950759888,-0.114651620388031,-0.12426957488059998,-0.22697006165981293,0.24012427031993866,0.18888689577579498,-0.33419665694236755,-0.11344830691814423},{-0.11302977800369263,0.17068561911582947,0.2805502414703369,-0.015970300883054733,-0.025026246905326843,0.0904938131570816,-0.021807009354233742,-0.32077133655548096,0.16078388690948486,0.2360309362411499,0.1842421591281891,0.22395841777324677,-0.2651785612106323,0.17204782366752625,-0.2506217360496521,0.30275148153305054,0.16027292609214783,-0.2563515305519104,0.26263856887817383,0.056053485721349716,-0.33265894651412964,0.27428701519966125,-0.22235387563705444,0.1409730315208435,0.1600736528635025,0.2622050642967224,0.0515456460416317,0.13932763040065765,-0.15866121649742126,0.24180838465690613,-0.06101905182003975,0.10354186594486237},{-0.12954944372177124,-0.1042075902223587,0.03499126806855202,0.17876623570919037,0.022684970870614052,0.2403174787759781,-0.24909813702106476,-0.1106235682964325,-0.1834816187620163,-0.08346281200647354,-0.1079648807644844,-0.19593219459056854,-0.01746247708797455,-0.2068818360567093,0.09719331562519073,-0.20988710224628448,0.24788542091846466,-0.013210915960371494,-0.2721884548664093,-0.30584046244621277,0.14288996160030365,0.12901659309864044,-0.13519659638404846,0.3389635980129242,-0.21885167062282562,0.03551449999213219,0.08982165157794952,-0.10510995239019394,0.1459619402885437,-0.19151027500629425,0.27225223183631897,0.12158240377902985},{0.2998221218585968,0.04954106733202934,0.04879312962293625,0.2289467751979828,-0.24273310601711273,0.14928726851940155,-0.09785162657499313,0.12687994539737701,0.11773303896188736,0.008477386087179184,0.10646776109933853,-0.2980278432369232,-0.25743791460990906,0.06649257987737656,0.0744996890425682,-0.07972966879606247,0.2619450092315674,0.13414305448532104,-0.19184313714504242,-0.2102908492088318,0.3392261266708374,0.19645945727825165,0.22610707581043243,0.08675988018512726,-0.016110427677631378,0.06274475157260895,-0.0476001538336277,-0.16354569792747498,0.20631802082061768,0.0014500381657853723,-0.17154107987880707,0.1046803742647171},{-0.015660729259252548,0.03970269858837128,-0.018619505688548088,-0.24298280477523804,-0.09291824698448181,-0.2372957468032837,-0.20753943920135498,-0.13884416222572327,-0.04319154843688011,-0.03322020173072815,-0.22200705111026764,0.03331008180975914,-0.2421693354845047,-0.15825141966342926,0.010412750765681267,0.0952848568558693,0.2591630220413208,-0.18157128989696503,-0.32104769349098206,0.24134652316570282,-0.16784271597862244,0.23295821249485016,0.04459746181964874,-0.052327871322631836,-0.05362806096673012,0.17065785825252533,-0.07719946652650833,-0.25023820996284485,0.22552736103534698,0.24505707621574402,-0.12858448922634125,0.1789238601922989},{-0.2441946268081665,-0.020481405779719353,0.03568184748291969,-0.026676403358578682,0.09521901607513428,0.11461403220891953,-0.19918754696846008,0.09089072048664093,-0.15309399366378784,-0.14920318126678467,0.0752318724989891,-0.13279804587364197,-0.1793895661830902,0.2665293514728546,0.013126041740179062,0.035660721361637115,0.19552838802337646,-0.25819146633148193,-0.16649819910526276,0.3262191116809845,0.03172438219189644,0.2762846350669861,-0.07309021800756454,0.011725793592631817,-0.1422092169523239,-0.17441010475158691,-0.0015522356843575835,0.28994354605674744,-0.0022080980706959963,0.004176769871264696,0.29402855038642883,0.2939707636833191}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.1292756199836731,0.13142350316047668,0.2264726459980011,-0.001993850339204073},{0.051262252032756805,-0.031207112595438957,0.044740669429302216,0.10469947010278702},{-0.13272005319595337,0.16591066122055054,0.07612765580415726,0.1244761124253273},{0.2974169850349426,0.04366149753332138,0.06143413484096527,0.35632601380348206},{-0.0838657096028328,0.04269421473145485,0.21126069128513336,0.003008827567100525},{-0.1239146739244461,0.17634189128875732,0.15439459681510925,-0.036564767360687256},{-0.17456471920013428,0.017762644216418266,0.0031152009032666683,-0.10375021398067474},{-0.3057294189929962,-0.09887222945690155,0.2813362181186676,-0.2683250606060028},{0.2625797986984253,-0.17408102750778198,-0.233379065990448,-0.30557581782341003},{0.03747427463531494,0.21669018268585205,0.27191656827926636,-0.33008459210395813},{-0.1011488139629364,-0.11441686749458313,-0.16969476640224457,0.16027159988880157},{0.20900572836399078,-0.149968221783638,0.041723839938640594,0.14118927717208862},{0.25509482622146606,0.2712349593639374,-0.06848124414682388,0.06868120282888412},{-0.008908501826226711,0.04048866778612137,-0.23938831686973572,0.02478705532848835},{0.11518854647874832,0.2599998414516449,0.2387954145669937,0.27125120162963867},{0.1327580064535141,0.06318052113056183,0.2036834955215454,0.20680566132068634},{-0.16044682264328003,-0.08934194594621658,-0.14491938054561615,-0.13011349737644196},{-0.13981284201145172,0.09307098388671875,-0.09553278982639313,-0.11057744920253754},{-0.1422305852174759,0.14282013475894928,0.14726251363754272,0.22016523778438568},{-0.018505563959479332,0.3053426146507263,-0.14400514960289001,0.05522964894771576},{-0.19016611576080322,-0.27999764680862427,-0.13505122065544128,-0.025735339149832726},{0.22502346336841583,0.3200419545173645,0.03177512064576149,-0.17310698330402374},{0.003968347329646349,0.13704249262809753,0.1300777643918991,0.11536820977926254},{-0.07651084661483765,0.31876757740974426,-0.04355946183204651,-0.10052260756492615},{0.0030168755911290646,0.0023888004943728447,-0.004797389730811119,-0.007920991629362106},{0.22865067422389984,-0.30777937173843384,-0.05009037256240845,0.04774489253759384},{-0.003404653398320079,-0.2612556219100952,-0.15333344042301178,-0.23017241060733795},{0.07763689756393433,-0.05015172064304352,0.17089655995368958,0.05784614756703377},{-0.0008214078843593597,-0.03015322797000408,0.03265095874667168,0.01806359924376011},{-0.28574997186660767,0.30835291743278503,0.2116718888282776,-0.07871278375387192},{0.26656147837638855,-0.13929791748523712,0.1484905630350113,0.004006626550108194},{0.0400809645652771,-0.2786638140678406,0.2783530652523041,-0.2216181755065918}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.028787167742848396,0.004583321046084166,0.040297213941812515,-0.05455702543258667,-0.032587930560112,-0.16100038588047028,0.05197654291987419,0.04157264158129692,0.005204536020755768,-0.11155175417661667,0.17449600994586945,0.07951060682535172,6.72381283948198e-05,-0.0053603011183440685,0.06704031676054001,0.01926501840353012};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.04800243675708771,0.03387153893709183,0.030590685084462166,0.027649857103824615,0.042537327855825424,0.010492884553968906,0.0350581556558609,0.010304695926606655,0.01149839535355568,0.00598136568441987,-0.04013461992144585,-0.007008674554526806,0.019991403445601463,-0.0283234640955925,-0.051884401589632034,0.02044568955898285};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06915055215358734,0.0563376359641552,0.02155888080596924,0.06898991763591766,0.039989031851291656,-0.0182169321924448,-0.036352794617414474,-0.01130669005215168,-0.028454624116420746,-0.011788892559707165,-0.04763133451342583,0.05320269614458084,0.07195738703012466,-0.07031003385782242,0.07120665162801743,0.06707557290792465,-0.05699417367577553,-0.06296627968549728,-0.0018471749499440193,0.014317870140075684,-0.041681598871946335,0.00482231704518199,0.05930275842547417,0.025598494336009026,-0.01171083189547062,-0.000618469319306314,-0.034679338335990906,0.05672195553779602,0.017324695363640785,-0.001381074427627027,0.021120255813002586,0.02881753072142601};
static const float action_parameterization_distribution_linear_bias[4] = {0.05020902305841446,0.009832806885242462,0.05315233767032623,0.043357569724321365};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.038682177662849426,0.28678056597709656,-0.06037401407957077,0.1447959840297699,0.2071232795715332,0.19383633136749268,0.24855037033557892,-0.003043277421966195},{-0.16217008233070374,-0.08034758269786835,-0.2031046450138092,-0.2928093373775482,-0.3104528486728668,-0.14578896760940552,-0.23219601809978485,-0.13116243481636047},{-0.24352599680423737,0.023630967363715172,0.24158622324466705,0.21385489404201508,0.20162087678909302,-0.011860242113471031,0.12899485230445862,-0.03787536919116974},{-0.012512704357504845,0.0805039256811142,-0.190890371799469,-0.014155391603708267,-0.012287001125514507,-0.07218843698501587,0.13666130602359772,-0.10876746475696564},{-0.27354496717453003,-0.11195563524961472,-0.2376168817281723,-0.17247849702835083,-0.065150186419487,0.20046494901180267,0.12862394750118256,-0.02083490788936615},{-0.339692085981369,0.019446538761258125,0.335366815328598,0.2585678696632385,0.18297864496707916,-0.04148663207888603,-0.12127245217561722,-0.0970163494348526},{-0.14336852729320526,0.08678208291530609,0.32877370715141296,-0.1721007078886032,-0.10588550567626953,-0.3204542100429535,-0.05131974816322327,-0.1543072760105133},{-0.4571852684020996,-0.3214365243911743,0.5311149954795837,-0.027544233947992325,-0.26398536562919617,0.17714399099349976,0.2076474279165268,-0.1815565824508667},{-0.2814584970474243,0.277779221534729,-0.08160477876663208,0.448961079120636,0.02208777703344822,-0.41265782713890076,0.14319787919521332,0.11225952208042145},{-0.2319677174091339,-0.33252662420272827,-0.11192861199378967,-0.17699792981147766,-0.46862953901290894,0.050940029323101044,0.032169315963983536,0.13186627626419067},{0.1939968764781952,0.31737184524536133,0.26001742482185364,-0.03268291428685188,0.2521299123764038,0.028741504997015,-0.19298212230205536,0.24096530675888062},{0.21783119440078735,-0.03582502156496048,0.2903928756713867,0.28614139556884766,-0.16206397116184235,0.22945934534072876,-0.005235843360424042,-0.208962544798851},{0.12705819308757782,-0.2688998281955719,0.23769651353359222,0.016142290085554123,-0.11567170172929764,-0.07120940834283829,-0.13898047804832458,-0.18936572968959808},{-0.21240928769111633,-0.06317685544490814,0.35482025146484375,0.3905111253261566,0.040858834981918335,-0.03734342008829117,-0.20758213102817535,0.05973060801625252},{-0.06899514049291611,-0.12886014580726624,0.1406492292881012,-0.20123711228370667,-0.25106915831565857,-0.15973463654518127,0.15579397976398468,-0.052257221192121506},{-0.04446710646152496,-0.01457744836807251,0.00026506176800467074,-0.3375357985496521,-0.017485463991761208,0.052647702395915985,-0.0790649875998497,0.3522585332393646},{-0.009875908493995667,-0.1770741492509842,-0.1521546095609665,0.0429743193089962,-0.18821309506893158,-0.13384976983070374,-0.12036283314228058,0.03581368550658226},{-0.15666359663009644,-0.18513530492782593,0.0875539556145668,-0.04033118113875389,0.13360023498535156,-0.20121824741363525,0.39051106572151184,0.07960699498653412},{0.05605059117078781,0.16213802993297577,-0.24658538401126862,0.09415201842784882,0.0844096913933754,0.09575575590133667,-0.18975532054901123,0.2561524510383606},{0.18637822568416595,-0.05267271026968956,-0.3439040780067444,0.049346428364515305,-0.15388770401477814,-0.14979994297027588,-0.25259560346603394,-0.018355557695031166},{0.018606608733534813,-0.19879356026649475,0.027051690965890884,-0.1264263540506363,0.16400617361068726,-0.12663906812667847,-0.07143402844667435,0.44649192690849304},{-0.03912363946437836,0.0961364284157753,-0.31724515557289124,0.23933497071266174,0.23236039280891418,0.23754476010799408,0.07240643352270126,-0.2715168297290802},{-0.4273768663406372,-0.12276960909366608,0.08775293827056885,-0.0594729520380497,0.1709280014038086,-0.3416742980480194,0.15456236898899078,-0.25508108735084534},{-0.059855278581380844,0.08524909615516663,-0.13120926916599274,-0.4155930280685425,0.25240951776504517,0.0621846467256546,-0.34609517455101013,0.1311671882867813},{-0.09620045870542526,-0.19443416595458984,-0.1627030372619629,0.11992988735437393,0.19717800617218018,0.2873203754425049,0.24615436792373657,-0.06600135564804077},{-0.1008690670132637,0.052610091865062714,-0.35367387533187866,-0.22929789125919342,0.1647031158208847,-0.03692248463630676,-0.0703783929347992,0.04020492732524872},{0.32350626587867737,0.3343725800514221,-0.23767143487930298,0.26514315605163574,0.10825364291667938,0.2614746689796448,-0.3145162761211395,-0.19373945891857147},{0.4278554320335388,0.2571197748184204,0.09933837503194809,0.08316963165998459,0.23837625980377197,0.05553312599658966,0.22611598670482635,0.33261075615882874},{-0.09734998643398285,0.3164193630218506,0.132477268576622,0.030775224789977074,0.2591977119445801,-0.010540323331952095,-0.42541155219078064,-0.2593863606452942},{-0.14521688222885132,-0.2538194954395294,-0.06822521239519119,-0.18859528005123138,-0.24155539274215698,-0.15034601092338562,0.1853025108575821,0.018950676545500755},{0.4009232521057129,-0.26944392919540405,0.19783341884613037,-0.26763850450515747,0.13796749711036682,0.3079969584941864,0.05376632884144783,-0.16497007012367249},{0.1470412313938141,0.4397675096988678,0.41257521510124207,-0.1933508664369583,-0.1998189091682434,0.18519383668899536,0.1969752311706543,0.02692348323762417}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.07470162212848663,0.3447679877281189,-0.14262185990810394,0.2315395176410675,-0.35172006487846375,0.22594362497329712,0.3889574706554413,0.01733340322971344},{-0.3557897210121155,-0.44363534450531006,-0.299001008272171,-0.33970150351524353,-0.3629656732082367,0.37777236104011536,0.45094236731529236,-0.43004557490348816},{0.04889450594782829,-0.11202410608530045,0.08704160153865814,0.0052023353055119514,-0.08490274846553802,0.3795047402381897,-0.3035963475704193,-0.26259762048721313},{0.30344000458717346,0.014930790290236473,0.06740012019872665,-0.002550361678004265,0.478744775056839,0.3762305676937103,0.35153836011886597,0.3603890836238861},{0.10348499566316605,0.18407981097698212,-0.12367299944162369,-0.05387018248438835,0.11627964675426483,-0.3008521795272827,-0.3380872905254364,0.41544419527053833},{0.4128669798374176,0.0877312421798706,0.053766801953315735,-0.30434322357177734,-0.28531208634376526,-0.46354666352272034,-0.11348778754472733,0.4332742989063263},{-0.2936682105064392,-0.25012442469596863,0.002788822865113616,-0.17400270700454712,0.06747708469629288,0.327017217874527,-0.4578879475593567,0.5321311950683594},{0.061508581042289734,0.01529875211417675,0.022820821031928062,-0.10358191281557083,0.2611708343029022,-0.43619874119758606,0.3348686397075653,-0.4692929685115814}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.0023578412365168333,0.020959850400686264,0.10900647193193436,-0.03928939253091812,-0.061669088900089264,-0.03674083203077316,0.12338027358055115,-0.02990282140672207};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03147129341959953,-0.018265241757035255,0.04179621860384941,-0.09950148314237595,0.01918213441967964,0.0012668351409956813,-0.01309632696211338,-0.05938161537051201};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

