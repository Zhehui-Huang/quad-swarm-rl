#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2840334177017212,0.011183573864400387,-0.10409504175186157,0.3071679174900055,0.28852561116218567,-0.22882740199565887,-0.30564117431640625,0.10764189064502716,0.29906657338142395,-0.3273088335990906,0.5376461744308472,-0.06499078869819641,0.2681073546409607,0.16757065057754517,-0.40646860003471375,0.0475991889834404},{-0.2437611073255539,-0.27093034982681274,-0.2962474524974823,-0.2366601526737213,0.08899927139282227,0.34547704458236694,0.1026497632265091,0.11091310530900955,0.23802243173122406,0.17115649580955505,-0.13351425528526306,-0.05759691447019577,-0.12048928439617157,0.05058309808373451,0.33768534660339355,-0.3141973912715912},{0.13545918464660645,0.2322806566953659,0.20747146010398865,0.301843523979187,-0.08905922621488571,-0.18453650176525116,0.3930191397666931,-0.04038216173648834,0.024565760046243668,-0.07371543347835541,-0.09321176260709763,-0.003095588879659772,0.052424632012844086,0.38286444544792175,-0.26655706763267517,-0.1190318688750267},{0.14909382164478302,-0.17555472254753113,-0.10842041671276093,-0.1389365941286087,0.06093626096844673,0.09289887547492981,0.08921581506729126,-0.19083356857299805,-0.14941924810409546,0.12462032586336136,0.4597884714603424,-0.24020813405513763,-0.19867287576198578,-0.13691332936286926,0.19781890511512756,0.10078834742307663},{-0.30824345350265503,-0.006383687257766724,0.11472160369157791,-0.23357069492340088,0.26176753640174866,0.33758044242858887,0.1380833387374878,-0.20859842002391815,-0.15048348903656006,0.13447953760623932,-0.12020959705114365,-0.39840948581695557,-0.066445492208004,-0.16343334317207336,0.2808710038661957,-0.03832225874066353},{0.05825834348797798,-0.06896792352199554,-0.024780133739113808,-0.05766453593969345,0.11854279041290283,-0.15279510617256165,0.42264094948768616,-0.3251746892929077,-0.1447209119796753,-0.17562606930732727,0.3018515408039093,0.06591443717479706,0.24726198613643646,0.024300377815961838,0.27905088663101196,0.249955415725708},{-0.24604372680187225,0.170529305934906,-0.11859308928251266,0.03351559489965439,-0.24928595125675201,-0.09522192925214767,-0.17558278143405914,-0.02858464978635311,0.1909114420413971,0.32284337282180786,-0.2966350018978119,-0.1209137886762619,0.22748149931430817,0.07052022963762283,-0.22020862996578217,0.3239004611968994},{-0.12657469511032104,0.013589218258857727,-0.09873364865779877,-0.1734429895877838,0.3609132766723633,-0.26935696601867676,-0.2738589942455292,-0.40885210037231445,-0.1596202850341797,-0.2438395917415619,0.35643553733825684,-0.008923882618546486,0.18267400562763214,0.18128646910190582,-0.16669853031635284,0.41095981001853943},{0.22902509570121765,0.08906113356351852,0.03615286201238632,0.05757858604192734,-0.3800402581691742,-0.45750099420547485,0.3159826993942261,-0.33987224102020264,-0.19116875529289246,0.1988513022661209,0.15913407504558563,-0.3121010959148407,-0.17920413613319397,0.10097441077232361,0.17197224497795105,-0.01307662483304739},{0.42488351464271545,-0.5562793016433716,-0.14420631527900696,-0.0443878211081028,0.180685892701149,-0.25757843255996704,-0.24924631416797638,-0.21204271912574768,-0.13815230131149292,-0.010755125433206558,-0.04833189398050308,-0.191088005900383,0.39671674370765686,-0.12056130170822144,-0.4919079840183258,-0.1494491845369339},{0.20142631232738495,0.1769091784954071,-0.33742260932922363,0.1227293610572815,-0.0323018841445446,-0.2718880772590637,-0.16071894764900208,0.11105088144540787,-0.16365602612495422,0.14847446978092194,0.140443816781044,0.2672857642173767,-0.1446523368358612,0.27661898732185364,-0.10484441369771957,-0.1981775313615799},{-0.4348480999469757,0.2596510648727417,0.2521803081035614,-0.28247442841529846,-0.3537726104259491,0.27290430665016174,0.04855518415570259,0.2985000014305115,0.1787329614162445,0.21708783507347107,0.30930864810943604,-0.07225844264030457,0.06568843871355057,-0.055995721369981766,-0.09120482206344604,-0.14186225831508636},{0.12292005121707916,-0.2561293840408325,-0.204711452126503,0.26044246554374695,-0.18460142612457275,-0.26715052127838135,-0.1623568832874298,0.3020426630973816,0.2886512279510498,-0.16782546043395996,-0.16703477501869202,0.10112088173627853,0.3155883848667145,0.13850057125091553,-0.18023179471492767,0.3412608504295349},{0.3119893968105316,0.18200436234474182,-0.17320755124092102,-0.09295633435249329,0.11525580286979675,-0.09828829020261765,-0.1084771528840065,0.2984340488910675,-0.26217830181121826,-0.20745110511779785,-0.1516752541065216,0.013172077015042305,-0.23192182183265686,-0.13602040708065033,-0.25344303250312805,-0.05895251780748367},{0.16022846102714539,0.36742469668388367,0.3979663848876953,-0.4024544060230255,-0.3956206440925598,0.05146582052111626,0.07270967960357666,-0.11361909657716751,0.3673231899738312,0.3419245779514313,-0.19611923396587372,0.09812179207801819,-0.03487439081072807,-0.3369612991809845,-0.010604321956634521,-0.13482666015625},{-0.18529190123081207,-0.19543932378292084,-0.13746413588523865,0.39413654804229736,-0.23045620322227478,-0.13709445297718048,-0.24359741806983948,-0.27726832032203674,-0.5704806447029114,-0.19995446503162384,0.3780801594257355,0.296370267868042,-0.6280226111412048,-0.3497970402240753,-0.636981725692749,-0.13916297256946564},{-0.5447452664375305,0.17178873717784882,-0.46859121322631836,-0.076291024684906,-0.4286269247531891,0.22414745390415192,0.47974133491516113,0.0719209834933281,0.45037972927093506,-0.47054946422576904,0.21386602520942688,-0.3635321855545044,-0.16093607246875763,-0.009694203734397888,-0.2016366720199585,-0.1931600570678711},{0.3119233250617981,-0.6062104105949402,0.2884497046470642,0.33536210656166077,-0.1360798180103302,0.4953548312187195,0.31131282448768616,0.2808597981929779,-0.11779704689979553,-0.32046079635620117,-0.10767985880374908,-0.17764221131801605,-0.05671194568276405,-0.516767144203186,0.17186406254768372,-0.09435851871967316}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06829250603914261,0.3191804587841034,0.24160099029541016,-0.11866907775402069,-0.2193319946527481,0.053278904408216476,-0.012998786754906178,0.3123808205127716,-0.10359534621238708,0.3392781913280487,0.4745737314224243,-0.40403011441230774,0.021828822791576385,0.03699907660484314,0.027565043419599533,-0.14813232421875},{-0.47675469517707825,0.17375656962394714,-0.24492359161376953,0.2899181544780731,0.26786407828330994,-0.15924429893493652,-0.3294334411621094,-0.19398917257785797,0.3595072031021118,0.23951271176338196,-0.06565310060977936,0.273974746465683,-0.4326137602329254,0.2050488144159317,-0.24590453505516052,0.48904937505722046},{-0.31138262152671814,0.11571811139583588,-0.37342125177383423,0.19227133691310883,-0.4732156991958618,-0.29142293334007263,0.09080388396978378,0.14983829855918884,-0.2814246416091919,0.4294419288635254,0.2719746530056,-0.2015606164932251,0.19575420022010803,-0.3012542128562927,-0.17856533825397491,-0.09856030344963074},{0.3393424153327942,-0.2519395053386688,0.12360212206840515,0.41768383979797363,-0.4173671305179596,-0.2976036071777344,0.29569679498672485,0.057293035089969635,0.29264315962791443,-0.06092254817485809,0.3473220467567444,0.08952832967042923,-0.21700933575630188,-0.02585851214826107,0.013303596526384354,-0.4606930911540985},{-0.40700504183769226,-0.043561529368162155,0.17454880475997925,-0.2925654649734497,0.16600099205970764,0.4610435366630554,-0.2826513648033142,0.28669077157974243,-0.22171160578727722,0.23243679106235504,-0.038702305406332016,0.002173133660107851,-0.24084408581256866,-0.02116287685930729,-0.2767798602581024,-0.13808296620845795},{0.07372555136680603,-0.3139772415161133,0.025487734004855156,-0.34582051634788513,0.22729913890361786,0.03974603861570358,-0.16799719631671906,-0.06687578558921814,-0.12799452245235443,0.40804484486579895,0.23290501534938812,-0.016752324998378754,-0.2822476923465729,0.06686468422412872,0.02208114042878151,-0.3024808466434479},{0.2917028069496155,-0.1627516746520996,0.3616412878036499,-0.276881605386734,-0.4104287326335907,-0.08358360826969147,-0.35472944378852844,0.3457604646682739,-0.08961031585931778,-0.2643719017505646,-0.2133980542421341,-0.02488393522799015,-0.032258838415145874,-0.08716326951980591,0.5032493472099304,-0.3531094789505005},{-0.30957362055778503,0.3655416667461395,-0.058605313301086426,0.17815956473350525,-0.03420222923159599,-0.20168821513652802,-0.22908930480480194,0.0615665502846241,0.03124130517244339,0.5324649214744568,0.12081100791692734,-0.09967966377735138,0.05087492987513542,-0.24893654882907867,0.12332354485988617,0.1626974493265152},{0.08688133209943771,0.255447119474411,-0.16123558580875397,-0.368572860956192,0.3566320240497589,-0.1785098761320114,0.10960286855697632,-0.3252077102661133,0.17220154404640198,0.09220913797616959,0.08453444391489029,0.16038838028907776,0.019111957401037216,-0.44209203124046326,-0.015291986986994743,0.2249491959810257},{-0.2647576630115509,0.07814518362283707,-0.31454548239707947,-0.3565419018268585,0.23349924385547638,-0.43107274174690247,-0.15134961903095245,0.29759809374809265,-0.17849218845367432,0.14446595311164856,-0.03333283215761185,-0.10392945259809494,-0.3683041036128998,0.09911417961120605,-0.265980988740921,-0.2909017503261566},{-0.14082495868206024,-0.1455366015434265,0.01160570327192545,-0.24862165749073029,-0.3166005313396454,-0.028517313301563263,0.1542360633611679,-0.437944233417511,0.01992964744567871,-0.11959095299243927,0.27608004212379456,-0.05542865768074989,0.30530381202697754,0.17451155185699463,0.22815586626529694,0.23515687882900238},{-0.07870292663574219,-0.03540685400366783,-0.420563280582428,0.33992987871170044,0.10823822766542435,0.13230092823505402,0.26774296164512634,0.18666395545005798,-0.4635672867298126,0.1798020899295807,-0.3136172890663147,-0.22745543718338013,-0.3630998432636261,0.41402122378349304,-0.36957496404647827,0.06920011341571808},{-0.21140795946121216,-0.5070327520370483,-0.13280422985553741,0.1771632432937622,-0.2344825267791748,-0.020741144195199013,-0.09004451334476471,0.3994758725166321,0.48420003056526184,0.14211872220039368,-0.01912785694003105,-0.18846668303012848,0.16137653589248657,-0.40007323026657104,0.11132711172103882,-0.2102632224559784},{-0.3303905725479126,-0.45570287108421326,-0.202823206782341,-0.15752314031124115,-0.4626248776912689,0.5450568795204163,-0.1644638180732727,0.21374011039733887,-0.10856684297323227,-0.24542944133281708,-0.3765874207019806,0.4672643542289734,-0.21392007172107697,-0.05746033787727356,-0.2747267186641693,0.3873492181301117},{-0.39486071467399597,0.3508429229259491,-0.22909343242645264,0.13277706503868103,-0.4015321731567383,0.18681517243385315,-0.08437713980674744,-0.26914098858833313,0.12235980480909348,0.2650284767150879,-0.27865299582481384,0.05511841922998428,0.23139511048793793,-0.3878941833972931,-0.34510675072669983,-0.1558927297592163},{-0.13121792674064636,-0.346513956785202,-0.4605407118797302,0.2448805719614029,0.08520366996526718,0.07049395889043808,-0.2559531033039093,0.2080489546060562,-0.3486925959587097,-0.2725142240524292,-0.3035912811756134,0.22608737647533417,-0.1878305822610855,0.14444482326507568,0.07989463955163956,0.2844546437263489}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10240115225315094,-0.05579005554318428,0.08803582936525345,-0.1411142349243164,-0.1332336813211441,0.09713713824748993,0.17486967146396637,-0.23073385655879974,-0.11213826388120651,0.2946130335330963,0.09596939384937286,0.16300112009048462,0.10930757224559784,0.1810905933380127,-0.18996833264827728,0.14598248898983002,0.11309664696455002,-0.36310073733329773,-0.2769797146320343,-0.10358880460262299,-0.15381230413913727,0.12668119370937347,-0.24331548810005188,0.2833481431007385,-0.07355866581201553,0.005104918032884598,0.16869689524173737,0.19534337520599365,-0.2578658163547516,-0.21410702168941498,0.2470155507326126,0.3017566204071045},{0.2535719871520996,-0.04733824357390404,0.154405415058136,-0.09933865070343018,-0.11266638338565826,0.2688249349594116,-0.021433521062135696,-0.061911441385746,-0.046991899609565735,0.011160639114677906,-0.157277911901474,0.02379027009010315,0.41168609261512756,0.1593923419713974,0.15488512814044952,0.10621412843465805,-0.26397281885147095,-0.3686525225639343,0.10486405342817307,0.018070818856358528,0.03902174532413483,0.31452295184135437,0.23458361625671387,-0.24003866314888,0.05627139285206795,0.28556281328201294,-0.30632245540618896,0.19462892413139343,0.1533254086971283,-0.22605299949645996,-0.02966809645295143,0.003615341614931822},{-0.11590715497732162,-0.024159369990229607,0.21055714786052704,-0.18679411709308624,-0.24494066834449768,-0.0024522251915186644,-0.20347018539905548,0.20815570652484894,0.18977396190166473,-0.03337028622627258,-0.15122543275356293,0.06490866839885712,0.29533231258392334,-0.1981274038553238,0.08176125586032867,-0.024565331637859344,-0.35462766885757446,0.22916807234287262,-0.31622713804244995,-0.054193586111068726,0.0032217910047620535,-0.136077880859375,-0.0832902193069458,-0.1353069543838501,0.03536516800522804,0.3739330470561981,-0.025413503870368004,0.0977218747138977,0.2636021375656128,-0.3407817780971527,-0.15833601355552673,-0.015871798619627953},{0.17299126088619232,-0.20499467849731445,0.07152779400348663,-0.39828255772590637,0.17828139662742615,-0.0724620446562767,-0.02331436052918434,0.27468961477279663,0.03667079657316208,0.2245761901140213,0.08027353137731552,-0.16736067831516266,-0.2220834642648697,-0.09229331463575363,0.2913227379322052,-0.2575500011444092,0.0780569538474083,-0.08925853669643402,-0.13608796894550323,0.10558171570301056,-0.13933302462100983,0.09978315979242325,-0.19291110336780548,0.2975577712059021,-0.3306998312473297,0.04122880846261978,-0.09528501331806183,-0.2346239984035492,0.01853061281144619,0.07369925826787949,0.22433963418006897,-0.1056676059961319},{0.21632367372512817,0.01416688971221447,0.037713319063186646,0.2841714918613434,-0.2890837788581848,-0.080999456346035,0.1479492485523224,-0.10027622431516647,0.09035065770149231,-0.2168077826499939,0.011347966268658638,-0.04703935980796814,-0.11275817453861237,-0.10293102264404297,0.2944273054599762,0.32449081540107727,-0.11620694398880005,-0.3411109745502472,0.17860844731330872,-0.08319301903247833,-0.140824094414711,0.21795211732387543,0.26941975951194763,0.04645388200879097,-0.025199808180332184,-0.10467593371868134,-0.03432345762848854,0.265036940574646,0.2458886206150055,0.09816686064004898,0.06965917348861694,-0.3037377595901489},{0.3031068742275238,-0.17687071859836578,0.0714690312743187,0.08269903808832169,-0.1538783758878708,-0.2952135503292084,-0.1858409196138382,-0.2892271876335144,-0.2623922824859619,-0.00717305950820446,0.009146274998784065,-0.04504034295678139,-0.1635001003742218,-0.023006871342658997,-0.21663455665111542,-0.24387046694755554,0.18729537725448608,0.03891201689839363,-0.2679557800292969,0.226099893450737,-0.027006210759282112,-0.24161559343338013,0.2057056725025177,-0.14512859284877777,-0.14758765697479248,-0.2736414074897766,-0.1087145283818245,0.10679154843091965,0.09570828825235367,0.27542462944984436,-0.3060806095600128,0.1495928317308426},{0.2224300056695938,0.04082661494612694,0.2607857882976532,-0.19696615636348724,0.2600814998149872,-0.13820312917232513,-0.25126543641090393,0.03684482350945473,0.28576770424842834,0.21237322688102722,-0.1792321503162384,0.05996384471654892,0.07140661031007767,0.32036128640174866,0.14023596048355103,-0.10617651045322418,-0.19431251287460327,0.15010826289653778,-0.008999612182378769,0.006058949511498213,-0.11704907566308975,0.2625075876712799,0.1914951056241989,0.20849278569221497,-0.29968270659446716,-0.2770731449127197,-0.2806073725223541,-0.3861733376979828,0.007948595099151134,-0.06852970272302628,0.25712212920188904,0.16387619078159332},{0.3457218110561371,-0.36946067214012146,0.14268314838409424,-0.4160289764404297,-0.24389450252056122,0.3616366982460022,0.4124453365802765,0.19418223202228546,-0.09802819043397903,0.08090247213840485,0.15473228693008423,-0.17992374300956726,0.12521770596504211,0.29750174283981323,-0.013075371272861958,0.20153573155403137,0.4133392870426178,-0.18661300837993622,-0.046372197568416595,-0.29309195280075073,0.13115492463111877,0.2618015706539154,0.286869615316391,0.19037900865077972,0.04869169369339943,0.06298511475324631,0.09532982110977173,0.2357238382101059,-0.21022933721542358,-0.18870742619037628,0.2529694736003876,0.013309979811310768},{-0.08248013257980347,-0.016096340492367744,0.2252301722764969,0.2506573796272278,-0.23664189875125885,-0.4127490520477295,-0.055444035679101944,0.20851381123065948,-0.20269453525543213,-0.36607569456100464,0.17972823977470398,0.144912451505661,0.0816904827952385,-0.2673238515853882,0.0860104113817215,-0.1860424429178238,-0.15369191765785217,0.15250898897647858,-0.24364277720451355,0.3103947639465332,-0.21312609314918518,-0.44680866599082947,-0.3326423466205597,0.19450023770332336,0.1640547662973404,0.16022825241088867,0.2881104052066803,0.21196973323822021,-0.1632077395915985,-0.33580875396728516,-0.19190488755702972,0.13482241332530975},{0.3818727731704712,-0.00596742145717144,0.0002573907549958676,0.13037382066249847,0.11610161513090134,0.2964341640472412,0.022062432020902634,0.3843052387237549,-0.07439601421356201,0.1262436956167221,0.12975065410137177,0.037922799587249756,-0.25174516439437866,-0.48210546374320984,0.14370831847190857,0.19573143124580383,0.11656016856431961,-0.16246353089809418,-0.03414319083094597,-0.13626311719417572,0.1567334234714508,-0.35026344656944275,0.3035195767879486,0.015952911227941513,-0.11070504039525986,0.13646754622459412,-0.3057907223701477,-0.15199926495552063,0.08505898714065552,0.04282961040735245,0.17213183641433716,0.32751962542533875},{-0.10444988310337067,0.09734948724508286,-0.1491481214761734,0.16969433426856995,-0.13315457105636597,0.260525643825531,0.08927194774150848,-0.036570459604263306,0.32842573523521423,-0.27273163199424744,-0.1664080172777176,0.17910213768482208,-0.17373107373714447,0.009492357261478901,-0.31260934472084045,-0.02450295351445675,0.10412603616714478,0.13518404960632324,0.015577632002532482,-0.19023028016090393,-0.2301095575094223,0.188047856092453,0.1776098757982254,0.17234832048416138,-0.28271248936653137,0.4012109637260437,-0.07113615423440933,-0.014662707224488258,-0.11187388747930527,0.10391569882631302,0.2548966109752655,0.3071492314338684},{-0.3139936923980713,0.34325990080833435,-0.025100456550717354,0.01922190934419632,-0.25655949115753174,-0.26229920983314514,0.1746513396501541,-0.3430803716182709,-0.11514852195978165,-0.40420112013816833,-0.07644130289554596,-0.03976074606180191,0.16193760931491852,-0.19589895009994507,-0.15393169224262238,-0.31997910141944885,-0.17894043028354645,-0.01663076877593994,0.3754844069480896,-0.23466502130031586,0.17890584468841553,-0.2927509844303131,0.039518341422080994,0.2621200680732727,-0.09464916586875916,0.16866528987884521,0.2368461787700653,-0.08404000103473663,-0.034931816160678864,0.2937484681606293,-0.2579804062843323,-0.3502480685710907},{-0.00029442826053127646,0.24276898801326752,0.17543350160121918,-0.250370055437088,0.27178123593330383,0.0007770305965095758,-0.17587894201278687,-0.014989237301051617,0.18407009541988373,-0.2390173226594925,-0.11188492178916931,0.0709935873746872,0.1668759286403656,-0.03355017676949501,0.06953614950180054,-0.044411685317754745,0.18827161192893982,-0.3315747380256653,0.2849724590778351,0.016339214518666267,-0.19837316870689392,0.23311811685562134,-0.13622891902923584,-0.2699148952960968,0.23655308783054352,-0.04194382205605507,0.041869450360536575,-0.08958880603313446,0.10919396579265594,-0.1737671196460724,0.36787280440330505,0.30815213918685913},{0.04080507531762123,-0.26683059334754944,-0.20675581693649292,0.05263650417327881,-0.04925043135881424,0.29229363799095154,-0.13854265213012695,-0.3736433684825897,0.37679916620254517,0.0675220787525177,0.024827660992741585,0.04248613491654396,-0.0581912137567997,0.25068166851997375,-0.24217233061790466,-0.37805309891700745,0.023587936535477638,0.06275041401386261,0.1458778828382492,0.48420414328575134,-0.30248990654945374,0.22778615355491638,-0.17051737010478973,0.14618809521198273,0.17288155853748322,-0.36687347292900085,-0.15908733010292053,-0.37842994928359985,-0.2200426608324051,-0.1699955314397812,0.12924888730049133,-0.4422810673713684},{-0.15016259253025055,0.39468955993652344,-0.018366452306509018,-0.13707438111305237,-0.22170475125312805,-0.3275672495365143,0.061958201229572296,-0.1653849482536316,0.3718329668045044,-0.07417114824056625,0.21679799258708954,0.29965031147003174,0.0034288682509213686,0.09388358891010284,-0.17805953323841095,0.1601467728614807,-0.2230527102947235,-0.4477063715457916,-0.3953968584537506,0.07821930199861526,0.13694961369037628,-0.21768322587013245,-0.42757394909858704,-0.3086557388305664,-0.06836295127868652,0.2183941900730133,0.4384160041809082,0.028307227417826653,-0.1180805116891861,-0.04993700981140137,-0.033502839505672455,0.11069104820489883},{-0.2775326371192932,-0.18754105269908905,-0.19064049422740936,0.051101166754961014,-0.28639957308769226,-0.16411513090133667,-0.0734492838382721,-0.1575099527835846,-0.32042190432548523,-0.2895490229129791,0.24299871921539307,0.14602932333946228,-0.28757569193840027,0.31140199303627014,-0.07704529911279678,0.13093864917755127,0.09473729133605957,0.05929935351014137,0.06242210790514946,0.19597816467285156,0.22458510100841522,0.23523099720478058,0.11494337767362595,0.27236688137054443,0.1313140094280243,-0.24162599444389343,-0.17675617337226868,0.2142900973558426,-0.0853438600897789,-0.19155332446098328,-0.22529950737953186,-0.24492795765399933},{-0.26605209708213806,-0.18617624044418335,-0.3573087453842163,0.11357758939266205,-0.08488763868808746,-0.06047290936112404,-0.11753083020448685,0.1269378960132599,-0.07070405781269073,0.0758044645190239,-0.23640260100364685,0.031040286645293236,0.17522510886192322,-0.10572891682386398,0.05691877752542496,0.23067177832126617,-0.13517774641513824,-0.1601838320493698,0.17772176861763,0.0485093891620636,0.19050776958465576,-0.014920596033334732,-0.1989520639181137,0.039451003074645996,0.2093902826309204,-0.25057315826416016,0.13967962563037872,0.08310465514659882,0.09663418680429459,-0.16145285964012146,0.24899634718894958,-0.04834316298365593},{0.24052314460277557,-0.021809669211506844,0.009284562431275845,0.1683105230331421,-0.32513517141342163,-0.021736817434430122,0.10849925875663757,0.18650557100772858,-0.06203606724739075,-0.1520123928785324,0.30954328179359436,-0.12510614097118378,0.04365779832005501,-0.034376684576272964,-0.15924116969108582,0.24256396293640137,-0.022196631878614426,-0.104739710688591,0.09940903633832932,-0.2950805127620697,-0.009803594090044498,-0.26509058475494385,-0.2105863392353058,0.24300378561019897,-0.06038213521242142,-0.059744350612163544,0.15620577335357666,0.028980769217014313,-0.17794200778007507,-0.06626445055007935,-0.05806132033467293,-0.06532521545886993},{0.3063410520553589,-0.0647202804684639,0.08920086175203323,0.04178854823112488,-0.02711092308163643,-0.09846597909927368,0.18817609548568726,-0.2364577054977417,0.2556133568286896,0.29546481370925903,0.02570493146777153,0.14166469871997833,0.24364648759365082,0.3401893377304077,-0.28601500391960144,-0.3346323072910309,-0.25387197732925415,0.07138088345527649,-0.15852834284305573,-0.28244686126708984,-0.1684897392988205,0.2632349729537964,0.06290111690759659,0.14327223598957062,-0.14087225496768951,-0.12518373131752014,-0.14248915016651154,-0.23641768097877502,0.25322839617729187,0.182368665933609,-0.313288152217865,-0.13510063290596008},{-0.11724807322025299,0.15580414235591888,0.2594795525074005,-0.050923023372888565,-0.04374824836850166,0.052437834441661835,-0.02739039994776249,-0.32663291692733765,0.2111792266368866,0.23977744579315186,0.16627323627471924,0.23705558478832245,-0.22033077478408813,0.21034519374370575,-0.285362184047699,0.2961106598377228,0.1690010279417038,-0.2640434205532074,0.22339580953121185,0.094728484749794,-0.3341965675354004,0.32490408420562744,-0.28222113847732544,0.14125406742095947,0.2458478808403015,0.27744394540786743,0.08402658253908157,0.13453063368797302,-0.182306170463562,0.20782282948493958,-0.04082116112112999,0.11389689892530441},{-0.11022283136844635,-0.10485514253377914,0.0020404215902090073,0.18389949202537537,0.029919885098934174,0.2114533632993698,-0.282154381275177,-0.09090548008680344,-0.13055852055549622,-0.07376115024089813,-0.1689801812171936,-0.17125144600868225,0.027789441868662834,-0.20034697651863098,0.09475337713956833,-0.19534197449684143,0.24232777953147888,-0.041711848229169846,-0.32211834192276,-0.2928570806980133,0.12437035888433456,0.17146259546279907,-0.1810668408870697,0.29717135429382324,-0.2565833032131195,0.06802012771368027,0.1126120537519455,-0.08242646604776382,0.16820186376571655,-0.22580969333648682,0.32257112860679626,0.16453653573989868},{0.3396879732608795,0.041161369532346725,0.11730799078941345,0.19685539603233337,-0.20661406219005585,0.18842685222625732,-0.07095381617546082,0.18585379421710968,0.07861007750034332,0.06433393806219101,0.08332105726003647,-0.34337639808654785,-0.2664843201637268,0.009023972786962986,0.1164894700050354,-0.062090132385492325,0.2637365162372589,0.1512167602777481,-0.1641751080751419,-0.2198151797056198,0.31756049394607544,0.19194599986076355,0.27727290987968445,0.09252873063087463,-0.048000555485486984,0.03082145005464554,-0.08483953028917313,-0.15598151087760925,0.29498663544654846,0.05762504041194916,-0.18484140932559967,0.12062092125415802},{-0.009683717973530293,0.009672515094280243,-0.05480086803436279,-0.23896129429340363,-0.07606234401464462,-0.20834113657474518,-0.22087906301021576,-0.13667958974838257,-0.006576401647180319,-0.006074986886233091,-0.27899137139320374,0.01542848814278841,-0.22096672654151917,-0.153227761387825,0.006801137235015631,0.10051389783620834,0.2690308392047882,-0.17736133933067322,-0.33192527294158936,0.2559009790420532,-0.1927390992641449,0.28865519165992737,0.030257053673267365,-0.024223439395427704,0.026720941066741943,0.15077339112758636,-0.08482509106397629,-0.2611595392227173,0.22106868028640747,0.2514248788356781,-0.1255216896533966,0.18834057450294495},{-0.2570030093193054,-0.035330548882484436,0.0355498380959034,-0.038007449358701706,0.08679355680942535,0.1208629310131073,-0.17530901730060577,0.11817862093448639,-0.16847975552082062,-0.1739044189453125,0.11231768131256104,-0.137692391872406,-0.20759671926498413,0.2368425726890564,-0.0006033871904946864,0.009495665319263935,0.21028867363929749,-0.23910090327262878,-0.16737286746501923,0.2750494182109833,0.05079115182161331,0.22053886950016022,-0.053957194089889526,0.00718903262168169,-0.27504706382751465,-0.17650683224201202,0.028094273060560226,0.2878711223602295,-0.0037258928641676903,0.009733233600854874,0.2702184021472931,0.29875269532203674}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.07017293572425842,0.2571505606174469,0.4804634153842926,-0.07927440106868744},{0.13876807689666748,-0.16965897381305695,0.0625540241599083,0.2584812045097351},{-0.16876326501369476,0.18789689242839813,0.1700931042432785,0.1357596218585968},{0.3145928978919983,0.004346912726759911,0.046360164880752563,0.4954308569431305},{-0.12505672872066498,0.10872764885425568,0.4123014211654663,-0.08429916948080063},{-0.10355853289365768,0.2709828317165375,0.3043805658817291,-0.16816124320030212},{-0.3241684138774872,-0.017727989703416824,0.0006878353888168931,-0.13427719473838806},{-0.41863465309143066,-0.16293464601039886,0.4671863913536072,-0.33386218547821045},{0.412399023771286,-0.1622406244277954,-0.3032726049423218,-0.44836586713790894},{0.07608935236930847,0.3554416000843048,0.41876596212387085,-0.5312790870666504},{-0.21963775157928467,-0.19720971584320068,-0.27718105912208557,0.19836871325969696},{0.445831298828125,-0.24976350367069244,-0.0595121830701828,0.23571360111236572},{0.35280245542526245,0.2808501422405243,-0.05799642205238342,0.13171985745429993},{0.029653392732143402,0.13542728126049042,-0.35517221689224243,-0.022061994299292564},{0.11137638241052628,0.33122286200523376,0.462264746427536,0.3484373092651367},{0.20598769187927246,0.019428003579378128,0.3320026397705078,0.2649018466472626},{-0.2871452271938324,-0.08782748132944107,-0.09167272597551346,-0.31802380084991455},{-0.27460891008377075,0.16346265375614166,-0.17897960543632507,-0.10502939671278},{-0.25082629919052124,0.2497802972793579,0.1835910677909851,0.36749348044395447},{-0.04725223407149315,0.3758673369884491,-0.24307742714881897,0.08610424399375916},{-0.33252787590026855,-0.40820372104644775,-0.10124070942401886,0.06598138809204102},{0.41093674302101135,0.5504973530769348,0.05910860002040863,-0.3813900053501129},{-0.08396090567111969,0.2380940318107605,0.2831248641014099,0.1847650706768036},{-0.1345996856689453,0.41735899448394775,-0.08699476718902588,-0.17400439083576202},{0.06727571785449982,-0.04413701966404915,-0.14098785817623138,0.04559263586997986},{0.3371736705303192,-0.5282567739486694,0.005348497536033392,0.04705740138888359},{0.020033029839396477,-0.4345206320285797,-0.26626691222190857,-0.21763890981674194},{0.1287882775068283,-0.2007269561290741,0.19087055325508118,0.2435733526945114},{0.013624177314341068,-0.0605805478990078,0.1641707420349121,0.06762441992759705},{-0.4260607063770294,0.3840808570384979,0.25752702355384827,-0.06510263681411743},{0.3896181881427765,-0.15672385692596436,0.25846999883651733,-0.12842336297035217},{0.10012628883123398,-0.4807693064212799,0.5087383389472961,-0.362631618976593}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.06324530392885208,-0.03851323202252388,0.04892060160636902,-0.03561629727482796,-0.030632823705673218,-0.13181515038013458,-0.1218162253499031,0.05861613526940346,0.0471145361661911,-0.018562104552984238,0.08182045072317123,0.06308714300394058,-0.08476397395133972,-0.13032862544059753,0.07205641269683838,-0.08315951377153397};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06371321529150009,0.0680411159992218,0.0260690338909626,0.017878135666251183,0.07475889474153519,-0.021453239023685455,0.09382414072751999,-0.01919044367969036,-0.03128663823008537,0.027874816209077835,-0.018540050834417343,-0.04947195574641228,0.07713932543992996,-0.04183255881071091,-0.03871026262640953,-0.03576964884996414};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07852927595376968,0.06786441057920456,0.023078028112649918,0.0727754682302475,0.05395001918077469,-0.0027680532075464725,-0.04353489726781845,-0.01782890409231186,-0.026963377371430397,0.019178608432412148,-0.06618647277355194,0.04081578925251961,0.06362952291965485,-0.07398805022239685,0.09156350046396255,0.08707042783498764,-0.07328810542821884,-0.06966105103492737,0.02345307357609272,0.0027617672458291054,-0.05608018860220909,0.01875641755759716,0.08245599269866943,0.003814729629084468,-0.03315598517656326,0.00617549754679203,-0.06407790631055832,0.056346382945775986,0.04925146698951721,0.015584795735776424,0.037226442247629166,0.04008542001247406};
static const float action_parameterization_distribution_linear_bias[4] = {0.04386743903160095,0.019656533375382423,0.06376547366380692,0.04686679691076279};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.0033739812206476927,0.25321725010871887,-0.13524045050144196,0.19134187698364258,0.23530852794647217,0.11816033720970154,0.27338922023773193,-0.014663406647741795},{-0.22214005887508392,-0.06759624928236008,-0.2806496322154999,-0.24699954688549042,-0.29896312952041626,-0.1818980574607849,-0.13749997317790985,-0.19191323220729828},{-0.2899198532104492,0.012643183581531048,0.23506921529769897,0.21544761955738068,0.25633305311203003,-0.019147519022226334,0.2382451742887497,-0.11804572492837906},{-0.01594707928597927,0.07789318263530731,-0.18394991755485535,-0.021187616512179375,-0.005660446360707283,-0.054414767771959305,0.23679685592651367,-0.19300854206085205},{-0.34285101294517517,-0.13535350561141968,-0.22724059224128723,-0.14689011871814728,-0.0229581817984581,0.17694146931171417,0.1444360613822937,-0.0446096733212471},{-0.31970298290252686,-0.014185594394803047,0.38267022371292114,0.22518599033355713,0.20705781877040863,-0.10922446101903915,-0.1525861769914627,-0.1364986002445221},{-0.22834274172782898,0.04992438107728958,0.3993794322013855,-0.22385111451148987,-0.07869973033666611,-0.40617451071739197,-0.1142798513174057,-0.1512804627418518},{-0.32299184799194336,-0.35819506645202637,0.4789745509624481,-0.10592660307884216,-0.1864452362060547,0.22107471525669098,0.15068992972373962,-0.24403521418571472},{-0.3121544122695923,0.2640050947666168,-0.1880791336297989,0.36606478691101074,0.0811622142791748,-0.36233216524124146,0.07552704960107803,0.05924888700246811},{-0.30855631828308105,-0.3216460347175598,-0.16841711103916168,-0.2084691971540451,-0.5378880500793457,0.0905110165476799,-0.012666868977248669,0.10230822116136551},{0.17140035331249237,0.3388495147228241,0.20969225466251373,-0.029230698943138123,0.16387267410755157,0.10378921031951904,-0.21480339765548706,0.16105395555496216},{0.19967536628246307,0.03286273404955864,0.28217941522598267,0.2318868786096573,-0.3000198006629944,0.28334566950798035,0.0017408315325155854,-0.2731369435787201},{0.11491868644952774,-0.2922945022583008,0.26329687237739563,-0.055535562336444855,-0.3186257481575012,-0.07536803930997849,-0.1662350296974182,-0.1567448526620865},{-0.22165602445602417,-0.17235484719276428,0.3029352128505707,0.34236958622932434,-0.22349224984645844,-0.07626021653413773,-0.2885567247867584,0.17281024158000946},{0.019480811432003975,-0.1575348675251007,0.061523567885160446,-0.24024638533592224,-0.37357497215270996,-0.15147504210472107,0.22347067296504974,0.00393754243850708},{0.1513029932975769,-0.023789681494235992,-0.06903521716594696,-0.3295581340789795,-0.062043748795986176,0.06039241701364517,-0.0019503264920786023,0.38497066497802734},{-0.0046191709116101265,-0.21850542724132538,-0.2106872797012329,0.025897175073623657,-0.14283441007137299,-0.11263013631105423,-0.13363970816135406,0.08536232262849808},{-0.16503556072711945,-0.27018609642982483,0.03870784491300583,-0.007210938725620508,0.17832113802433014,-0.19767379760742188,0.36760127544403076,0.1282580941915512},{0.058162204921245575,0.12161986529827118,-0.24854883551597595,0.09366586804389954,0.11948273330926895,0.1747901439666748,-0.2088465839624405,0.29472094774246216},{0.19707584381103516,-0.03883056715130806,-0.37003153562545776,0.06518880277872086,-0.046141114085912704,-0.06396913528442383,-0.3095846474170685,-0.037172023206949234},{0.0976950004696846,-0.13941290974617004,0.04849854111671448,-0.13262853026390076,0.3007757365703583,0.0014049990568310022,-0.07561100274324417,0.42367443442344666},{0.05088009685277939,0.1439877152442932,-0.27313733100891113,0.2097325176000595,0.31104525923728943,0.30555078387260437,0.138592928647995,-0.3064454197883606},{-0.3659361004829407,-0.10752297192811966,0.13210071623325348,-0.0967455804347992,0.20448678731918335,-0.3234763443470001,0.16200605034828186,-0.24291439354419708},{-0.11082442849874496,0.07660461217164993,-0.08014761656522751,-0.4011833369731903,0.23395965993404388,-0.025232365354895592,-0.3751765787601471,0.21255019307136536},{-0.188722163438797,-0.16896696388721466,-0.013196307234466076,0.09396804124116898,-0.042107004672288895,0.16075800359249115,0.2870978116989136,-0.05116090923547745},{-0.1965303122997284,0.07201377302408218,-0.35114672780036926,-0.2834017872810364,0.13547174632549286,0.0037016996648162603,-0.09879843890666962,0.11467418819665909},{0.3379145562648773,0.3841939866542816,-0.26526471972465515,0.16906209290027618,0.16522978246212006,0.3439846932888031,-0.2968112528324127,-0.11441286653280258},{0.40090012550354004,0.2550552487373352,0.07784748822450638,0.05764107406139374,0.22782328724861145,0.14271759986877441,0.2361908107995987,0.3923697769641876},{-0.10846367478370667,0.3995313346385956,0.16687029600143433,-0.006254743784666061,0.2061338573694229,0.034659747034311295,-0.3700082302093506,-0.2951078712940216},{-0.1421341896057129,-0.22074562311172485,0.06678116321563721,-0.2233402281999588,-0.3105904459953308,-0.20347581803798676,0.2789812684059143,-0.05524540692567825},{0.41575345396995544,-0.2650587260723114,0.30313223600387573,-0.27152758836746216,0.06770358979701996,0.2406337559223175,0.16278286278247833,-0.21132934093475342},{0.2455977201461792,0.39746662974357605,0.37585511803627014,-0.23409122228622437,-0.18262137472629547,0.08286906778812408,0.24163131415843964,0.055337004363536835}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.012514286674559116,0.39380255341529846,-0.1694398820400238,0.24420413374900818,-0.39985209703445435,0.27041131258010864,0.4237613379955292,0.06577087938785553},{-0.438783198595047,-0.49835535883903503,-0.3760114312171936,-0.44708219170570374,-0.44601061940193176,0.3921601176261902,0.44822925329208374,-0.4165809452533722},{-0.010684710927307606,-0.15663151443004608,0.1073087528347969,0.05593865364789963,-0.07237906754016876,0.447201669216156,-0.360041081905365,-0.363495796918869},{0.5110229253768921,0.017721958458423615,0.0829300731420517,-0.024265924468636513,0.5525224804878235,0.3900481164455414,0.33448606729507446,0.40560394525527954},{0.075922891497612,0.27572935819625854,-0.15254437923431396,-0.11088491231203079,0.07785968482494354,-0.38855576515197754,-0.37629422545433044,0.44895556569099426},{0.38441672921180725,0.06988053768873215,0.049116432666778564,-0.3884293735027313,-0.43736571073532104,-0.49271002411842346,-0.10564832389354706,0.5256279110908508},{-0.48909610509872437,-0.35038426518440247,-0.04132559522986412,-0.24524323642253876,0.0054064407013356686,0.4595818817615509,-0.5254024863243103,0.6040661334991455},{0.23490607738494873,0.0827859565615654,0.007788420654833317,-0.026547932997345924,0.4148711860179901,-0.5526503920555115,0.4354041814804077,-0.40058350563049316}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.06236964836716652,0.0027903167065232992,0.03877020254731178,-0.025516968220472336,-0.009178963489830494,0.029346991330385208,0.013927051797509193,0.018835192546248436};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.014458540827035904,-0.03967260196805,0.024218710139393806,-0.07731237262487411,-0.0002929719630628824,-0.02893511764705181,-0.027553077787160873,-0.07070910930633545};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

