#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3460838198661804,-0.1012277752161026,0.30077433586120605,0.12561628222465515,-0.28438645601272583,0.2945941984653473,0.008072830736637115,-0.1141323521733284,0.11197508871555328,0.30347028374671936,0.09177527576684952,0.005858134478330612,0.20666182041168213,-0.22036318480968475,0.2685997486114502,-0.028752245008945465},{-0.2059113085269928,-0.3953257203102112,0.29304584860801697,0.06734494864940643,-0.2042563110589981,0.16080553829669952,-0.42348408699035645,-0.04642985016107559,-0.10394562780857086,-0.20426742732524872,0.02245941013097763,-0.1883440762758255,-0.02422655001282692,-0.3236226439476013,-0.28510597348213196,0.11901538074016571},{-0.14523650705814362,-0.26484835147857666,-0.4723455607891083,0.20381702482700348,0.28095149993896484,0.6266328692436218,0.032525435090065,-0.03404885530471802,0.1560862809419632,-0.5845739841461182,-0.4232744574546814,0.8369675874710083,-0.274058073759079,-0.32511812448501587,-0.4275010824203491,0.32817938923835754},{0.17691412568092346,0.2520676851272583,0.36352455615997314,-0.03998541831970215,-0.37709590792655945,-0.01927787996828556,0.26649460196495056,0.07778991013765335,0.32472410798072815,-0.3155743181705475,0.011280536651611328,0.40885019302368164,-0.23446519672870636,-0.020059719681739807,0.47737187147140503,-0.4705001711845398},{-0.09570803493261337,0.046714819967746735,0.3100930154323578,-0.04749837517738342,0.3073759973049164,0.43373045325279236,0.16906875371932983,-0.04151011258363724,0.10468068718910217,0.1943819373846054,0.2761685848236084,-0.3392255902290344,-0.17327050864696503,-0.42790257930755615,0.3549540340900421,0.09705140441656113},{-0.2765216529369354,-0.1808917224407196,-0.2190961390733719,-0.043625395745038986,0.22188155353069305,0.23424780368804932,0.009415972046554089,-0.09998981654644012,0.3355237543582916,-0.3178562819957733,-0.44993048906326294,0.2574974298477173,0.07533898949623108,-0.17020480334758759,-0.018325133249163628,0.10776960849761963},{0.048933111131191254,0.1363838016986847,0.04933749511837959,-0.4218597114086151,0.14092044532299042,-0.03260297328233719,0.04767640680074692,0.3490300178527832,0.3213141858577728,0.05412265285849571,-0.4054414629936218,-0.029606245458126068,-0.0008207118371501565,0.17450706660747528,-0.23953081667423248,-0.2273939847946167},{-0.2999632954597473,0.4498293995857239,0.4425477087497711,0.37398630380630493,-0.4779071807861328,-0.06553766131401062,0.6028547286987305,0.530683159828186,-0.2603766620159149,0.2986831068992615,-0.7369396686553955,-0.43525171279907227,0.45115986466407776,0.05908430740237236,0.25808238983154297,0.4503762722015381},{0.4092593491077423,-0.310040146112442,0.6323517560958862,0.10072069615125656,-0.007628162857145071,0.058618590235710144,0.14079724252223969,-0.6802417039871216,-0.24479800462722778,-0.39087918400764465,-0.17086763679981232,0.011575204320251942,-0.06497319787740707,0.743295431137085,0.47739675641059875,-0.33529096841812134},{0.19063423573970795,-0.6185276508331299,-0.6628240346908569,-0.3771384656429291,-0.22855141758918762,0.252601683139801,0.11912542581558228,0.11443451792001724,0.6438270211219788,0.2760128974914551,0.21375344693660736,-0.26823747158050537,-0.14382092654705048,0.45484378933906555,-0.22526335716247559,-0.5914708375930786},{0.2035064697265625,0.4337839186191559,0.41785183548927307,-0.5801197290420532,-0.3663167953491211,0.13444729149341583,0.18049660325050354,0.4500700831413269,-0.3925209045410156,0.038509633392095566,-0.05869258940219879,-0.028493070974946022,-0.1307210773229599,-0.19357804954051971,0.26003971695899963,-0.4186604917049408},{-0.058999672532081604,-0.4534195363521576,0.18436883389949799,0.6720874309539795,0.8617986440658569,0.4475780129432678,0.455834299325943,0.4599979519844055,0.03483978658914566,-0.021275034174323082,0.26561301946640015,-0.46075114607810974,-0.6358692646026611,-0.41243571043014526,0.8133636116981506,-0.03151027858257294},{-0.23623734712600708,0.38745301961898804,-0.07366778701543808,-0.6166245937347412,0.1720702052116394,0.09107882529497147,0.17974574863910675,0.17642219364643097,0.05925681069493294,0.009863320738077164,0.0580151230096817,0.1901201456785202,0.35831698775291443,0.32519426941871643,-0.1135021448135376,-0.11539105325937271},{0.03311128169298172,-0.3918095529079437,-0.2543398439884186,-0.18772076070308685,-0.4497769773006439,0.03702341020107269,-0.3290344476699829,-0.32666364312171936,-0.25857409834861755,-0.036628641188144684,-0.44819578528404236,-0.001699351123534143,-0.19299310445785522,0.407381147146225,0.10636559873819351,-0.005373029969632626},{0.05985412746667862,-0.26468607783317566,-0.227896049618721,0.19815969467163086,-0.12405940890312195,-0.4562409222126007,0.2921467125415802,-0.07975815236568451,-0.021770603954792023,0.37762683629989624,0.08118126541376114,0.042645182460546494,0.29948392510414124,-0.0034153503365814686,-0.23749521374702454,0.2057197242975235},{0.3601594865322113,0.003916453570127487,-0.24068313837051392,-0.1442846953868866,-0.29119113087654114,0.14836128056049347,0.3107427954673767,-0.08038585633039474,0.15784844756126404,0.327982634305954,-0.14900757372379303,0.05346081778407097,-0.17284847795963287,0.23118160665035248,-0.06519272923469543,-0.013020133599638939},{-0.23038271069526672,-0.19937600195407867,0.24008356034755707,0.12111275643110275,-0.23301710188388824,0.054651908576488495,-0.18198849260807037,-0.09529101103544235,-0.19847188889980316,-0.2633640468120575,-0.034830864518880844,-0.2877213656902313,0.06583618372678757,-0.2010861486196518,0.070820651948452,-0.2058670073747635},{-0.24511802196502686,0.24674759805202484,-0.31693899631500244,-0.19103102385997772,0.05465146154165268,0.30740106105804443,-0.17544987797737122,-0.21182365715503693,0.11383230984210968,0.13557498157024384,0.33622100949287415,-0.12444628030061722,-0.3054809272289276,0.2956106960773468,0.007761602755635977,-0.3900134861469269}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.024108553305268288,-0.06075062230229378,-0.09123414754867554,-0.3364489674568176,0.302093505859375,0.2870878279209137,0.07793969660997391,0.04857075586915016,-0.07185731828212738,-0.18205514550209045,0.008383632637560368,0.06531564146280289,0.20073413848876953,0.30024072527885437,0.15818527340888977,0.046347521245479584},{-0.14103196561336517,-0.29723066091537476,-0.049725648015737534,0.037335820496082306,0.23929014801979065,-0.2862336337566376,0.021276824176311493,0.04955427348613739,-0.05168211832642555,0.2697474956512451,-0.21801018714904785,0.3182324171066284,-0.37838077545166016,0.16815437376499176,-0.23605209589004517,-0.3436374068260193},{0.028549348935484886,0.20852696895599365,-0.3888533115386963,-0.5161617398262024,0.20631802082061768,0.44015228748321533,-0.08589699119329453,0.06344310939311981,-0.2655407786369324,-0.24171140789985657,-0.012274093925952911,0.3313206434249878,-0.28581351041793823,-0.12449586391448975,0.08490442484617233,-0.08837062120437622},{0.13421514630317688,-0.0674034059047699,0.09028318524360657,0.17009924352169037,-0.43886131048202515,0.002401219215244055,0.06566105782985687,-0.19459813833236694,0.28029653429985046,0.36184775829315186,-0.1725337952375412,-0.14816775918006897,-0.4201502203941345,-0.3370665907859802,0.17655783891677856,0.13419902324676514},{-0.03844151273369789,0.15829995274543762,0.008883299306035042,0.2707112431526184,-0.2365141361951828,0.09767252206802368,-0.01319270022213459,0.1716001033782959,0.24876628816127777,-0.2111269235610962,0.19259122014045715,0.2413138896226883,0.18407951295375824,-0.44270655512809753,0.0337066724896431,0.03968926891684532},{0.19744303822517395,0.25717025995254517,-0.004844249691814184,0.19430282711982727,-0.4971860349178314,-0.4430183172225952,0.2698945999145508,0.3296123147010803,0.057786665856838226,0.3738059997558594,0.22878742218017578,-0.2586591839790344,0.000306641188217327,-0.15751580893993378,-0.11823668330907822,0.28643330931663513},{-0.11223918944597244,0.26027992367744446,0.2929723858833313,-0.3707841634750366,-0.2560828924179077,0.0015296495985239744,-0.35227155685424805,-0.038177717477083206,0.18290424346923828,0.061993762850761414,-0.12619812786579132,-0.2126423567533493,-0.31710681319236755,-0.09667292982339859,0.2012946456670761,0.0171064343303442},{-0.11155448853969574,-0.12362947314977646,-0.46171993017196655,0.287822961807251,-0.3038756549358368,-0.24745920300483704,-0.23626182973384857,-0.3777095377445221,0.1471291482448578,-0.19910942018032074,0.06279220432043076,0.05821167305111885,-0.14576365053653717,0.41720473766326904,-0.02310352958738804,-0.2935483455657959},{-0.3093174397945404,0.25040003657341003,-0.008319351822137833,-0.05288331210613251,0.2699662744998932,-0.2804871201515198,0.2884696424007416,0.13875609636306763,0.3363892436027527,0.31344708800315857,0.2558833658695221,0.30432504415512085,0.17914661765098572,-0.11071555316448212,0.24210651218891144,0.09667039662599564},{0.08445356041193008,-0.27206405997276306,-0.1335061937570572,-0.1256287544965744,0.2285902053117752,-0.16198591887950897,-0.29281532764434814,-0.1510736495256424,0.046495456248521805,-0.3729890286922455,-0.25995349884033203,0.3124563694000244,0.10704999417066574,0.08353938162326813,-0.27825233340263367,0.22220388054847717},{-0.03468861058354378,-0.44394493103027344,0.28391513228416443,0.2748261094093323,0.2694281041622162,0.15983246266841888,0.14566315710544586,-0.1294851452112198,0.24059535562992096,-0.20660942792892456,0.1726309210062027,0.33487555384635925,0.4845455288887024,0.11128252744674683,-0.02545573003590107,0.0416974239051342},{0.0451238676905632,-0.006392435636371374,0.40286344289779663,-0.017552657052874565,-0.2502453029155731,-0.19267739355564117,0.4224018156528473,0.30183887481689453,-0.2360369712114334,-0.18698664009571075,-0.04462528973817825,-0.35731157660484314,-0.004892612341791391,-0.3008296489715576,-0.2871502637863159,0.085536427795887},{-0.15902641415596008,-0.3162408173084259,0.4135964512825012,-0.2333160638809204,0.380014032125473,-0.3057929575443268,-0.4639223515987396,0.057984475046396255,0.10468980669975281,0.06276674568653107,-0.3111427426338196,0.1207994893193245,0.11014728248119354,-0.26493480801582336,-0.21984586119651794,0.003629217389971018},{0.37641698122024536,-0.333363801240921,0.449321985244751,0.08557959645986557,-0.10147084295749664,0.33586281538009644,-0.11621125787496567,-0.2241971641778946,-0.3962923288345337,0.08327334374189377,0.02156447246670723,-0.3512721657752991,-0.12345071136951447,0.0831758975982666,0.3217526376247406,0.04184551537036896},{-0.10052867978811264,0.19535432755947113,0.13101789355278015,-0.48911741375923157,-0.18495593965053558,0.20639067888259888,0.23461419343948364,-0.24970771372318268,0.24133244156837463,-0.25678750872612,0.07924434542655945,0.10723677277565002,-0.03371565043926239,0.19540435075759888,0.03963424265384674,0.06510229408740997},{-0.1268690824508667,0.39488139748573303,-0.44039857387542725,0.39935287833213806,0.07964543998241425,-0.3797683119773865,-0.008331473916769028,-0.0781143307685852,-0.3157084584236145,0.3669034242630005,-0.28601497411727905,0.25013279914855957,-0.09112384170293808,-0.29165828227996826,-0.10555297136306763,-0.45366841554641724}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12522172927856445,0.09766466170549393,0.009044471196830273,-0.045846011489629745,-0.08291622251272202,-0.0007381550967693329,0.26443272829055786,0.07574155926704407,-0.15742328763008118,-0.18280577659606934,0.10990112274885178,-0.26022064685821533,-0.1768696904182434,0.24997128546237946,0.2086545079946518,0.31299519538879395,-0.25840291380882263,-0.2686528265476227,-0.1905338019132614,0.13881969451904297,-0.04955528303980827,-0.3550301194190979,-0.26803916692733765,-0.2673324644565582,-0.2241666167974472,0.1171972006559372,-0.2286810576915741,-0.06676118075847626,-0.08306827396154404,-0.0015045767650008202,0.20980121195316315,-0.2088281363248825},{0.305425226688385,0.1506332904100418,0.18725675344467163,-0.0797215923666954,0.12884566187858582,-0.15443666279315948,0.34558090567588806,0.1602143496274948,-0.12182912975549698,-0.07179497927427292,-0.1277582049369812,-0.24680981040000916,-0.19083301723003387,0.235404834151268,-0.2653234302997589,-0.19282683730125427,-0.052699100226163864,0.175127774477005,-0.34961894154548645,-0.20805878937244415,-0.020089970901608467,0.20506428182125092,0.016071906313300133,0.03419918566942215,0.2236720770597458,-0.34154582023620605,-0.05810125172138214,0.06294015049934387,0.15575309097766876,-0.09703649580478668,-0.07079149037599564,0.20679455995559692},{0.1718701869249344,0.04805527627468109,-0.12893445789813995,0.1420317441225052,-0.15269534289836884,-0.14311563968658447,-0.21697178483009338,0.0565977580845356,-0.17026226222515106,0.3359360694885254,-0.3151848614215851,-0.2688271403312683,0.18047977983951569,-0.4018232822418213,-0.1443738043308258,0.09561086446046829,-0.08035074174404144,-0.11254958808422089,0.19286881387233734,-0.1005641296505928,0.2370520532131195,0.2752513587474823,-0.2210327535867691,0.02159247174859047,-0.26232340931892395,-0.024501197040081024,0.14333418011665344,-0.06588902324438095,0.01067135389894247,-0.2005927562713623,-0.10364609211683273,-0.07536972314119339},{0.3915790021419525,0.05692235752940178,0.12815256416797638,-0.18399816751480103,-0.24786674976348877,-0.042704034596681595,-0.12639972567558289,0.27226966619491577,0.2288549244403839,-0.2955797612667084,-0.060560185462236404,0.2544694244861603,0.11578146368265152,-0.011879755184054375,-0.2420162409543991,0.2946239411830902,-0.295463502407074,0.2673729956150055,-0.002988487482070923,0.10640313476324081,-0.09825071692466736,-0.08779742568731308,0.29161930084228516,0.15708820521831512,0.15796132385730743,-0.3563876450061798,0.2640298306941986,-0.20824624598026276,-0.03752269595861435,0.05237475410103798,-0.20955874025821686,0.13833929598331451},{-0.06804578006267548,-0.050888609141111374,-0.11661039292812347,0.12150069326162338,0.20629112422466278,-0.1406172662973404,-0.4107898771762848,-0.0770360603928566,-0.10626702755689621,-0.311303973197937,0.15405716001987457,0.2473815530538559,-0.05620211362838745,-0.11954490840435028,-0.09611771255731583,0.12469026446342468,-0.023801444098353386,-0.03970453888177872,-0.2991819679737091,-0.19971972703933716,-0.17425361275672913,-0.3480202555656433,0.14198948442935944,0.13426628708839417,-0.10676588118076324,0.3472209572792053,-0.17845335602760315,0.21763402223587036,0.2812861204147339,0.3789224922657013,-0.020715953782200813,0.37979361414909363},{-0.2781437933444977,0.02979153022170067,-0.2342466413974762,-0.0551685206592083,-0.19891011714935303,0.23539181053638458,0.20839959383010864,0.016384847462177277,0.2570553123950958,0.2172536998987198,0.33279088139533997,-0.2273833453655243,-0.2761745750904083,0.19854238629341125,0.34189078211784363,-0.33425644040107727,-0.11556103080511093,-0.2475164830684662,0.23640473186969757,0.1113913357257843,0.08756079524755478,0.18794970214366913,0.06648285686969757,-0.07932458817958832,-0.33486407995224,0.3382134437561035,-0.13800016045570374,0.2140389233827591,0.301372766494751,0.17970764636993408,0.06572365760803223,0.01570543646812439},{0.2006789892911911,-0.13443274796009064,-0.12443733960390091,-0.28835412859916687,-0.044809792190790176,0.23717623949050903,0.2817573547363281,0.1847067028284073,0.08516178280115128,0.34506258368492126,-0.0056697288528084755,-0.013897411525249481,-0.4793727695941925,-0.17211338877677917,-0.1572684645652771,0.16023366153240204,-0.2546378970146179,-0.2181900292634964,0.22693496942520142,-0.07973538339138031,-0.1251765936613083,-0.15193097293376923,-0.2310873419046402,-0.21495561301708221,0.13311989605426788,-0.21522876620292664,-0.07730727642774582,-0.19729368388652802,0.29537132382392883,0.14491797983646393,-0.1580089032649994,-0.2887283265590668},{0.009072757326066494,0.17668257653713226,0.05544296279549599,0.010924081318080425,0.1215139701962471,-0.30451732873916626,-0.15053904056549072,-0.14636683464050293,-0.037194933742284775,-0.23989254236221313,-0.29003286361694336,-0.02301831729710102,-0.1586781144142151,-0.034553177654743195,-0.11724741756916046,0.3828957676887512,-0.012519077397882938,-0.15634849667549133,0.13952000439167023,0.33406364917755127,-0.10193883627653122,-0.23299363255500793,0.26510804891586304,0.08769942075014114,-0.0581258125603199,-0.284076452255249,-0.2864583134651184,-0.30159682035446167,-0.3252387046813965,-0.23023946583271027,0.049437131732702255,-0.2905118763446808},{0.08799436688423157,0.2903921604156494,-0.2548246383666992,-0.31941676139831543,-0.20189660787582397,0.049447353929281235,0.06952616572380066,0.0532679446041584,0.16774623095989227,-0.2726367712020874,-0.2477124184370041,0.3246157765388489,-0.2379034459590912,-0.18737496435642242,0.17844581604003906,-0.2813587784767151,0.2694539725780487,0.14965102076530457,0.3162921965122223,0.04203679785132408,0.22083395719528198,0.031184496358036995,0.2517589330673218,-0.07628870010375977,0.37042561173439026,-0.211194708943367,0.0958525687456131,0.31457725167274475,-0.27873653173446655,0.21928812563419342,-0.03194480389356613,0.14835965633392334},{-0.18143604695796967,0.12697690725326538,-0.22803744673728943,-0.1494079977273941,0.1901789754629135,-0.13676121830940247,0.06515856832265854,0.00024163555644918233,0.14863654971122742,-0.04954783618450165,-0.2534237504005432,-0.2748807370662689,-0.3115486204624176,-0.0632043406367302,-0.24112218618392944,0.09724735468626022,0.06946366280317307,-0.2112087905406952,0.2741047441959381,0.08503378927707672,0.0032681752927601337,-0.02046181447803974,0.28029438853263855,-0.20672431588172913,0.2986316382884979,0.11297453194856644,-0.25398126244544983,0.016700442880392075,-0.00391216017305851,0.145534947514534,-0.1194864809513092,0.11446809023618698},{0.08524881303310394,0.010637873783707619,0.2151646465063095,-0.2636079490184784,-0.27803468704223633,-0.25418633222579956,-0.2669323980808258,-0.0033716349862515926,-0.19701264798641205,0.420950710773468,0.12376274913549423,-0.25801971554756165,-0.3879118859767914,-0.022367244586348534,-0.24070729315280914,-0.08628376573324203,0.22832049429416656,-0.1365026980638504,0.2568448483943939,-0.1320892721414566,-0.1948179304599762,-0.0034565723035484552,0.1437273770570755,0.2440844625234604,0.1620461344718933,-0.11162766069173813,-0.021615436300635338,-0.09558510780334473,-0.08294889330863953,0.027813086286187172,-0.04738548770546913,0.11704184859991074},{-0.1695575714111328,-0.12475249916315079,0.2119254171848297,0.2997357249259949,0.24735015630722046,-0.06503435224294662,0.06765934824943542,-0.22319161891937256,-0.010936242528259754,-0.2492496520280838,0.2611394226551056,-0.2204267680644989,-0.22254040837287903,-0.20729289948940277,0.23890148103237152,-0.008138133212924004,-0.024494249373674393,-0.001807438675314188,0.35363468527793884,0.04577329009771347,-0.16697226464748383,0.20942969620227814,0.09973394125699997,-0.06561379134654999,0.22902275621891022,-0.09252412617206573,-0.18427373468875885,0.20435847342014313,0.11444397270679474,0.009908839128911495,-0.31153514981269836,-0.22949153184890747},{0.29133403301239014,-0.2509385347366333,0.005957205779850483,-0.3161124885082245,0.006949909497052431,-0.1578209549188614,0.11855200678110123,0.1554744839668274,0.2296251356601715,0.046971000730991364,0.18004383146762848,0.25059807300567627,-0.4270596504211426,-0.344814270734787,-0.04679664969444275,-0.21187789738178253,-0.24166977405548096,-0.285961776971817,0.3118990361690521,-0.16654613614082336,0.3289632797241211,-0.09622214734554291,-0.006995039060711861,0.19553788006305695,0.11324522644281387,-0.10163737088441849,0.10965845733880997,0.04700284078717232,0.054801903665065765,-0.018009448423981667,-0.27817392349243164,-0.0071878498420119286},{0.2637118995189667,-0.03476960211992264,-0.013643767684698105,0.33739885687828064,-0.09931115061044693,-0.16053886711597443,-0.015052441507577896,0.18285241723060608,0.18534336984157562,0.2430674135684967,0.12219176441431046,-0.13975200057029724,0.061864160001277924,0.2114836722612381,-0.12337567657232285,0.13644567131996155,0.23367604613304138,-0.22061404585838318,0.11776368319988251,-0.3300815224647522,0.23457932472229004,0.16455337405204773,-0.08071912080049515,0.20219503343105316,0.25940266251564026,0.060984376817941666,0.16241776943206787,0.09613930433988571,0.07489833235740662,-0.1439725011587143,0.03770890831947327,0.3422284424304962},{0.08764439821243286,-0.20498405396938324,0.0028151185251772404,0.09332571178674698,-0.2684406042098999,-0.025804635137319565,0.05343087017536163,-0.20316359400749207,-0.14896725118160248,-0.018779443576931953,0.1602027863264084,0.20902860164642334,0.09865185618400574,0.2458680272102356,-0.03524800390005112,-0.020355533808469772,-0.23484408855438232,0.2535233795642853,-0.07366716861724854,-0.1812545657157898,-0.20308749377727509,-0.11735837906599045,0.14302757382392883,0.06166192889213562,0.012578128837049007,-0.16746516525745392,-0.172483891248703,0.19950607419013977,0.03495744988322258,-0.15440934896469116,0.24290180206298828,0.1578230857849121},{0.1700308471918106,-0.2347453236579895,0.02919614315032959,-0.18516823649406433,0.02368847094476223,0.15486589074134827,0.059902485460042953,0.2595965266227722,-0.07724598050117493,-0.04130839928984642,0.20132456719875336,0.1253695785999298,0.05934138596057892,-0.09709147363901138,-0.02110123448073864,0.20380949974060059,-0.3241400122642517,-0.17398495972156525,-0.03308231011033058,0.08707217872142792,0.03538455069065094,0.23750096559524536,0.1362573355436325,0.19467684626579285,0.05526410788297653,0.18278338015079498,-0.03643083572387695,-0.0553000345826149,0.06629130244255066,-0.09253300726413727,-0.25181856751441956,0.31161075830459595},{0.17645381391048431,-0.011634496971964836,-0.3162425458431244,0.12074402719736099,0.06493688374757767,-0.05842548981308937,0.32544270157814026,0.11249656230211258,0.12737014889717102,-0.12744347751140594,0.1862793266773224,-0.22287243604660034,-0.3586641252040863,0.23928534984588623,0.07124694436788559,0.0448729433119297,-0.023187393322587013,-0.10326260328292847,-0.15595535933971405,0.07156288623809814,-0.026056228205561638,0.18681803345680237,0.07586164772510529,-0.15445181727409363,-0.06745833903551102,-0.2388499528169632,0.04329422116279602,0.3010718524456024,0.2017144113779068,-0.16472381353378296,0.17299412190914154,0.18248209357261658},{-0.08515464514493942,0.008662749081850052,-0.08690938353538513,-0.06396808475255966,-0.23739013075828552,-0.030228594318032265,0.2126159518957138,0.16612908244132996,0.12387765198945999,0.023469088599085808,0.18369320034980774,0.0032236455008387566,0.2491944134235382,0.19109943509101868,0.1945042461156845,-0.11957663297653198,0.11268588900566101,0.18613150715827942,0.20713898539543152,0.040634553879499435,0.21248182654380798,0.2659352719783783,0.08347392082214355,0.158709317445755,-0.040689170360565186,-0.06142212077975273,-0.1306931972503662,-0.25854548811912537,0.1462637484073639,-0.27737340331077576,0.021595424041152,-0.05001632124185562},{-0.31224554777145386,0.04824187606573105,-0.3125929534435272,-0.3318694233894348,0.023928498849272728,-0.003267694730311632,0.1164332702755928,-0.14753858745098114,0.04968308284878731,0.3436330556869507,0.017473630607128143,-0.18889746069908142,0.08174047619104385,-0.2025367170572281,-0.30078378319740295,0.017566494643688202,-0.16832050681114197,0.11001187562942505,-0.04370987415313721,0.025803368538618088,-0.2821750342845917,0.13744354248046875,0.09209805727005005,0.04290473461151123,-0.06493030488491058,0.3158787786960602,0.050014324486255646,-0.20458705723285675,-0.1795070618391037,0.042148567736148834,-0.2019859403371811,-0.25188755989074707},{-0.004523027688264847,-0.2644904851913452,-0.2711244821548462,-0.052704911679029465,-0.3221113979816437,-0.14901134371757507,0.18141040205955505,-0.2711360454559326,-0.20894457399845123,0.16379696130752563,0.2055516541004181,0.09052857756614685,0.11956373602151871,-0.15184253454208374,0.2659026086330414,-0.26755470037460327,0.09162668138742447,0.2592064142227173,0.05318859964609146,0.27394208312034607,0.002124481601640582,-0.11343362182378769,-0.2750319838523865,0.222526416182518,-0.11557722836732864,-0.15258349478244781,0.1192813441157341,0.04306541010737419,-0.12644904851913452,-0.31702157855033875,-0.025395099073648453,-0.19059360027313232},{0.23624877631664276,0.14533960819244385,-0.055021632462739944,0.2024766504764557,-0.251302570104599,0.13428513705730438,-0.09178273379802704,-0.16144181787967682,-0.13386686146259308,0.19164277613162994,-0.30344104766845703,-0.12838922441005707,-0.021983245387673378,-0.20825964212417603,-0.37493041157722473,-0.14669056236743927,-0.09281870722770691,-0.31079161167144775,-0.2265925109386444,0.2183486968278885,0.12123552709817886,0.11810452491044998,-0.3727828860282898,0.3034155070781708,0.15533889830112457,0.2928306758403778,-0.271684855222702,-0.0683811604976654,0.06743724644184113,-0.19894473254680634,0.14685098826885223,0.15010668337345123},{-0.051983173936605453,-0.30633771419525146,-0.040777772665023804,-0.3033912181854248,-0.07544685155153275,0.28446006774902344,0.19970116019248962,0.03785251826047897,-0.08881714940071106,0.010233491659164429,-0.14747649431228638,0.10386066138744354,0.09859790652990341,0.05184885486960411,0.11005403101444244,0.03375827893614769,-0.09508528560400009,0.13255956768989563,-0.11205913871526718,0.14693936705589294,0.19156762957572937,0.2513132095336914,-0.021424980834126472,-0.24998614192008972,0.16447566449642181,0.16376209259033203,0.2844076454639435,0.1583559215068817,0.016866402700543404,0.11643146723508835,0.014470974914729595,-0.09794281423091888},{-0.02038157358765602,-0.21259386837482452,0.21884872019290924,0.06896526366472244,0.2665548622608185,-0.03546427935361862,-0.13794565200805664,-0.2017853856086731,0.1465664803981781,-0.03688707947731018,0.07803905755281448,0.00045540169230662286,-0.3382869362831116,0.05577893927693367,-0.09898124635219574,-0.2563774883747101,-0.05095537379384041,-0.06844823062419891,0.18320612609386444,0.201571524143219,0.027327505871653557,0.04724219813942909,0.16790452599525452,0.29935911297798157,-0.18423445522785187,-0.04419035464525223,0.16138014197349548,-0.0732528418302536,-0.13870306313037872,-0.25947922468185425,0.2887178063392639,0.02123147062957287},{0.19751928746700287,-0.0948115736246109,0.052794285118579865,0.10675543546676636,-0.020421938970685005,0.03335782513022423,-0.22966398298740387,0.30259519815444946,-0.10005531460046768,-0.02216971479356289,0.1031193658709526,-0.3006494641304016,0.10795276612043381,-0.05154285952448845,-0.12235452234745026,0.3135974705219269,-0.09254814684391022,-0.17840133607387543,0.009671356528997421,0.0235090684145689,-0.1651420146226883,0.1546020805835724,0.21284860372543335,0.26039376854896545,-0.25812047719955444,0.11249405145645142,-0.08526185899972916,0.04608284682035446,-0.26229754090309143,0.24870052933692932,-0.06612767279148102,0.034849200397729874}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.18741974234580994,-0.11394054442644119,0.04598299786448479,-0.11256690323352814},{0.19888393580913544,-0.24227702617645264,0.26898854970932007,0.22530891001224518},{-0.20368079841136932,0.027798576280474663,0.052325427532196045,-0.02822730503976345},{0.273673415184021,0.3812103271484375,0.2941296696662903,0.03913070634007454},{-0.2425016313791275,0.1429499387741089,-0.2495698183774948,0.10587193071842194},{0.017201222479343414,-0.06532064080238342,0.06891816109418869,0.22398923337459564},{-0.10643161088228226,-0.15423475205898285,-0.3164539337158203,-0.06442194432020187},{-0.09338583052158356,-0.30942726135253906,0.12319536507129669,-0.057314563542604446},{-0.08217402547597885,0.1453067660331726,-0.08887316286563873,-0.07814140617847443},{0.18937553465366364,-0.024212844669818878,-0.06242670863866806,-0.14431199431419373},{0.20452342927455902,-0.17957349121570587,0.26933714747428894,0.19799081981182098},{-0.017355777323246002,0.004380160477012396,0.3134889006614685,-0.06827884167432785},{-0.28435903787612915,0.22146153450012207,-0.04627954214811325,-0.06637871265411377},{-0.14047230780124664,0.011245086789131165,-0.20784185826778412,0.02776549942791462},{0.18279442191123962,-0.017449500039219856,0.19857025146484375,0.059200458228588104},{-0.11547578126192093,-0.2555122673511505,-0.10908542573451996,-0.06953271478414536},{-0.22779861092567444,0.044306524097919464,-0.062476009130477905,0.2580234706401825},{-0.23557494580745697,-0.12110470980405807,-0.21924902498722076,0.16278548538684845},{-0.062207452952861786,-0.07530704885721207,0.3112826347351074,0.07280907034873962},{-0.1277952939271927,-0.15467309951782227,-0.009617507457733154,-0.15225845575332642},{0.13605159521102905,0.10348125547170639,0.10705737769603729,-0.12559841573238373},{-0.014871835708618164,-0.22574646770954132,-0.10803640633821487,0.20495247840881348},{0.2687740623950958,-0.11762040108442307,0.13840220868587494,0.009403533302247524},{-0.23709791898727417,-0.10268833488225937,-0.25902554392814636,-0.15869134664535522},{-0.21853376924991608,-0.1579972356557846,-0.01604207418859005,-0.12160341441631317},{0.14266029000282288,0.14452612400054932,-0.036628831177949905,0.13478657603263855},{0.1710154414176941,-0.18715818226337433,0.20254628360271454,0.0717560201883316},{-0.04793884977698326,-0.14400993287563324,0.006448487751185894,0.2672411799430847},{0.025807209312915802,0.011106954887509346,0.021052325144410133,0.007781557273119688},{-0.11748716235160828,0.10309731215238571,0.18760021030902863,0.0104883573949337},{-0.1226673498749733,-0.1250818967819214,0.07778126001358032,0.15844027698040009},{0.16943074762821198,0.1753077656030655,0.18503153324127197,-0.014675164595246315}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.059606004506349564,-0.001702162902802229,-0.0017932058544829488,0.04912928491830826,0.047195009887218475,-0.03829876333475113,0.0058463988825678825,0.05233112350106239,-0.06491401046514511,-0.09078657627105713,-0.02447599172592163,0.07091408967971802,-0.034068189561367035,0.041047170758247375,-0.02541200816631317,-0.019001595675945282};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.002038004109635949,0.0005433534970507026,-0.008372877724468708,-0.01581701450049877,-0.05460643023252487,0.017830535769462585,-0.019701797515153885,-0.00537676177918911,0.019458414986729622,-0.046919986605644226,-0.004069042392075062,-0.018173931166529655,-0.008998126722872257,-0.021993763744831085,-0.005184824112802744,-0.04324730485677719};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0032012001611292362,0.06259270012378693,-0.02435825765132904,0.017508093267679214,-0.01704542525112629,0.03665772080421448,-0.04214516282081604,-0.01899789087474346,-0.03209822624921799,-0.01683666557073593,-0.011287620291113853,0.03183167055249214,0.01570763997733593,0.01114935614168644,0.06238621473312378,-0.050699103623628616,0.021633895114064217,-0.005292555782943964,0.017839966341853142,-0.033587075769901276,0.0006543915951624513,0.02492664009332657,-0.007719020824879408,-0.04445266351103783,-0.05402931571006775,0.013873402960598469,0.022493571043014526,0.031408682465553284,0.002593918237835169,0.020041460171341896,0.025924310088157654,0.004461871460080147};
static const float action_parameterization_distribution_linear_bias[4] = {0.0095430389046669,0.02104007825255394,0.015644211322069168,0.0418265201151371};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4365922212600708,-0.36847934126853943,-0.12359291315078735,0.24595147371292114,-0.15990114212036133,0.10224728286266327,-0.2932899594306946,0.063310906291008},{0.21166397631168365,0.11736410111188889,0.4077589213848114,0.38432857394218445,-0.09892116487026215,-0.3384232223033905,0.33257266879081726,0.39382365345954895},{0.06841970235109329,0.18167217075824738,0.11274567991495132,-0.054276321083307266,0.337638258934021,0.21947385370731354,-0.0008689212263561785,0.22794824838638306},{0.12115301191806793,-0.3689957857131958,0.34712886810302734,-0.152466282248497,-0.22154133021831512,0.09838929772377014,0.34767425060272217,0.24820932745933533},{-0.23447470366954803,-0.08462539315223694,-0.029071152210235596,-0.2638852894306183,0.1516270488500595,0.12058279663324356,0.3821621835231781,0.2733311951160431},{-0.042458947747945786,0.18150226771831512,0.007893050089478493,-0.19482941925525665,0.3431776463985443,0.11494897305965424,0.138154536485672,-0.17341753840446472},{0.013805058784782887,0.14089129865169525,0.15372519195079803,-0.145128533244133,0.4359978437423706,-0.11081435531377792,0.17499588429927826,0.0849493145942688},{0.05486774444580078,-0.4731961786746979,-0.014494803734123707,-0.2200319766998291,0.29959020018577576,0.05302108824253082,-0.1405748724937439,-0.349368155002594},{-0.2588651478290558,0.15177176892757416,0.027983229607343674,-0.06505164504051208,0.04802791774272919,0.4802834093570709,0.41703739762306213,0.2820199131965637},{-0.0015474866377189755,-0.16573302447795868,-0.26002973318099976,0.28172385692596436,0.3108995258808136,0.3334183096885681,0.3746037185192108,-0.3359120786190033},{-0.15829868614673615,-0.399600625038147,0.3667354881763458,0.17950433492660522,0.02963460050523281,-0.2658398747444153,0.03604501113295555,-0.3489271104335785},{0.24766431748867035,0.03065304271876812,0.41679060459136963,0.40089407563209534,-0.10019506514072418,0.32584673166275024,0.19853317737579346,-0.3458181917667389},{-0.3734419643878937,0.14502640068531036,-0.35091432929039,0.4365857243537903,-0.016628310084342957,0.40526437759399414,-0.03561386093497276,0.24456411600112915},{-0.053831372410058975,0.18125130236148834,-0.12021037936210632,-0.1130223348736763,0.029742909595370293,0.15683357417583466,0.2646735608577728,-0.017643116414546967},{0.11336345225572586,-0.3857017457485199,-0.357554167509079,-0.16563501954078674,0.13827840983867645,-0.1377735137939453,0.0995442345738411,-0.13914629817008972},{-0.481245219707489,-0.37629616260528564,-0.29732248187065125,-0.012858923524618149,-0.05530979484319687,0.23635365068912506,0.1541716605424881,-0.1575383096933365},{-0.1822316199541092,-0.3584607243537903,0.20319971442222595,-0.3483879864215851,-0.011775744147598743,0.025868671014904976,-0.4459877014160156,-0.3255939185619354},{0.07172068953514099,0.19723522663116455,0.11538635194301605,0.21370388567447662,-0.12322989851236343,0.3093799948692322,0.2503882348537445,-0.23027345538139343},{0.07705750316381454,-0.35954010486602783,-0.09938764572143555,-0.032950520515441895,-0.1518765091896057,-0.3648638129234314,0.010262674652040005,-0.3238046169281006},{-0.013101196847856045,-0.010784448124468327,0.08903299272060394,-0.2810112237930298,0.03839544951915741,0.1018037497997284,0.0494878776371479,-0.16280227899551392},{0.11957938969135284,-0.110173799097538,0.046093106269836426,-0.23844096064567566,-0.00911042746156454,-0.02110845409333706,-0.06433285772800446,-0.27564704418182373},{-0.2901766300201416,0.17329469323158264,0.12039797008037567,-0.2253575325012207,-0.4711545705795288,0.0008976593380793929,0.10282273590564728,-0.029361749067902565},{0.31154727935791016,0.11807579547166824,-0.45193958282470703,0.13117963075637817,-0.07537195086479187,0.21300341188907623,0.20619618892669678,0.24825835227966309},{0.04674823209643364,-0.09637434780597687,-0.052647512406110764,0.3193347156047821,-0.3356472849845886,-0.08445414900779724,-0.1874605268239975,-0.3592184782028198},{0.23460154235363007,0.08478032797574997,-0.5000094175338745,0.321489542722702,-0.32143667340278625,-0.3634569048881531,-0.3510283827781677,0.1323203593492508},{0.07600676268339157,0.3534807860851288,-0.3410346508026123,-0.054103635251522064,0.07430445402860641,-0.26068395376205444,0.31737327575683594,-0.314265638589859},{-0.046350620687007904,0.06056153029203415,-0.17260828614234924,-0.13151311874389648,0.03900142014026642,-0.19095320999622345,-0.09135837852954865,-0.1535428762435913},{0.16048561036586761,-0.19539856910705566,-0.07841301709413528,-0.08108797669410706,0.008941794745624065,-0.0034174788743257523,-0.1971210539340973,0.08152858167886734},{0.3595317602157593,0.0380096398293972,-0.40258389711380005,-0.16900427639484406,-0.24691243469715118,0.0996721163392067,0.2476663738489151,0.06831815093755722},{0.4192640781402588,-0.30656570196151733,-0.04965139552950859,-0.01686989888548851,0.11184383928775787,-0.139412984251976,0.22456106543540955,0.3353988528251648},{-0.20245981216430664,-0.15608274936676025,0.024918207898736,-0.2158387005329132,0.33365893363952637,-0.2752721309661865,0.05971803516149521,0.09612822532653809},{0.2578907907009125,0.03243725746870041,-0.14505581557750702,0.38936424255371094,0.10953722149133682,-0.009664206765592098,-0.007809120696038008,0.056131646037101746}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23408648371696472,0.39004120230674744,-0.6001567244529724,-0.4775066375732422,-0.25467023253440857,0.07994306087493896,-0.402866393327713,0.5111358165740967},{-0.0352134145796299,0.5676133632659912,-0.2097061276435852,0.45539379119873047,-0.018501216545701027,0.017621517181396484,-0.2463427037000656,0.023046353831887245},{-0.4608289301395416,-0.171763613820076,-0.1676575243473053,-0.296630859375,0.5125353932380676,0.1592048853635788,-0.01014516968280077,0.4608132839202881},{-0.45223483443260193,-0.4042043089866638,0.27031901478767395,0.37982630729675293,-0.5091125965118408,-0.14113906025886536,0.34972083568573,0.17862246930599213},{-0.24187660217285156,-0.3136453926563263,-0.2651260197162628,-0.2474946677684784,0.31654682755470276,-0.24181050062179565,0.4377526044845581,-0.38772672414779663},{-0.07496976107358932,0.14022673666477203,0.2895703911781311,-0.5156405568122864,0.5312142372131348,-0.28118401765823364,-0.4279071092605591,-0.31736645102500916},{-0.41248512268066406,0.1330571472644806,0.06723944842815399,-0.2989725172519684,-0.022959675639867783,-0.5165977478027344,0.501940906047821,0.04986586421728134},{-0.3913581371307373,-0.300986111164093,-0.22191640734672546,-0.47693440318107605,-0.29659682512283325,0.051398590207099915,0.4578137993812561,-0.28535112738609314}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.013049360364675522,-0.04359326511621475,-0.014429248869419098,0.032424382865428925,-0.022525228559970856,-0.027259286493062973,-0.09193135052919388,0.012147396802902222};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011240466497838497,-0.07675914466381073,-0.021867742761969566,0.12200462073087692,-0.02644946426153183,0.054243385791778564,-0.038554657250642776,0.022554943338036537};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

