#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3006741404533386,-0.2033422738313675,0.32968375086784363,0.22345612943172455,-0.37256067991256714,0.16820736229419708,-0.0023549855686724186,-0.2149794101715088,0.08852853626012802,0.4257049858570099,0.12421344965696335,0.024323605000972748,0.16381044685840607,-0.20379339158535004,0.35550621151924133,-0.10841654241085052},{-0.37120115756988525,-0.2987115681171417,0.2857021689414978,0.1944195181131363,-0.23240362107753754,0.034010909497737885,-0.4087364375591278,0.027867158874869347,-0.18219026923179626,-0.11880415678024292,0.15226638317108154,-0.16763538122177124,0.23415130376815796,-0.3962080776691437,-0.2012026607990265,0.08017078787088394},{0.15578243136405945,-0.23899130523204803,-0.26907169818878174,0.08999258279800415,0.10800634324550629,0.15336160361766815,-0.05141209065914154,0.017479894682765007,-0.1206839457154274,-0.19989579916000366,-0.19246669113636017,0.41358956694602966,-0.0065103438682854176,-0.17427362501621246,-0.401714026927948,0.2333812564611435},{0.1414133459329605,0.1888042539358139,0.3315958082675934,-0.057719454169273376,-0.34222620725631714,-0.03943163901567459,0.19369378685951233,0.13125669956207275,0.4821009635925293,-0.3930615782737732,0.037980563938617706,0.15998108685016632,-0.3231114447116852,-0.04153601452708244,0.3364260792732239,-0.38735511898994446},{-0.053897928446531296,0.04661523923277855,0.22762098908424377,-0.11283355951309204,0.22972345352172852,0.26088082790374756,0.2777961194515228,-0.06790152192115784,-0.04544270411133766,0.253302663564682,0.34270042181015015,-0.17417533695697784,-0.13530808687210083,-0.3191583752632141,0.3989696502685547,0.14318738877773285},{0.022417619824409485,-0.18970976769924164,-0.12407062202692032,-0.24998632073402405,0.10457679629325867,0.01569318398833275,-0.0013898577308282256,-0.14309996366500854,0.20022402703762054,-0.2390415370464325,-0.2984575033187866,0.19379669427871704,0.435928076505661,0.0024168204981833696,-0.034198686480522156,0.128767728805542},{-0.06009849160909653,-0.023531712591648102,0.0923871248960495,-0.213837668299675,0.2111673206090927,0.0306431595236063,0.07021752744913101,0.33501380681991577,0.3087255656719208,-0.002649125875905156,-0.3215664029121399,0.1831481009721756,-0.09934961795806885,0.2057703584432602,-0.16769061982631683,-0.23420651257038116},{-0.006068735383450985,0.019858509302139282,0.25083887577056885,0.2320050448179245,-0.4163317382335663,-0.02084287814795971,0.3498491048812866,0.3265317976474762,-0.0926206037402153,0.20842546224594116,-0.5074700713157654,-0.32993564009666443,0.2216697335243225,0.31755608320236206,0.20918697118759155,0.1377618908882141},{0.2805315852165222,-0.21905629336833954,0.33018508553504944,-0.07017545402050018,0.23229394853115082,0.08632928133010864,-0.15163688361644745,-0.23423482477664948,0.10411511361598969,-0.3029443025588989,0.037431810051202774,-0.287075012922287,-0.19406762719154358,0.35484936833381653,0.1531021147966385,-0.11443977802991867},{0.021663755178451538,-0.37370064854621887,-0.48464998602867126,-0.012981866486370564,-0.3000375032424927,0.2269098162651062,0.34548258781433105,0.20263409614562988,0.4578228294849396,0.338473379611969,0.01103376504033804,-0.2745256721973419,0.1043570414185524,0.2674354910850525,-0.06610973924398422,-0.3611195981502533},{0.08161597698926926,0.24052292108535767,0.4240933656692505,-0.33877164125442505,-0.3233044743537903,0.21593399345874786,0.1455901563167572,0.38919228315353394,-0.33348309993743896,-0.008097237907350063,-0.028389986604452133,0.1477375477552414,-0.31890106201171875,-0.17747004330158234,0.332811176776886,-0.34227076172828674},{0.13289475440979004,-0.14720143377780914,-0.024608122184872627,0.1445939540863037,0.3279552757740021,0.2831496298313141,0.44798797369003296,-0.013505089096724987,0.003081990173086524,-0.0019925169181078672,0.24604272842407227,-0.11450093984603882,-0.06570900976657867,-0.22240181267261505,0.23332694172859192,0.29206252098083496},{-0.1563575714826584,0.3155476748943329,0.1554597020149231,-0.2996804416179657,0.05039791017770767,0.13373257219791412,0.30474650859832764,-0.0387558750808239,0.12415206432342529,0.006027991883456707,-0.060319893062114716,0.11891515552997589,0.19238290190696716,0.2934626042842865,0.13964013755321503,-0.2353777438402176},{-0.23203669488430023,-0.20270876586437225,-0.19492444396018982,-0.029822269454598427,-0.17319539189338684,0.08035635203123093,-0.32319876551628113,0.0994568020105362,-0.08898268640041351,-0.010183634236454964,-0.2895326316356659,-0.07149697095155716,-0.33356717228889465,0.10880881547927856,0.25105300545692444,0.07925289124250412},{-0.13898691534996033,-0.410992830991745,-0.23461642861366272,0.3342216908931732,0.054717689752578735,-0.360507071018219,0.2826480269432068,-0.07120443135499954,-0.039387017488479614,0.31489095091819763,0.07492667436599731,0.19220933318138123,0.18526701629161835,-0.03614648059010506,-0.18362732231616974,0.21616435050964355},{0.5212253332138062,-0.09528713673353195,-0.2627370357513428,-0.4103410243988037,-0.6096713542938232,0.3097960650920868,0.4148888885974884,-0.2968323230743408,0.16003216803073883,0.12186610698699951,-0.3067284822463989,0.049710217863321304,-0.5425785779953003,0.5332098603248596,-0.2879818081855774,0.030171722173690796},{-0.368714302778244,-0.3945975601673126,0.40083208680152893,0.37213796377182007,-0.32785874605178833,0.3482781648635864,-0.12708139419555664,-0.3111870288848877,0.2571495771408081,-0.46001410484313965,-0.3461666703224182,-0.6620585918426514,-0.24227312207221985,-0.4907990097999573,-0.01658024825155735,-0.20536546409130096},{-0.38611868023872375,0.2650120258331299,-0.5050125122070312,0.0015756093198433518,0.037067681550979614,0.34258773922920227,-0.31486520171165466,-0.40403130650520325,0.225876584649086,0.25883352756500244,0.4215155243873596,-0.08227182179689407,-0.2415626496076584,0.2996569275856018,0.15811745822429657,-0.49980685114860535}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.13699698448181152,-0.0884210541844368,-0.17204216122627258,-0.4215241074562073,0.4107415974140167,0.2803928852081299,0.08077574521303177,0.11002779006958008,-0.2858482897281647,-0.09121575206518173,-0.10236085951328278,-0.009393763728439808,0.23968498408794403,0.5181261301040649,0.16156867146492004,0.07631958276033401},{-0.19411832094192505,-0.2747352123260498,-0.01968451403081417,0.1429382562637329,0.2880547046661377,-0.26746663451194763,0.18046902120113373,0.05161567032337189,-0.06641967594623566,0.25264909863471985,-0.13241390883922577,0.3498431146144867,-0.353910893201828,0.23345054686069489,-0.3717482089996338,-0.24955539405345917},{0.13872139155864716,0.24870379269123077,-0.4122945964336395,-0.5441158413887024,0.1497296541929245,0.47397786378860474,-0.09769993275403976,0.10662930458784103,-0.24851615726947784,-0.25027263164520264,-0.018619252368807793,0.2839738428592682,-0.3427601754665375,-0.2876061201095581,0.16870057582855225,-0.06904765963554382},{0.20392584800720215,-0.03622254356741905,0.08164646476507187,0.18670174479484558,-0.5186410546302795,0.024846479296684265,0.027294624596834183,-0.2581269443035126,0.3563295304775238,0.37672507762908936,-0.10670739412307739,-0.17169040441513062,-0.3918587267398834,-0.38425061106681824,0.21103473007678986,0.22458712756633759},{-0.17952853441238403,0.05052294209599495,0.05688902735710144,0.27448129653930664,-0.23223772644996643,0.013911839574575424,-0.047278739511966705,0.1843799501657486,0.23703326284885406,-0.31879857182502747,0.04130192846059799,0.4153556227684021,0.13475176692008972,-0.41804373264312744,-0.07719799876213074,-0.11577078700065613},{0.2586516737937927,0.22803187370300293,-0.024927256628870964,0.16968725621700287,-0.3657323122024536,-0.40132981538772583,0.27162593603134155,0.28271278738975525,0.12833407521247864,0.5058773159980774,0.25895267724990845,-0.2729877829551697,0.018773887306451797,-0.14674875140190125,-0.049344293773174286,0.3372732102870941},{-0.01994633488357067,0.16039399802684784,0.34501051902770996,-0.3834323585033417,-0.17146748304367065,0.06843926757574081,-0.29120320081710815,-0.0599321648478508,0.08852327615022659,0.12141625583171844,-0.1441950798034668,-0.2826061546802521,-0.28648677468299866,0.07584932446479797,0.2262849062681198,0.07425335049629211},{-0.2027176171541214,-0.20325852930545807,-0.4101422131061554,0.2797359526157379,-0.2843467593193054,-0.3149876892566681,-0.20438933372497559,-0.35048049688339233,0.01743888296186924,-0.24149848520755768,-0.12932272255420685,0.1687861680984497,-0.2306966334581375,0.41710326075553894,-0.12997286021709442,-0.396126925945282},{-0.26050981879234314,0.28133076429367065,0.014583451673388481,-0.007217763923108578,0.3104841411113739,-0.20938561856746674,0.4150388538837433,0.12135212123394012,0.2967528700828552,0.3919094502925873,0.3220253884792328,0.2925944924354553,0.2522481083869934,-0.051432352513074875,0.30098235607147217,0.15109166502952576},{0.14296388626098633,-0.2619690001010895,-0.03591778129339218,-0.14619165658950806,0.3190189599990845,-0.033473074436187744,-0.2747589349746704,-0.242667093873024,0.08659495413303375,-0.4595085680484772,-0.1999819427728653,0.22825275361537933,0.1401260942220688,0.1765088438987732,-0.30889618396759033,0.2782049775123596},{-0.18772827088832855,-0.36768409609794617,0.492849200963974,0.278350830078125,0.21546226739883423,0.1335112750530243,0.1541430503129959,-0.14120906591415405,0.15543587505817413,-0.25419676303863525,0.022546865046024323,0.3800203204154968,0.38159146904945374,0.13072387874126434,-0.24688300490379333,-0.0013673387002199888},{0.023239977657794952,-0.17732059955596924,0.297518253326416,0.037386659532785416,-0.1251281499862671,-0.20172084867954254,0.4451940953731537,0.2700989842414856,-0.2515632212162018,-0.37973883748054504,-0.1270628273487091,-0.28903400897979736,-0.014086632989346981,-0.309601753950119,-0.374800443649292,-0.0038507976569235325},{-0.0652410164475441,-0.3205699622631073,0.30151212215423584,-0.19914306700229645,0.2987525761127472,-0.3368660807609558,-0.38623782992362976,0.17850767076015472,0.1287291795015335,-0.034011248499155045,-0.2964063882827759,0.11254587769508362,0.07332879304885864,-0.33641916513442993,-0.39191412925720215,-0.020283285528421402},{0.3032180070877075,-0.34014344215393066,0.48191916942596436,0.13839983940124512,0.09126986563205719,0.3052615821361542,-0.08795233815908432,-0.23752477765083313,-0.5406162142753601,0.09368164092302322,0.009438407607376575,-0.4204353392124176,0.022535454481840134,0.27562642097473145,0.32838174700737,0.07118953764438629},{-0.22485944628715515,0.17149405181407928,0.09128285199403763,-0.330145001411438,-0.21990655362606049,0.09927103668451309,0.23887266218662262,-0.16889256238937378,0.1897481232881546,-0.39084067940711975,-0.0037910062819719315,0.07275855541229248,-0.07287722826004028,0.07746770977973938,-0.06634367257356644,-0.005239172372967005},{-0.1745923012495041,0.34644031524658203,-0.35426342487335205,0.2890858054161072,0.16893023252487183,-0.3896711766719818,-0.14957544207572937,-0.059098321944475174,-0.42448046803474426,0.269881933927536,-0.4343016743659973,0.3210761249065399,-0.08979178220033646,-0.17658831179141998,-0.2646510601043701,-0.5589434504508972}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.18902389705181122,0.014748172834515572,-0.08455082029104233,-0.00528190191835165,-0.11707013845443726,-0.00662821251899004,0.29355642199516296,0.007029979024082422,-0.11152197420597076,-0.14912940561771393,0.09864047169685364,-0.32394227385520935,-0.22116155922412872,0.22461280226707458,0.2009493112564087,0.25805726647377014,-0.28453031182289124,-0.32856741547584534,-0.2493240386247635,0.02173018455505371,-0.015384123660624027,-0.36995929479599,-0.22055254876613617,-0.29563650488853455,-0.318492591381073,0.24992859363555908,-0.27222001552581787,-0.04903044179081917,-0.00356380851007998,-0.016691625118255615,0.16653968393802643,-0.13586466014385223},{0.2248314917087555,0.23703475296497345,0.09865947812795639,-0.083400197327137,0.11680341511964798,-0.05965708941221237,0.32035475969314575,0.10042846947908401,-0.2237992137670517,-0.14418552815914154,-0.05506040155887604,-0.3106076419353485,-0.18912942707538605,0.2160511314868927,-0.20446965098381042,-0.304269403219223,-0.02918117865920067,0.1872568130493164,-0.3643323481082916,-0.3180750906467438,-0.028183890506625175,0.29408711194992065,0.1348572075366974,-0.11357534676790237,0.13283562660217285,-0.25076302886009216,0.004135399125516415,0.1421695053577423,0.20576518774032593,-0.15257474780082703,-0.02308313362300396,0.22388407588005066},{0.244538813829422,0.07796363532543182,-0.06743591278791428,0.1665448695421219,-0.22448717057704926,-0.1992977261543274,-0.29491767287254333,0.15240538120269775,-0.11611371487379074,0.37952831387519836,-0.27502134442329407,-0.15738819539546967,0.12418157607316971,-0.4189910590648651,-0.13466297090053558,0.08945036679506302,-0.16641546785831451,-0.18286314606666565,0.28912022709846497,-0.03393630310893059,0.27334025502204895,0.2109357863664627,-0.23837807774543762,0.01900722086429596,-0.20761069655418396,-0.10305851697921753,0.1757800132036209,-0.12516061961650848,-0.03482382372021675,-0.1505986899137497,-0.11076080799102783,-0.0724186971783638},{0.35244685411453247,0.09512130916118622,0.09190118312835693,-0.12543147802352905,-0.28439250588417053,-0.07600955665111542,-0.18179889023303986,0.27664175629615784,0.24446187913417816,-0.23972851037979126,-0.07632765173912048,0.32449886202812195,0.09123806655406952,-0.16546231508255005,-0.20101286470890045,0.29805469512939453,-0.31359654664993286,0.2219410538673401,0.018193108960986137,0.08640258014202118,-0.03950890898704529,-0.11185572296380997,0.28817397356033325,0.15577256679534912,0.17385831475257874,-0.3451586365699768,0.3522118628025055,-0.21940629184246063,-0.024880239740014076,0.057844940572977066,-0.2791627049446106,0.17841589450836182},{-0.03410132974386215,-0.05844356119632721,-0.08440782874822617,0.05166950076818466,0.18165463209152222,-0.20149511098861694,-0.3688327670097351,-0.02054435759782791,-0.13012242317199707,-0.1731133610010147,0.1378663331270218,0.23318874835968018,-0.05908132717013359,-0.08786419034004211,-0.08922107517719269,0.2065287083387375,-0.08007381856441498,-0.030614107847213745,-0.3338230848312378,-0.07097208499908447,-0.1529529094696045,-0.37773048877716064,0.17985065281391144,0.2286689579486847,-0.0684838518500328,0.28616592288017273,-0.1735718846321106,0.187796950340271,0.3159330189228058,0.35166651010513306,-0.04245689511299133,0.30520299077033997},{-0.2400960922241211,-0.08457663655281067,-0.17074836790561676,-0.04395204782485962,-0.17452655732631683,0.24068737030029297,0.20818637311458588,0.0367099791765213,0.30401235818862915,0.15536294877529144,0.31805843114852905,-0.22620952129364014,-0.17701368033885956,0.23453278839588165,0.2897867262363434,-0.3575802147388458,-0.11505572497844696,-0.2429993599653244,0.2216913104057312,0.09936212003231049,0.09319677203893661,0.131461039185524,0.014520599506795406,-0.03780133277177811,-0.37307459115982056,0.3411825895309448,-0.2112315446138382,0.16130632162094116,0.35762786865234375,0.22072821855545044,0.07310377806425095,0.07822172343730927},{0.18301033973693848,-0.11183460801839828,-0.14970935881137848,-0.3340390622615814,-0.0355818010866642,0.2243555188179016,0.2678327262401581,0.15216343104839325,0.08733543008565903,0.34167617559432983,-0.00607174402102828,0.004211383406072855,-0.4123702049255371,-0.15975305438041687,-0.1461203247308731,0.06450589001178741,-0.3022688329219818,-0.23407921195030212,0.18216532468795776,-0.09271714836359024,-0.1066460832953453,-0.14217530190944672,-0.2080908864736557,-0.2579684257507324,0.18015816807746887,-0.25688713788986206,-0.10337232053279877,-0.21415619552135468,0.34851956367492676,0.11360926926136017,-0.17879821360111237,-0.27626052498817444},{0.057650819420814514,0.18568211793899536,0.045541346073150635,-0.1396503448486328,0.14969758689403534,-0.29776856303215027,-0.043137576431035995,-0.16327716410160065,-0.008904268965125084,-0.2656610310077667,-0.32463186979293823,-0.11572569608688354,-0.12724876403808594,0.06160115450620651,-0.14773432910442352,0.4220065474510193,0.004588454961776733,-0.13630355894565582,0.10483068972826004,0.33382508158683777,-0.19592814147472382,-0.17453917860984802,0.30008769035339355,0.08549969643354416,0.006150508299469948,-0.33684036135673523,-0.32971689105033875,-0.2063664197921753,-0.37562841176986694,-0.2849019169807434,0.09520094841718674,-0.39299461245536804},{0.027677012607455254,0.5122833847999573,-0.43758970499038696,-0.3986107110977173,-0.3374010920524597,0.18223117291927338,0.061493415385484695,0.16735276579856873,-0.036424774676561356,-0.27021437883377075,-0.09864864498376846,0.3044607937335968,-0.4513722062110901,-0.26893994212150574,0.2500280737876892,-0.19585174322128296,0.21709753572940826,0.15872158110141754,0.39464613795280457,0.05095804110169411,0.16177386045455933,0.2407360076904297,0.4134887158870697,-0.17989376187324524,0.4754507541656494,-0.22632543742656708,0.3019088804721832,0.434161901473999,-0.15894275903701782,0.08628243952989578,0.045931413769721985,0.09977651387453079},{-0.27610304951667786,0.0913778766989708,-0.42518627643585205,-0.21685969829559326,0.10826125741004944,-0.2721492350101471,0.1630491465330124,-0.05074605345726013,0.2032744139432907,0.14785361289978027,-0.3154601454734802,-0.4043838381767273,-0.4559701085090637,-0.1286967545747757,-0.2894127368927002,0.13392889499664307,-0.07218553870916367,-0.2634080946445465,0.12283742427825928,0.07723332196474075,0.08043619990348816,-0.0047288010828197,0.41778165102005005,-0.16242867708206177,0.3448857367038727,0.19546087086200714,-0.2654256820678711,0.025604939088225365,0.0005252835107967257,-0.0361802913248539,-0.2654094696044922,0.11424198001623154},{0.10180001705884933,0.030543478205800056,0.12628941237926483,-0.29951080679893494,-0.3080967366695404,-0.23280814290046692,-0.26447150111198425,-0.01571037247776985,-0.20095451176166534,0.38533297181129456,0.1455719769001007,-0.27228978276252747,-0.3781539797782898,-0.07948055118322372,-0.2123027890920639,-0.11539147794246674,0.19752515852451324,-0.16235408186912537,0.2744865119457245,-0.19835242629051208,-0.1812698245048523,0.0463714599609375,0.2248772382736206,0.1756826937198639,0.20577387511730194,-0.15233692526817322,-0.023962339386343956,-0.06109828129410744,-0.042784757912158966,-0.010273360647261143,-0.07556337118148804,0.16995133459568024},{-0.20269648730754852,-0.037915248423814774,0.22266539931297302,0.26797980070114136,0.26656433939933777,0.009052249602973461,0.09618920832872391,-0.19343674182891846,-0.11711311340332031,-0.21958155930042267,0.29236772656440735,-0.24048927426338196,-0.2102733999490738,-0.18646419048309326,0.2810438573360443,0.04255028814077377,0.0026973981875926256,0.05187854543328285,0.3568059206008911,0.10153745859861374,-0.2177634984254837,0.2724215090274811,0.1112794280052185,-0.06294214725494385,0.2450156807899475,-0.13791683316230774,-0.12346306443214417,0.24362611770629883,0.18495722115039825,-0.030440522357821465,-0.2477179765701294,-0.2993362247943878},{0.26237496733665466,-0.26006585359573364,-0.028894653543829918,-0.32489389181137085,0.08629211783409119,-0.15660688281059265,0.14624488353729248,0.09210334718227386,0.2875709533691406,0.10566738992929459,0.11042100936174393,0.21768665313720703,-0.3610585033893585,-0.3011482059955597,-0.08962266147136688,-0.22845406830310822,-0.1976441890001297,-0.25740566849708557,0.2599124312400818,-0.21966932713985443,0.327644020318985,-0.0597294382750988,-0.010959647595882416,0.20050576329231262,0.14441977441310883,-0.11140656471252441,0.10730179399251938,0.0634227991104126,0.1455368995666504,-0.07222644239664078,-0.28535667061805725,-0.06962362676858902},{0.22049783170223236,-0.12245416641235352,-0.04536121338605881,0.4388933479785919,-0.09230408072471619,-0.27096644043922424,-0.05132725089788437,0.05908486247062683,0.25083309412002563,0.38227859139442444,0.06626720726490021,-0.16416984796524048,0.09592092037200928,0.22486065328121185,-0.12930822372436523,0.042150139808654785,0.163071408867836,-0.27638283371925354,0.015379694290459156,-0.36507225036621094,0.3636399209499359,0.07554623484611511,-0.10698840767145157,0.21577391028404236,0.15909676253795624,0.15189029276371002,0.047895945608615875,-0.027823347598314285,0.0910198986530304,-0.16336630284786224,-0.09365388751029968,0.418308287858963},{0.00795326940715313,-0.27585822343826294,-0.10041321814060211,0.12149934470653534,-0.25591182708740234,-0.014841335825622082,0.05626809224486351,-0.283610463142395,-0.1323745995759964,-0.020466124638915062,0.17287945747375488,0.11968325078487396,0.0881265327334404,0.24905334413051605,-0.06973040103912354,-0.09387881308794022,-0.2337590754032135,0.2681453227996826,-0.14077913761138916,-0.29781633615493774,-0.17856170237064362,-0.08003783226013184,0.17957881093025208,0.003553955350071192,-0.059162918478250504,-0.04107670485973358,-0.23992009460926056,0.22129346430301666,0.07331402599811554,-0.1993010938167572,0.20871223509311676,0.20243997871875763},{0.1153167337179184,-0.18272173404693604,-0.1546688973903656,-0.1728065460920334,-0.15051758289337158,0.12857753038406372,0.035111624747514725,0.2409982532262802,-0.13418085873126984,0.08128762990236282,0.25910934805870056,0.10171512514352798,-0.09332803636789322,-0.18359513580799103,0.041330184787511826,0.15990757942199707,-0.4879027307033539,-0.2998766005039215,-0.06127765774726868,0.02523881569504738,0.14079686999320984,0.2465175986289978,0.3398997485637665,0.11564081907272339,0.05352436378598213,0.232826367020607,0.03268243744969368,-0.0802900567650795,0.22428350150585175,-0.16317375004291534,-0.32583194971084595,0.3992730379104614},{0.16665838658809662,0.004704512655735016,-0.27669018507003784,0.1714676171541214,0.09405287355184555,-0.03772576525807381,0.27261608839035034,0.10586978495121002,0.11404045671224594,-0.20132862031459808,0.22577357292175293,-0.19397203624248505,-0.41425949335098267,0.23684924840927124,0.06069152057170868,0.04135703667998314,0.049224745482206345,-0.06577148288488388,-0.14461714029312134,0.0365389883518219,-0.06335043907165527,0.20005589723587036,0.0850585475564003,-0.15434348583221436,0.02562209591269493,-0.24360407888889313,0.0362347811460495,0.40533173084259033,0.26726552844047546,-0.1499336063861847,0.2087305784225464,0.20777584612369537},{-0.017740726470947266,-0.03290735185146332,-0.07552286237478256,-0.042711179703474045,-0.25375500321388245,-0.04782722145318985,0.1905995011329651,0.22168800234794617,0.1430017650127411,-0.011719089932739735,0.22868601977825165,0.0338357649743557,0.21668380498886108,0.14038033783435822,0.17117613554000854,-0.07373184710741043,0.12143377214670181,0.16832952201366425,0.2628087103366852,0.09806866943836212,0.19317176938056946,0.23410958051681519,0.06298588961362839,0.15280930697917938,-0.0020171150099486113,-0.11779342591762543,-0.10060887783765793,-0.25506988167762756,0.16518522799015045,-0.22176142036914825,0.03967427834868431,-0.03250492364168167},{-0.36208924651145935,0.09861742705106735,-0.32524362206459045,-0.3347732424736023,-0.011770034208893776,0.06144726276397705,0.13221709430217743,-0.15562023222446442,-0.00033228754182346165,0.31508511304855347,0.07551592588424683,-0.22969307005405426,0.016979634761810303,-0.15900959074497223,-0.3018805980682373,-0.0471925362944603,-0.1835164725780487,0.1303909868001938,-0.03487182408571243,-0.08921421319246292,-0.32237696647644043,0.1887381672859192,0.14348070323467255,0.012727240100502968,-0.029926907271146774,0.3086177706718445,0.02439628541469574,-0.13416443765163422,-0.1606985181570053,-0.002704952610656619,-0.1605478972196579,-0.2499692589044571},{0.016279594972729683,-0.22063124179840088,-0.21767348051071167,-0.027622750028967857,-0.3469926714897156,-0.16865544021129608,0.1567293405532837,-0.28417137265205383,-0.19624607264995575,0.18463610112667084,0.13568858802318573,0.12648332118988037,0.13268183171749115,-0.11029201745986938,0.30527564883232117,-0.3041796386241913,0.0715983510017395,0.22850444912910461,0.05571320652961731,0.256753146648407,0.05029984191060066,-0.13372386991977692,-0.2954384684562683,0.21537591516971588,-0.15091253817081451,-0.17905020713806152,0.0910688117146492,0.01353045366704464,-0.13143157958984375,-0.2869841456413269,-0.03226049989461899,-0.1526419222354889},{0.217799112200737,0.18861235678195953,-0.07666363567113876,0.14990192651748657,-0.2804984748363495,0.18022215366363525,-0.05273216590285301,-0.13945604860782623,-0.20787978172302246,0.20155398547649384,-0.2541809678077698,-0.1561625450849533,-0.04607347026467323,-0.1849825531244278,-0.36724355816841125,-0.126991406083107,-0.08645863831043243,-0.2594311237335205,-0.21603114902973175,0.29489466547966003,0.08615086227655411,0.13080130517482758,-0.32359468936920166,0.33091118931770325,0.18409229815006256,0.2476479858160019,-0.27164146304130554,-0.030965831130743027,0.07497774809598923,-0.267792284488678,0.13191506266593933,0.08949226886034012},{0.007793788332492113,-0.3298605978488922,0.021886764094233513,-0.3023379445075989,-0.05101250484585762,0.25148457288742065,0.18648800253868103,0.023689452558755875,-0.022138562053442,0.016385050490498543,-0.24160495400428772,0.14566655457019806,0.16094434261322021,0.11589813232421875,0.12269586324691772,0.02774091064929962,-0.07306226342916489,0.13321074843406677,-0.12113715708255768,0.17669463157653809,0.21581947803497314,0.22770757973194122,-0.0969921126961708,-0.2196340709924698,0.12316723167896271,0.10959295928478241,0.23907457292079926,0.1208757609128952,-0.038474954664707184,0.17976227402687073,0.03359554335474968,-0.11754394322633743},{0.03462187945842743,-0.1908240020275116,0.25330406427383423,0.004447571933269501,0.2970259487628937,-0.02597150392830372,-0.1228252500295639,-0.16033701598644257,0.14313390851020813,-0.07089007645845413,0.07330448180437088,0.009659713134169579,-0.23253868520259857,0.025222135707736015,-0.10023342818021774,-0.2542986273765564,-0.04103023186326027,-0.03879832848906517,0.21862567961215973,0.25717005133628845,0.02862839214503765,0.043656691908836365,0.1703041046857834,0.33275899291038513,-0.16479158401489258,-0.0811416506767273,0.20929494500160217,-0.10343465209007263,-0.2205589860677719,-0.22875423729419708,0.30218595266342163,-0.0050231716595590115},{0.20241409540176392,-0.038274187594652176,0.050916269421577454,0.1426868885755539,-0.05599668622016907,0.07316664606332779,-0.2938227355480194,0.29227277636528015,-0.10583549737930298,-0.05662359297275543,0.12521086633205414,-0.2505720555782318,0.0003670463338494301,-0.04800004884600639,-0.06767989695072174,0.2664777636528015,-0.07237648218870163,-0.19992443919181824,0.060221895575523376,-0.02562057226896286,-0.15853720903396606,0.21050509810447693,0.23860163986682892,0.19630591571331024,-0.2912565767765045,0.11826196312904358,-0.04717413708567619,0.09256819635629654,-0.2719561755657196,0.30383065342903137,-0.014381718821823597,0.0661216750741005}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.24662071466445923,-0.10924923419952393,0.17065995931625366,-0.19611823558807373},{0.22122593224048615,-0.368388831615448,0.29775524139404297,0.29399314522743225},{-0.35222822427749634,0.13041134178638458,0.09624623507261276,-0.011985551565885544},{0.25761330127716064,0.567729651927948,0.3740636706352234,0.033093664795160294},{-0.28671175241470337,0.15746766328811646,-0.35413914918899536,0.11000656336545944},{-0.07617698609828949,-0.0945257768034935,0.10097955912351608,0.5116179585456848},{-0.10236788541078568,-0.11335816979408264,-0.43553754687309265,0.027501199394464493},{-0.15487432479858398,-0.2878071665763855,0.2507292926311493,-0.07573553174734116},{-0.08866170793771744,0.14602863788604736,-0.10748693346977234,-0.16746918857097626},{0.29001384973526,0.058242782950401306,-0.11731050163507462,-0.27635782957077026},{0.19033393263816833,-0.11459559202194214,0.34133413434028625,0.2774708569049835},{-0.10186175256967545,0.004753690212965012,0.49736031889915466,-0.11120012402534485},{-0.4411718547344208,0.2922414541244507,-0.0034424359910190105,-0.1478683203458786},{-0.21153144538402557,0.1497613489627838,-0.27222010493278503,0.11748770624399185},{0.15461526811122894,0.030921364203095436,0.30557236075401306,0.128608837723732},{-0.15179213881492615,-0.3429087996482849,-0.14192411303520203,-0.1384255588054657},{-0.40028271079063416,0.032121073454618454,-0.10893108695745468,0.3550451397895813},{-0.33985021710395813,-0.14756280183792114,-0.22125844657421112,0.2680826485157013},{-0.07763998955488205,-0.1929052621126175,0.45485034584999084,0.05075392872095108},{-0.2459162324666977,-0.20796246826648712,0.0445559062063694,-0.20197325944900513},{0.19071176648139954,0.166957288980484,0.1870289444923401,-0.26263222098350525},{-0.0331512875854969,-0.37720611691474915,-0.13284513354301453,0.3715662658214569},{0.4774733781814575,-0.3022627532482147,0.13900907337665558,0.09924425184726715},{-0.35499078035354614,-0.09818053990602493,-0.3016824722290039,-0.39101025462150574},{-0.14855694770812988,-0.3102526366710663,-0.11707882583141327,-0.10254587233066559},{0.203977569937706,0.19995060563087463,-0.09436748921871185,0.07915077358484268},{0.12627024948596954,-0.21322204172611237,0.345032662153244,0.0928683951497078},{-0.07083608955144882,-0.19731126725673676,-0.058736007660627365,0.3565269410610199},{0.17396949231624603,0.04384472593665123,0.0641944408416748,0.03597966954112053},{-0.1751355230808258,0.12682078778743744,0.29566577076911926,0.04160238429903984},{-0.2883192300796509,-0.06547033786773682,0.0858386680483818,0.2990170419216156},{0.3382558822631836,0.23879525065422058,0.2895025908946991,-0.051099397242069244}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.08861452341079712,-0.13023178279399872,0.07959827035665512,0.09714218229055405,0.09057436883449554,-0.1794125735759735,0.08873298019170761,0.015706866979599,-0.07628761231899261,-0.05102841928601265,0.009304176084697247,-0.009183559566736221,-0.009898827411234379,0.09426762908697128,0.11054354906082153,-0.029343916103243828};
static const float actor_encoder_self_encoder_2_bias[16] = {0.01781238429248333,0.062081899493932724,0.04554776847362518,-0.04595567286014557,-0.04588623717427254,0.07997280359268188,-0.0460955835878849,-0.09285886585712433,0.033017463982105255,-0.016966085880994797,-0.017521018162369728,-0.0047835055738687515,-0.006808682810515165,-0.07394339889287949,0.04484392702579498,-0.07944468408823013};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05339845269918442,-0.00928411539644003,-0.06865924596786499,0.050831425935029984,0.010257651098072529,0.017938004806637764,-0.05236484855413437,-0.05886046960949898,-0.0068639530800282955,-0.02042563259601593,0.014225480146706104,0.020325157791376114,-0.007636720314621925,-0.02013508975505829,0.028574639931321144,-0.08100758492946625,-0.007396560162305832,-0.03737903758883476,0.014426736161112785,-0.07553604990243912,0.018593979999423027,-0.013263028115034103,0.01411495078355074,-0.0657370463013649,-0.06834235042333603,0.07190380990505219,0.029617508873343468,-0.02168649435043335,0.057137299329042435,0.009740244597196579,-0.01707157865166664,0.05533017963171005};
static const float action_parameterization_distribution_linear_bias[4] = {0.03440414369106293,0.06339901685714722,-0.0016280916752293706,0.03789781033992767};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.32769283652305603,-0.22519266605377197,-0.11370901018381119,0.2020808309316635,-0.10217584669589996,0.07151705771684647,-0.2705276310443878,0.021297626197338104},{0.07856627553701401,0.1384594440460205,0.3107401430606842,0.34969472885131836,-0.10476239770650864,-0.279097318649292,0.3198539614677429,0.25225216150283813},{0.004874339792877436,0.20410799980163574,0.061354704201221466,-0.06977633386850357,0.34074196219444275,0.2514376640319824,-0.029741445556282997,0.15240681171417236},{0.0667056143283844,-0.28450390696525574,0.27204567193984985,-0.24346685409545898,-0.24171499907970428,0.07546142488718033,0.23196832835674286,0.21433837711811066},{-0.24568775296211243,-0.012092781253159046,-0.08538701385259628,-0.3535236120223999,0.1012904942035675,0.07474981993436813,0.3131187856197357,0.26105472445487976},{-0.05431560426950455,0.2912123203277588,-0.06763149797916412,-0.29250049591064453,0.24166426062583923,0.03804607689380646,0.07447817921638489,-0.17398789525032043},{0.01007874496281147,0.29617443680763245,0.13232894241809845,-0.22631202638149261,0.31436607241630554,-0.22475174069404602,0.18847940862178802,0.11481331288814545},{0.07761505246162415,-0.2299044132232666,-0.037513259798288345,-0.2542273700237274,0.3017297089099884,-0.132656529545784,-0.09864092618227005,-0.2886563241481781},{-0.18432755768299103,0.31863975524902344,0.045594681054353714,-0.08610599488019943,0.042729441076517105,0.24271094799041748,0.416819304227829,0.3571963608264923},{0.03615337237715721,-0.025600450113415718,-0.29467031359672546,0.27390316128730774,0.30688315629959106,0.18991084396839142,0.2567635178565979,-0.2794489562511444},{-0.12516754865646362,-0.29617881774902344,0.3269394338130951,0.16408012807369232,0.006003782618790865,-0.342911958694458,-0.07099045813083649,-0.3391723334789276},{0.30333760380744934,0.072567880153656,0.36086663603782654,0.36617133021354675,-0.14042627811431885,0.25296512246131897,0.13853426277637482,-0.37416696548461914},{-0.3181491494178772,0.15826283395290375,-0.3635910749435425,0.4009386897087097,-0.013423060066998005,0.3411816656589508,0.01154114305973053,0.2408590465784073},{0.00491745863109827,0.2073306143283844,-0.13630732893943787,-0.14294549822807312,0.05147867277264595,0.05945288762450218,0.3131125569343567,0.006128723733127117},{0.1926930546760559,-0.2824558913707733,-0.3285229504108429,-0.1954934000968933,0.18860851228237152,-0.20002394914627075,0.19390322268009186,-0.06409183144569397},{-0.3767297565937042,-0.3388482332229614,-0.2497548907995224,-0.004841686226427555,0.0369330495595932,0.14509707689285278,0.25607746839523315,0.01161934807896614},{-0.17361579835414886,-0.27483683824539185,0.18414074182510376,-0.34520038962364197,0.10558727383613586,0.0417826846241951,-0.42843762040138245,-0.1713622808456421},{0.052646566182374954,0.23262876272201538,0.08147165924310684,0.1633463352918625,-0.03196569159626961,0.3429069519042969,0.27907460927963257,-0.12780536711215973},{0.016676073893904686,-0.32049429416656494,-0.15898798406124115,-0.03293222561478615,-0.07080109417438507,-0.33833393454551697,0.0755806416273117,-0.22514720261096954},{-0.07862906903028488,-0.011526137590408325,0.0024319076910614967,-0.26718753576278687,0.10099373757839203,0.11386172473430634,0.17060543596744537,-0.03853927552700043},{0.0465676449239254,-0.08899211883544922,-0.00569182587787509,-0.1837717443704605,0.04118994250893593,-0.029817767441272736,0.09291080385446548,-0.15353979170322418},{-0.3318382501602173,0.16964173316955566,0.11161813884973526,-0.26314473152160645,-0.4125196039676666,-0.026952354237437248,0.25078099966049194,0.07306418567895889},{0.2609347403049469,0.06897353380918503,-0.4097634255886078,0.023405959829688072,-0.026698188856244087,0.22796925902366638,0.3109116554260254,0.3567182719707489},{-0.012658803723752499,-0.1927592158317566,-0.021761463955044746,0.16075308620929718,-0.28441035747528076,-0.047768205404281616,-0.12069373577833176,-0.2558977007865906},{0.1473848670721054,-0.06299823522567749,-0.4247569739818573,0.3120668828487396,-0.29023614525794983,-0.18146318197250366,-0.3997204303741455,0.13063479959964752},{-0.02237779274582863,0.3178764283657074,-0.23806419968605042,-0.09816320240497589,0.12538158893585205,-0.15442785620689392,0.3086032271385193,-0.2996978759765625},{-0.11584002524614334,0.0753660798072815,-0.09785611927509308,-0.23511134088039398,0.0757574513554573,-0.1276102364063263,-0.11184967309236526,-0.13445749878883362},{0.07355930656194687,-0.17092417180538177,-0.000684330880176276,-0.13260799646377563,0.0893087238073349,0.060888245701789856,-0.20270434021949768,0.08425329625606537},{0.2572712302207947,0.03743082657456398,-0.3390090763568878,-0.266063928604126,-0.19648177921772003,0.14784476161003113,0.22443194687366486,0.06329313665628433},{0.3111312985420227,-0.3451240062713623,0.027941547334194183,-0.09566070139408112,0.1290515959262848,-0.10835317522287369,0.18398864567279816,0.31599119305610657},{-0.29593566060066223,-0.2194085717201233,0.061065398156642914,-0.3699156939983368,0.2879890501499176,-0.26981982588768005,0.002887193812057376,0.09337466955184937},{0.1849002093076706,0.1334685981273651,-0.07965070009231567,0.23719528317451477,0.04306047782301903,-0.04988488182425499,-0.017686674371361732,0.06493822485208511}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2401662915945053,0.4235401451587677,-0.5169856548309326,-0.5281444191932678,-0.21697942912578583,-0.06364680826663971,-0.42131027579307556,0.5581281781196594},{-0.06603606045246124,0.499494343996048,-0.2671053409576416,0.6190592646598816,-0.039912860840559006,-0.004189486149698496,-0.3250100612640381,0.04240952059626579},{-0.3810335099697113,-0.16517935693264008,-0.11644821614027023,-0.0947965681552887,0.456306517124176,0.240743026137352,-0.04673156142234802,0.42455151677131653},{-0.5047114491462708,-0.537442147731781,0.3355664014816284,0.3189810514450073,-0.4770025610923767,-0.21797996759414673,0.4277058243751526,0.2234470099210739},{-0.30422696471214294,-0.24465903639793396,-0.3213803768157959,-0.23650987446308136,0.32639873027801514,-0.2379828542470932,0.5100163817405701,-0.40053194761276245},{-0.025997307151556015,0.232111394405365,0.19343216717243195,-0.5472162961959839,0.5629687309265137,-0.26412609219551086,-0.4744078814983368,-0.4056927561759949},{-0.33183571696281433,0.1712481826543808,0.09016832709312439,-0.4984886944293976,-0.010212228633463383,-0.5206692218780518,0.4955882132053375,0.03828207775950432},{-0.3961423933506012,-0.17713506519794464,-0.1261361688375473,-0.3200457692146301,-0.34416860342025757,0.12853674590587616,0.5622898936271667,-0.30449602007865906}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.001496144919656217,-0.13476312160491943,-0.13172854483127594,0.015955371782183647,0.11486416310071945,0.04658611863851547,0.09860143065452576,0.0629609152674675};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.0345415361225605,-0.04582792893052101,-0.01806967332959175,-0.1144232451915741,-0.07249733805656433,-0.0778709128499031,0.0011566447792574763,-0.15335169434547424};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

