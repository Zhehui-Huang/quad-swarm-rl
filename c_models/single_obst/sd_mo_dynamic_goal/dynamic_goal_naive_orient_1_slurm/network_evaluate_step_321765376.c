#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3430076837539673,0.06889325380325317,0.02832437865436077,0.23890994489192963,0.35627081990242004,-0.23926393687725067,-0.28728094696998596,0.13305909931659698,0.3558044731616974,-0.2789096534252167,0.4569793939590454,0.05452970042824745,0.27896732091903687,0.11787326633930206,-0.30701377987861633,0.02134084701538086},{-0.3011881411075592,-0.19353948533535004,-0.2857891023159027,-0.10406636446714401,0.20341823995113373,0.3651186525821686,0.15196293592453003,0.019253790378570557,0.14456871151924133,0.22354857623577118,-0.12835648655891418,0.002579433610662818,-0.06843709200620651,0.11907568573951721,0.2719285190105438,-0.23146574199199677},{0.006863909773528576,0.26976463198661804,0.2186845988035202,0.25075575709342957,0.053653132170438766,-0.2456934005022049,0.7433634996414185,-0.2286018431186676,-0.13224653899669647,-0.007383285090327263,0.006533506792038679,-0.23492713272571564,0.2680833339691162,0.5958895683288574,-0.4709552824497223,0.11768456548452377},{0.1706157624721527,-0.14049850404262543,-0.1572059690952301,-0.051710791885852814,-0.21812273561954498,0.06457193195819855,-0.0625004842877388,-0.24921700358390808,-0.019319960847496986,-0.14897863566875458,0.6192696690559387,-0.24681726098060608,-0.3652419149875641,-0.1762992888689041,0.22078068554401398,-0.06152858957648277},{-0.2573580741882324,0.010728270746767521,0.21726125478744507,-0.48332080245018005,0.5077840685844421,0.2017952799797058,0.24417220056056976,-0.21686166524887085,-0.18522752821445465,0.25561946630477905,-0.039807356894016266,-0.44888076186180115,0.006138110999017954,-0.19984622299671173,0.463108628988266,-0.016747834160923958},{-0.012909723445773125,-0.12961445748806,-0.07192040979862213,-0.06433524191379547,0.08566988259553909,-0.23181526362895966,0.5877869725227356,-0.2933621108531952,-0.22435849905014038,-0.21255578100681305,0.1813184916973114,0.08397604525089264,0.34585055708885193,0.015433195978403091,0.32093504071235657,0.23625552654266357},{-0.23637573421001434,0.2914890944957733,-0.040673017501831055,0.09267929941415787,-0.303213894367218,-0.10604459047317505,-0.10462921857833862,-0.03188064694404602,0.3106812834739685,0.3273216784000397,-0.2722955048084259,-0.12513324618339539,0.30052706599235535,0.01005812082439661,-0.13941062986850739,0.30447444319725037},{-0.35016846656799316,0.15926216542720795,0.04559830576181412,-0.29382357001304626,0.3782895803451538,-0.24902454018592834,-0.2976062595844269,-0.4581948518753052,-0.060009971261024475,-0.2312769591808319,0.5582193732261658,0.1500849425792694,0.019767798483371735,0.4371604025363922,0.06659919768571854,0.6007679104804993},{0.25048550963401794,0.1340152472257614,-0.13833297789096832,0.037501320242881775,-0.5816752314567566,-0.5837266445159912,0.1831752061843872,-0.5825062394142151,-0.07719812542200089,-0.0953543409705162,0.3069014847278595,-0.5693340301513672,-0.5155180096626282,0.15744994580745697,0.0685499757528305,-0.2469681054353714},{0.6338972449302673,-0.7911337614059448,-0.33478477597236633,0.11085537821054459,0.1984497308731079,-0.31563955545425415,-0.08112587779760361,-0.19862084090709686,-0.36684608459472656,0.0072800288908183575,-0.325926274061203,-0.31176164746284485,0.6220784187316895,-0.27859246730804443,-0.6987296938896179,-0.2369084507226944},{0.23096169531345367,0.37469157576560974,-0.137102410197258,0.09296178817749023,0.04813786596059799,-0.20344489812850952,-0.16901999711990356,0.11837393790483475,-0.061787474900484085,0.23293815553188324,0.20585469901561737,0.25484633445739746,-0.11035729199647903,0.23097454011440277,0.019473588094115257,-0.2765927016735077},{-0.3745231628417969,0.21606379747390747,0.5265529155731201,-0.7530302405357361,0.013278272934257984,0.08840741217136383,0.14324459433555603,0.28436633944511414,0.30525946617126465,0.43331995606422424,0.4078642725944519,-0.3131093978881836,0.2997860610485077,-0.19130077958106995,0.03664136305451393,-0.205474853515625},{0.17009101808071136,-0.27583733201026917,-0.25756338238716125,0.3220454156398773,-0.19626684486865997,-0.3035012483596802,-0.05800587683916092,0.33837762475013733,0.20845206081867218,-0.11115306615829468,-0.3185233175754547,0.29111090302467346,0.42895495891571045,0.31679609417915344,-0.16841499507427216,0.6311638355255127},{0.2283698469400406,0.2770542502403259,-0.382254034280777,0.1078307256102562,-0.09004054218530655,-0.17803364992141724,-0.2530968189239502,0.13545849919319153,-0.3279024362564087,-0.39429113268852234,-0.09178122878074646,0.09170809388160706,-0.593061625957489,-0.07004867494106293,-0.31098121404647827,-0.14012615382671356},{0.09101516008377075,0.6014282703399658,0.4706514775753021,-0.4452628791332245,-0.3153506815433502,0.252812922000885,-0.04106278344988823,0.016967345029115677,0.49361324310302734,0.34451597929000854,-0.17534439265727997,0.12020169943571091,-0.13385923206806183,-0.325292706489563,0.14749479293823242,-0.3153224289417267},{-0.348843514919281,-0.07509094476699829,-0.02296079695224762,0.25337499380111694,-0.04138790816068649,0.048432618379592896,-0.1529083251953125,-0.07142061740159988,-0.37646740674972534,-0.09442754834890366,0.28201329708099365,0.12757432460784912,-0.20540359616279602,-0.23342567682266235,-0.4043262302875519,-0.12295348942279816},{-0.3385790288448334,0.1428418904542923,-0.26925572752952576,0.012377835810184479,-0.11813650280237198,0.3369063436985016,0.3461427092552185,0.1377079039812088,0.26846060156822205,-0.2297711968421936,-0.06724685430526733,-0.10907670110464096,0.002335116732865572,0.05236915126442909,-0.010132160037755966,-0.15050870180130005},{0.12860773503780365,-0.47021737694740295,0.17121288180351257,0.19534838199615479,0.013075056485831738,0.2980261445045471,0.3385283052921295,0.15659838914871216,-0.1506333351135254,-0.25865963101387024,-0.11477728933095932,-0.08531621098518372,-0.11338227987289429,-0.36803606152534485,0.06202942505478859,0.02055446058511734}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.16011913120746613,0.31774774193763733,0.3593285083770752,-0.0850418210029602,-0.2237369269132614,0.08118845522403717,0.07086142152547836,0.26169639825820923,-0.04087960720062256,0.276912659406662,0.4951297640800476,-0.358894407749176,-0.1152757778763771,0.07991248369216919,0.027751941233873367,-0.038129307329654694},{-0.5660653114318848,0.20295609533786774,-0.30700474977493286,0.24900580942630768,0.34486326575279236,-0.16218464076519012,-0.3639164865016937,-0.28208139538764954,0.34311333298683167,0.28415733575820923,-0.07582519203424454,0.2750745713710785,-0.36676156520843506,0.1682053953409195,-0.2381049245595932,0.4673250615596771},{-0.40898722410202026,0.19112832844257355,-0.38126829266548157,0.01310672890394926,-0.42250198125839233,-0.31071150302886963,-0.12806729972362518,0.00981169007718563,-0.23975667357444763,0.3554309010505676,0.21134519577026367,-0.06804095953702927,0.25155431032180786,-0.3505779802799225,-0.050244566053152084,0.0001916838955366984},{0.2645949423313141,-0.2266000360250473,0.08808436244726181,0.44303128123283386,-0.4377257525920868,-0.3836815357208252,0.27996376156806946,0.10844558477401733,0.29503586888313293,-0.09391508996486664,0.32971057295799255,0.101984903216362,-0.261907160282135,-0.02439771220088005,-0.020376289263367653,-0.3628552556037903},{-0.39970168471336365,0.03907549008727074,0.2562859058380127,-0.3839094042778015,0.17962759733200073,0.32804372906684875,-0.33520185947418213,0.21290922164916992,-0.2175699770450592,0.2078791707754135,-0.13027875125408173,-0.009145516902208328,-0.11734110116958618,-0.030685417354106903,-0.1894271820783615,-0.17604772746562958},{0.01738312467932701,-0.23657773435115814,-0.019155366346240044,-0.34954363107681274,0.2931171655654907,0.08873440325260162,-0.028487632051110268,-0.07820423692464828,-0.21635228395462036,0.3709828853607178,0.29376864433288574,-0.09020218253135681,-0.170315682888031,0.22514306008815765,-0.067647784948349,-0.35709038376808167},{0.23577934503555298,-0.13730818033218384,0.33054423332214355,-0.31325796246528625,-0.37291380763053894,-0.04030660167336464,-0.3829188644886017,0.35538822412490845,-0.09687986224889755,-0.23329822719097137,-0.2631121277809143,-0.049309104681015015,-0.015513384714722633,-0.11291290819644928,0.47926315665245056,-0.37797585129737854},{-0.28399476408958435,0.3767601549625397,-0.06739452481269836,0.28434649109840393,0.020134462043642998,-0.2510746121406555,-0.09498637169599533,0.1273929327726364,-0.042290423065423965,0.48901399970054626,0.16625158488750458,-0.2149716317653656,0.00948844850063324,-0.08388100564479828,0.04814741760492325,0.15000972151756287},{0.11709295958280563,0.28077006340026855,-0.16727732121944427,-0.3408481180667877,0.38151466846466064,-0.20486846566200256,0.2215925008058548,-0.35677245259284973,0.1199234277009964,0.03449693322181702,0.12517832219600677,0.12486490607261658,-0.028496364131569862,-0.2932506799697876,-0.07661540806293488,0.2205079197883606},{-0.2269972711801529,-0.007036459632217884,-0.30148059129714966,-0.3371574580669403,0.23215195536613464,-0.44834354519844055,-0.20767365396022797,0.2714613080024719,-0.13963687419891357,0.2110384851694107,-0.036559686064720154,-0.07516463845968246,-0.359372615814209,-0.009232758544385433,-0.2378208041191101,-0.3304438591003418},{-0.2629968225955963,-0.1208682581782341,-0.09448347240686417,-0.356200635433197,-0.3450184464454651,-0.02104925364255905,0.11495766788721085,-0.5044345855712891,0.015230667777359486,-0.06969012320041656,0.17069202661514282,0.021520962938666344,0.42319849133491516,0.04878540337085724,0.2351997196674347,0.2506619691848755},{-0.1823951154947281,-0.04646937921643257,-0.4300304055213928,0.3736225366592407,0.1440393477678299,-0.039691101759672165,0.18448655307292938,0.10019470006227493,-0.41840478777885437,0.22974847257137299,-0.3151143491268158,-0.177541121840477,-0.3896905481815338,0.41592469811439514,-0.364040732383728,0.0766819640994072},{-0.1668766289949417,-0.447783499956131,-0.11343410611152649,0.175649031996727,-0.17463213205337524,-0.1162622943520546,-0.09087672084569931,0.4113050103187561,0.4379102885723114,0.10641147196292877,-0.09528934955596924,-0.2729693055152893,0.18151700496673584,-0.38797610998153687,0.1487099975347519,-0.24629777669906616},{-0.2750667929649353,-0.455363005399704,-0.18340514600276947,-0.09458250552415848,-0.44633162021636963,0.39345189929008484,-0.0652744472026825,0.1989642232656479,-0.1804562509059906,-0.3250621259212494,-0.3168655037879944,0.406375914812088,-0.21744395792484283,0.06459061801433563,-0.2823845446109772,0.3750622868537903},{-0.34023964405059814,0.3524358570575714,-0.16611023247241974,0.12119173258543015,-0.37777474522590637,0.26698997616767883,0.052584949880838394,-0.3755345046520233,0.11328347027301788,0.18696314096450806,-0.17725825309753418,0.0729714184999466,0.2869552969932556,-0.24765288829803467,-0.34670451283454895,-0.16207394003868103},{-0.1626182198524475,-0.3542148470878601,-0.5415250062942505,0.31205543875694275,0.04343041405081749,0.17008621990680695,-0.25348636507987976,0.18203695118427277,-0.4410269558429718,-0.320974737405777,-0.4062124788761139,0.24557864665985107,-0.23704802989959717,0.20875859260559082,0.08808491379022598,0.31297191977500916}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.03838631138205528,-0.13468995690345764,0.11514516919851303,-0.13284628093242645,-0.07382731884717941,0.12960663437843323,0.17308436334133148,-0.22969146072864532,-0.11971914023160934,0.3353588879108429,0.048472240567207336,0.13095936179161072,0.10723834484815598,0.12633974850177765,-0.18311257660388947,0.14670026302337646,0.11260739713907242,-0.3055405914783478,-0.27564895153045654,-0.09347007423639297,-0.20501430332660675,0.1510026752948761,-0.20985765755176544,0.37268927693367004,-0.20756345987319946,-0.032040636986494064,0.11995180696249008,0.18342161178588867,-0.25544461607933044,-0.19936728477478027,0.2699248492717743,0.2996508479118347},{0.14953109622001648,-0.05859346315264702,0.14488735795021057,-0.08369464427232742,-0.12511684000492096,0.2079816460609436,-0.002140429802238941,-0.08980906009674072,-0.012244408950209618,-0.05672220140695572,-0.10552619397640228,0.02320467308163643,0.3948734402656555,0.23532482981681824,0.10522584617137909,0.0331832654774189,-0.24128656089305878,-0.27583450078964233,0.09180789440870285,0.04987955838441849,0.07823093235492706,0.29210996627807617,0.25068581104278564,-0.15617461502552032,0.06823589652776718,0.3012440800666809,-0.3369292914867401,0.19052453339099884,0.09777195751667023,-0.25944870710372925,-0.07750189304351807,-0.03649168089032173},{-0.08485472202301025,-0.04515735059976578,0.15481096506118774,-0.1466868668794632,-0.18770548701286316,0.0029360256157815456,-0.27220356464385986,0.16538894176483154,0.26054051518440247,-0.00860277097672224,-0.2131270468235016,0.10616933554410934,0.364607572555542,-0.22957396507263184,0.07882928103208542,-0.03933156654238701,-0.4009030759334564,0.21092601120471954,-0.3924119770526886,-0.06672384589910507,-0.051562242209911346,-0.08539844304323196,-0.08232426643371582,-0.08556830137968063,-0.008035016246140003,0.4204554557800293,-0.041497454047203064,0.11983565986156464,0.29691460728645325,-0.4109533429145813,-0.06903151422739029,0.0229556355625391},{0.1909722536802292,-0.2612694203853607,0.023968009278178215,-0.39918842911720276,0.11446135491132736,-0.08139010518789291,-0.051692310720682144,0.21896468102931976,0.05342097580432892,0.26490873098373413,0.010541284456849098,-0.15424847602844238,-0.20152948796749115,-0.07611371576786041,0.26618996262550354,-0.21872642636299133,0.04786000773310661,-0.06212642043828964,-0.1551542580127716,0.12144723534584045,-0.18859541416168213,0.17998696863651276,-0.22880269587039948,0.3268776535987854,-0.3019356429576874,0.015384342521429062,-0.08367138355970383,-0.2475614994764328,-0.002087733941152692,0.05386314541101456,0.22646385431289673,-0.1431809961795807},{0.2697232961654663,-0.03550022467970848,0.03444742038846016,0.2642454504966736,-0.2820625603199005,-0.0791834145784378,0.18234193325042725,-0.01594453677535057,0.10753551870584488,-0.17812205851078033,0.004248928278684616,-0.083152174949646,-0.1975233554840088,-0.1405513882637024,0.30536583065986633,0.2583763599395752,-0.047380246222019196,-0.3231032192707062,0.14102992415428162,-0.11912427097558975,-0.13375160098075867,0.23026502132415771,0.26892325282096863,0.023726262152194977,-0.10680394619703293,-0.11590443551540375,0.020023906603455544,0.2508591413497925,0.24668781459331512,0.10753398388624191,0.11796455085277557,-0.2366739958524704},{0.31092196702957153,-0.16490626335144043,0.03523935377597809,0.09526392817497253,-0.1242152601480484,-0.30876147747039795,-0.23487940430641174,-0.3214276134967804,-0.19153839349746704,0.03561650589108467,-0.052163511514663696,-0.005437739659100771,-0.06277317553758621,-0.05657759681344032,-0.19107608497142792,-0.2708786725997925,0.15420864522457123,0.026918185874819756,-0.31297701597213745,0.23912747204303741,-0.10485879331827164,-0.17301705479621887,0.21361283957958221,-0.12292931973934174,-0.1646864265203476,-0.2497374564409256,-0.14216595888137817,0.07311137765645981,0.09413816034793854,0.24900104105472565,-0.28520339727401733,0.16169396042823792},{0.19677993655204773,0.05491947382688522,0.23021851480007172,-0.16264773905277252,0.2504233419895172,-0.18632806837558746,-0.3112558424472809,-0.019896671175956726,0.2983863651752472,0.15500159561634064,-0.18906822800636292,0.12397187948226929,0.0911773145198822,0.30650585889816284,0.1140037551522255,-0.048387594521045685,-0.2239253968000412,0.12734001874923706,-0.02474489063024521,-0.03207316994667053,-0.10890471935272217,0.246989443898201,0.18716786801815033,0.15903963148593903,-0.3077877461910248,-0.22777198255062103,-0.28109467029571533,-0.34644514322280884,0.04353294149041176,-0.1237204298377037,0.31732505559921265,0.14814403653144836},{0.35451754927635193,-0.3811180889606476,0.07620487362146378,-0.43191391229629517,-0.2787826955318451,0.3298572599887848,0.4201584458351135,0.22885875403881073,-0.07123655080795288,0.12613005936145782,0.15904037654399872,-0.1491718739271164,0.05436587706208229,0.2468295842409134,-0.02270055189728737,0.21330757439136505,0.41136500239372253,-0.28038206696510315,-0.07943642884492874,-0.4058144688606262,0.18694435060024261,0.24247018992900848,0.20873376727104187,0.13125093281269073,0.11377570033073425,0.11781793087720871,0.16357135772705078,0.30164438486099243,-0.10269147902727127,-0.26125311851501465,0.2663327753543854,0.10440722852945328},{0.03091978281736374,-0.07819151133298874,0.18148227035999298,0.27126944065093994,-0.24223150312900543,-0.35505110025405884,-0.09272825717926025,0.2295200228691101,-0.1662209928035736,-0.22429154813289642,0.0435340441763401,0.14617665112018585,0.13550764322280884,-0.3044261932373047,0.12496650964021683,-0.17909860610961914,-0.21333497762680054,0.14537805318832397,-0.30520305037498474,0.25549226999282837,-0.3275931477546692,-0.3072666823863983,-0.33896756172180176,0.21523645520210266,0.11445207893848419,0.12414029240608215,0.35330870747566223,0.21353553235530853,-0.15674172341823578,-0.36413493752479553,-0.12560541927814484,0.1793438196182251},{0.32814475893974304,0.05371006205677986,0.025181636214256287,0.22355780005455017,0.05187145248055458,0.24703383445739746,-0.045396074652671814,0.2533101737499237,-0.06608983129262924,0.0319938100874424,0.17418652772903442,0.10871158540248871,-0.1114499419927597,-0.34973692893981934,0.19051620364189148,0.20694993436336517,0.018651900812983513,-0.16489169001579285,-0.0007247927715070546,-0.004370097536593676,0.10337027907371521,-0.3374875485897064,0.3697439134120941,0.026253072544932365,-0.044764768332242966,0.12087103724479675,-0.36141374707221985,-0.16102132201194763,0.047872722148895264,0.01792752556502819,0.10343874990940094,0.22902590036392212},{-0.1073002740740776,0.08165902644395828,-0.09312144666910172,0.1902942955493927,-0.10653059184551239,0.28491267561912537,0.07228528708219528,-0.10764876753091812,0.2972690761089325,-0.31191587448120117,-0.16581764817237854,0.1740266978740692,-0.07920033484697342,0.08550821244716644,-0.3190860450267792,0.0247658621519804,0.06008920818567276,0.1652413159608841,0.05974439159035683,-0.11898858845233917,-0.2615792453289032,0.1822321116924286,0.22677600383758545,0.23175041377544403,-0.31916332244873047,0.35663697123527527,-0.13736611604690552,-0.012224811129271984,-0.13710543513298035,0.11667925119400024,0.21318471431732178,0.24130916595458984},{-0.22363397479057312,0.2842051088809967,-0.0759788230061531,-0.004729548469185829,-0.2585158944129944,-0.18425670266151428,0.1644531935453415,-0.30421340465545654,-0.031152212992310524,-0.25786226987838745,-0.2031005173921585,-0.08178988099098206,0.17457692325115204,-0.23789551854133606,-0.12406972050666809,-0.39150160551071167,-0.15428809821605682,0.010330334305763245,0.302977055311203,-0.2548752427101135,0.07153107225894928,-0.14898119866847992,0.010534729808568954,0.2930894196033478,-0.11733641475439072,0.1290772706270218,0.27854955196380615,-0.15145571529865265,-0.09402415156364441,0.3018939793109894,-0.21429526805877686,-0.33868512511253357},{-0.05513400211930275,0.25654393434524536,0.24861246347427368,-0.32873544096946716,0.31079229712486267,0.01866939291357994,-0.11475495994091034,-0.003777475329115987,0.12208597362041473,-0.30673205852508545,-0.03483247384428978,0.037327464669942856,0.20158930122852325,0.03164387121796608,0.0030098992865532637,-0.025475434958934784,0.23147453367710114,-0.30540046095848083,0.3334861099720001,0.05498521029949188,-0.15371271967887878,0.16299676895141602,-0.09946610033512115,-0.24366030097007751,0.24697601795196533,-0.07241858541965485,-0.004067068453878164,-0.1088232547044754,0.05976589024066925,-0.12773416936397552,0.31297898292541504,0.28505396842956543},{0.08259173482656479,-0.228911355137825,-0.18906810879707336,0.07699146121740341,0.058648113161325455,0.2896591126918793,-0.12031756341457367,-0.2788815498352051,0.32409703731536865,0.06251505762338638,0.02257218025624752,0.03648783266544342,-0.18822595477104187,0.11538849771022797,-0.19895754754543304,-0.30423322319984436,0.05849234759807587,0.006995349656790495,0.1886930763721466,0.38008248805999756,-0.24713942408561707,0.14220303297042847,-0.14473360776901245,0.07657194882631302,0.06939937174320221,-0.3020809590816498,-0.1606937199831009,-0.29082733392715454,-0.10137638449668884,-0.13924075663089752,0.21709810197353363,-0.351972758769989},{-0.06807709485292435,0.33603787422180176,0.1384323537349701,-0.18477948009967804,-0.13376134634017944,-0.2218821793794632,0.1506456732749939,-0.08733487129211426,0.236283540725708,-0.04902774095535278,0.2444586157798767,0.18859079480171204,-0.003291234141215682,0.0695176050066948,-0.1640901118516922,0.19528889656066895,-0.20542362332344055,-0.3979196846485138,-0.28667327761650085,0.11269976198673248,0.13439393043518066,-0.27424952387809753,-0.3448055386543274,-0.24385738372802734,-0.20292255282402039,0.09189381450414658,0.3874853849411011,0.012127785943448544,-0.11462005972862244,0.06771882623434067,-0.12702548503875732,0.11709556728601456},{-0.21208661794662476,-0.19030539691448212,-0.24238577485084534,0.07209549099206924,-0.30321362614631653,-0.1397869735956192,-0.11421684175729752,-0.14945103228092194,-0.2902015149593353,-0.19491200149059296,0.11253120005130768,0.17399320006370544,-0.2602691650390625,0.28243881464004517,-0.033263180404901505,0.1789841502904892,0.03259079158306122,0.02616528794169426,0.03818821161985397,0.13883714377880096,0.14617963135242462,0.32440921664237976,0.09656635671854019,0.23867559432983398,0.11151476204395294,-0.2518368065357208,-0.13207286596298218,0.23571281135082245,-0.06115073338150978,-0.21055078506469727,-0.17839238047599792,-0.21192964911460876},{-0.3308696746826172,-0.20667897164821625,-0.39436209201812744,0.0953296571969986,-0.1667633354663849,-0.11701365560293198,-0.16695447266101837,0.027340762317180634,-0.017898274585604668,0.06539474427700043,-0.24493327736854553,0.035568419843912125,0.17806555330753326,-0.013051560148596764,0.01751316711306572,0.166063129901886,-0.16227656602859497,-0.0876510813832283,0.1410224288702011,0.12671467661857605,0.2042986899614334,0.010556857101619244,-0.29073312878608704,0.07175078243017197,0.25465524196624756,-0.2842303514480591,0.17548394203186035,-0.013191758655011654,0.04936877265572548,-0.17026390135288239,0.18845196068286896,-0.11669714003801346},{0.27429574728012085,-0.05803545564413071,0.055754151195287704,0.10355442762374878,-0.2823679745197296,0.0031717841047793627,0.1696537286043167,0.23273561894893646,-0.08497641235589981,-0.0985109955072403,0.3056624233722687,-0.19628992676734924,-0.03177155181765556,-0.07597317546606064,-0.14821647107601166,0.22068747878074646,0.025511760264635086,-0.06772361695766449,0.13339897990226746,-0.2869468033313751,0.03566937521100044,-0.31044715642929077,-0.23698127269744873,0.2584083378314972,-0.14061486721038818,-0.13711899518966675,0.17113755643367767,-0.009232875891029835,-0.1546696275472641,-0.0005330798448994756,-0.09455486387014389,-0.023473648354411125},{0.2964347302913666,-0.056564148515462875,0.07210348546504974,0.07377313822507858,-0.016867049038410187,-0.10967294126749039,0.1492631435394287,-0.25192520022392273,0.22678892314434052,0.27855822443962097,0.005614759400486946,0.1721068024635315,0.2710893452167511,0.3501276969909668,-0.2972838282585144,-0.31207454204559326,-0.3043423295021057,0.058256443589925766,-0.15341925621032715,-0.28384172916412354,-0.19506888091564178,0.29740580916404724,0.06326906383037567,0.14568088948726654,-0.13403292000293732,-0.08730997145175934,-0.15428555011749268,-0.20680812001228333,0.24546507000923157,0.1636708825826645,-0.2832331359386444,-0.16297966241836548},{-0.11540503799915314,0.13800475001335144,0.2811702787876129,-0.07257134467363358,-0.030438151210546494,0.05651823803782463,-0.014195364899933338,-0.3285049796104431,0.21675817668437958,0.2611530125141144,0.1570960283279419,0.19875921308994293,-0.24543394148349762,0.20210732519626617,-0.2838374972343445,0.2697646915912628,0.15873152017593384,-0.2164977490901947,0.24494734406471252,0.15230576694011688,-0.3140917122364044,0.3141983449459076,-0.33069685101509094,0.1449989527463913,0.19318155944347382,0.21347680687904358,0.10289433598518372,0.07846082746982574,-0.1989997774362564,0.23875759541988373,-0.09349000453948975,0.09895256906747818},{-0.16804766654968262,-0.05232959985733032,-0.019626013934612274,0.2545848488807678,-0.05219448357820511,0.14974451065063477,-0.38156408071517944,-0.21877877414226532,-0.1414526253938675,-0.13244223594665527,-0.18434536457061768,-0.09357845783233643,0.09981486201286316,-0.08752003312110901,0.09747996181249619,-0.19210603833198547,0.13825753331184387,-0.02377687394618988,-0.34577128291130066,-0.2190164476633072,0.09435274451971054,0.20912408828735352,-0.211682990193367,0.3128572702407837,-0.2317768633365631,0.11611813306808472,0.12165167182683945,-0.08747673034667969,0.1189182922244072,-0.27899548411369324,0.3379032015800476,0.06650172919034958},{0.34995582699775696,-0.07418192923069,0.06615621596574783,0.14813195168972015,-0.15808311104774475,0.2439357489347458,-0.01776474341750145,0.24562616646289825,0.16919834911823273,0.12955139577388763,0.026026666164398193,-0.41473615169525146,-0.2712664306163788,-0.05840010568499565,0.06682638078927994,-0.14975441992282867,0.32651734352111816,0.23349638283252716,-0.2155761569738388,-0.2021346241235733,0.276330828666687,0.29009589552879333,0.2560955882072449,0.16117426753044128,-0.07085033506155014,-0.043005120009183884,-0.08202721178531647,-0.24337610602378845,0.2077123522758484,0.08993944525718689,-0.20090949535369873,0.11397287994623184},{-0.017062384635210037,0.02046055905520916,-0.06527672708034515,-0.25458329916000366,-0.10490751266479492,-0.24382948875427246,-0.22650156915187836,-0.16953113675117493,0.021161286160349846,-0.009300975129008293,-0.267441064119339,0.01703161559998989,-0.2528376877307892,-0.16708847880363464,0.0019387638894841075,0.08521559834480286,0.2760660946369171,-0.17366304993629456,-0.347921758890152,0.2741679251194,-0.1579483449459076,0.2596034109592438,-0.023183492943644524,-0.0496898777782917,0.045410268008708954,0.12282266467809677,-0.05099816247820854,-0.2815036475658417,0.23620040714740753,0.2508368492126465,-0.14746786653995514,0.20122042298316956},{-0.27623388171195984,-0.004721567966043949,0.04410857707262039,-0.01601358875632286,0.03858106955885887,0.09057439863681793,-0.161913201212883,0.12445148080587387,-0.21425144374370575,-0.21861077845096588,0.15077434480190277,-0.12574760615825653,-0.2003980576992035,0.25525227189064026,0.0024679761845618486,0.0030407605227082968,0.21457955241203308,-0.2685225009918213,-0.15252499282360077,0.23706883192062378,0.0634852945804596,0.1821231096982956,-0.012382298707962036,-0.0034933225251734257,-0.2567387521266937,-0.12723304331302643,0.028847111389040947,0.32626616954803467,0.009295070543885231,-0.008040057495236397,0.2735879421234131,0.3076777160167694}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.08887924998998642,0.20413939654827118,0.43466246128082275,-0.07664486020803452},{0.04895056039094925,-0.15360412001609802,0.0111080352216959,0.2756667733192444},{-0.11605016142129898,0.12052021920681,0.1427505761384964,0.10902580618858337},{0.3479153513908386,0.04284607991576195,0.028625668957829475,0.4979357421398163},{-0.05980371683835983,0.0913752093911171,0.3338397741317749,0.02050846256315708},{-0.1415427327156067,0.24742934107780457,0.24661850929260254,-0.06947798281908035},{-0.37664923071861267,-0.028436047956347466,0.09832360595464706,-0.12927880883216858},{-0.38208872079849243,-0.17221543192863464,0.4358776807785034,-0.30499133467674255},{0.3267174959182739,-0.14020122587680817,-0.29814741015434265,-0.4107172191143036},{0.1018441915512085,0.37132468819618225,0.375311940908432,-0.46108874678611755},{-0.2508890926837921,-0.22589550912380219,-0.08330313861370087,0.12407443672418594},{0.4345080852508545,-0.19229993224143982,-0.07343068718910217,0.22452044486999512},{0.2951273024082184,0.26925355195999146,-0.07868610322475433,0.14417821168899536},{0.0007217665552161634,0.04403967410326004,-0.30651992559432983,0.053290460258722305},{0.1053026095032692,0.26686739921569824,0.4072788655757904,0.3078772723674774},{0.14824040234088898,-0.01641230285167694,0.29489344358444214,0.283085435628891},{-0.293345183134079,-0.09948013722896576,-0.06352198868989944,-0.2871483266353607},{-0.13522185385227203,0.17757666110992432,-0.15567544102668762,-0.1039152592420578},{-0.3818155825138092,0.19494444131851196,0.16360493004322052,0.39937713742256165},{-0.0334201417863369,0.3410755693912506,-0.1929112821817398,0.18036706745624542},{-0.29406437277793884,-0.3947939872741699,-0.1255858987569809,0.026855148375034332},{0.3712717890739441,0.47273504734039307,0.0069004083052277565,-0.32628917694091797},{-0.014453158713877201,0.201163187623024,0.2287830114364624,0.19901098310947418},{-0.05388449504971504,0.4437430500984192,-0.06777235865592957,-0.22077657282352448},{-0.013104991987347603,-0.08893633633852005,-0.1148211881518364,0.008911286480724812},{0.3436158299446106,-0.4466337263584137,-0.05757920444011688,0.00924384593963623},{-0.03950098156929016,-0.3979082405567169,-0.18091973662376404,-0.28625038266181946},{0.14528951048851013,-0.2253657728433609,0.23948730528354645,0.14514262974262238},{0.03487776964902878,-0.06012868881225586,0.03241744264960289,0.02137492038309574},{-0.4627169668674469,0.4198664724826813,0.2224360853433609,-0.002389514120295644},{0.37473395466804504,-0.16787366569042206,0.2137945145368576,-0.0594443678855896},{0.14592576026916504,-0.4399903416633606,0.4147903323173523,-0.2838200628757477}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.06193316727876663,-0.029232406988739967,0.005976412445306778,0.03847943991422653,-0.08146127313375473,-0.09311974793672562,0.014820659533143044,0.042493317276239395,0.06539859622716904,-0.006620616186410189,-0.058044202625751495,-0.012670197524130344,0.04633120819926262,0.00025295084924437106,-0.06544370204210281,-0.019252749159932137};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.023415734991431236,0.004589150194078684,0.01084973942488432,0.004474644083529711,0.008188817650079727,-0.012706703506410122,0.031173091381788254,0.01772036775946617,0.015286865644156933,0.020526444539427757,0.03897087648510933,3.2098421797854826e-05,0.04655095934867859,-0.03288567066192627,-0.03742018714547157,0.0006717928336001933};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.00014110516349319369,0.011031465604901314,0.009437230415642262,0.0050250086933374405,0.01083394791930914,0.0006776552181690931,0.0040438249707221985,0.009566908702254295,-0.03822063282132149,-0.019605914130806923,0.006604242138564587,0.012405009008944035,0.015013337135314941,0.011907024309039116,-0.0026438902132213116,0.03439705818891525,-0.003791545517742634,-0.018831202760338783,0.014039221219718456,-0.012286460027098656,-0.01629629172384739,-0.006338967010378838,0.04508236050605774,0.010179202072322369,0.008060207590460777,0.026994574815034866,-0.028187870979309082,0.03767583519220352,-0.009645852260291576,0.0012754827039316297,0.013759184628725052,0.003243810497224331};
static const float action_parameterization_distribution_linear_bias[4] = {-0.0034128031693398952,-0.015671975910663605,-0.0056769526563584805,0.009705405682325363};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.046343863010406494,0.25470149517059326,-0.1706508845090866,0.2029780149459839,0.10104481875896454,0.05609862878918648,0.4057103991508484,-0.07544992864131927},{-0.22243064641952515,-0.0350935123860836,-0.30015116930007935,-0.20601223409175873,-0.39403825998306274,-0.25100743770599365,-0.003655873006209731,-0.25896304845809937},{-0.24800123274326324,0.021461712196469307,0.2332272082567215,0.26299849152565,0.23433345556259155,-0.0349092036485672,0.37800896167755127,-0.17376971244812012},{0.03473062068223953,0.09554395824670792,-0.168483167886734,0.03239528089761734,0.0019872402772307396,-0.06354223191738129,0.33710432052612305,-0.2548951208591461},{-0.27707043290138245,-0.12944024801254272,-0.2118157148361206,-0.09953721612691879,-0.04904133453965187,0.16775181889533997,0.19065611064434052,-0.07297994941473007},{-0.3071958124637604,-0.03708888590335846,0.4208783805370331,0.27307915687561035,0.15588633716106415,-0.1217312440276146,-0.13063685595989227,-0.16245542466640472},{-0.26336869597435,0.0037893573753535748,0.4541328549385071,-0.1673354059457779,-0.14011168479919434,-0.4230358302593231,-0.11641769111156464,-0.11451873183250427},{-0.27185508608818054,-0.3605566918849945,0.5454499125480652,-0.05694492533802986,-0.18933731317520142,0.24319270253181458,0.1662004590034485,-0.24336713552474976},{-0.3941463828086853,0.29143935441970825,-0.1360020786523819,0.3740253746509552,0.13717956840991974,-0.291951060295105,0.0025983068626374006,0.12972666323184967},{-0.4376765489578247,-0.3184452950954437,-0.1300593763589859,-0.20647341012954712,-0.509391725063324,0.15030640363693237,-0.05101172998547554,0.17431554198265076},{0.04108019918203354,0.33257535099983215,0.22325648367404938,-0.021323956549167633,0.21330620348453522,0.166268989443779,-0.21858015656471252,0.23703591525554657},{0.0969417616724968,0.021532908082008362,0.2572978436946869,0.24901369214057922,-0.31230980157852173,0.3162200152873993,-0.014630192890763283,-0.21631136536598206},{0.031951166689395905,-0.3402121961116791,0.25477734208106995,-0.056995075196027756,-0.37056681513786316,-0.06983521580696106,-0.18478892743587494,-0.10815959423780441},{-0.269645631313324,-0.2661605775356293,0.31803959608078003,0.3408984839916229,-0.2542608380317688,-0.05579027533531189,-0.3062621057033539,0.23709145188331604},{0.0371866375207901,-0.1811269223690033,0.13115857541561127,-0.23269206285476685,-0.2778354585170746,-0.1117001473903656,0.23992367088794708,0.010998615995049477},{0.16517212986946106,-0.03888752683997154,0.026362445205450058,-0.23352764546871185,0.06391727924346924,0.07431139051914215,0.11783654987812042,0.37829479575157166},{-0.05181628093123436,-0.3114076554775238,-0.17210473120212555,0.1316671222448349,-0.21179428696632385,-0.1442786604166031,-0.12572674453258514,0.12825947999954224},{-0.2180468738079071,-0.3321762979030609,0.02373780868947506,0.05607588589191437,0.11739040166139603,-0.19221238791942596,0.32983675599098206,0.1835300624370575},{-0.0377674363553524,0.08094886690378189,-0.27105697989463806,0.13523927330970764,0.10841934382915497,0.19236087799072266,-0.2552015781402588,0.3790571093559265},{0.09783437103033066,-0.04094880074262619,-0.3754497766494751,0.11242299526929855,-0.06118455156683922,-0.030230648815631866,-0.3273036479949951,0.008855283260345459},{0.020567933097481728,-0.1370098888874054,0.06090850755572319,-0.0714072436094284,0.34026941657066345,0.049861446022987366,-0.02040890045464039,0.4084293842315674},{-0.028428586199879646,0.1098303347826004,-0.2671024799346924,0.3188842236995697,0.3741430640220642,0.3537141680717468,0.22227638959884644,-0.3221076726913452},{-0.49440255761146545,-0.14873450994491577,0.15261834859848022,-0.04109268635511398,0.2279275357723236,-0.2637961506843567,0.281992644071579,-0.28872936964035034},{-0.2758970558643341,0.005937004927545786,-0.0849931463599205,-0.3768239915370941,0.2354450672864914,0.014108376577496529,-0.27577221393585205,0.1653374284505844},{-0.33420509099960327,-0.19890116155147552,-0.015646476298570633,0.033090878278017044,-0.07804615795612335,0.16004152595996857,0.36594313383102417,-0.13667207956314087},{-0.3007518947124481,0.05318530648946762,-0.396600604057312,-0.3367229700088501,0.1748340129852295,0.04999305307865143,-0.032605405896902084,0.06059102714061737},{0.2580656409263611,0.38405853509902954,-0.3163028359413147,0.15299277007579803,0.22776688635349274,0.40668773651123047,-0.24119308590888977,-0.15292304754257202},{0.29347753524780273,0.2520257532596588,0.03363650664687157,0.04823773354291916,0.29926151037216187,0.2206578105688095,0.31417039036750793,0.36018601059913635},{-0.22213096916675568,0.3874307870864868,0.1422146111726761,-0.010535033419728279,0.23207202553749084,0.06369034945964813,-0.2795883119106293,-0.3152133524417877},{-0.31006741523742676,-0.20979365706443787,0.06686233729124069,-0.2725982069969177,-0.30371782183647156,-0.1613623946905136,0.3959754407405853,-0.09284991025924683},{0.2790205180644989,-0.23766295611858368,0.3354509770870209,-0.3347913324832916,0.018335051834583282,0.23089522123336792,0.28548306226730347,-0.294951856136322},{0.09041871130466461,0.3922635614871979,0.3919248878955841,-0.26629799604415894,-0.2862120568752289,0.04157897084951401,0.28711551427841187,0.02895318903028965}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.014138930477201939,0.47052493691444397,-0.1819695681333542,0.1980859935283661,-0.41356927156448364,0.31538063287734985,0.32175058126449585,0.09017623960971832},{-0.5091197490692139,-0.40816059708595276,-0.3679679334163666,-0.43728744983673096,-0.46541115641593933,0.4782545566558838,0.3466741144657135,-0.3828669488430023},{0.11587446182966232,-0.1812119334936142,0.1640375405550003,0.18308669328689575,-0.02812119759619236,0.4613124132156372,-0.296963632106781,-0.4961646497249603},{0.4724019765853882,-0.07187243551015854,0.19537000358104706,0.03280695527791977,0.513496458530426,0.4147365689277649,0.5522454977035522,0.36045190691947937},{0.0978909507393837,0.20693007111549377,-0.17867784202098846,-0.28856411576271057,0.08266431093215942,-0.47407785058021545,-0.5266982913017273,0.6148366332054138},{0.44020572304725647,0.09587743878364563,0.0037192220333963633,-0.3625633716583252,-0.4827961027622223,-0.4965800344944,-0.14785778522491455,0.42715635895729065},{-0.46981528401374817,-0.3397237956523895,-0.10700198262929916,-0.2484029233455658,-0.022196056321263313,0.5259103178977966,-0.537791907787323,0.5239951014518738},{0.22752660512924194,0.05220668762922287,-0.018551113083958626,0.07399935275316238,0.4130801856517792,-0.5447494387626648,0.4029723107814789,-0.36955252289772034}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.08554507046937943,0.01719917543232441,0.03888735920190811,-0.01594734378159046,-0.04489659518003464,0.02550816908478737,0.008751635439693928,-0.003486036555841565};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.02085137367248535,-0.013964289799332619,-0.03444182127714157,0.04408276453614235,-0.015878776088356972,-0.004135847091674805,0.031095663085579872,-0.0687963142991066};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

