#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.34226110577583313,-0.21988172829151154,0.34217438101768494,0.15730953216552734,-0.3959779143333435,0.11659155786037445,0.004930749535560608,-0.2070758044719696,0.0726972371339798,0.47960761189460754,0.10922728478908539,0.013249085284769535,0.15091092884540558,-0.1462506651878357,0.3601127862930298,-0.12990802526474},{-0.35499143600463867,-0.2450934797525406,0.28461381793022156,0.14791005849838257,-0.23387813568115234,-0.02781439572572708,-0.36468154191970825,0.06669985502958298,-0.21557168662548065,-0.10780726373195648,0.1471318155527115,-0.15152211487293243,0.20374645292758942,-0.36963629722595215,-0.23426860570907593,0.07496891915798187},{0.1497543752193451,-0.24777592718601227,-0.2536320686340332,0.04894869029521942,0.10963749140501022,0.15511034429073334,-0.08117447048425674,0.004216598812490702,-0.09672985225915909,-0.18385028839111328,-0.19932280480861664,0.41189631819725037,-0.014921044930815697,-0.15785087645053864,-0.3835330605506897,0.21667034924030304},{0.16086295247077942,0.18213693797588348,0.3271616995334625,-0.09114359319210052,-0.33662891387939453,-0.010061490349471569,0.14303705096244812,0.11994335800409317,0.4770886301994324,-0.3748122751712799,0.009656104259192944,0.13527953624725342,-0.29129186272621155,-0.05683398246765137,0.3245021402835846,-0.3944084346294403},{-0.04871675372123718,0.1104704737663269,0.23118089139461517,-0.10680200159549713,0.22743594646453857,0.26119938492774963,0.2306191772222519,-0.06255059689283371,-0.03605469688773155,0.21837934851646423,0.30583953857421875,-0.1433793008327484,-0.1302151381969452,-0.35674017667770386,0.3725188672542572,0.12562517821788788},{-0.03917979449033737,-0.18718673288822174,-0.1362554132938385,-0.25364798307418823,0.1066034734249115,0.05801999941468239,-0.03903508186340332,-0.1583578735589981,0.19547611474990845,-0.21976236999034882,-0.3129519522190094,0.17988437414169312,0.3899892568588257,-0.025753775611519814,-0.0607772096991539,0.16301044821739197},{-0.07960063964128494,0.02441193349659443,0.07653719931840897,-0.2568288743495941,0.18557672202587128,0.021587973460555077,0.06873318552970886,0.3775412142276764,0.27492427825927734,0.010211676359176636,-0.3354581892490387,0.2519604563713074,-0.07272463291883469,0.20874199271202087,-0.1811341792345047,-0.16371305286884308},{-0.005369109567254782,-0.018245967105031013,0.2533249258995056,0.20989353954792023,-0.3879774212837219,0.009043167345225811,0.3043263554573059,0.3227923810482025,-0.05550912395119667,0.1968889683485031,-0.49283745884895325,-0.3207843601703644,0.23818598687648773,0.25965631008148193,0.2243421971797943,0.16583795845508575},{0.3345779478549957,-0.2517765760421753,0.3435920774936676,-0.01030051801353693,0.13064877688884735,0.10948055982589722,-0.17296887934207916,-0.22907577455043793,0.15885846316814423,-0.2982403337955475,0.024538526311516762,-0.2966623306274414,-0.19633717834949493,0.30558669567108154,0.1458905041217804,-0.0975399911403656},{0.06780818849802017,-0.24911165237426758,-0.4508167803287506,-0.05895490571856499,-0.32201656699180603,0.22829416394233704,0.39435288310050964,0.135759636759758,0.4753980338573456,0.37378403544425964,0.009367314167320728,-0.27989357709884644,0.10075969249010086,0.3245120644569397,-0.1403064876794815,-0.38428613543510437},{0.026392538100481033,0.24824942648410797,0.38002243638038635,-0.2871928811073303,-0.3125302791595459,0.24313271045684814,0.1730901002883911,0.3560117483139038,-0.286094605922699,-0.04091563820838928,-0.026220541447401047,0.151824489235878,-0.27287757396698,-0.20224381983280182,0.3288370370864868,-0.3543738126754761},{0.07430504262447357,-0.12398845702409744,-0.006854999344795942,0.1710360199213028,0.3406592011451721,0.30645012855529785,0.4548560678958893,-0.007404328789561987,0.011627531610429287,-0.029609503224492073,0.2726030647754669,-0.1546798050403595,-0.02596740610897541,-0.2564490735530853,0.27680227160453796,0.27834150195121765},{-0.11429926753044128,0.2861936390399933,0.13177397847175598,-0.30486178398132324,0.09371867030858994,0.11124445497989655,0.34066858887672424,-0.050742167979478836,0.10831976681947708,-0.001513838884420693,-0.10803200304508209,0.12786485254764557,0.16755768656730652,0.2835381031036377,0.1281384527683258,-0.2924705147743225},{-0.2483024299144745,-0.2906422019004822,-0.22134125232696533,-0.00845979806035757,-0.17085623741149902,0.08001972734928131,-0.3359074592590332,0.07933317869901657,-0.036305490881204605,-0.06436535716056824,-0.26283180713653564,-0.061252862215042114,-0.35254281759262085,0.08887308835983276,0.2556915283203125,0.12110259383916855},{-0.207789346575737,-0.3621051013469696,-0.24536602199077606,0.3532893657684326,0.08733630925416946,-0.33680737018585205,0.2956923842430115,-0.10203228890895844,0.03388524055480957,0.28805574774742126,0.10355280339717865,0.17410479485988617,0.1883910596370697,-0.01655367575585842,-0.1972363442182541,0.21454109251499176},{0.46546661853790283,-0.08489315956830978,-0.23684580624103546,-0.4097359776496887,-0.5761739015579224,0.27812454104423523,0.45427462458610535,-0.27457141876220703,0.14388008415699005,0.07155591994524002,-0.2705620527267456,0.07321377098560333,-0.5397570729255676,0.5294867157936096,-0.2756807506084442,-0.03326559066772461},{-0.4056347608566284,-0.35095104575157166,0.426831990480423,0.3427700996398926,-0.2905189096927643,0.30825865268707275,-0.08247097581624985,-0.3015056848526001,0.2755092978477478,-0.44811493158340454,-0.2994108200073242,-0.6742423176765442,-0.25749677419662476,-0.4179600477218628,0.033269792795181274,-0.17448225617408752},{-0.3999907970428467,0.2636210322380066,-0.5599901676177979,-0.0241651963442564,0.0005958760157227516,0.388539582490921,-0.36077627539634705,-0.40032485127449036,0.23552273213863373,0.2370259165763855,0.40836387872695923,-0.04016659036278725,-0.21854138374328613,0.2688182592391968,0.14532798528671265,-0.5073354840278625}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.10410833358764648,-0.09973248094320297,-0.17817804217338562,-0.3994070887565613,0.37497180700302124,0.26242491602897644,0.07261616736650467,0.08877070248126984,-0.24291302263736725,-0.1045183464884758,-0.08079146593809128,0.021443504840135574,0.23969241976737976,0.4743713140487671,0.12169764190912247,0.10157979279756546},{-0.18181760609149933,-0.24600908160209656,-0.027949199080467224,0.13884098827838898,0.3097364604473114,-0.23292741179466248,0.15571334958076477,0.04718630388379097,-0.0662878081202507,0.2598695456981659,-0.1348421424627304,0.3454231917858124,-0.3504405617713928,0.2048616111278534,-0.3467985987663269,-0.2583653926849365},{0.16613754630088806,0.21836018562316895,-0.36984992027282715,-0.6097606420516968,0.17620638012886047,0.45353931188583374,-0.09890001267194748,0.1055605560541153,-0.27195510268211365,-0.2380642294883728,-0.028316449373960495,0.2802925705909729,-0.2970644533634186,-0.243336021900177,0.14944025874137878,-0.03635584935545921},{0.22082290053367615,-0.04236692190170288,0.06737393885850906,0.14918595552444458,-0.5094566345214844,0.015043474733829498,0.04160385578870773,-0.2674276828765869,0.32577183842658997,0.354628324508667,-0.1439274400472641,-0.1950056552886963,-0.41735416650772095,-0.3425038754940033,0.21280790865421295,0.23014196753501892},{-0.17230035364627838,0.06679142266511917,0.054345134645700455,0.31158187985420227,-0.25672876834869385,0.0029083897825330496,-0.02385159395635128,0.21088631451129913,0.2317572385072708,-0.26936882734298706,0.03818307816982269,0.38687124848365784,0.12692411243915558,-0.4234983026981354,-0.08256193995475769,-0.13435202836990356},{0.22654534876346588,0.19014577567577362,-0.017059242352843285,0.15989021956920624,-0.3503127694129944,-0.4033462107181549,0.2144271731376648,0.2672044634819031,0.12072037905454636,0.4550137221813202,0.2562061846256256,-0.2519194483757019,0.015395424328744411,-0.14319121837615967,-0.04626850783824921,0.3248787820339203},{-0.05236633121967316,0.15220163762569427,0.37609392404556274,-0.34821948409080505,-0.14873246848583221,0.060824453830718994,-0.2921735644340515,-0.05658514052629471,0.1129990965127945,0.10192815959453583,-0.11484285444021225,-0.29338693618774414,-0.24362078309059143,0.049306903034448624,0.17009861767292023,0.07774459570646286},{-0.15931658446788788,-0.15014486014842987,-0.3883214592933655,0.27563512325286865,-0.24914535880088806,-0.3073238134384155,-0.18112631142139435,-0.33215847611427307,0.022434186190366745,-0.16763590276241302,-0.11745595186948776,0.16814793646335602,-0.217254638671875,0.41903015971183777,-0.09836515039205551,-0.3856548070907593},{-0.22500436007976532,0.2904159128665924,0.0012375573860481381,-0.02866174466907978,0.32405710220336914,-0.23071587085723877,0.39218267798423767,0.13186754286289215,0.2381870001554489,0.3824491798877716,0.2568344175815582,0.2893998324871063,0.25557148456573486,-0.03148286044597626,0.2794947624206543,0.1320606917142868},{0.12504391372203827,-0.2857242822647095,-0.02755424939095974,-0.1276286244392395,0.3201543688774109,-0.050137463957071304,-0.30714842677116394,-0.241075336933136,0.061799194663763046,-0.4677318334579468,-0.16884012520313263,0.21077893674373627,0.1347070038318634,0.16519050300121307,-0.3099612593650818,0.2836249768733978},{-0.1302240937948227,-0.35362082719802856,0.46412330865859985,0.2353857010602951,0.21837493777275085,0.15505462884902954,0.095763199031353,-0.15413951873779297,0.14018212258815765,-0.2043333202600479,0.013629317283630371,0.4171616733074188,0.31628578901290894,0.13277782499790192,-0.20864243805408478,0.0032302895560860634},{0.01613542251288891,-0.1408139318227768,0.27366408705711365,0.015069705434143543,-0.13826267421245575,-0.22769597172737122,0.46834465861320496,0.3021429181098938,-0.28039735555648804,-0.3831966519355774,-0.11162026971578598,-0.32731905579566956,0.016746003180742264,-0.3354058563709259,-0.35553014278411865,-0.005865051876753569},{-0.03184578940272331,-0.32440775632858276,0.31264930963516235,-0.22124555706977844,0.30899468064308167,-0.314767062664032,-0.36589616537094116,0.17279814183712006,0.08143363893032074,-0.026279093697667122,-0.3006387948989868,0.07371587306261063,0.06784600764513016,-0.26752689480781555,-0.3742603659629822,-0.0014790690038353205},{0.3102051019668579,-0.28929904103279114,0.45367735624313354,0.15937715768814087,0.03616872802376747,0.2950831651687622,-0.06059776619076729,-0.20966419577598572,-0.5208911895751953,0.12049558758735657,0.010369508527219296,-0.3838914632797241,-0.002821410307660699,0.21218816936016083,0.337248295545578,0.04326774924993515},{-0.2422260344028473,0.16252247989177704,0.12529532611370087,-0.31417912244796753,-0.2156965434551239,0.03702252730727196,0.23241673409938812,-0.12891167402267456,0.16567707061767578,-0.3632441759109497,-0.006863413844257593,0.05887799710035324,-0.018696004524827003,0.05715537071228027,-0.10905412584543228,0.011969557963311672},{-0.2092919498682022,0.30806058645248413,-0.31689417362213135,0.34553685784339905,0.13949598371982574,-0.3675627112388611,-0.12257784605026245,-0.09915301203727722,-0.37795013189315796,0.2793595790863037,-0.35528913140296936,0.31099584698677063,-0.07781242579221725,-0.16908729076385498,-0.27950868010520935,-0.5292882323265076}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.15860781073570251,0.016387825831770897,-0.05701301246881485,-0.03162970766425133,-0.11267252266407013,0.031030520796775818,0.2894887328147888,0.046196348965168,-0.13002824783325195,-0.20021621882915497,0.1153818666934967,-0.29840710759162903,-0.2034335881471634,0.23345594108104706,0.2124716192483902,0.29337963461875916,-0.24402615427970886,-0.30738088488578796,-0.20022815465927124,0.0401441715657711,-0.04105231538414955,-0.34562480449676514,-0.24083366990089417,-0.27584877610206604,-0.31144383549690247,0.22872646152973175,-0.23322844505310059,-0.029473917558789253,-0.012608602643013,0.0039189523085951805,0.2232634723186493,-0.16890139877796173},{0.2684658467769623,0.22980493307113647,0.13962838053703308,-0.07219786942005157,0.09672288596630096,-0.08947800099849701,0.27908840775489807,0.13311702013015747,-0.19648504257202148,-0.15761199593544006,-0.04697145149111748,-0.2551797926425934,-0.16321061551570892,0.1882089376449585,-0.20914191007614136,-0.316978394985199,-0.0485367514193058,0.14615297317504883,-0.3083607852458954,-0.2825501561164856,0.010955484583973885,0.24841952323913574,0.11782166361808777,-0.11123158782720566,0.15654073655605316,-0.28471341729164124,0.03658559173345566,0.09274214506149292,0.21895892918109894,-0.12035670876502991,-0.024121474474668503,0.25674915313720703},{0.2426300346851349,0.0736379623413086,-0.04614144563674927,0.11791074275970459,-0.1699422150850296,-0.17528395354747772,-0.2421397715806961,0.1415921300649643,-0.11374834924936295,0.36833855509757996,-0.3001323342323303,-0.19678284227848053,0.15453201532363892,-0.37321025133132935,-0.15572339296340942,0.12770548462867737,-0.1232612207531929,-0.12483473122119904,0.24782226979732513,-0.027990594506263733,0.21363042294979095,0.25545981526374817,-0.25807681679725647,0.04160436615347862,-0.17843545973300934,-0.10308412462472916,0.1309865117073059,-0.07708922773599625,-0.08359676599502563,-0.16631126403808594,-0.06738190352916718,-0.12993761897087097},{0.32329896092414856,0.0755765289068222,0.08730832487344742,-0.13837511837482452,-0.2630149722099304,-0.07920440286397934,-0.14164836704730988,0.23333361744880676,0.24100981652736664,-0.2083524912595749,-0.10205835849046707,0.27748656272888184,0.11451687663793564,-0.11887691915035248,-0.2319100797176361,0.3115823566913605,-0.3134467899799347,0.2451884001493454,-0.01661529578268528,0.04446853697299957,-0.05960331857204437,-0.10019570589065552,0.28332337737083435,0.16326314210891724,0.16071723401546478,-0.30674564838409424,0.3183209002017975,-0.2057523876428604,-0.0187760591506958,0.022193018347024918,-0.3049086928367615,0.15929025411605835},{-0.020513026043772697,-0.04786453768610954,-0.07652836292982101,0.04955637454986572,0.19543154537677765,-0.1775822937488556,-0.37682607769966125,-0.0025984023232012987,-0.12944594025611877,-0.191865012049675,0.14761070907115936,0.23120862245559692,-0.08144902437925339,-0.08412507176399231,-0.07214047759771347,0.21388165652751923,-0.051626238971948624,-0.005472536198794842,-0.33421024680137634,-0.044131357222795486,-0.17662101984024048,-0.3568422496318817,0.16166143119335175,0.23417094349861145,-0.06135251373052597,0.26983004808425903,-0.17338502407073975,0.22984673082828522,0.2815290689468384,0.3602749705314636,-0.00853568036109209,0.2966817617416382},{-0.2236400991678238,-0.12082662433385849,-0.13930051028728485,-0.057113733142614365,-0.12595400214195251,0.21229669451713562,0.22483380138874054,0.032021984457969666,0.3297983705997467,0.1430404782295227,0.26938381791114807,-0.22040441632270813,-0.15889887511730194,0.2433636486530304,0.25394049286842346,-0.3510821759700775,-0.11113393306732178,-0.24659988284111023,0.22070924937725067,0.14055584371089935,0.09242044389247894,0.11498004198074341,-0.008519909344613552,-0.017499862238764763,-0.3574735224246979,0.31125885248184204,-0.2098771333694458,0.13996413350105286,0.33212634921073914,0.2271086573600769,0.07119802385568619,0.057175859808921814},{0.17670264840126038,-0.14569295942783356,-0.13006818294525146,-0.338619589805603,0.015106622129678726,0.22093036770820618,0.28250399231910706,0.12266556918621063,0.11408355087041855,0.3047807216644287,-0.00818158034235239,-0.0037269319873303175,-0.41179877519607544,-0.11986111849546432,-0.15194949507713318,0.042863842099905014,-0.2793165147304535,-0.21167702972888947,0.16189001500606537,-0.08691121637821198,-0.12180378288030624,-0.14974604547023773,-0.2360122799873352,-0.2477017045021057,0.19618894159793854,-0.2784188687801361,-0.13401378691196442,-0.21672731637954712,0.3261421322822571,0.1181667149066925,-0.17925743758678436,-0.2870662808418274},{0.07282762974500656,0.17798301577568054,0.05553794279694557,-0.13182400166988373,0.15340469777584076,-0.2944307327270508,-0.05487145110964775,-0.15997876226902008,0.010979964397847652,-0.2839544713497162,-0.30677974224090576,-0.09896482527256012,-0.11698342859745026,0.06575804948806763,-0.12513038516044617,0.4010729491710663,0.01043735258281231,-0.1395850032567978,0.1187964677810669,0.331896036863327,-0.19422784447669983,-0.19146645069122314,0.27727964520454407,0.08212079852819443,0.008228684775531292,-0.3424673080444336,-0.33293798565864563,-0.22010231018066406,-0.3792141377925873,-0.2704167366027832,0.10692384839057922,-0.3829713761806488},{0.04333023726940155,0.4185768961906433,-0.3814927041530609,-0.3610531687736511,-0.29262202978134155,0.11144893616437912,0.06701137125492096,0.12881802022457123,0.07872220128774643,-0.23991136252880096,-0.17762896418571472,0.2938671410083771,-0.36272937059402466,-0.20539826154708862,0.20188240706920624,-0.22416847944259644,0.23252815008163452,0.1226268783211708,0.32207146286964417,0.07065184414386749,0.2031461000442505,0.1486055999994278,0.3428054451942444,-0.1408866047859192,0.46272897720336914,-0.20214597880840302,0.21571648120880127,0.3600634038448334,-0.18634766340255737,0.1171562671661377,0.033082734793424606,0.09835328906774521},{-0.22383153438568115,0.1064661294221878,-0.35997509956359863,-0.17507317662239075,0.10816437005996704,-0.2188393771648407,0.11319635063409805,-0.009537571109831333,0.18155527114868164,0.06223431974649429,-0.259650856256485,-0.34647735953330994,-0.42202937602996826,-0.11062807589769363,-0.2483595311641693,0.10039794445037842,-0.029398472979664803,-0.26185616850852966,0.203933984041214,0.06652676314115524,0.0818408951163292,-0.017641671001911163,0.3833796977996826,-0.21024253964424133,0.3225875496864319,0.1718299835920334,-0.22383853793144226,0.05407832935452461,0.02028391696512699,0.04251427203416824,-0.19544486701488495,0.13779498636722565},{0.08694501221179962,-0.017462652176618576,0.16833575069904327,-0.27596795558929443,-0.24566690623760223,-0.2228035181760788,-0.25427547097206116,-0.06906378269195557,-0.17382653057575226,0.3250645101070404,0.13158324360847473,-0.2773337662220001,-0.34983471035957336,-0.024115074425935745,-0.2198592871427536,-0.17531023919582367,0.24195189774036407,-0.15164054930210114,0.26887574791908264,-0.2099686563014984,-0.19192153215408325,0.02368261106312275,0.17977264523506165,0.17309482395648956,0.18542355298995972,-0.15345872938632965,-0.05426081269979477,-0.06197402626276016,-0.051271483302116394,0.017484357580542564,-0.06328637897968292,0.1661391705274582},{-0.21910305321216583,-0.04027553275227547,0.22707130014896393,0.32401198148727417,0.2560586631298065,-0.007384037598967552,0.0580674484372139,-0.21902546286582947,-0.09634926915168762,-0.19216345250606537,0.2897852659225464,-0.23881547152996063,-0.21213674545288086,-0.20102235674858093,0.2909449338912964,-0.005512660369277,-0.01332561019808054,0.018184777349233627,0.33392176032066345,0.07942410558462143,-0.18040500581264496,0.23272141814231873,0.11186157912015915,-0.10080846399068832,0.20252063870429993,-0.10814380645751953,-0.13565599918365479,0.2269219309091568,0.20558606088161469,-0.015052574686706066,-0.27381718158721924,-0.2500293254852295},{0.23334042727947235,-0.2363625019788742,-0.00648130290210247,-0.35190242528915405,0.12935079634189606,-0.0761299654841423,0.1579669862985611,0.07823886722326279,0.2538768947124481,0.07997609674930573,0.1342315375804901,0.19641147553920746,-0.3625037670135498,-0.23951584100723267,-0.07167171686887741,-0.20989353954792023,-0.13719701766967773,-0.21027535200119019,0.2545957565307617,-0.23366603255271912,0.266918420791626,0.004131336696445942,-0.017478467896580696,0.18150494992733002,0.14151456952095032,-0.08334726095199585,0.1251021772623062,0.15156733989715576,0.13162319362163544,-0.0803106352686882,-0.21080628037452698,-0.09499921649694443},{0.23843905329704285,-0.05931182578206062,-0.047002192586660385,0.42179781198501587,-0.09848277270793915,-0.20475777983665466,-0.06821325421333313,0.10594266653060913,0.17774248123168945,0.29769980907440186,0.12318769097328186,-0.1464380919933319,0.034798648208379745,0.19749005138874054,-0.09821049124002457,0.0619019977748394,0.19558978080749512,-0.23584482073783875,0.0565815269947052,-0.33289051055908203,0.33156880736351013,0.1405855119228363,-0.06834626942873001,0.188310444355011,0.18555089831352234,0.08186714351177216,0.09381057322025299,0.0558759942650795,0.07378323376178741,-0.1427249014377594,-0.04478944092988968,0.41200369596481323},{0.02969514951109886,-0.2750838100910187,-0.07646923512220383,0.12107235938310623,-0.24058444797992706,-0.01102751586586237,0.0609666109085083,-0.26978516578674316,-0.1457396298646927,-0.058220624923706055,0.17480410635471344,0.14233550429344177,0.09648837894201279,0.2624466121196747,-0.07002104073762894,-0.10025203973054886,-0.22894331812858582,0.26514923572540283,-0.09986686706542969,-0.27648261189460754,-0.1793520748615265,-0.08508233726024628,0.17536234855651855,-0.006422297563403845,-0.04575623199343681,-0.07500623166561127,-0.2128603756427765,0.2191930115222931,0.06766163557767868,-0.17223121225833893,0.22737106680870056,0.1978941112756729},{0.1321893334388733,-0.2224070429801941,-0.0931738093495369,-0.17730829119682312,-0.10021975636482239,0.15618743002414703,0.03216848149895668,0.23588594794273376,-0.09440608322620392,0.01995699852705002,0.2560059726238251,0.10913834720849991,-0.05663418397307396,-0.12920978665351868,0.04315595701336861,0.1566684991121292,-0.41421154141426086,-0.27610617876052856,-0.06343571096658707,0.045756224542856216,0.1183837428689003,0.23812240362167358,0.27796778082847595,0.13991938531398773,0.05203782767057419,0.2289387732744217,0.012490347027778625,-0.06848939508199692,0.19267483055591583,-0.12896020710468292,-0.25615349411964417,0.3717575669288635},{0.1923317313194275,-0.02222117967903614,-0.2463691234588623,0.15365073084831238,0.09009090065956116,-0.04103947803378105,0.2743326425552368,0.11631860584020615,0.11062052845954895,-0.22067725658416748,0.20922699570655823,-0.18182532489299774,-0.3569832742214203,0.25034788250923157,0.06306228041648865,0.07064426690340042,0.06787324696779251,-0.038282863795757294,-0.13098396360874176,0.06196540966629982,-0.07859399169683456,0.21033771336078644,0.053237590938806534,-0.13853001594543457,0.04557349905371666,-0.2871648669242859,0.03089485689997673,0.41962817311286926,0.22144314646720886,-0.14198412001132965,0.2172764092683792,0.18278641998767853},{-0.06400677561759949,-0.034532032907009125,-0.0961494892835617,-0.02440210059285164,-0.2587691843509674,-0.030298708006739616,0.18146513402462006,0.17834776639938354,0.13198493421077728,-0.008445248939096928,0.2452559918165207,0.016609814018011093,0.20740550756454468,0.16644838452339172,0.18309596180915833,-0.09767597913742065,0.12226124107837677,0.1608847677707672,0.25415781140327454,0.06323064118623734,0.19297295808792114,0.24023175239562988,0.06514031440019608,0.12097436189651489,-0.02219189889729023,-0.08478928357362747,-0.0865752175450325,-0.24685682356357574,0.18309195339679718,-0.2274187058210373,0.021064169704914093,-0.011218422092497349},{-0.3220110535621643,0.0980198010802269,-0.2980135679244995,-0.35988980531692505,-0.011178869754076004,0.05624792352318764,0.13063044846057892,-0.11757021397352219,0.0034791415091603994,0.3128162920475006,0.054018307477235794,-0.2198701798915863,0.05588819086551666,-0.183696448802948,-0.31560152769088745,-0.015593891963362694,-0.1850363165140152,0.1557447463274002,-0.032361190766096115,-0.060204945504665375,-0.32213467359542847,0.1880681961774826,0.13676947355270386,0.03181866556406021,-0.008021806366741657,0.2855653166770935,0.017274653539061546,-0.13667884469032288,-0.1874583214521408,0.004005803260952234,-0.1535167694091797,-0.2590882182121277},{-0.0017470708116889,-0.21439595520496368,-0.22589287161827087,-0.027709471061825752,-0.3640425205230713,-0.15820233523845673,0.16152483224868774,-0.2938153147697449,-0.2052932232618332,0.19367770850658417,0.147837832570076,0.12279471009969711,0.13288049399852753,-0.11451485753059387,0.3130779564380646,-0.3138924539089203,0.06439407914876938,0.22347930073738098,0.059073224663734436,0.24785341322422028,0.05127844586968422,-0.11422691494226456,-0.27899301052093506,0.1991332322359085,-0.17476706206798553,-0.16284982860088348,0.10261829197406769,0.037525344640016556,-0.11870211362838745,-0.29889291524887085,-0.037738505750894547,-0.1365205943584442},{0.22654525935649872,0.1829400658607483,-0.07980025559663773,0.16356222331523895,-0.2799006700515747,0.1750219315290451,-0.06451322138309479,-0.1385164111852646,-0.18136946856975555,0.19920876622200012,-0.26131176948547363,-0.16804558038711548,-0.043097950518131256,-0.1866564303636551,-0.3747490644454956,-0.1316259801387787,-0.07873227447271347,-0.2667689025402069,-0.2389966994524002,0.28609129786491394,0.09220238029956818,0.1275886595249176,-0.3424997627735138,0.33739808201789856,0.19668343663215637,0.26154860854148865,-0.2892766296863556,-0.028969131410121918,0.06444980204105377,-0.2655262351036072,0.12985895574092865,0.09251432120800018},{0.009307214990258217,-0.3334396481513977,0.029320698231458664,-0.2763924300670624,-0.07357845455408096,0.2621348202228546,0.16565895080566406,0.021061228588223457,-0.036377113312482834,-0.008401690050959587,-0.21665039658546448,0.17307886481285095,0.17156878113746643,0.11547017842531204,0.15636979043483734,0.0035989198368042707,-0.07405590265989304,0.11430645734071732,-0.08750627189874649,0.17248792946338654,0.2271600216627121,0.2283925861120224,-0.08857201784849167,-0.24687319993972778,0.09728281944990158,0.09660221636295319,0.26316308975219727,0.13491836190223694,-0.032861098647117615,0.20803198218345642,0.04091409593820572,-0.10719496011734009},{0.03841882944107056,-0.1797102987766266,0.24896475672721863,-0.0014812200097367167,0.3114113211631775,-0.031009970232844353,-0.10524313896894455,-0.15243923664093018,0.14612577855587006,-0.07575206458568573,0.07040394842624664,0.0014704499626532197,-0.27244511246681213,0.02251557633280754,-0.1123475655913353,-0.2411317229270935,-0.035928212106227875,-0.03993483632802963,0.21121934056282043,0.26075220108032227,0.022211214527487755,0.037761759012937546,0.16550880670547485,0.3554612696170807,-0.15194526314735413,-0.08826524764299393,0.19717524945735931,-0.1167784333229065,-0.21241793036460876,-0.2394896298646927,0.3133317828178406,-0.01453432533890009},{0.20129935443401337,-0.07061418145895004,0.034979671239852905,0.13832084834575653,-0.04046669602394104,0.044242870062589645,-0.2759760320186615,0.27391716837882996,-0.07607972621917725,-0.030803026631474495,0.1040213331580162,-0.26630792021751404,-0.009487316012382507,-0.024227211251854897,-0.09249673783779144,0.2737269997596741,-0.0994202122092247,-0.205747589468956,0.043235279619693756,-0.010693075135350227,-0.15589836239814758,0.1958809792995453,0.2401493638753891,0.21012552082538605,-0.28555527329444885,0.11838535964488983,-0.05953199043869972,0.08114070445299149,-0.27885696291923523,0.28459104895591736,-0.03580629453063011,0.05718949809670448}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.21626383066177368,-0.10071718692779541,0.10073117911815643,-0.15024873614311218},{0.19901281595230103,-0.3178301155567169,0.2655148506164551,0.24266982078552246},{-0.25743821263313293,0.10954234004020691,0.05686011537909508,-0.011838378384709358},{0.280247300863266,0.4799362123012543,0.3590952455997467,0.03554954379796982},{-0.2629198133945465,0.12950412929058075,-0.30134665966033936,0.08433793485164642},{-0.05498109012842178,-0.0417301282286644,0.058376215398311615,0.37877291440963745},{-0.10959669202566147,-0.09687858819961548,-0.34528103470802307,0.01359864603728056},{-0.15261217951774597,-0.25182288885116577,0.17753101885318756,-0.06566645950078964},{-0.05946154519915581,0.09156014770269394,-0.08578101545572281,-0.1007051169872284},{0.22694183886051178,0.021167179569602013,-0.10294307768344879,-0.18569950759410858},{0.15986692905426025,-0.11075213551521301,0.2992457151412964,0.25164127349853516},{-0.033723387867212296,0.00971088744699955,0.3610290586948395,-0.07881155610084534},{-0.3369467556476593,0.21504490077495575,-0.01217256486415863,-0.13456405699253082},{-0.17347829043865204,0.0994107723236084,-0.2166999876499176,0.10009396076202393},{0.17061322927474976,0.037138719111680984,0.2735587954521179,0.10918662697076797},{-0.14420783519744873,-0.34631696343421936,-0.13505500555038452,-0.10223660618066788},{-0.2862001359462738,0.03678785264492035,-0.07919081300497055,0.2988484501838684},{-0.25140371918678284,-0.1287611871957779,-0.20189295709133148,0.19767773151397705},{-0.06723427027463913,-0.0940404161810875,0.35496553778648376,0.06934022158384323},{-0.1956092119216919,-0.143934428691864,0.014676772989332676,-0.18337590992450714},{0.15091246366500854,0.11464438587427139,0.15826940536499023,-0.15791799128055573},{-0.046570807695388794,-0.2766372263431549,-0.10324922949075699,0.2753109633922577},{0.3985859751701355,-0.21687202155590057,0.14589521288871765,0.05195971578359604},{-0.3288920223712921,-0.10992438346147537,-0.31091442704200745,-0.34063881635665894},{-0.15410742163658142,-0.19767241179943085,-0.08479224145412445,-0.0816083699464798},{0.14988385140895844,0.12965475022792816,-0.04960703104734421,0.08775307238101959},{0.1336996704339981,-0.20267361402511597,0.2735268473625183,0.07659599930047989},{-0.08606046438217163,-0.15524247288703918,-0.018046140670776367,0.28133827447891235},{0.10530859977006912,0.04688735678792,0.0681561678647995,0.050508562475442886},{-0.1478184461593628,0.11711592972278595,0.24514825642108917,-0.0031978043261915445},{-0.24864520132541656,-0.10183114558458328,0.07964533567428589,0.21764351427555084},{0.2553407549858093,0.2047458291053772,0.28128838539123535,-0.026485435664653778}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11401009559631348,-0.09922201186418533,0.047267697751522064,0.08183559030294418,0.11237268894910812,-0.11686483770608902,0.08855725824832916,0.0032696581911295652,-0.05887753143906593,-0.10435651987791061,-0.0033516164403408766,0.06607964634895325,-0.013883371837437153,0.0630510076880455,0.0946233943104744,-0.026651056483387947};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.01657111756503582,0.05862884968519211,0.05629891902208328,-0.020128635689616203,-0.04169851914048195,0.05400558188557625,-0.046082258224487305,-0.07219710946083069,0.050313904881477356,-0.004913070239126682,-0.028430892154574394,-0.03316982835531235,-0.004856124985963106,-0.07654441148042679,0.03072509914636612,-0.08020976930856705};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.048617035150527954,-0.0013413392007350922,-0.062326930463314056,0.04068024083971977,-1.043358315655496e-05,0.01467802282422781,-0.05350719392299652,-0.04569026455283165,-0.019571227952837944,-0.01181967556476593,0.009302948601543903,0.03944951668381691,0.03155338019132614,-0.04641998931765556,0.03319975361227989,-0.0803363025188446,-0.01112145371735096,-0.03924025595188141,0.021927321329712868,-0.06275845319032669,0.026963666081428528,-0.014922545291483402,0.03299124166369438,-0.07046249508857727,-0.06336157023906708,0.05878278240561485,0.044658541679382324,-0.032547373324632645,0.07029865682125092,0.022051209583878517,-0.013626002706587315,0.05783899128437042};
static const float action_parameterization_distribution_linear_bias[4] = {0.03856714442372322,0.05975547432899475,0.009541790001094341,0.03312091901898384};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3272286653518677,-0.2064083069562912,-0.018519563600420952,0.16859479248523712,-0.011396827176213264,0.024005627259612083,-0.18826569616794586,0.015663662925362587},{0.04105865955352783,0.09511813521385193,0.3402414321899414,0.3303024172782898,-0.08006561547517776,-0.2548663318157196,0.3441772758960724,0.12502801418304443},{0.00881468877196312,0.21804288029670715,0.030594199895858765,-0.07269512116909027,0.32153940200805664,0.23095697164535522,-0.050799742341041565,0.08107021450996399},{0.08409910649061203,-0.2345656156539917,0.26216262578964233,-0.2571890652179718,-0.2960796058177948,0.03402150794863701,0.21548549830913544,0.14954937994480133},{-0.23210425674915314,-0.008670506067574024,-0.03296779468655586,-0.3067878186702728,0.04737556725740433,0.04202818125486374,0.26171940565109253,0.2294212430715561},{-0.07517646253108978,0.2991001605987549,-0.0774654746055603,-0.25551310181617737,0.1319241225719452,0.020920943468809128,0.04188905283808708,-0.21606409549713135},{-0.012710453942418098,0.3245215117931366,0.14054013788700104,-0.14658847451210022,0.2126961648464203,-0.25141194462776184,0.2548915147781372,0.0730767548084259},{0.01121878158301115,-0.18282079696655273,0.056951697915792465,-0.08890032023191452,0.30730074644088745,-0.12767410278320312,0.0235078614205122,-0.27291396260261536},{-0.15667253732681274,0.30704498291015625,0.1488024741411209,-0.014897577464580536,0.033821094781160355,0.19853481650352478,0.47478729486465454,0.39302125573158264},{0.05222373083233833,-0.06197935715317726,-0.2756844460964203,0.3657188415527344,0.2514982223510742,0.1549600064754486,0.22003859281539917,-0.2659700810909271},{-0.12712326645851135,-0.3258005678653717,0.3529781699180603,0.22433878481388092,-0.03264414891600609,-0.37767377495765686,-0.11553946137428284,-0.3316669762134552},{0.3054502606391907,0.0717448964715004,0.3908458948135376,0.47669413685798645,-0.15829315781593323,0.1978423297405243,0.14073261618614197,-0.3744048774242401},{-0.30099090933799744,0.18165676295757294,-0.3212052285671234,0.4181394577026367,-0.05115712061524391,0.24853163957595825,0.0002061318518826738,0.2430824339389801},{-0.019606566056609154,0.21530303359031677,-0.06561978161334991,-0.1754695177078247,0.03713729605078697,0.05152758210897446,0.300616055727005,-0.021857233718037605},{0.14884048700332642,-0.2957642674446106,-0.26865291595458984,-0.17456749081611633,0.21739235520362854,-0.19732114672660828,0.21794970333576202,-0.12594658136367798},{-0.3690726161003113,-0.3448663353919983,-0.25765636563301086,-0.0011858704965561628,0.046760108321905136,0.10461433976888657,0.27453136444091797,-0.005875363480299711},{-0.21137826144695282,-0.20483922958374023,0.1537458747625351,-0.27396008372306824,0.10125698149204254,0.06932184100151062,-0.4192798137664795,-0.26115351915359497},{0.026967478916049004,0.29033851623535156,0.05810091271996498,0.18588349223136902,-0.07433317601680756,0.3348812162876129,0.2589446008205414,-0.17930079996585846},{-0.012616933323442936,-0.27929145097732544,-0.13727186620235443,-0.013977859169244766,-0.05300930142402649,-0.33616459369659424,0.0939725786447525,-0.23239892721176147},{-0.12016938626766205,0.0061447834596037865,0.048716552555561066,-0.25814223289489746,0.11097050458192825,0.08832406997680664,0.10497375577688217,-0.005704368464648724},{0.021238479763269424,-0.06039808318018913,0.060106802731752396,-0.17664097249507904,0.03966587781906128,-0.04448053985834122,0.09048043936491013,-0.1513514220714569},{-0.3142572045326233,0.19617609679698944,0.17073163390159607,-0.28063341975212097,-0.38853883743286133,-0.041853658854961395,0.19904862344264984,0.05648906156420708},{0.27613404393196106,0.05765943601727486,-0.3930031955242157,-0.008471132256090641,-0.06614450365304947,0.22113224864006042,0.2275848686695099,0.3166396915912628},{0.007865022867918015,-0.20723460614681244,-0.05882503092288971,0.12066276371479034,-0.31300103664398193,-0.08841052651405334,-0.24093547463417053,-0.2812327742576599},{0.1126600131392479,-0.0799904614686966,-0.39192163944244385,0.3396674692630768,-0.34661272168159485,-0.11047186702489853,-0.44129350781440735,0.0947098359465599},{-0.0032585500739514828,0.32839435338974,-0.20697104930877686,-0.09988757967948914,0.08711091428995132,-0.1518133282661438,0.2837120592594147,-0.2746421694755554},{-0.10625868290662766,0.09396463632583618,-0.1115490049123764,-0.2539546489715576,0.01244085468351841,-0.1359833925962448,-0.144804447889328,-0.09572435915470123},{0.08360317349433899,-0.15964025259017944,0.03121820278465748,-0.1514577567577362,0.05887293443083763,0.084880031645298,-0.22477596998214722,0.10373038798570633},{0.1984948068857193,0.015181416645646095,-0.31754270195961,-0.2173953503370285,-0.19396930932998657,0.18155713379383087,0.21731975674629211,0.043760452419519424},{0.3203190565109253,-0.35109996795654297,0.015035714022815228,-0.04573440924286842,0.11163710802793503,-0.08029831200838089,0.1760256141424179,0.23776836693286896},{-0.26088282465934753,-0.20378422737121582,0.04793253913521767,-0.3612474203109741,0.2802174687385559,-0.3364517390727997,-0.03340553492307663,0.08407693356275558},{0.2640538215637207,0.21181708574295044,-0.012144660577178001,0.22668229043483734,0.0996209979057312,-0.1639835387468338,-0.04276399686932564,0.14846007525920868}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.22815871238708496,0.41300883889198303,-0.4794824719429016,-0.5262799859046936,-0.17955848574638367,-0.09555793553590775,-0.3843477964401245,0.5148988962173462},{-0.022951509803533554,0.4372207522392273,-0.25525963306427,0.5454392433166504,-0.035172611474990845,-0.045815709978342056,-0.3366067707538605,0.007313004694879055},{-0.3402270972728729,-0.1979164034128189,-0.14127221703529358,-0.09688183665275574,0.42907124757766724,0.20909447968006134,-0.05266331881284714,0.41914451122283936},{-0.49707505106925964,-0.5179761052131653,0.3228769600391388,0.2685597836971283,-0.4855913519859314,-0.21326975524425507,0.43286094069480896,0.22659535706043243},{-0.2765600085258484,-0.253613144159317,-0.3092934191226959,-0.18147383630275726,0.3506084382534027,-0.23074248433113098,0.49089935421943665,-0.38802534341812134},{-0.027111947536468506,0.25214236974716187,0.14117678999900818,-0.5608826875686646,0.5253130793571472,-0.2323082983493805,-0.5065181255340576,-0.3585211932659149},{-0.2969202399253845,0.12707847356796265,0.07040440291166306,-0.454293817281723,0.03538299351930618,-0.5121978521347046,0.46088096499443054,0.06437751650810242},{-0.3192138671875,-0.14969496428966522,-0.1460333615541458,-0.3687790036201477,-0.38012152910232544,0.11649036407470703,0.5594170093536377,-0.2981160283088684}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.030479280278086662,-0.09937150031328201,-0.10808160901069641,0.0256479661911726,0.17428961396217346,0.045033201575279236,0.14334748685359955,0.04169614985585213};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.006170390639454126,-0.018333949148654938,-0.02163730375468731,-0.08785005658864975,-0.05616915971040726,-0.06715422123670578,0.013480174355208874,-0.1669122278690338};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

