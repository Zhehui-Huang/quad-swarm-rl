#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2664559483528137,0.014528745785355568,-0.15012884140014648,0.26792004704475403,0.30867546796798706,-0.18328921496868134,-0.22299756109714508,0.12188883870840073,0.24160289764404297,-0.30929744243621826,0.6311660408973694,-0.008436975069344044,0.31620243191719055,0.09229656308889389,-0.45835018157958984,0.0573883093893528},{-0.22467848658561707,-0.27898645401000977,-0.31486788392066956,-0.18376155197620392,0.07173637300729752,0.24826936423778534,0.0635448694229126,0.07136458158493042,0.2292645126581192,0.2030934989452362,-0.19744205474853516,-0.09649737924337387,-0.19632449746131897,0.07827016711235046,0.34654343128204346,-0.3145856261253357},{0.11735030263662338,0.1994137018918991,0.20527471601963043,0.3442973494529724,-0.0896000787615776,-0.24432097375392914,0.5281316041946411,-0.018655791878700256,-0.02948322705924511,-0.14482319355010986,0.029079584404826164,-0.026086945086717606,0.061922065913677216,0.48510798811912537,-0.27362260222435,-0.043520864099264145},{0.09659659117460251,-0.1487397700548172,-0.1467740386724472,-0.10052409023046494,0.019768647849559784,0.0947052463889122,0.1010378897190094,-0.18415245413780212,-0.16307011246681213,0.1544666439294815,0.505891740322113,-0.22330810129642487,-0.17298129200935364,-0.15176880359649658,0.1619430035352707,0.13785912096500397},{-0.296073317527771,0.07716294378042221,0.15338575839996338,-0.21686206758022308,0.30753904581069946,0.2906017005443573,0.14404191076755524,-0.19199606776237488,-0.11691372841596603,0.17664770781993866,-0.15426640212535858,-0.38149911165237427,-0.00287542468868196,-0.13233962655067444,0.30793580412864685,-0.03259582072496414},{-0.04908114671707153,0.027784068137407303,-0.022532768547534943,0.017506614327430725,0.08711118996143341,-0.039019353687763214,0.4098453223705292,-0.3658134341239929,-0.14437007904052734,-0.15320563316345215,0.3068130910396576,0.025664670392870903,0.20214879512786865,0.09857344627380371,0.24186982214450836,0.2666707932949066},{-0.1779203563928604,0.12650853395462036,-0.013134371489286423,0.11582129448652267,-0.1888403445482254,-0.07119399309158325,-0.13698983192443848,-0.046895649284124374,0.1254141628742218,0.3460497260093689,-0.13899539411067963,-0.0790478065609932,0.21377746760845184,0.07878244668245316,-0.18330195546150208,0.2573409378528595},{-0.11299335956573486,-0.03398443013429642,-0.22487106919288635,-0.21926957368850708,0.39351537823677063,-0.3178812265396118,-0.3000081479549408,-0.39494675397872925,-0.06526149809360504,-0.20614679157733917,0.355673611164093,-0.030916694551706314,0.23089712858200073,0.14474625885486603,-0.2628713846206665,0.4340767562389374},{0.22469285130500793,0.05250779911875725,-0.04231646656990051,0.1125575453042984,-0.364895761013031,-0.409696102142334,0.37232547998428345,-0.33982983231544495,-0.14977121353149414,0.19244807958602905,0.18157340586185455,-0.3043450713157654,-0.1357036679983139,0.012870346195995808,0.16975845396518707,0.005354609806090593},{0.42272964119911194,-0.48064860701560974,-0.027422135695815086,0.0051614935509860516,0.24828854203224182,-0.1153850108385086,-0.2476528286933899,-0.1125720664858818,-0.16762769222259521,0.02773893252015114,-0.009443742223083973,-0.18725872039794922,0.3351992964744568,-0.0850260928273201,-0.5578915476799011,-0.154815211892128},{0.2624721825122833,0.13860876858234406,-0.2999555468559265,0.09866061806678772,0.05383668094873428,-0.16647028923034668,-0.12742362916469574,0.1261277198791504,-0.15551096200942993,0.10956260561943054,0.1989876925945282,0.24838216602802277,-0.11258873343467712,0.2456061691045761,0.015999436378479004,-0.30898618698120117},{-0.4426884651184082,0.284222811460495,0.22345182299613953,-0.2770821154117584,-0.26485252380371094,0.2999436557292938,0.060639288276433945,0.2992185652256012,0.22988447546958923,0.1461060494184494,0.1982434093952179,-0.13479511439800262,0.16144393384456635,-0.0777188241481781,-0.0687396451830864,-0.16268564760684967},{0.1102236807346344,-0.25566887855529785,-0.20026390254497528,0.16124732792377472,-0.24210546910762787,-0.20762215554714203,-0.10783949494361877,0.22988079488277435,0.3230006694793701,-0.12530389428138733,-0.03135031461715698,0.0760355144739151,0.2414388805627823,0.1540912389755249,-0.19454391300678253,0.2735847532749176},{0.2956399917602539,0.18161721527576447,-0.09852765500545502,-0.10904590785503387,0.06385444849729538,-0.08531118184328079,-0.11642459034919739,0.26148757338523865,-0.2135784924030304,-0.1936805546283722,-0.17371435463428497,0.04988249018788338,-0.21509984135627747,-0.11095275729894638,-0.23113755881786346,-0.04037275165319443},{0.14749206602573395,0.43924447894096375,0.38917791843414307,-0.3564368486404419,-0.3582432270050049,0.1973140835762024,-0.004222378134727478,-0.17815421521663666,0.4038417637348175,0.39245423674583435,-0.10646925121545792,0.11457104235887527,-0.1078895553946495,-0.3180457353591919,0.0933791846036911,-0.18365052342414856},{-0.21928852796554565,-0.127815842628479,-0.11127142608165741,0.41152212023735046,-0.23505298793315887,-0.233464315533638,-0.23307111859321594,-0.29897913336753845,-0.48703527450561523,-0.22394149005413055,0.3316534757614136,0.2606927156448364,-0.5321459770202637,-0.3233134150505066,-0.5326683521270752,-0.17426756024360657},{-0.4698663055896759,0.19248640537261963,-0.3114677667617798,-0.16284476220607758,-0.428475946187973,0.19460180401802063,0.512519896030426,0.07096853852272034,0.41151928901672363,-0.48553550243377686,0.24040591716766357,-0.32857778668403625,-0.19479461014270782,0.04061418026685715,-0.15678641200065613,-0.20168180763721466},{0.36877670884132385,-0.5928288102149963,0.26624515652656555,0.22334469854831696,-0.13654260337352753,0.47656118869781494,0.20270229876041412,0.2966732680797577,-0.03352370858192444,-0.2265266627073288,-0.15756672620773315,-0.12351736426353455,-0.1128179281949997,-0.5306457877159119,0.2764340341091156,-0.11042751371860504}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.008046954870223999,0.29538366198539734,0.1879253387451172,-0.153992161154747,-0.17611348628997803,0.05602576583623886,-0.0077775344252586365,0.21490560472011566,-0.09670943766832352,0.30639082193374634,0.46464210748672485,-0.3716910481452942,0.03616202250123024,0.05857079476118088,-0.007159230299293995,-0.08434730768203735},{-0.3411577641963959,0.18764886260032654,-0.14327993988990784,0.312721312046051,0.2768961787223816,-0.06207505241036415,-0.3157145082950592,-0.1544273942708969,0.3348149359226227,0.2583768665790558,-0.047649141401052475,0.2172669619321823,-0.3687310814857483,0.15950961410999298,-0.2108999490737915,0.4292711913585663},{-0.2360515296459198,0.13369061052799225,-0.21935690939426422,0.14778289198875427,-0.42125043272972107,-0.17071115970611572,0.023627325892448425,0.09988277405500412,-0.1521630436182022,0.35272565484046936,0.2296866923570633,-0.09518581628799438,0.14136779308319092,-0.2680091857910156,-0.09849736839532852,-0.023633789271116257},{0.15984737873077393,-0.23815253376960754,0.0751124769449234,0.39193829894065857,-0.42500603199005127,-0.30306363105773926,0.23268818855285645,0.02614767476916313,0.2672206163406372,-0.08330681920051575,0.2984932065010071,0.10809570550918579,-0.18408212065696716,0.013542063534259796,-0.008534479886293411,-0.38021326065063477},{-0.361928790807724,-0.09296444803476334,0.09801365435123444,-0.26253437995910645,0.12782403826713562,0.3050225079059601,-0.30575358867645264,0.3159330487251282,-0.2113635540008545,0.19670327007770538,-0.005181916989386082,0.05080728977918625,-0.2670347988605499,-0.005741138942539692,-0.25201931595802307,-0.08387970179319382},{0.07647102326154709,-0.2910918891429901,0.0015790917677804828,-0.3233022093772888,0.21201564371585846,0.018458914011716843,-0.12012075632810593,-0.0505751371383667,-0.1298898607492447,0.36321067810058594,0.1646934598684311,0.009243709966540337,-0.2942869961261749,0.0814022496342659,0.015675250440835953,-0.2994824945926666},{0.22623927891254425,-0.23378722369670868,0.3157316744327545,-0.18484719097614288,-0.42804616689682007,0.03632737696170807,-0.35549396276474,0.35251814126968384,-0.11286410689353943,-0.2690848112106323,-0.24352732300758362,-0.0213419571518898,-0.09650705009698868,-0.06615354865789413,0.50074303150177,-0.36104556918144226},{-0.36593931913375854,0.3313531279563904,-0.08384732156991959,0.1675696074962616,-0.1250211000442505,-0.2223319560289383,-0.21579718589782715,0.08462676405906677,-0.04734330251812935,0.43392303586006165,0.06146090477705002,-0.11844681203365326,0.06427963078022003,-0.21139508485794067,0.05927840247750282,0.16824188828468323},{0.11554419249296188,0.2588810920715332,-0.16154725849628448,-0.2963049113750458,0.30338093638420105,-0.184101402759552,0.19815963506698608,-0.24786806106567383,-0.023055704310536385,0.013424037024378777,0.09315908700227737,0.05653788894414902,0.013877058401703835,-0.35951071977615356,-0.08922451734542847,0.19186025857925415},{-0.15636441111564636,0.03183222562074661,-0.25549307465553284,-0.2942504286766052,0.2229287028312683,-0.3483082354068756,-0.09091009199619293,0.29130011796951294,-0.16420447826385498,0.12783604860305786,-0.04899035021662712,-0.10050681978464127,-0.34768131375312805,0.10004948079586029,-0.21911223232746124,-0.3482956886291504},{-0.12070562690496445,-0.16332842409610748,0.04194328188896179,-0.24242053925991058,-0.3203386962413788,0.034022409468889236,0.1268811672925949,-0.2999056279659271,0.006651346106082201,-0.09298153221607208,0.25550779700279236,-0.05993592366576195,0.21149978041648865,0.15941917896270752,0.22321194410324097,0.25480833649635315},{-0.14668266475200653,-0.027057068422436714,-0.3037641942501068,0.32075339555740356,0.08756077289581299,0.1594267636537552,0.1900770515203476,0.13444004952907562,-0.40200626850128174,0.1899396777153015,-0.35813626646995544,-0.2215571403503418,-0.3225388824939728,0.34450507164001465,-0.3345191776752472,0.091526098549366},{-0.14326538145542145,-0.4386516213417053,-0.03721657022833824,0.13637372851371765,-0.22028611600399017,-0.04803990572690964,-0.08433127403259277,0.3793589174747467,0.43186742067337036,0.11972924321889877,0.011941861361265182,-0.19567647576332092,0.15296050906181335,-0.36091431975364685,0.09728394448757172,-0.1634065806865692},{-0.2668844759464264,-0.4504466652870178,-0.12300588190555573,-0.12054400146007538,-0.5023403167724609,0.4770543575286865,-0.142754465341568,0.19196026027202606,-0.1532004177570343,-0.22971811890602112,-0.2841933071613312,0.35379377007484436,-0.11449452489614487,-0.025498421862721443,-0.205375537276268,0.3188422620296478},{-0.30518272519111633,0.34482911229133606,-0.24429357051849365,0.15888431668281555,-0.3622068166732788,0.14372162520885468,0.007371976505964994,-0.31786251068115234,0.12839967012405396,0.1794574111700058,-0.2303134948015213,0.0704171285033226,0.22500088810920715,-0.28835102915763855,-0.32427579164505005,-0.15070772171020508},{-0.13587293028831482,-0.2860163152217865,-0.375013142824173,0.23844967782497406,0.1306687593460083,0.0455092191696167,-0.23726262152194977,0.17059743404388428,-0.33434009552001953,-0.23183439671993256,-0.2783021926879883,0.1755620688199997,-0.2179449051618576,0.15527354180812836,0.052687641233205795,0.29558905959129333}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11596768349409103,-0.04652533680200577,0.21342016756534576,-0.12514282763004303,-0.07785585522651672,0.08859248459339142,0.21451663970947266,-0.19504782557487488,-0.2289690375328064,0.2549929916858673,0.15299507975578308,0.11411618441343307,0.06092171370983124,0.16964180767536163,-0.14832541346549988,0.16720141470432281,0.14300917088985443,-0.3448552191257477,-0.1461898386478424,-0.09717563539743423,-0.11286364495754242,0.03173625096678734,-0.16867755353450775,0.2520284056663513,-0.03825214505195618,-0.06356016546487808,0.10250537097454071,0.2075178474187851,-0.18641330301761627,-0.12855234742164612,0.1747986078262329,0.23249754309654236},{0.21075499057769775,-0.08254094421863556,0.1398710161447525,-0.13286544382572174,-0.1211187094449997,0.22401213645935059,0.0016736367251724005,-0.07685821503400803,-0.04654071107506752,0.025112617760896683,-0.15011996030807495,-0.007765030488371849,0.3993273973464966,0.17867717146873474,0.1043722927570343,0.046639177948236465,-0.2086029350757599,-0.3414536416530609,0.05959844961762428,0.025025753304362297,0.06424345821142197,0.2890821397304535,0.19210411608219147,-0.21698836982250214,0.007042630109935999,0.24738886952400208,-0.26250627636909485,0.17410892248153687,0.08283750712871552,-0.22199375927448273,-0.06973552703857422,-0.035660188645124435},{-0.09921576827764511,-0.07215999811887741,0.3169400990009308,-0.23031345009803772,-0.1476278305053711,0.05329839512705803,-0.12392648309469223,0.2530745267868042,0.09878884255886078,0.002195850946009159,-0.17656603455543518,-0.03489432856440544,0.2386799454689026,-0.21491128206253052,0.1066044494509697,-0.02711031585931778,-0.29429227113723755,0.27196204662323,-0.21769577264785767,-0.04560275748372078,0.004948936402797699,-0.14755882322788239,-0.029136229306459427,-0.0755225345492363,0.0057854424230754375,0.26058489084243774,-0.08109115809202194,0.09315451979637146,0.24436330795288086,-0.2244974672794342,-0.21372295916080475,-0.07244385033845901},{0.13661634922027588,-0.0915544331073761,0.059881776571273804,-0.31199607253074646,0.09915976971387863,-0.15702497959136963,-0.08116398006677628,0.2605784833431244,0.02777590975165367,0.11338283866643906,0.1606433391571045,-0.08394027501344681,-0.18763309717178345,-0.09231799840927124,0.29846301674842834,-0.23284906148910522,0.03030148521065712,-0.1387248933315277,-0.13030143082141876,0.11644668877124786,-0.1053718626499176,0.041335854679346085,-0.20969676971435547,0.2212861031293869,-0.1860663741827011,0.11370258778333664,-0.08967725932598114,-0.18672879040241241,0.11149325221776962,-0.016320666298270226,0.2544223666191101,-0.12585002183914185},{0.22108349204063416,0.004119653720408678,0.03227759525179863,0.23135879635810852,-0.2336765080690384,-0.08542691916227341,0.19978423416614532,-0.059864774346351624,0.11155562102794647,-0.17494644224643707,-0.0064315227791666985,-0.08255264908075333,-0.15047647058963776,-0.17675957083702087,0.27399685978889465,0.31599950790405273,-0.06481374055147171,-0.3398020565509796,0.15872694551944733,-0.13121294975280762,-0.12166541069746017,0.2014973759651184,0.26047107577323914,0.05614574998617172,-0.025510815903544426,-0.08963404595851898,-0.012965339235961437,0.27312031388282776,0.22882094979286194,0.1364944577217102,0.0974079817533493,-0.23340938985347748},{0.33764180541038513,-0.15608468651771545,-0.008676408790051937,0.09993448108434677,-0.13628366589546204,-0.31046178936958313,-0.21047534048557281,-0.30735114216804504,-0.19091372191905975,0.03567004203796387,-0.06114752218127251,-0.012013311497867107,-0.1500098705291748,-0.03962079808115959,-0.21015049517154694,-0.21730618178844452,0.1651722639799118,-0.014228678308427334,-0.3151662349700928,0.17572829127311707,-0.06871102005243301,-0.20247367024421692,0.18279539048671722,-0.14335104823112488,-0.1328626126050949,-0.22168608009815216,-0.10614369809627533,0.14040204882621765,0.07205020636320114,0.2619099020957947,-0.22254358232021332,0.20899540185928345},{0.15053363144397736,0.10474149882793427,0.26583901047706604,-0.1888105869293213,0.23131348192691803,-0.2287374883890152,-0.24286572635173798,0.06160254776477814,0.2682988941669464,0.10028263926506042,-0.09923222661018372,0.103563591837883,0.05440998077392578,0.3367522060871124,0.11477112025022507,-0.11088287830352783,-0.18299375474452972,0.1374741494655609,0.013673967681825161,-0.002240908332169056,-0.03672116994857788,0.18020601570606232,0.1616307497024536,0.13037428259849548,-0.13596203923225403,-0.23403246700763702,-0.24906280636787415,-0.3566743731498718,0.08910895138978958,-0.1150454506278038,0.24645164608955383,0.16553564369678497},{0.27339568734169006,-0.27954214811325073,0.11970991641283035,-0.35783401131629944,-0.34635356068611145,0.24645960330963135,0.3740350902080536,0.13525813817977905,-0.09981746226549149,0.0003067402576562017,0.2294011265039444,-0.13004417717456818,0.14194661378860474,0.3371730148792267,-0.02877032198011875,0.1807458996772766,0.3632447123527527,-0.1823916733264923,-0.027189545333385468,-0.2670574486255646,0.1440889984369278,0.20204713940620422,0.22762900590896606,0.11454517394304276,0.09478563070297241,0.11583828926086426,0.11265614628791809,0.25565943121910095,-0.1771184653043747,-0.24475280940532684,0.23919114470481873,-0.058405712246894836},{0.04879773408174515,-0.0946706235408783,0.27047133445739746,0.2135343700647354,-0.1515483409166336,-0.270143985748291,-0.05363687127828598,0.2917338013648987,-0.183648943901062,-0.22954408824443817,0.051387764513492584,0.09435903280973434,0.11118955165147781,-0.2914406359195709,0.12485524266958237,-0.17464497685432434,-0.15818487107753754,0.17737017571926117,-0.2301211655139923,0.3051132261753082,-0.30988553166389465,-0.290023535490036,-0.2615329325199127,0.29701268672943115,0.10709802061319351,0.09176179766654968,0.2445809543132782,0.19110910594463348,-0.1529269963502884,-0.26273563504219055,-0.14715389907360077,0.18076010048389435},{0.25856146216392517,-0.020094910636544228,-0.05578938126564026,0.15991297364234924,-0.026825031265616417,0.18899452686309814,-0.044905826449394226,0.22344188392162323,-0.001102360780350864,0.062432192265987396,0.18482396006584167,0.05720537528395653,-0.12279843538999557,-0.3345334231853485,0.09512925893068314,0.11423879861831665,0.09328189492225647,-0.11043497174978256,-0.08921104669570923,-0.026283901184797287,0.11299397796392441,-0.27679476141929626,0.2012561559677124,0.08910419791936874,-0.01757906749844551,0.11450020968914032,-0.25983700156211853,-0.25276345014572144,-0.06811561435461044,-0.028042525053024292,0.11695455759763718,0.15627038478851318},{-0.12772084772586823,0.10333307087421417,-0.07790331542491913,0.15366992354393005,-0.10271503031253815,0.272090345621109,0.12890182435512543,-0.006795796565711498,0.2636236250400543,-0.30715838074684143,-0.15373297035694122,0.14641207456588745,-0.1678033322095871,0.03438077121973038,-0.29332977533340454,-0.029447268694639206,0.10665149241685867,0.17234686017036438,0.09797642379999161,-0.13128629326820374,-0.22112184762954712,0.201690673828125,0.19954562187194824,0.18564139306545258,-0.22712059319019318,0.34288838505744934,-0.11012738198041916,-0.02133004367351532,-0.08493588119745255,0.14441314339637756,0.21702007949352264,0.2645770311355591},{-0.16187186539173126,0.2950372099876404,-0.07479740679264069,0.009019915945827961,-0.162718266248703,-0.1330815702676773,0.1358083337545395,-0.29295143485069275,-0.03733177110552788,-0.23149514198303223,-0.22128666937351227,-0.032647326588630676,0.16179008781909943,-0.2788100242614746,-0.11683417111635208,-0.26605138182640076,-0.2005244344472885,-0.07314039021730423,0.29919537901878357,-0.317512184381485,0.08235568553209305,-0.18408413231372833,0.08597568422555923,0.29562005400657654,-0.17226581275463104,0.18911102414131165,0.21815133094787598,-0.06381607800722122,-0.031162768602371216,0.31133607029914856,-0.12407901138067245,-0.21971692144870758},{-0.047576289623975754,0.14702065289020538,0.23796506226062775,-0.2793043851852417,0.25896063446998596,0.019580839201807976,-0.11919431388378143,-0.02800937555730343,0.152419775724411,-0.2859380543231964,-0.09055504202842712,0.009180759079754353,0.17061935365200043,0.05245010182261467,0.03091493435204029,-0.10882829874753952,0.24378177523612976,-0.23409698903560638,0.31943395733833313,0.07856423407793045,-0.16685433685779572,0.24520142376422882,-0.12079355120658875,-0.18215857446193695,0.26808038353919983,-0.13966897130012512,0.028797930106520653,-0.17217989265918732,0.034999698400497437,-0.13214728236198425,0.2558116614818573,0.20159690082073212},{0.07131798565387726,-0.1317967176437378,-0.1680372953414917,0.061255183070898056,0.03283758834004402,0.29580068588256836,-0.10038316994905472,-0.25534212589263916,0.2646966874599457,0.015018108300864697,0.052363090217113495,0.0860535055398941,-0.17452602088451385,0.0738244503736496,-0.18911032378673553,-0.2660726010799408,0.01441703550517559,-0.05654200166463852,0.2116931974887848,0.3775588274002075,-0.19761955738067627,0.07529734075069427,-0.12213940173387527,-0.011992380954325199,0.1267704963684082,-0.2859567105770111,-0.17600344121456146,-0.21782681345939636,-0.025414960458874702,-0.17482833564281464,0.1776997148990631,-0.29278987646102905},{-0.07962167263031006,0.27038872241973877,0.16679930686950684,-0.2041831761598587,-0.09107339382171631,-0.1617293506860733,0.1783616989850998,-0.019339649006724358,0.22224611043930054,-0.0065798708237707615,0.16608265042304993,0.1454235464334488,-0.035814665257930756,0.03847523406147957,-0.11974039673805237,0.16238321363925934,-0.17003661394119263,-0.35350486636161804,-0.2399747669696808,0.10812558978796005,0.13083289563655853,-0.19221949577331543,-0.2918436825275421,-0.22649429738521576,-0.12159570306539536,0.042110223323106766,0.3245891034603119,-0.009739812463521957,-0.05896281450986862,0.13155753910541534,-0.1431570202112198,0.08543600142002106},{-0.1937779188156128,-0.17751723527908325,-0.21719516813755035,0.0027116735000163317,-0.2165183573961258,-0.0879671573638916,-0.031627099961042404,-0.01085573248565197,-0.2894781529903412,-0.20997479557991028,0.16528350114822388,0.13594084978103638,-0.2955237627029419,0.21845191717147827,-0.061719704419374466,0.16648904979228973,0.09685799479484558,0.03078719601035118,0.033557090908288956,0.15270860493183136,0.21961405873298645,0.28233835101127625,0.13507576286792755,0.26369762420654297,0.13957782089710236,-0.21757042407989502,-0.18835501372814178,0.2509298026561737,0.0011647912906482816,-0.17756929993629456,-0.15614053606987,-0.08558690547943115},{-0.29466453194618225,-0.208616703748703,-0.3257799744606018,0.043804388493299484,-0.11132857948541641,-0.053389858454465866,-0.07940276712179184,0.13581520318984985,-0.08904168009757996,0.0709887221455574,-0.17144736647605896,-0.0004534086911007762,0.13554851710796356,-0.10385637730360031,0.03538886457681656,0.17683441936969757,-0.08560462296009064,-0.09765075892210007,0.172882080078125,0.04296431690454483,0.22621563076972961,-0.055683281272649765,-0.21460305154323578,0.06907423585653305,0.1748417615890503,-0.2534790337085724,0.17318874597549438,0.05014654994010925,0.07202915847301483,-0.1435202807188034,0.19836817681789398,-0.06994106620550156},{0.26292213797569275,0.01814180426299572,0.03858780860900879,0.20334690809249878,-0.33872073888778687,-0.02912885695695877,0.06386257708072662,0.16368965804576874,-0.07112612575292587,-0.1314907819032669,0.28835222125053406,-0.09833484888076782,0.08182978630065918,-0.0546175017952919,-0.10652338713407516,0.27460384368896484,-0.07552634179592133,-0.1206100806593895,0.10366427153348923,-0.27433574199676514,-0.05715959891676903,-0.25314009189605713,-0.17444658279418945,0.2356947660446167,-0.09296950697898865,-0.04558316990733147,0.1256406158208847,0.05917482450604439,-0.1308676153421402,-0.07184170186519623,-0.03854769095778465,-0.08380823582410812},{0.2940428555011749,-0.06293345242738724,0.0599997453391552,0.06031253933906555,-0.02887616492807865,-0.07475514709949493,0.19070173799991608,-0.22205457091331482,0.24226583540439606,0.2816748321056366,0.05189499258995056,0.14728841185569763,0.20200517773628235,0.30726873874664307,-0.2906827926635742,-0.3498290777206421,-0.2315097153186798,0.0688985213637352,-0.16349734365940094,-0.3676310181617737,-0.14728721976280212,0.2172066867351532,0.06705617904663086,0.14300210773944855,-0.15954017639160156,-0.11273634433746338,-0.12077226489782333,-0.22515735030174255,0.23658955097198486,0.18959496915340424,-0.33021003007888794,-0.11023062467575073},{-0.1162903904914856,0.16787642240524292,0.2828848958015442,-0.014679539948701859,-0.02332836017012596,0.09207341074943542,-0.019125549122691154,-0.31905338168144226,0.1589294672012329,0.23615579307079315,0.18824736773967743,0.22102880477905273,-0.26698803901672363,0.1731080263853073,-0.25083717703819275,0.2992728352546692,0.1623537242412567,-0.25290581583976746,0.2658943235874176,0.058569151908159256,-0.33051371574401855,0.2718484401702881,-0.22303667664527893,0.14797808229923248,0.15643838047981262,0.2588672339916229,0.05162675306200981,0.13959486782550812,-0.15868958830833435,0.24368475377559662,-0.06319541484117508,0.10364808142185211},{-0.12980924546718597,-0.10577008128166199,0.03263275697827339,0.18355438113212585,0.020679930225014687,0.23896707594394684,-0.24865929782390594,-0.10977718979120255,-0.1836380958557129,-0.0838761255145073,-0.10258538275957108,-0.1951814740896225,-0.017781760543584824,-0.20180539786815643,0.09734213352203369,-0.20948967337608337,0.2505958676338196,-0.01603493094444275,-0.27108263969421387,-0.306180864572525,0.14302338659763336,0.12916605174541473,-0.13984793424606323,0.34168481826782227,-0.16846686601638794,0.03605033457279205,0.09296555817127228,-0.10419609397649765,0.13807836174964905,-0.1934535950422287,0.2724440395832062,0.12093675136566162},{0.29463616013526917,0.04306657984852791,0.04640086367726326,0.23058010637760162,-0.24549299478530884,0.14556942880153656,-0.09849921613931656,0.12763886153697968,0.11765872687101364,0.00545582827180624,0.1077757477760315,-0.29861384630203247,-0.257758766412735,0.06763698905706406,0.0704038068652153,-0.08180643618106842,0.26835617423057556,0.1338087022304535,-0.19412323832511902,-0.2156144082546234,0.3402833938598633,0.1957840770483017,0.22423237562179565,0.08404721319675446,-0.025341924279928207,0.06295650452375412,-0.04352888837456703,-0.16766394674777985,0.19251064956188202,0.003503688145428896,-0.17611731588840485,0.10318537801504135},{-0.013397511094808578,0.043009113520383835,-0.01495723519474268,-0.23677365481853485,-0.08876916021108627,-0.23486359417438507,-0.20880122482776642,-0.1420927792787552,-0.045717716217041016,-0.034651804715394974,-0.22028930485248566,0.03616733476519585,-0.24299778044223785,-0.15803878009319305,0.014670445583760738,0.09675174206495285,0.256563663482666,-0.1834089607000351,-0.318437784910202,0.2401040941476822,-0.1659153699874878,0.22781875729560852,0.045707907527685165,-0.05312854051589966,-0.06273601204156876,0.17247053980827332,-0.07964997738599777,-0.24312686920166016,0.22530750930309296,0.24401535093784332,-0.1289805769920349,0.17945989966392517},{-0.24046136438846588,-0.020849723368883133,0.03633572906255722,-0.030981915071606636,0.09330698847770691,0.11585785448551178,-0.19768597185611725,0.0916900634765625,-0.1495736837387085,-0.14724333584308624,0.06949421763420105,-0.13482362031936646,-0.1754579395055771,0.2646597623825073,0.01480915304273367,0.03532521054148674,0.19398105144500732,-0.25560033321380615,-0.1669490933418274,0.3291008174419403,0.028792327269911766,0.28201523423194885,-0.06716303527355194,0.010489916428923607,-0.09876637905836105,-0.17781151831150055,-0.004583269823342562,0.2840281128883362,-0.001581363845616579,0.004144096747040749,0.29472416639328003,0.2920774519443512}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.12576419115066528,0.12855543196201324,0.21847040951251984,-0.00259815389290452},{0.045823268592357635,-0.03355887532234192,0.04403091222047806,0.10020270198583603},{-0.12897449731826782,0.1597001850605011,0.07367077469825745,0.12562614679336548},{0.2940409183502197,0.047744542360305786,0.05884212255477905,0.34922024607658386},{-0.0785709023475647,0.03831318020820618,0.20013239979743958,0.0030860495753586292},{-0.12435518950223923,0.17306073009967804,0.14555086195468903,-0.03784855455160141},{-0.1695442944765091,0.011691045947372913,0.01124371588230133,-0.10078025609254837},{-0.3040655255317688,-0.09738771617412567,0.27562010288238525,-0.26618871092796326},{0.2588987946510315,-0.17210525274276733,-0.23361200094223022,-0.3008565306663513},{0.03717799484729767,0.2105693370103836,0.26287317276000977,-0.3250810205936432},{-0.09724540263414383,-0.11250505596399307,-0.17233073711395264,0.15680252015590668},{0.20141831040382385,-0.1475517302751541,0.04479531943798065,0.14005230367183685},{0.24729937314987183,0.26643580198287964,-0.06287596374750137,0.06785022467374802},{-0.008091678842902184,0.04066096991300583,-0.2339305877685547,0.018914934247732162},{0.11568489670753479,0.25378093123435974,0.2369644045829773,0.2663319408893585},{0.12542155385017395,0.06551551818847656,0.2014617919921875,0.20651106536388397},{-0.15638136863708496,-0.08612412959337234,-0.14634335041046143,-0.12421760708093643},{-0.13393881916999817,0.09220712631940842,-0.09576787799596786,-0.11121004819869995},{-0.14288528263568878,0.1388261616230011,0.14583884179592133,0.21321463584899902},{-0.018538713455200195,0.3058919906616211,-0.14338494837284088,0.05420800670981407},{-0.1857733130455017,-0.2761634290218353,-0.1376805156469345,-0.030287332832813263},{0.22335200011730194,0.3167998790740967,0.03332476690411568,-0.172029048204422},{0.005654303822666407,0.13652843236923218,0.12911556661128998,0.10882353037595749},{-0.07238191366195679,0.31646227836608887,-0.04253213107585907,-0.09672142565250397},{-0.0007255643140524626,-0.0011372901499271393,0.0010430944385007024,-0.00038250963552854955},{0.21746166050434113,-0.3049318194389343,-0.04506611451506615,0.05034811049699783},{-0.005825352855026722,-0.26169946789741516,-0.14725539088249207,-0.22490672767162323},{0.07413143664598465,-0.040368612855672836,0.17528633773326874,0.05259089171886444},{0.003778178011998534,-0.02391773648560047,0.02622256800532341,0.01454476360231638},{-0.2790665924549103,0.3062722086906433,0.2119729071855545,-0.07770701497793198},{0.2632143497467041,-0.13661833107471466,0.14555387198925018,0.003985452465713024},{0.037102460861206055,-0.2695032060146332,0.2694290578365326,-0.2134082168340683}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.02640724740922451,0.007813596166670322,0.04041498526930809,-0.050129540264606476,-0.031149333342909813,-0.16020701825618744,0.06510938704013824,0.03511665761470795,0.0021624246146529913,-0.11623213440179825,0.18313948810100555,0.07940931618213654,0.0033645022194832563,-0.0013649413594976068,0.05162033811211586,0.028547417372465134};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0399760901927948,0.0331006683409214,0.028331872075796127,0.027396712452173233,0.04201585426926613,0.00926600955426693,0.029890522360801697,0.0063362447544932365,0.013990326784551144,0.0033460722770541906,-0.038932353258132935,-0.0013775749830529094,0.008327563293278217,-0.028408193960785866,-0.050892654806375504,0.01958298124372959};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07008658349514008,0.056732337921857834,0.02167758159339428,0.07264476269483566,0.042619746178388596,-0.013592658564448357,-0.03651304170489311,-0.011789866723120213,-0.03209788724780083,-0.010582744143903255,-0.04990741237998009,0.05505015328526497,0.07411062717437744,-0.07354532182216644,0.0752440020442009,0.06949067860841751,-0.060453884303569794,-0.06603197008371353,0.00010848863166756928,0.014404002577066422,-0.04525943845510483,0.005803579930216074,0.06025396287441254,0.026357440277934074,-0.012106706388294697,0.00035859696799889207,-0.03520046919584274,0.06113418564200401,0.015596558339893818,0.0009439354762434959,0.018374374136328697,0.030425840988755226};
static const float action_parameterization_distribution_linear_bias[4] = {0.05174076929688454,0.012650624848902225,0.05847121775150299,0.04519609361886978};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.014308641664683819,0.2942979037761688,-0.034424666315317154,0.14956431090831757,0.1902017593383789,0.18902099132537842,0.2520112097263336,0.0015319164376705885},{-0.1851474791765213,-0.07813002169132233,-0.17988017201423645,-0.2941553294658661,-0.31388863921165466,-0.14997100830078125,-0.22682014107704163,-0.12944696843624115},{-0.24941498041152954,0.019831640645861626,0.24970634281635284,0.21028964221477509,0.19550639390945435,-0.009774062782526016,0.12762054800987244,-0.021882804110646248},{-0.001191245624795556,0.07717180252075195,-0.18584834039211273,-0.01724836230278015,-0.010303336195647717,-0.05673103407025337,0.12552334368228912,-0.0981065109372139},{-0.2636784017086029,-0.11827301234006882,-0.24240510165691376,-0.17617757618427277,-0.06101744994521141,0.21143539249897003,0.1296771764755249,-0.03763260692358017},{-0.3255171775817871,0.016682865098118782,0.327243447303772,0.25277623534202576,0.1961628645658493,-0.029491789638996124,-0.12396063655614853,-0.1069444790482521},{-0.13044071197509766,0.07610324025154114,0.3118203580379486,-0.1659562885761261,-0.0996951088309288,-0.2982886731624603,-0.05737629160284996,-0.15184283256530762},{-0.4453738331794739,-0.3310180604457855,0.5207701325416565,-0.026158679276704788,-0.25802117586135864,0.1868141144514084,0.19853176176548004,-0.16399216651916504},{-0.2564602494239807,0.2671254873275757,-0.09339581429958344,0.4630061089992523,0.01831332966685295,-0.43366286158561707,0.13745561242103577,0.11634324491024017},{-0.2161157876253128,-0.33828720450401306,-0.1206771582365036,-0.1781686246395111,-0.4750056862831116,0.0460757315158844,0.0343102402985096,0.12837018072605133},{0.20979775488376617,0.3117457628250122,0.24949194490909576,-0.04199124872684479,0.2522152066230774,0.03730524703860283,-0.20293165743350983,0.23564352095127106},{0.21937482059001923,-0.04561787098646164,0.2836959660053253,0.2991665005683899,-0.16625092923641205,0.22536088526248932,-0.008943485096096992,-0.19678018987178802},{0.13470277190208435,-0.26806187629699707,0.2327089160680771,0.016077958047389984,-0.11309964209794998,-0.06638600677251816,-0.1373286247253418,-0.17739726603031158},{-0.19966048002243042,-0.06708034127950668,0.36030396819114685,0.38696321845054626,0.04278348758816719,-0.0425129309296608,-0.2015744149684906,0.06532574445009232},{-0.06102906912565231,-0.1388402283191681,0.130057692527771,-0.20331154763698578,-0.23942038416862488,-0.16763432323932648,0.14973005652427673,-0.03663049265742302},{-0.04198785498738289,-0.027503637596964836,-0.0017226977506652474,-0.3397301733493805,-0.015510877594351768,0.04613646864891052,-0.08132327347993851,0.36586686968803406},{0.012162233702838421,-0.15782852470874786,-0.15276964008808136,0.04101747274398804,-0.1900329440832138,-0.12698805332183838,-0.12062254548072815,0.030854929238557816},{-0.1351063847541809,-0.17170540988445282,0.08048658072948456,-0.03468390554189682,0.1242796778678894,-0.21910719573497772,0.3960655927658081,0.07910123467445374},{0.07292389869689941,0.15529246628284454,-0.2705790400505066,0.09150256961584091,0.072649747133255,0.08034174144268036,-0.1934124231338501,0.2579759955406189},{0.20363281667232513,-0.047833237797021866,-0.3601192533969879,0.04082329943776131,-0.15991288423538208,-0.15518315136432648,-0.2577861547470093,-0.025771519169211388},{0.01487964391708374,-0.19616135954856873,0.024384871125221252,-0.13101613521575928,0.1654549241065979,-0.13771431148052216,-0.07798051089048386,0.439980149269104},{-0.04469294473528862,0.09742103517055511,-0.310835063457489,0.2457287758588791,0.2281031608581543,0.23093430697917938,0.06430790573358536,-0.2675950527191162},{-0.43646174669265747,-0.12551380693912506,0.1091386079788208,-0.056676216423511505,0.16942283511161804,-0.35240069031715393,0.15803304314613342,-0.24819420278072357},{-0.06365975737571716,0.0872335135936737,-0.11074186861515045,-0.40859663486480713,0.25434017181396484,0.05192439258098602,-0.3548333942890167,0.13794423639774323},{-0.08597607910633087,-0.19058841466903687,-0.1647038757801056,0.12023823708295822,0.19807597994804382,0.2697788178920746,0.23749153316020966,-0.051150351762771606},{-0.07913963496685028,0.0529046431183815,-0.3540479242801666,-0.2446577399969101,0.16935664415359497,-0.03820702061057091,-0.06458518654108047,0.04581904411315918},{0.3346998691558838,0.3424380421638489,-0.23180364072322845,0.2565695643424988,0.11210907995700836,0.2608741819858551,-0.29746320843696594,-0.18815910816192627},{0.43454697728157043,0.25149503350257874,0.1038854643702507,0.09181864559650421,0.23440931737422943,0.044315509498119354,0.23535364866256714,0.33986788988113403},{-0.07901330292224884,0.31201595067977905,0.13651764392852783,0.032911516726017,0.2601187825202942,-0.026982588693499565,-0.4196763038635254,-0.25790226459503174},{-0.14289942383766174,-0.2578953504562378,-0.05935017019510269,-0.17975400388240814,-0.24037352204322815,-0.15415418148040771,0.19104532897472382,0.01586025208234787},{0.4043518304824829,-0.27874553203582764,0.20887522399425507,-0.26158568263053894,0.14558659493923187,0.29256609082221985,0.05726790055632591,-0.16210944950580597},{0.14354826509952545,0.42784804105758667,0.4158805310726166,-0.190509632229805,-0.19739511609077454,0.173146054148674,0.19915391504764557,0.030548011884093285}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.08624379336833954,0.33671990036964417,-0.1394304782152176,0.22261714935302734,-0.34678539633750916,0.23628020286560059,0.3907587230205536,0.014458808116614819},{-0.3567538559436798,-0.44149744510650635,-0.29216712713241577,-0.3337353467941284,-0.3591161072254181,0.37870246171951294,0.45933231711387634,-0.43991631269454956},{0.0449121817946434,-0.11110372096300125,0.10163956880569458,0.009506162256002426,-0.07941775023937225,0.3719998002052307,-0.2932426929473877,-0.26180168986320496},{0.29393553733825684,0.016553061082959175,0.073931485414505,-0.001040763920173049,0.47282013297080994,0.3855007588863373,0.3485342860221863,0.3556115925312042},{0.09615442156791687,0.1729988008737564,-0.11476517468690872,-0.051008667796850204,0.11042813211679459,-0.30017608404159546,-0.33943501114845276,0.4012733995914459},{0.4014241397380829,0.08233670145273209,0.05511242896318436,-0.3067217171192169,-0.27739882469177246,-0.4622247517108917,-0.10496165603399277,0.41762688755989075},{-0.2736035883426666,-0.23574690520763397,0.005917542148381472,-0.17475643754005432,0.07696881145238876,0.3232097625732422,-0.43752172589302063,0.5215492844581604},{0.06859666109085083,0.016665274277329445,0.02112259529531002,-0.10267007350921631,0.2602163255214691,-0.4173124432563782,0.32240578532218933,-0.4573041796684265}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.006246923469007015,0.0238543339073658,0.1094961017370224,-0.04758194833993912,-0.05759342387318611,-0.031064214184880257,0.13007193803787231,-0.03708961606025696};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.02861017733812332,-0.017322547733783722,0.04160192236304283,-0.09808497875928879,0.013201353140175343,0.0017483207629993558,-0.019735712558031082,-0.06523783504962921};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

