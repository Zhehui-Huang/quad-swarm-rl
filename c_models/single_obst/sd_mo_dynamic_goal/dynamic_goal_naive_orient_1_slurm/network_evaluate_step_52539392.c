#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.29836305975914,0.010564847849309444,-0.02585659734904766,0.32140475511550903,0.33682331442832947,-0.2851618230342865,-0.38493257761001587,0.14246542751789093,0.30979031324386597,-0.31115636229515076,0.4421159327030182,0.04753463715314865,0.3187694251537323,0.14264386892318726,-0.35016658902168274,0.07227525860071182},{-0.3593025207519531,-0.22710959613323212,-0.30568787455558777,-0.17379774153232574,0.21898768842220306,0.33415085077285767,0.15745612978935242,0.08444222807884216,0.17400406301021576,0.2208651900291443,-0.1945769190788269,0.016112588346004486,-0.05556182935833931,0.19859634339809418,0.31448474526405334,-0.17275963723659515},{0.09906385838985443,0.36623415350914,0.1921314299106598,0.25657832622528076,-0.10178264230489731,-0.18293870985507965,0.4662364721298218,-0.0779648870229721,-0.0013198491651564837,-0.044448208063840866,-0.059785835444927216,-0.027233554050326347,-0.03637925535440445,0.41642558574676514,-0.39598968625068665,-0.07139407098293304},{0.2162477970123291,-0.16556598246097565,0.03771243989467621,-0.1610363870859146,0.10331601649522781,0.06411684304475784,0.02726793847978115,-0.09914373606443405,-0.0685010626912117,0.10153917223215103,0.44808122515678406,-0.26826244592666626,-0.10357113182544708,-0.10344694554805756,0.3489149808883667,0.04074237868189812},{-0.2580695152282715,-0.08191848546266556,0.11197982728481293,-0.2737133204936981,0.21237388253211975,0.20795497298240662,0.16472959518432617,-0.3043069839477539,-0.21285367012023926,0.13293059170246124,-0.02772778645157814,-0.3772926926612854,-0.15229089558124542,-0.26127195358276367,0.2776091992855072,-0.07863221317529678},{-0.019426897168159485,-0.041494935750961304,-0.06666330993175507,-0.16077971458435059,0.12571293115615845,-0.26419803500175476,0.47746846079826355,-0.30550074577331543,-0.17979517579078674,-0.15538260340690613,0.2817324697971344,0.15369899570941925,0.3052630126476288,0.03970739245414734,0.3518800139427185,0.32019302248954773},{-0.2587767243385315,0.32618892192840576,-0.023144399747252464,0.05446244403719902,-0.304813027381897,-0.10844653099775314,-0.17854230105876923,-0.0053157382644712925,0.23533731698989868,0.41111427545547485,-0.31736308336257935,-0.0010318042477592826,0.2686713635921478,0.032879192382097244,-0.14728336036205292,0.36520716547966003},{-0.0668216124176979,-0.05670787766575813,-0.0555465929210186,-0.06976853311061859,0.21869127452373505,-0.18880102038383484,-0.214468315243721,-0.4461233913898468,-0.1278601884841919,-0.3564532697200775,0.5079079866409302,0.038657981902360916,0.07759573310613632,0.14282122254371643,-0.1246250569820404,0.4168224334716797},{0.2574373185634613,0.20287223160266876,0.1145293191075325,-0.07585903257131577,-0.2455935925245285,-0.4796154499053955,0.17807050049304962,-0.4060124456882477,-0.10226903110742569,0.15983068943023682,0.15627285838127136,-0.4214174151420593,-0.2835788428783417,0.18243390321731567,0.2849459648132324,-0.16107143461704254},{0.3702072203159332,-0.5392933487892151,-0.1864432990550995,-0.10835760086774826,0.3717396855354309,-0.32039013504981995,-0.28231745958328247,-0.18437474966049194,-0.24748365581035614,0.14163191616535187,-0.25140711665153503,-0.19993402063846588,0.5674676895141602,-0.048659972846508026,-0.4887177646160126,-0.08795487135648727},{0.2278614640235901,0.31658390164375305,-0.19904212653636932,0.15439985692501068,-0.06576745212078094,-0.2511010468006134,-0.21994519233703613,0.12921777367591858,-0.16777752339839935,0.2751743495464325,0.10115408897399902,0.4190402925014496,-0.11354795098304749,0.2415401190519333,-0.03401998430490494,-0.16044113039970398},{-0.4283672273159027,0.2511017620563507,0.2966342568397522,-0.471464067697525,-0.3486829698085785,0.1395302712917328,-0.16525967419147491,0.19613955914974213,0.19102972745895386,0.29402682185173035,0.3953604996204376,0.05576878413558006,-0.11567091196775436,-0.1414329558610916,-0.029408050701022148,-0.18930040299892426},{0.18803644180297852,-0.40280455350875854,-0.2798386812210083,0.3925447165966034,-0.2334795892238617,-0.3343353271484375,0.03756863251328468,0.3307579457759857,0.16850987076759338,-0.17873351275920868,-0.35819554328918457,0.15480494499206543,0.5334267020225525,0.31404852867126465,-0.2832757532596588,0.5865628123283386},{0.32374507188796997,0.19680385291576385,-0.1941504180431366,0.017859438434243202,0.20737065374851227,-0.15238651633262634,-0.1120540127158165,0.27773889899253845,-0.35458025336265564,-0.19360196590423584,-0.24621090292930603,0.04334215447306633,-0.30833038687705994,-0.09686354547739029,-0.2654015123844147,-0.07877278327941895},{0.047375377267599106,0.4907047748565674,0.41117873787879944,-0.4866349697113037,-0.32202523946762085,0.15276005864143372,0.06572192907333374,-0.025723813101649284,0.43856877088546753,0.3372354507446289,-0.16772833466529846,0.06968577951192856,-0.009244144894182682,-0.27106472849845886,0.13068434596061707,-0.17257465422153473},{-0.34876030683517456,-0.1305871158838272,-0.11116474121809006,0.350021094083786,-0.19294044375419617,0.03101246803998947,-0.23133538663387299,-0.09307992458343506,-0.4117794334888458,-0.16607747972011566,0.34906286001205444,0.22130544483661652,-0.3620035946369171,-0.27059561014175415,-0.4529305696487427,-0.1506882905960083},{-0.3766975700855255,0.1445743590593338,-0.35727259516716003,0.03641756251454353,-0.19751344621181488,0.320185124874115,0.3855569362640381,0.17301131784915924,0.2769780457019806,-0.2773834466934204,-0.10780757665634155,-0.11144465953111649,-0.010563906282186508,0.030685948207974434,-0.06552170217037201,-0.1460677832365036},{0.1243831142783165,-0.3863253593444824,0.17136827111244202,0.20686668157577515,-0.03614222630858421,0.33027374744415283,0.29288047552108765,0.1420833170413971,-0.15206660330295563,-0.27514520287513733,-0.11290588229894638,-0.04050368070602417,-0.2170058637857437,-0.3921346664428711,0.08464955538511276,0.05084976553916931}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.03710351884365082,0.3106844127178192,0.23836317658424377,-0.14788901805877686,-0.2645527720451355,0.09471927583217621,-0.0887833833694458,0.36680537462234497,-0.04898775368928909,0.3826395571231842,0.33811721205711365,-0.381131112575531,-0.031864795833826065,-0.08086223155260086,0.03627301752567291,-0.0972106009721756},{-0.4851827621459961,0.2216486781835556,-0.27298805117607117,0.31577199697494507,0.3345639705657959,-0.2701393663883209,-0.2940385043621063,-0.2378566712141037,0.31016743183135986,0.2872486710548401,-0.005302899517118931,0.21808522939682007,-0.4049778878688812,0.19777971506118774,-0.3020351231098175,0.4567306935787201},{-0.3671239912509918,0.2545199692249298,-0.32125869393348694,0.042164839804172516,-0.40700942277908325,-0.3303203582763672,0.030860207974910736,-0.03211120143532753,-0.26040026545524597,0.33710378408432007,0.3560149669647217,-0.10815474390983582,0.2738349437713623,-0.21095030009746552,-0.15337170660495758,0.02173110842704773},{0.2948911190032959,-0.2204851359128952,0.10699275135993958,0.43471476435661316,-0.4162521958351135,-0.4314297139644623,0.3106057047843933,0.07399116456508636,0.30519646406173706,-0.08452273905277252,0.3401833176612854,0.09648188203573227,-0.2325320839881897,-0.029322855174541473,0.000919873418752104,-0.3754843473434448},{-0.3482001721858978,0.014038702473044395,0.28158101439476013,-0.33458828926086426,0.127101331949234,0.3705002963542938,-0.22546780109405518,0.24499550461769104,-0.22532477974891663,0.16883312165737152,0.016111882403492928,-0.02933785319328308,-0.15067672729492188,0.04806462302803993,-0.20638495683670044,-0.15801554918289185},{0.06842844188213348,-0.26615816354751587,0.03133638575673103,-0.3296070098876953,0.2877361476421356,0.09904863685369492,-0.02916710451245308,-0.11314104497432709,-0.21112321317195892,0.31744879484176636,0.31479737162590027,-0.05874759331345558,-0.2495567500591278,0.24472787976264954,-0.028185589239001274,-0.33058401942253113},{0.24206024408340454,-0.113484226167202,0.34518295526504517,-0.2834341824054718,-0.33299902081489563,-0.024526143446564674,-0.3483722507953644,0.33460089564323425,-0.12080872058868408,-0.2552529573440552,-0.2559358775615692,-0.027531521394848824,-0.07820408791303635,-0.08324532955884933,0.44302889704704285,-0.348453551530838},{-0.2754973769187927,0.3531322181224823,-0.08650050312280655,0.2897396683692932,-0.03225922957062721,-0.21875661611557007,-0.14541007578372955,0.1540350615978241,-0.058512333780527115,0.44353756308555603,0.12264998257160187,-0.16165995597839355,-0.0604340098798275,-0.09545905143022537,0.058168184012174606,0.20399110019207},{0.06286517530679703,0.26968249678611755,-0.18665340542793274,-0.38786065578460693,0.3429926633834839,-0.17998898029327393,0.10709423571825027,-0.31788522005081177,0.15084721148014069,0.03245373070240021,0.07476811856031418,0.17791081964969635,-0.03219856321811676,-0.37269797921180725,-0.033645857125520706,0.2660054564476013},{-0.27824610471725464,0.0024095235858112574,-0.355501651763916,-0.3223835229873657,0.2568162977695465,-0.4363362193107605,-0.18948669731616974,0.29741036891937256,-0.16015754640102386,0.25077763199806213,-0.04931383207440376,-0.11367552727460861,-0.3628765344619751,-0.003453026060014963,-0.2971566915512085,-0.34731507301330566},{-0.2058316171169281,-0.1112939864397049,-0.08618686348199844,-0.23551836609840393,-0.33160045742988586,-0.05496765673160553,0.24834991991519928,-0.47991514205932617,-0.05458462983369827,-0.010866932570934296,0.224973663687706,-0.086720772087574,0.4166945815086365,0.10498911887407303,0.1678437441587448,0.1591833382844925},{-0.12585356831550598,-0.08023284375667572,-0.38926616311073303,0.31452426314353943,0.07999549061059952,-0.037279803305864334,0.15675479173660278,0.08329391479492188,-0.3714044988155365,0.15557897090911865,-0.2715800404548645,-0.13003140687942505,-0.39498016238212585,0.44927316904067993,-0.2920158803462982,0.12092527747154236},{-0.22293224930763245,-0.43834465742111206,-0.12656967341899872,0.13684555888175964,-0.2120353728532791,-0.09338315576314926,-0.08744890987873077,0.4099096655845642,0.44279369711875916,0.0394342802464962,-0.033687934279441833,-0.2128399759531021,0.17592203617095947,-0.3210083842277527,0.12472551316022873,-0.13819128274917603},{-0.34788259863853455,-0.4113714396953583,-0.22248820960521698,-0.12858371436595917,-0.4148516356945038,0.41824087500572205,-0.11477795243263245,0.24234546720981598,-0.15671508014202118,-0.2627888321876526,-0.3599681854248047,0.39942243695259094,-0.1956336796283722,-0.030612332746386528,-0.3038767874240875,0.3917912244796753},{-0.40211644768714905,0.35243356227874756,-0.20010828971862793,0.08394502103328705,-0.39614740014076233,0.31718990206718445,-0.09661545604467392,-0.3125956058502197,0.12314598262310028,0.22992368042469025,-0.2874143719673157,0.08628962934017181,0.2749278247356415,-0.37351515889167786,-0.3246389329433441,-0.17776572704315186},{-0.14575210213661194,-0.3505987823009491,-0.4709886610507965,0.24912935495376587,-0.015003213658928871,0.09672895073890686,-0.3114398717880249,0.24229758977890015,-0.3772928714752197,-0.3208615183830261,-0.35816535353660583,0.23664699494838715,-0.1469975709915161,0.15270818769931793,0.13055159151554108,0.29265162348747253}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12512774765491486,-0.06307454407215118,0.15593676269054413,-0.15318304300308228,-0.11263994872570038,0.07808281481266022,0.2311999648809433,-0.1983988732099533,-0.17341835796833038,0.24261508882045746,0.18283575773239136,0.11913104355335236,0.030905166640877724,0.17731165885925293,-0.19566167891025543,0.1412944197654724,0.1483445018529892,-0.31865668296813965,-0.21533259749412537,-0.11692245304584503,-0.07447534799575806,0.022604364901781082,-0.2233773022890091,0.30820831656455994,-0.14292789995670319,-0.022192975506186485,0.15909968316555023,0.19968193769454956,-0.24650102853775024,-0.20560389757156372,0.16797704994678497,0.31085702776908875},{0.19199037551879883,-0.04694901779294014,0.22642700374126434,-0.12872342765331268,-0.10432841628789902,0.24975845217704773,0.08655556291341782,0.00011313662980683148,-0.125113844871521,-0.07192643731832504,-0.023751910775899887,-0.044639620929956436,0.3002677857875824,0.19224970042705536,0.12966188788414001,0.06292682886123657,-0.1928938329219818,-0.31014642119407654,0.1645437628030777,0.02302890457212925,0.1506187468767166,0.1949293315410614,0.24406449496746063,-0.2230815291404724,0.021568823605775833,0.2740735411643982,-0.3012144863605499,0.19734743237495422,0.1422145813703537,-0.18201012909412384,-0.11759739369153976,-0.0021571123506873846},{-0.09383879601955414,-0.02764769457280636,0.22730596363544464,-0.18139582872390747,-0.19471322000026703,0.006909461691975594,-0.20719680190086365,0.2155500054359436,0.18943481147289276,-0.0305059552192688,-0.1463746726512909,0.059934329241514206,0.2957318425178528,-0.21440629661083221,0.10616673529148102,-0.016283517703413963,-0.3664838969707489,0.2301790863275528,-0.3071472942829132,-0.05809508264064789,0.004354154225438833,-0.15489913523197174,-0.05605519935488701,-0.10087888687849045,-0.02135227806866169,0.3784996569156647,-0.04867009073495865,0.12415114045143127,0.288476824760437,-0.3540642559528351,-0.1688532680273056,0.029313145205378532},{0.13438022136688232,-0.20341841876506805,0.017919359728693962,-0.3744737207889557,0.12491776794195175,-0.12070776522159576,-0.05667915940284729,0.22878257930278778,0.058953262865543365,0.20176738500595093,0.08743073046207428,-0.12970927357673645,-0.22406665980815887,-0.0769682303071022,0.257360577583313,-0.24176186323165894,0.06433534622192383,-0.11186959594488144,-0.17030933499336243,0.06894151866436005,-0.11471189558506012,0.1101493090391159,-0.2413579523563385,0.26832252740859985,-0.24711056053638458,0.060233622789382935,-0.048669829964637756,-0.2144932895898819,0.025896748527884483,-0.0018661271315068007,0.25608763098716736,-0.12507005035877228},{0.22091558575630188,-0.060135822743177414,-0.024602526798844337,0.22556795179843903,-0.31464752554893494,-0.12057743966579437,0.17210517823696136,-0.05326516926288605,0.19062891602516174,-0.18062567710876465,-0.011467642150819302,-0.06061897426843643,-0.1964966505765915,-0.12734968960285187,0.22922663390636444,0.2372288554906845,-0.03586317226290703,-0.31867915391921997,0.08197290450334549,-0.129789799451828,-0.12128014862537384,0.2472163736820221,0.17331206798553467,0.0516279935836792,-0.04938838258385658,-0.07762740552425385,0.07386084645986557,0.22161979973316193,0.2246543914079666,0.07378269731998444,0.11868857592344284,-0.23794959485530853},{0.2840350270271301,-0.14973211288452148,0.05025136098265648,0.07326430827379227,-0.15558387339115143,-0.3227095305919647,-0.192959263920784,-0.30626532435417175,-0.2438988834619522,-0.01918335072696209,0.023894108831882477,-0.01857032999396324,-0.129996657371521,-0.033679816871881485,-0.22165662050247192,-0.25855302810668945,0.1905924677848816,0.002432136330753565,-0.2841091454029083,0.22303855419158936,-0.014072158373892307,-0.27926281094551086,0.19901542365550995,-0.19631358981132507,-0.1466577798128128,-0.23511864244937897,-0.11038601398468018,0.10796307772397995,0.11645868420600891,0.24383218586444855,-0.31842371821403503,0.18695612251758575},{0.17740356922149658,0.10060112178325653,0.2798122465610504,-0.15429778397083282,0.25025689601898193,-0.2071804404258728,-0.2730535864830017,0.017994171008467674,0.23919089138507843,0.12606433033943176,-0.1115654855966568,0.10525664687156677,0.04893161356449127,0.3186778128147125,0.13855694234371185,-0.05882386490702629,-0.21070730686187744,0.1289171278476715,0.03453374654054642,-0.04695770516991615,-0.049677979201078415,0.17645840346813202,0.20084764063358307,0.12087604403495789,-0.301492840051651,-0.24361853301525116,-0.2702442407608032,-0.3402650058269501,0.055010873824357986,-0.10275889188051224,0.24386829137802124,0.15571458637714386},{0.313081830739975,-0.3768605589866638,0.08449921756982803,-0.41937175393104553,-0.2891817092895508,0.3324759900569916,0.4275464713573456,0.21119095385074615,-0.09211888164281845,0.08068501204252243,0.192144513130188,-0.16127438843250275,0.062377702444791794,0.2865900993347168,-0.05420041084289551,0.19546356797218323,0.43304112553596497,-0.25306811928749084,-0.06416822969913483,-0.36851680278778076,0.2083684802055359,0.22208067774772644,0.22112224996089935,0.12330424785614014,0.14927805960178375,0.10178564488887787,0.15062353014945984,0.29039448499679565,-0.14147570729255676,-0.26691100001335144,0.27195537090301514,0.06216345354914665},{0.006760982796549797,-0.0571761429309845,0.21665561199188232,0.25983312726020813,-0.20006230473518372,-0.3476272523403168,-0.0840693861246109,0.23081353306770325,-0.1817096769809723,-0.27276724576950073,0.073739193379879,0.14015576243400574,0.11938180774450302,-0.2972913086414337,0.12644170224666595,-0.1604803502559662,-0.1996774524450302,0.15390360355377197,-0.2802276611328125,0.27910083532333374,-0.2903968095779419,-0.33538737893104553,-0.31411534547805786,0.22894743084907532,0.1311563402414322,0.11753065884113312,0.29027411341667175,0.22020941972732544,-0.15735504031181335,-0.33592239022254944,-0.14087799191474915,0.14860670268535614},{0.37192702293395996,-0.03253195062279701,0.006105357781052589,0.16750554740428925,0.054374080151319504,0.2872486412525177,-0.02618412673473358,0.2666393220424652,-0.05759366974234581,0.10407786816358566,0.11608223617076874,0.062466010451316833,-0.1043025329709053,-0.36269742250442505,0.15458178520202637,0.17145052552223206,0.060135602951049805,-0.11397796124219894,-0.037148844450712204,0.021296923980116844,0.05173570662736893,-0.2626861333847046,0.329965740442276,0.0902290940284729,-0.06415457278490067,0.0831427276134491,-0.35422906279563904,-0.21963967382907867,-0.009552361443638802,0.06049355864524841,0.11768872290849686,0.2108243852853775},{-0.08307132869958878,0.09671659767627716,-0.06282690167427063,0.20081612467765808,-0.08965697139501572,0.28807467222213745,0.08771652728319168,-0.06960425525903702,0.26210498809814453,-0.293938547372818,-0.15467201173305511,0.1585560441017151,-0.09419973194599152,0.06341008096933365,-0.2737509608268738,0.022636359557509422,0.06895561516284943,0.17727245390415192,0.09496167302131653,-0.12083278596401215,-0.27497532963752747,0.19456462562084198,0.2577667534351349,0.23054979741573334,-0.33934155106544495,0.3321594297885895,-0.15317602455615997,-0.024751853197813034,-0.1332796961069107,0.1534508913755417,0.18853625655174255,0.24880443513393402},{-0.22811473906040192,0.30590587854385376,-0.09432938694953918,0.004316391889005899,-0.22664475440979004,-0.20361974835395813,0.12377835810184479,-0.3359183073043823,-0.0052857655100524426,-0.28437167406082153,-0.221518874168396,-0.029438041150569916,0.1937992423772812,-0.257682204246521,-0.13133478164672852,-0.3362393081188202,-0.18903495371341705,-0.03913465887308121,0.27338919043540955,-0.27692854404449463,0.07631837576627731,-0.1645156443119049,0.004260677844285965,0.2941237986087799,-0.11641305685043335,0.18253345787525177,0.26345744729042053,-0.09643998742103577,-0.04882961884140968,0.2575168311595917,-0.16095487773418427,-0.32609376311302185},{-0.009999959729611874,0.2764934301376343,0.25841909646987915,-0.28442704677581787,0.2901747524738312,0.03033742681145668,-0.14412319660186768,-0.02176853083074093,0.11157569289207458,-0.2820591628551483,-0.06840319186449051,0.04184848070144653,0.2335844188928604,0.03350801393389702,0.07236150652170181,-0.02661718614399433,0.18991421163082123,-0.29412344098091125,0.35742583870887756,0.08927007019519806,-0.2059476375579834,0.19823814928531647,-0.0494384802877903,-0.2554451823234558,0.20747169852256775,-0.09532502293586731,-0.04806198552250862,-0.12297055125236511,0.07515913993120193,-0.09770704805850983,0.29559841752052307,0.26767370104789734},{0.08627695590257645,-0.25263169407844543,-0.21000881493091583,0.06114102900028229,0.05723276734352112,0.2837246358394623,-0.11575301736593246,-0.26252540946006775,0.3706633150577545,0.10405761748552322,0.006625351030379534,0.03252213075757027,-0.19312302768230438,0.09639768302440643,-0.20486728847026825,-0.3341638147830963,0.06674844771623611,0.007912391796708107,0.16198813915252686,0.3420475423336029,-0.25186416506767273,0.16869647800922394,-0.18428348004817963,0.09292291104793549,0.06153282895684242,-0.30063125491142273,-0.11033610254526138,-0.3038046956062317,-0.11442109197378159,-0.15722519159317017,0.2101152539253235,-0.31973573565483093},{-0.10307706892490387,0.34477296471595764,0.12471919506788254,-0.19176188111305237,-0.15241846442222595,-0.23176176846027374,0.14038120210170746,-0.111895851790905,0.26916933059692383,-0.05772890895605087,0.24003085494041443,0.19216172397136688,0.010634534992277622,0.10565733164548874,-0.14886893332004547,0.1685095578432083,-0.20691853761672974,-0.357168585062027,-0.29496145248413086,0.14539073407649994,0.12900468707084656,-0.24915336072444916,-0.3185037076473236,-0.20728597044944763,-0.18069277703762054,0.07885843515396118,0.3461707532405853,-0.012420624494552612,-0.1598222255706787,0.06835874170064926,-0.1603948026895523,0.08270054310560226},{-0.20999440550804138,-0.17167368531227112,-0.22774749994277954,0.07553548365831375,-0.24027672410011292,-0.1375800222158432,-0.11822088062763214,-0.12760329246520996,-0.2952176630496979,-0.22859732806682587,0.14378602802753448,0.18542058765888214,-0.2851916551589966,0.23855945467948914,-0.03871900588274002,0.18797780573368073,0.055817075073719025,-0.015735816210508347,0.02605617791414261,0.09808717668056488,0.18983472883701324,0.2920130789279938,0.10405538231134415,0.2107774168252945,0.10957825928926468,-0.2191116064786911,-0.14168816804885864,0.27054253220558167,-0.018081603571772575,-0.22333966195583344,-0.11835011839866638,-0.18656215071678162},{-0.30092981457710266,-0.2359604835510254,-0.3882303833961487,0.07756979763507843,-0.11390373855829239,-0.07547057420015335,-0.12126624584197998,0.09490213543176651,-0.029875975102186203,0.09505985677242279,-0.24811489880084991,0.021524006500840187,0.1332985758781433,-0.09865942597389221,0.012580430135130882,0.18766535818576813,-0.11851618438959122,-0.1389467567205429,0.14046932756900787,0.06582212448120117,0.20228776335716248,0.011004162020981312,-0.2715727686882019,0.06541051715612411,0.25898635387420654,-0.27226951718330383,0.1859649270772934,0.041669927537441254,0.06698770821094513,-0.16528178751468658,0.2499675154685974,-0.0569894015789032},{0.26218724250793457,-0.08326925337314606,0.05278841778635979,0.07993034273386002,-0.26809221506118774,0.016784487292170525,0.19155384600162506,0.2577132284641266,-0.10158246010541916,-0.10445939004421234,0.3135816156864166,-0.20895244181156158,-0.0542365238070488,-0.08906792104244232,-0.17169278860092163,0.22123952209949493,0.05093172937631607,-0.06970910727977753,0.13025513291358948,-0.303102970123291,0.03684687241911888,-0.30903175473213196,-0.22537527978420258,0.27647557854652405,-0.12370669841766357,-0.14017076790332794,0.1713094264268875,-0.0004414606955833733,-0.1808430552482605,0.0037532499991357327,-0.09791409969329834,-0.009607268497347832},{0.3416941463947296,-0.0530364029109478,0.09468482434749603,0.08074475824832916,-0.006166206672787666,-0.08430414646863937,0.1586769074201584,-0.24100089073181152,0.22778746485710144,0.31624624133110046,-0.010837900452315807,0.1613215059041977,0.27274712920188904,0.32364949584007263,-0.26154041290283203,-0.3104364275932312,-0.30445459485054016,0.051828183233737946,-0.13729891180992126,-0.28861483931541443,-0.20284442603588104,0.29930293560028076,0.07561682909727097,0.14085052907466888,-0.16420800983905792,-0.09479288756847382,-0.15680795907974243,-0.1934424191713333,0.27481308579444885,0.18305127322673798,-0.26816052198410034,-0.14788967370986938},{-0.12816667556762695,0.1068909615278244,0.24966999888420105,-0.1096566766500473,-0.047313906252384186,0.05391772836446762,0.01727008819580078,-0.2925702631473541,0.2244652360677719,0.26548710465431213,0.1649559736251831,0.19443270564079285,-0.2863217294216156,0.17983582615852356,-0.3307248651981354,0.24778620898723602,0.21068528294563293,-0.23129382729530334,0.215481236577034,0.10836372524499893,-0.3022027909755707,0.30769744515419006,-0.3425217866897583,0.15527746081352234,0.23751866817474365,0.2433299422264099,0.14487525820732117,0.10825931280851364,-0.21265073120594025,0.2231799215078354,-0.07334169000387192,0.14623822271823883},{-0.15979225933551788,-0.07173518091440201,-0.04390639811754227,0.2353057563304901,-0.03301089257001877,0.16291503608226776,-0.35368749499320984,-0.18825913965702057,-0.10479287803173065,-0.10090818256139755,-0.1840377300977707,-0.10266824066638947,0.06666010618209839,-0.13280688226222992,0.08259180188179016,-0.2191595435142517,0.1874140352010727,-0.04926612600684166,-0.36412063241004944,-0.2596074342727661,0.10871855914592743,0.20390771329402924,-0.2395246922969818,0.3073679804801941,-0.21882353723049164,0.13462652266025543,0.15213130414485931,-0.07321469485759735,0.13840623199939728,-0.29170048236846924,0.38387438654899597,0.10486187040805817},{0.31542739272117615,0.030421262606978416,0.08765070140361786,0.19635726511478424,-0.22094176709651947,0.1743568629026413,-0.04257667809724808,0.2157362848520279,0.1277097761631012,0.046549562364816666,0.09707926213741302,-0.3661864697933197,-0.2855749726295471,-0.013746293261647224,0.0798235684633255,-0.11987825483083725,0.2922936975955963,0.18546094000339508,-0.18634220957756042,-0.21147701144218445,0.3409055471420288,0.1852472871541977,0.2629883885383606,0.07528884708881378,-0.036765534430742264,0.017180558294057846,-0.056898850947618484,-0.17651358246803284,0.27020588517189026,0.057183269411325455,-0.2378379851579666,0.13651321828365326},{-0.04177936166524887,0.006688205059617758,-0.07042983919382095,-0.27247896790504456,-0.10331404954195023,-0.24276289343833923,-0.20876218378543854,-0.15283448994159698,0.005707207135856152,-0.030010955408215523,-0.2505413889884949,0.011464063078165054,-0.2747151851654053,-0.1678970456123352,-0.02610221691429615,0.08352770656347275,0.30074265599250793,-0.17698392271995544,-0.34950315952301025,0.26155349612236023,-0.1478387862443924,0.24924880266189575,-0.015905076637864113,-0.04094235226511955,0.0763733983039856,0.12651559710502625,-0.045544158667325974,-0.27137234807014465,0.20964191854000092,0.2479352056980133,-0.15458327531814575,0.2098812311887741},{-0.2757114768028259,0.0032663028687238693,0.05355173349380493,0.014478788711130619,0.06816264241933823,0.09452571719884872,-0.19756129384040833,0.0896926075220108,-0.20062008500099182,-0.21415561437606812,0.13604027032852173,-0.11367800086736679,-0.16532525420188904,0.26436224579811096,0.02470698580145836,0.0192867461591959,0.18724851310253143,-0.26870614290237427,-0.1494559794664383,0.26421135663986206,0.04201672971248627,0.20332352817058563,-0.022164642810821533,0.0064096697606146336,-0.28451672196388245,-0.14315566420555115,-0.0033415579237043858,0.30864718556404114,0.014172223396599293,-0.010491086170077324,0.27693191170692444,0.27563127875328064}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.0468924380838871,0.20208533108234406,0.42040324211120605,-0.09421249479055405},{0.1154170110821724,-0.08864647150039673,0.02656255103647709,0.29996874928474426},{-0.23070985078811646,0.14374230802059174,0.1568816602230072,0.20204393565654755},{0.4183575212955475,0.052637260407209396,0.04485522583127022,0.4474935531616211},{-0.05635425075888634,0.13316330313682556,0.3580942153930664,0.01790611632168293},{-0.156254380941391,0.28472042083740234,0.2681809663772583,-0.10389165580272675},{-0.37767893075942993,0.0011040193494409323,0.03710096329450607,-0.1716942936182022},{-0.39081233739852905,-0.1047394648194313,0.4209218919277191,-0.30231773853302},{0.3376591205596924,-0.13522955775260925,-0.3171095848083496,-0.4364466071128845},{0.03568953648209572,0.30545908212661743,0.37138786911964417,-0.4911017417907715},{-0.27218300104141235,-0.24925822019577026,-0.1836005300283432,0.16073784232139587},{0.42533376812934875,-0.187630757689476,-0.045374441891908646,0.23632849752902985},{0.2737003564834595,0.3151260018348694,-0.0336952731013298,0.19015507400035858},{-0.04961046576499939,0.01801791973412037,-0.30378419160842896,0.11220890283584595},{0.14363613724708557,0.31416624784469604,0.4187242388725281,0.32982829213142395},{0.15154476463794708,0.01046584639698267,0.28507936000823975,0.25894150137901306},{-0.29180848598480225,-0.13862347602844238,-0.10885358601808548,-0.3042972683906555},{-0.14220570027828217,0.2227717936038971,-0.110077403485775,-0.08590187877416611},{-0.2817130386829376,0.27584221959114075,0.21952983736991882,0.32758086919784546},{-0.04843834787607193,0.35780444741249084,-0.2015807330608368,0.16193245351314545},{-0.2872255742549896,-0.4110657572746277,-0.12215415388345718,0.05140826478600502},{0.35625508427619934,0.4226018190383911,0.022240936756134033,-0.339699923992157},{-0.012088650837540627,0.22472642362117767,0.23272071778774261,0.21806372702121735},{-0.08814507722854614,0.3904013931751251,-0.06251392513513565,-0.22820012271404266},{0.03253199905157089,-0.07577703148126602,-0.1268388032913208,-0.01955205202102661},{0.3137180805206299,-0.45283955335617065,-0.05843663215637207,0.03436940535902977},{-0.0036356323398649693,-0.39933866262435913,-0.21206097304821014,-0.30633291602134705},{0.13660383224487305,-0.23551499843597412,0.22339455783367157,0.182937890291214},{0.053447794169187546,-0.0818047896027565,0.09305483847856522,0.02871621586382389},{-0.3802729845046997,0.45062223076820374,0.20747487246990204,-0.07391563802957535},{0.3898817002773285,-0.1780446618795395,0.21490798890590668,-0.06219523772597313},{0.035226065665483475,-0.4515460133552551,0.4248470962047577,-0.23784282803535461}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.01628711260855198,0.0018966292263939977,0.020966900512576103,0.03461141139268875,-0.07450512796640396,-0.0690331757068634,0.004888982977718115,0.01868158020079136,0.06647641956806183,-0.01909535750746727,-0.025881625711917877,-0.0337352380156517,0.04294964671134949,0.004096760414540768,-0.023127693682909012,-0.03136257827281952};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.025183837860822678,0.017560668289661407,0.00016413148841820657,0.02229655534029007,0.016672110185027122,-0.013035863637924194,0.0031067361123859882,0.006171036045998335,0.00896943174302578,0.016675002872943878,0.017835328355431557,-0.004499149974435568,0.05474213883280754,-0.03534206748008728,-0.030086524784564972,-0.013704652898013592};
static const float actor_encoder_feed_forward_0_bias[32] = {0.025912784039974213,0.011556488461792469,0.018973736092448235,0.004730327520519495,0.01765280030667782,0.010827037505805492,0.006749150343239307,0.010272330604493618,-0.02219228819012642,0.008660267107188702,-0.00400238623842597,-0.0006183712393976748,0.021960949525237083,0.004975041374564171,0.01749396324157715,0.022960325703024864,-0.0058245486579835415,-0.006541953422129154,0.02057197503745556,-0.003479026723653078,-0.01952088065445423,0.00034039924503304064,0.032063551247119904,0.0075822863727808,-0.021967735141515732,0.012990670278668404,-0.027434101328253746,0.018018821254372597,0.005558901932090521,0.016079524531960487,0.016529347747564316,-0.004331112839281559};
static const float action_parameterization_distribution_linear_bias[4] = {-0.002633120631799102,0.007030839566141367,0.014533823356032372,0.008072111755609512};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.09535399079322815,0.21880604326725006,-0.22528500854969025,0.22153207659721375,0.12339315563440323,0.07045741379261017,0.32747262716293335,-0.01655225269496441},{-0.3107250928878784,-0.0524129681289196,-0.361721932888031,-0.20042413473129272,-0.36445653438568115,-0.23783528804779053,-0.04208207130432129,-0.22650425136089325},{-0.3099345564842224,0.028283879160881042,0.1713685691356659,0.253591388463974,0.26702600717544556,-0.02577175199985504,0.3972283899784088,-0.167861670255661},{-0.010134301148355007,0.1071617603302002,-0.24720259010791779,0.012944760732352734,0.051329705864191055,-0.04781697317957878,0.3712066113948822,-0.25116246938705444},{-0.3493857979774475,-0.12816864252090454,-0.3079484701156616,-0.1300031989812851,0.014272351749241352,0.19751900434494019,0.205157071352005,-0.05465853586792946},{-0.35862547159194946,-0.03260748088359833,0.3106704354286194,0.23395420610904694,0.22703105211257935,-0.08774565905332565,-0.11201963573694229,-0.14521048963069916},{-0.27983853220939636,0.020584331825375557,0.3340848386287689,-0.22397717833518982,-0.060113001614809036,-0.37961938977241516,-0.08754988759756088,-0.10530199110507965},{-0.2698933780193329,-0.3340892493724823,0.3946952819824219,-0.1340259164571762,-0.08559149503707886,0.30840057134628296,0.20256267488002777,-0.23565146327018738},{-0.31812092661857605,0.3277508616447449,-0.2794630229473114,0.29016005992889404,0.2500459551811218,-0.19011467695236206,0.04887061193585396,0.15267902612686157},{-0.34751811623573303,-0.2758544385433197,-0.2255098521709442,-0.26277583837509155,-0.4400704503059387,0.21457183361053467,0.001670358469709754,0.18208444118499756},{0.1432415097951889,0.3788226544857025,0.17024368047714233,-0.04849065840244293,0.2360132783651352,0.1906217634677887,-0.16621868312358856,0.23323947191238403},{0.18500390648841858,0.05630577728152275,0.24238458275794983,0.2493157535791397,-0.3268502354621887,0.305268257856369,0.03992847725749016,-0.21839533746242523},{0.11349114030599594,-0.3207762539386749,0.26144224405288696,-0.03704250231385231,-0.40457841753959656,-0.10209441184997559,-0.1340680867433548,-0.09973671287298203},{-0.18596620857715607,-0.24215354025363922,0.32963305711746216,0.35612741112709045,-0.28822755813598633,-0.08414565026760101,-0.24965199828147888,0.24174486100673676},{0.11247581988573074,-0.14669765532016754,0.13456590473651886,-0.23340420424938202,-0.30178114771842957,-0.13410694897174835,0.3242010474205017,0.005125279538333416},{0.2514515519142151,0.027386946603655815,0.013306948356330395,-0.25292912125587463,0.05178048834204674,0.057572945952415466,0.2299942672252655,0.3455601632595062},{0.02384534291923046,-0.29884493350982666,-0.17752642929553986,0.13461200892925262,-0.22189684212207794,-0.15742476284503937,-0.08664499968290329,0.14128944277763367},{-0.13691037893295288,-0.340009480714798,0.017203785479068756,0.07212726026773453,0.11055023223161697,-0.20939165353775024,0.363216757774353,0.2149629294872284},{0.03591546416282654,0.06925484538078308,-0.28493088483810425,0.1513337790966034,0.10894428938627243,0.1805146336555481,-0.23026159405708313,0.4184608459472656},{0.16112032532691956,-0.05205772817134857,-0.39653658866882324,0.12415715306997299,-0.0553722083568573,-0.041315607726573944,-0.30238640308380127,0.04550080746412277},{0.09808170050382614,-0.13076123595237732,0.040916558355093,-0.06719135493040085,0.3448871672153473,0.03645298257470131,0.008183440193533897,0.43193480372428894},{0.05947870388627052,0.14185287058353424,-0.266584575176239,0.3266814053058624,0.35697323083877563,0.3187696635723114,0.2678864300251007,-0.32129737734794617},{-0.387268602848053,-0.11513248831033707,0.18664254248142242,-0.0018832142231985927,0.17427444458007812,-0.33537617325782776,0.33005595207214355,-0.29998505115509033},{-0.17865516245365143,0.02793601155281067,-0.03114369511604309,-0.30943089723587036,0.15652485191822052,-0.08328971266746521,-0.24402697384357452,0.16507889330387115},{-0.28188395500183105,-0.18881596624851227,0.0570925809442997,0.1037132516503334,-0.18224506080150604,0.05043337121605873,0.362774521112442,-0.12899018824100494},{-0.2634733021259308,0.059431292116642,-0.3687661588191986,-0.2933904826641083,0.12010562419891357,-0.012932099401950836,-0.029216596856713295,0.08119560778141022},{0.2779144048690796,0.3924309015274048,-0.3140328824520111,0.1697739213705063,0.20637300610542297,0.381542831659317,-0.2354612797498703,-0.12914565205574036},{0.31391656398773193,0.25899243354797363,0.038890983909368515,0.06918440014123917,0.27640214562416077,0.19637401401996613,0.3232618272304535,0.38753026723861694},{-0.20453369617462158,0.39716044068336487,0.16223378479480743,0.014398089610040188,0.19742992520332336,0.034381523728370667,-0.27836403250694275,-0.29372334480285645},{-0.28702691197395325,-0.21481312811374664,0.08716905862092972,-0.24136844277381897,-0.33882638812065125,-0.1860179603099823,0.3692341446876526,-0.05410868674516678},{0.29861950874328613,-0.25534358620643616,0.3318098783493042,-0.3054559826850891,0.0015955950366333127,0.2219586819410324,0.2361731082201004,-0.2392168939113617},{0.1171647235751152,0.36887413263320923,0.3694002330303192,-0.23739397525787354,-0.28640487790107727,0.04375945404171944,0.22328750789165497,0.09614678472280502}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.0005992187652736902,0.48396462202072144,-0.2102862298488617,0.22834528982639313,-0.4262002110481262,0.3236154317855835,0.35285747051239014,0.08365780860185623},{-0.5018707513809204,-0.4308481216430664,-0.4142427146434784,-0.48318374156951904,-0.5210105776786804,0.4411841630935669,0.40201282501220703,-0.3845207989215851},{0.06894631683826447,-0.20946155488491058,0.1460292935371399,0.13960349559783936,-0.049660760909318924,0.47051188349723816,-0.3695850968360901,-0.4764822721481323},{0.5207909345626831,0.06352406740188599,0.07240572571754456,0.036063071340322495,0.552749752998352,0.3747865557670593,0.4177887439727783,0.4545033872127533},{0.10421445965766907,0.233851358294487,-0.16981913149356842,-0.28973183035850525,0.08483720570802689,-0.4913366734981537,-0.4555472135543823,0.635381817817688},{0.426358699798584,0.02266339585185051,0.0483233742415905,-0.414795458316803,-0.4909365475177765,-0.5379245281219482,-0.13931865990161896,0.4237695336341858},{-0.47689974308013916,-0.3820782005786896,-0.0774892047047615,-0.27316999435424805,-0.004698892589658499,0.5127004981040955,-0.5687045454978943,0.5250424742698669},{0.25852546095848083,0.12318405508995056,-0.004850097466260195,0.07647570222616196,0.4485321044921875,-0.5697501301765442,0.45862677693367004,-0.3672507107257843}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.061158325523138046,0.021747568622231483,0.021136028692126274,-0.01110976655036211,-0.05064631253480911,0.01685236766934395,0.045442357659339905,0.013977404683828354};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.005831942427903414,-0.025795828551054,-0.0024549514055252075,0.014546443708240986,-0.004099429119378328,-0.008473181165754795,0.002761189127340913,-0.06616197526454926};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

