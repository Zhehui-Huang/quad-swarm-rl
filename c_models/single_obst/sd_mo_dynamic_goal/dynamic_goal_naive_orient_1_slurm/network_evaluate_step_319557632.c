#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3185324966907501,-0.20347954332828522,0.33055517077445984,0.17998561263084412,-0.36869218945503235,0.15058229863643646,0.0008519123075529933,-0.21988032758235931,0.06820946931838989,0.45181095600128174,0.11330369114875793,0.027037816122174263,0.1744300127029419,-0.1820795089006424,0.3479384481906891,-0.10655850172042847},{-0.38382160663604736,-0.2859460711479187,0.26971563696861267,0.19959083199501038,-0.2234533280134201,0.014250112697482109,-0.371941477060318,0.05620952695608139,-0.1869964897632599,-0.13101808726787567,0.1587591916322708,-0.1559828519821167,0.23492617905139923,-0.40991029143333435,-0.19287827610969543,0.08990304917097092},{0.14359164237976074,-0.2511284053325653,-0.2594245970249176,0.07253991812467575,0.13973954319953918,0.1550121009349823,-0.06852347403764725,0.008195141330361366,-0.12254579365253448,-0.1850346028804779,-0.19501318037509918,0.40625256299972534,-0.010888776741921902,-0.17767052352428436,-0.3837713301181793,0.22726254165172577},{0.1505921185016632,0.16686104238033295,0.3414890468120575,-0.07340101897716522,-0.332584023475647,-0.03818124160170555,0.16750018298625946,0.13970348238945007,0.49376794695854187,-0.38337242603302,0.026414798572659492,0.16413241624832153,-0.2926219701766968,-0.058593910187482834,0.3434120714664459,-0.3995906710624695},{-0.03490395471453667,0.09509024024009705,0.24307790398597717,-0.11861201375722885,0.23393884301185608,0.2631075084209442,0.23284566402435303,-0.05986574664711952,-0.0560198575258255,0.23017850518226624,0.3133634328842163,-0.1514759659767151,-0.1091199517250061,-0.3286843001842499,0.4067031145095825,0.15369729697704315},{0.004945793654769659,-0.19405734539031982,-0.12355586886405945,-0.23416851460933685,0.117063008248806,0.03490390628576279,-0.041913703083992004,-0.15588438510894775,0.17102962732315063,-0.22773750126361847,-0.30197781324386597,0.19995328783988953,0.4299561679363251,-0.0015899084974080324,-0.04503622651100159,0.13365231454372406},{-0.07959368824958801,-0.03524896502494812,0.07225698232650757,-0.21018965542316437,0.2158990353345871,0.04932582750916481,0.08122726529836655,0.3091166317462921,0.2984967827796936,0.010963493026793003,-0.32121047377586365,0.21191346645355225,-0.09955980628728867,0.21393130719661713,-0.180395245552063,-0.23011349141597748},{-0.046637143939733505,-0.009250364266335964,0.265491783618927,0.19485142827033997,-0.4090215861797333,0.005289045162498951,0.30362579226493835,0.2997637689113617,-0.09812594950199127,0.19598020613193512,-0.4999984800815582,-0.3038681745529175,0.2176959067583084,0.3056073784828186,0.22423775494098663,0.17967204749584198},{0.30934563279151917,-0.22845718264579773,0.3428303301334381,-0.05137237161397934,0.19834356009960175,0.11372490227222443,-0.19354309141635895,-0.23884956538677216,0.1159050464630127,-0.32385769486427307,0.05130678787827492,-0.2938176691532135,-0.19157642126083374,0.3138372004032135,0.1521429717540741,-0.09879211336374283},{0.0714011862874031,-0.33619752526283264,-0.49117839336395264,-0.023484503850340843,-0.29695531725883484,0.24021536111831665,0.3968941271305084,0.2067505419254303,0.466817706823349,0.3587029278278351,0.017864257097244263,-0.2866755425930023,0.10890050232410431,0.27855896949768066,-0.0844622328877449,-0.37554603815078735},{0.03527260571718216,0.22793987393379211,0.4209854006767273,-0.30592525005340576,-0.28887510299682617,0.22346383333206177,0.15766289830207825,0.37294453382492065,-0.311031311750412,-0.020861336961388588,-0.018830398097634315,0.16848942637443542,-0.3104175627231598,-0.18537628650665283,0.335470050573349,-0.353758841753006},{0.13898427784442902,-0.15579959750175476,-0.01968235895037651,0.1643608808517456,0.331500381231308,0.30106985569000244,0.453691303730011,-0.03393952175974846,0.008896835148334503,-0.025224905461072922,0.262914776802063,-0.14147214591503143,-0.08599493652582169,-0.22596153616905212,0.22684462368488312,0.26589521765708923},{-0.14919611811637878,0.2989814877510071,0.1299576461315155,-0.2978208065032959,0.05688067525625229,0.13851039111614227,0.3196278214454651,-0.05391843244433403,0.14207296073436737,-0.0015488143544644117,-0.07774859666824341,0.12455520033836365,0.18450917303562164,0.30447787046432495,0.14483948051929474,-0.2562313973903656},{-0.2296677529811859,-0.21277479827404022,-0.20372138917446136,-0.031773779541254044,-0.1874570995569229,0.0922015905380249,-0.3605338931083679,0.10262211412191391,-0.07198251783847809,-0.045588187873363495,-0.27688777446746826,-0.059088993817567825,-0.33166274428367615,0.10083689540624619,0.2615819573402405,0.12372522801160812},{-0.16931237280368805,-0.40570446848869324,-0.226309671998024,0.36756089329719543,0.08754021674394608,-0.3373110592365265,0.29220816493034363,-0.09851221740245819,-0.01820840872824192,0.30883219838142395,0.08652402460575104,0.1816311627626419,0.19215704500675201,-0.024447854608297348,-0.18315936625003815,0.18609438836574554},{0.4990834593772888,-0.06095120310783386,-0.25628796219825745,-0.3666512370109558,-0.5777202844619751,0.3039705157279968,0.4073133170604706,-0.28576573729515076,0.1611071527004242,0.0987916812300682,-0.3070196807384491,0.05656372383236885,-0.5277923345565796,0.5376264452934265,-0.29451966285705566,0.01421684306114912},{-0.3896685838699341,-0.3979710042476654,0.39709728956222534,0.4014125466346741,-0.33109039068222046,0.33178526163101196,-0.07788174599409103,-0.33154088258743286,0.2801743149757385,-0.4474102854728699,-0.3571363389492035,-0.6856856942176819,-0.2639968991279602,-0.4468810260295868,-0.015631061047315598,-0.20191147923469543},{-0.44123929738998413,0.24596425890922546,-0.508620023727417,-0.04447587952017784,0.026087181642651558,0.33185356855392456,-0.3432583808898926,-0.40497344732284546,0.21737153828144073,0.24034276604652405,0.41413596272468567,-0.057149555534124374,-0.2423401176929474,0.2934057414531708,0.16261842846870422,-0.4829570949077606}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.11618301272392273,-0.10741286724805832,-0.17833800613880157,-0.4151397943496704,0.40454819798469543,0.2810644805431366,0.06266644597053528,0.10293236374855042,-0.2756538987159729,-0.10120145976543427,-0.10386435687541962,-0.002158577786758542,0.23565560579299927,0.5000102519989014,0.15336796641349792,0.07912050187587738},{-0.19377897679805756,-0.2657264471054077,-0.024711523205041885,0.14205068349838257,0.2950536012649536,-0.259752482175827,0.16529077291488647,0.044236455112695694,-0.07461259514093399,0.24327358603477478,-0.13834437727928162,0.35622307658195496,-0.36368077993392944,0.22562319040298462,-0.3640190064907074,-0.25745338201522827},{0.14906714856624603,0.2374187856912613,-0.39333754777908325,-0.5763726234436035,0.1556854546070099,0.4683954119682312,-0.09297990798950195,0.1200120821595192,-0.2642401158809662,-0.22801026701927185,-0.016833392903208733,0.27203354239463806,-0.31364700198173523,-0.2899569272994995,0.15967312455177307,-0.05247914046049118},{0.20652443170547485,-0.04636221379041672,0.08445239067077637,0.17229090631008148,-0.48933008313179016,0.030299203470349312,0.018683040514588356,-0.2704925537109375,0.3408338725566864,0.36562809348106384,-0.12261679768562317,-0.1893131285905838,-0.39582929015159607,-0.3698367774486542,0.21912002563476562,0.22314424812793732},{-0.17181092500686646,0.05332739278674126,0.05537687614560127,0.29411056637763977,-0.2343880981206894,0.012742072343826294,-0.02570529095828533,0.20252053439617157,0.22994373738765717,-0.285244345664978,0.053645119071006775,0.4154377281665802,0.1474204808473587,-0.4011743366718292,-0.07481471449136734,-0.10479535907506943},{0.2509601414203644,0.2248447686433792,-0.0159104336053133,0.17788496613502502,-0.37208327651023865,-0.4007962644100189,0.2722330689430237,0.2880326509475708,0.11487901210784912,0.49561822414398193,0.27072590589523315,-0.28124532103538513,0.03745526820421219,-0.14971019327640533,-0.047445762902498245,0.3435952663421631},{-0.02291696146130562,0.16063490509986877,0.3509999215602875,-0.3679255247116089,-0.16273705661296844,0.0649581179022789,-0.3081192970275879,-0.06116705387830734,0.08047924935817719,0.10319484770298004,-0.14485543966293335,-0.28883376717567444,-0.2833043336868286,0.06511764228343964,0.2095152586698532,0.07688143104314804},{-0.1911226511001587,-0.1674538254737854,-0.4162925183773041,0.27352437376976013,-0.2937152087688446,-0.3206598162651062,-0.18928080797195435,-0.3433729112148285,0.025824708864092827,-0.21911898255348206,-0.12201888114213943,0.18068617582321167,-0.23603133857250214,0.40370386838912964,-0.12676726281642914,-0.39864039421081543},{-0.24261252582073212,0.2829919755458832,0.008375449106097221,-0.03410770371556282,0.3111802637577057,-0.21304619312286377,0.39717966318130493,0.12018772214651108,0.2773076295852661,0.38516899943351746,0.2982441186904907,0.28621214628219604,0.2619791328907013,-0.042647626250982285,0.31094443798065186,0.13684187829494476},{0.12563471496105194,-0.28782373666763306,-0.017188096418976784,-0.13718482851982117,0.3154478967189789,-0.055273182690143585,-0.2834106385707855,-0.22906683385372162,0.05852795019745827,-0.46762585639953613,-0.19130191206932068,0.203062504529953,0.1434125155210495,0.17937666177749634,-0.3333837687969208,0.27111583948135376},{-0.17364805936813354,-0.352327436208725,0.47634172439575195,0.24267323315143585,0.21458591520786285,0.16446295380592346,0.12834873795509338,-0.15746483206748962,0.14466015994548798,-0.22249747812747955,0.029244214296340942,0.42817288637161255,0.35934320092201233,0.13877452909946442,-0.21501773595809937,0.007726045325398445},{0.023527121171355247,-0.17817223072052002,0.29255473613739014,0.03028840385377407,-0.12565593421459198,-0.2147575467824936,0.45700955390930176,0.2806212306022644,-0.26081815361976624,-0.3941620886325836,-0.12306244671344757,-0.3187536895275116,0.004225484095513821,-0.3171112835407257,-0.3682315945625305,-0.007351696491241455},{-0.042352136224508286,-0.31577083468437195,0.3113413155078888,-0.20983317494392395,0.2990513741970062,-0.3139565885066986,-0.3831651508808136,0.1711033582687378,0.11250120401382446,-0.034836217761039734,-0.29085415601730347,0.09701237082481384,0.07293344289064407,-0.3174934387207031,-0.37835797667503357,-0.01979837752878666},{0.31729328632354736,-0.30851098895072937,0.4719233214855194,0.14602267742156982,0.05963517725467682,0.2926812469959259,-0.07038296014070511,-0.2176123708486557,-0.530382513999939,0.11355915665626526,0.021397123113274574,-0.39298269152641296,0.011118859052658081,0.26034754514694214,0.32987305521965027,0.06311226636171341},{-0.23959481716156006,0.15595166385173798,0.10579689592123032,-0.32356101274490356,-0.22862988710403442,0.06294376403093338,0.2545139491558075,-0.13888542354106903,0.1669633537530899,-0.3830842673778534,0.0008729687542654574,0.052401602268218994,-0.03951595723628998,0.07103206217288971,-0.07989156991243362,-0.0031319144181907177},{-0.1816376894712448,0.31600329279899597,-0.33500489592552185,0.3170323073863983,0.1777314692735672,-0.37186112999916077,-0.1460815668106079,-0.06897953152656555,-0.42189276218414307,0.2830846905708313,-0.4118683338165283,0.3120855987071991,-0.08144121617078781,-0.15606795251369476,-0.2689664661884308,-0.5327979922294617}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1752295345067978,0.019602946937084198,-0.07723680883646011,-0.026889750733971596,-0.11564142256975174,0.003578907111659646,0.2980200946331024,0.0239221453666687,-0.11583539098501205,-0.16930948197841644,0.10217773169279099,-0.3156415820121765,-0.22103825211524963,0.21846473217010498,0.20073923468589783,0.27797093987464905,-0.2724306583404541,-0.3173521161079407,-0.2387155145406723,0.0366070382297039,-0.027971705421805382,-0.3608051538467407,-0.2272729128599167,-0.28176450729370117,-0.3085646331310272,0.2317882776260376,-0.2552938163280487,-0.04883270338177681,-0.012593020685017109,-0.015231102705001831,0.18530847132205963,-0.15433251857757568},{0.24849602580070496,0.22406509518623352,0.11973151564598083,-0.0774819478392601,0.1123834103345871,-0.07707976549863815,0.29670801758766174,0.1093096062541008,-0.20850440859794617,-0.14176198840141296,-0.05574401095509529,-0.2849228084087372,-0.17439986765384674,0.20284982025623322,-0.19792993366718292,-0.32760506868362427,-0.04473855346441269,0.1617412269115448,-0.35289525985717773,-0.30236685276031494,-0.004263754468411207,0.26685553789138794,0.1378389149904251,-0.1151389554142952,0.13372661173343658,-0.268812358379364,0.018263690173625946,0.1102161854505539,0.20414403080940247,-0.1349019557237625,-0.027685796841979027,0.24228312075138092},{0.2315949648618698,0.06999026983976364,-0.06074902415275574,0.15077781677246094,-0.19534380733966827,-0.1915367841720581,-0.2658472955226898,0.1362331658601761,-0.113968126475811,0.380138099193573,-0.28813064098358154,-0.1810768097639084,0.13695071637630463,-0.38930651545524597,-0.15222930908203125,0.10812520980834961,-0.14924076199531555,-0.15670666098594666,0.2699044346809387,-0.04432254284620285,0.24728773534297943,0.22506597638130188,-0.25577840209007263,0.03529199957847595,-0.19952988624572754,-0.09739397466182709,0.146769180893898,-0.1081114336848259,-0.0467185340821743,-0.16276443004608154,-0.09521394968032837,-0.08914162218570709},{0.3353770971298218,0.08985103666782379,0.0904015302658081,-0.12620757520198822,-0.2704817056655884,-0.07254254072904587,-0.16085655987262726,0.26444748044013977,0.24283434450626373,-0.22623345255851746,-0.07970861345529556,0.30055585503578186,0.09055832773447037,-0.1453534960746765,-0.21147967875003815,0.3125746548175812,-0.31108686327934265,0.22868458926677704,0.009162530303001404,0.05998935550451279,-0.05227905884385109,-0.10442423820495605,0.285589337348938,0.15401144325733185,0.1731737107038498,-0.32887616753578186,0.3367435038089752,-0.2017679065465927,-0.013403015211224556,0.03830203786492348,-0.2888874113559723,0.17163336277008057},{-0.02938905730843544,-0.05019567906856537,-0.07481607049703598,0.06364502757787704,0.19066087901592255,-0.18840336799621582,-0.37512877583503723,-0.017004504799842834,-0.13237763941287994,-0.18757137656211853,0.1416008174419403,0.23421238362789154,-0.057512879371643066,-0.08512072265148163,-0.08814109861850739,0.20590397715568542,-0.06141580641269684,-0.015795612707734108,-0.32843419909477234,-0.058826375752687454,-0.1604016125202179,-0.37058311700820923,0.16551339626312256,0.22956186532974243,-0.07691357284784317,0.2903677821159363,-0.17973552644252777,0.20448720455169678,0.299750953912735,0.36805835366249084,-0.026554986834526062,0.3052152991294861},{-0.2373603731393814,-0.0968831479549408,-0.16399702429771423,-0.05092614144086838,-0.16119137406349182,0.22707867622375488,0.21067820489406586,0.0248898696154356,0.3106275498867035,0.15588170289993286,0.293874055147171,-0.22789447009563446,-0.17753072082996368,0.23240478336811066,0.2887488007545471,-0.35500892996788025,-0.12363158166408539,-0.248748317360878,0.21606193482875824,0.11074822396039963,0.09439653903245926,0.12518003582954407,0.0248696431517601,-0.03219150751829147,-0.37474602460861206,0.33163341879844666,-0.21194493770599365,0.14408926665782928,0.3616226017475128,0.20963262021541595,0.06308059394359589,0.07024351507425308},{0.18331976234912872,-0.1275729238986969,-0.1405843198299408,-0.34709885716438293,-0.013835698366165161,0.21794256567955017,0.2754966914653778,0.13454991579055786,0.09733016043901443,0.3340044617652893,-0.006631649564951658,0.0007296436815522611,-0.3997199237346649,-0.14234893023967743,-0.15653811395168304,0.05251913517713547,-0.29750922322273254,-0.22217302024364471,0.17170654237270355,-0.08964044600725174,-0.1153276339173317,-0.14190714061260223,-0.2180326133966446,-0.2514071464538574,0.19400420784950256,-0.2685433328151703,-0.11147955805063248,-0.217777818441391,0.33797699213027954,0.11023228615522385,-0.17833654582500458,-0.2828020751476288},{0.05516650900244713,0.1855919510126114,0.03658491373062134,-0.1303308606147766,0.14692938327789307,-0.30809906125068665,-0.05251314118504524,-0.17198868095874786,-0.004416110459715128,-0.25829100608825684,-0.3165324032306671,-0.10783766955137253,-0.12323842942714691,0.054981909692287445,-0.14394590258598328,0.3997036814689636,-0.012177305296063423,-0.14956387877464294,0.10357172042131424,0.328727662563324,-0.18364983797073364,-0.18894663453102112,0.29900458455085754,0.08040229976177216,4.2442974518053234e-05,-0.32917773723602295,-0.32780274748802185,-0.22392277419567108,-0.3821246027946472,-0.277351975440979,0.08585727214813232,-0.37311774492263794},{0.0323370061814785,0.4637730121612549,-0.4100952744483948,-0.381283700466156,-0.32310956716537476,0.15842638909816742,0.06544332206249237,0.14635536074638367,0.009492388926446438,-0.2540512681007385,-0.1273769736289978,0.30439862608909607,-0.4093545079231262,-0.24198611080646515,0.23374687135219574,-0.22533942759037018,0.2271277755498886,0.1437739133834839,0.3675387501716614,0.05208277329802513,0.1831861138343811,0.20549388229846954,0.38577425479888916,-0.1621241569519043,0.4654069244861603,-0.21678830683231354,0.2737569808959961,0.4067496061325073,-0.1670542061328888,0.10193714499473572,0.045699454843997955,0.10325907170772552},{-0.2742374837398529,0.09601808339357376,-0.4021008610725403,-0.1830090433359146,0.12271464616060257,-0.2536095380783081,0.14624886214733124,-0.05182245001196861,0.19930541515350342,0.12346536666154861,-0.28632327914237976,-0.38838157057762146,-0.4490657150745392,-0.11687116324901581,-0.2663570046424866,0.10311710089445114,-0.05486884340643883,-0.26586127281188965,0.13518957793712616,0.054159387946128845,0.08582571893930435,-0.01724107190966606,0.40645745396614075,-0.1905769258737564,0.32100632786750793,0.20003418624401093,-0.2552526593208313,0.03109668754041195,0.010727406479418278,-0.004867449402809143,-0.24535538256168365,0.13432924449443817},{0.08905211091041565,0.014837093651294708,0.13389812409877777,-0.3097706735134125,-0.28480279445648193,-0.22522330284118652,-0.2477186918258667,-0.045075468719005585,-0.2018948793411255,0.36865925788879395,0.14390933513641357,-0.2861989736557007,-0.36804813146591187,-0.05300481617450714,-0.21860411763191223,-0.13768194615840912,0.21578973531723022,-0.15115860104560852,0.2641938030719757,-0.21131597459316254,-0.19821901619434357,0.054183777421712875,0.21642296016216278,0.1680791676044464,0.2092493176460266,-0.15339797735214233,-0.031197644770145416,-0.052100542932748795,-0.044770386070013046,-0.014427842572331429,-0.06870780885219574,0.1603521853685379},{-0.2086678147315979,-0.037967853248119354,0.2232290655374527,0.2925705015659332,0.26244398951530457,0.008329289965331554,0.08163366466760635,-0.20145854353904724,-0.11289708316326141,-0.207375630736351,0.29309773445129395,-0.2430782914161682,-0.2108745127916336,-0.19023959338665009,0.28682348132133484,0.02740289829671383,-0.00012989816605113447,0.041769374161958694,0.35264852643013,0.0942307859659195,-0.20629194378852844,0.2682046890258789,0.11731306463479996,-0.07778385281562805,0.22989201545715332,-0.12401244789361954,-0.13087958097457886,0.24964484572410583,0.1950719654560089,-0.023814676329493523,-0.25753262639045715,-0.2842061519622803},{0.24376636743545532,-0.25294145941734314,-0.013799051754176617,-0.3296329379081726,0.10867585986852646,-0.12237007915973663,0.15133926272392273,0.07521286606788635,0.2704082727432251,0.10319384187459946,0.12138310074806213,0.2047983556985855,-0.359921395778656,-0.2833109200000763,-0.09180311113595963,-0.22642654180526733,-0.1771257221698761,-0.240726038813591,0.2633659839630127,-0.2360525131225586,0.3045707046985626,-0.03669114410877228,-0.006209329701960087,0.18893255293369293,0.12924399971961975,-0.09627556800842285,0.11175914853811264,0.10030435025691986,0.15011684596538544,-0.0721176415681839,-0.26051971316337585,-0.06780717521905899},{0.2342938780784607,-0.08510418236255646,-0.032013311982154846,0.42405587434768677,-0.10108687728643417,-0.2309778779745102,-0.05753877013921738,0.0860995277762413,0.21343733370304108,0.33469462394714355,0.09495650976896286,-0.1541811227798462,0.0781993418931961,0.2182738184928894,-0.11380152404308319,0.06053299084305763,0.19193649291992188,-0.24642029404640198,0.03859696164727211,-0.347272664308548,0.3385346531867981,0.1125839576125145,-0.09883997589349747,0.20279547572135925,0.17187635600566864,0.11902887374162674,0.06838084012269974,0.01873595640063286,0.08339879661798477,-0.14954881370067596,-0.06153962388634682,0.40651604533195496},{0.008410651236772537,-0.2722630798816681,-0.08991507440805435,0.11790530383586884,-0.24734064936637878,-0.0058828843757510185,0.0595565065741539,-0.2886946499347687,-0.1448204666376114,-0.03697429969906807,0.17653140425682068,0.12235261499881744,0.0830693244934082,0.2576710879802704,-0.06049484387040138,-0.10295945405960083,-0.22806045413017273,0.2715003490447998,-0.13384123146533966,-0.3009829819202423,-0.18589869141578674,-0.07711481302976608,0.19066788256168365,-0.010302849113941193,-0.061791516840457916,-0.050119951367378235,-0.22733083367347717,0.22124138474464417,0.07791032642126083,-0.1968480944633484,0.21877421438694,0.19991853833198547},{0.1263822317123413,-0.20715917646884918,-0.12246628105640411,-0.18494360148906708,-0.12927694618701935,0.1318584680557251,0.04126644879579544,0.22770127654075623,-0.11066170036792755,0.06290638446807861,0.24981126189231873,0.10351454466581345,-0.06708045303821564,-0.15952494740486145,0.030207592993974686,0.14877347648143768,-0.458274781703949,-0.2882973849773407,-0.07494257390499115,0.03901546448469162,0.1335671991109848,0.23851020634174347,0.30960044264793396,0.13655909895896912,0.05385170504450798,0.22288058698177338,0.02198908105492592,-0.08833897858858109,0.20288687944412231,-0.1472184956073761,-0.2959330379962921,0.3866921067237854},{0.18954642117023468,0.00833163782954216,-0.25446817278862,0.1644769012928009,0.09038032591342926,-0.03225124254822731,0.2731492817401886,0.12098176032304764,0.109391950070858,-0.2220843881368637,0.22323279082775116,-0.1791885942220688,-0.3880501091480255,0.24476128816604614,0.05753406882286072,0.06554710865020752,0.07286176085472107,-0.042555276304483414,-0.12596899271011353,0.05274681746959686,-0.07838805019855499,0.20963676273822784,0.06311002373695374,-0.14904120564460754,0.04544472694396973,-0.27315613627433777,0.03369547054171562,0.42381685972213745,0.2454979419708252,-0.13705244660377502,0.22466066479682922,0.1939130276441574},{-0.019177164882421494,-0.023531856015324593,-0.08149708807468414,-0.039190810173749924,-0.25830864906311035,-0.045967184007167816,0.18048983812332153,0.21676358580589294,0.13529455661773682,-0.013949682004749775,0.2369471788406372,0.036224618554115295,0.20826666057109833,0.14371657371520996,0.16865995526313782,-0.07282394170761108,0.12085431069135666,0.1672847867012024,0.2713373005390167,0.09530254453420639,0.19758926331996918,0.23378443717956543,0.06851951032876968,0.1416793167591095,0.004461671691387892,-0.11936359852552414,-0.08978110551834106,-0.25644248723983765,0.16988863050937653,-0.2202654778957367,0.03956703841686249,-0.025462239980697632},{-0.3457961678504944,0.0981055349111557,-0.3146296441555023,-0.3438321352005005,-0.010611481964588165,0.06010982021689415,0.13631907105445862,-0.13355174660682678,0.004620353225618601,0.3116207718849182,0.06614053249359131,-0.2294163852930069,0.031010247766971588,-0.16201908886432648,-0.31042492389678955,-0.023655502125620842,-0.178933247923851,0.13940860331058502,-0.031467195600271225,-0.0750199481844902,-0.3264177143573761,0.19277605414390564,0.13048438727855682,0.027123896405100822,-0.01767953485250473,0.29730138182640076,0.016495931893587112,-0.12697912752628326,-0.17219197750091553,-0.0017862835666164756,-0.1592550128698349,-0.25900354981422424},{-0.0018635592423379421,-0.21806377172470093,-0.2417801469564438,-0.019472356885671616,-0.36324700713157654,-0.17110669612884521,0.16036751866340637,-0.2893106937408447,-0.20763978362083435,0.19960106909275055,0.15065985918045044,0.11932813376188278,0.12202493101358414,-0.12034574151039124,0.3167329728603363,-0.3162805438041687,0.055158860981464386,0.21760332584381104,0.053351376205682755,0.23959685862064362,0.058358918875455856,-0.13145966827869415,-0.27888309955596924,0.19854050874710083,-0.17581088840961456,-0.15730343759059906,0.0989251509308815,0.016379958018660545,-0.11102516949176788,-0.30228090286254883,-0.05287519842386246,-0.13153104484081268},{0.22906309366226196,0.18059776723384857,-0.08157460391521454,0.14777514338493347,-0.28253012895584106,0.1663053333759308,-0.050009433180093765,-0.13626208901405334,-0.19522032141685486,0.21142040193080902,-0.26621249318122864,-0.1608213484287262,-0.04584088176488876,-0.18131229281425476,-0.3732282817363739,-0.12611150741577148,-0.09236567467451096,-0.2676195502281189,-0.2287217676639557,0.3035631775856018,0.09219890832901001,0.12714870274066925,-0.32646429538726807,0.3467496931552887,0.1958981454372406,0.25353479385375977,-0.2805173099040985,-0.029845329001545906,0.06385353207588196,-0.27149122953414917,0.11826319992542267,0.08463957160711288},{0.018063336610794067,-0.3355625569820404,0.03152947500348091,-0.2933233380317688,-0.05805101990699768,0.25331851840019226,0.1840144693851471,0.025267088785767555,-0.024362318217754364,0.001070775673724711,-0.23098237812519073,0.15777701139450073,0.1730165332555771,0.1141650602221489,0.13097402453422546,0.01984132081270218,-0.06591419875621796,0.1329592913389206,-0.1096038669347763,0.18114863336086273,0.21427355706691742,0.22555096447467804,-0.10017650574445724,-0.23057472705841064,0.11588018387556076,0.09783852100372314,0.2460029572248459,0.12248831242322922,-0.04229738190770149,0.19506074488162994,0.040458425879478455,-0.11586630344390869},{0.027297627180814743,-0.18321965634822845,0.2476644366979599,-0.0030621420592069626,0.2994946241378784,-0.03013903647661209,-0.11785819381475449,-0.16507381200790405,0.14489562809467316,-0.06334914267063141,0.07016409188508987,0.006369551178067923,-0.2534621059894562,0.022443965077400208,-0.09728185087442398,-0.25411561131477356,-0.04879552498459816,-0.04745253175497055,0.21355940401554108,0.25486668944358826,0.028438294306397438,0.04164843261241913,0.1796109527349472,0.34515637159347534,-0.16129522025585175,-0.08182201534509659,0.21056310832500458,-0.11187312752008438,-0.21645162999629974,-0.23714891076087952,0.3029496967792511,-0.006314728409051895},{0.18600118160247803,-0.053348831832408905,0.041779499500989914,0.14643661677837372,-0.0433436781167984,0.07962074130773544,-0.2826671898365021,0.2710629105567932,-0.10099788010120392,-0.0585373155772686,0.12261009961366653,-0.27125000953674316,-0.005252784118056297,-0.03185824304819107,-0.07943978160619736,0.2574605345726013,-0.07112368941307068,-0.19423694908618927,0.04312290623784065,-0.03945591300725937,-0.16582518815994263,0.21713384985923767,0.2365904152393341,0.1879422813653946,-0.30045217275619507,0.13318811357021332,-0.0579511858522892,0.10056982189416885,-0.27192452549934387,0.29088491201400757,-0.017183326184749603,0.06288985908031464}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.24087345600128174,-0.10568110644817352,0.13752464950084686,-0.172947496175766},{0.21207988262176514,-0.3443172574043274,0.2858569622039795,0.26717785000801086},{-0.3174903988838196,0.1150716096162796,0.08355432748794556,-0.012873610481619835},{0.2643824815750122,0.5217664241790771,0.3752295970916748,0.04136697202920914},{-0.2828500270843506,0.15627039968967438,-0.332792729139328,0.09603734314441681},{-0.08084198832511902,-0.08442747592926025,0.08143895119428635,0.4488050043582916},{-0.1073160320520401,-0.11017491668462753,-0.39265182614326477,0.005616731941699982},{-0.17446722090244293,-0.2654530107975006,0.22281505167484283,-0.06502372771501541},{-0.08869454264640808,0.12109292298555374,-0.09686499834060669,-0.13822759687900543},{0.2728957533836365,0.038245897740125656,-0.12445150315761566,-0.24304772913455963},{0.18171732127666473,-0.1252104789018631,0.322965145111084,0.2759146988391876},{-0.07775460183620453,0.015213322825729847,0.45801275968551636,-0.10500279814004898},{-0.4006084203720093,0.2572370767593384,-0.006765806581825018,-0.14343410730361938},{-0.20437300205230713,0.12279314547777176,-0.2401145100593567,0.10782373696565628},{0.16961583495140076,0.02873559109866619,0.2981051206588745,0.1152123212814331},{-0.1594187170267105,-0.34623461961746216,-0.13628433644771576,-0.11382604390382767},{-0.3651607930660248,0.027229340746998787,-0.08496993035078049,0.33920592069625854},{-0.3018411695957184,-0.1379397213459015,-0.20772090554237366,0.23952706158161163},{-0.058345988392829895,-0.16162645816802979,0.4112214744091034,0.06637339293956757},{-0.21254472434520721,-0.18770897388458252,0.035444095730781555,-0.21594715118408203},{0.16995030641555786,0.1538112908601761,0.18101952970027924,-0.22971828281879425},{-0.056105565279722214,-0.34158748388290405,-0.12852449715137482,0.339964359998703},{0.4497782588005066,-0.2577843964099884,0.14618493616580963,0.10243581980466843},{-0.33446982502937317,-0.10824903100728989,-0.3096311092376709,-0.3690682649612427},{-0.16469895839691162,-0.2719275653362274,-0.1009715124964714,-0.09032389521598816},{0.17636430263519287,0.1777125746011734,-0.08156488835811615,0.08052457869052887},{0.12340743094682693,-0.20788192749023438,0.3170374929904938,0.09095699340105057},{-0.084408238530159,-0.1700669527053833,-0.037811972200870514,0.34539589285850525},{0.1344710737466812,0.035754285752773285,0.07534537464380264,0.03307635337114334},{-0.17988476157188416,0.13389384746551514,0.27469804883003235,0.04195430502295494},{-0.27635085582733154,-0.08792870491743088,0.0898599848151207,0.2578814923763275},{0.29133036732673645,0.23002558946609497,0.2893984019756317,-0.028815457597374916}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0794927179813385,-0.11967292428016663,0.0776832327246666,0.08994229137897491,0.09004224091768265,-0.17293737828731537,0.08536330610513687,0.017206726595759392,-0.06667055934667587,-0.05917738378047943,0.011574014090001583,0.02045377343893051,-0.015755383297801018,0.08924084156751633,0.09877897799015045,-0.02722524292767048};
static const float actor_encoder_self_encoder_2_bias[16] = {0.008076377213001251,0.06539884954690933,0.04488160461187363,-0.02997041866183281,-0.04179408401250839,0.07099658995866776,-0.048019424080848694,-0.08407948166131973,0.031532831490039825,-0.014344237744808197,-0.027903400361537933,-0.009136893786489964,-0.012180712074041367,-0.07196349650621414,0.041184570640325546,-0.08034691959619522};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.058237019926309586,-0.013538488186895847,-0.06887005269527435,0.04076759144663811,0.01362893357872963,0.019152596592903137,-0.04834448918700218,-0.05624741315841675,-0.010777934454381466,-0.020823661237955093,0.01143477950245142,0.024050068110227585,0.00667425524443388,-0.028400355949997902,0.02983209677040577,-0.07493872195482254,-0.007350718602538109,-0.029745619744062424,0.017164358869194984,-0.07352087646722794,0.01597471721470356,-0.009488850831985474,0.02107112668454647,-0.06329260766506195,-0.06823131442070007,0.06950809806585312,0.03248850628733635,-0.025252021849155426,0.06314460188150406,0.0048563433811068535,-0.017077254131436348,0.05137064680457115};
static const float action_parameterization_distribution_linear_bias[4] = {0.03532325103878975,0.05932816490530968,-0.003320666030049324,0.03868040442466736};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.33190056681632996,-0.20869150757789612,-0.07333800941705704,0.19661486148834229,-0.08676883578300476,0.08742769062519073,-0.24447974562644958,-0.027619069442152977},{0.05917029455304146,0.11132893711328506,0.34233567118644714,0.3522132635116577,-0.11716700345277786,-0.2492343634366989,0.3281654715538025,0.16714878380298615},{0.0036594844423234463,0.19682744145393372,0.06778194010257721,-0.06147416681051254,0.3040984869003296,0.25860267877578735,-0.029034104198217392,0.0979357436299324},{0.07300497591495514,-0.26691243052482605,0.3114764988422394,-0.23723295331001282,-0.28030961751937866,0.049425020813941956,0.25401750206947327,0.19506290555000305},{-0.22575579583644867,-0.0063018957152962685,-0.04919521138072014,-0.3129945397377014,0.04717065393924713,0.04421364143490791,0.29877424240112305,0.2544233500957489},{-0.06412827968597412,0.3165712356567383,-0.07701675593852997,-0.2512455880641937,0.18948805332183838,0.013793040998280048,0.06367401778697968,-0.1885252445936203},{-0.004931090399622917,0.32381966710090637,0.1306072175502777,-0.16848796606063843,0.2947578430175781,-0.22289611399173737,0.19318310916423798,0.0885087326169014},{0.05655454844236374,-0.1803596466779709,0.003227513749152422,-0.1414644718170166,0.338832825422287,-0.12558965384960175,-0.06701097637414932,-0.2958431839942932},{-0.16807673871517181,0.31651753187179565,0.0824141651391983,-0.022050123661756516,0.030889110639691353,0.22604787349700928,0.4359438121318817,0.38159412145614624},{0.057769525796175,-0.04371560364961624,-0.2846263349056244,0.3534243404865265,0.29717835783958435,0.17530259490013123,0.23705652356147766,-0.263898640871048},{-0.11742836236953735,-0.3296569585800171,0.3424437642097473,0.2243795543909073,-0.005504263564944267,-0.36663439869880676,-0.10489237308502197,-0.3292427659034729},{0.31140634417533875,0.04748355969786644,0.3729449510574341,0.4219461679458618,-0.15597765147686005,0.22900228202342987,0.121119923889637,-0.3719380497932434},{-0.3199397027492523,0.14483331143856049,-0.3269912004470825,0.41386470198631287,-0.02806210145354271,0.30244097113609314,0.005103216506540775,0.2382286936044693},{-0.016750892624258995,0.20155169069766998,-0.08688808977603912,-0.15691858530044556,0.04498526081442833,0.044698383659124374,0.30392351746559143,-0.0025894322898238897},{0.13830190896987915,-0.2945326566696167,-0.28738850355148315,-0.1880558282136917,0.20745401084423065,-0.2028764933347702,0.21740904450416565,-0.08517947047948837},{-0.412632018327713,-0.3361912965774536,-0.23246151208877563,0.0347115620970726,0.057326335459947586,0.1306028813123703,0.28521525859832764,0.005905686877667904},{-0.18301723897457123,-0.25971511006355286,0.19536475837230682,-0.32440781593322754,0.11177358031272888,0.06856265664100647,-0.39722296595573425,-0.2361799031496048},{0.0678645521402359,0.22947101294994354,0.08362496644258499,0.1662740707397461,-0.037128157913684845,0.33313506841659546,0.285576194524765,-0.15523497760295868},{0.03226802498102188,-0.3367393910884857,-0.1437913030385971,-0.03673739358782768,-0.039897192269563675,-0.33806172013282776,0.09856098890304565,-0.23026274144649506},{-0.07444417476654053,-0.027141058817505836,0.016748830676078796,-0.26848140358924866,0.12809202075004578,0.10290773957967758,0.16697371006011963,-0.032850660383701324},{0.0584990493953228,-0.09454143792390823,0.0027340350206941366,-0.14939916133880615,0.051389358937740326,-0.024291418492794037,0.12057042866945267,-0.1713295578956604},{-0.324886292219162,0.1470097452402115,0.1166207566857338,-0.2366054207086563,-0.3776308000087738,-0.015985896810889244,0.2379642277956009,0.04633154347538948},{0.2782602608203888,0.046244531869888306,-0.43183404207229614,0.030285736545920372,-0.02241281233727932,0.21998965740203857,0.29049548506736755,0.3141991198062897},{0.020194536074995995,-0.20590421557426453,-0.042933762073516846,0.1483808159828186,-0.2874124050140381,-0.08065517246723175,-0.16420690715312958,-0.27116069197654724},{0.10594678670167923,-0.09191369265317917,-0.3927830457687378,0.33970925211906433,-0.3059784173965454,-0.13345405459403992,-0.4198572635650635,0.10376238822937012},{-0.023402966558933258,0.3054836392402649,-0.218384250998497,-0.09866943955421448,0.10480299592018127,-0.1543329656124115,0.2876347601413727,-0.2918609082698822},{-0.09343957901000977,0.09569631516933441,-0.09130946546792984,-0.26190420985221863,0.04886888712644577,-0.14881309866905212,-0.12987437844276428,-0.10423803329467773},{0.08709942549467087,-0.1596497744321823,0.03668198361992836,-0.14760051667690277,0.1024668887257576,0.05994224548339844,-0.2146874964237213,0.10916242003440857},{0.23397409915924072,0.02514430321753025,-0.3059268295764923,-0.23723812401294708,-0.17177936434745789,0.14806078374385834,0.21362191438674927,0.06502779573202133},{0.31426194310188293,-0.347902774810791,0.03272765874862671,-0.08430789411067963,0.12676271796226501,-0.11349127441644669,0.16844391822814941,0.2855663001537323},{-0.26515281200408936,-0.19075551629066467,0.0668737143278122,-0.3839723467826843,0.28250983357429504,-0.31785380840301514,-0.027789758518338203,0.10371387749910355},{0.23464219272136688,0.18000034987926483,-0.035130761563777924,0.2238638997077942,0.05968295782804489,-0.09531964361667633,-0.03192409873008728,0.11526104062795639}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.22032082080841064,0.4090024530887604,-0.5007500052452087,-0.5469439625740051,-0.19663746654987335,-0.07357663661241531,-0.4026993215084076,0.5519354939460754},{-0.050631653517484665,0.4802466928958893,-0.2588505446910858,0.6136496663093567,-0.04602964222431183,-0.0389636792242527,-0.3518519699573517,0.035755705088377},{-0.37142127752304077,-0.16855022311210632,-0.11492010951042175,-0.06488790363073349,0.4627040922641754,0.2351473718881607,-0.04413255676627159,0.41392290592193604},{-0.49966520071029663,-0.5420809984207153,0.3361425995826721,0.30805352330207825,-0.477603942155838,-0.2253134399652481,0.4116465747356415,0.2239190936088562},{-0.3146946132183075,-0.2651267349720001,-0.31223931908607483,-0.2112731635570526,0.3360272943973541,-0.23617009818553925,0.49211448431015015,-0.39434105157852173},{-0.03992292284965515,0.2513267397880554,0.15964893996715546,-0.5436795353889465,0.5620139837265015,-0.252148300409317,-0.47779351472854614,-0.3846464157104492},{-0.3184509873390198,0.15146535634994507,0.08897016942501068,-0.4944297969341278,0.010648231953382492,-0.5160171389579773,0.4927866458892822,0.045247070491313934},{-0.37310636043548584,-0.15522120893001556,-0.12425011396408081,-0.32494768500328064,-0.3569242060184479,0.13401775062084198,0.5754497647285461,-0.2963668704032898}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0016071089776232839,-0.1363435834646225,-0.12448609620332718,0.021881502121686935,0.1578376740217209,0.04781244695186615,0.14292123913764954,0.06731423735618591};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.01637393608689308,-0.03245272859930992,-0.016333555802702904,-0.1058860570192337,-0.06674123555421829,-0.07355628162622452,0.02110963873565197,-0.17071327567100525};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

