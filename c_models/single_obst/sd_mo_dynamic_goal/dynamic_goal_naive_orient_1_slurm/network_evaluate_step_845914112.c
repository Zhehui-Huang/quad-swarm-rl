#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.323379248380661,0.03920643776655197,0.08330905437469482,0.2668846547603607,0.2782784700393677,-0.21191824972629547,-0.3164980113506317,0.11419680714607239,0.3847282826900482,-0.3084849417209625,0.4527246057987213,0.08928487449884415,0.24295058846473694,0.08212906867265701,-0.3066423833370209,0.02517307922244072},{-0.32902151346206665,-0.2203054130077362,-0.2561892867088318,-0.07584570348262787,0.17680276930332184,0.42264431715011597,0.17385339736938477,-0.02637171372771263,0.2003449648618698,0.24325595796108246,-0.08012150973081589,0.009912989102303982,-0.10492752492427826,0.10513022541999817,0.28172361850738525,-0.22442086040973663},{-0.01665985956788063,0.15784883499145508,0.24401363730430603,0.36441776156425476,0.07570663094520569,-0.30614835023880005,0.9067029356956482,-0.3245777487754822,-0.2793467044830322,0.0009745389106683433,-0.03493928909301758,-0.26794496178627014,0.404854416847229,0.6583771109580994,-0.581578254699707,0.2022663950920105},{0.16681446135044098,-0.18048688769340515,-0.13477295637130737,-0.00021108782675582916,-0.12402788549661636,0.1309087574481964,-0.055668748915195465,-0.22816987335681915,-0.021312884986400604,-0.034773509949445724,0.5854492783546448,-0.20417600870132446,-0.3415299952030182,-0.18377569317817688,0.23534250259399414,-0.041487984359264374},{-0.17489191889762878,-0.023854797706007957,0.18886856734752655,-0.40136051177978516,0.46039310097694397,0.2564675807952881,0.21503078937530518,-0.1992833912372589,-0.19377072155475616,0.30569377541542053,-0.12224315106868744,-0.4120873510837555,-0.00628140103071928,-0.2231983095407486,0.4562150537967682,-0.017571410164237022},{-0.0178122129291296,-0.130887970328331,-0.0981612280011177,-0.06873426586389542,0.05641220882534981,-0.22234377264976501,0.6017430424690247,-0.3156311511993408,-0.2458398938179016,-0.20830972492694855,0.11508121341466904,0.07444797456264496,0.3080649971961975,0.02051055058836937,0.3028528392314911,0.2377420961856842},{-0.1076977476477623,0.2968158721923828,-0.03734253719449043,0.09976267069578171,-0.2623651325702667,-0.0754847377538681,-0.08479727804660797,0.03134274110198021,0.33277440071105957,0.26365986466407776,-0.32973119616508484,-0.13102850317955017,0.24716311693191528,-0.10742741078138351,-0.0735483169555664,0.2054750919342041},{-0.3396429121494293,0.24874097108840942,-0.03594980388879776,-0.32566365599632263,0.32520535588264465,-0.2857614755630493,-0.3692188262939453,-0.5371220111846924,-0.08129945397377014,-0.24704119563102722,0.5749408602714539,0.13726696372032166,-0.04423360526561737,0.49103882908821106,0.028215257450938225,0.6701979041099548},{0.29596802592277527,0.14662979543209076,-0.27805018424987793,0.020279863849282265,-0.6714298725128174,-0.6088058352470398,0.16324655711650848,-0.600627601146698,-0.03369906544685364,-0.19576327502727509,0.35419365763664246,-0.6164595484733582,-0.5404947996139526,0.11837021261453629,0.027429820969700813,-0.33158165216445923},{0.6797624230384827,-0.9084352254867554,-0.4243999421596527,0.13054703176021576,0.16027438640594482,-0.34850162267684937,0.0009244748507626355,-0.1956179141998291,-0.40461742877960205,-0.07510125637054443,-0.2828376889228821,-0.35912713408470154,0.5581095218658447,-0.34084343910217285,-0.7110050916671753,-0.325681209564209},{0.35874706506729126,0.29328453540802,-0.1542797088623047,0.08423144370317459,0.08495137840509415,-0.14334101974964142,-0.10666374862194061,0.170815572142601,-0.05086258053779602,0.17367491126060486,0.12844477593898773,0.2029467523097992,-0.12603531777858734,0.11787273734807968,0.03598162159323692,-0.38855963945388794},{-0.4294736683368683,0.28139492869377136,0.6118370890617371,-0.9534832239151001,0.17778870463371277,0.21212822198867798,0.16938966512680054,0.3569723069667816,0.33369526267051697,0.46890220046043396,0.5042561888694763,-0.4490772783756256,0.35034334659576416,-0.21955855190753937,0.059079427272081375,-0.23403948545455933},{0.14669331908226013,-0.33052384853363037,-0.29071474075317383,0.3682308793067932,-0.20948149263858795,-0.3076411485671997,-0.046840883791446686,0.3068266808986664,0.22756162285804749,-0.13837356865406036,-0.27672603726387024,0.2864939868450165,0.3992973864078522,0.3332729637622833,-0.22434034943580627,0.6485508680343628},{0.2736920714378357,0.2981263995170593,-0.3322145640850067,0.08399862051010132,-0.13173925876617432,-0.1458524763584137,-0.2693602740764618,0.20753447711467743,-0.2314465194940567,-0.3643265664577484,-0.06417588144540787,0.07576730102300644,-0.5644038319587708,-0.11091349273920059,-0.280008465051651,-0.18940481543540955},{0.15309353172779083,0.5492537617683411,0.33279192447662354,-0.38367021083831787,-0.41584011912345886,0.2590218186378479,-0.10595043748617172,0.01910465396940708,0.5005059242248535,0.2437279224395752,-0.23908217251300812,0.15841704607009888,-0.1983007937669754,-0.35527682304382324,0.15465566515922546,-0.3409377336502075},{-0.3251890540122986,-0.03698321059346199,-0.02058781310915947,0.23107506334781647,-0.02237127348780632,0.010056537576019764,-0.1695353239774704,-0.015418941155076027,-0.3822517395019531,-0.11444000154733658,0.23719018697738647,0.07842779159545898,-0.1652051955461502,-0.21566064655780792,-0.3790554106235504,-0.10025423765182495},{-0.29175323247909546,0.15587224066257477,-0.16068732738494873,0.0002205229247920215,-0.10846126824617386,0.3202206790447235,0.3412834107875824,0.14024195075035095,0.18783563375473022,-0.24737565219402313,-0.0512721948325634,-0.10457395017147064,-0.008513140492141247,0.024124421179294586,-0.018536746501922607,-0.13900616765022278},{0.15142914652824402,-0.4171224534511566,0.11850342899560928,0.15080635249614716,0.020342934876680374,0.2853827476501465,0.3041914105415344,0.12248843163251877,-0.13425645232200623,-0.23349623382091522,-0.0993238314986229,-0.141591876745224,-0.130000501871109,-0.37953615188598633,0.057379789650440216,0.019552156329154968}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15855737030506134,0.3145180642604828,0.3589712679386139,-0.06839104741811752,-0.17167341709136963,0.01728830486536026,0.0798959955573082,0.24879077076911926,-0.07032503187656403,0.3066054880619049,0.46748656034469604,-0.3653281033039093,-0.10871795564889908,0.0774037092924118,0.010631919838488102,-0.044730957597494125},{-0.5176475048065186,0.23788167536258698,-0.27394047379493713,0.2648289203643799,0.35121601819992065,-0.10559676587581635,-0.31288251280784607,-0.277354896068573,0.27104246616363525,0.3086763620376587,-0.07144322246313095,0.20779213309288025,-0.2957247197628021,0.16397599875926971,-0.2684639096260071,0.4105830192565918},{-0.38566452264785767,0.17994381487369537,-0.33292943239212036,0.05376923456788063,-0.4135848879814148,-0.28421226143836975,-0.11378685384988785,0.03575015440583229,-0.22458474338054657,0.3400432765483856,0.195814311504364,-0.06086952984333038,0.2127590775489807,-0.3495792746543884,-0.04314793273806572,0.036700762808322906},{0.2210206687450409,-0.22094863653182983,0.08001332730054855,0.4351328909397125,-0.46189573407173157,-0.31619060039520264,0.2458396703004837,0.12727825343608856,0.2869521379470825,-0.0731101706624031,0.2541411519050598,0.1060761958360672,-0.2591674327850342,-0.06610099971294403,-0.023423809558153152,-0.354721337556839},{-0.3227367699146271,0.007897315546870232,0.22867313027381897,-0.35038691759109497,0.12286774814128876,0.2788166403770447,-0.3128182291984558,0.25805753469467163,-0.22934941947460175,0.18536551296710968,-0.12894266843795776,-0.006210692226886749,-0.1521310806274414,0.0011360261123627424,-0.20418420433998108,-0.19549180567264557},{-0.0012892780359834433,-0.21345575153827667,-0.04889734461903572,-0.37776997685432434,0.30595099925994873,0.07821570336818695,-0.00886237621307373,-0.10429158061742783,-0.20527420938014984,0.356073260307312,0.32373932003974915,-0.0928594097495079,-0.16011132299900055,0.24757106602191925,-0.08122263848781586,-0.36075153946876526},{0.21920716762542725,-0.18373273313045502,0.28334471583366394,-0.30758777260780334,-0.36736801266670227,-0.057033125311136246,-0.37635481357574463,0.345617413520813,-0.13863331079483032,-0.26022371649742126,-0.24651308357715607,-0.024800265207886696,-0.07291901856660843,-0.06555339694023132,0.4602489173412323,-0.39028260111808777},{-0.3087834119796753,0.3794064223766327,-0.05728829279541969,0.21795359253883362,0.009600665420293808,-0.22729428112506866,-0.12958960235118866,0.09843660145998001,-0.05005939304828644,0.48766517639160156,0.1251947432756424,-0.21934480965137482,0.06674520671367645,-0.10082277655601501,0.07286450266838074,0.17724139988422394},{0.15750357508659363,0.2682415246963501,-0.1738736629486084,-0.3480571210384369,0.3746311068534851,-0.1989632546901703,0.24833646416664124,-0.3650563061237335,0.054313138127326965,0.01277043018490076,0.13015156984329224,0.10737805813550949,-0.016416996717453003,-0.23535095155239105,-0.10549990087747574,0.2003813236951828},{-0.1849503517150879,-0.017389273270964622,-0.2754412889480591,-0.31794473528862,0.22787803411483765,-0.4511464238166809,-0.199785053730011,0.2596542239189148,-0.07775135338306427,0.1743076592683792,0.02152487263083458,-0.06307096779346466,-0.35850027203559875,-0.004225917626172304,-0.20717529952526093,-0.35268786549568176},{-0.23442448675632477,-0.08235234022140503,-0.10011239349842072,-0.33103078603744507,-0.3288499712944031,-0.0014608502388000488,0.13669130206108093,-0.4642597436904907,-0.005131855607032776,-0.03228525444865227,0.13740397989749908,-0.015211902558803558,0.3768424093723297,0.025302959606051445,0.1958678513765335,0.21684376895427704},{-0.20845484733581543,-0.05242010951042175,-0.406985342502594,0.3741694986820221,0.1099516972899437,0.052714426070451736,0.1510518342256546,0.07991185039281845,-0.36297622323036194,0.20897845923900604,-0.39605823159217834,-0.1314612329006195,-0.36906591057777405,0.37687528133392334,-0.32890892028808594,0.0888545885682106},{-0.10936237871646881,-0.4469629228115082,-0.07341144979000092,0.1397990882396698,-0.19441308081150055,-0.08113957941532135,-0.07151724398136139,0.34748584032058716,0.415326863527298,0.08260242640972137,-0.10862638056278229,-0.2444431334733963,0.15469183027744293,-0.31496915221214294,0.15405167639255524,-0.20436541736125946},{-0.2512364983558655,-0.48143497109413147,-0.1731778383255005,-0.14004427194595337,-0.4658432602882385,0.34381216764450073,-0.07730098813772202,0.20193761587142944,-0.1983254849910736,-0.3307977318763733,-0.28799617290496826,0.394756555557251,-0.16839094460010529,0.09468202292919159,-0.25127023458480835,0.353714257478714},{-0.3280145227909088,0.3240869343280792,-0.17873038351535797,0.10272539407014847,-0.350408673286438,0.13963188230991364,0.06292204558849335,-0.3821624219417572,0.11277958750724792,0.15419025719165802,-0.11464076489210129,0.0806487426161766,0.27730026841163635,-0.20492418110370636,-0.3303283452987671,-0.15308156609535217},{-0.15358275175094604,-0.3646535277366638,-0.5088457465171814,0.2991383671760559,0.061085980385541916,0.10331343859434128,-0.25021442770957947,0.19347521662712097,-0.41247978806495667,-0.2998487949371338,-0.40375036001205444,0.2462707906961441,-0.24656902253627777,0.20863565802574158,0.09147186577320099,0.34273767471313477}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07116629928350449,-0.09580768644809723,0.15299823880195618,-0.10256196558475494,-0.09541235119104385,0.12196430563926697,0.19745318591594696,-0.23995164036750793,-0.18845824897289276,0.27944037318229675,0.10494271665811539,0.10944864898920059,0.06681819260120392,0.13173164427280426,-0.17887140810489655,0.14212827384471893,0.13373270630836487,-0.29654887318611145,-0.19357427954673767,-0.07304272800683975,-0.16582433879375458,0.08551162481307983,-0.18459758162498474,0.3505444824695587,-0.16582301259040833,-0.055852070450782776,0.10357403755187988,0.18096648156642914,-0.17122457921504974,-0.16273626685142517,0.20709848403930664,0.23694761097431183},{0.14544989168643951,-0.06382539123296738,0.16948625445365906,-0.1219610646367073,-0.07647616416215897,0.2353009581565857,0.05115034803748131,-0.041591789573431015,-0.03686855360865593,-0.056345731019973755,-0.09483182430267334,-0.0017763817450031638,0.3620951175689697,0.216585174202919,0.09715238213539124,0.02686070278286934,-0.22495953738689423,-0.2641708254814148,0.11299305409193039,0.029460055753588676,0.10179293900728226,0.28694742918014526,0.27243688702583313,-0.157877117395401,0.04803993180394173,0.27578651905059814,-0.3489171266555786,0.19922687113285065,0.0064488002099096775,-0.2380775511264801,-0.08954808861017227,-0.015454326756298542},{-0.06344694644212723,-0.07478576898574829,0.21673913300037384,-0.1772596687078476,-0.14212441444396973,0.07830740511417389,-0.19348454475402832,0.21585334837436676,0.1893773078918457,0.022652991116046906,-0.19008760154247284,0.017946995794773102,0.3113158941268921,-0.2836078405380249,0.1056140884757042,-0.06095324829220772,-0.34737300872802734,0.25022757053375244,-0.29990166425704956,-0.053083233535289764,-0.04503047838807106,-0.1129520982503891,-0.02850872278213501,-0.03896696865558624,-0.03385360166430473,0.33788082003593445,-0.0953977182507515,0.0936441421508789,0.22977405786514282,-0.31085270643234253,-0.13585717976093292,-0.01597057469189167},{0.14359620213508606,-0.1872197836637497,0.007982774637639523,-0.3610360026359558,0.0631551444530487,-0.14525410532951355,-0.08220071345567703,0.1843883991241455,0.05214456468820572,0.19433674216270447,0.05677546560764313,-0.10351230949163437,-0.20295140147209167,-0.011417534202337265,0.24072903394699097,-0.20411494374275208,0.042755890637636185,-0.09030689299106598,-0.14766797423362732,0.11692636460065842,-0.14620940387248993,0.12571799755096436,-0.26963546872138977,0.2555387616157532,-0.22776703536510468,0.07499828934669495,-0.0498005636036396,-0.2144373655319214,0.1516149640083313,-0.013362785801291466,0.23256103694438934,-0.14678555727005005},{0.2577032446861267,-0.055678337812423706,0.009742697700858116,0.24900002777576447,-0.31116729974746704,-0.09136010706424713,0.1682003140449524,-0.02630380354821682,0.13785716891288757,-0.17302393913269043,-0.002411959692835808,-0.07853936403989792,-0.19052721560001373,-0.12832599878311157,0.2779848575592041,0.22875185310840607,-0.04245658218860626,-0.3067375719547272,0.10202091187238693,-0.1258101761341095,-0.13804395496845245,0.23649822175502777,0.22555871307849884,0.02140604332089424,-0.09773032367229462,-0.10289491713047028,0.0589413158595562,0.24077606201171875,0.14908567070960999,0.0939476266503334,0.12305859476327896,-0.2209794521331787},{0.31691837310791016,-0.1418762058019638,0.011290435679256916,0.09114125370979309,-0.10138549655675888,-0.3070841431617737,-0.22403745353221893,-0.29501819610595703,-0.19632023572921753,0.03611090034246445,-0.0290815569460392,0.01845639757812023,-0.10075971484184265,-0.09333017468452454,-0.19436724483966827,-0.2536410987377167,0.15929394960403442,-0.005768486298620701,-0.3170287311077118,0.19579017162322998,-0.08202440291643143,-0.19579407572746277,0.21134480834007263,-0.1512078493833542,-0.17702390253543854,-0.20938047766685486,-0.12004059553146362,0.09323283284902573,0.04061422869563103,0.24044987559318542,-0.24672503769397736,0.20874592661857605},{0.16821470856666565,0.10345734655857086,0.23059768974781036,-0.16083723306655884,0.24380475282669067,-0.20477746427059174,-0.2864253520965576,0.007615433074533939,0.2624913454055786,0.11163850128650665,-0.1414300501346588,0.1123301237821579,0.054555173963308334,0.30885812640190125,0.09273511916399002,-0.053512513637542725,-0.1820887327194214,0.10286044329404831,0.004825814161449671,-0.05058690905570984,-0.05251142382621765,0.18436290323734283,0.17535236477851868,0.10575754940509796,-0.24418504536151886,-0.20256268978118896,-0.2618390917778015,-0.3045349419116974,0.12403355538845062,-0.1406380534172058,0.3038860261440277,0.1779118776321411},{0.3040054142475128,-0.3571472465991974,0.07645443081855774,-0.40887585282325745,-0.3483988344669342,0.27392706274986267,0.40097010135650635,0.16880035400390625,-0.05834594741463661,0.08172392100095749,0.18121767044067383,-0.13168631494045258,0.06314876675605774,0.31158334016799927,-0.047184523195028305,0.20384924113750458,0.3930646479129791,-0.26465538144111633,-0.06933096051216125,-0.36780866980552673,0.19887764751911163,0.22213347256183624,0.19000978767871857,0.14175277948379517,0.13876713812351227,0.12070199102163315,0.1652894765138626,0.257114976644516,-0.014841396361589432,-0.2841947078704834,0.23522122204303741,0.03675118461251259},{0.0658344179391861,-0.11594202369451523,0.2356572151184082,0.25478535890579224,-0.2037099450826645,-0.26494234800338745,-0.07021575421094894,0.2426438331604004,-0.1994858980178833,-0.1573634296655655,0.004804357420653105,0.08096283674240112,0.16260015964508057,-0.31805771589279175,0.1653323471546173,-0.19208671152591705,-0.1964222937822342,0.18371699750423431,-0.2574687600135803,0.286880761384964,-0.37505868077278137,-0.2778919041156769,-0.3038627505302429,0.2711476981639862,0.08146101236343384,0.04976008087396622,0.29783961176872253,0.19063885509967804,-0.14405547082424164,-0.31174951791763306,-0.16281946003437042,0.16053591668605804},{0.29687419533729553,0.03970342129468918,0.017634160816669464,0.2327824980020523,0.02132684364914894,0.23221243917942047,-0.07871434092521667,0.2004011869430542,-0.0270172581076622,0.029217135161161423,0.15476199984550476,0.12162177264690399,-0.052747808396816254,-0.282871812582016,0.1744479537010193,0.18284332752227783,-0.02019672468304634,-0.13111357390880585,-0.038310691714286804,0.03802775219082832,0.07677006721496582,-0.29289305210113525,0.33141130208969116,0.05592765659093857,-0.02800992876291275,0.10514117032289505,-0.373439759016037,-0.18747325241565704,-0.08831056952476501,0.0018181669292971492,0.08632496744394302,0.18549910187721252},{-0.08016102015972137,0.10209857672452927,-0.046339742839336395,0.1969740241765976,-0.05037656053900719,0.3230989873409271,0.1047448068857193,-0.06703445315361023,0.24387246370315552,-0.30410951375961304,-0.159430131316185,0.14223387837409973,-0.0915195569396019,0.0541178435087204,-0.2834834158420563,0.04636619985103607,0.07015475630760193,0.14771580696105957,0.11663711816072464,-0.12248419970273972,-0.25743645429611206,0.16689808666706085,0.2732669711112976,0.22283928096294403,-0.32597988843917847,0.3242293894290924,-0.19245900213718414,0.03812224045395851,-0.11657747626304626,0.146465465426445,0.20548635721206665,0.2540081739425659},{-0.15434187650680542,0.2495073527097702,-0.09899788349866867,-0.017220478504896164,-0.2076362818479538,-0.12646372616291046,0.1569511890411377,-0.2618394196033478,-0.014358014799654484,-0.19263257086277008,-0.2575658857822418,-0.07443858683109283,0.16748136281967163,-0.3119215965270996,-0.09524483233690262,-0.36972036957740784,-0.15720169246196747,-0.01552917156368494,0.2561269998550415,-0.3077559471130371,0.03789239004254341,-0.11603084206581116,0.022220458835363388,0.28953033685684204,-0.16856156289577484,0.1558196246623993,0.2907722592353821,-0.12600655853748322,-0.08022666722536087,0.3088306486606598,-0.14043840765953064,-0.24415384232997894},{-0.06348200142383575,0.22817911207675934,0.24569135904312134,-0.34424349665641785,0.3132913410663605,0.03862527757883072,-0.11922653764486313,-0.010782718658447266,0.12970058619976044,-0.30237284302711487,-0.041735634207725525,0.015600904822349548,0.2271423488855362,0.04029017314314842,0.0064450460486114025,-0.03630223125219345,0.24035823345184326,-0.2799833118915558,0.34764912724494934,0.09749722480773926,-0.17721429467201233,0.2089013159275055,-0.07700930535793304,-0.20185069739818573,0.248574897646904,-0.10763093829154968,-0.03870229423046112,-0.13810622692108154,-0.004041001666337252,-0.11998926103115082,0.2712583541870117,0.23591142892837524},{0.13245661556720734,-0.15977004170417786,-0.16117165982723236,0.11595411598682404,0.10507600754499435,0.28239208459854126,-0.1086234524846077,-0.2206881195306778,0.26192042231559753,0.04544393718242645,0.04879360646009445,0.06536978483200073,-0.22288411855697632,0.05647170543670654,-0.15994583070278168,-0.2363138198852539,0.04608645290136337,-0.06176787614822388,0.22922268509864807,0.32341739535331726,-0.21174383163452148,0.06878066062927246,-0.11927969753742218,-0.004652798175811768,0.0531938262283802,-0.25165116786956787,-0.1471809595823288,-0.18934522569179535,-0.055661045014858246,-0.13247057795524597,0.2717882990837097,-0.27978235483169556},{-0.006249787285923958,0.2997194826602936,0.1935715675354004,-0.16998332738876343,-0.08070388436317444,-0.15366476774215698,0.16532395780086517,-0.06932345032691956,0.18822157382965088,0.014312442392110825,0.191448375582695,0.1389937847852707,0.022558441385626793,0.03412140533328056,-0.09354105591773987,0.2155497670173645,-0.2146332859992981,-0.36940741539001465,-0.22414395213127136,0.15022355318069458,0.06953295320272446,-0.22711396217346191,-0.2841220796108246,-0.19098436832427979,-0.2412862479686737,0.018205394968390465,0.31697922945022583,0.0006991241243667901,-0.0462094284594059,0.13640736043453217,-0.1512196809053421,0.06512381136417389},{-0.1904621124267578,-0.17976713180541992,-0.24407757818698883,0.06053968891501427,-0.2691851258277893,-0.11320745199918747,-0.09882429987192154,-0.11065185815095901,-0.2937396764755249,-0.1729130744934082,0.09567636251449585,0.1710875928401947,-0.25964516401290894,0.26838308572769165,-0.0297396257519722,0.19268138706684113,0.04558814316987991,0.005524894222617149,0.029088091105222702,0.10872511565685272,0.15153485536575317,0.3213565945625305,0.08612686395645142,0.21401812136173248,0.11087153851985931,-0.23100072145462036,-0.1241706982254982,0.27353641390800476,0.024674225598573685,-0.23279589414596558,-0.15071572363376617,-0.14184625446796417},{-0.2885722219944,-0.21125680208206177,-0.3537955582141876,0.07756631076335907,-0.12375649064779282,-0.08722025156021118,-0.13591846823692322,0.07205554842948914,-0.03855059668421745,0.09734213352203369,-0.2608778476715088,0.014112084172666073,0.14428499341011047,-0.048275772482156754,0.036789145320653915,0.1969689279794693,-0.17311500012874603,-0.09095421433448792,0.15368062257766724,0.10411114245653152,0.204000324010849,0.008316799998283386,-0.2658352255821228,0.06812655180692673,0.18934553861618042,-0.30502966046333313,0.17596566677093506,-0.0032638658303767443,0.05538637563586235,-0.1323120892047882,0.1992497444152832,-0.08568037301301956},{0.2562367618083954,-0.05515061691403389,0.056153804063797,0.13029944896697998,-0.3038601577281952,-0.012744092382490635,0.15569721162319183,0.19859282672405243,-0.07552832365036011,-0.11454431712627411,0.31796401739120483,-0.16819816827774048,-0.006148570217192173,-0.037007834762334824,-0.15480411052703857,0.21324361860752106,0.0077246748842298985,-0.05453307554125786,0.11437533050775528,-0.272835910320282,0.03889251500368118,-0.3110990822315216,-0.2470136433839798,0.258166640996933,-0.12451324611902237,-0.13176026940345764,0.17038114368915558,-0.016716638579964638,-0.1757800579071045,-0.007053094450384378,-0.08968225866556168,-0.05012419819831848},{0.30006110668182373,-0.03008406236767769,0.056959908455610275,0.06899294257164001,-0.010719720274209976,-0.12644007802009583,0.13907530903816223,-0.23721152544021606,0.22860470414161682,0.2672675549983978,0.01473587192595005,0.17958159744739532,0.24221941828727722,0.3279230296611786,-0.2984122633934021,-0.28719717264175415,-0.31020820140838623,0.019362924620509148,-0.14701686799526215,-0.31052741408348083,-0.18233849108219147,0.281297892332077,0.06643802672624588,0.11512681096792221,-0.14494264125823975,-0.06465935707092285,-0.14361883699893951,-0.18244166672229767,0.2740941345691681,0.14533989131450653,-0.27277427911758423,-0.13330109417438507},{-0.12440852075815201,0.18432210385799408,0.29964712262153625,-0.05324558541178703,-0.016522670164704323,0.044684916734695435,-0.008264481090009212,-0.327876478433609,0.1858249455690384,0.2198227196931839,0.20962509512901306,0.21797966957092285,-0.26764407753944397,0.21108178794384003,-0.2754199802875519,0.30677857995033264,0.1331816017627716,-0.24955008924007416,0.2706781029701233,0.13763435184955597,-0.2823897898197174,0.2724986672401428,-0.3142145276069641,0.10798802971839905,0.15695181488990784,0.22055310010910034,0.08753304183483124,0.10140881687402725,-0.22598370909690857,0.24993640184402466,-0.10370388627052307,0.09247912466526031},{-0.10714863985776901,-0.0501694455742836,0.07688812166452408,0.23862241208553314,0.02449878677725792,0.22661827504634857,-0.314333975315094,-0.15645648539066315,-0.2203400433063507,-0.0952598825097084,-0.18567106127738953,-0.1365276277065277,0.0575060211122036,-0.14251627027988434,0.15238018333911896,-0.1371767520904541,0.11209294199943542,-0.022404272109270096,-0.2764419615268707,-0.2279292196035385,0.08584672212600708,0.20129252970218658,-0.1348591446876526,0.33029213547706604,-0.3337540030479431,0.05246177315711975,0.07380451261997223,-0.07516312599182129,0.028822187334299088,-0.18615049123764038,0.3245646357536316,0.0735185444355011},{0.34763848781585693,-0.013659913092851639,0.05390547960996628,0.18774017691612244,-0.1468401402235031,0.23260895907878876,-0.05308856815099716,0.22407624125480652,0.15083946287631989,0.0935184583067894,0.06157735735177994,-0.3715488612651825,-0.26661041378974915,-0.07842204719781876,0.09116490185260773,-0.10544206202030182,0.28833866119384766,0.1654522866010666,-0.1866479068994522,-0.2113870084285736,0.2766216993331909,0.26534605026245117,0.2756997048854828,0.12394049763679504,-0.08018491417169571,-0.01765155978500843,-0.1081412062048912,-0.20109210908412933,0.10757610201835632,0.0658978596329689,-0.18771126866340637,0.11517970263957977},{-0.02474786899983883,0.02585352025926113,-0.05121198296546936,-0.2389875203371048,-0.10444602370262146,-0.24235166609287262,-0.21751181781291962,-0.17781823873519897,0.012317960150539875,-0.021660005673766136,-0.246420219540596,0.030861150473356247,-0.24759911000728607,-0.15073779225349426,0.0019271922064945102,0.08385173231363297,0.2673569917678833,-0.16750533878803253,-0.3473181128501892,0.2748989462852478,-0.14645503461360931,0.24582439661026,-0.023472720757126808,-0.05425839498639107,0.044531628489494324,0.1198374330997467,-0.056186139583587646,-0.279081255197525,0.20046240091323853,0.2599036991596222,-0.14550365507602692,0.18690143525600433},{-0.2744986414909363,-0.03781793639063835,0.034853044897317886,-0.015026111155748367,0.0060472325421869755,0.09139600396156311,-0.19357149302959442,0.08486086875200272,-0.1863466501235962,-0.18851108849048615,0.09281846880912781,-0.13126663863658905,-0.15759283304214478,0.2796485424041748,0.006299808621406555,-0.010846356861293316,0.2045895904302597,-0.2338705062866211,-0.17969796061515808,0.2804965674877167,0.017521463334560394,0.23516133427619934,-0.013537232764065266,0.03625183552503586,-0.21887844800949097,-0.1379663646221161,0.032192494720220566,0.28945979475975037,0.01029136311262846,-0.020598378032445908,0.2599225342273712,0.28328749537467957}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10759688168764114,0.08555847406387329,0.24686037003993988,0.015614528208971024},{0.0500810444355011,-0.06025251746177673,0.01823045127093792,0.16616156697273254},{-0.13137373328208923,0.10658528655767441,0.055450569838285446,0.11419680714607239},{0.3269312083721161,0.05228967219591141,0.09546903520822525,0.3925779461860657},{-0.05026620253920555,0.06653610616922379,0.2822337746620178,0.00992249883711338},{-0.13222378492355347,0.20178338885307312,0.19368667900562286,-0.01920732855796814},{-0.24731354415416718,-0.011383610777556896,0.018931783735752106,-0.10064925253391266},{-0.29592886567115784,-0.10199149698019028,0.2846696376800537,-0.27023619413375854},{0.2698006331920624,-0.14492040872573853,-0.23840415477752686,-0.3158368766307831},{0.07054699957370758,0.23751118779182434,0.2823544144630432,-0.32177072763442993},{-0.09500721842050552,-0.13309451937675476,-0.1326855570077896,0.10758281499147415},{0.2724768817424774,-0.1285151243209839,0.001423226436600089,0.14625830948352814},{0.22251784801483154,0.26594027876853943,-0.05739248916506767,0.10677163302898407},{-0.0016142016975209117,0.00415977044031024,-0.2747327387332916,0.054523155093193054},{0.09752056002616882,0.2356056123971939,0.27678772807121277,0.2290288805961609},{0.1350088268518448,0.01996041275560856,0.2082098126411438,0.23918600380420685},{-0.22841529548168182,-0.0972059890627861,-0.09912434220314026,-0.20351818203926086},{-0.11574387550354004,0.1056823581457138,-0.09060867875814438,-0.08788558840751648},{-0.27451103925704956,0.13248378038406372,0.13557970523834229,0.30577975511550903},{-0.027917848899960518,0.29420343041419983,-0.1413661390542984,0.1514846533536911},{-0.19959403574466705,-0.2959752380847931,-0.11777280271053314,-0.018619364127516747},{0.2785566747188568,0.31844693422317505,0.03385366126894951,-0.2059290111064911},{0.0014338720357045531,0.1527836173772812,0.17811572551727295,0.1448640674352646},{-0.07250729948282242,0.3268517553806305,-0.0350077822804451,-0.12071733921766281},{0.00382747920230031,-0.024323146790266037,-0.07022282481193542,-0.021905431523919106},{0.22720442712306976,-0.30298900604248047,-0.05240021273493767,0.02935032919049263},{-0.019146641716361046,-0.29080983996391296,-0.15263111889362335,-0.26327723264694214},{0.12562508881092072,-0.14542770385742188,0.19747842848300934,0.08504632115364075},{-0.001885130419395864,-0.006007006391882896,0.004354693461209536,0.0022047567181289196},{-0.3710193932056427,0.3558512330055237,0.18878649175167084,0.0011835317127406597},{0.319850355386734,-0.1396844983100891,0.1788252592086792,-0.03919905796647072},{0.09569942206144333,-0.32141080498695374,0.32491108775138855,-0.21192675828933716}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0854249969124794,-0.040587153285741806,0.014679741114377975,0.03966345265507698,-0.06755556911230087,-0.10770730674266815,0.04752363637089729,0.03690851107239723,0.013138781301677227,-0.015145394951105118,-0.041771333664655685,-0.004439077340066433,0.05695056915283203,0.030296778306365013,-0.10365910083055496,-0.011354087851941586};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.023009905591607094,0.012305260635912418,0.011931223794817924,-4.5102675358066335e-05,0.0059794653207063675,0.007670024875551462,0.02799610234797001,0.0341835543513298,0.006630321033298969,0.03420853987336159,0.031881753355264664,-0.017712028697133064,0.03975021839141846,-0.027082061395049095,-0.048646654933691025,0.009533446282148361};
static const float actor_encoder_feed_forward_0_bias[32] = {0.016218086704611778,0.012406667694449425,0.003917282447218895,-0.00588222173973918,0.021049214527010918,0.0063655078411102295,-0.00396374287083745,0.023300940170884132,-0.038607195019721985,-0.005665097385644913,-0.01447162963449955,0.0001943373354151845,0.006778088863939047,-0.015022996813058853,0.006850841920822859,0.04737184941768646,-0.0033933217637240887,-0.033151350915431976,0.022086799144744873,-0.01658182591199875,-0.029876386746764183,0.005361936520785093,0.05543488264083862,0.012171013280749321,-0.0027905211318284273,0.028140809386968613,-0.030229346826672554,0.04428812488913536,0.022225700318813324,-0.0021828203462064266,0.016976701095700264,0.02171454392373562};
static const float action_parameterization_distribution_linear_bias[4] = {0.002584314439445734,-0.012915045954287052,0.012440735474228859,0.0074975560419261456};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.037269704043865204,0.28970205783843994,-0.12585192918777466,0.17597976326942444,0.08826422691345215,0.04590824991464615,0.5896179676055908,-0.13212543725967407},{-0.12904417514801025,-0.03237204998731613,-0.2517337501049042,-0.21796923875808716,-0.4141418933868408,-0.2627454102039337,0.10283162444829941,-0.2694762349128723},{-0.17743684351444244,0.014234033413231373,0.27188840508461,0.2567439377307892,0.21398469805717468,-0.04643721878528595,0.4414411783218384,-0.1710299253463745},{0.039064206182956696,0.08424822986125946,-0.11969788372516632,0.03554261103272438,-0.022410200908780098,-0.07956281304359436,0.4039226174354553,-0.251799076795578},{-0.2226211428642273,-0.11804211884737015,-0.1847923994064331,-0.11793535947799683,-0.05933737754821777,0.16216996312141418,0.28295189142227173,-0.08304890990257263},{-0.28460830450057983,-0.032248131930828094,0.4697539210319519,0.2617502212524414,0.14356708526611328,-0.12530696392059326,-0.04996625706553459,-0.17089231312274933},{-0.24576981365680695,0.004160895943641663,0.5241602659225464,-0.16737432777881622,-0.1691751927137375,-0.43498295545578003,-0.03707510605454445,-0.12672920525074005},{-0.2782294750213623,-0.3746058940887451,0.6416282653808594,-0.032921478152275085,-0.24572600424289703,0.21245484054088593,0.23085139691829681,-0.2505320906639099},{-0.37290263175964355,0.2893032431602478,-0.05674224719405174,0.39873600006103516,0.060176607221364975,-0.3394954800605774,0.0444318987429142,0.1022069901227951},{-0.4300723373889923,-0.3388524353504181,-0.10237220674753189,-0.20862360298633575,-0.5413864254951477,0.13999143242835999,-0.022149302065372467,0.17323635518550873},{0.0795220285654068,0.3083838224411011,0.25801798701286316,-0.02468516118824482,0.20158416032791138,0.1695234328508377,-0.1934988796710968,0.24464477598667145},{0.11910417675971985,0.003965722396969795,0.27552083134651184,0.22741346061229706,-0.30024248361587524,0.34385815262794495,0.013431469909846783,-0.20855815708637238},{0.05008167773485184,-0.3461376130580902,0.2735971510410309,-0.07808045297861099,-0.3641851842403412,-0.04752374812960625,-0.1537153571844101,-0.11590567231178284},{-0.26668405532836914,-0.2755534052848816,0.3568542003631592,0.3348669111728668,-0.2637004256248474,-0.04745836928486824,-0.2717963755130768,0.22536061704158783},{0.02110818400979042,-0.21701359748840332,0.17370957136154175,-0.23226934671401978,-0.2918480634689331,-0.10593191534280777,0.24488000571727753,0.01580692082643509},{0.1450852006673813,-0.11476491391658783,0.06149149686098099,-0.24073843657970428,0.059602826833724976,0.09928546845912933,0.09219972044229507,0.41486719250679016},{-0.09495576471090317,-0.3657013475894928,-0.14214423298835754,0.12153466045856476,-0.21920529007911682,-0.12719690799713135,-0.11225952953100204,0.1391790211200714},{-0.22864359617233276,-0.3468610644340515,0.05031442269682884,0.031015964224934578,0.10418562591075897,-0.17494863271713257,0.3629526197910309,0.16426019370555878},{-0.03636262193322182,0.08607881516218185,-0.24404692649841309,0.10522226989269257,0.08803476393222809,0.21287605166435242,-0.19926884770393372,0.3468898832798004},{0.0717182382941246,-0.058712758123874664,-0.34701257944107056,0.0941905677318573,-0.08213595300912857,-0.006253109313547611,-0.2795106768608093,-0.004006785806268454},{0.01974630355834961,-0.1676074117422104,0.08722486346960068,-0.08867449313402176,0.31464841961860657,0.07225750386714935,0.040343768894672394,0.4008408784866333},{-0.061053261160850525,0.05056938901543617,-0.24033716320991516,0.2978309094905853,0.35552161931991577,0.38747692108154297,0.2447548508644104,-0.3037205934524536},{-0.5206772089004517,-0.2117069810628891,0.17585763335227966,-0.08579409122467041,0.22219622135162354,-0.21438036859035492,0.30300813913345337,-0.2685500979423523},{-0.26360422372817993,-0.025775037705898285,-0.0776573047041893,-0.46358808875083923,0.2523879110813141,0.08665674924850464,-0.2225007712841034,0.16322344541549683},{-0.3396362066268921,-0.1941034495830536,-0.029668500646948814,-0.030682522803544998,-0.0426216758787632,0.23723597824573517,0.37804296612739563,-0.14108364284038544},{-0.3147983253002167,0.05544133484363556,-0.3807530105113983,-0.3539593517780304,0.16657927632331848,0.07856409251689911,-0.028384270146489143,0.04900688678026199},{0.2720048725605011,0.38378074765205383,-0.3001057505607605,0.14517447352409363,0.21410174667835236,0.4290478229522705,-0.1958903670310974,-0.16057267785072327},{0.3184202313423157,0.2534712851047516,0.04346923157572746,0.041373565793037415,0.28676143288612366,0.2343369722366333,0.3753245770931244,0.35314685106277466},{-0.19497042894363403,0.3756757974624634,0.14128811657428741,-0.019449910148978233,0.23314055800437927,0.0908355861902237,-0.24354933202266693,-0.30275702476501465},{-0.2841535210609436,-0.21645759046077728,0.06517799198627472,-0.29831644892692566,-0.2989865243434906,-0.120304174721241,0.43417614698410034,-0.08231542259454727},{0.3014204204082489,-0.22978590428829193,0.3524463176727295,-0.3512358069419861,0.006132420618087053,0.24877126514911652,0.35782837867736816,-0.3099934458732605},{0.11471349745988846,0.4226176142692566,0.41949930787086487,-0.29590439796447754,-0.317113995552063,0.04983952268958092,0.392711877822876,-0.02147689089179039}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.0057706693187355995,0.4410385489463806,-0.15540042519569397,0.1729428917169571,-0.42850375175476074,0.3164092004299164,0.3090066611766815,0.11235915869474411},{-0.508540153503418,-0.421618789434433,-0.36117997765541077,-0.4582793414592743,-0.47412365674972534,0.4943042993545532,0.33379805088043213,-0.35382169485092163},{0.11730515956878662,-0.15169739723205566,0.1475098580121994,0.2001371830701828,-0.010568051598966122,0.4509052336215973,-0.28334861993789673,-0.5190586447715759},{0.3994123041629791,-0.09329981356859207,0.2032705843448639,-0.02368962951004505,0.4653467535972595,0.4491090178489685,0.5216947793960571,0.38933244347572327},{0.10772918909788132,0.1702834516763687,-0.1318051517009735,-0.22813428938388824,0.07678192853927612,-0.40146753191947937,-0.5104430913925171,0.5566458106040955},{0.45802074670791626,0.130196675658226,-0.02263912931084633,-0.31938764452934265,-0.4539676606655121,-0.4897482991218567,-0.10674794018268585,0.4073699116706848},{-0.4747615456581116,-0.3091871738433838,-0.13028950989246368,-0.22107599675655365,-0.007959329523146152,0.5239408612251282,-0.507132351398468,0.49787187576293945},{0.13055677711963654,0.059459835290908813,-0.003738909959793091,0.014489754103124142,0.331032395362854,-0.4450550675392151,0.29720571637153625,-0.3477429151535034}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.06852170079946518,0.025514742359519005,0.05585480108857155,-0.0315750315785408,-0.05751525238156319,0.02143850363790989,0.05283952131867409,-0.021490752696990967};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011812972836196423,0.015993814915418625,-0.06226406618952751,0.06869015097618103,-0.0014861607924103737,-0.0060074483044445515,0.039575908333063126,-0.08998484164476395};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

