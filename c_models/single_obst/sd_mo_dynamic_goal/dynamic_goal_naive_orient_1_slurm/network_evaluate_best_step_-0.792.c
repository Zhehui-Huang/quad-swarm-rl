#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2869113087654114,-0.19340507686138153,0.3361605703830719,0.23133037984371185,-0.37173837423324585,0.16849547624588013,-0.005825983826071024,-0.20581577718257904,0.08295179158449173,0.4197414219379425,0.12422168999910355,0.05063773691654205,0.1601596474647522,-0.20041806995868683,0.3516494929790497,-0.10296522825956345},{-0.3588349521160126,-0.3003409206867218,0.2906026542186737,0.2002652883529663,-0.24418169260025024,0.05010569095611572,-0.38300320506095886,-0.008193743415176868,-0.1726159006357193,-0.13673900067806244,0.1326490193605423,-0.17679111659526825,0.23003250360488892,-0.38118961453437805,-0.20472820103168488,0.08310206234455109},{0.1581469476222992,-0.24042510986328125,-0.2622939646244049,0.08801437169313431,0.10149426758289337,0.1487564742565155,-0.0548173151910305,0.022644005715847015,-0.12796084582805634,-0.20322167873382568,-0.19128477573394775,0.41273677349090576,-0.008317201398313046,-0.16470244526863098,-0.4083400368690491,0.23977668583393097},{0.13560564815998077,0.17902690172195435,0.32310524582862854,-0.03843016177415848,-0.3298827111721039,-0.0422571562230587,0.18470865488052368,0.12889216840267181,0.4909178614616394,-0.38244396448135376,0.045074306428432465,0.16136792302131653,-0.3438085913658142,-0.026095548644661903,0.33763208985328674,-0.41291555762290955},{-0.05759076774120331,0.051162537187337875,0.24073828756809235,-0.10152596980333328,0.23624956607818604,0.27859732508659363,0.3068203330039978,-0.05566403269767761,-0.036499470472335815,0.2598477303981781,0.3381858468055725,-0.19592106342315674,-0.13910847902297974,-0.306194007396698,0.41101768612861633,0.1526923030614853},{0.017970681190490723,-0.185280442237854,-0.1389084756374359,-0.24030160903930664,0.12975117564201355,0.003063184441998601,0.014167779125273228,-0.13925158977508545,0.2125449925661087,-0.2394959032535553,-0.30163830518722534,0.18699778616428375,0.43252551555633545,0.0033758326899260283,-0.014760697260499,0.1167002022266388},{-0.04555446654558182,-0.014781951904296875,0.08715304732322693,-0.21978987753391266,0.20973370969295502,0.021258633583784103,0.07147519290447235,0.3335786461830139,0.3242590129375458,-0.006140819750726223,-0.31955403089523315,0.19134977459907532,-0.10581886768341064,0.2100888043642044,-0.17128659784793854,-0.24253541231155396},{0.0163650531321764,0.015858061611652374,0.23964586853981018,0.24214237928390503,-0.40693262219429016,-0.038052868098020554,0.37247031927108765,0.34130623936653137,-0.10101105272769928,0.2488306611776352,-0.4995729625225067,-0.3275665044784546,0.22325871884822845,0.3113718330860138,0.23221148550510406,0.12666036188602448},{0.28766775131225586,-0.23455587029457092,0.33651047945022583,-0.06843052059412003,0.24814298748970032,0.07167419791221619,-0.1308167427778244,-0.20987479388713837,0.09176657348871231,-0.30821970105171204,0.04996378347277641,-0.2942562699317932,-0.17246444523334503,0.36296796798706055,0.1594723016023636,-0.10907088965177536},{0.006952421274036169,-0.3759053647518158,-0.46450698375701904,-0.03323023021221161,-0.3167155385017395,0.20845991373062134,0.32293134927749634,0.24437005817890167,0.448142945766449,0.3436754047870636,-0.015548615716397762,-0.2907058298587799,0.10713831335306168,0.2656234800815582,-0.0629892647266388,-0.334105521440506},{0.0942971482872963,0.23841068148612976,0.4437532424926758,-0.34286385774612427,-0.3277464210987091,0.20855137705802917,0.14809103310108185,0.3861687481403351,-0.32208365201950073,-0.030460678040981293,-0.03730249032378197,0.16763633489608765,-0.30724841356277466,-0.17929144203662872,0.3333642780780792,-0.3433113992214203},{0.14909891784191132,-0.14082786440849304,-0.03388350084424019,0.12048736959695816,0.3204302489757538,0.27667567133903503,0.44314655661582947,0.004323111847043037,-0.0024478428531438112,0.005519261118024588,0.24813811480998993,-0.08942082524299622,-0.07704972475767136,-0.21252237260341644,0.2115613967180252,0.30049219727516174},{-0.16812807321548462,0.3654317557811737,0.15423625707626343,-0.3154125511646271,0.03527260944247246,0.13149665296077728,0.2691514194011688,-0.05136168748140335,0.10899456590414047,0.01512861531227827,-0.06201823055744171,0.14221207797527313,0.2310667335987091,0.30375489592552185,0.12868137657642365,-0.21551626920700073},{-0.23971518874168396,-0.21844731271266937,-0.20304137468338013,-0.02139098010957241,-0.17258675396442413,0.09095244109630585,-0.33014747500419617,0.10434138029813766,-0.08365243673324585,-0.032741185277700424,-0.2860231101512909,-0.07648870348930359,-0.31792783737182617,0.10955769568681717,0.24789945781230927,0.08416886627674103},{-0.1121123731136322,-0.4114460349082947,-0.2511005103588104,0.33210164308547974,0.036115292459726334,-0.3637586236000061,0.2873416244983673,-0.07961490750312805,-0.027699267491698265,0.31452199816703796,0.09379074722528458,0.1948862224817276,0.1818941831588745,-0.016878627240657806,-0.18496887385845184,0.1890989989042282},{0.5220193266868591,-0.10068660229444504,-0.25106197595596313,-0.41977667808532715,-0.6158312559127808,0.3229571282863617,0.4301622807979584,-0.30567413568496704,0.17197363078594208,0.11749351024627686,-0.32003751397132874,0.05158349499106407,-0.5559332370758057,0.5357692241668701,-0.2892563045024872,0.04045651853084564},{-0.366270512342453,-0.39441990852355957,0.39005541801452637,0.3637000620365143,-0.3188364505767822,0.3398137092590332,-0.14802710711956024,-0.3039931654930115,0.2474920004606247,-0.45180976390838623,-0.34542641043663025,-0.6445834636688232,-0.21173563599586487,-0.5115649104118347,-0.019210640341043472,-0.2029838114976883},{-0.3660195469856262,0.2812792658805847,-0.48781320452690125,-0.00038051640149205923,0.04388744384050369,0.3323728144168854,-0.2636300325393677,-0.40436938405036926,0.22204452753067017,0.2458728402853012,0.4127136170864105,-0.09110596776008606,-0.25101396441459656,0.3176765739917755,0.16262660920619965,-0.5101798176765442}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.147640198469162,-0.08151331543922424,-0.1815306842327118,-0.4253810942173004,0.4210396409034729,0.2826564908027649,0.07244352996349335,0.10240425914525986,-0.298123836517334,-0.10365668684244156,-0.11968901753425598,-0.016169382259249687,0.22776268422603607,0.5256879329681396,0.1651550978422165,0.05791386589407921},{-0.19243620336055756,-0.2709730863571167,-0.033516354858875275,0.13989214599132538,0.28304243087768555,-0.2859799265861511,0.18342562019824982,0.06732284277677536,-0.07986900210380554,0.2575847804546356,-0.13866649568080902,0.3454180955886841,-0.35307076573371887,0.22305183112621307,-0.3787039816379547,-0.25956544280052185},{0.12323196232318878,0.25346022844314575,-0.4191020429134369,-0.548093855381012,0.14259178936481476,0.4810456335544586,-0.10308296978473663,0.10074760019779205,-0.2267172485589981,-0.2551698684692383,-0.023691195994615555,0.29963114857673645,-0.353427529335022,-0.3070281744003296,0.17704540491104126,-0.07088806480169296},{0.2089991271495819,-0.038475401699543,0.08691833913326263,0.19786429405212402,-0.5135064721107483,0.04067564010620117,0.039371270686388016,-0.2670162618160248,0.3593756854534149,0.3829381763935089,-0.0928005501627922,-0.17005784809589386,-0.3816435933113098,-0.37492600083351135,0.21317866444587708,0.23621945083141327},{-0.18733175098896027,0.0397956483066082,0.05252380669116974,0.25748544931411743,-0.23333778977394104,0.0034300328698009253,-0.05927572771906853,0.18814945220947266,0.23039856553077698,-0.33405420184135437,0.03604377806186676,0.40925100445747375,0.12770618498325348,-0.416467547416687,-0.08129984885454178,-0.13168226182460785},{0.26781001687049866,0.23833273351192474,-0.04414934292435646,0.15503033995628357,-0.3747588098049164,-0.4134913682937622,0.2556459307670593,0.2944856584072113,0.10753831267356873,0.5032429099082947,0.23159801959991455,-0.2777840197086334,-0.004716213792562485,-0.14255860447883606,-0.05138152837753296,0.3108668029308319},{-0.01958855241537094,0.1638859659433365,0.3331001102924347,-0.38903555274009705,-0.17044754326343536,0.06810906529426575,-0.3025410771369934,-0.06726723909378052,0.07755238562822342,0.1091218888759613,-0.16372862458229065,-0.28873538970947266,-0.2987518012523651,0.08027137070894241,0.21967269480228424,0.05647514760494232},{-0.2025095671415329,-0.20702382922172546,-0.4104004502296448,0.2881335914134979,-0.2919822633266449,-0.3218323588371277,-0.19715963304042816,-0.34663769602775574,0.019323937594890594,-0.24208278954029083,-0.11905679106712341,0.17321765422821045,-0.2109948694705963,0.4098418354988098,-0.14742524921894073,-0.389988511800766},{-0.2631776034832001,0.2829938530921936,0.0181264728307724,0.0019842847250401974,0.315610408782959,-0.1986127644777298,0.4220670163631439,0.10716304183006287,0.30729588866233826,0.3889632225036621,0.3272151052951813,0.29395508766174316,0.24825432896614075,-0.05407845228910446,0.3017975986003876,0.155315563082695},{0.14045357704162598,-0.25546765327453613,-0.05946030840277672,-0.15780995786190033,0.31491103768348694,-0.03685160353779793,-0.2947702705860138,-0.2396799474954605,0.07762306183576584,-0.47422459721565247,-0.22344261407852173,0.230178102850914,0.11303628236055374,0.17383518815040588,-0.311213880777359,0.2562243342399597},{-0.18703286349773407,-0.3776273727416992,0.48953357338905334,0.2629756033420563,0.22584562003612518,0.13088271021842957,0.15572825074195862,-0.15041132271289825,0.1474410593509674,-0.25946345925331116,0.021492401137948036,0.3731677234172821,0.379485547542572,0.1355433166027069,-0.24606148898601532,-0.008731390349566936},{0.029451658949255943,-0.18529760837554932,0.31250494718551636,0.05607379227876663,-0.12020809203386307,-0.19766974449157715,0.44576454162597656,0.2603619694709778,-0.25200366973876953,-0.385865718126297,-0.12870939075946808,-0.29126888513565063,-0.008159237913787365,-0.30355656147003174,-0.3843647539615631,0.0020593178924173117},{-0.08221985399723053,-0.33452045917510986,0.31275081634521484,-0.18216979503631592,0.29971590638160706,-0.35073038935661316,-0.37938493490219116,0.17798909544944763,0.1298888474702835,-0.0424533486366272,-0.2966172695159912,0.09511863440275192,0.07630041986703873,-0.3403243124485016,-0.41094258427619934,-0.016863441094756126},{0.3021649122238159,-0.3552875220775604,0.4901137351989746,0.13189226388931274,0.10138832777738571,0.29632171988487244,-0.09827246516942978,-0.2370539754629135,-0.5458388924598694,0.08702542632818222,0.0006035995320416987,-0.425703763961792,0.02503260225057602,0.2814657688140869,0.32474860548973083,0.06781745702028275},{-0.2165166139602661,0.17372433841228485,0.08692415058612823,-0.34074655175209045,-0.2056335061788559,0.12257435917854309,0.2258048951625824,-0.1892908662557602,0.20697267353534698,-0.3912823498249054,-0.009155262261629105,0.08549880236387253,-0.08868460357189178,0.08118832111358643,-0.04321935027837753,-0.0019446081714704633},{-0.1763954609632492,0.35942527651786804,-0.3543919622898102,0.2885168492794037,0.17404568195343018,-0.3940218985080719,-0.14902238547801971,-0.05740329250693321,-0.42935746908187866,0.2776486873626709,-0.4339897036552429,0.3138129711151123,-0.09160508215427399,-0.16601228713989258,-0.2661427855491638,-0.5594807267189026}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.19390714168548584,0.016163315623998642,-0.0784289613366127,0.0014955000951886177,-0.1115451231598854,-0.005072286352515221,0.2949683368206024,-0.0012907315976917744,-0.10704998672008514,-0.14519928395748138,0.09583315253257751,-0.3279610574245453,-0.21467225253582,0.23074659705162048,0.20410478115081787,0.25592225790023804,-0.2804088294506073,-0.3253231346607208,-0.2569970190525055,0.014227205887436867,-0.017577458173036575,-0.37437930703163147,-0.22403597831726074,-0.29808780550956726,-0.329725444316864,0.25998637080192566,-0.2798859775066376,-0.04866620525717735,6.199863855727017e-05,-0.015032651834189892,0.16413021087646484,-0.14219503104686737},{0.20670099556446075,0.2535390853881836,0.08560909330844879,-0.08207085728645325,0.11877308785915375,-0.045023657381534576,0.3267366886138916,0.09833303093910217,-0.2454259842634201,-0.1472669243812561,-0.04376636818051338,-0.3161078095436096,-0.20204630494117737,0.21239861845970154,-0.19445419311523438,-0.3064829707145691,-0.022167565301060677,0.19754646718502045,-0.3623928129673004,-0.3331504762172699,-0.034768953919410706,0.30848535895347595,0.14969086647033691,-0.12202756106853485,0.13289819657802582,-0.24180015921592712,0.011714372783899307,0.15446890890598297,0.22208571434020996,-0.15897870063781738,-0.021965276449918747,0.22185131907463074},{0.264080286026001,0.07012322545051575,-0.05430134758353233,0.19269099831581116,-0.23625555634498596,-0.21050620079040527,-0.3237689137458801,0.1639351099729538,-0.10820268094539642,0.38072460889816284,-0.2676406800746918,-0.1396908015012741,0.13812346756458282,-0.4281775653362274,-0.12105603516101837,0.07721982896327972,-0.1734839230775833,-0.20065435767173767,0.29829397797584534,-0.023996787145733833,0.29687970876693726,0.18773195147514343,-0.24915218353271484,0.008817702531814575,-0.22667208313941956,-0.10850539803504944,0.18070204555988312,-0.13989372551441193,-0.038265664130449295,-0.132017582654953,-0.11150410771369934,-0.05551927164196968},{0.35528767108917236,0.08913391083478928,0.08609064668416977,-0.1330718845129013,-0.29292163252830505,-0.09405810385942459,-0.18194134533405304,0.2754805088043213,0.2581007480621338,-0.22181233763694763,-0.08338708430528641,0.32501354813575745,0.08154144138097763,-0.17066045105457306,-0.20425023138523102,0.30625486373901367,-0.3306726813316345,0.20575091242790222,0.010299398563802242,0.09997313469648361,-0.030534101650118828,-0.11765988916158676,0.29605984687805176,0.16384516656398773,0.17876306176185608,-0.351508766412735,0.3471751809120178,-0.23935706913471222,-0.025211162865161896,0.05010334402322769,-0.292864054441452,0.17938238382339478},{-0.032140135765075684,-0.06332977861166,-0.08091290295124054,0.051484063267707825,0.18371017277240753,-0.19780775904655457,-0.3724837601184845,-0.02447219379246235,-0.12767618894577026,-0.17659920454025269,0.1345178633928299,0.23169896006584167,-0.05084819346666336,-0.08270874619483948,-0.0960768386721611,0.2026207000017166,-0.07603323459625244,-0.031453464180231094,-0.3396877944469452,-0.07696634531021118,-0.15302717685699463,-0.38155490159988403,0.16909635066986084,0.22720542550086975,-0.06380663812160492,0.2886206805706024,-0.17428036034107208,0.1871630698442459,0.3086472749710083,0.3518158793449402,-0.04013242572546005,0.30561456084251404},{-0.2609160244464874,-0.06838511675596237,-0.18672233819961548,-0.031222423538565636,-0.17898349463939667,0.254981130361557,0.20073777437210083,0.0234458539634943,0.2933884263038635,0.15703898668289185,0.33753305673599243,-0.22937099635601044,-0.1874922662973404,0.2278498113155365,0.30914390087127686,-0.3775373697280884,-0.1132558211684227,-0.24364756047725677,0.23049461841583252,0.0777115449309349,0.0945279598236084,0.13851846754550934,0.026529835537075996,-0.050850819796323776,-0.37919771671295166,0.36157190799713135,-0.2054414004087448,0.1744493544101715,0.3822196125984192,0.22200286388397217,0.074429452419281,0.09187217801809311},{0.16733935475349426,-0.10149040073156357,-0.1676257848739624,-0.3212926983833313,-0.05125334486365318,0.22137531638145447,0.2600420415401459,0.1469886600971222,0.07931045442819595,0.3570128381252289,0.003209237474948168,0.001191349932923913,-0.42540639638900757,-0.1742384433746338,-0.13706770539283752,0.0587138831615448,-0.3160005211830139,-0.24653033912181854,0.18033702671527863,-0.10752478986978531,-0.09166409075260162,-0.14942201972007751,-0.19348886609077454,-0.27133771777153015,0.17042504251003265,-0.23667322099208832,-0.09311763197183609,-0.2213849574327469,0.362333208322525,0.1057368665933609,-0.1957208812236786,-0.26147639751434326},{0.060173094272613525,0.17808231711387634,0.04841143265366554,-0.14831429719924927,0.15003561973571777,-0.29927194118499756,-0.03630690276622772,-0.15732362866401672,-0.009408782236278057,-0.26713305711746216,-0.33749642968177795,-0.12420245260000229,-0.11874137818813324,0.060818836092948914,-0.1588592231273651,0.43173232674598694,0.00981687568128109,-0.12664273381233215,0.09461104869842529,0.3390810489654541,-0.19998665153980255,-0.17529594898223877,0.2883938252925873,0.09216802567243576,0.015675220638513565,-0.3423183560371399,-0.33797764778137207,-0.20725508034229279,-0.3875397741794586,-0.29184213280677795,0.092403344810009,-0.40457019209861755},{0.027168074622750282,0.5284384489059448,-0.444886714220047,-0.403732568025589,-0.34021440148353577,0.1880604326725006,0.055965106934309006,0.17673538625240326,-0.05235627293586731,-0.28133755922317505,-0.07692264020442963,0.31007662415504456,-0.45894333720207214,-0.26817819476127625,0.2604338824748993,-0.20086318254470825,0.21902522444725037,0.16168351471424103,0.4144352674484253,0.05304987356066704,0.15360479056835175,0.25467076897621155,0.4168694317340851,-0.18971097469329834,0.4762423038482666,-0.2317904531955719,0.31599360704421997,0.44915860891342163,-0.15139387547969818,0.09046101570129395,0.05184858292341232,0.10424604266881943},{-0.28470778465270996,0.0927417129278183,-0.44145211577415466,-0.23741906881332397,0.10769818723201752,-0.28267887234687805,0.18561390042304993,-0.05595763400197029,0.2066933661699295,0.16469421982765198,-0.32935798168182373,-0.4233399033546448,-0.4656958281993866,-0.12345417588949203,-0.30476170778274536,0.14505234360694885,-0.08040407299995422,-0.2665996253490448,0.0994647815823555,0.08027531951665878,0.07669226080179214,0.00017029511218424886,0.42128369212150574,-0.14560553431510925,0.36240941286087036,0.199810191988945,-0.2709561586380005,0.016887519508600235,-0.002522343071177602,-0.06880306452512741,-0.2853940427303314,0.09864497184753418},{0.09322122484445572,0.039967913180589676,0.10771943628787994,-0.2993413209915161,-0.31862786412239075,-0.23471201956272125,-0.26089751720428467,-0.0164568442851305,-0.20676016807556152,0.395207941532135,0.15249468386173248,-0.2780873775482178,-0.3850797116756439,-0.08850709348917007,-0.20995503664016724,-0.11406758427619934,0.1894264668226242,-0.16555337607860565,0.2733725607395172,-0.19909483194351196,-0.17755962908267975,0.0489923320710659,0.2367085963487625,0.17834033071994781,0.20755340158939362,-0.14163722097873688,-0.018853846937417984,-0.06337045133113861,-0.034615591168403625,-0.02232176810503006,-0.08831927180290222,0.17171159386634827},{-0.20287777483463287,-0.03815633803606033,0.21881042420864105,0.2513306438922882,0.27317115664482117,0.012815660797059536,0.09806054085493088,-0.19215179979801178,-0.12036190181970596,-0.22667308151721954,0.2941163182258606,-0.24086833000183105,-0.21375951170921326,-0.17850486934185028,0.27457550168037415,0.04851669445633888,0.008797314949333668,0.057870689779520035,0.3621423840522766,0.10317198932170868,-0.2286718487739563,0.28453779220581055,0.10896747559309006,-0.061028510332107544,0.2622353732585907,-0.14525842666625977,-0.1217854842543602,0.2522788941860199,0.17851318418979645,-0.031225956976413727,-0.23856188356876373,-0.3008612096309662},{0.2720628082752228,-0.2609710991382599,-0.019260112196207047,-0.31065770983695984,0.07686614990234375,-0.16251179575920105,0.12411731481552124,0.09755777567625046,0.2900473475456238,0.10668512433767319,0.115685373544693,0.22552892565727234,-0.3497922718524933,-0.30702468752861023,-0.08116224408149719,-0.22895845770835876,-0.199997678399086,-0.26669934391975403,0.26589205861091614,-0.2171839028596878,0.339937686920166,-0.07544276863336563,-0.02106332965195179,0.19422583281993866,0.14499680697917938,-0.11574320495128632,0.10457971692085266,0.05151201784610748,0.1447811871767044,-0.058252885937690735,-0.2839323580265045,-0.06731180846691132},{0.2169349491596222,-0.13351140916347504,-0.038127679377794266,0.44403180480003357,-0.07798118144273758,-0.27555525302886963,-0.038578204810619354,0.043370410799980164,0.26933610439300537,0.3837263286113739,0.05490688979625702,-0.17314809560775757,0.10576627403497696,0.23976005613803864,-0.14150451123714447,0.040367644280195236,0.16831064224243164,-0.2752276659011841,-0.0017326032975688577,-0.36711955070495605,0.3620370030403137,0.0669533908367157,-0.11463332921266556,0.22592495381832123,0.15571777522563934,0.1699867695569992,0.035795826464891434,-0.03261087089776993,0.08304179459810257,-0.17001135647296906,-0.0947011411190033,0.4114146828651428},{-0.007992184720933437,-0.2657912075519562,-0.11644510179758072,0.13097655773162842,-0.26488903164863586,-0.011803075671195984,0.058099668473005295,-0.29169684648513794,-0.13683652877807617,-0.013201779685914516,0.18165385723114014,0.11288705468177795,0.07748302072286606,0.24298201501369476,-0.057849373668432236,-0.10761633515357971,-0.2383078783750534,0.26318418979644775,-0.14284378290176392,-0.3101122975349426,-0.17344674468040466,-0.07964076101779938,0.18949712812900543,0.0028000888414680958,-0.061551399528980255,-0.024784892797470093,-0.2382785528898239,0.22117912769317627,0.09095657616853714,-0.20986050367355347,0.19930562376976013,0.207614466547966},{0.11078807711601257,-0.1715838760137558,-0.1555863618850708,-0.16291671991348267,-0.14817100763320923,0.13010340929031372,0.028864124789834023,0.24069049954414368,-0.1404406875371933,0.08091460913419724,0.26938679814338684,0.09901591390371323,-0.08609313517808914,-0.1811036467552185,0.047140128910541534,0.15870079398155212,-0.4854913353919983,-0.29920437932014465,-0.05974816158413887,0.01679856888949871,0.1394314467906952,0.24391703307628632,0.33332735300064087,0.10484442114830017,0.04115966707468033,0.24478593468666077,0.03575238585472107,-0.07541339844465256,0.22903816401958466,-0.1636168360710144,-0.329819917678833,0.3979135751724243},{0.16415032744407654,0.008076190017163754,-0.27167636156082153,0.18773166835308075,0.07853782922029495,-0.027989575639367104,0.2588903605937958,0.10771787166595459,0.10982756316661835,-0.198027104139328,0.24204663932323456,-0.1867990791797638,-0.4229186475276947,0.23351061344146729,0.07895083725452423,0.02054666355252266,0.04367309436202049,-0.07645612955093384,-0.13840128481388092,0.026438629254698753,-0.05165485292673111,0.19402481615543365,0.09702026844024658,-0.16784653067588806,0.0036484140437096357,-0.23279356956481934,0.041977111250162125,0.39839839935302734,0.2850639224052429,-0.14287987351417542,0.20759499073028564,0.22350142896175385},{-0.03230821341276169,-0.03648903965950012,-0.07110840827226639,-0.030067438259720802,-0.2599383592605591,-0.031273599714040756,0.18463292717933655,0.21080416440963745,0.1431548148393631,-0.0068408288061618805,0.23531413078308105,0.03222106769680977,0.21261875331401825,0.14595039188861847,0.18170900642871857,-0.0957745686173439,0.12424927949905396,0.16366176307201385,0.25674909353256226,0.08070557564496994,0.19850294291973114,0.2282772809267044,0.060880500823259354,0.13794133067131042,-0.02160160429775715,-0.10333887487649918,-0.1053614616394043,-0.2554841935634613,0.1750691831111908,-0.2175440490245819,0.04137371480464935,-0.026916293427348137},{-0.360009104013443,0.08428367972373962,-0.32425472140312195,-0.33255916833877563,-0.006901673506945372,0.04992165416479111,0.13148713111877441,-0.16129745543003082,0.009420820511877537,0.31980541348457336,0.07020644098520279,-0.2254442721605301,0.014447168447077274,-0.15494364500045776,-0.30060479044914246,-0.046530723571777344,-0.19045090675354004,0.12004316598176956,-0.03996624797582626,-0.0918504074215889,-0.31458279490470886,0.1796914041042328,0.14419540762901306,0.01481255516409874,-0.03713623434305191,0.31126660108566284,0.022937605157494545,-0.14592644572257996,-0.15611031651496887,0.0013567139394581318,-0.16370806097984314,-0.23964418470859528},{0.020659364759922028,-0.22894905507564545,-0.211630716919899,-0.025620950385928154,-0.3360447585582733,-0.17122399806976318,0.15757891535758972,-0.2860397696495056,-0.18995536863803864,0.17665530741214752,0.13205493986606598,0.12581290304660797,0.14001987874507904,-0.10708816349506378,0.2982473075389862,-0.29969891905784607,0.07684441655874252,0.22750218212604523,0.04847584664821625,0.2620423138141632,0.05132192373275757,-0.13974548876285553,-0.30041009187698364,0.21929022669792175,-0.14899271726608276,-0.17959550023078918,0.0846787616610527,0.005975271575152874,-0.13204088807106018,-0.2869805097579956,-0.030562520027160645,-0.1553538292646408},{0.21748024225234985,0.17782726883888245,-0.06646691262722015,0.14733774960041046,-0.2627505660057068,0.18115580081939697,-0.049617718905210495,-0.14919380843639374,-0.19771260023117065,0.1981169879436493,-0.26221778988838196,-0.15728318691253662,-0.03587494418025017,-0.1714741587638855,-0.37225085496902466,-0.13868117332458496,-0.0790519043803215,-0.25574934482574463,-0.2167954444885254,0.29347407817840576,0.0828629583120346,0.1331808865070343,-0.33689239621162415,0.33547350764274597,0.1855485886335373,0.24887703359127045,-0.28413185477256775,-0.03008088655769825,0.06386164575815201,-0.2624753415584564,0.14345484972000122,0.08596578985452652},{0.008393988944590092,-0.32542043924331665,0.025053558871150017,-0.30270594358444214,-0.03699515014886856,0.257058322429657,0.19022095203399658,0.026112455874681473,-0.026750285178422928,0.006312867626547813,-0.24396629631519318,0.13961826264858246,0.16938719153404236,0.11673519015312195,0.11654815822839737,0.027128560468554497,-0.06240472570061684,0.14109672605991364,-0.12346764653921127,0.18151111900806427,0.20784658193588257,0.23211373388767242,-0.0991128459572792,-0.2140558511018753,0.12322776019573212,0.1136946901679039,0.23764348030090332,0.12232628464698792,-0.04255092889070511,0.17497318983078003,0.03731319308280945,-0.12653537094593048},{0.03311287984251976,-0.18349266052246094,0.24689291417598724,-0.006212164182215929,0.29143011569976807,-0.03052598237991333,-0.1190863847732544,-0.15882906317710876,0.1439713090658188,-0.06923796236515045,0.0702073946595192,0.008379141800105572,-0.23548904061317444,0.024538494646549225,-0.10634974390268326,-0.24379241466522217,-0.04203734174370766,-0.03369231894612312,0.22021882236003876,0.2624218463897705,0.019251488149166107,0.05237280949950218,0.17151649296283722,0.3348948359489441,-0.15355652570724487,-0.0882958397269249,0.21360136568546295,-0.0936218872666359,-0.22802045941352844,-0.23538358509540558,0.30014774203300476,-0.009103775955736637},{0.2095068097114563,-0.03725987672805786,0.0539775975048542,0.13812698423862457,-0.0494951456785202,0.07387431710958481,-0.2920418381690979,0.30307435989379883,-0.10802248120307922,-0.06513942778110504,0.12135238945484161,-0.24928760528564453,0.006209553685039282,-0.05637381598353386,-0.07329873740673065,0.27727317810058594,-0.06704222410917282,-0.197678804397583,0.06020308658480644,-0.021248668432235718,-0.15748198330402374,0.2056424617767334,0.23261769115924835,0.20268405973911285,-0.28531214594841003,0.1133803129196167,-0.04499736800789833,0.08642484247684479,-0.27469509840011597,0.30409008264541626,-0.011886617168784142,0.05843348056077957}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.254266619682312,-0.10414090752601624,0.18753917515277863,-0.21394164860248566},{0.22221073508262634,-0.3771093785762787,0.30502617359161377,0.2972921133041382},{-0.3654794692993164,0.12140852957963943,0.0981115773320198,-0.01005280390381813},{0.242051362991333,0.5860081911087036,0.3781818151473999,0.03719223663210869},{-0.2958584725856781,0.14439135789871216,-0.35853636264801025,0.11357278376817703},{-0.07395974546670914,-0.0959317684173584,0.11637138575315475,0.5387716293334961},{-0.08389707654714584,-0.10634420812129974,-0.44448256492614746,0.04849347472190857},{-0.1465037763118744,-0.293744295835495,0.2712835669517517,-0.08019205927848816},{-0.07918423414230347,0.15380394458770752,-0.11605846136808395,-0.18156911432743073},{0.3026193678379059,0.07312251627445221,-0.11704191565513611,-0.28937867283821106},{0.20810241997241974,-0.1047910824418068,0.3586614727973938,0.3011924922466278},{-0.11640922725200653,0.000858858460560441,0.5180400013923645,-0.12029525637626648},{-0.46544349193573,0.31117939949035645,-0.0036097581032663584,-0.15441672503948212},{-0.20223557949066162,0.14926275610923767,-0.2867390811443329,0.13623064756393433},{0.15192881226539612,0.032496124505996704,0.3203583061695099,0.15104906260967255},{-0.1594662368297577,-0.35086047649383545,-0.14884540438652039,-0.15613603591918945},{-0.4240797162055969,0.026028050109744072,-0.11252439767122269,0.37125518918037415},{-0.3447626829147339,-0.15437328815460205,-0.2214464396238327,0.2763494551181793},{-0.07450025528669357,-0.2095860093832016,0.47074687480926514,0.04776053875684738},{-0.2652244567871094,-0.21769359707832336,0.040966976433992386,-0.20783957839012146},{0.185077503323555,0.1819067895412445,0.19785386323928833,-0.2657453119754791},{-0.030007146298885345,-0.38669905066490173,-0.12287398427724838,0.3967534899711609},{0.4975607097148895,-0.32550787925720215,0.13116604089736938,0.10276637971401215},{-0.3711997866630554,-0.0916144922375679,-0.31319278478622437,-0.40533098578453064},{-0.1435241401195526,-0.3319726884365082,-0.12934614717960358,-0.10699441283941269},{0.2003212869167328,0.22064487636089325,-0.10828647762537003,0.08531215041875839},{0.12261426448822021,-0.22542497515678406,0.3651480972766876,0.08009634912014008},{-0.06895415484905243,-0.2107529491186142,-0.05330611765384674,0.3833944797515869},{0.199300155043602,0.06473325192928314,0.07298274338245392,0.056605007499456406},{-0.17853088676929474,0.11951179057359695,0.3044055998325348,0.04517456516623497},{-0.29779189825057983,-0.06402584165334702,0.09189987927675247,0.3246856927871704},{0.3526063561439514,0.2434043288230896,0.2908092439174652,-0.04328267276287079}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09001310169696808,-0.13515423238277435,0.08933238685131073,0.09540709853172302,0.08910991996526718,-0.196852445602417,0.09612253308296204,0.02813580632209778,-0.08223429322242737,-0.04171016439795494,-0.001117236097343266,-0.022683527320623398,-0.010341412387788296,0.0997505709528923,0.11987952142953873,-0.028441675007343292};
static const float actor_encoder_self_encoder_2_bias[16] = {0.016028450801968575,0.05342346429824829,0.0452469177544117,-0.05599699169397354,-0.048879317939281464,0.07900451123714447,-0.06307584047317505,-0.0951167494058609,0.03484933823347092,-0.025475939735770226,-0.025982117280364037,0.006133932154625654,-0.015105067752301693,-0.0818341001868248,0.043711107224226,-0.09239005297422409};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04439017176628113,-0.010028990916907787,-0.05664253607392311,0.05757952854037285,0.012918205931782722,0.02152520976960659,-0.0527372807264328,-0.05415812507271767,-0.007503813598304987,-0.030969737097620964,0.01843372918665409,0.025606554001569748,-0.0006593157886527479,-0.012599356472492218,0.034923259168863297,-0.0855274423956871,0.0017703322228044271,-0.02899354137480259,0.022054214030504227,-0.06700355559587479,0.015007523819804192,-0.011566905304789543,0.013129209168255329,-0.06556709110736847,-0.07276234030723572,0.06377410143613815,0.02666516602039337,-0.011757871136069298,0.05360310524702072,0.021708110347390175,-0.00411641551181674,0.05159781500697136};
static const float action_parameterization_distribution_linear_bias[4] = {0.023749621585011482,0.06481998413801193,0.006023004651069641,0.041787829250097275};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3167054355144501,-0.23544031381607056,-0.1342705488204956,0.195912703871727,-0.1179947480559349,0.07204311341047287,-0.2767910361289978,-0.010889108292758465},{0.09412664920091629,0.157126784324646,0.3055226802825928,0.3330833613872528,-0.11492519080638885,-0.30536094307899475,0.30959802865982056,0.25107941031455994},{0.01579759083688259,0.21685105562210083,0.04480966925621033,-0.07593855261802673,0.3418419659137726,0.23773540556430817,-0.04633224382996559,0.16260454058647156},{0.07480622082948685,-0.27196937799453735,0.2600933313369751,-0.25760582089424133,-0.23732246458530426,0.07701412588357925,0.22602824866771698,0.2114204615354538},{-0.24226155877113342,0.008516962639987469,-0.08943470567464828,-0.3846937417984009,0.12454184889793396,0.07694559544324875,0.29056620597839355,0.2505453824996948},{-0.056607771664857864,0.3001788556575775,-0.06682141125202179,-0.30296140909194946,0.26712697744369507,0.04424244165420532,0.034322094172239304,-0.19221994280815125},{0.019716966897249222,0.31562596559524536,0.13947978615760803,-0.21305042505264282,0.3410896360874176,-0.22322265803813934,0.14737153053283691,0.10477489978075027},{0.07846001535654068,-0.22459156811237335,-0.03949957340955734,-0.2549419403076172,0.2770850360393524,-0.13291162252426147,-0.17057809233665466,-0.30060282349586487},{-0.22376786172389984,0.30547288060188293,0.024387245997786522,-0.06119777262210846,0.014360240660607815,0.2836100161075592,0.39281293749809265,0.36875584721565247},{0.024438917636871338,-0.01679554581642151,-0.29230040311813354,0.2910047173500061,0.28918513655662537,0.20205473899841309,0.2537805438041687,-0.25722798705101013},{-0.14177605509757996,-0.28605422377586365,0.32841557264328003,0.1653524488210678,-0.004037368111312389,-0.338875949382782,-0.07284833490848541,-0.32183021306991577},{0.29121923446655273,0.09153711795806885,0.35279518365859985,0.35403233766555786,-0.1578388661146164,0.2432013750076294,0.12099307030439377,-0.3684743642807007},{-0.32968300580978394,0.17460650205612183,-0.37821123003959656,0.3976413309574127,-0.02149546891450882,0.3405797481536865,-0.0032514489721506834,0.25497427582740784},{0.013447392731904984,0.22552184760570526,-0.15192878246307373,-0.1509924829006195,0.04437393695116043,0.05087481811642647,0.3163735866546631,0.010128342546522617},{0.2134975641965866,-0.263556569814682,-0.34741172194480896,-0.19657304883003235,0.1852578967809677,-0.2193543165922165,0.19171924889087677,-0.06742545962333679},{-0.38528957962989807,-0.33933475613594055,-0.26130878925323486,0.002451544627547264,0.04133403301239014,0.14190348982810974,0.25687137246131897,-0.008255011402070522},{-0.1583448052406311,-0.2685292363166809,0.17131197452545166,-0.3231934905052185,0.10780001431703568,0.017253771424293518,-0.4244065582752228,-0.18641020357608795},{0.0751674473285675,0.24330322444438934,0.07462557405233383,0.17786239087581635,-0.020681291818618774,0.334113210439682,0.2928273379802704,-0.14354178309440613},{0.04135648161172867,-0.31083810329437256,-0.1538093090057373,-0.06274102628231049,-0.06647004187107086,-0.3563593327999115,0.08677943795919418,-0.23424898087978363},{-0.05854638293385506,0.010149030014872551,0.015496942214667797,-0.27655112743377686,0.11962065100669861,0.10662496089935303,0.17600776255130768,-0.039333488792181015},{0.07369814813137054,-0.07470328360795975,0.005665787495672703,-0.20522761344909668,0.042128462344408035,-0.03677523508667946,0.11614393442869186,-0.15576863288879395},{-0.31508874893188477,0.1835036426782608,0.12649518251419067,-0.24957992136478424,-0.40369555354118347,-0.02796379290521145,0.27958157658576965,0.06440342962741852},{0.2752836048603058,0.07709765434265137,-0.40255942940711975,0.053456347435712814,-0.017457377165555954,0.22820711135864258,0.3248654305934906,0.3485695719718933},{-0.00699892221018672,-0.19144092500209808,-0.0046067191287875175,0.20569606125354767,-0.29166558384895325,-0.042375046759843826,-0.09121846407651901,-0.274616539478302},{0.15284059941768646,-0.058016322553157806,-0.43497082591056824,0.3361087441444397,-0.28261420130729675,-0.19883348047733307,-0.37177786231040955,0.13807828724384308},{-0.011859032325446606,0.30491867661476135,-0.2758791148662567,-0.07470417022705078,0.11881958693265915,-0.16043193638324738,0.333371102809906,-0.31482216715812683},{-0.1137750893831253,0.06485573947429657,-0.14705806970596313,-0.1876683384180069,0.07105439156293869,-0.12731853127479553,-0.09083402156829834,-0.14872096478939056},{0.08015294373035431,-0.1886412650346756,-0.025654982775449753,-0.110951267182827,0.06950124353170395,0.05444682016968727,-0.20052470266819,0.07795947045087814},{0.2632438838481903,0.038949958980083466,-0.34705740213394165,-0.23778310418128967,-0.20439943671226501,0.1319628357887268,0.21912294626235962,0.0703553631901741},{0.30273765325546265,-0.34345802664756775,0.03459988161921501,-0.07314489036798477,0.13798026740550995,-0.11806312203407288,0.18143267929553986,0.32181552052497864},{-0.3101220726966858,-0.23726066946983337,0.03605934605002403,-0.34601935744285583,0.29965198040008545,-0.2581874430179596,-7.981139788171276e-05,0.08462746441364288},{0.1593114733695984,0.12017796188592911,-0.11235207319259644,0.24724949896335602,0.044481851160526276,-0.03886305168271065,-0.022537866607308388,0.037703681737184525}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23783500492572784,0.4362693130970001,-0.5384950637817383,-0.5318350195884705,-0.22435854375362396,-0.05444970354437828,-0.43716681003570557,0.5818642377853394},{-0.06901148706674576,0.4795350134372711,-0.27349191904067993,0.6226077675819397,-0.03258844465017319,-0.009360668249428272,-0.3332628607749939,0.03001505881547928},{-0.4017615020275116,-0.1929866522550583,-0.1277465671300888,-0.08999574184417725,0.4736824333667755,0.25643405318260193,-0.033646322786808014,0.40720346570014954},{-0.5101963877677917,-0.5442671775817871,0.33359143137931824,0.3308725953102112,-0.4680728614330292,-0.2209877371788025,0.43071016669273376,0.22657226026058197},{-0.29883962869644165,-0.23212172091007233,-0.32151123881340027,-0.23172616958618164,0.326317697763443,-0.22298279404640198,0.5166675448417664,-0.41049298644065857},{-0.02884279564023018,0.21767497062683105,0.20403601229190826,-0.5364328026771545,0.5477254390716553,-0.27032551169395447,-0.466337114572525,-0.4093196988105774},{-0.34008994698524475,0.16913080215454102,0.09423772245645523,-0.4902523458003998,-0.016501406207680702,-0.5319289565086365,0.49726995825767517,0.023986272513866425},{-0.3934183418750763,-0.1970287263393402,-0.13328038156032562,-0.32834750413894653,-0.3434901833534241,0.13511689007282257,0.5552010536193848,-0.3109656870365143}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.006734437774866819,-0.13611845672130585,-0.1361304223537445,-0.009897853247821331,0.09830542653799057,0.04061384126543999,0.08365650475025177,0.06940602511167526};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.04469968006014824,-0.04357410594820976,-0.03275164216756821,-0.12267100811004639,-0.08590330928564072,-0.06945794075727463,-0.0039993030950427055,-0.14793698489665985};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

