#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.31571924686431885,0.027360331267118454,0.06107676029205322,0.26025569438934326,0.2952550947666168,-0.2358776330947876,-0.3022972643375397,0.13106951117515564,0.3738768398761749,-0.3028072416782379,0.4532584547996521,0.08778111636638641,0.25164586305618286,0.09316761046648026,-0.30961906909942627,0.011396677233278751},{-0.32548636198043823,-0.21209357678890228,-0.2572639584541321,-0.07696659117937088,0.17991088330745697,0.40703272819519043,0.17622795701026917,-0.014995051547884941,0.18529485166072845,0.24567244946956635,-0.09332972019910812,-0.003768554190173745,-0.10336188971996307,0.10484080016613007,0.30448266863822937,-0.22525286674499512},{-0.04083746299147606,0.2099454253911972,0.24406558275222778,0.32500481605529785,0.06621657311916351,-0.31383979320526123,0.8672098517417908,-0.2869836091995239,-0.23110249638557434,-0.0018401299603283405,-0.00978551059961319,-0.2527855634689331,0.3522241413593292,0.6382932662963867,-0.5331593155860901,0.1870022565126419},{0.16640107333660126,-0.15986594557762146,-0.15290376543998718,-0.02466553822159767,-0.1736941933631897,0.10844972729682922,-0.05580195412039757,-0.23425602912902832,0.005209813360124826,-0.10380880534648895,0.5976012945175171,-0.2323407381772995,-0.35039517283439636,-0.19494983553886414,0.2189980149269104,-0.05306737497448921},{-0.18133588135242462,-0.03116932138800621,0.17540675401687622,-0.4352075159549713,0.479708194732666,0.24888689815998077,0.2316277027130127,-0.20042946934700012,-0.19806160032749176,0.2945486009120941,-0.07692229747772217,-0.4322623610496521,-0.009743301197886467,-0.21761223673820496,0.4454222619533539,-0.03108695149421692},{-0.022966891527175903,-0.1377936601638794,-0.06911256909370422,-0.07397092133760452,0.07455036044120789,-0.2434411197900772,0.6096227169036865,-0.3177777826786041,-0.22589240968227386,-0.2122005671262741,0.1575019657611847,0.05766752362251282,0.3198716342449188,0.023513000458478928,0.3034474849700928,0.23616668581962585},{-0.13831941783428192,0.2675780951976776,-0.020031724125146866,0.09879954904317856,-0.27051210403442383,-0.10069717466831207,-0.0661076158285141,0.02619793266057968,0.3392683267593384,0.30756986141204834,-0.3125683665275574,-0.1483469009399414,0.26625630259513855,-0.08471861481666565,-0.08072234690189362,0.22416327893733978},{-0.3656080663204193,0.23720131814479828,-0.012347309850156307,-0.29963621497154236,0.34981825947761536,-0.2905309498310089,-0.3538501262664795,-0.5232359766960144,-0.09154053032398224,-0.23597344756126404,0.5604386329650879,0.165187805891037,-0.008143266662955284,0.49466222524642944,0.054158106446266174,0.6580848097801208},{0.31198054552078247,0.13443082571029663,-0.22950850427150726,0.04018326848745346,-0.6354807615280151,-0.5840123891830444,0.1637459695339203,-0.6004719138145447,-0.051240842789411545,-0.17677636444568634,0.3483349680900574,-0.6056554317474365,-0.5167016983032227,0.09908516705036163,0.04748276248574257,-0.33021506667137146},{0.6883576512336731,-0.8728240728378296,-0.386616587638855,0.116115041077137,0.18286637961864471,-0.3207011818885803,-0.039928220212459564,-0.20157724618911743,-0.4200498163700104,-0.03536134213209152,-0.31391140818595886,-0.32084476947784424,0.578644335269928,-0.3254135549068451,-0.7178857326507568,-0.30448517203330994},{0.31342074275016785,0.3166883885860443,-0.12216603755950928,0.07198477536439896,0.07786057889461517,-0.18981622159481049,-0.09963811933994293,0.154004767537117,-0.03912663087248802,0.20947930216789246,0.19431839883327484,0.21805791556835175,-0.13383224606513977,0.1516808122396469,0.04085294529795647,-0.3552339971065521},{-0.44160014390945435,0.287198007106781,0.6018458008766174,-0.9204651713371277,0.14641812443733215,0.17890678346157074,0.15674610435962677,0.35239383578300476,0.32462605834007263,0.46765515208244324,0.49833276867866516,-0.4000415802001953,0.346402108669281,-0.21259215474128723,0.05118631571531296,-0.21621984243392944},{0.12394122034311295,-0.3123777210712433,-0.2891429364681244,0.3180827498435974,-0.23112162947654724,-0.2907536029815674,-0.06520398706197739,0.3277110159397125,0.26232457160949707,-0.1504976898431778,-0.24481654167175293,0.2704249620437622,0.36448934674263,0.3262975513935089,-0.20394544303417206,0.6212716102600098},{0.25694313645362854,0.30358219146728516,-0.32792046666145325,0.07372993975877762,-0.113086998462677,-0.12052411586046219,-0.2711053788661957,0.20081961154937744,-0.25938504934310913,-0.3680991232395172,-0.054116908460855484,0.10235567390918732,-0.5973829627037048,-0.10686624050140381,-0.265114963054657,-0.17212975025177002},{0.15678103268146515,0.5787390470504761,0.41088318824768066,-0.4172734022140503,-0.3699447810649872,0.25697648525238037,-0.08249275386333466,0.04077423736453056,0.5360569953918457,0.2900533080101013,-0.22340014576911926,0.12944187223911285,-0.20628374814987183,-0.36659231781959534,0.18522660434246063,-0.36240649223327637},{-0.3122602701187134,-0.04583878070116043,-0.03421784192323685,0.2242402881383896,-0.022655699402093887,0.022270580753684044,-0.13494561612606049,-0.017616722732782364,-0.3827059864997864,-0.09277819842100143,0.2507078945636749,0.09067527204751968,-0.18895170092582703,-0.21417196094989777,-0.39937517046928406,-0.10216919332742691},{-0.28163400292396545,0.1534726768732071,-0.20125223696231842,0.0030049991328269243,-0.12535089254379272,0.31127533316612244,0.32116836309432983,0.14804314076900482,0.22848868370056152,-0.2371172159910202,-0.04506855458021164,-0.11333485692739487,-0.016490260139107704,0.041545890271663666,-0.014383315108716488,-0.14875294268131256},{0.12081939727067947,-0.426341712474823,0.1350715458393097,0.1958368420600891,0.00502466456964612,0.28692615032196045,0.3475220799446106,0.13623583316802979,-0.14033466577529907,-0.23358109593391418,-0.12435503304004669,-0.12247087061405182,-0.11534550040960312,-0.3829304575920105,0.0708598792552948,0.0161029901355505}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14561717212200165,0.32027050852775574,0.35563838481903076,-0.08868050575256348,-0.1856299340724945,0.06054333969950676,0.07059888541698456,0.24905924499034882,-0.06844846904277802,0.2974333167076111,0.47422564029693604,-0.36564022302627563,-0.11936070770025253,0.0658632442355156,0.008590873330831528,-0.02644747868180275},{-0.5286816954612732,0.23049180209636688,-0.29327306151390076,0.25514984130859375,0.3428642451763153,-0.1367613673210144,-0.32677367329597473,-0.28486984968185425,0.27912601828575134,0.3145964741706848,-0.07877972722053528,0.21839219331741333,-0.31094035506248474,0.16826939582824707,-0.2711244523525238,0.41700685024261475},{-0.40626341104507446,0.19426773488521576,-0.34839409589767456,0.03162459284067154,-0.40209776163101196,-0.2882949709892273,-0.11136472225189209,0.024031704291701317,-0.2291768193244934,0.3487001359462738,0.20497435331344604,-0.0664985254406929,0.22853203117847443,-0.34932446479797363,-0.05246279761195183,0.03428815305233002},{0.2320740520954132,-0.22192293405532837,0.07693681865930557,0.44540175795555115,-0.4489568769931793,-0.3450028598308563,0.2607114017009735,0.12233409285545349,0.3051019310951233,-0.07256032526493073,0.27600550651550293,0.10412119328975677,-0.26286640763282776,-0.04868210479617119,-0.01978563889861107,-0.3500230014324188},{-0.3443242311477661,0.008783048950135708,0.2259417474269867,-0.3493225574493408,0.14021115005016327,0.2984413802623749,-0.3195170760154724,0.2569638192653656,-0.219441220164299,0.18738968670368195,-0.1278000771999359,-0.00615472998470068,-0.15634803473949432,-0.0008238078444264829,-0.20115450024604797,-0.19178040325641632},{0.011820194311439991,-0.2239513248205185,-0.035653553903102875,-0.35349711775779724,0.29164862632751465,0.06884413212537766,-0.017442530021071434,-0.08675240725278854,-0.2103300541639328,0.35569998621940613,0.31183427572250366,-0.08572914451360703,-0.16175627708435059,0.24655523896217346,-0.06483469158411026,-0.3765626847743988},{0.21495617926120758,-0.16300638020038605,0.2903110682964325,-0.2988487482070923,-0.37774693965911865,-0.050479307770729065,-0.3854162096977234,0.34714093804359436,-0.13390710949897766,-0.24959425628185272,-0.2667129337787628,-0.027424268424510956,-0.051525190472602844,-0.0762309581041336,0.4677332937717438,-0.3964804708957672},{-0.2903696298599243,0.3782411217689514,-0.05661750212311745,0.24985890090465546,0.00876385997980833,-0.2593071162700653,-0.11266756057739258,0.10872096568346024,-0.04823872447013855,0.48893094062805176,0.14368538558483124,-0.22157154977321625,0.05726299434900284,-0.08585508167743683,0.07218446582555771,0.15742692351341248},{0.14746229350566864,0.277765154838562,-0.17356546223163605,-0.3501727879047394,0.38059061765670776,-0.21024496853351593,0.2391897290945053,-0.3622507154941559,0.07249932736158371,0.029382716864347458,0.1308421939611435,0.10114838182926178,-0.007719476707279682,-0.26620155572891235,-0.0999700278043747,0.20092172920703888},{-0.20889826118946075,-0.00505225732922554,-0.2859824001789093,-0.33561456203460693,0.24060599505901337,-0.44208085536956787,-0.20817594230175018,0.2469099909067154,-0.10436506569385529,0.18928122520446777,0.004946218337863684,-0.06431075930595398,-0.37269192934036255,-0.01264222338795662,-0.22343890368938446,-0.34700143337249756},{-0.25278207659721375,-0.09536096453666687,-0.1051756888628006,-0.3396237790584564,-0.32741156220436096,0.003450973192229867,0.13334284722805023,-0.4781443178653717,0.008243964053690434,-0.04672713205218315,0.14178504049777985,-0.0024480822030454874,0.39245855808258057,0.03793108090758324,0.21131214499473572,0.2376590520143509},{-0.22491253912448883,-0.05655692145228386,-0.431968629360199,0.36162078380584717,0.12486360222101212,0.017569199204444885,0.14682438969612122,0.06936746835708618,-0.37399932742118835,0.2178344577550888,-0.3825523257255554,-0.13287253677845,-0.3645147383213043,0.3981582224369049,-0.33678919076919556,0.09885188937187195},{-0.12414830923080444,-0.44775620102882385,-0.0867401510477066,0.15313184261322021,-0.19120733439922333,-0.10090529173612595,-0.0745476558804512,0.37524062395095825,0.4228050112724304,0.09198402613401413,-0.09999632090330124,-0.2612706422805786,0.17401860654354095,-0.3495059013366699,0.15423263609409332,-0.21664419770240784},{-0.25086843967437744,-0.4796825647354126,-0.1838836818933487,-0.11924409121274948,-0.4723106324672699,0.35413476824760437,-0.07794922590255737,0.20119400322437286,-0.20190584659576416,-0.3321819305419922,-0.30422064661979675,0.397908478975296,-0.17773495614528656,0.0761595144867897,-0.26619842648506165,0.3593570291996002},{-0.3301842212677002,0.32977917790412903,-0.1702837198972702,0.1013222336769104,-0.3622710108757019,0.1825280785560608,0.04736597463488579,-0.37797054648399353,0.09989307820796967,0.15736718475818634,-0.1357145458459854,0.0833156630396843,0.2806691527366638,-0.22656038403511047,-0.3337910771369934,-0.16120626032352448},{-0.1545700579881668,-0.36606231331825256,-0.5110757946968079,0.29093825817108154,0.050992511212825775,0.12306953221559525,-0.2522414028644562,0.1931493580341339,-0.41891786456108093,-0.3162044882774353,-0.40317538380622864,0.2480650097131729,-0.23339000344276428,0.2025318592786789,0.09281086921691895,0.3485861122608185}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.05618370696902275,-0.10022298991680145,0.14517322182655334,-0.10926926136016846,-0.08587918430566788,0.1264459192752838,0.1864517778158188,-0.2400091290473938,-0.18193258345127106,0.28887102007865906,0.09176158159971237,0.11941982060670853,0.0836174488067627,0.13188961148262024,-0.17282308638095856,0.14869488775730133,0.11671904474496841,-0.30040475726127625,-0.21361713111400604,-0.07411858439445496,-0.1792668253183365,0.10083982348442078,-0.18961504101753235,0.35402244329452515,-0.1834314912557602,-0.0407102033495903,0.10284725576639175,0.18737494945526123,-0.23932543396949768,-0.16984190046787262,0.2260970026254654,0.25594910979270935},{0.15255486965179443,-0.05724988132715225,0.16640113294124603,-0.0960286483168602,-0.08405102044343948,0.23275211453437805,0.02763209491968155,-0.059752337634563446,-0.03719935566186905,-0.05624785274267197,-0.0973953828215599,0.007350521627813578,0.3831694424152374,0.21314062178134918,0.10567189753055573,0.034617867320775986,-0.23873171210289001,-0.2679313123226166,0.11652578413486481,0.04146488383412361,0.09090296924114227,0.290842741727829,0.2795746624469757,-0.15535211563110352,0.051943156868219376,0.27945199608802795,-0.36477842926979065,0.197122260928154,0.06232123449444771,-0.23884963989257812,-0.0898514911532402,-0.02682316303253174},{-0.05956143140792847,-0.07927798479795456,0.2088649868965149,-0.17900758981704712,-0.15012528002262115,0.07120054960250854,-0.20445199310779572,0.20780296623706818,0.1999392956495285,0.02217702567577362,-0.20128564536571503,0.024941040202975273,0.3228597939014435,-0.26495736837387085,0.10337822139263153,-0.060738205909729004,-0.35731473565101624,0.2523992657661438,-0.32676953077316284,-0.04878140613436699,-0.05447603017091751,-0.09788686037063599,-0.04610361531376839,-0.038327280431985855,-0.03753248602151871,0.35444149374961853,-0.0830298364162445,0.0876728966832161,0.22699478268623352,-0.32275068759918213,-0.1339966505765915,-0.01059410348534584},{0.14576970040798187,-0.20905861258506775,0.0006523295305669308,-0.37363460659980774,0.07224664837121964,-0.1347282975912094,-0.06919809430837631,0.1923094391822815,0.05981699004769325,0.20584876835346222,0.052095137536525726,-0.11438865214586258,-0.20545674860477448,-0.029261689633131027,0.23820391297340393,-0.21532198786735535,0.049892399460077286,-0.0800270289182663,-0.1555580496788025,0.11564251035451889,-0.15132245421409607,0.13443922996520996,-0.269692599773407,0.26920244097709656,-0.235980823636055,0.06250476837158203,-0.04911326989531517,-0.22146643698215485,0.11638577282428741,-0.0021019941195845604,0.23622027039527893,-0.14255419373512268},{0.26559025049209595,-0.052577558904886246,0.006638342048972845,0.24954907596111298,-0.3070680797100067,-0.08745419979095459,0.17263910174369812,-0.011472559534013271,0.14020349085330963,-0.1720108538866043,-0.003266270039603114,-0.08028420060873032,-0.20016568899154663,-0.13656598329544067,0.27988097071647644,0.23822423815727234,-0.040124647319316864,-0.3179773688316345,0.10530105978250504,-0.13366562128067017,-0.1355382353067398,0.2342112511396408,0.23479978740215302,0.016357431188225746,-0.10541965812444687,-0.09809298068284988,0.056683141738176346,0.25034332275390625,0.20670795440673828,0.09109067171812057,0.13674375414848328,-0.21123982965946198},{0.2983431816101074,-0.15184207260608673,0.007331369910389185,0.08149915188550949,-0.1232496127486229,-0.31743142008781433,-0.22696931660175323,-0.307688444852829,-0.18554598093032837,0.03162725269794464,-0.027855724096298218,0.016378894448280334,-0.10673365741968155,-0.07651228457689285,-0.211146742105484,-0.2731415331363678,0.1670878827571869,0.0042104474268853664,-0.3262234926223755,0.19590725004673004,-0.07368215918540955,-0.1931096911430359,0.19741567969322205,-0.14992175996303558,-0.15632234513759613,-0.21546025574207306,-0.11005467921495438,0.07947402447462082,0.07058676332235336,0.2297884076833725,-0.2624797523021698,0.19964465498924255},{0.1752760112285614,0.08862899243831635,0.22701452672481537,-0.15919412672519684,0.2443850189447403,-0.20865623652935028,-0.2899823784828186,0.0004182566190138459,0.2727452516555786,0.12013183534145355,-0.14885340631008148,0.11957371234893799,0.06150142103433609,0.30129924416542053,0.09665432572364807,-0.05262341350317001,-0.1883975863456726,0.10750976949930191,-0.004441394004970789,-0.05417502671480179,-0.06482695788145065,0.19342154264450073,0.17303884029388428,0.11335599422454834,-0.2586248815059662,-0.20786184072494507,-0.26134437322616577,-0.3097045421600342,0.1226397156715393,-0.13914312422275543,0.319192498922348,0.17382442951202393},{0.32237526774406433,-0.35600540041923523,0.08069596439599991,-0.4108361601829529,-0.32882851362228394,0.28936684131622314,0.4036041796207428,0.18133696913719177,-0.07365679740905762,0.09596142917871475,0.17213653028011322,-0.13247418403625488,0.06066637113690376,0.29485780000686646,-0.03322192654013634,0.2105671912431717,0.3889103829860687,-0.27056583762168884,-0.06391116976737976,-0.3732072710990906,0.19056929647922516,0.22676756978034973,0.20088957250118256,0.13857290148735046,0.12922313809394836,0.11891084909439087,0.1618174910545349,0.2751246392726898,-0.0828968957066536,-0.274167537689209,0.24522840976715088,0.051317982375621796},{0.07311254739761353,-0.11417455226182938,0.22430099546909332,0.25823864340782166,-0.19289815425872803,-0.2668834626674652,-0.06592760980129242,0.25480887293815613,-0.1984218806028366,-0.16130462288856506,0.005788014270365238,0.08862243592739105,0.15316784381866455,-0.3219012916088104,0.16378048062324524,-0.18272481858730316,-0.2012377232313156,0.17238736152648926,-0.2676168978214264,0.2769896686077118,-0.37244468927383423,-0.2809886932373047,-0.30913692712783813,0.26492390036582947,0.07505343109369278,0.0640094131231308,0.31131452322006226,0.2033180594444275,-0.1578458547592163,-0.3141418993473053,-0.15398240089416504,0.17926569283008575},{0.30913883447647095,0.04668692499399185,0.021739574149250984,0.23818689584732056,0.028729017823934555,0.23832227289676666,-0.06366448104381561,0.21871735155582428,-0.0389229916036129,0.028419576585292816,0.16016794741153717,0.11651167273521423,-0.06554458290338516,-0.2988418936729431,0.18124377727508545,0.19245994091033936,-0.010886861011385918,-0.141408309340477,-0.021879984065890312,0.031915489584207535,0.08182191848754883,-0.3054320514202118,0.347764253616333,0.0483437180519104,-0.04183865711092949,0.1073598712682724,-0.380902498960495,-0.18255558609962463,-0.022240586578845978,0.00887936633080244,0.08777523040771484,0.19388848543167114},{-0.07577884197235107,0.0915173590183258,-0.049567997455596924,0.19847393035888672,-0.05381937325000763,0.3187602460384369,0.10477247089147568,-0.07070755958557129,0.25061097741127014,-0.2983834147453308,-0.16584816575050354,0.1408558040857315,-0.08705984801054001,0.055917803198099136,-0.281975120306015,0.04485460743308067,0.07044868171215057,0.1561729907989502,0.10317054390907288,-0.11986011266708374,-0.2661609649658203,0.17340914905071259,0.26505598425865173,0.23025119304656982,-0.3372068405151367,0.327254980802536,-0.1882140338420868,0.02624446339905262,-0.10488725453615189,0.15026697516441345,0.2058093249797821,0.2527855634689331},{-0.17465655505657196,0.25287315249443054,-0.09118510037660599,-0.02430630475282669,-0.21975629031658173,-0.13296671211719513,0.15698765218257904,-0.271366149187088,-0.010319583117961884,-0.20185600221157074,-0.24944181740283966,-0.07840807735919952,0.1722012162208557,-0.296429842710495,-0.10638592392206192,-0.3788071274757385,-0.1540738195180893,-0.00908343680202961,0.2674461305141449,-0.29862451553344727,0.04625663906335831,-0.12119904905557632,0.016062695533037186,0.2954424321651459,-0.15549857914447784,0.14378419518470764,0.2972542345523834,-0.13318964838981628,-0.08463797718286514,0.3035415709018707,-0.15663264691829681,-0.26221540570259094},{-0.0567697174847126,0.2256634533405304,0.23716819286346436,-0.3437698781490326,0.32046106457710266,0.02974642626941204,-0.11957575380802155,-0.005521906074136496,0.13996614515781403,-0.29171818494796753,-0.05262795835733414,0.022726325318217278,0.21533706784248352,0.028715213760733604,0.0031951155979186296,-0.03478692099452019,0.24167606234550476,-0.2877023220062256,0.32593095302581787,0.07755876332521439,-0.17318131029605865,0.20807978510856628,-0.08668207377195358,-0.2117331176996231,0.2534548044204712,-0.09399139136075974,-0.029717804864048958,-0.12853272259235382,0.02666129730641842,-0.12428013980388641,0.28743231296539307,0.2567504346370697},{0.1042904183268547,-0.19009700417518616,-0.16807058453559875,0.09598802030086517,0.07512213289737701,0.27911698818206787,-0.10762320458889008,-0.24568042159080505,0.28654158115386963,0.04031895846128464,0.050955239683389664,0.04558475688099861,-0.20855514705181122,0.08770398795604706,-0.1782936453819275,-0.26989319920539856,0.056875329464673996,-0.024683009833097458,0.21425460278987885,0.3528469502925873,-0.2214711457490921,0.08987071365118027,-0.13433502614498138,0.024846311658620834,0.06219400465488434,-0.27589690685272217,-0.14715176820755005,-0.2371351420879364,-0.05018629506230354,-0.13222020864486694,0.24658739566802979,-0.315304696559906},{-0.02161506377160549,0.30232447385787964,0.17748458683490753,-0.18035054206848145,-0.08787943422794342,-0.16850516200065613,0.16321082413196564,-0.07672134041786194,0.20390649139881134,-0.0037346675526350737,0.20312277972698212,0.14662276208400726,0.02017134241759777,0.05627407506108284,-0.11072340607643127,0.20780809223651886,-0.21100054681301117,-0.36983588337898254,-0.25155767798423767,0.1522855907678604,0.08276984095573425,-0.23305563628673553,-0.30583178997039795,-0.1984100043773651,-0.23355890810489655,0.04073922708630562,0.33196693658828735,-0.005541605409234762,-0.10563221573829651,0.12178666144609451,-0.15795986354351044,0.07583729922771454},{-0.20524774491786957,-0.188071608543396,-0.255098432302475,0.06090853363275528,-0.27989697456359863,-0.1289847195148468,-0.10397862643003464,-0.12168022245168686,-0.28111785650253296,-0.17892007529735565,0.10345892608165741,0.17601965367794037,-0.265250027179718,0.27294331789016724,-0.04129428789019585,0.1812852919101715,0.05113909766077995,0.011139564216136932,0.025102829560637474,0.10759852081537247,0.15564675629138947,0.3188765048980713,0.07848317921161652,0.2163192629814148,0.12254606187343597,-0.2363365739583969,-0.11494684964418411,0.264702707529068,0.02625441737473011,-0.23610472679138184,-0.15403081476688385,-0.15036499500274658},{-0.30935192108154297,-0.2205144613981247,-0.36826038360595703,0.07428790628910065,-0.14880669116973877,-0.09301015734672546,-0.14444509148597717,0.053805094212293625,-0.02027689851820469,0.09141883999109268,-0.2559381127357483,0.010376264341175556,0.1628836840391159,-0.028386160731315613,0.02514089271426201,0.1769932508468628,-0.16608074307441711,-0.0740659162402153,0.14721918106079102,0.12276346236467361,0.20278096199035645,0.019391613081097603,-0.2712409496307373,0.08274312317371368,0.21879783272743225,-0.3082105219364166,0.17772239446640015,-0.021495185792446136,0.03088628500699997,-0.14251452684402466,0.19048477709293365,-0.11625954508781433},{0.2638285458087921,-0.05030112341046333,0.05268607288599014,0.12577655911445618,-0.2970590591430664,-0.009726590476930141,0.1535206437110901,0.20711849629878998,-0.08072182536125183,-0.11247123777866364,0.3129276633262634,-0.17200522124767303,-0.012125661596655846,-0.047709524631500244,-0.15140372514724731,0.21992738544940948,0.008069610223174095,-0.0624871589243412,0.11840806901454926,-0.27675026655197144,0.03761729970574379,-0.3086615204811096,-0.24387222528457642,0.25868669152259827,-0.133762389421463,-0.12902162969112396,0.16741791367530823,-0.011677558533847332,-0.17307202517986298,-0.0045713395811617374,-0.0927949771285057,-0.04178624972701073},{0.294869989156723,-0.04055659472942352,0.06374328583478928,0.06904228776693344,-0.015353391878306866,-0.12105754017829895,0.14712022244930267,-0.2387513518333435,0.23239171504974365,0.27244406938552856,0.014567067846655846,0.17419221997261047,0.25092342495918274,0.335310161113739,-0.3004550039768219,-0.2960440516471863,-0.3064148724079132,0.03127268701791763,-0.147014319896698,-0.3036895990371704,-0.18350841104984283,0.28379300236701965,0.06843611598014832,0.12223450094461441,-0.1331721395254135,-0.07452800124883652,-0.14312689006328583,-0.19030249118804932,0.26459363102912903,0.14890511333942413,-0.27586719393730164,-0.14496544003486633},{-0.1178797259926796,0.18305747210979462,0.29289567470550537,-0.049747396260499954,-0.018808482214808464,0.04578874260187149,-0.010474137961864471,-0.3171192705631256,0.19751952588558197,0.23267494142055511,0.20002324879169464,0.2221921980381012,-0.2649805247783661,0.20579178631305695,-0.2794792354106903,0.3076978921890259,0.13710351288318634,-0.2600243389606476,0.2612048089504242,0.12618057429790497,-0.2812335789203644,0.27938321232795715,-0.3137059509754181,0.10555944591760635,0.1751975119113922,0.2284015715122223,0.09695727378129959,0.11059494316577911,-0.2242332547903061,0.24090160429477692,-0.09576257318258286,0.10324396938085556},{-0.13639631867408752,-0.05597401037812233,0.05353541672229767,0.23055122792720795,-0.01196288038045168,0.2070910781621933,-0.3268194794654846,-0.17584049701690674,-0.19087345898151398,-0.10716143250465393,-0.1765058934688568,-0.1372670829296112,0.07028260082006454,-0.11075770109891891,0.12977585196495056,-0.16056910157203674,0.1297132521867752,-0.009236570447683334,-0.2945285141468048,-0.21478842198848724,0.09557946771383286,0.20495082437992096,-0.15745970606803894,0.3368494212627411,-0.2962271273136139,0.0613454170525074,0.09008172154426575,-0.09605180472135544,0.04496984928846359,-0.21054881811141968,0.3153092861175537,0.050254181027412415},{0.35425883531570435,-0.039552997797727585,0.061964746564626694,0.17512957751750946,-0.14285646378993988,0.24559541046619415,-0.04174696281552315,0.23682962357997894,0.15327632427215576,0.11434292048215866,0.04266785457730293,-0.3907919228076935,-0.26443564891815186,-0.07007411867380142,0.08847507834434509,-0.1166834756731987,0.29911646246910095,0.18454815447330475,-0.19696325063705444,-0.2113296389579773,0.27289748191833496,0.28013119101524353,0.272064208984375,0.13824501633644104,-0.07797158509492874,-0.029419180005788803,-0.1042582243680954,-0.21780553460121155,0.16418872773647308,0.0774664655327797,-0.20317021012306213,0.11971267312765121},{-0.019309014081954956,0.025231588631868362,-0.06019872426986694,-0.243016317486763,-0.10415816307067871,-0.24245096743106842,-0.22658833861351013,-0.1763506680727005,0.015295738354325294,-0.017069831490516663,-0.25621873140335083,0.02821960113942623,-0.24650947749614716,-0.1537764072418213,0.0022451223339885473,0.08567999303340912,0.26744696497917175,-0.17069202661514282,-0.35290879011154175,0.27517271041870117,-0.15148445963859558,0.256487637758255,-0.024940703064203262,-0.049181412905454636,0.04163019359111786,0.12325688451528549,-0.05693550407886505,-0.28088557720184326,0.20778103172779083,0.2585330009460449,-0.14953452348709106,0.19130389392375946},{-0.28519853949546814,-0.01498502865433693,0.0439048632979393,-0.010652200318872929,0.011937875300645828,0.08547554910182953,-0.18725387752056122,0.08626946806907654,-0.20461738109588623,-0.21521764993667603,0.1210683211684227,-0.12333929538726807,-0.1743176281452179,0.2798612713813782,0.011314773000776768,0.00015234746388159692,0.19953303039073944,-0.24352262914180756,-0.15637782216072083,0.27265986800193787,0.03486249968409538,0.20545373857021332,-0.010680032894015312,0.016989214345812798,-0.23785315454006195,-0.13228707015514374,0.022801756858825684,0.3019825220108032,0.025603417307138443,-0.01874912902712822,0.2648189067840576,0.28303855657577515}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10623322427272797,0.11654479801654816,0.31841224431991577,-0.017056573182344437},{0.054497022181749344,-0.08247316628694534,0.03207339718937874,0.190476655960083},{-0.12777671217918396,0.11036905646324158,0.09147169440984726,0.12158302217721939},{0.32582151889801025,0.05403069406747818,0.08234520256519318,0.41902607679367065},{-0.052907757461071014,0.07019796967506409,0.2925436794757843,0.013998796232044697},{-0.1417197585105896,0.22471654415130615,0.21009698510169983,-0.01323313731700182},{-0.27578768134117126,-0.015997042879462242,0.04706617817282677,-0.09639035910367966},{-0.326075941324234,-0.11489381641149521,0.3327861726284027,-0.274287611246109},{0.2841014564037323,-0.14156483113765717,-0.24869270622730255,-0.35260897874832153},{0.07261420041322708,0.26509150862693787,0.2960517406463623,-0.34656500816345215},{-0.12734530866146088,-0.1649659126996994,-0.12135322391986847,0.12781411409378052},{0.31076258420944214,-0.1475481539964676,-0.009083306416869164,0.16177436709403992},{0.23535846173763275,0.279258131980896,-0.06008255109190941,0.11842728406190872},{-0.0021374081261456013,0.011208404786884785,-0.2840053141117096,0.06090562790632248},{0.09888733923435211,0.24372468888759613,0.308832049369812,0.24101139605045319},{0.14756466448307037,0.01139142271131277,0.24099811911582947,0.2599504888057709},{-0.23766550421714783,-0.10142143070697784,-0.09370008111000061,-0.22114156186580658},{-0.1294868290424347,0.12429948151111603,-0.10597730427980423,-0.09924197196960449},{-0.2946222722530365,0.14057376980781555,0.14842548966407776,0.32629990577697754},{-0.028078719973564148,0.3017798066139221,-0.15953247249126434,0.1576617807149887},{-0.22715434432029724,-0.3202579915523529,-0.13195766508579254,0.0007471278659068048},{0.3171596825122833,0.3556945323944092,0.020347489044070244,-0.245576411485672},{-0.0020822768565267324,0.16281190514564514,0.19416554272174835,0.16632933914661407},{-0.07535605132579803,0.3587575852870941,-0.04644056409597397,-0.1520387977361679},{0.012848992832005024,-0.04120558500289917,-0.07954306900501251,-0.021166538819670677},{0.253170371055603,-0.331962913274765,-0.03493208810687065,0.032866500318050385},{-0.02291455864906311,-0.3136049807071686,-0.15743191540241241,-0.2731185853481293},{0.13142304122447968,-0.16832222044467926,0.21461988985538483,0.10765670239925385},{0.00994406919926405,-0.014815079048275948,0.003251322079449892,0.006026094313710928},{-0.38743460178375244,0.3642388582229614,0.19812136888504028,-0.002379173180088401},{0.3348754048347473,-0.14891687035560608,0.18671834468841553,-0.040545351803302765},{0.11012738198041916,-0.3457079231739044,0.35558220744132996,-0.2189977765083313}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0827714055776596,-0.03453792259097099,0.01943347416818142,0.042236436158418655,-0.0711297020316124,-0.10721085220575333,0.040936533361673355,0.04145454242825508,0.02586374245584011,-0.01416048128157854,-0.04076284542679787,-0.004932176321744919,0.06267835944890976,0.028589440509676933,-0.10132545977830887,-0.006968406029045582};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02931644394993782,0.0021437176037579775,0.003455657511949539,0.004582301247864962,0.008863122202455997,-0.0052683693356812,0.02462983876466751,0.034706611186265945,0.012965249828994274,0.030493775382637978,0.023122187703847885,-0.010157289914786816,0.048863012343645096,-0.029419459402561188,-0.046031877398490906,0.012271523475646973};
static const float actor_encoder_feed_forward_0_bias[32] = {0.006897872779518366,0.01046880055218935,0.010089505463838577,-0.004180969670414925,0.01639377698302269,0.0041377367451786995,0.005297697149217129,0.020066166296601295,-0.03770703822374344,-0.011319352313876152,-0.0036780680529773235,0.0016313644591718912,0.006167653948068619,-0.0076724993996322155,0.002688357839360833,0.041200902312994,8.060336404014379e-05,-0.02683131769299507,0.02420097403228283,-0.015570197254419327,-0.02317463792860508,-0.004767473787069321,0.0531151220202446,0.0081586679443717,0.004830910358577967,0.025140007957816124,-0.026437995955348015,0.042199280112981796,0.015372107736766338,-0.0028888522647321224,0.01891433447599411,0.014904673211276531};
static const float action_parameterization_distribution_linear_bias[4] = {-0.0041077518835663795,-0.015047688968479633,0.006128600332885981,0.00859785359352827};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.015737703070044518,0.2844351530075073,-0.1419946402311325,0.18490907549858093,0.0984509289264679,0.050467733293771744,0.5359801650047302,-0.11718982458114624},{-0.16392922401428223,-0.03607262298464775,-0.2650379240512848,-0.20713567733764648,-0.4030549228191376,-0.2580147981643677,0.043238315731287,-0.2569536566734314},{-0.23319779336452484,0.010107122361660004,0.2660682499408722,0.2693367302417755,0.21994233131408691,-0.04571646451950073,0.4029964208602905,-0.16416418552398682},{0.01216995157301426,0.0833197683095932,-0.1288476288318634,0.04016463831067085,-0.015532732009887695,-0.07579557597637177,0.36108019948005676,-0.24640695750713348},{-0.28298917412757874,-0.12592251598834991,-0.18346191942691803,-0.10279446840286255,-0.058588478714227676,0.16363002359867096,0.224798783659935,-0.07520805299282074},{-0.31628182530403137,-0.03337547555565834,0.4653623402118683,0.2721823453903198,0.14567121863365173,-0.12432767450809479,-0.09132687747478485,-0.16869483888149261},{-0.27243730425834656,0.007342144846916199,0.5173454284667969,-0.16027942299842834,-0.16401180624961853,-0.433517724275589,-0.06995443254709244,-0.12696489691734314},{-0.29718706011772156,-0.3699864149093628,0.6174847483634949,-0.0409957617521286,-0.22488842904567719,0.2248924821615219,0.20462433993816376,-0.24812999367713928},{-0.39609020948410034,0.2880905866622925,-0.06015501916408539,0.3999255299568176,0.06597470492124557,-0.33701395988464355,0.026306254789233208,0.10780278593301773},{-0.45454519987106323,-0.3381286561489105,-0.08109962940216064,-0.19703087210655212,-0.5491840839385986,0.13093391060829163,-0.036119215190410614,0.1736254096031189},{0.044034674763679504,0.31520193815231323,0.27675661444664,-0.014095671474933624,0.18841566145420074,0.15547241270542145,-0.19889861345291138,0.24212424457073212},{0.09464871883392334,0.010787729173898697,0.2893754541873932,0.23863065242767334,-0.31438589096069336,0.32874834537506104,0.0037173477467149496,-0.21254724264144897},{0.011535486206412315,-0.34658095240592957,0.2798845171928406,-0.07102235406637192,-0.3664567470550537,-0.051691632717847824,-0.1665334850549698,-0.10742639750242233},{-0.29598936438560486,-0.27146297693252563,0.3420204520225525,0.3351260721683502,-0.2586122751235962,-0.04837688431143761,-0.2859093248844147,0.2341071367263794},{-0.008721103891730309,-0.2139034867286682,0.16525962948799133,-0.22553084790706635,-0.29222649335861206,-0.10960493981838226,0.23346702754497528,0.02388896979391575},{0.11376666277647018,-0.10045529901981354,0.06292558461427689,-0.2311449944972992,0.056203994899988174,0.09006709605455399,0.08512867987155914,0.4145951569080353},{-0.11046867817640305,-0.35307034850120544,-0.16416378319263458,0.11966180801391602,-0.20853589475154877,-0.12467500567436218,-0.12190942466259003,0.14012818038463593},{-0.2392411231994629,-0.3393188416957855,0.03567465394735336,0.03738131746649742,0.11206711083650589,-0.17996695637702942,0.3543475866317749,0.17112700641155243},{-0.04413914680480957,0.0859423279762268,-0.2588083744049072,0.11292023956775665,0.09809216111898422,0.2086598426103592,-0.2119235098361969,0.3594713807106018},{0.07511995732784271,-0.05113896355032921,-0.3609170615673065,0.09569420665502548,-0.07232937216758728,-0.00892588309943676,-0.29444682598114014,0.004828926641494036},{0.019311191514134407,-0.15455831587314606,0.0724712684750557,-0.08953628689050674,0.3260176181793213,0.07171837985515594,0.01993117295205593,0.40689268708229065},{-0.06090499088168144,0.07306192815303802,-0.25444963574409485,0.2976838946342468,0.36645978689193726,0.3860763609409332,0.23358534276485443,-0.30792027711868286},{-0.5166648030281067,-0.18107476830482483,0.16233877837657928,-0.07681036740541458,0.22602957487106323,-0.2253122329711914,0.293975830078125,-0.2803954482078552},{-0.27131110429763794,-0.005271675996482372,-0.08832293003797531,-0.44680914282798767,0.2527972161769867,0.07800624519586563,-0.24908515810966492,0.15643036365509033},{-0.3585742115974426,-0.1919417679309845,-0.028963303193449974,-0.010805959813296795,-0.04810146242380142,0.22576415538787842,0.37447482347488403,-0.13445647060871124},{-0.3368319272994995,0.05555127188563347,-0.38116705417633057,-0.3415873348712921,0.1668303906917572,0.06992505490779877,-0.02909734658896923,0.05628540366888046},{0.24819818139076233,0.3812822103500366,-0.2969818115234375,0.16191411018371582,0.21130745112895966,0.41307777166366577,-0.21735216677188873,-0.1521003097295761},{0.2908337116241455,0.2532106637954712,0.04262416809797287,0.05139501392841339,0.2882808446884155,0.22563453018665314,0.33163267374038696,0.35967540740966797},{-0.22396285831928253,0.38252103328704834,0.1365766078233719,-0.015797782689332962,0.23564578592777252,0.08111175894737244,-0.26385849714279175,-0.30614134669303894},{-0.3149615526199341,-0.20996765792369843,0.055962737649679184,-0.2934894561767578,-0.29410654306411743,-0.13399578630924225,0.4170428514480591,-0.08521155267953873},{0.26783686876296997,-0.22788116335868835,0.33406880497932434,-0.34969842433929443,0.017766371369361877,0.2422131896018982,0.32654935121536255,-0.3037397563457489},{0.08213501423597336,0.41945454478263855,0.3951299488544464,-0.29202067852020264,-0.3016568720340729,0.044115856289863586,0.3507711887359619,-0.009141014888882637}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.010661449283361435,0.4452057480812073,-0.16115443408489227,0.17221280932426453,-0.418831467628479,0.3173302710056305,0.31371450424194336,0.1138080507516861},{-0.5125672221183777,-0.42118868231773376,-0.3592451512813568,-0.4554770588874817,-0.4644264280796051,0.4948295056819916,0.36039161682128906,-0.35445520281791687},{0.11826404184103012,-0.16077986359596252,0.15261898934841156,0.20236589014530182,-0.017399420961737633,0.4541037380695343,-0.291246622800827,-0.521756112575531},{0.418968141078949,-0.08871069550514221,0.21054351329803467,-0.00692001124843955,0.4837057292461395,0.4461153745651245,0.5286106467247009,0.3840709626674652},{0.09932125359773636,0.1838173270225525,-0.1506788283586502,-0.2518172264099121,0.07368313521146774,-0.42059993743896484,-0.5209403038024902,0.5791459083557129},{0.45838654041290283,0.12123928219079971,-0.015335294418036938,-0.32521986961364746,-0.46451449394226074,-0.4889732897281647,-0.11254200339317322,0.40417754650115967},{-0.47057729959487915,-0.31491854786872864,-0.12403487414121628,-0.2199045717716217,-0.016953209415078163,0.5231819748878479,-0.5117208361625671,0.495961457490921},{0.1697799265384674,0.06727002561092377,0.003422773675993085,0.03414909169077873,0.3527160882949829,-0.46987849473953247,0.314152330160141,-0.3613281548023224}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09942923486232758,0.020496971905231476,0.04828330874443054,-0.026252975687384605,-0.05188513919711113,0.026282792910933495,0.03431287407875061,-0.010669872164726257};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.016779977828264236,0.011528976261615753,-0.05590558424592018,0.06945110112428665,-0.01126426924020052,-0.006919413339346647,0.03517116606235504,-0.09236650913953781};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

