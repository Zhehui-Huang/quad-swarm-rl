#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.27113044261932373,0.02092786505818367,-0.15661737322807312,0.27433717250823975,0.29498013854026794,-0.21108831465244293,-0.22507400810718536,0.12693464756011963,0.264998197555542,-0.31501731276512146,0.6239979267120361,-0.008775625377893448,0.2940318286418915,0.10582054406404495,-0.434214323759079,0.04428672045469284},{-0.24053490161895752,-0.2762031853199005,-0.3138876259326935,-0.18438607454299927,0.07799240946769714,0.2521510720252991,0.06693654507398605,0.0571955069899559,0.24311396479606628,0.2008458524942398,-0.1730348914861679,-0.08239759504795074,-0.1726280003786087,0.06672374904155731,0.33589884638786316,-0.3159993886947632},{0.11666993796825409,0.2170114368200302,0.19372953474521637,0.34449172019958496,-0.08133905380964279,-0.23168623447418213,0.5038660764694214,-0.045034006237983704,-0.01620159111917019,-0.12954948842525482,-0.0158168226480484,-0.008721445687115192,0.0649774894118309,0.464038610458374,-0.2738473117351532,-0.03616277128458023},{0.11928950995206833,-0.14183302223682404,-0.16008484363555908,-0.10933011770248413,0.034058671444654465,0.11435358226299286,0.08275093883275986,-0.20235642790794373,-0.1608019322156906,0.15782994031906128,0.504134476184845,-0.20485588908195496,-0.1621643751859665,-0.15269272029399872,0.17051413655281067,0.12726542353630066},{-0.3249312937259674,0.05678640305995941,0.14246757328510284,-0.21795493364334106,0.26291951537132263,0.3123903274536133,0.14715056121349335,-0.19743940234184265,-0.10328361392021179,0.15577097237110138,-0.14790616929531097,-0.37850716710090637,-0.027208561077713966,-0.14073330163955688,0.3139621913433075,-0.040008798241615295},{-0.0455358624458313,0.0013101304648444057,-0.022094575688242912,0.015065901912748814,0.11392514407634735,-0.060805562883615494,0.3888327181339264,-0.34394243359565735,-0.14967884123325348,-0.1463007777929306,0.3050311207771301,0.014340736903250217,0.19794249534606934,0.09959537535905838,0.2686384916305542,0.2682378888130188},{-0.18438482284545898,0.15871991217136383,-0.027596144005656242,0.10822609066963196,-0.22204390168190002,-0.0876094177365303,-0.15642741322517395,-0.027547426521778107,0.14523059129714966,0.3457038700580597,-0.18310776352882385,-0.08200346678495407,0.20060496032238007,0.07439886778593063,-0.1934577077627182,0.2872740924358368},{-0.11943309009075165,-0.03531980887055397,-0.18958604335784912,-0.20019978284835815,0.3676791787147522,-0.313059002161026,-0.3061390519142151,-0.4197641611099243,-0.07974912226200104,-0.236888125538826,0.4063369631767273,-0.030243245884776115,0.2285807579755783,0.1332131028175354,-0.20112089812755585,0.4352256953716278},{0.23589129745960236,0.07048400491476059,-0.008246570825576782,0.10921342670917511,-0.40063223242759705,-0.40708616375923157,0.3549591898918152,-0.3185175061225891,-0.15160469710826874,0.23438608646392822,0.18506257236003876,-0.29559895396232605,-0.13522642850875854,0.03197133541107178,0.18543300032615662,-0.018894091248512268},{0.42495259642601013,-0.4931003451347351,-0.06498004496097565,0.011119561269879341,0.2682623863220215,-0.12131515890359879,-0.2545038163661957,-0.1396758109331131,-0.17993006110191345,0.012792504392564297,0.009932372719049454,-0.2181113213300705,0.3484352231025696,-0.07256027311086655,-0.5349621176719666,-0.18353208899497986},{0.2674478590488434,0.15901009738445282,-0.31605881452560425,0.12089825421571732,-0.009019644930958748,-0.17030054330825806,-0.10903583467006683,0.14907842874526978,-0.15402354300022125,0.12074234336614609,0.21113425493240356,0.21646025776863098,-0.10746397078037262,0.2535642385482788,-0.03750012069940567,-0.28292039036750793},{-0.45817604660987854,0.29420650005340576,0.24157868325710297,-0.27085617184638977,-0.25043952465057373,0.3091682493686676,0.04731908068060875,0.3012751042842865,0.21016889810562134,0.15516673028469086,0.1991412490606308,-0.1133066862821579,0.17140638828277588,-0.0775158554315567,-0.08811499178409576,-0.1603371798992157},{0.08590564131736755,-0.24818749725818634,-0.23437511920928955,0.16608360409736633,-0.22847416996955872,-0.22390571236610413,-0.11897393316030502,0.23678958415985107,0.3248039782047272,-0.15625594556331635,-0.06444060802459717,0.04483503848314285,0.24523839354515076,0.1379365622997284,-0.19459842145442963,0.28662821650505066},{0.2799549102783203,0.15803708136081696,-0.125549778342247,-0.11087125539779663,0.05137987807393074,-0.06604435294866562,-0.11405432224273682,0.28798407316207886,-0.21704256534576416,-0.18250173330307007,-0.1326417177915573,0.05302057042717934,-0.22721295058727264,-0.10106798261404037,-0.24242523312568665,-0.017016345635056496},{0.15798477828502655,0.4302842319011688,0.40051737427711487,-0.34706324338912964,-0.35937273502349854,0.1574844866991043,0.00958253350108862,-0.1347855031490326,0.3936019837856293,0.3861747086048126,-0.1444111317396164,0.11196114122867584,-0.09206707775592804,-0.3091184198856354,0.0907214879989624,-0.1572696715593338},{-0.2083636224269867,-0.16192826628684998,-0.09189207851886749,0.4456484019756317,-0.22495971620082855,-0.19458191096782684,-0.23524029552936554,-0.27578094601631165,-0.4911155700683594,-0.2317221313714981,0.33285415172576904,0.28415071964263916,-0.5827174186706543,-0.36228224635124207,-0.5744217038154602,-0.16906589269638062},{-0.46121808886528015,0.1539519727230072,-0.3245961666107178,-0.16550122201442719,-0.45361119508743286,0.17627151310443878,0.5081595778465271,0.11659328639507294,0.4000750184059143,-0.47573667764663696,0.23213323950767517,-0.35975369811058044,-0.21144333481788635,0.03464963659644127,-0.18400874733924866,-0.2006002515554428},{0.36508896946907043,-0.5940758585929871,0.27546337246894836,0.23639948666095734,-0.07689081132411957,0.4690144658088684,0.23345956206321716,0.2907353937625885,-0.07514780759811401,-0.24479228258132935,-0.1408083587884903,-0.13225652277469635,-0.11164771020412445,-0.5280401110649109,0.2656746208667755,-0.09471991658210754}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.030156036838889122,0.30503034591674805,0.22012008726596832,-0.15746472775936127,-0.17447145283222198,0.028658172115683556,-0.016035711392760277,0.2421872913837433,-0.09435329586267471,0.31616270542144775,0.48014140129089355,-0.38332945108413696,0.05133357271552086,0.047546472400426865,0.0011172282975167036,-0.09363646060228348},{-0.3719974160194397,0.18749746680259705,-0.1671266108751297,0.32570064067840576,0.26960715651512146,-0.11220422387123108,-0.3086528480052948,-0.15345275402069092,0.3521438539028168,0.2652539908885956,-0.06584906578063965,0.21417081356048584,-0.37586748600006104,0.17371466755867004,-0.20925259590148926,0.4285237193107605},{-0.2726656198501587,0.11966246366500854,-0.2567934989929199,0.15597811341285706,-0.4465717375278473,-0.1919003129005432,0.017337681725621223,0.12027069181203842,-0.16651134192943573,0.36910849809646606,0.21904796361923218,-0.11581993103027344,0.1450348198413849,-0.26002734899520874,-0.1016792356967926,-0.03696144372224808},{0.24545904994010925,-0.21231132745742798,0.09968046844005585,0.38872531056404114,-0.4148322641849518,-0.3145733177661896,0.2682569921016693,0.039905846118927,0.28461265563964844,-0.08672931045293808,0.3268063962459564,0.09286367148160934,-0.1987978219985962,0.01938772015273571,-0.008938374929130077,-0.39654025435447693},{-0.3914835751056671,-0.07910916954278946,0.13347496092319489,-0.26985299587249756,0.14564010500907898,0.35113948583602905,-0.3058856129646301,0.2815495431423187,-0.20612773299217224,0.19847676157951355,0.0021239810157567263,0.05199500173330307,-0.27657729387283325,-0.020130863413214684,-0.26697978377342224,-0.09843940287828445},{0.07142405956983566,-0.2984517812728882,-6.633406883338466e-05,-0.32624563574790955,0.21108895540237427,0.03836294263601303,-0.13109301030635834,-0.06108717992901802,-0.13013340532779694,0.36753061413764954,0.18142716586589813,0.009631868451833725,-0.29997962713241577,0.0935211330652237,0.01221407763659954,-0.30493658781051636},{0.25302743911743164,-0.22342844307422638,0.3311323821544647,-0.18607237935066223,-0.4221307337284088,0.017332587391138077,-0.3531898856163025,0.341409832239151,-0.10261872410774231,-0.2535887360572815,-0.24573072791099548,-0.018038133159279823,-0.07089557498693466,-0.07795014977455139,0.49819082021713257,-0.39005881547927856},{-0.33397793769836426,0.34271082282066345,-0.08927880227565765,0.1917359083890915,-0.1076958104968071,-0.22449991106987,-0.2210339456796646,0.10182064771652222,-0.06067962571978569,0.4673632085323334,0.10080768167972565,-0.13104410469532013,0.05135732144117355,-0.2197161316871643,0.07356978952884674,0.156403586268425},{0.13681048154830933,0.27218109369277954,-0.17162276804447174,-0.2996595799922943,0.30192479491233826,-0.19276808202266693,0.18788661062717438,-0.2469811588525772,0.011318596079945564,0.025685667991638184,0.1082606166601181,0.07792768627405167,0.005913605913519859,-0.3714519143104553,-0.06760529428720474,0.19293677806854248},{-0.18503670394420624,0.02698897197842598,-0.2735127806663513,-0.32194459438323975,0.21776314079761505,-0.37885966897010803,-0.10788074135780334,0.2942432165145874,-0.15926198661327362,0.13588565587997437,-0.05138180032372475,-0.10476438701152802,-0.3685290515422821,0.11595623195171356,-0.23003746569156647,-0.34849879145622253},{-0.12324441224336624,-0.15909643471240997,0.011061317287385464,-0.24397552013397217,-0.31527984142303467,0.005511890631169081,0.13801611959934235,-0.31727713346481323,0.030644534155726433,-0.08409956842660904,0.2681731879711151,-0.06861680746078491,0.23540399968624115,0.15811318159103394,0.21969659626483917,0.24464118480682373},{-0.1249619573354721,-0.029903557151556015,-0.3326381742954254,0.3241364061832428,0.09167167544364929,0.15417727828025818,0.2001238763332367,0.16375046968460083,-0.425923615694046,0.1925235539674759,-0.3354100286960602,-0.2316845953464508,-0.3436538279056549,0.3405856192111969,-0.3320279121398926,0.09119738638401031},{-0.16843850910663605,-0.44765347242355347,-0.07624725252389908,0.12902824580669403,-0.23237407207489014,-0.05085909739136696,-0.09845544397830963,0.39348742365837097,0.44943514466285706,0.12203814834356308,-0.001961324131116271,-0.1778271347284317,0.1403576135635376,-0.3770369291305542,0.09278447926044464,-0.16294342279434204},{-0.2593405544757843,-0.45746055245399475,-0.1251066029071808,-0.13078263401985168,-0.5025733709335327,0.4858119785785675,-0.15720658004283905,0.20803231000900269,-0.14609183371067047,-0.23995698988437653,-0.30196526646614075,0.39386215806007385,-0.14414416253566742,-0.044029686599969864,-0.20965783298015594,0.32575905323028564},{-0.31214475631713867,0.3565308749675751,-0.23554988205432892,0.1387021392583847,-0.35116273164749146,0.13823530077934265,-0.0032964583951979876,-0.33702558279037476,0.13313566148281097,0.2037639319896698,-0.23397861421108246,0.06552891433238983,0.2506553530693054,-0.3092619478702545,-0.33796507120132446,-0.1817101240158081},{-0.1274753212928772,-0.2695719599723816,-0.4175090491771698,0.2252768874168396,0.14509433507919312,0.03826581686735153,-0.2305331975221634,0.17543841898441315,-0.35483840107917786,-0.24117213487625122,-0.2946799099445343,0.1926470249891281,-0.20374354720115662,0.14287634193897247,0.0395040325820446,0.2952977120876312}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1125495433807373,-0.041432470083236694,0.1936284303665161,-0.1370459794998169,-0.08133595436811447,0.09409338235855103,0.22193408012390137,-0.1912856251001358,-0.2225472331047058,0.260916143655777,0.15185432136058807,0.11576473712921143,0.0679393857717514,0.1766674518585205,-0.1516302078962326,0.16277073323726654,0.1340094357728958,-0.33948633074760437,-0.15301105380058289,-0.08484736829996109,-0.1169576570391655,0.050977036356925964,-0.1855182647705078,0.2586458623409271,-0.09108748286962509,-0.05831461772322655,0.1132669523358345,0.20616133511066437,-0.2048926204442978,-0.12933076918125153,0.1690635085105896,0.2612752914428711},{0.21998891234397888,-0.0654630959033966,0.13504824042320251,-0.12954184412956238,-0.12357048690319061,0.23928023874759674,-0.00629638833925128,-0.06493280082941055,-0.045939620584249496,0.016821902245283127,-0.1414756327867508,0.008214587345719337,0.3946998119354248,0.17257408797740936,0.11845089495182037,0.06425374001264572,-0.22043265402317047,-0.3541591465473175,0.07378173619508743,0.03685010224580765,0.06723008304834366,0.2884032428264618,0.20612655580043793,-0.24331168830394745,0.035388361662626266,0.2613043189048767,-0.27405041456222534,0.1852346807718277,0.10228195041418076,-0.22904793918132782,-0.05471682921051979,-0.011932233348488808},{-0.09563732147216797,-0.05864883214235306,0.2975998520851135,-0.23718151450157166,-0.15455202758312225,0.05531253293156624,-0.12550443410873413,0.26019811630249023,0.10744482278823853,0.0001618954847799614,-0.1727040708065033,-0.026470575481653214,0.2334289699792862,-0.22711408138275146,0.10421063750982285,-0.033306658267974854,-0.3063610792160034,0.27081912755966187,-0.22548633813858032,-0.049420926719903946,0.008748126216232777,-0.14370286464691162,-0.03793187811970711,-0.08946502208709717,-0.023355865851044655,0.27064111828804016,-0.07005094736814499,0.10279468446969986,0.254276841878891,-0.2295982539653778,-0.21113374829292297,-0.04248422756791115},{0.14360149204730988,-0.10441498458385468,0.070439912378788,-0.3258277475833893,0.11937735229730606,-0.1527606099843979,-0.07788407802581787,0.27347540855407715,0.015576866455376148,0.12547415494918823,0.15815038979053497,-0.08660155534744263,-0.1968427300453186,-0.09374446421861649,0.30345702171325684,-0.2252657264471054,0.025403771549463272,-0.13983432948589325,-0.12247965484857559,0.09720239788293839,-0.10400542616844177,0.03823156654834747,-0.20332112908363342,0.21831662952899933,-0.25869113206863403,0.10170940309762955,-0.09208472073078156,-0.1773049384355545,0.096387580037117,-0.0010469479020684958,0.25500714778900146,-0.12170843780040741},{0.21174468100070953,0.0023715978022664785,0.028069352731108665,0.2367987334728241,-0.2480834424495697,-0.08346900343894958,0.2071586698293686,-0.05517352744936943,0.11404306441545486,-0.1824939250946045,0.0017046810826286674,-0.08582555502653122,-0.15313494205474854,-0.1576509326696396,0.2649382948875427,0.3038656711578369,-0.06447084993124008,-0.33504101634025574,0.15381360054016113,-0.11442341655492783,-0.11812087148427963,0.20833972096443176,0.2595321834087372,0.056688886135816574,-0.05002119392156601,-0.0908372551202774,-0.007381432224065065,0.25843754410743713,0.24618719518184662,0.13228031992912292,0.08021364361047745,-0.24240778386592865},{0.32309669256210327,-0.15426740050315857,0.0034030743408948183,0.09462834149599075,-0.1355334222316742,-0.32777121663093567,-0.2054997980594635,-0.30238819122314453,-0.19609002768993378,0.026024101302027702,-0.0516662560403347,-0.017176823690533638,-0.1650783121585846,-0.054926760494709015,-0.216973215341568,-0.22787971794605255,0.17100536823272705,-0.011158620938658714,-0.311178594827652,0.15030471980571747,-0.054641157388687134,-0.21811546385288239,0.17692971229553223,-0.15872777998447418,-0.13281244039535522,-0.22887162864208221,-0.09403049945831299,0.14709779620170593,0.10345128923654556,0.2620759904384613,-0.2303134799003601,0.20295938849449158},{0.15468497574329376,0.08695625513792038,0.2580135464668274,-0.18632467091083527,0.22546230256557465,-0.22377128899097443,-0.2410447895526886,0.057971224188804626,0.27473610639572144,0.10834214091300964,-0.09616737067699432,0.09947604686021805,0.05751239135861397,0.3704644739627838,0.1115366742014885,-0.11887955665588379,-0.18426719307899475,0.1466338187456131,0.0053925723768770695,0.011391022242605686,-0.044678010046482086,0.1978059560060501,0.15630270540714264,0.1481163650751114,-0.19268858432769775,-0.2391853779554367,-0.24825996160507202,-0.37224116921424866,0.05726885795593262,-0.11370237916707993,0.23285450041294098,0.16216470301151276},{0.2733834385871887,-0.299091100692749,0.11291663348674774,-0.3675479590892792,-0.3549213409423828,0.24498319625854492,0.3678361177444458,0.12603223323822021,-0.09558621048927307,-0.008412249386310577,0.2349408119916916,-0.12954245507717133,0.14761649072170258,0.33948996663093567,-0.031118448823690414,0.17992891371250153,0.3676224648952484,-0.17889311909675598,-0.04206910356879234,-0.2888545095920563,0.15397222340106964,0.20618928968906403,0.23437128961086273,0.11515358090400696,0.118272565305233,0.11439424008131027,0.1223941370844841,0.25079992413520813,-0.2118133157491684,-0.24577175080776215,0.23791226744651794,-0.0660385861992836},{0.028676992282271385,-0.08088703453540802,0.27098867297172546,0.22270970046520233,-0.17280809581279755,-0.2878529727458954,-0.06335597485303879,0.2701500356197357,-0.18538881838321686,-0.2508311867713928,0.07362987101078033,0.10015234351158142,0.13053102791309357,-0.26685065031051636,0.12454469501972198,-0.17844052612781525,-0.1582164615392685,0.1782047599554062,-0.23328164219856262,0.34123730659484863,-0.30726709961891174,-0.30295300483703613,-0.2807523012161255,0.2993340492248535,0.11598393321037292,0.10150575637817383,0.2457336187362671,0.1738271564245224,-0.1703222393989563,-0.2733721137046814,-0.1558775007724762,0.15933652222156525},{0.28642159700393677,-0.0232684388756752,-0.05780797824263573,0.161217600107193,-0.009603267535567284,0.21541781723499298,-0.042567040771245956,0.24444352090358734,0.0010253621730953455,0.0732852965593338,0.170557901263237,0.06460439413785934,-0.14055897295475006,-0.35266175866127014,0.09806617349386215,0.1294625848531723,0.09663745760917664,-0.12417910993099213,-0.0922732949256897,-0.03748312219977379,0.11495750397443771,-0.2813924551010132,0.23084142804145813,0.07256889343261719,-0.008514320477843285,0.1319374442100525,-0.27304166555404663,-0.24318529665470123,-0.04570990428328514,-0.01988551951944828,0.1334245651960373,0.18929660320281982},{-0.1250743865966797,0.09860403090715408,-0.09800444543361664,0.15589426457881927,-0.11571178585290909,0.2718222141265869,0.12459871172904968,-0.011219317093491554,0.27576178312301636,-0.30943557620048523,-0.14329203963279724,0.1554577499628067,-0.17216062545776367,0.048882149159908295,-0.30321475863456726,-0.0337655246257782,0.10718144476413727,0.1697584092617035,0.0805710032582283,-0.13611342012882233,-0.21739709377288818,0.20143914222717285,0.19090604782104492,0.18183927237987518,-0.25200262665748596,0.3580762445926666,-0.10029387474060059,-0.022526852786540985,-0.1049414724111557,0.13508275151252747,0.21786290407180786,0.27618667483329773},{-0.17965877056121826,0.30718618631362915,-0.06485296040773392,0.01270638220012188,-0.17650894820690155,-0.1556604653596878,0.13333621621131897,-0.3113584518432617,-0.04001108556985855,-0.24469168484210968,-0.21825556457042694,-0.03666919469833374,0.17764151096343994,-0.2735414505004883,-0.1169806718826294,-0.2731620967388153,-0.19750970602035522,-0.07101715356111526,0.30273979902267456,-0.29903337359428406,0.08079548925161362,-0.1886691451072693,0.07248549163341522,0.30166569352149963,-0.17728210985660553,0.18195191025733948,0.2194293588399887,-0.07265820354223251,-0.017878497019410133,0.3067314922809601,-0.13322806358337402,-0.250516414642334},{-0.05368318036198616,0.16644741594791412,0.22894354164600372,-0.279289186000824,0.26483601331710815,0.017258580774068832,-0.11896688491106033,-0.021860472857952118,0.15025049448013306,-0.2965041399002075,-0.06967799365520477,0.017246734350919724,0.15747548639774323,0.05536796152591705,0.03302094712853432,-0.10277161002159119,0.24187901616096497,-0.2387646734714508,0.3285500407218933,0.08478221297264099,-0.1587546467781067,0.23128463327884674,-0.13198858499526978,-0.19995179772377014,0.2744995355606079,-0.12583021819591522,0.028310531750321388,-0.16958416998386383,0.048905789852142334,-0.1396828442811966,0.2612451910972595,0.22867828607559204},{0.06926664710044861,-0.14480432868003845,-0.16567079722881317,0.06299279630184174,0.026482077315449715,0.29299822449684143,-0.10474301874637604,-0.26256611943244934,0.27043816447257996,0.02254607528448105,0.04955312982201576,0.08409111946821213,-0.15951213240623474,0.08724671602249146,-0.19335484504699707,-0.2747054100036621,0.0064803906716406345,-0.04698024317622185,0.21450825035572052,0.38429251313209534,-0.21336515247821808,0.09003519266843796,-0.12095027416944504,0.0004733047971967608,0.11754000186920166,-0.3048769533634186,-0.17156662046909332,-0.2117120325565338,-0.054359279572963715,-0.1769195795059204,0.17597180604934692,-0.3167039453983307},{-0.09010222554206848,0.2934863865375519,0.15495134890079498,-0.21147161722183228,-0.09343746304512024,-0.17555059492588043,0.18003305792808533,-0.03281847760081291,0.22086448967456818,-0.022334670647978783,0.18761062622070312,0.1530640721321106,-0.042105961591005325,0.04669969156384468,-0.12577903270721436,0.16170060634613037,-0.17371568083763123,-0.3533957898616791,-0.23801617324352264,0.11563573032617569,0.13893623650074005,-0.20461907982826233,-0.3132905960083008,-0.2295127809047699,-0.15164555609226227,0.0577668696641922,0.33207112550735474,-0.011282665655016899,-0.07290951162576675,0.12223753333091736,-0.141354039311409,0.09807606041431427},{-0.20199577510356903,-0.1812087893486023,-0.20283296704292297,0.001176050049252808,-0.21260154247283936,-0.09994164109230042,-0.029713142663240433,-0.013327074237167835,-0.3023039996623993,-0.22238367795944214,0.18416616320610046,0.13436715304851532,-0.30963635444641113,0.23340436816215515,-0.0632350742816925,0.16303732991218567,0.09930964559316635,0.02886361815035343,0.03888481855392456,0.14028853178024292,0.22968114912509918,0.26185154914855957,0.1354873925447464,0.26115167140960693,0.10294385254383087,-0.22286605834960938,-0.18809852004051208,0.24880897998809814,-0.0004749554500449449,-0.17646464705467224,-0.1597093790769577,-0.10857796669006348},{-0.2865876257419586,-0.21677498519420624,-0.33698412775993347,0.05136115849018097,-0.10266047716140747,-0.05175952613353729,-0.07726263999938965,0.14553982019424438,-0.08988598734140396,0.08347047120332718,-0.18598297238349915,-0.0036706069950014353,0.14119373261928558,-0.11250956356525421,0.036296289414167404,0.18335860967636108,-0.09214561432600021,-0.10976117849349976,0.17280170321464539,0.024765416979789734,0.22029274702072144,-0.04894249886274338,-0.2191857546567917,0.06578322499990463,0.17999060451984406,-0.2542175352573395,0.17347118258476257,0.05170302093029022,0.08102129399776459,-0.13524572551250458,0.20451946556568146,-0.06026455760002136},{0.2659972310066223,0.017431283369660378,0.03508571535348892,0.19896766543388367,-0.33785396814346313,-0.03820975497364998,0.05845390260219574,0.1589738428592682,-0.06997883319854736,-0.13253921270370483,0.29164549708366394,-0.08948338031768799,0.0847054123878479,-0.050908468663692474,-0.10567311942577362,0.28554466366767883,-0.07928024977445602,-0.1356591284275055,0.104027159512043,-0.29351210594177246,-0.05620485544204712,-0.2539541721343994,-0.18111355602741241,0.22807614505290985,-0.0801713690161705,-0.03985605761408806,0.1276598572731018,0.06126493588089943,-0.14654329419136047,-0.0728488564491272,-0.026105351746082306,-0.08209241926670074},{0.2944832444190979,-0.07232637703418732,0.0584552101790905,0.056785572320222855,-0.025628678500652313,-0.07593349367380142,0.1994938850402832,-0.22535374760627747,0.2547302544116974,0.2920726239681244,0.04207271337509155,0.13564036786556244,0.20866073668003082,0.31316837668418884,-0.29688987135887146,-0.3592829406261444,-0.22882714867591858,0.07774201780557632,-0.17514272034168243,-0.3533952534198761,-0.14865642786026,0.2326972782611847,0.057641658931970596,0.14603494107723236,-0.1503426432609558,-0.12108317017555237,-0.12102791666984558,-0.2386033982038498,0.24570247530937195,0.1881907880306244,-0.3333292007446289,-0.11932068318128586},{-0.1000746563076973,0.16942527890205383,0.28031113743782043,-0.02110445685684681,-0.016160303726792336,0.08802139759063721,-0.02318461611866951,-0.327841192483902,0.17192010581493378,0.25281625986099243,0.17062385380268097,0.22588051855564117,-0.25158119201660156,0.16728918254375458,-0.24552428722381592,0.3103082776069641,0.1536344438791275,-0.26493433117866516,0.25600287318229675,0.05606578290462494,-0.34112870693206787,0.29174506664276123,-0.22898440062999725,0.14664426445960999,0.1759866625070572,0.26200971007347107,0.04804406315088272,0.1414061188697815,-0.15731556713581085,0.24277478456497192,-0.04757058992981911,0.10525751113891602},{-0.1292019784450531,-0.10510951280593872,0.02944372408092022,0.18894128501415253,0.0285650622099638,0.2366795390844345,-0.2507346570491791,-0.11031555384397507,-0.17607536911964417,-0.08084619790315628,-0.11485440284013748,-0.19528909027576447,-0.010170483030378819,-0.21494469046592712,0.10208775848150253,-0.20403413474559784,0.24199919402599335,-0.018602663651108742,-0.28116074204444885,-0.3052109181880951,0.1429527848958969,0.134881854057312,-0.1482136994600296,0.3286689221858978,-0.2639863193035126,0.0342700332403183,0.09333163499832153,-0.10123950242996216,0.16240058839321136,-0.19568444788455963,0.280097097158432,0.12278895080089569},{0.3016875088214874,0.05438748747110367,0.04955946281552315,0.22696827352046967,-0.24320103228092194,0.1566045880317688,-0.09477869421243668,0.13927283883094788,0.11621364951133728,0.010500160977244377,0.10022027790546417,-0.30361711978912354,-0.2633950114250183,0.05916965380311012,0.06981442868709564,-0.08449310809373856,0.27055928111076355,0.14048229157924652,-0.19222129881381989,-0.20998282730579376,0.3390290439128876,0.19506414234638214,0.2283177524805069,0.08235440403223038,0.005175407975912094,0.06446073949337006,-0.046636924147605896,-0.165103942155838,0.2370835244655609,0.00657847011461854,-0.1787688136100769,0.10825515538454056},{-0.016131950542330742,0.028063075616955757,-0.028996706008911133,-0.25310900807380676,-0.09637226909399033,-0.22986067831516266,-0.21118198335170746,-0.1420212984085083,-0.0378376767039299,-0.02467864193022251,-0.23506110906600952,0.026597386226058006,-0.23536303639411926,-0.15907959640026093,0.012529069557785988,0.09577704221010208,0.2621012330055237,-0.1776139885187149,-0.32438090443611145,0.2494112104177475,-0.17160946130752563,0.24466361105442047,0.03967176377773285,-0.03726526349782944,-0.014303592033684254,0.1697113811969757,-0.07715853303670883,-0.25666168332099915,0.22422511875629425,0.2540631592273712,-0.1320146769285202,0.1767881065607071},{-0.23705464601516724,-0.021871652454137802,0.03757357969880104,-0.023799803107976913,0.09030541032552719,0.11938302218914032,-0.2011125236749649,0.09712500870227814,-0.14811354875564575,-0.14051564037799835,0.06612249463796616,-0.13199922442436218,-0.17350955307483673,0.27007734775543213,0.015040488913655281,0.03849690034985542,0.18613608181476593,-0.25854232907295227,-0.168116495013237,0.3205277919769287,0.01913907565176487,0.28397154808044434,-0.06977752596139908,0.014390150085091591,-0.20332081615924835,-0.1781393587589264,0.00228092516772449,0.29670917987823486,-0.01677985116839409,0.0018679678905755281,0.301363080739975,0.2961074709892273}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.13517577946186066,0.1290421187877655,0.24694646894931793,-0.004667926114052534},{0.06946547329425812,-0.04189792275428772,0.045200593769550323,0.12928995490074158},{-0.132883682847023,0.17247846722602844,0.0848938599228859,0.13585317134857178},{0.31481751799583435,0.040010254830121994,0.060083840042352676,0.36736974120140076},{-0.09426620602607727,0.05694403499364853,0.23807242512702942,-0.00451161852106452},{-0.12335777282714844,0.19188788533210754,0.1754133552312851,-0.05428097024559975},{-0.20280802249908447,0.006302656140178442,-0.004590717609971762,-0.10829437524080276},{-0.32676973938941956,-0.1081450954079628,0.2965008318424225,-0.27083784341812134},{0.28355440497398376,-0.1769757717847824,-0.2472849190235138,-0.3287172317504883},{0.04309462383389473,0.2333059012889862,0.2989486753940582,-0.36299288272857666},{-0.11366941779851913,-0.13185404241085052,-0.17959418892860413,0.1796952188014984},{0.23507659137248993,-0.157127246260643,0.03601227328181267,0.15196684002876282},{0.2680366635322571,0.2726830244064331,-0.0687568336725235,0.08224937319755554},{-0.005392799153923988,0.04972461983561516,-0.2631092071533203,0.02184630185365677},{0.11731380969285965,0.26977741718292236,0.2656857967376709,0.2937287986278534},{0.14167524874210358,0.06026134639978409,0.22458328306674957,0.21563677489757538},{-0.17790848016738892,-0.09285436570644379,-0.14415033161640167,-0.15452511608600616},{-0.15520022809505463,0.10207545012235641,-0.11194679141044617,-0.12172672897577286},{-0.1546841263771057,0.1511412411928177,0.15428707003593445,0.24806910753250122},{-0.0214808601886034,0.32325005531311035,-0.15351246297359467,0.05944426357746124},{-0.2155374437570572,-0.31099817156791687,-0.1339375227689743,-0.020096857100725174},{0.2475433647632599,0.3476613461971283,0.03218377009034157,-0.2024802267551422},{0.002881375839933753,0.14189857244491577,0.140048548579216,0.1203707605600357},{-0.08217617124319077,0.337489515542984,-0.047940950840711594,-0.1072518453001976},{0.008869371376931667,-0.006434421520680189,-0.029505405575037003,-0.016161879524588585},{0.2485729306936264,-0.33303359150886536,-0.046619776636362076,0.047052737325429916},{-0.0026807966642081738,-0.2763284742832184,-0.16720612347126007,-0.22899019718170166},{0.08984982967376709,-0.06330887228250504,0.19021011888980865,0.08658523857593536},{-0.0024234645534306765,-0.04300849512219429,0.05198412761092186,0.01262020692229271},{-0.2979695200920105,0.32398664951324463,0.21838191151618958,-0.0911213606595993},{0.28314080834388733,-0.14520728588104248,0.15262779593467712,-0.00488366698846221},{0.05119134113192558,-0.2970709204673767,0.30216270685195923,-0.24301397800445557}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.027998432517051697,-0.002493687206879258,0.03099566511809826,-0.04767110198736191,-0.022350260987877846,-0.15613600611686707,0.03860346972942352,0.0411025770008564,0.006902929861098528,-0.10711141675710678,0.1523246020078659,0.07686778157949448,0.0005193618126213551,-0.015890132635831833,0.07074730843305588,0.0024945412296801805};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06294982135295868,0.03461908549070358,0.03302016109228134,0.031972650438547134,0.04467307776212692,0.009068183600902557,0.04598119854927063,0.006296440027654171,-8.979074482340366e-05,0.002620804589241743,-0.043861255049705505,-0.014556746929883957,0.03384070843458176,-0.026858014985919,-0.04558771103620529,0.0060893273912370205};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06663572043180466,0.054047562181949615,0.019253162667155266,0.06696990877389908,0.0383886843919754,-0.019028684124350548,-0.041979510337114334,-0.012508302927017212,-0.02490287832915783,-0.010546962730586529,-0.044768206775188446,0.051912978291511536,0.06514450162649155,-0.06111112982034683,0.07046172022819519,0.0652942955493927,-0.05895409733057022,-0.056865379214286804,-0.0021561719477176666,0.014761718921363354,-0.03822903707623482,0.008412809111177921,0.05794162675738335,0.02178647182881832,-0.010453678667545319,-0.002044130116701126,-0.0368703231215477,0.051344580948352814,0.021958908066153526,-0.0029125609435141087,0.02271886169910431,0.02504901960492134};
static const float action_parameterization_distribution_linear_bias[4] = {0.05068833753466606,0.011106796562671661,0.0467878058552742,0.0419594943523407};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.04285538196563721,0.274137407541275,-0.10160594433546066,0.1591786891222,0.21940501034259796,0.1938202977180481,0.250387966632843,0.011438697576522827},{-0.17089702188968658,-0.08473746478557587,-0.21615135669708252,-0.2813011407852173,-0.3047797679901123,-0.13615089654922485,-0.21575172245502472,-0.13227909803390503},{-0.26007360219955444,0.02556728944182396,0.24525761604309082,0.222967267036438,0.21435417234897614,0.005296063143759966,0.1641504317522049,-0.06813976913690567},{-0.04506372660398483,0.07069329172372818,-0.18736155331134796,0.0012405243469402194,-0.02853342518210411,-0.06559072434902191,0.15790002048015594,-0.12558794021606445},{-0.29971668124198914,-0.12100421637296677,-0.2531706392765045,-0.14047226309776306,-0.07313563674688339,0.1981206089258194,0.13474467396736145,-0.01255400013178587},{-0.37198391556739807,0.02116166427731514,0.3284038007259369,0.2546862065792084,0.16258777678012848,-0.031487807631492615,-0.11430356651544571,-0.12035802006721497},{-0.21024157106876373,0.07638917863368988,0.3073517382144928,-0.1731477975845337,-0.12007775157690048,-0.3254449665546417,-0.08512046933174133,-0.1359570473432541},{-0.4948207437992096,-0.3355226218700409,0.5072096586227417,-0.012809445150196552,-0.27197015285491943,0.1774097979068756,0.1927746683359146,-0.1755092889070511},{-0.2692391872406006,0.25973600149154663,-0.11105427891016006,0.42307373881340027,0.05366439372301102,-0.4267166554927826,0.09575772285461426,0.1597462296485901},{-0.24773749709129333,-0.3153020441532135,-0.13744303584098816,-0.1429542601108551,-0.47488003969192505,0.018408222123980522,-0.001411961973644793,0.17720404267311096},{0.1869155615568161,0.3439176380634308,0.23127281665802002,0.008186032995581627,0.26003870368003845,0.01380416750907898,-0.2281298041343689,0.25951486825942993},{0.22901271283626556,0.006583843845874071,0.2822287678718567,0.2833269536495209,-0.17321430146694183,0.24212868511676788,-0.019126225262880325,-0.20531779527664185},{0.12798640131950378,-0.2538983225822449,0.2267104536294937,0.005899745039641857,-0.13487498462200165,-0.04753703996539116,-0.14964056015014648,-0.18509067595005035},{-0.21550410985946655,-0.06087407469749451,0.3184390068054199,0.395842045545578,0.008974223397672176,-0.03336534649133682,-0.21584516763687134,0.05952419340610504},{-0.07084113359451294,-0.13979165256023407,0.09531727433204651,-0.1943979561328888,-0.2819823622703552,-0.1491284817457199,0.17127680778503418,-0.05199563503265381},{-0.030053047463297844,-0.005569671746343374,-0.02083948627114296,-0.3220689296722412,-0.06097547709941864,0.05888105183839798,-0.05142756924033165,0.35791951417922974},{0.0074286325834691525,-0.1919618844985962,-0.17556430399417877,0.03243880346417427,-0.19197256863117218,-0.1043490469455719,-0.09904873371124268,0.024260032922029495},{-0.14744965732097626,-0.21237514913082123,0.07222804427146912,-0.03816690668463707,0.11221332848072052,-0.17408831417560577,0.38204503059387207,0.09537678211927414},{0.07010375708341599,0.150356262922287,-0.2938152551651001,0.08438518643379211,0.08701807260513306,0.14130079746246338,-0.1948024481534958,0.2573222517967224},{0.16753067076206207,-0.08676178008317947,-0.37987735867500305,0.056049495935440063,-0.14196933805942535,-0.11504171788692474,-0.26217398047447205,-0.01727370172739029},{0.00938732922077179,-0.21931099891662598,-0.0029093907214701176,-0.13268135488033295,0.16825804114341736,-0.09435580670833588,-0.07282669842243195,0.4255664348602295},{-0.034013375639915466,0.06491133570671082,-0.32173895835876465,0.22807033360004425,0.21791194379329681,0.22627881169319153,0.06169253587722778,-0.28612110018730164},{-0.40663325786590576,-0.12239930778741837,0.07174855470657349,-0.07853309065103531,0.14896200597286224,-0.3871763050556183,0.12776903808116913,-0.2606288194656372},{-0.059175826609134674,0.09388461709022522,-0.11815204471349716,-0.4632396697998047,0.2409118413925171,0.0219523087143898,-0.3652220666408539,0.13215462863445282},{-0.10741420835256577,-0.19390763342380524,-0.14080218970775604,0.07899394631385803,0.13535399734973907,0.29957205057144165,0.26653021574020386,-0.0695176050066948},{-0.11624161154031754,0.056850615888834,-0.34753692150115967,-0.2466256469488144,0.12509354948997498,-0.0032209984492510557,-0.05257495492696762,0.05112507566809654},{0.3099299967288971,0.3550715446472168,-0.23441903293132782,0.26328572630882263,0.07968185842037201,0.27359384298324585,-0.2976861000061035,-0.174775630235672},{0.4182650148868561,0.25286927819252014,0.10750094056129456,0.09359878301620483,0.22126512229442596,0.055440813302993774,0.22540192306041718,0.3515952229499817},{-0.10378243774175644,0.3108898103237152,0.13716326653957367,0.04692632332444191,0.2632283568382263,-0.012948652729392052,-0.42061036825180054,-0.27755653858184814},{-0.15296266973018646,-0.26971009373664856,-0.04284195974469185,-0.17203232645988464,-0.23752917349338531,-0.150347501039505,0.20344887673854828,0.009412084706127644},{0.40886589884757996,-0.28853145241737366,0.22789153456687927,-0.24350301921367645,0.1435622125864029,0.29866349697113037,0.06733079999685287,-0.1562192142009735},{0.19797275960445404,0.428279846906662,0.4251834452152252,-0.19969765841960907,-0.19892922043800354,0.1733207404613495,0.19628210365772247,0.03817524388432503}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.051314618438482285,0.3598843812942505,-0.14820849895477295,0.2418559193611145,-0.35964086651802063,0.22174416482448578,0.4364159405231476,0.040081627666950226},{-0.38724637031555176,-0.442303329706192,-0.31942641735076904,-0.3669431209564209,-0.3987421989440918,0.37637534737586975,0.4767577648162842,-0.4048600494861603},{0.026472678408026695,-0.13987486064434052,0.1013554111123085,0.019944973289966583,-0.07714304327964783,0.3851892948150635,-0.29641029238700867,-0.2785218060016632},{0.34960150718688965,0.01068031881004572,0.06613343954086304,-0.014733405783772469,0.4978923201560974,0.38310956954956055,0.3727324604988098,0.3694819509983063},{0.10059747844934464,0.2086750715970993,-0.12878166139125824,-0.044472306966781616,0.11158464848995209,-0.3131343126296997,-0.34424063563346863,0.4370860159397125},{0.4105397164821625,0.09420585632324219,0.04690461978316307,-0.32495126128196716,-0.32138532400131226,-0.4462871849536896,-0.11813610792160034,0.45411694049835205},{-0.3046504557132721,-0.2739774286746979,0.0005220856401138008,-0.18760794401168823,0.07867533713579178,0.33105212450027466,-0.47092244029045105,0.5753757953643799},{0.11428516358137131,0.03146970272064209,0.015504867769777775,-0.09419336915016174,0.2941562831401825,-0.464613676071167,0.3777223527431488,-0.48501840233802795}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0396554172039032,0.011677189730107784,0.10794154554605484,-0.045053880661726,-0.04854770377278328,-0.04824276641011238,0.11927802115678787,-0.04365789517760277};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03971286118030548,-0.02487664297223091,0.04847288131713867,-0.10600311309099197,0.0283951573073864,0.004057867452502251,-0.01811317168176174,-0.04450232535600662};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

