#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.1891457736492157,-0.09129425883293152,0.2865520715713501,0.20362704992294312,-0.3066921830177307,0.28195029497146606,-0.07050018012523651,-0.13606558740139008,0.17074766755104065,0.36458468437194824,0.09202902764081955,0.034438151866197586,0.2638891339302063,-0.30674365162849426,0.24583888053894043,-0.04462569206953049},{-0.1366964876651764,-0.38226884603500366,0.36939677596092224,0.1542351096868515,-0.35444942116737366,0.09704004228115082,-0.3692238926887512,-0.0360434390604496,-0.12944258749485016,-0.21488326787948608,0.02858491986989975,-0.2503596544265747,0.0030208176467567682,-0.2986410856246948,-0.2499983161687851,0.08783701807260513},{0.07240232080221176,-0.28686976432800293,-0.2914564907550812,0.11627379804849625,0.18407590687274933,0.21344010531902313,0.04619832709431648,0.027832049876451492,-0.0846569612622261,-0.21287676692008972,-0.28417515754699707,0.4637643098831177,-0.04210057482123375,-0.24580581486225128,-0.3400527238845825,0.20067214965820312},{0.11327503621578217,0.2745887041091919,0.3568292558193207,-0.06511189043521881,-0.40205591917037964,-0.04346757009625435,0.254587322473526,0.09734760969877243,0.33233240246772766,-0.38630133867263794,0.06879792362451553,0.3578300476074219,-0.21580785512924194,0.07841185480356216,0.3843773603439331,-0.4017369747161865},{-0.054986756294965744,-0.04725531116127968,0.3319174647331238,-0.03795653209090233,0.32190850377082825,0.3954016864299774,0.31995877623558044,-0.018421124666929245,0.0983024537563324,0.24994878470897675,0.2959913909435272,-0.3731743097305298,-0.352125346660614,-0.36004638671875,0.46685290336608887,0.035683516412973404},{-0.03494446352124214,-0.3192330300807953,-0.1514037698507309,-0.12560951709747314,0.11925140023231506,0.07137326896190643,0.1329115927219391,-0.2758924067020416,0.3008139133453369,-0.39132192730903625,-0.41894999146461487,0.2106887847185135,0.23150169849395752,0.012813682667911053,0.02521667256951332,-0.06281236559152603},{0.014846324920654297,-0.04833913594484329,0.08571598678827286,-0.30170997977256775,0.24366715550422668,0.07464653253555298,0.1327245831489563,0.38069605827331543,0.3824065923690796,-0.0911732092499733,-0.42200174927711487,0.08295436948537827,-0.2425386756658554,0.1829129159450531,-0.11210819333791733,-0.3159344494342804},{-0.09779798984527588,0.12790504097938538,0.19913865625858307,0.339516282081604,-0.43291664123535156,-0.13080619275569916,0.34267181158065796,0.309135764837265,-0.11189054697751999,0.37629684805870056,-0.3815077245235443,-0.34814196825027466,0.33506378531455994,0.309259831905365,0.2738710343837738,0.15538619458675385},{0.23843322694301605,-0.13042809069156647,0.4268505573272705,-0.014014857821166515,0.25482165813446045,0.11703101545572281,-0.001521571772173047,-0.22695213556289673,0.013493997044861317,-0.2957320213317871,0.029374374076724052,-0.21350960433483124,-0.06617577373981476,0.42135733366012573,0.2762705981731415,-0.09201902896165848},{0.13625900447368622,-0.506572425365448,-0.408284068107605,-0.13263113796710968,-0.2864961624145508,0.2707673907279968,0.3538493514060974,0.3031124770641327,0.4642796218395233,0.24788177013397217,-0.14069074392318726,-0.3002883493900299,-0.05841570720076561,0.29409924149513245,-0.09812711179256439,-0.36882710456848145},{0.18743817508220673,0.25339338183403015,0.4430311620235443,-0.4601935148239136,-0.31660476326942444,0.26054635643959045,0.1884150505065918,0.46529319882392883,-0.28412050008773804,-0.07747164368629456,-0.14597639441490173,0.10000142455101013,-0.3970590829849243,-0.18501229584217072,0.37477907538414,-0.40112945437431335},{0.1014430820941925,-0.18252219259738922,0.04913365840911865,0.2040800303220749,0.41493213176727295,0.321990966796875,0.31737300753593445,0.11576291918754578,-0.15599532425403595,0.07055355608463287,0.2315560132265091,-0.1059320867061615,-0.29132503271102905,-0.16066984832286835,0.3614884614944458,0.1305568814277649},{-0.26797473430633545,0.33367645740509033,0.17573435604572296,-0.3952154517173767,0.07429909706115723,0.007826587185263634,0.287520170211792,0.06471548229455948,0.0433587022125721,-0.0001747552742017433,-0.11710173636674881,0.13473975658416748,0.31931763887405396,0.3711238205432892,0.16913825273513794,-0.27294105291366577},{-0.054517246782779694,-0.3867768347263336,-0.2413836270570755,-0.03228414058685303,-0.27748408913612366,0.09539845585823059,-0.2369801551103592,0.006898018531501293,-0.09558425098657608,-0.03595268353819847,-0.34551143646240234,-0.19098864495754242,-0.3178975284099579,0.30233919620513916,0.2788645923137665,0.012386756017804146},{0.0016451393021270633,-0.3270111382007599,-0.2920827865600586,0.2346232533454895,-0.056139007210731506,-0.2570706307888031,0.246602863073349,-0.07792145758867264,0.08227674663066864,0.20994099974632263,0.03365642577409744,0.22047960758209229,0.23515179753303528,-0.05975092947483063,-0.3139875829219818,0.2676929831504822},{0.36825841665267944,-0.01380234956741333,-0.25955361127853394,-0.2434684932231903,-0.39968055486679077,0.2651726305484772,0.4092240631580353,-0.13473957777023315,0.21259823441505432,0.3843616247177124,-0.19572147727012634,0.09849824011325836,-0.30224037170410156,0.34793028235435486,-0.1599508821964264,-0.01284356415271759},{-0.3548349440097809,-0.2658308148384094,0.22331710159778595,0.2599373757839203,-0.3385584354400635,0.15202578902244568,-0.23306703567504883,-0.22463040053844452,-0.23311235010623932,-0.2768403887748718,-0.12105657160282135,-0.31325119733810425,0.11837493628263474,-0.3296530544757843,0.0032597051467746496,-0.248997762799263},{-0.22380197048187256,0.2437889724969864,-0.2872222065925598,-0.17057593166828156,-0.033961039036512375,0.3267481029033661,-0.12865623831748962,-0.24938932061195374,0.06890790164470673,0.2129923403263092,0.27684086561203003,-0.1092907041311264,-0.39228543639183044,0.351492702960968,0.0764026939868927,-0.40397506952285767}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.021394262090325356,-0.03393422067165375,-0.1228242963552475,-0.28677552938461304,0.3866879343986511,0.2609502077102661,0.09537770599126816,0.06872665137052536,-0.14938630163669586,-0.1609172821044922,-0.04945512115955353,0.08477810770273209,0.21806393563747406,0.4389439821243286,0.056438568979501724,0.08098848164081573},{-0.24172909557819366,-0.267488569021225,-0.03876466304063797,0.09735532104969025,0.22590336203575134,-0.32023024559020996,0.14341658353805542,0.0647067278623581,-0.09957075864076614,0.2455114871263504,-0.24150557816028595,0.3672204315662384,-0.3633122742176056,0.20548491179943085,-0.43592163920402527,-0.34256038069725037},{0.07043091952800751,0.17707061767578125,-0.3592037558555603,-0.457676500082016,0.14557744562625885,0.4690057337284088,-0.06749550253152847,0.10781308263540268,-0.23004308342933655,-0.3040967881679535,0.03318241238594055,0.32372453808784485,-0.28135427832603455,-0.24938145279884338,0.0838472843170166,-0.047788355499506},{0.15709415078163147,-0.13428224623203278,0.08186398446559906,0.23832301795482635,-0.45911890268325806,-0.03336667641997337,0.05361732840538025,-0.173493430018425,0.29164183139801025,0.3878385126590729,-0.2031230479478836,-0.1795485019683838,-0.39834651350975037,-0.376436710357666,0.09718650579452515,0.1809806525707245},{-0.15472367405891418,0.1136888787150383,0.014655474573373795,0.21597078442573547,-0.2296840101480484,0.09033813327550888,0.01682862639427185,0.08262757211923599,0.2761254608631134,-0.302545428276062,0.1859283745288849,0.37182992696762085,0.21129892766475677,-0.41553032398223877,0.04052627459168434,-0.04020464047789574},{0.2874349057674408,0.2544121742248535,-0.05419352650642395,0.1573861986398697,-0.43089157342910767,-0.4252030551433563,0.160896435379982,0.25463005900382996,0.1111062616109848,0.3708890676498413,0.1772586703300476,-0.2572098970413208,-0.06321296095848083,-0.16865409910678864,-0.033644985407590866,0.24374331533908844},{-0.08202234655618668,0.26880794763565063,0.32546573877334595,-0.3672395944595337,-0.21507760882377625,0.03282884508371353,-0.2997799813747406,-0.06339845061302185,0.11308614164590836,0.11739970743656158,-0.14101457595825195,-0.22873421013355255,-0.31212735176086426,0.055983979254961014,0.20039139688014984,0.08045858144760132},{-0.18287716805934906,-0.13662609457969666,-0.44814491271972656,0.28191688656806946,-0.3622068464756012,-0.23541200160980225,-0.1687224805355072,-0.40279871225357056,0.10225759446620941,-0.25050026178359985,0.046005845069885254,0.17292240262031555,-0.1669970601797104,0.44033122062683105,-0.07005000114440918,-0.3549608588218689},{-0.2952401041984558,0.2989208996295929,0.022093577310442924,-0.0358254611492157,0.2998470067977905,-0.24006149172782898,0.33208876848220825,0.13274778425693512,0.29461485147476196,0.3063621520996094,0.24619273841381073,0.34804102778434753,0.16609950363636017,-0.0208593662828207,0.29208022356033325,0.09791743755340576},{0.046884018927812576,-0.2290785014629364,-0.19201324880123138,-0.10437887161970139,0.2939799129962921,-0.20273181796073914,-0.2794601619243622,-0.164943128824234,0.0603116936981678,-0.38878780603408813,-0.3158271908760071,0.37910181283950806,0.10358931869268417,0.20520317554473877,-0.3846440315246582,0.23766815662384033},{-0.1644897162914276,-0.41700437664985657,0.3332809507846832,0.265628457069397,0.2335427850484848,0.09591947495937347,0.19072282314300537,-0.11537805199623108,0.16424162685871124,-0.3080979287624359,0.06952386349439621,0.4227941930294037,0.4201410412788391,0.1424187868833542,-0.1824038177728653,-0.03397581726312637},{0.07078108191490173,-0.02119307592511177,0.37015146017074585,0.010568899102509022,-0.20723536610603333,-0.13195453584194183,0.4224666655063629,0.22903698682785034,-0.24653688073158264,-0.2449626326560974,-0.08249528706073761,-0.22877655923366547,-0.012049435637891293,-0.2606865465641022,-0.3750356435775757,0.039402469992637634},{-0.06658821552991867,-0.3168884813785553,0.4109839200973511,-0.19843025505542755,0.3127557039260864,-0.28584861755371094,-0.42744681239128113,0.09333554655313492,0.13037511706352234,0.08944401144981384,-0.29071199893951416,0.14012308418750763,0.11222951859235764,-0.3187977373600006,-0.4077644944190979,0.03303731232881546},{0.284940630197525,-0.3294405937194824,0.436709463596344,0.09468413144350052,-0.02995644137263298,0.2958035469055176,-0.13049449026584625,-0.24736806750297546,-0.4440445601940155,0.0631004273891449,-0.001796321477741003,-0.34219449758529663,-0.08108193427324295,0.171517476439476,0.29863283038139343,0.025069385766983032},{-0.17725802958011627,0.17396840453147888,0.12675397098064423,-0.3447492718696594,-0.18170033395290375,0.15682537853717804,0.3065839111804962,-0.2213512361049652,0.16842935979366302,-0.3414846658706665,0.021552275866270065,0.09422533214092255,-0.016157617792487144,0.1919594407081604,-0.07724177092313766,0.09141770750284195},{-0.2733023762702942,0.3224369287490845,-0.37267714738845825,0.41011297702789307,0.23753085732460022,-0.431250661611557,-0.020436253398656845,-0.11179564893245697,-0.34908029437065125,0.3390847444534302,-0.34215840697288513,0.34275537729263306,0.01739932782948017,-0.15569502115249634,-0.2780801057815552,-0.4913274347782135}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.15904659032821655,0.13340334594249725,-0.019042374566197395,-0.019471433013677597,-0.1273954212665558,0.06949247419834137,0.2612878084182739,0.10256662964820862,-0.19827868044376373,-0.2046910971403122,0.16346755623817444,-0.2969415485858917,-0.21615859866142273,0.23895792663097382,0.24197034537792206,0.30249443650245667,-0.24514341354370117,-0.2882538139820099,-0.1954410821199417,0.09389089047908783,-0.0765371099114418,-0.32289499044418335,-0.22558507323265076,-0.3198263943195343,-0.2902309000492096,0.20150089263916016,-0.22810351848602295,0.009180502966046333,-0.028034402057528496,0.005143968854099512,0.2565186023712158,-0.21313771605491638},{0.25500980019569397,0.23746071755886078,0.14246563613414764,-0.03785908222198486,0.07058679312467575,-0.09432915598154068,0.3126806914806366,0.13306225836277008,-0.21388785541057587,-0.07973234355449677,-0.04604567959904671,-0.2551685869693756,-0.21535594761371613,0.1797063946723938,-0.15893316268920898,-0.2816050350666046,-0.07517906278371811,0.14123953878879547,-0.33198583126068115,-0.28047406673431396,0.018211450427770615,0.22930026054382324,0.13981588184833527,-0.0734604001045227,0.13597950339317322,-0.313018798828125,0.014275014400482178,0.08627750724554062,0.2537693977355957,-0.11393395811319351,-0.06515665352344513,0.24376386404037476},{0.10988004505634308,0.06130962073802948,-0.16294175386428833,0.1611986756324768,-0.16942919790744781,-0.14752815663814545,-0.22644159197807312,0.048437245190143585,-0.16219355165958405,0.38848650455474854,-0.2786344885826111,-0.29499852657318115,0.10074084252119064,-0.36356452107429504,-0.16528141498565674,0.0757329910993576,-0.10559556633234024,-0.11836625635623932,0.16948261857032776,-0.14166544377803802,0.23513546586036682,0.3115736246109009,-0.2329901158809662,-0.029347894713282585,-0.28843459486961365,0.030939949676394463,0.12768897414207458,-0.07223958522081375,-0.0122660081833601,-0.26123329997062683,-0.1301194578409195,-0.07149926573038101},{0.38280224800109863,0.033945802599191666,0.1266210675239563,-0.11976087093353271,-0.2583763301372528,-0.03804843872785568,-0.18381601572036743,0.22217866778373718,0.2817436754703522,-0.329250305891037,-0.09315686672925949,0.3260391652584076,0.10399225354194641,-0.08509133756160736,-0.2194114327430725,0.22758570313453674,-0.27688300609588623,0.2328110933303833,0.018917104229331017,0.05551779642701149,-0.057153407484292984,-0.1416091024875641,0.2775636911392212,0.12820476293563843,0.153326615691185,-0.36167189478874207,0.2817624807357788,-0.2194097340106964,-0.03433110564947128,0.13808228075504303,-0.2103320062160492,0.19699804484844208},{-0.026754427701234818,-0.08856187760829926,-0.107827328145504,0.0770820677280426,0.22473840415477753,-0.20687048137187958,-0.39253097772598267,-0.0374208502471447,-0.107588030397892,-0.24638205766677856,0.10765600949525833,0.2363072782754898,-0.01792220212519169,-0.11164999008178711,-0.1374179720878601,0.19020354747772217,-0.0565926693379879,-0.03566569834947586,-0.3216541111469269,-0.13013479113578796,-0.1499747782945633,-0.38165751099586487,0.15056273341178894,0.20972804725170135,-0.055437300354242325,0.31769809126853943,-0.18684186041355133,0.1779019981622696,0.3215109407901764,0.3539273738861084,-0.06109381094574928,0.3431064486503601},{-0.2455471158027649,-0.02481299638748169,-0.19874116778373718,-0.1156102791428566,-0.216303750872612,0.2440458983182907,0.24756675958633423,0.08623760938644409,0.2572804391384125,0.243439182639122,0.3271912634372711,-0.24051061272621155,-0.24033039808273315,0.20471912622451782,0.3173857033252716,-0.2601536214351654,-0.13051198422908783,-0.22894325852394104,0.2359195202589035,0.19255831837654114,0.05680512264370918,0.18123766779899597,0.043841078877449036,-0.009236789308488369,-0.32682937383651733,0.33007699251174927,-0.171938955783844,0.22133517265319824,0.3000301122665405,0.1878005713224411,0.08811094611883163,-0.011134909465909004},{0.1572655737400055,-0.1346191018819809,-0.11634307354688644,-0.299137681722641,-0.00935428123921156,0.23954616487026215,0.294612854719162,0.1318502277135849,0.08189491927623749,0.3640553653240204,-0.01920376345515251,-0.015583012253046036,-0.39770182967185974,-0.1331263780593872,-0.1426810324192047,0.09058953076601028,-0.2696392834186554,-0.22127018868923187,0.1940411478281021,-0.12006811052560806,-0.12220223993062973,-0.1496410071849823,-0.24761269986629486,-0.2598031759262085,0.11750122159719467,-0.2304707169532776,-0.11060924828052521,-0.22144344449043274,0.31830430030822754,0.11045613884925842,-0.1803474873304367,-0.2868025302886963},{-0.02157074213027954,0.24114890396595,0.026507865637540817,-0.0221865177154541,0.1019793152809143,-0.2616819143295288,-0.11742323637008667,-0.18584002554416656,-0.08404437452554703,-0.2411268651485443,-0.26885464787483215,-0.08904193341732025,-0.15362046658992767,0.013619525358080864,-0.07605038583278656,0.3504868447780609,-0.015999989584088326,-0.17276597023010254,0.10842321813106537,0.273042768239975,-0.13865500688552856,-0.194843590259552,0.326718807220459,0.01852334849536419,-0.09195826202630997,-0.2843431830406189,-0.2934459447860718,-0.2602023482322693,-0.30107879638671875,-0.29299843311309814,0.0663171261548996,-0.3140880763530731},{0.05443273112177849,0.33913156390190125,-0.31910184025764465,-0.3566860556602478,-0.20026655495166779,0.1019519492983818,0.11580569297075272,0.03473767638206482,0.1054496094584465,-0.2715829908847809,-0.19777369499206543,0.2710597515106201,-0.2787070870399475,-0.13369622826576233,0.17740553617477417,-0.2774834632873535,0.27507081627845764,0.17719900608062744,0.31821000576019287,-0.004795210435986519,0.16920462250709534,0.1280108094215393,0.26007622480392456,-0.10691267997026443,0.36948150396347046,-0.20480461418628693,0.11340238153934479,0.3430124819278717,-0.2631072700023651,0.1568310409784317,0.003411763347685337,0.12638729810714722},{-0.18967078626155853,0.11464554816484451,-0.27808550000190735,-0.1137581467628479,0.1408073753118515,-0.19790184497833252,0.06270391494035721,-0.01980000175535679,0.17997615039348602,-0.02041667513549328,-0.29380255937576294,-0.3002336025238037,-0.3410423696041107,-0.09447940438985825,-0.2436995953321457,0.05820399522781372,0.014947829768061638,-0.263723224401474,0.22731949388980865,0.09357498586177826,0.0694199651479721,-0.07627259194850922,0.3144949674606323,-0.21134552359580994,0.27154073119163513,0.14161400496959686,-0.27791157364845276,-0.026419101282954216,-0.005660019814968109,0.12801849842071533,-0.18202832341194153,0.11537814140319824},{0.0812268853187561,0.0713953971862793,0.18810953199863434,-0.28107285499572754,-0.339789479970932,-0.17812955379486084,-0.2538559138774872,-0.005217528901994228,-0.2670186161994934,0.4300853908061981,0.1839125156402588,-0.2538484036922455,-0.39837512373924255,-0.03550569713115692,-0.16058999300003052,-0.1257118582725525,0.22831474244594574,-0.13869038224220276,0.28762689232826233,-0.1775549203157425,-0.2101859599351883,0.04671282693743706,0.20055323839187622,0.19385512173175812,0.14449124038219452,-0.1465567648410797,-0.003941334784030914,-0.03842052072286606,-0.0487796850502491,0.022204134613275528,0.011050394736230373,0.12212315946817398},{-0.1702321469783783,-0.10651315003633499,0.2148120105266571,0.2482689917087555,0.30467382073402405,-0.01136187557131052,0.09747608751058578,-0.21933111548423767,-0.0708814412355423,-0.2726519703865051,0.26867160201072693,-0.22667397558689117,-0.1867225617170334,-0.18305732309818268,0.2550084590911865,0.023256400600075722,0.02193363569676876,0.05970917269587517,0.3745608925819397,0.06108073145151138,-0.21660134196281433,0.2669967710971832,0.0992477536201477,-0.05189140886068344,0.2729310691356659,-0.13818906247615814,-0.14397083222866058,0.24094858765602112,0.1551228016614914,0.0009249263675883412,-0.2660132944583893,-0.2572246789932251},{0.3137401342391968,-0.25842633843421936,0.012438623234629631,-0.2774903178215027,0.02625562995672226,-0.12593132257461548,0.0792146846652031,0.12784305214881897,0.22244279086589813,0.03934771195054054,0.18440178036689758,0.2834371328353882,-0.3814546465873718,-0.34646573662757874,-0.03056778572499752,-0.2730463743209839,-0.20798803865909576,-0.29789796471595764,0.3431779444217682,-0.25379979610443115,0.34667208790779114,-0.10339976847171783,0.009977679699659348,0.15070991218090057,0.13890966773033142,-0.13812541961669922,0.11835329979658127,0.06245424970984459,0.14311431348323822,0.03611497953534126,-0.24017424881458282,0.017486045137047768},{0.26924601197242737,-0.0632920190691948,-0.010737774893641472,0.35291755199432373,-0.07032109797000885,-0.20268388092517853,-0.015577712096273899,0.17364752292633057,0.20002207159996033,0.2762811779975891,0.10532490164041519,-0.13652421534061432,0.08364971727132797,0.2341921031475067,-0.15668076276779175,0.14005695283412933,0.23930415511131287,-0.200585275888443,0.0796997994184494,-0.31735488772392273,0.2567812204360962,0.1677851527929306,-0.12273295223712921,0.23334984481334686,0.2726530432701111,0.07621340453624725,0.11235035955905914,0.07823766022920609,0.05789266899228096,-0.16783756017684937,0.010721579194068909,0.3267631530761719},{0.057777080684900284,-0.20834466814994812,-0.018463807180523872,0.10233758389949799,-0.29887154698371887,0.031295180320739746,0.054019954055547714,-0.19660957157611847,-0.18170113861560822,-0.03184158354997635,0.20970728993415833,0.17354710400104523,0.07633023709058762,0.2511804401874542,-0.030277665704488754,-0.04511537402868271,-0.20994776487350464,0.2878496050834656,-0.08093603700399399,-0.20448358356952667,-0.22184516489505768,-0.07448680698871613,0.1588221937417984,0.03423566371202469,-0.03879980370402336,-0.11242102831602097,-0.20160254836082458,0.2503319978713989,0.05649665743112564,-0.1462821215391159,0.2880280315876007,0.13465622067451477},{0.18158137798309326,-0.2111664116382599,0.016429902985692024,-0.1833445280790329,-0.008285189047455788,0.16609202325344086,0.06349839270114899,0.27970534563064575,-0.11909874528646469,-0.027802210301160812,0.2382863163948059,0.09702794253826141,0.07920144498348236,-0.06703455001115799,-0.015604418702423573,0.19326965510845184,-0.34653154015541077,-0.19964207708835602,-0.038475193083286285,0.06314915418624878,0.038115084171295166,0.2541598975658417,0.16557347774505615,0.1619708389043808,0.04644140973687172,0.19977928698062897,-0.0575142502784729,-0.05270877853035927,0.10818967968225479,-0.11107993125915527,-0.2495916187763214,0.3031850755214691},{0.1386881023645401,-0.036458805203437805,-0.296089768409729,0.2595163583755493,0.13842634856700897,-0.015502586029469967,0.2552362084388733,0.006805999670177698,0.19135239720344543,-0.22689853608608246,0.18757523596286774,-0.2168932557106018,-0.3532659113407135,0.30245253443717957,0.0706443339586258,-0.05498373135924339,0.09792099893093109,-0.09596125781536102,-0.16368773579597473,-0.05013300105929375,-0.01886097900569439,0.15441951155662537,0.011106831952929497,-0.20098283886909485,-0.1150687038898468,-0.16024498641490936,-0.013497701846063137,0.34153154492378235,0.2842337489128113,-0.09807126969099045,0.21221119165420532,0.25623130798339844},{-0.11273191124200821,-0.04895397648215294,-0.08112544566392899,-0.06031171604990959,-0.18507015705108643,-0.008912493474781513,0.25875213742256165,0.13614892959594727,0.17726455628871918,-0.021459247916936874,0.185393288731575,-0.05836857855319977,0.22378624975681305,0.25825509428977966,0.1424044519662857,-0.10372679680585861,0.1707042157649994,0.2166958749294281,0.18462024629116058,0.005165058188140392,0.15439173579216003,0.28661900758743286,0.044132888317108154,0.15479741990566254,-0.042567092925310135,-0.035526588559150696,-0.18348966538906097,-0.2267233431339264,0.16747690737247467,-0.29186487197875977,0.06311295181512833,-0.06637952476739883},{-0.3423970341682434,0.06937910616397858,-0.37680330872535706,-0.3241850733757019,-0.006624253932386637,0.01508705597370863,0.122531957924366,-0.17218433320522308,0.013058595359325409,0.3665717542171478,0.06720678508281708,-0.23435787856578827,0.012148375622928143,-0.20448057353496552,-0.2830038368701935,-0.0067236702889204025,-0.19192960858345032,0.110449880361557,-0.06721234321594238,-0.03359145298600197,-0.2959197163581848,0.1690191626548767,0.1463783234357834,0.032701436430215836,-0.07892061024904251,0.348136305809021,0.08788314461708069,-0.18158286809921265,-0.18228690326213837,0.009744023904204369,-0.20042939484119415,-0.2542121410369873},{0.0286263320595026,-0.25323471426963806,-0.27169424295425415,-0.05690751597285271,-0.3208048939704895,-0.15984223783016205,0.17091234028339386,-0.2687992453575134,-0.2205430567264557,0.17610706388950348,0.16411688923835754,0.11221391707658768,0.14298053085803986,-0.14149099588394165,0.2744655907154083,-0.24159173667430878,0.1021118015050888,0.2700164020061493,0.04289516434073448,0.3006077706813812,0.010983116924762726,-0.11245860904455185,-0.30419206619262695,0.24647140502929688,-0.09495227783918381,-0.17252646386623383,0.11775248497724533,0.047614432871341705,-0.1632150262594223,-0.3058016896247864,-0.042596329003572464,-0.20420138537883759},{0.21127662062644958,0.18639437854290009,-0.07138025015592575,0.1940457820892334,-0.29279589653015137,0.14657853543758392,-0.09207703173160553,-0.17705656588077545,-0.15711942315101624,0.2146504521369934,-0.2777191698551178,-0.13402797281742096,-0.03172110766172409,-0.21963058412075043,-0.33664804697036743,-0.20589511096477509,-0.10770781338214874,-0.31406548619270325,-0.22856856882572174,0.2596130967140198,0.14090675115585327,0.11378975957632065,-0.3198760151863098,0.30517342686653137,0.14851634204387665,0.27184173464775085,-0.26942503452301025,-0.07421154528856277,0.10852237790822983,-0.2254112809896469,0.13784751296043396,0.15192186832427979},{-0.02955685369670391,-0.3134166896343231,-0.03694627061486244,-0.3204590380191803,-0.04296382516622543,0.2800131142139435,0.2085111141204834,0.02764570713043213,-0.08216235041618347,0.012918415479362011,-0.20897163450717926,0.10603707283735275,0.1423521339893341,0.08585229516029358,0.09581448137760162,0.06357622891664505,-0.06000833213329315,0.16538728773593903,-0.13845273852348328,0.17458021640777588,0.17818373441696167,0.2656503915786743,-0.07797087728977203,-0.21858595311641693,0.17835594713687897,0.1562781035900116,0.25450608134269714,0.17188413441181183,-0.024977074936032295,0.11917372047901154,0.00492601003497839,-0.13060534000396729},{0.06555163860321045,-0.19190055131912231,0.3085700571537018,-0.01468731090426445,0.26418787240982056,-0.07068382948637009,-0.1360965222120285,-0.10886741429567337,0.12815171480178833,-0.04007799178361893,0.06917186081409454,0.05732959881424904,-0.26325157284736633,0.020677052438259125,-0.11285874992609024,-0.2242199182510376,-0.09142442792654037,-0.058255620300769806,0.24115969240665436,0.3098776638507843,0.040730975568294525,0.021417351439595222,0.1788066327571869,0.3590025007724762,-0.10433828085660934,-0.14385949075222015,0.19235409796237946,-0.11843491345643997,-0.21105752885341644,-0.23448406159877777,0.29156750440597534,-0.011185559444129467},{0.23715725541114807,-0.11028489470481873,0.05149661749601364,0.09944850951433182,-0.030515523627400398,0.017128895968198776,-0.2427653968334198,0.32379379868507385,-0.08722889423370361,-0.01936984993517399,0.0734466016292572,-0.28036293387413025,0.06916936486959457,-0.06312977522611618,-0.14019685983657837,0.3732767701148987,-0.08934782445430756,-0.1885625571012497,0.01719752326607704,0.04222483187913895,-0.17644794285297394,0.16933591663837433,0.1848042905330658,0.279072642326355,-0.23929573595523834,0.10334295779466629,-0.07739327847957611,0.06365518271923065,-0.3311883211135864,0.27337846159935,-0.08288563787937164,0.022146685048937798}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.2712126672267914,-0.08572212606668472,0.14099523425102234,-0.16449500620365143},{0.26264387369155884,-0.26451534032821655,0.2978290021419525,0.2791965901851654},{-0.3525157868862152,0.0013132409658282995,0.1791020631790161,-0.050474368035793304},{0.30893152952194214,0.46684151887893677,0.35143357515335083,-0.001066154451109469},{-0.3027849793434143,0.16814777255058289,-0.3073391318321228,0.09497435390949249},{-0.0436449758708477,-0.12133025377988815,0.06724622845649719,0.43133237957954407},{-0.1396198719739914,-0.11751895397901535,-0.42137184739112854,0.05244922637939453},{-0.15443739295005798,-0.26415205001831055,0.17415210604667664,-0.04396045580506325},{-0.15477178990840912,0.22422625124454498,-0.11067424714565277,-0.14453698694705963},{0.3195677399635315,-0.04186974838376045,-0.15067064762115479,-0.25040513277053833},{0.1490238457918167,-0.2404857873916626,0.33463674783706665,0.276185005903244},{-0.09672620892524719,-0.00018481435836292803,0.460212767124176,-0.11950711905956268},{-0.37283599376678467,0.2038748413324356,-0.08622922003269196,-0.14571703970432281},{-0.23124940693378448,0.03564566373825073,-0.26062431931495667,0.10226472467184067},{0.15669484436511993,-0.062014319002628326,0.2222633957862854,0.10580787807703018},{-0.15051135420799255,-0.3023025095462799,-0.15236157178878784,-0.09390242397785187},{-0.37015897035598755,0.03057483583688736,-0.15357328951358795,0.3521727919578552},{-0.3146393597126007,-0.1504347175359726,-0.2828385531902313,0.24112215638160706},{-0.10601538419723511,-0.1584191769361496,0.42620208859443665,0.08428116142749786},{-0.20104067027568817,-0.21882301568984985,-0.006444863509386778,-0.21458061039447784},{0.18441855907440186,0.16688542068004608,0.13582271337509155,-0.20698168873786926},{-0.02492346428334713,-0.3092035949230194,-0.2495356649160385,0.37326881289482117},{0.3687548339366913,-0.16188548505306244,0.21901912987232208,0.060466330498456955},{-0.36824560165405273,-0.15700663626194,-0.32688969373703003,-0.40803781151771545},{-0.24556486308574677,-0.1752665489912033,-0.01133776642382145,-0.08078714460134506},{0.2264377623796463,0.1694909781217575,-0.12063051760196686,0.07848794013261795},{0.1882244199514389,-0.2159949094057083,0.26536497473716736,0.08802314847707748},{-0.1162748634815216,-0.18497109413146973,-0.044950418174266815,0.3192256689071655},{0.16069667041301727,0.08510098606348038,0.06253097951412201,0.049276962876319885},{-0.2146470993757248,0.10275507718324661,0.3049548268318176,-0.04009734466671944},{-0.23338663578033447,-0.1712144911289215,0.0933903232216835,0.2869710624217987},{0.2369658499956131,0.2522910535335541,0.3452568054199219,-0.06374277919530869}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.037034258246421814,-0.012296846136450768,-0.003394070314243436,0.07378140836954117,0.03940718621015549,-0.057536810636520386,0.0038563054986298084,0.056079935282468796,-0.07710271328687668,-0.07365062087774277,-0.010195591486990452,-0.02404855191707611,-0.062497641891241074,0.04648910090327263,-0.0190129354596138,-0.04405613988637924};
static const float actor_encoder_self_encoder_2_bias[16] = {0.01226249523460865,0.002990230219438672,-0.013256736099720001,-0.0066774217411875725,-0.049796778708696365,0.04850250110030174,-0.02816610224545002,-0.021289480850100517,0.03368768468499184,-0.03389861807227135,0.01825609616935253,-0.010149429552257061,-0.01380443200469017,-0.06218033656477928,0.021797044202685356,-0.04242534562945366};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0027728199493139982,0.02686922997236252,-0.00315005867742002,0.010196320712566376,-0.005974163766950369,0.024429885670542717,-0.026705875992774963,-0.009973620064556599,0.0014155965764075518,-0.03554924950003624,0.008251653984189034,0.01831045188009739,0.008495146408677101,0.01133156381547451,0.028077898547053337,-0.056901801377534866,0.012434711679816246,-0.010519571602344513,0.02503170445561409,-0.03326776623725891,-0.006548217497766018,0.008276179432868958,-0.0019236019579693675,-0.03688254579901695,-0.04269096255302429,0.008728929795324802,0.010741492733359337,0.012617737986147404,0.004738364834338427,0.021162429824471474,0.038907021284103394,0.00733178248628974};
static const float action_parameterization_distribution_linear_bias[4] = {-0.001606341334991157,0.02214524894952774,0.016270946711301804,0.028459258377552032};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3479658365249634,-0.30829206109046936,-0.2155577689409256,0.13805097341537476,-0.30700838565826416,0.09736894071102142,-0.2980597913265228,-0.009187877178192139},{0.20984496176242828,0.1959303468465805,0.35284358263015747,0.3344185948371887,-0.1853097677230835,-0.38898614048957825,0.33842307329177856,0.41115444898605347},{0.08355972915887833,0.2527916431427002,0.09712495654821396,-0.07140100747346878,0.3147079050540924,0.18107332289218903,0.018330777063965797,0.2883138358592987},{0.10411335527896881,-0.2914738059043884,0.3252466022968292,-0.21388210356235504,-0.23682686686515808,0.08751232177019119,0.33723896741867065,0.28216978907585144},{-0.28381505608558655,-0.03694869950413704,-0.06334848701953888,-0.3494797945022583,0.14563874900341034,0.12799175083637238,0.3608548939228058,0.2956761121749878},{-0.09190557152032852,0.25591975450515747,-0.03180865943431854,-0.2983250319957733,0.3417471945285797,0.1248193010687828,0.11404868960380554,-0.15732260048389435},{-0.008932973258197308,0.24533125758171082,0.11074136197566986,-0.24278436601161957,0.4315919876098633,-0.12480801343917847,0.18758593499660492,0.11731071770191193},{0.09142860025167465,-0.3060576617717743,-0.10517365485429764,-0.3306611478328705,0.2486128807067871,-0.029032431542873383,-0.15745000541210175,-0.30649763345718384},{-0.2655104696750641,0.26804444193840027,-0.14630579948425293,-0.1856192648410797,-0.13260473310947418,0.4167569577693939,0.368939071893692,0.22815684974193573},{-0.010975885204970837,-0.05828584358096123,-0.39218074083328247,0.19607491791248322,0.18695016205310822,0.3122608959674835,0.32685309648513794,-0.37125444412231445},{-0.1735108643770218,-0.31912705302238464,0.27978214621543884,0.12179099768400192,-0.05549531802535057,-0.25652211904525757,0.04950864985585213,-0.3700312077999115},{0.22517667710781097,0.09364954382181168,0.32862555980682373,0.3589436411857605,-0.17314191162586212,0.32410621643066406,0.2460860162973404,-0.36077865958213806},{-0.3922821581363678,0.19749638438224792,-0.42047038674354553,0.3936382234096527,-0.06620626896619797,0.40310147404670715,0.07027022540569305,0.26193907856941223},{-0.029789788648486137,0.24849803745746613,-0.17374688386917114,-0.1303655505180359,0.006420424673706293,0.07395968586206436,0.38826388120651245,0.05497223883867264},{0.1795998513698578,-0.25343459844589233,-0.3480849862098694,-0.15348796546459198,0.1696394681930542,-0.2666315734386444,0.22898335754871368,0.001572631299495697},{-0.3890838325023651,-0.26725149154663086,-0.21089443564414978,0.04714573919773102,0.06428215652704239,0.11363214999437332,0.33818528056144714,0.05942650884389877},{-0.11182300746440887,-0.25554126501083374,0.2811380922794342,-0.3154296278953552,0.09277641028165817,-0.04923555627465248,-0.31283020973205566,-0.15766744315624237},{0.09063155204057693,0.2309894859790802,0.19553829729557037,0.2096182256937027,-0.030398160219192505,0.29577770829200745,0.41030433773994446,-0.11981474608182907},{0.07460364699363708,-0.3290219306945801,-0.037430789321660995,-0.06575299799442291,-0.10008862614631653,-0.36384105682373047,0.17962646484375,-0.2530709505081177},{-0.027778854593634605,0.004469332285225391,0.1601228266954422,-0.31780552864074707,0.08997563272714615,0.09943985193967819,0.22261017560958862,-0.07952391356229782},{0.09108445793390274,-0.10807231813669205,0.11371330171823502,-0.2806830108165741,0.030928073450922966,-0.010034781880676746,0.12088558822870255,-0.2142118662595749},{-0.33056461811065674,0.17642450332641602,0.20956310629844666,-0.24949420988559723,-0.4281262457370758,0.019417107105255127,0.29852530360221863,0.040047451853752136},{0.2676137089729309,0.08667642623186111,-0.31541207432746887,0.12908518314361572,0.006943438667804003,0.25009721517562866,0.41493654251098633,0.33875033259391785},{-0.041480209678411484,-0.18296197056770325,0.11159996688365936,0.31459110975265503,-0.22729676961898804,-0.009406301192939281,0.02088026888668537,-0.2857750952243805},{0.20542998611927032,0.08011849969625473,-0.37699708342552185,0.3343060612678528,-0.24764150381088257,-0.32636594772338867,-0.265392005443573,0.22213001549243927},{0.04089852049946785,0.3665459156036377,-0.2617437243461609,-0.07378170639276505,0.11026152968406677,-0.23934683203697205,0.40779098868370056,-0.2547917366027832},{-0.08240927755832672,0.0701354518532753,-0.1475841999053955,-0.18388725817203522,0.04280806705355644,-0.17095424234867096,-0.022593678906559944,-0.12219485640525818},{0.13201740384101868,-0.18537381291389465,-0.03561895340681076,-0.12918327748775482,0.030889339745044708,0.0240471251308918,-0.12716789543628693,0.11275922507047653},{0.34013330936431885,0.020411012694239616,-0.36347559094429016,-0.2208162099123001,-0.21562129259109497,0.12806566059589386,0.29710349440574646,0.10577020794153214},{0.3691399097442627,-0.3535196781158447,0.011638609692454338,-0.06474455446004868,0.1585065722465515,-0.09643441438674927,0.2730399966239929,0.36295458674430847},{-0.3266192376613617,-0.24429458379745483,0.07098526507616043,-0.3126775622367859,0.3509571850299835,-0.18650810420513153,0.12023578584194183,0.05298102647066116},{0.04310200363397598,-0.0753021165728569,-0.14403191208839417,0.23912698030471802,0.05061260610818863,0.12242263555526733,0.042154256254434586,-0.08249248564243317}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.22879602015018463,0.4185599386692047,-0.5785294771194458,-0.4955289661884308,-0.26514333486557007,0.006468014791607857,-0.4538367986679077,0.4861767590045929},{-0.025594191625714302,0.5559406876564026,-0.19434978067874908,0.5880804061889648,-0.028555501252412796,0.13662266731262207,-0.26815271377563477,0.09867961704730988},{-0.48513364791870117,-0.20242515206336975,-0.14774802327156067,-0.1539255827665329,0.5501931309700012,0.26414626836776733,0.019310129806399345,0.5333042144775391},{-0.48607009649276733,-0.49095332622528076,0.39063599705696106,0.36776861548423767,-0.526823878288269,-0.16243961453437805,0.48716479539871216,0.3024345338344574},{-0.25777795910835266,-0.24918366968631744,-0.3336558938026428,-0.2818516194820404,0.2888840138912201,-0.23834888637065887,0.5211950540542603,-0.4517703652381897},{0.03099709190428257,0.24518704414367676,0.3512730598449707,-0.6298664212226868,0.48522040247917175,-0.3021368086338043,-0.4841909110546112,-0.3735634684562683},{-0.4041746258735657,0.19642296433448792,0.08212265372276306,-0.4332749545574188,-0.03799591213464737,-0.5929185152053833,0.5202967524528503,-0.008533087559044361},{-0.428931325674057,-0.25560393929481506,-0.2180953025817871,-0.3521564304828644,-0.35183942317962646,0.16443322598934174,0.6183074116706848,-0.3739515244960785}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.04505695775151253,-0.014545902609825134,-0.006189879961311817,0.00011167991033289582,-0.024910688400268555,-0.00011260202154517174,0.017231974750757217,0.03829682245850563};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.017642730847001076,-0.008759045973420143,-0.002588721225038171,-0.0012717717327177525,-0.03779327869415283,-0.01533511932939291,-0.01831754669547081,-0.031761132180690765};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

