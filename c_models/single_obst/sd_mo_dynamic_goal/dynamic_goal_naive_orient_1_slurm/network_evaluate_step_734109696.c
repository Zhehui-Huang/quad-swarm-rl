#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2641606330871582,0.008744588121771812,-0.14849218726158142,0.27296561002731323,0.28875038027763367,-0.21214939653873444,-0.228915274143219,0.11610932648181915,0.2612721621990204,-0.3004760146141052,0.61620032787323,-0.0018803700804710388,0.2939087152481079,0.10051461309194565,-0.4229620397090912,0.046220045536756516},{-0.22826741635799408,-0.27955782413482666,-0.3078155517578125,-0.18244287371635437,0.07846377789974213,0.25410228967666626,0.06320256739854813,0.05578327551484108,0.24041379988193512,0.19686377048492432,-0.16115738451480865,-0.08303055167198181,-0.17175284028053284,0.07184778153896332,0.3253048360347748,-0.31050944328308105},{0.1363205909729004,0.21441905200481415,0.1845647692680359,0.3437998592853546,-0.1024828627705574,-0.23825059831142426,0.4921019375324249,-0.04570074751973152,-0.004246419295668602,-0.1303538680076599,-0.02077353559434414,-0.01229880005121231,0.06125352904200554,0.477145254611969,-0.26889267563819885,-0.03875899687409401},{0.10993686318397522,-0.13935434818267822,-0.15080121159553528,-0.10675529390573502,0.038123663514852524,0.09276625514030457,0.07819700241088867,-0.2090836614370346,-0.1582755297422409,0.1637241393327713,0.5190069675445557,-0.20636916160583496,-0.16432850062847137,-0.15029452741146088,0.17737558484077454,0.13250955939292908},{-0.32846638560295105,0.05407561734318733,0.14427955448627472,-0.2235155999660492,0.2663734555244446,0.2994753122329712,0.15059182047843933,-0.2082095742225647,-0.10855463147163391,0.15882658958435059,-0.14463403820991516,-0.3766612708568573,-0.022935623303055763,-0.14304250478744507,0.3137734830379486,-0.04491537809371948},{-0.029905419796705246,-0.008850419893860817,-0.029047664254903793,-0.0012362339766696095,0.11980099231004715,-0.07377534359693527,0.39909598231315613,-0.34051892161369324,-0.1437397450208664,-0.14744262397289276,0.2977108955383301,0.01870807819068432,0.21166028082370758,0.0970989465713501,0.2657301425933838,0.2747127413749695},{-0.17437894642353058,0.15925711393356323,-0.039833780378103256,0.10943253338336945,-0.23076799511909485,-0.09949696809053421,-0.1601877510547638,-0.03590753674507141,0.13987700641155243,0.3373643159866333,-0.18396808207035065,-0.08931057155132294,0.21664080023765564,0.06852255016565323,-0.18635544180870056,0.29159748554229736},{-0.11168377101421356,-0.025998275727033615,-0.15631166100502014,-0.20585092902183533,0.36274048686027527,-0.30705562233924866,-0.31137725710868835,-0.4079683721065521,-0.07554090023040771,-0.2440340667963028,0.4041275084018707,-0.026879386976361275,0.23422816395759583,0.14555418491363525,-0.19170279800891876,0.42326226830482483},{0.2324783056974411,0.0764165148139,-0.01681065745651722,0.10936176031827927,-0.38818472623825073,-0.4043242633342743,0.33827370405197144,-0.3101406991481781,-0.1436968445777893,0.23730525374412537,0.18547262251377106,-0.29025083780288696,-0.15102361142635345,0.04012826457619667,0.19855204224586487,-0.018094800412654877},{0.43958380818367004,-0.5044434666633606,-0.06684920191764832,0.00662818131968379,0.24406535923480988,-0.09927350282669067,-0.23642857372760773,-0.12810572981834412,-0.182308167219162,0.02195810154080391,-0.027609998360276222,-0.22410941123962402,0.34702423214912415,-0.07857406884431839,-0.5372655391693115,-0.18084880709648132},{0.2734924554824829,0.16557574272155762,-0.339403361082077,0.09701816737651825,-0.0029667650815099478,-0.17647388577461243,-0.11751902848482132,0.14084497094154358,-0.1488569676876068,0.12267464399337769,0.19869861006736755,0.2284695953130722,-0.09930592030286789,0.24170631170272827,-0.03826964274048805,-0.2731144428253174},{-0.44284987449645996,0.28760194778442383,0.23266297578811646,-0.28721311688423157,-0.2483791559934616,0.32504284381866455,0.04804109036922455,0.31751367449760437,0.21107734739780426,0.13579441606998444,0.2086736112833023,-0.11664693057537079,0.16373775899410248,-0.07502391934394836,-0.10092523694038391,-0.1542365998029709},{0.09031374007463455,-0.24548789858818054,-0.2235279530286789,0.17082373797893524,-0.24064213037490845,-0.2514725923538208,-0.12634064257144928,0.2344394475221634,0.32175955176353455,-0.15629655122756958,-0.062379349023103714,0.04273282736539841,0.2509978413581848,0.13961929082870483,-0.16962930560112,0.2902844548225403},{0.2670908272266388,0.1739344298839569,-0.13484519720077515,-0.112369105219841,0.061684295535087585,-0.08458153903484344,-0.12143310904502869,0.27694249153137207,-0.2213757336139679,-0.17726518213748932,-0.12160638719797134,0.039362967014312744,-0.2264844924211502,-0.10532905161380768,-0.234485924243927,-0.0214675422757864},{0.18170925974845886,0.3965349793434143,0.39166221022605896,-0.3646880090236664,-0.384461373090744,0.1268945038318634,0.009136343374848366,-0.15019935369491577,0.39349764585494995,0.38847094774246216,-0.1572498232126236,0.11824757605791092,-0.07792238891124725,-0.3017326295375824,0.08268595486879349,-0.14569926261901855},{-0.21060384809970856,-0.16769970953464508,-0.10550463199615479,0.42564186453819275,-0.23167213797569275,-0.18898862600326538,-0.2327103614807129,-0.2915865480899811,-0.5150882005691528,-0.24030105769634247,0.341509610414505,0.27983996272087097,-0.5732052326202393,-0.34646743535995483,-0.6089834570884705,-0.15835066139698029},{-0.4577654004096985,0.1578257530927658,-0.34876400232315063,-0.16698285937309265,-0.44422367215156555,0.17444033920764923,0.5020291209220886,0.09954223036766052,0.39834335446357727,-0.47847604751586914,0.23063011467456818,-0.3633424937725067,-0.2042919248342514,0.042614519596099854,-0.1959608793258667,-0.20261740684509277},{0.36579933762550354,-0.5931864380836487,0.2762320339679718,0.2252921164035797,-0.07508254051208496,0.485287606716156,0.24309863150119781,0.2957206666469574,-0.06893184036016464,-0.2496536672115326,-0.1256411224603653,-0.13437682390213013,-0.11496086418628693,-0.5401536822319031,0.26041775941848755,-0.08698280900716782}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.029268354177474976,0.30534252524375916,0.2268907129764557,-0.146690234541893,-0.17363311350345612,0.03686084598302841,-0.018483245745301247,0.24510295689105988,-0.08850269764661789,0.31807389855384827,0.4761201739311218,-0.384488970041275,0.04366184026002884,0.048350393772125244,0.002464890480041504,-0.0961683839559555},{-0.38392114639282227,0.18701009452342987,-0.16294953227043152,0.3333768844604492,0.2641855776309967,-0.1090676411986351,-0.31698623299598694,-0.15512529015541077,0.3637216091156006,0.26533859968185425,-0.07064259797334671,0.22405436635017395,-0.390450119972229,0.17309752106666565,-0.2044653743505478,0.43369734287261963},{-0.2702438235282898,0.11849001049995422,-0.2695961892604828,0.16251493990421295,-0.45117586851119995,-0.20188310742378235,0.018295513466000557,0.12400322407484055,-0.1701904982328415,0.3683319687843323,0.21673427522182465,-0.11191654950380325,0.13270078599452972,-0.2538720965385437,-0.1038266122341156,-0.0422520712018013},{0.2632178068161011,-0.21742162108421326,0.09680888801813126,0.391711950302124,-0.42167186737060547,-0.30833303928375244,0.2693347930908203,0.035539522767066956,0.2944701313972473,-0.09006279706954956,0.3247664272785187,0.09009871631860733,-0.19745950400829315,0.022843942046165466,-0.007450639270246029,-0.40299680829048157},{-0.4033298194408417,-0.07712758332490921,0.13478752970695496,-0.273381769657135,0.14795376360416412,0.35661405324935913,-0.3080688416957855,0.2809876799583435,-0.20835140347480774,0.19448576867580414,0.0003622228978201747,0.05316178500652313,-0.2795524001121521,-0.015383977442979813,-0.269746869802475,-0.1019221693277359},{0.0676398053765297,-0.30112168192863464,-0.010194897651672363,-0.3451036512851715,0.2141522318124771,0.03441385552287102,-0.13937650620937347,-0.06179380416870117,-0.1407594382762909,0.367123544216156,0.18124687671661377,0.014844967052340508,-0.29684382677078247,0.09131786227226257,0.010320870205760002,-0.3034924566745758},{0.2629941999912262,-0.22242267429828644,0.32610681653022766,-0.19434350728988647,-0.42062681913375854,0.023046329617500305,-0.351785808801651,0.33528268337249756,-0.09988966584205627,-0.2507188618183136,-0.25399649143218994,-0.013311087153851986,-0.0701480284333229,-0.08113878220319748,0.49878260493278503,-0.38815224170684814},{-0.329876571893692,0.35054582357406616,-0.08976316452026367,0.18433955311775208,-0.10973379015922546,-0.23329149186611176,-0.22187110781669617,0.10351072251796722,-0.05416145175695419,0.459902286529541,0.11290246248245239,-0.13238774240016937,0.06986767053604126,-0.2178170531988144,0.08388309180736542,0.15846458077430725},{0.13010446727275848,0.27307283878326416,-0.19000092148780823,-0.30580058693885803,0.3105432391166687,-0.21036115288734436,0.1904098391532898,-0.2646450400352478,0.020866909995675087,0.026968177407979965,0.10594652593135834,0.08216296136379242,0.025774165987968445,-0.37825947999954224,-0.0717136412858963,0.202082097530365},{-0.19140316545963287,0.020550670102238655,-0.27058783173561096,-0.31480586528778076,0.21454204618930817,-0.37921085953712463,-0.10435771197080612,0.3018478751182556,-0.1703183948993683,0.13922761380672455,-0.051993485540151596,-0.11122258007526398,-0.3773805499076843,0.11621315032243729,-0.23168328404426575,-0.3466334640979767},{-0.1270233541727066,-0.1612263172864914,0.012618821114301682,-0.245600625872612,-0.32016435265541077,0.005464246030896902,0.13337716460227966,-0.3259086012840271,0.03987408056855202,-0.08448013663291931,0.27537745237350464,-0.06624775379896164,0.241854727268219,0.16219840943813324,0.22160008549690247,0.25010570883750916},{-0.11874544620513916,-0.02657167799770832,-0.33937928080558777,0.32610663771629333,0.09094826877117157,0.14833223819732666,0.20672567188739777,0.15630948543548584,-0.4211256504058838,0.19249877333641052,-0.3291113078594208,-0.2363177239894867,-0.3320868909358978,0.3488579988479614,-0.33054858446121216,0.08627529442310333},{-0.18321332335472107,-0.44900280237197876,-0.07852856814861298,0.14497315883636475,-0.2270565778017044,-0.06392361968755722,-0.10974270105361938,0.3907921016216278,0.4507817327976227,0.13320188224315643,0.0007584267295897007,-0.1792616993188858,0.1414550542831421,-0.3951699435710907,0.08626924455165863,-0.16625863313674927},{-0.2579019069671631,-0.45584535598754883,-0.12474898248910904,-0.13728345930576324,-0.5009742975234985,0.4811529815196991,-0.14826279878616333,0.19673201441764832,-0.13902978599071503,-0.24109968543052673,-0.30039268732070923,0.39494219422340393,-0.13591386377811432,-0.048615068197250366,-0.20779918134212494,0.326838880777359},{-0.3128913342952728,0.3537938892841339,-0.23729442059993744,0.13453727960586548,-0.35062235593795776,0.14347606897354126,4.209417966194451e-06,-0.3364526629447937,0.1223193109035492,0.21202494204044342,-0.23961590230464935,0.06347905099391937,0.24872103333473206,-0.3122147023677826,-0.3408487141132355,-0.18620775640010834},{-0.1254207342863083,-0.2674292325973511,-0.4173968732357025,0.23634503781795502,0.1378643959760666,0.030876392498612404,-0.23522989451885223,0.17840881645679474,-0.3471924960613251,-0.24162183701992035,-0.28062930703163147,0.19464370608329773,-0.19753070175647736,0.13533899188041687,0.044186804443597794,0.2903732657432556}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10429022461175919,-0.04342154040932655,0.20034244656562805,-0.138496994972229,-0.07799268513917923,0.10431791096925735,0.22213110327720642,-0.19262415170669556,-0.22800932824611664,0.2666017413139343,0.14418186247348785,0.11121399700641632,0.0688093975186348,0.174326553940773,-0.14776773750782013,0.1702316403388977,0.13114726543426514,-0.33849775791168213,-0.14951154589653015,-0.07802344113588333,-0.12674076855182648,0.06304937601089478,-0.18394051492214203,0.26581940054893494,-0.10200296342372894,-0.06665565073490143,0.10984120517969131,0.2063320428133011,-0.21127533912658691,-0.12342701107263565,0.17181730270385742,0.26437413692474365},{0.22385314106941223,-0.06618402153253555,0.13061310350894928,-0.12327253818511963,-0.12603363394737244,0.23915539681911469,-0.0077437846921384335,-0.06859061866998672,-0.04013770818710327,0.017360206693410873,-0.14381082355976105,0.012230806052684784,0.39416080713272095,0.17410527169704437,0.12121094763278961,0.06703885644674301,-0.2261841744184494,-0.35650530457496643,0.0698312371969223,0.047127868980169296,0.0644034743309021,0.29577669501304626,0.2093045711517334,-0.24419346451759338,0.040628831833601,0.2611793577671051,-0.2794249653816223,0.18504329025745392,0.0983889102935791,-0.23111850023269653,-0.05059445649385452,-0.01298200897872448},{-0.09604523330926895,-0.058671459555625916,0.2907409071922302,-0.23655292391777039,-0.16238881647586823,0.05480576306581497,-0.12502969801425934,0.2560722827911377,0.10722766816616058,-0.004088686313480139,-0.16941414773464203,-0.026671098545193672,0.22799156606197357,-0.22228668630123138,0.0983368381857872,-0.0316874124109745,-0.30178236961364746,0.27267447113990784,-0.23200152814388275,-0.04619941487908363,0.011341954581439495,-0.14671479165554047,-0.04258805513381958,-0.09481309354305267,-0.025232048705220222,0.2741148769855499,-0.06557535380125046,0.09998047351837158,0.2540270686149597,-0.2330908626317978,-0.21245235204696655,-0.044251881539821625},{0.14398226141929626,-0.11460620909929276,0.07075358927249908,-0.33319956064224243,0.12233980000019073,-0.15072844922542572,-0.07507647573947906,0.2797202169895172,0.01707600988447666,0.13253849744796753,0.1513095200061798,-0.08925410360097885,-0.1987365186214447,-0.09401044994592667,0.30164211988449097,-0.22867844998836517,0.025536824017763138,-0.1364530771970749,-0.12533876299858093,0.09263761341571808,-0.10555906593799591,0.0408221036195755,-0.20471911132335663,0.22519004344940186,-0.2631542682647705,0.10108987987041473,-0.0917440801858902,-0.17920057475566864,0.08891123533248901,0.004224134609103203,0.25364577770233154,-0.11450692266225815},{0.2106727957725525,0.00044334749691188335,0.03384581208229065,0.23770344257354736,-0.2437724769115448,-0.07728341966867447,0.21327194571495056,-0.04934724047780037,0.11255007237195969,-0.1854245513677597,0.003907335456460714,-0.09228517860174179,-0.15508641302585602,-0.1627572476863861,0.26701197028160095,0.30273357033729553,-0.06498187780380249,-0.3355698585510254,0.16175320744514465,-0.11289916187524796,-0.11526050418615341,0.20755626261234283,0.26355668902397156,0.05401228740811348,-0.05753295496106148,-0.09874231368303299,-0.011259492486715317,0.2593892216682434,0.25009000301361084,0.13558310270309448,0.07726132869720459,-0.25011807680130005},{0.3262358605861664,-0.14399725198745728,0.007059219293296337,0.10332430154085159,-0.13530905544757843,-0.3288928270339966,-0.21307550370693207,-0.30786383152008057,-0.19936777651309967,0.022778116166591644,-0.049161147326231,-0.011277979239821434,-0.1622706800699234,-0.05535457655787468,-0.21060095727443695,-0.21915848553180695,0.16843554377555847,-0.01496929582208395,-0.3049635589122772,0.14468073844909668,-0.05689799040555954,-0.22147539258003235,0.18319912254810333,-0.16488146781921387,-0.13725951313972473,-0.22692056000232697,-0.09704982489347458,0.15560215711593628,0.1100676953792572,0.25934773683547974,-0.22510021924972534,0.19622506201267242},{0.1588553935289383,0.08413859456777573,0.26401928067207336,-0.1875431388616562,0.2242429554462433,-0.2156081348657608,-0.242056742310524,0.057145856320858,0.2760065495967865,0.11314521729946136,-0.10241588205099106,0.09741511195898056,0.05771533399820328,0.3684266209602356,0.11485599726438522,-0.11494407802820206,-0.18624736368656158,0.1483485996723175,0.007171521428972483,0.02353009395301342,-0.05450080707669258,0.2090856283903122,0.1579129844903946,0.15832491219043732,-0.2011406272649765,-0.2475903332233429,-0.25413236021995544,-0.37437379360198975,0.04653381183743477,-0.10691532492637634,0.23157843947410583,0.16059724986553192},{0.27794310450553894,-0.3034795820713043,0.11391915380954742,-0.36564260721206665,-0.3499878942966461,0.24970310926437378,0.3674059510231018,0.13521327078342438,-0.0955081507563591,-0.002506032818928361,0.2282721847295761,-0.12802007794380188,0.14528247714042664,0.33425840735435486,-0.027013368904590607,0.18089807033538818,0.3690505623817444,-0.18426638841629028,-0.044036008417606354,-0.2999217212200165,0.1525702178478241,0.20405171811580658,0.23591506481170654,0.11705197393894196,0.11571275442838669,0.11842965334653854,0.1234365776181221,0.25863346457481384,-0.2052617371082306,-0.24382653832435608,0.2441253811120987,-0.058088112622499466},{0.025672683492302895,-0.08135988563299179,0.2713111340999603,0.21849969029426575,-0.1696327179670334,-0.2901032269001007,-0.06022286042571068,0.2766905128955841,-0.19541706144809723,-0.2555633783340454,0.07757193595170975,0.09780143201351166,0.12728214263916016,-0.27538445591926575,0.1241309717297554,-0.1771554946899414,-0.15936855971813202,0.1825045347213745,-0.23022469878196716,0.3385685384273529,-0.3022269308567047,-0.3110303580760956,-0.2801123559474945,0.2947849929332733,0.11304918676614761,0.10223904252052307,0.24377009272575378,0.17259812355041504,-0.16831839084625244,-0.267387717962265,-0.16165615618228912,0.15964843332767487},{0.28594961762428284,-0.02237665466964245,-0.049896787852048874,0.16669295728206635,-0.004368544090539217,0.22506462037563324,-0.03593643382191658,0.2472284436225891,-0.005331853870302439,0.07155147939920425,0.17434976994991302,0.0628962367773056,-0.1385572999715805,-0.35804301500320435,0.10359565168619156,0.13261976838111877,0.09326085448265076,-0.1285930573940277,-0.0821543037891388,-0.029926227405667305,0.11753365397453308,-0.285732239484787,0.23959437012672424,0.06826967000961304,-0.0111268674954772,0.12703336775302887,-0.2846132814884186,-0.2403610497713089,-0.04493698477745056,-0.013181597925722599,0.13176798820495605,0.1831444799900055},{-0.1276036947965622,0.09751114249229431,-0.09487669914960861,0.15619617700576782,-0.11933305859565735,0.27680569887161255,0.12711986899375916,-0.010387040674686432,0.27342119812965393,-0.3129775822162628,-0.13962511718273163,0.15330716967582703,-0.17293930053710938,0.04900533705949783,-0.30386605858802795,-0.03464141860604286,0.10958397388458252,0.16891036927700043,0.08016697317361832,-0.1312176138162613,-0.21525593101978302,0.19850611686706543,0.19147883355617523,0.18266849219799042,-0.2584318518638611,0.35628965497016907,-0.10347377508878708,-0.025880446657538414,-0.11007242649793625,0.13794003427028656,0.21317420899868011,0.2731192708015442},{-0.1863410323858261,0.30838754773139954,-0.06780283898115158,0.011906002648174763,-0.18202586472034454,-0.16551890969276428,0.12961365282535553,-0.31840628385543823,-0.0367429219186306,-0.24843862652778625,-0.21497830748558044,-0.03614701330661774,0.18460440635681152,-0.2651253342628479,-0.12233493477106094,-0.2762133777141571,-0.19787999987602234,-0.0653693825006485,0.3008991777896881,-0.3036227226257324,0.08141256868839264,-0.1869063377380371,0.06443873792886734,0.29940545558929443,-0.16838893294334412,0.18229924142360687,0.22809717059135437,-0.07842391729354858,-0.02082907035946846,0.3009619414806366,-0.13388541340827942,-0.2543209195137024},{-0.04518940672278404,0.176713764667511,0.22356387972831726,-0.2754497230052948,0.2608596384525299,0.012192802503705025,-0.12785997986793518,-0.030133487656712532,0.15297958254814148,-0.29291415214538574,-0.07311774790287018,0.024295520037412643,0.1611015796661377,0.05480511486530304,0.036555539816617966,-0.09523256868124008,0.2389710247516632,-0.2419946789741516,0.32403364777565,0.08988696336746216,-0.16636711359024048,0.2386755496263504,-0.12644188106060028,-0.1991272270679474,0.27516797184944153,-0.11790276318788528,0.024676255881786346,-0.16660642623901367,0.042627062648534775,-0.14285150170326233,0.2667338252067566,0.224952831864357},{0.06014416739344597,-0.1544525921344757,-0.17733381688594818,0.05804984271526337,0.013774268329143524,0.2852170169353485,-0.10539131611585617,-0.26944223046302795,0.28431975841522217,0.017304595559835434,0.05224912241101265,0.08479037880897522,-0.16003328561782837,0.10285698622465134,-0.20450595021247864,-0.28611573576927185,0.010825050994753838,-0.04353371262550354,0.2004973292350769,0.3904484510421753,-0.20818336308002472,0.08861225843429565,-0.13126446306705475,0.0071380166336894035,0.12515634298324585,-0.3008548319339752,-0.1645742952823639,-0.2214585244655609,-0.06379953026771545,-0.18539372086524963,0.1685357540845871,-0.3212701678276062},{-0.09246067702770233,0.30065104365348816,0.1505834311246872,-0.2117997109889984,-0.10188420116901398,-0.18557500839233398,0.1752617359161377,-0.043934717774391174,0.21886584162712097,-0.029973438009619713,0.1943543553352356,0.1585308462381363,-0.04113189876079559,0.05356161668896675,-0.13182927668094635,0.15913544595241547,-0.17208388447761536,-0.35621389746665955,-0.24324294924736023,0.11605365574359894,0.14200492203235626,-0.20868681371212006,-0.3195136487483978,-0.23103569447994232,-0.15360993146896362,0.06989005208015442,0.33796700835227966,-0.014764546416699886,-0.08112407475709915,0.1155015379190445,-0.14197957515716553,0.09762993454933167},{-0.20629800856113434,-0.17731517553329468,-0.20034481585025787,0.006485332269221544,-0.21634024381637573,-0.10761264711618423,-0.0380801297724247,-0.019871238619089127,-0.30045342445373535,-0.23028403520584106,0.18819226324558258,0.14267714321613312,-0.3044888973236084,0.2334885597229004,-0.060591403394937515,0.16280101239681244,0.09530168771743774,0.025554193183779716,0.04060260206460953,0.13796187937259674,0.23065198957920074,0.2597726285457611,0.13515940308570862,0.2598385810852051,0.09971561282873154,-0.21780048310756683,-0.18966004252433777,0.25042086839675903,-0.006790697108954191,-0.17820395529270172,-0.160333514213562,-0.11354756355285645},{-0.2927725911140442,-0.22387300431728363,-0.3342141807079315,0.05032702907919884,-0.10134964436292648,-0.05413355678319931,-0.07372989505529404,0.14756692945957184,-0.09222438931465149,0.08571872115135193,-0.18810932338237762,-0.00787038542330265,0.14070147275924683,-0.11389390379190445,0.03334351256489754,0.18472295999526978,-0.08775167167186737,-0.1061985045671463,0.1751471608877182,0.026826057583093643,0.2187359631061554,-0.04647984355688095,-0.22049817442893982,0.06839440762996674,0.18340937793254852,-0.26071447134017944,0.17592966556549072,0.04705970734357834,0.07903085649013519,-0.13187915086746216,0.20325736701488495,-0.061859168112277985},{0.2642182409763336,0.013384087942540646,0.03851925581693649,0.20048686861991882,-0.3382086455821991,-0.040990233421325684,0.05732118710875511,0.15666167438030243,-0.0702090933918953,-0.13159556686878204,0.288032591342926,-0.08735008537769318,0.08304014801979065,-0.05180004611611366,-0.10221900045871735,0.29147619009017944,-0.0827023908495903,-0.13884936273097992,0.10722508281469345,-0.29575029015541077,-0.060221802443265915,-0.2509724199771881,-0.1801869422197342,0.22881120443344116,-0.0773889422416687,-0.04132290184497833,0.1263047456741333,0.0626268982887268,-0.15095773339271545,-0.07200173288583755,-0.02469768188893795,-0.0803890973329544},{0.29503333568573,-0.07221006602048874,0.06254184991121292,0.05487191304564476,-0.020251763984560966,-0.07119914144277573,0.20408311486244202,-0.22159019112586975,0.2486509084701538,0.2939448058605194,0.039436958730220795,0.13152502477169037,0.2086883932352066,0.3093290627002716,-0.29615551233291626,-0.36092323064804077,-0.2287731170654297,0.08188454061746597,-0.17043812572956085,-0.3488518297672272,-0.14832842350006104,0.23259523510932922,0.058561038225889206,0.14992238581180573,-0.15312513709068298,-0.12491293251514435,-0.12087027728557587,-0.23695816099643707,0.25015026330947876,0.1921955645084381,-0.3321038484573364,-0.12434685230255127},{-0.09821822494268417,0.16915160417556763,0.28407788276672363,-0.017263837158679962,-0.01445041224360466,0.08936093747615814,-0.024343734607100487,-0.32922255992889404,0.16911259293556213,0.2531246244907379,0.1670948714017868,0.22729142010211945,-0.2442435473203659,0.1639331579208374,-0.23900486528873444,0.314052551984787,0.14871062338352203,-0.2670831084251404,0.2610335052013397,0.05179472267627716,-0.3440506160259247,0.29582157731056213,-0.2263849824666977,0.14824877679347992,0.1803806573152542,0.25975877046585083,0.04488678276538849,0.1441836655139923,-0.15821844339370728,0.2432350516319275,-0.042063407599925995,0.10361132770776749},{-0.12862125039100647,-0.10303710401058197,0.029299546033143997,0.18969778716564178,0.02912141941487789,0.23428316414356232,-0.2526264488697052,-0.10861786454916,-0.17899389564990997,-0.0826135203242302,-0.11662473529577255,-0.19545449316501617,-0.0038737331051379442,-0.21505792438983917,0.10560466349124908,-0.2008875459432602,0.23992112278938293,-0.01933250203728676,-0.2797861099243164,-0.3058813512325287,0.13803277909755707,0.13583101332187653,-0.1458200216293335,0.3293233811855316,-0.26662880182266235,0.032132912427186966,0.09296189993619919,-0.10102280229330063,0.163267120718956,-0.19703851640224457,0.28360646963119507,0.11980021744966507},{0.30683085322380066,0.06215823441743851,0.05043945088982582,0.22682929039001465,-0.2368810474872589,0.16173456609249115,-0.09529370069503784,0.14378611743450165,0.10952699929475784,0.0133293392136693,0.10349338501691818,-0.30280691385269165,-0.26248595118522644,0.05238476023077965,0.07107244431972504,-0.08209768682718277,0.27175185084342957,0.13852636516094208,-0.18964195251464844,-0.21904528141021729,0.345030814409256,0.19070462882518768,0.2340531349182129,0.07584422826766968,0.0010109646245837212,0.06615916639566422,-0.05150976404547691,-0.1618993729352951,0.24989424645900726,0.007766057271510363,-0.17744098603725433,0.11319544911384583},{-0.016976248472929,0.02503054402768612,-0.028845207765698433,-0.25401562452316284,-0.0945894792675972,-0.23379655182361603,-0.21175439655780792,-0.13904912769794464,-0.03475130721926689,-0.02184976451098919,-0.23741403222084045,0.026226656511425972,-0.23308493196964264,-0.16097214818000793,0.012443202547729015,0.09761213511228561,0.2650567889213562,-0.17696982622146606,-0.32450342178344727,0.2457301765680313,-0.17322151362895966,0.24961264431476593,0.03877166286110878,-0.038492489606142044,-0.007474017795175314,0.16768275201320648,-0.07505562901496887,-0.2599025070667267,0.22634920477867126,0.2544195055961609,-0.13543403148651123,0.17822447419166565},{-0.23996907472610474,-0.023634953424334526,0.040926769375801086,-0.03351333364844322,0.09040489047765732,0.12480302155017853,-0.1968216598033905,0.09787367284297943,-0.1568792760372162,-0.1423414796590805,0.06801167130470276,-0.13632932305335999,-0.1814623475074768,0.2693566381931305,0.012830542400479317,0.04124765843153,0.18902038037776947,-0.25727224349975586,-0.16630201041698456,0.32083556056022644,0.021694641560316086,0.27464282512664795,-0.06672598421573639,0.018410414457321167,-0.2176840901374817,-0.18262597918510437,-0.002370496280491352,0.29569607973098755,-0.017499806359410286,0.00663535762578249,0.30028119683265686,0.30018433928489685}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.1388324648141861,0.13144811987876892,0.2672494351863861,-0.0031243693083524704},{0.07662332057952881,-0.0449971966445446,0.04575609415769577,0.13912737369537354},{-0.1358911544084549,0.18145695328712463,0.09645792841911316,0.13788153231143951},{0.3149009048938751,0.03811287879943848,0.05901053920388222,0.37980470061302185},{-0.09442233294248581,0.05971367284655571,0.2426535040140152,-0.014095389284193516},{-0.12945018708705902,0.19761940836906433,0.1797347217798233,-0.05231863632798195},{-0.21491488814353943,0.005945401731878519,-0.0021358439698815346,-0.1139330267906189},{-0.33658367395401,-0.11150103807449341,0.30547234416007996,-0.27498289942741394},{0.2880699038505554,-0.17825455963611603,-0.2549501061439514,-0.33618053793907166},{0.043276622891426086,0.24358698725700378,0.3093007206916809,-0.37487515807151794},{-0.11782156676054001,-0.1352524757385254,-0.17806419730186462,0.18524086475372314},{0.24646411836147308,-0.15635105967521667,0.02923206426203251,0.1582057625055313},{0.2724246382713318,0.27633118629455566,-0.07148004323244095,0.07866392284631729},{-0.0029959699604660273,0.05426447466015816,-0.26508599519729614,0.021321672946214676},{0.1157476082444191,0.2725212574005127,0.27982592582702637,0.29147788882255554},{0.14258843660354614,0.06354578584432602,0.23473207652568817,0.2233869433403015},{-0.18439432978630066,-0.09398096799850464,-0.13888244330883026,-0.15294596552848816},{-0.1622730791568756,0.09809703379869461,-0.12083714455366135,-0.12048376351594925},{-0.151852548122406,0.15689033269882202,0.15163683891296387,0.24793194234371185},{-0.026144269853830338,0.3224731385707855,-0.16047552227973938,0.061471886932849884},{-0.21814705431461334,-0.32495197653770447,-0.1353801190853119,-0.014065262861549854},{0.2536821961402893,0.3573713004589081,0.03700718656182289,-0.2077241837978363},{0.0014656041748821735,0.143983855843544,0.14628998935222626,0.129745215177536},{-0.08637680858373642,0.3489062786102295,-0.04746653512120247,-0.1106468066573143},{0.018726205453276634,-0.016088660806417465,-0.03993143513798714,-0.019821345806121826},{0.2520862817764282,-0.3400548994541168,-0.04322158545255661,0.05062316358089447},{-0.0030506220646202564,-0.28427743911743164,-0.1702108085155487,-0.23248647153377533},{0.09108509868383408,-0.0697173923254013,0.20134080946445465,0.094797782599926},{-0.006291174795478582,-0.047490477561950684,0.058310240507125854,0.014498350210487843},{-0.3034774363040924,0.3275706171989441,0.22204865515232086,-0.08846083283424377},{0.28697845339775085,-0.14473190903663635,0.1527346670627594,-0.0102029237896204},{0.050179772078990936,-0.2964191436767578,0.3176461458206177,-0.2353818118572235}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.02820189669728279,-0.0016954137245193124,0.026398437097668648,-0.047243233770132065,-0.024782150983810425,-0.15303340554237366,0.027585161849856377,0.04814837500452995,0.011891411617398262,-0.10467696189880371,0.14446614682674408,0.0802542120218277,-0.00857131090015173,-0.020144237205386162,0.07428400963544846,-0.0037674219347536564};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06929963827133179,0.03817474842071533,0.038332223892211914,0.03628711774945259,0.047349054366350174,0.01632530800998211,0.04663574695587158,0.003028009319677949,0.0051190718077123165,0.003993844147771597,-0.04795975610613823,-0.017711516469717026,0.027728084474802017,-0.026488926261663437,-0.04336695373058319,0.0074273766949772835};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06900165975093842,0.05624350905418396,0.01680055819451809,0.06692764163017273,0.03952782601118088,-0.022540226578712463,-0.04347749799489975,-0.011851047165691853,-0.023823263123631477,-0.007198486942797899,-0.04789965972304344,0.05424429103732109,0.060135021805763245,-0.057301126420497894,0.06996005773544312,0.06675685197114944,-0.06057596579194069,-0.05599476024508476,-0.004175176844000816,0.01819465495646,-0.04187094047665596,0.009735098108649254,0.057949233800172806,0.022312326356768608,-0.01187715120613575,0.0017490589525550604,-0.035247333347797394,0.05341074615716934,0.024159356951713562,-0.003702522022649646,0.018269523978233337,0.021917371079325676};
static const float action_parameterization_distribution_linear_bias[4] = {0.051394034177064896,0.009559987112879753,0.047075919806957245,0.040679119527339935};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.045425061136484146,0.26324859261512756,-0.11433948576450348,0.15647150576114655,0.23475198447704315,0.19495493173599243,0.2624853253364563,0.012395952828228474},{-0.169342502951622,-0.09386356174945831,-0.22863487899303436,-0.2733992338180542,-0.3002311587333679,-0.14179427921772003,-0.1968098133802414,-0.1308022141456604},{-0.2674335241317749,0.02459223009645939,0.24787470698356628,0.2133973091840744,0.2153531312942505,0.005015142727643251,0.18145015835762024,-0.06749948859214783},{-0.03676842898130417,0.07666785269975662,-0.17451640963554382,0.0031588240526616573,-0.02570253610610962,-0.07530525326728821,0.160395547747612,-0.10986634343862534},{-0.28357550501823425,-0.12388742715120316,-0.2422240972518921,-0.14793163537979126,-0.0659070685505867,0.1999283879995346,0.12828916311264038,-0.004433491267263889},{-0.361053466796875,0.012231805361807346,0.3328232169151306,0.24626944959163666,0.1639152467250824,-0.029217146337032318,-0.11794423311948776,-0.10522794723510742},{-0.22739087045192719,0.057866547256708145,0.3084489405155182,-0.18505878746509552,-0.12262993305921555,-0.31774404644966125,-0.08502142131328583,-0.12647591531276703},{-0.4862380623817444,-0.36512473225593567,0.5083585977554321,-0.029014352709054947,-0.2702327072620392,0.18583782017230988,0.18957512080669403,-0.1807996928691864},{-0.2795734405517578,0.26126420497894287,-0.11745315790176392,0.4262315630912781,0.07562606036663055,-0.4093776047229767,0.08848243951797485,0.13894958794116974},{-0.2618226706981659,-0.3217783272266388,-0.14199548959732056,-0.12314457446336746,-0.4672333002090454,0.023692287504673004,0.0036136882845312357,0.16083937883377075},{0.18620754778385162,0.3361145853996277,0.21940267086029053,0.024308698251843452,0.26316606998443604,0.018963389098644257,-0.2285999208688736,0.2579810321331024},{0.23664341866970062,0.0016904915682971478,0.2661348879337311,0.28842586278915405,-0.15821170806884766,0.24762767553329468,-0.005977231077849865,-0.2133183777332306},{0.12000124901533127,-0.253048837184906,0.22860312461853027,0.012544684112071991,-0.131360724568367,-0.05332726612687111,-0.13982659578323364,-0.19307579100131989},{-0.20928245782852173,-0.059049997478723526,0.3127935528755188,0.392878919839859,0.008528468199074268,-0.0287543423473835,-0.2265741527080536,0.05837055668234825},{-0.05593600496649742,-0.1409660130739212,0.10014459490776062,-0.1934112310409546,-0.28824949264526367,-0.15494777262210846,0.17976519465446472,-0.06112944707274437},{-0.02246302179992199,-0.005277263931930065,-0.025122536346316338,-0.3268503248691559,-0.07255199551582336,0.06266152113676071,-0.04989991337060928,0.3492763638496399},{-0.010861865244805813,-0.1811176985502243,-0.18483349680900574,0.03446752578020096,-0.19161710143089294,-0.10447084903717041,-0.09209436923265457,0.03224221244454384},{-0.15113399922847748,-0.21429793536663055,0.07087671756744385,-0.028887730091810226,0.11613191664218903,-0.16461288928985596,0.3840559422969818,0.11381826549768448},{0.0505501888692379,0.1462610810995102,-0.29380568861961365,0.09635257720947266,0.08031988143920898,0.12469862401485443,-0.2037167102098465,0.2836608588695526},{0.16334877908229828,-0.08686397969722748,-0.39654216170310974,0.058821991086006165,-0.12821367383003235,-0.11594258248806,-0.2779479920864105,-0.013662565499544144},{0.01270222943276167,-0.20530802011489868,-0.005205978639423847,-0.13045139610767365,0.1819412261247635,-0.09877141565084457,-0.06538654118776321,0.42333945631980896},{-0.03880085051059723,0.05944259837269783,-0.3378448486328125,0.23155128955841064,0.21091517806053162,0.2217533439397812,0.06752137094736099,-0.2865881323814392},{-0.40854114294052124,-0.14067663252353668,0.059232197701931,-0.06979209184646606,0.14840467274188995,-0.39048781991004944,0.1300574243068695,-0.27022504806518555},{-0.07056476920843124,0.08169224858283997,-0.11691410094499588,-0.461247980594635,0.24929894506931305,0.021012885496020317,-0.36247023940086365,0.11484595388174057},{-0.11024782806634903,-0.18172134459018707,-0.1518644392490387,0.07535922527313232,0.13350026309490204,0.30809396505355835,0.2752780616283417,-0.0716574639081955},{-0.12580306828022003,0.062014609575271606,-0.36342987418174744,-0.25837549567222595,0.1393601894378662,0.024143831804394722,-0.05450938642024994,0.06032118201255798},{0.3042336702346802,0.36172735691070557,-0.23961348831653595,0.2516527771949768,0.09099346399307251,0.30446839332580566,-0.2894638776779175,-0.17067109048366547},{0.4158342778682709,0.24981486797332764,0.10242480784654617,0.09198426455259323,0.22661469876766205,0.062118664383888245,0.22526073455810547,0.3610369861125946},{-0.09214229881763458,0.32337018847465515,0.13486352562904358,0.0411791168153286,0.2637788653373718,0.0005542947328649461,-0.41409698128700256,-0.27880942821502686},{-0.1713525503873825,-0.27002793550491333,-0.03325532004237175,-0.17933598160743713,-0.24455992877483368,-0.15185126662254333,0.21058377623558044,0.002791318343952298},{0.4133922755718231,-0.28856948018074036,0.2240259051322937,-0.25010788440704346,0.1451028436422348,0.2930319905281067,0.08385947346687317,-0.17073161900043488},{0.2018139809370041,0.4137679636478424,0.4107609689235687,-0.21154500544071198,-0.18008771538734436,0.15272338688373566,0.20183776319026947,0.02949235588312149}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.04649479314684868,0.36428919434547424,-0.1578376442193985,0.24970759451389313,-0.35552167892456055,0.21411190927028656,0.4432757496833801,0.04055209085345268},{-0.4043132960796356,-0.44737952947616577,-0.3182118535041809,-0.3660733699798584,-0.40715673565864563,0.3731580376625061,0.47062307596206665,-0.4066077172756195},{0.02975834533572197,-0.1412632167339325,0.10316862910985947,0.02295653708279133,-0.06329195946455002,0.39962804317474365,-0.2964414358139038,-0.2827799320220947},{0.3641655445098877,0.0049887667410075665,0.07188883423805237,-0.011963619850575924,0.5126292705535889,0.3829182982444763,0.3893353343009949,0.3843943774700165},{0.08499149978160858,0.2059868574142456,-0.12404146045446396,-0.03782615065574646,0.09905744343996048,-0.32526955008506775,-0.35224655270576477,0.4310143291950226},{0.4011024534702301,0.0942125990986824,0.04050875082612038,-0.32383254170417786,-0.33650124073028564,-0.4498789608478546,-0.11545424163341522,0.4725887179374695},{-0.3200005888938904,-0.27686601877212524,-0.006598701234906912,-0.1903100162744522,0.06678779423236847,0.3290612995624542,-0.46017730236053467,0.5922974348068237},{0.12974099814891815,0.02962644025683403,0.019278671592473984,-0.08805737644433975,0.30919724702835083,-0.4708178639411926,0.376993864774704,-0.48465877771377563}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.036674629896879196,0.020001813769340515,0.11766431480646133,-0.05396830290555954,-0.0463825948536396,-0.04391561448574066,0.11363807320594788,-0.037256088107824326};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.049628086388111115,-0.02822207659482956,0.05225221812725067,-0.10684898495674133,0.012270049192011356,-0.0046737114898860455,-0.011782610788941383,-0.05456506460905075};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

