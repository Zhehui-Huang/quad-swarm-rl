#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3476402163505554,-0.10936158150434494,0.3020293712615967,0.1306220293045044,-0.2758067846298218,0.2927229106426239,0.0019566607661545277,-0.12133245915174484,0.11072132736444473,0.32191869616508484,0.10620315372943878,0.021291574463248253,0.21569204330444336,-0.22936582565307617,0.2784995436668396,-0.03827666491270065},{-0.18601270020008087,-0.41987714171409607,0.31812503933906555,0.0798560082912445,-0.2079838663339615,0.17192517220973969,-0.4110895097255707,-0.04607830569148064,-0.1022806465625763,-0.17704950273036957,0.030204206705093384,-0.18702466785907745,-0.006872186902910471,-0.3277423679828644,-0.2901560664176941,0.12364575266838074},{-0.11735733598470688,-0.25265541672706604,-0.48078814148902893,0.18974724411964417,0.2610901892185211,0.5957388877868652,0.03700469806790352,-0.04907046630978584,0.1334291249513626,-0.5524047017097473,-0.400941401720047,0.8195722103118896,-0.2603469789028168,-0.30975645780563354,-0.3914169669151306,0.2896895110607147},{0.17524822056293488,0.26535481214523315,0.36802220344543457,-0.018218055367469788,-0.3813765347003937,-0.022747958078980446,0.26456624269485474,0.08900932967662811,0.32092541456222534,-0.3103231191635132,0.0068244896829128265,0.4217541813850403,-0.242607980966568,-0.021265758201479912,0.4743090271949768,-0.45715174078941345},{-0.07701896131038666,0.03956201300024986,0.3056105375289917,-0.064000703394413,0.3140847682952881,0.44589462876319885,0.16937284171581268,-0.036825992166996,0.11632583290338516,0.2082640528678894,0.26459556818008423,-0.33181869983673096,-0.18458715081214905,-0.42212316393852234,0.3646750748157501,0.09565074741840363},{-0.2657298147678375,-0.18877437710762024,-0.22358524799346924,-0.03396560251712799,0.18531088531017303,0.22873656451702118,0.039197955280542374,-0.1143847107887268,0.3397120535373688,-0.322393536567688,-0.4493514597415924,0.2396152913570404,0.10742918401956558,-0.1326822191476822,-0.02985312044620514,0.08111198246479034},{0.05509639158844948,0.16007766127586365,0.020755568519234657,-0.41458991169929504,0.17433752119541168,-0.027743158861994743,0.07236276566982269,0.3954489827156067,0.33874714374542236,0.040734801441431046,-0.4197709858417511,-0.04925427958369255,-0.015112633816897869,0.14535072445869446,-0.24084895849227905,-0.22567859292030334},{-0.3120880126953125,0.4583335220813751,0.39763808250427246,0.36282604932785034,-0.5019397139549255,-0.07991421967744827,0.5677462220191956,0.5476909875869751,-0.23782549798488617,0.31571224331855774,-0.7126853466033936,-0.4519599378108978,0.4672509431838989,0.08759299665689468,0.2750207781791687,0.4532987177371979},{0.38689929246902466,-0.2897167503833771,0.6282933950424194,0.08220871537923813,0.0034168122801929712,0.06948476284742355,0.11672616750001907,-0.6728796362876892,-0.2573033273220062,-0.4198879301548004,-0.16488638520240784,0.008696610108017921,-0.04768543317914009,0.7409811615943909,0.4414307475090027,-0.3043728768825531},{0.24712251126766205,-0.581292986869812,-0.6522367596626282,-0.37775713205337524,-0.24175924062728882,0.24169115722179413,0.12523986399173737,0.12703321874141693,0.6024766564369202,0.282291442155838,0.21649688482284546,-0.2798621952533722,-0.11305872350931168,0.47169652581214905,-0.19762936234474182,-0.6089404821395874},{0.2345951795578003,0.4164961576461792,0.3623391389846802,-0.6330292224884033,-0.34056684374809265,0.15006934106349945,0.17366373538970947,0.4020198583602905,-0.3939894735813141,0.021739978343248367,-0.06845598667860031,-0.023024355992674828,-0.13276320695877075,-0.1710832267999649,0.2344113290309906,-0.4287734925746918},{-0.05472610145807266,-0.46496719121932983,0.17278863489627838,0.6516715884208679,0.8308212161064148,0.4696595370769501,0.4368506968021393,0.42648401856422424,0.046432334929704666,-0.026646211743354797,0.2815248668193817,-0.46114587783813477,-0.6146897673606873,-0.42836591601371765,0.7968128323554993,-0.06362103670835495},{-0.23529815673828125,0.38308799266815186,-0.06145641952753067,-0.588954508304596,0.17180564999580383,0.0654125064611435,0.20444314181804657,0.19260478019714355,0.056511204689741135,0.03962566703557968,0.047780416905879974,0.20390786230564117,0.3521452248096466,0.3452329933643341,-0.10561273247003555,-0.1202545315027237},{0.0736125111579895,-0.3804481327533722,-0.2509557008743286,-0.21545378863811493,-0.4763619601726532,0.015571022406220436,-0.2995378077030182,-0.30810245871543884,-0.23566566407680511,-0.004717250820249319,-0.43652379512786865,-0.02397856116294861,-0.18328270316123962,0.4099155068397522,0.1308373659849167,-0.011265521869063377},{0.06931605190038681,-0.2661750018596649,-0.24607039988040924,0.21108749508857727,-0.1253071427345276,-0.43917515873908997,0.30603528022766113,-0.09335017204284668,-0.040067676454782486,0.365461528301239,0.07228275388479233,0.04873184487223625,0.29995793104171753,0.023455169051885605,-0.2822045683860779,0.2006208598613739},{0.3660520613193512,0.005103870760649443,-0.2292742133140564,-0.16410228610038757,-0.304338663816452,0.15749619901180267,0.3104071617126465,-0.08194759488105774,0.19672231376171112,0.3651309311389923,-0.14961692690849304,0.06856658309698105,-0.17772331833839417,0.23318694531917572,-0.07057539373636246,-0.023353153839707375},{-0.24845260381698608,-0.1851266622543335,0.23163168132305145,0.12933872640132904,-0.22767680883407593,0.06374086439609528,-0.1439129263162613,-0.08253264427185059,-0.19942381978034973,-0.27019426226615906,-0.0337069071829319,-0.27401304244995117,0.07591838389635086,-0.19618326425552368,0.0819636881351471,-0.21673701703548431},{-0.2339562326669693,0.24767589569091797,-0.31287702918052673,-0.19866858422756195,0.05486702919006348,0.29794180393218994,-0.17229029536247253,-0.18956707417964935,0.13119617104530334,0.12641550600528717,0.33714917302131653,-0.13051655888557434,-0.32146501541137695,0.31579428911209106,0.011987675912678242,-0.3907143771648407}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.041291557252407074,-0.05509739741683006,-0.08968545496463776,-0.3496209383010864,0.3109244704246521,0.3037986755371094,0.07532050460577011,0.044425684958696365,-0.07866338640451431,-0.15912896394729614,-0.003100045956671238,0.07955396175384521,0.1965187042951584,0.33468908071517944,0.12594453990459442,0.04994579032063484},{-0.1574031263589859,-0.3020218312740326,-0.05689937248826027,0.040918804705142975,0.23489691317081451,-0.2961021661758423,0.025556504726409912,0.05720922350883484,-0.0547955222427845,0.2654963433742523,-0.2419605404138565,0.3189726173877716,-0.3921510875225067,0.18130894005298615,-0.3022274374961853,-0.35916194319725037},{0.03357328474521637,0.21169088780879974,-0.38120555877685547,-0.5082225203514099,0.19702264666557312,0.4401617646217346,-0.08344965428113937,0.06566052883863449,-0.27386465668678284,-0.2682349383831024,-0.012962806969881058,0.32762065529823303,-0.27959105372428894,-0.14488209784030914,0.09763464331626892,-0.06610793620347977},{0.14879970252513885,-0.06987793743610382,0.0933641567826271,0.18911238014698029,-0.45815446972846985,-0.004744283389300108,0.07866667956113815,-0.18890787661075592,0.2790851891040802,0.3634234368801117,-0.16463510692119598,-0.15495258569717407,-0.4107547700405121,-0.37186673283576965,0.20227189362049103,0.1663290411233902},{-0.05217593163251877,0.15405143797397614,0.010921206325292587,0.2633519768714905,-0.23408593237400055,0.09234689176082611,-0.011951351538300514,0.1747836023569107,0.2502502501010895,-0.22846335172653198,0.1910456120967865,0.23293541371822357,0.18062983453273773,-0.44913148880004883,0.035214949399232864,0.026660801842808723},{0.20476034283638,0.2638355493545532,-0.026573294773697853,0.185945525765419,-0.49392300844192505,-0.4377059042453766,0.26399490237236023,0.315931111574173,0.08133269101381302,0.38289380073547363,0.22884106636047363,-0.2267407476902008,-0.005657638888806105,-0.1575842648744583,-0.12989625334739685,0.28695785999298096},{-0.11336225271224976,0.26308733224868774,0.29145294427871704,-0.36174842715263367,-0.2548528015613556,0.004496419336646795,-0.3521267771720886,-0.03513886034488678,0.1950116604566574,0.07477493584156036,-0.12988032400608063,-0.21397686004638672,-0.3165952265262604,-0.06157698482275009,0.18398752808570862,0.017770905047655106},{-0.11499779671430588,-0.13998478651046753,-0.4528330862522125,0.28507569432258606,-0.31243419647216797,-0.23496600985527039,-0.240123450756073,-0.38415810465812683,0.14895732700824738,-0.22683610022068024,0.0553462877869606,0.06817370653152466,-0.1581202894449234,0.4310981333255768,-0.03930513933300972,-0.3071317672729492},{-0.31699904799461365,0.2549549341201782,-0.010864258743822575,-0.04868687316775322,0.2763535976409912,-0.2737891972064972,0.29038041830062866,0.1464604288339615,0.34110134840011597,0.3079633116722107,0.25295811891555786,0.303701251745224,0.16896049678325653,-0.07746117562055588,0.26447609066963196,0.09807901829481125},{0.07456479966640472,-0.26685675978660583,-0.1494765728712082,-0.1310953050851822,0.24198505282402039,-0.1623314470052719,-0.29331162571907043,-0.14730043709278107,0.06037554144859314,-0.3492862284183502,-0.26289570331573486,0.335053950548172,0.11315915733575821,0.11591785401105881,-0.37441888451576233,0.216488316655159},{-0.039652641862630844,-0.4466865658760071,0.28602921962738037,0.2808530926704407,0.25681352615356445,0.1602349579334259,0.16115126013755798,-0.1324939727783203,0.23577623069286346,-0.23380933701992035,0.19098679721355438,0.3381979465484619,0.4961157739162445,0.11016271263360977,-0.05711866170167923,0.07845091074705124},{0.05370544642210007,-0.008196096867322922,0.4189589023590088,-0.014397182501852512,-0.25366395711898804,-0.1839962601661682,0.4344361126422882,0.31068578362464905,-0.24342882633209229,-0.18957895040512085,-0.0566108338534832,-0.3655208349227905,-0.0170187558978796,-0.2921433448791504,-0.31378164887428284,0.08376573026180267},{-0.14959457516670227,-0.32103243470191956,0.42353177070617676,-0.22421376407146454,0.37124890089035034,-0.3037729859352112,-0.45231083035469055,0.06719440221786499,0.0851512998342514,0.05768584460020065,-0.3208251893520355,0.11033830046653748,0.11563337594270706,-0.27743029594421387,-0.27487218379974365,0.010909372940659523},{0.3733879327774048,-0.3403053879737854,0.4490693211555481,0.07600071281194687,-0.0915113016963005,0.33250418305397034,-0.11872216314077377,-0.223446324467659,-0.4017028212547302,0.10159382224082947,0.012105867266654968,-0.3500595986843109,-0.13175249099731445,0.10281695425510406,0.3029688596725464,0.01921444945037365},{-0.09709044545888901,0.19301655888557434,0.12573575973510742,-0.48812761902809143,-0.1882309466600418,0.2123633772134781,0.23817327618598938,-0.25739043951034546,0.2288304716348648,-0.27997884154319763,0.05585479736328125,0.10622304677963257,-0.04893245920538902,0.19879135489463806,0.0455588661134243,0.07244905829429626},{-0.12779071927070618,0.40768668055534363,-0.4358910322189331,0.3763241469860077,0.08820218592882156,-0.3721190392971039,-0.018855711445212364,-0.07412967085838318,-0.3033263087272644,0.3865028917789459,-0.29354843497276306,0.2774842381477356,-0.09501288831233978,-0.3103422224521637,-0.15071196854114532,-0.46859967708587646}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.14343960583209991,0.10799320787191391,0.0028189148288220167,-0.045989952981472015,-0.08412180840969086,0.01875218376517296,0.2622738480567932,0.06572657823562622,-0.16556623578071594,-0.1755589097738266,0.12070327997207642,-0.2708377242088318,-0.20179232954978943,0.2502431571483612,0.21649813652038574,0.30244776606559753,-0.25466835498809814,-0.27451208233833313,-0.1892305463552475,0.12090856581926346,-0.06345149874687195,-0.33582887053489685,-0.26247483491897583,-0.28001272678375244,-0.2323039174079895,0.1350303590297699,-0.21882475912570953,-0.04948950558900833,-0.05976442992687225,-0.0020118376705795527,0.2198336273431778,-0.20831380784511566},{0.3029770255088806,0.15894728899002075,0.18026024103164673,-0.08965341746807098,0.13106660544872284,-0.14439652860164642,0.36369138956069946,0.15063047409057617,-0.13505145907402039,-0.07706832885742188,-0.11890891939401627,-0.2571008801460266,-0.1830650269985199,0.2361125946044922,-0.25609999895095825,-0.1944991797208786,-0.046900674700737,0.19022412598133087,-0.3561551570892334,-0.2163511961698532,-0.024277716875076294,0.21359732747077942,0.028177212923765182,0.029241878539323807,0.22574321925640106,-0.3459773063659668,-0.05206221714615822,0.07113124430179596,0.16728733479976654,-0.10407467931509018,-0.06692469120025635,0.2023860067129135},{0.17400717735290527,0.03276440501213074,-0.12890878319740295,0.14211201667785645,-0.15132468938827515,-0.15326783061027527,-0.21817132830619812,0.057585593312978745,-0.1600019335746765,0.3393854796886444,-0.32234129309654236,-0.27498912811279297,0.18210670351982117,-0.39538562297821045,-0.1571286916732788,0.09924843162298203,-0.08377600461244583,-0.11886654049158096,0.1905960887670517,-0.09659375250339508,0.23582595586776733,0.27542099356651306,-0.2342226505279541,0.02549482136964798,-0.26329663395881653,-0.022992203012108803,0.13125476241111755,-0.07293552160263062,-0.02107379212975502,-0.20934872329235077,-0.11039219796657562,-0.08049513399600983},{0.39993682503700256,0.05697092413902283,0.14267273247241974,-0.1819247603416443,-0.25238239765167236,-0.03809013590216637,-0.14114047586917877,0.27705618739128113,0.23459091782569885,-0.30598869919776917,-0.06266400963068008,0.27039414644241333,0.11779812723398209,-0.019069211557507515,-0.23625686764717102,0.29258888959884644,-0.2920560836791992,0.2673475444316864,0.014617946930229664,0.11182490736246109,-0.09692391008138657,-0.09688308089971542,0.2902280390262604,0.15627537667751312,0.16606681048870087,-0.3664786219596863,0.26977381110191345,-0.20764747262001038,-0.0432751439511776,0.07205558568239212,-0.1912708729505539,0.13887189328670502},{-0.06635794788599014,-0.06039554998278618,-0.1136355996131897,0.12482520937919617,0.2148786038160324,-0.14732298254966736,-0.41034287214279175,-0.08239162713289261,-0.10015935450792313,-0.3065338134765625,0.14543253183364868,0.24545514583587646,-0.04884712025523186,-0.11381105333566666,-0.10159844160079956,0.12338078022003174,-0.020950013771653175,-0.04053300619125366,-0.3075661361217499,-0.20087359845638275,-0.17376826703548431,-0.3552718460559845,0.13377182185649872,0.14185236394405365,-0.10523001849651337,0.3479039967060089,-0.1876019835472107,0.2135416865348816,0.30276209115982056,0.38332560658454895,-0.02703561633825302,0.3811783790588379},{-0.29037582874298096,0.021914217621088028,-0.2315908968448639,-0.054508015513420105,-0.20590339601039886,0.24025920033454895,0.20234237611293793,0.016182053834199905,0.25577032566070557,0.2272714376449585,0.33847999572753906,-0.22590716183185577,-0.27393433451652527,0.19407542049884796,0.33959951996803284,-0.33629822731018066,-0.12362807244062424,-0.2567462623119354,0.2284134328365326,0.10241549462080002,0.09156299382448196,0.18218550086021423,0.0714290663599968,-0.08239437639713287,-0.3502199947834015,0.3597261905670166,-0.1364777386188507,0.209639310836792,0.33209681510925293,0.18194924294948578,0.05740685388445854,0.024026159197092056},{0.19791381061077118,-0.14472326636314392,-0.1353256106376648,-0.3041316866874695,-0.045274827629327774,0.23704925179481506,0.2959088683128357,0.17574289441108704,0.08440304547548294,0.3519717752933502,-0.0017229864606633782,-0.026864083483815193,-0.45966535806655884,-0.1711558848619461,-0.15604373812675476,0.16025690734386444,-0.26378917694091797,-0.2230786830186844,0.21256938576698303,-0.0871204063296318,-0.12415038794279099,-0.15118075907230377,-0.2282257229089737,-0.2161867618560791,0.13560397922992706,-0.2177843451499939,-0.08566287904977798,-0.20153984427452087,0.29855799674987793,0.12677939236164093,-0.16473908722400665,-0.2928609848022461},{0.023102490231394768,0.1622391641139984,0.06587695330381393,-0.007078633643686771,0.1294417828321457,-0.3211747109889984,-0.13174133002758026,-0.15348972380161285,-0.023904675617814064,-0.23498335480690002,-0.30466222763061523,-0.028216755017638206,-0.12804095447063446,-0.02488710545003414,-0.12115482985973358,0.3843640089035034,-0.017468411475419998,-0.15753744542598724,0.12684890627861023,0.33813512325286865,-0.1030280813574791,-0.24449729919433594,0.256584107875824,0.09864506870508194,-0.03959756717085838,-0.3132651746273041,-0.30605149269104004,-0.3131619691848755,-0.34224605560302734,-0.232153058052063,0.04185355827212334,-0.30152663588523865},{0.091397225856781,0.3071759343147278,-0.26056942343711853,-0.3203687369823456,-0.22386467456817627,0.05810454860329628,0.06399768590927124,0.07066559791564941,0.14686219394207,-0.276202917098999,-0.2225295603275299,0.33965709805488586,-0.24031248688697815,-0.2026330679655075,0.18853254616260529,-0.27494609355926514,0.262514591217041,0.14421790838241577,0.3346309959888458,0.043162520974874496,0.22494685649871826,0.042827852070331573,0.26596203446388245,-0.08730959892272949,0.3713192939758301,-0.213781476020813,0.11338978260755539,0.3171112835407257,-0.28569167852401733,0.21976573765277863,-0.025695405900478363,0.15572603046894073},{-0.17680780589580536,0.12603551149368286,-0.2206275463104248,-0.15193621814250946,0.19552825391292572,-0.14233385026454926,0.07458154112100601,-0.01579298824071884,0.16080114245414734,-0.05175885185599327,-0.26799073815345764,-0.2756042182445526,-0.301775723695755,-0.05652952566742897,-0.23556002974510193,0.08625579625368118,0.07475977391004562,-0.2026909589767456,0.2785124182701111,0.09279141575098038,0.0026455537881702185,-0.026768134906888008,0.272060364484787,-0.20561900734901428,0.31216487288475037,0.1009264811873436,-0.25865527987480164,0.013732037506997585,-0.016050903126597404,0.155726358294487,-0.11163055151700974,0.10956472158432007},{0.08485296368598938,0.018098412081599236,0.21184368431568146,-0.27458739280700684,-0.2955110967159271,-0.24367037415504456,-0.26996296644210815,-0.004190514329820871,-0.21152834594249725,0.42722755670547485,0.14588125050067902,-0.25166040658950806,-0.3795356750488281,-0.03189041092991829,-0.2250550389289856,-0.09360744059085846,0.2213403582572937,-0.15350830554962158,0.26043155789375305,-0.14677532017230988,-0.18789535760879517,-0.0007127111894078553,0.15695685148239136,0.234181210398674,0.16336265206336975,-0.11268524825572968,-0.010232029482722282,-0.09027706831693649,-0.06281651556491852,0.025014812126755714,-0.03786120191216469,0.12186649441719055},{-0.16906923055648804,-0.12164982408285141,0.20893025398254395,0.2966194450855255,0.25168827176094055,-0.06105852127075195,0.06854530423879623,-0.21835872530937195,-0.016723383218050003,-0.25274553894996643,0.2661533057689667,-0.21687710285186768,-0.21574151515960693,-0.21029546856880188,0.23957104980945587,-0.00271046906709671,-0.021219072863459587,0.00659381877630949,0.35248076915740967,0.048336971551179886,-0.16671863198280334,0.20977318286895752,0.10290240496397018,-0.062370553612709045,0.23028260469436646,-0.09526413679122925,-0.18387237191200256,0.20455648005008698,0.1360127180814743,0.010170870460569859,-0.31100258231163025,-0.228349968791008},{0.29358726739883423,-0.2421756386756897,0.0012228537816554308,-0.3169254660606384,-0.011180851608514786,-0.15388958156108856,0.10778769850730896,0.15635812282562256,0.21717211604118347,0.061473410576581955,0.19679711759090424,0.2622346878051758,-0.4354710578918457,-0.35897064208984375,-0.030638735741376877,-0.21811357140541077,-0.2517498731613159,-0.3067285418510437,0.3195783793926239,-0.17784743010997772,0.3376524746417999,-0.10001028329133987,0.007302465382963419,0.1863863319158554,0.1171853169798851,-0.10569170117378235,0.12385863810777664,0.04583674296736717,0.08844099193811417,-0.01059796940535307,-0.27344632148742676,0.003591615241020918},{0.25623205304145813,-0.03650153800845146,-0.021914834156632423,0.3532833158969879,-0.0919019877910614,-0.16010868549346924,-0.026003194972872734,0.16676989197731018,0.18927276134490967,0.2418135702610016,0.12234044075012207,-0.14153774082660675,0.05491789057850838,0.2123444825410843,-0.1258115917444229,0.11990103125572205,0.23870716989040375,-0.23465664684772491,0.11394113302230835,-0.34433990716934204,0.24102041125297546,0.16576310992240906,-0.08952049911022186,0.19778577983379364,0.24655349552631378,0.07817008346319199,0.1569618135690689,0.10249616205692291,0.08334039151668549,-0.14298668503761292,0.030986355617642403,0.35458528995513916},{0.07937286794185638,-0.2109087109565735,0.0067244335077703,0.09613753110170364,-0.27387508749961853,-0.015214982442557812,0.048154041171073914,-0.2183820754289627,-0.15130525827407837,-0.023260872811079025,0.16979680955410004,0.20585374534130096,0.10594336688518524,0.2471706122159958,-0.03727523609995842,-0.03266528248786926,-0.22740209102630615,0.25052517652511597,-0.07489780336618423,-0.1996479630470276,-0.20324194431304932,-0.1168655976653099,0.1393446922302246,0.05154302343726158,0.00678349519148469,-0.1464589685201645,-0.17223931849002838,0.20500940084457397,0.04842239245772362,-0.14673356711864471,0.24902072548866272,0.16544301807880402},{0.17389819025993347,-0.2352059781551361,0.029816260561347008,-0.1910705268383026,0.01369553618133068,0.15144148468971252,0.06483384221792221,0.25833413004875183,-0.08197177201509476,-0.03145763650536537,0.20857223868370056,0.13022807240486145,0.06377356499433517,-0.10123841464519501,-0.01851925067603588,0.20121075212955475,-0.33107200264930725,-0.187945157289505,-0.03179341182112694,0.08441630005836487,0.0366719588637352,0.23792359232902527,0.13717041909694672,0.19130823016166687,0.06405599415302277,0.17717812955379486,-0.03642551600933075,-0.0603489950299263,0.07466620206832886,-0.08830519765615463,-0.25769636034965515,0.31603696942329407},{0.16585198044776917,0.00770419929176569,-0.34464532136917114,0.11860206723213196,0.04896970093250275,-0.04715539142489433,0.33208519220352173,0.11179131269454956,0.11204102635383606,-0.11299795657396317,0.19829565286636353,-0.239671990275383,-0.38617315888404846,0.2369716763496399,0.08159516006708145,0.049535080790519714,-0.026508331298828125,-0.10135561972856522,-0.158651664853096,0.06687869876623154,-0.031051162630319595,0.20758292078971863,0.09135790914297104,-0.16296394169330597,-0.07134358584880829,-0.23730449378490448,0.060998767614364624,0.31763505935668945,0.21453465521335602,-0.1883028894662857,0.17808252573013306,0.1785344034433365},{-0.0764661356806755,0.010194453410804272,-0.08634969592094421,-0.07238699495792389,-0.2388984113931656,-0.03378854691982269,0.2202853411436081,0.1758139431476593,0.12843593955039978,0.023303158581256866,0.17887650430202484,-0.0060792420990765095,0.23976726830005646,0.20035704970359802,0.18274278938770294,-0.10518749803304672,0.11294718086719513,0.19065944850444794,0.2083766758441925,0.049979303032159805,0.20127922296524048,0.27611005306243896,0.08528405427932739,0.16584095358848572,-0.03083939477801323,-0.07230254262685776,-0.12749513983726501,-0.2523445188999176,0.13731984794139862,-0.280880331993103,0.027582010254263878,-0.0611104890704155},{-0.32791200280189514,0.05206058546900749,-0.32543253898620605,-0.324826717376709,0.024652358144521713,-0.005820900667458773,0.11436406522989273,-0.1557811200618744,0.055092789232730865,0.3504764139652252,0.021607084199786186,-0.20350056886672974,0.06879640370607376,-0.20355428755283356,-0.29940369725227356,0.014580207876861095,-0.1762179434299469,0.10867030173540115,-0.05443398281931877,0.017988085746765137,-0.2818153500556946,0.14132298529148102,0.10324826091527939,0.04129808768630028,-0.07999564707279205,0.3325193226337433,0.052327584475278854,-0.20829914510250092,-0.18587879836559296,0.030289357528090477,-0.20734192430973053,-0.2506762444972992},{-0.0075449757277965546,-0.26432934403419495,-0.279788613319397,-0.05147875100374222,-0.32605060935020447,-0.1501196324825287,0.18404150009155273,-0.27887415885925293,-0.2142675817012787,0.1733831763267517,0.2022036463022232,0.08959205448627472,0.11983097344636917,-0.1543554663658142,0.2731874883174896,-0.271530419588089,0.08961807936429977,0.2578312158584595,0.04659665375947952,0.27356263995170593,0.009039223194122314,-0.11945953220129013,-0.27696725726127625,0.22191575169563293,-0.11728806793689728,-0.15443499386310577,0.11739610880613327,0.04086272791028023,-0.11972661316394806,-0.3241795003414154,-0.03282342851161957,-0.1892312467098236},{0.2418423742055893,0.12248817086219788,-0.04190225154161453,0.19892281293869019,-0.2409692406654358,0.12305843085050583,-0.08390704542398453,-0.1704590618610382,-0.11255784332752228,0.18678052723407745,-0.3217315077781677,-0.13212306797504425,0.018616285175085068,-0.2052987813949585,-0.3887738287448883,-0.15079915523529053,-0.09026334434747696,-0.3035123646259308,-0.23480038344860077,0.2281666249036789,0.1265219748020172,0.10567520558834076,-0.3831321895122528,0.3201272189617157,0.1605469286441803,0.2901470959186554,-0.2971348166465759,-0.08113763481378555,0.0626811757683754,-0.19458243250846863,0.14225128293037415,0.14980265498161316},{-0.05322199687361717,-0.306072860956192,-0.044803593307733536,-0.3072282075881958,-0.07283014804124832,0.2906365990638733,0.2058034986257553,0.0319121815264225,-0.0957663282752037,0.01108182966709137,-0.15067926049232483,0.09959124028682709,0.10238691419363022,0.05532002076506615,0.1131427139043808,0.031989775598049164,-0.0871746689081192,0.1394619196653366,-0.11651847511529922,0.14522652328014374,0.1898147165775299,0.2532063126564026,-0.028275880962610245,-0.24936027824878693,0.165651336312294,0.16186875104904175,0.28074535727500916,0.16515520215034485,0.02271455153822899,0.11132702976465225,0.015453903004527092,-0.10147344321012497},{-0.026483112946152687,-0.2122327983379364,0.22223465144634247,0.06794395297765732,0.27505946159362793,-0.02647337131202221,-0.13783010840415955,-0.2054770141839981,0.14056068658828735,-0.04268445447087288,0.08538517355918884,0.0036235523875802755,-0.3345561921596527,0.05650706961750984,-0.09454481303691864,-0.26164770126342773,-0.044580936431884766,-0.06651768833398819,0.1816132366657257,0.19132958352565765,0.027325280010700226,0.050113826990127563,0.16371333599090576,0.2945549190044403,-0.1902623325586319,-0.033130452036857605,0.16026805341243744,-0.07175452262163162,-0.1346723884344101,-0.25961071252822876,0.28922516107559204,0.02463115192949772},{0.1945711374282837,-0.0832153782248497,0.04237811639904976,0.0960736870765686,-0.01608898490667343,0.03849813714623451,-0.2172534465789795,0.3077636659145355,-0.11210990697145462,-0.018045494332909584,0.10229634493589401,-0.31757816672325134,0.0867064818739891,-0.04487806558609009,-0.1280137002468109,0.3297121524810791,-0.08944890648126602,-0.17047454416751862,0.0039287894032895565,0.02572796680033207,-0.18257172405719757,0.1744409054517746,0.21472778916358948,0.262763649225235,-0.255723774433136,0.11086029559373856,-0.07986411452293396,0.06265665590763092,-0.2711803913116455,0.23175998032093048,-0.059973057359457016,0.02194451168179512}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.21227729320526123,-0.12405369430780411,0.06404905021190643,-0.1251729428768158},{0.1997920274734497,-0.25066542625427246,0.273516982793808,0.22542314231395721},{-0.24116003513336182,0.029239080846309662,0.0732957199215889,-0.025634750723838806},{0.281633198261261,0.401322603225708,0.29807060956954956,0.04064466431736946},{-0.2575233578681946,0.14919935166835785,-0.2641163170337677,0.1147741824388504},{0.021695110946893692,-0.08465027064085007,0.07176852971315384,0.26878708600997925},{-0.09989332407712936,-0.1692700982093811,-0.34145715832710266,-0.05226201191544533},{-0.10252054035663605,-0.3353406488895416,0.13722440600395203,-0.05195077881217003},{-0.0940127745270729,0.1505015790462494,-0.08258884400129318,-0.08715452253818512},{0.21365061402320862,-0.016707489266991615,-0.08412601798772812,-0.16199296712875366},{0.22670772671699524,-0.18641111254692078,0.28094151616096497,0.21515026688575745},{-0.02567276358604431,0.0056610917672514915,0.3547287583351135,-0.08213742822408676},{-0.29961904883384705,0.22585049271583557,-0.04273216798901558,-0.07880079746246338},{-0.15110711753368378,0.007633924949914217,-0.22197476029396057,0.04694077745079994},{0.197508305311203,-0.029691504314541817,0.20895728468894958,0.06372638791799545},{-0.13525055348873138,-0.2635319232940674,-0.12166428565979004,-0.06983941793441772},{-0.24494290351867676,0.04134463891386986,-0.06524664163589478,0.2730174958705902},{-0.25227856636047363,-0.1312250941991806,-0.2246202528476715,0.173801988363266},{-0.05875343084335327,-0.09400296211242676,0.3489225208759308,0.06831759959459305},{-0.1402733474969864,-0.16150128841400146,-0.014059599488973618,-0.1637355238199234},{0.14419881999492645,0.11288081854581833,0.11668669432401657,-0.13745729625225067},{-0.010255452245473862,-0.2564682066440582,-0.13004142045974731,0.23208792507648468},{0.28200748562812805,-0.13622841238975525,0.16290919482707977,0.01866663247346878},{-0.2658553421497345,-0.09443533420562744,-0.27114158868789673,-0.19153505563735962},{-0.23520851135253906,-0.16566766798496246,-0.004258148837834597,-0.11588595807552338},{0.16070279479026794,0.16879796981811523,-0.053315989673137665,0.14592908322811127},{0.1851263791322708,-0.19450055062770844,0.21647487580776215,0.0821443498134613},{-0.04492080211639404,-0.1517840474843979,0.007833200506865978,0.284471720457077},{0.046091388911008835,0.020276449620723724,0.022238371893763542,0.01782182976603508},{-0.1361648589372635,0.10125783085823059,0.21580654382705688,0.017116690054535866},{-0.13714337348937988,-0.1334860473871231,0.07761122286319733,0.18128247559070587},{0.17835432291030884,0.19875113666057587,0.2218402922153473,-0.01493179053068161}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05276958644390106,0.006828538607805967,0.0005825768457725644,0.04554107412695885,0.03636135905981064,-0.04973243921995163,0.0008649309747852385,0.05237170681357384,-0.07363864779472351,-0.08209595829248428,-0.017827384173870087,0.0636463388800621,-0.02345449849963188,0.048777997493743896,-0.024665946140885353,-0.0271371491253376};
static const float actor_encoder_self_encoder_2_bias[16] = {0.003675897838547826,-0.006782233715057373,-0.007517911493778229,-0.013054423034191132,-0.05444924905896187,0.019258689135313034,-0.02111971564590931,-0.0031445042695850134,0.01818106882274151,-0.037507280707359314,0.0011236174032092094,-0.01571323350071907,-0.011690140701830387,-0.023486707359552383,-0.0241706445813179,-0.041519645601511};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0020007395651191473,0.06470248103141785,-0.02031826600432396,0.01693660020828247,-0.016536341980099678,0.03439418971538544,-0.04418230429291725,-0.011524956673383713,-0.0274275504052639,-0.020546691492199898,-0.007375315297394991,0.03164641186594963,0.010259217582643032,0.011802401393651962,0.05686443671584129,-0.04521191492676735,0.01836819387972355,-0.007199574261903763,0.021895548328757286,-0.03212752938270569,-0.004080822225660086,0.030176343396306038,-0.002833851845934987,-0.043901290744543076,-0.05313771963119507,0.016023574396967888,0.026285534724593163,0.031010527163743973,-0.004912668373435736,0.022411489859223366,0.02949504368007183,0.0033982694149017334};
static const float action_parameterization_distribution_linear_bias[4] = {0.007684668991714716,0.013260409235954285,0.015930017456412315,0.03899350017309189};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.41620805859565735,-0.380876362323761,-0.13232143223285675,0.23301449418067932,-0.18253301084041595,0.10649215430021286,-0.3161112368106842,0.05309288948774338},{0.20436027646064758,0.10909377038478851,0.40398845076560974,0.3776725232601166,-0.11328193545341492,-0.33624720573425293,0.30943313241004944,0.3925304412841797},{0.06852667033672333,0.17014256119728088,0.11075763404369354,-0.05607643350958824,0.33149030804634094,0.22499504685401917,-0.025820422917604446,0.23110464215278625},{0.12029922008514404,-0.3823222219944,0.3410699963569641,-0.15565863251686096,-0.22715696692466736,0.1070733517408371,0.3177947998046875,0.2507157027721405},{-0.2387917935848236,-0.09565883874893188,-0.03479491546750069,-0.26853469014167786,0.147693932056427,0.1322033405303955,0.3546293079853058,0.2770223915576935},{-0.04095405340194702,0.18146684765815735,0.0069953082129359245,-0.1956901252269745,0.3440861403942108,0.1281137764453888,0.1183430477976799,-0.17066000401973724},{0.01267502922564745,0.1416195183992386,0.15574583411216736,-0.1454341560602188,0.4357600212097168,-0.09601585566997528,0.1538340300321579,0.08633623272180557},{0.05964608117938042,-0.46775558590888977,-0.017296291887760162,-0.22539818286895752,0.2935320734977722,0.05892195552587509,-0.16923530399799347,-0.3484971821308136},{-0.25182029604911804,0.15069912374019623,0.018224330618977547,-0.07215326279401779,0.03437915816903114,0.46457406878471375,0.3890680968761444,0.2890860140323639},{0.0038703083992004395,-0.1562013328075409,-0.26537832617759705,0.2771172821521759,0.3011920750141144,0.32673051953315735,0.3490886390209198,-0.3308960497379303},{-0.15513870120048523,-0.39713406562805176,0.3651074469089508,0.17987318336963654,0.025875214487314224,-0.2622606158256531,0.028578877449035645,-0.3419043719768524},{0.24972322583198547,0.017256107181310654,0.41688594222068787,0.4046688377857208,-0.09892963618040085,0.33407703042030334,0.201944962143898,-0.33791229128837585},{-0.3713681995868683,0.1328728049993515,-0.34469839930534363,0.4394493103027344,-0.01240015309303999,0.4204227328300476,-0.015784332528710365,0.25255635380744934},{-0.055055271834135056,0.16032198071479797,-0.11872315406799316,-0.11300964653491974,0.03189365938305855,0.17263174057006836,0.2779684364795685,-0.008745191618800163},{0.11468362808227539,-0.3755696713924408,-0.3516436219215393,-0.16702093183994293,0.1379164159297943,-0.13049036264419556,0.10389712452888489,-0.12605422735214233},{-0.47615909576416016,-0.369926780462265,-0.29467397928237915,-0.012086333706974983,-0.05318112671375275,0.23756282031536102,0.15381242334842682,-0.1355692595243454},{-0.17807941138744354,-0.33252689242362976,0.21276652812957764,-0.36054727435112,-0.00927515048533678,0.03840018808841705,-0.449460506439209,-0.3176840543746948},{0.072501040995121,0.20937956869602203,0.12151747941970825,0.20126457512378693,-0.12147937715053558,0.32864266633987427,0.2544800639152527,-0.22445659339427948},{0.07551230490207672,-0.3468434810638428,-0.09132514894008636,-0.04722010716795921,-0.15020723640918732,-0.3462546765804291,0.01329670287668705,-0.3165191411972046},{-0.019111888483166695,-0.01667429506778717,0.09456897526979446,-0.2943231761455536,0.040023911744356155,0.11689993739128113,0.04820831120014191,-0.15281550586223602},{0.11527970433235168,-0.11999285966157913,0.059291113168001175,-0.24905002117156982,-0.009055120870471,-0.005781885236501694,-0.06252602487802505,-0.2723718583583832},{-0.29639676213264465,0.16719356179237366,0.12993669509887695,-0.2337033748626709,-0.4749335050582886,0.011159008368849754,0.09682833403348923,-0.023508472368121147},{0.3053370416164398,0.1087573915719986,-0.4431554079055786,0.124263696372509,-0.0771748498082161,0.22064262628555298,0.19932174682617188,0.2556963264942169},{0.034080490469932556,-0.11076951771974564,-0.04803602397441864,0.31090858578681946,-0.3362776041030884,-0.07318484038114548,-0.1940510869026184,-0.3542548418045044},{0.22986210882663727,0.06852103769779205,-0.4853278696537018,0.3229914605617523,-0.31608307361602783,-0.34889835119247437,-0.35110926628112793,0.1390126496553421},{0.0755779966711998,0.3407743573188782,-0.3298932611942291,-0.05351787060499191,0.07597427815198898,-0.2506469488143921,0.31620854139328003,-0.307378351688385},{-0.04363086819648743,0.05119483172893524,-0.17045798897743225,-0.13456571102142334,0.035060279071331024,-0.18239301443099976,-0.09786161035299301,-0.15035296976566315},{0.1747717559337616,-0.20382502675056458,-0.07947475463151932,-0.08245781809091568,0.0060195536352694035,0.0007563309045508504,-0.20476852357387543,0.08425465226173401},{0.3790627121925354,0.024457182735204697,-0.40980687737464905,-0.17509327828884125,-0.24915677309036255,0.10679250955581665,0.23853863775730133,0.07154980301856995},{0.4298384189605713,-0.3219972252845764,-0.051983464509248734,-0.020713362842798233,0.11078261584043503,-0.13039319217205048,0.2118578404188156,0.3393411636352539},{-0.1983773559331894,-0.1704103946685791,0.017048437148332596,-0.2259054332971573,0.3286563754081726,-0.2652759552001953,0.04501477628946304,0.09735459089279175},{0.2508314549922943,0.021027736365795135,-0.15424300730228424,0.37666913866996765,0.09834805130958557,0.0020080022513866425,-0.027708647772669792,0.05203448608517647}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23713064193725586,0.39698925614356995,-0.5996794104576111,-0.5239840149879456,-0.2551365792751312,0.07085899263620377,-0.3999360501766205,0.5386751890182495},{-0.03521256521344185,0.5554578900337219,-0.2125176638364792,0.4907503128051758,-0.019438156858086586,0.025012405589222908,-0.2538282573223114,0.001856533344835043},{-0.460777223110199,-0.18116214871406555,-0.16670344769954681,-0.260385125875473,0.5133673548698425,0.1735275387763977,-0.013050336390733719,0.43912261724472046},{-0.46958765387535095,-0.4331178069114685,0.2752649784088135,0.3713606595993042,-0.5048210024833679,-0.18228088319301605,0.41765743494033813,0.18915371596813202},{-0.27734965085983276,-0.31225037574768066,-0.2803889811038971,-0.25956955552101135,0.32535091042518616,-0.2537142038345337,0.4525837302207947,-0.3967604637145996},{-0.08064080774784088,0.1482793092727661,0.2918078303337097,-0.542357325553894,0.5367788672447205,-0.29832199215888977,-0.41163381934165955,-0.3041348159313202},{-0.4132837951183319,0.14500999450683594,0.07015359401702881,-0.33404162526130676,-0.021624291315674782,-0.5246553421020508,0.5109146237373352,0.06951377540826797},{-0.3868947923183441,-0.3123472332954407,-0.22283151745796204,-0.44988736510276794,-0.30607518553733826,0.06995336711406708,0.46529269218444824,-0.3093748688697815}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.014029824174940586,-0.054000891745090485,-0.017334988340735435,0.019862515851855278,-0.030227595940232277,-0.018719470128417015,-0.10509208589792252,0.013413985259830952};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.011882061138749123,-0.06372581422328949,-0.018059855327010155,0.0868743285536766,-0.02509654499590397,0.047395363450050354,-0.03065798059105873,0.04394017159938812};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

