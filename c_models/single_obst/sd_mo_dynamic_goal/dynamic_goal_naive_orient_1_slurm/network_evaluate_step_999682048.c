#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.33819371461868286,0.04678759723901749,0.07918684929609299,0.2672737240791321,0.23923996090888977,-0.21613338589668274,-0.3328564465045929,0.12005080282688141,0.3898821771144867,-0.32015204429626465,0.43361297249794006,0.09047230333089828,0.22475466132164001,0.07173768430948257,-0.3138413727283478,0.027410956099629402},{-0.31514063477516174,-0.2154143750667572,-0.23395784199237823,-0.08832093328237534,0.1795097291469574,0.40899354219436646,0.18454982340335846,-0.00888427160680294,0.19732417166233063,0.25861644744873047,-0.06883367896080017,0.020618263632059097,-0.10854802280664444,0.09433238953351974,0.2910258173942566,-0.2216261327266693},{-0.006793458480387926,0.1421259343624115,0.26555201411247253,0.3715391755104065,0.08472634851932526,-0.33373457193374634,0.9242972135543823,-0.3133915066719055,-0.3059612214565277,0.011290430091321468,-0.047796014696359634,-0.2565563917160034,0.4146946370601654,0.6548802256584167,-0.5919959545135498,0.22551801800727844},{0.13009297847747803,-0.15880133211612701,-0.13483326137065887,-0.0051584187895059586,-0.09748504310846329,0.13632376492023468,-0.07386220246553421,-0.20932091772556305,-0.024830924347043037,-0.012067178264260292,0.5758053064346313,-0.18461452424526215,-0.3328404426574707,-0.1762627214193344,0.24435923993587494,-0.0271805040538311},{-0.1716235876083374,-0.029392652213573456,0.18281367421150208,-0.4001151919364929,0.4473887085914612,0.250286728143692,0.2035878449678421,-0.18469226360321045,-0.1913691908121109,0.30507129430770874,-0.13318754732608795,-0.4138598144054413,-0.014887127093970776,-0.21822486817836761,0.45378533005714417,-0.010492690838873386},{-0.049605004489421844,-0.10372883081436157,-0.10282009094953537,-0.06884805858135223,0.08679123967885971,-0.23395854234695435,0.6105374693870544,-0.32195791602134705,-0.2456621378660202,-0.1841432899236679,0.13533784449100494,0.052210256457328796,0.32408106327056885,0.0312521867454052,0.2935539484024048,0.2763521373271942},{-0.10012811422348022,0.31594401597976685,-0.10113796591758728,0.12421072274446487,-0.27481669187545776,-0.06481428444385529,-0.11145751178264618,0.022850023582577705,0.3468085825443268,0.24951155483722687,-0.33800065517425537,-0.11297418922185898,0.24077743291854858,-0.10898769646883011,-0.09346410632133484,0.18443317711353302},{-0.35229718685150146,0.2572992146015167,-0.0881015881896019,-0.32220327854156494,0.27211183309555054,-0.3146571218967438,-0.35290566086769104,-0.5810777544975281,-0.10267694294452667,-0.2783546447753906,0.5778616666793823,0.1437988132238388,-0.052896641194820404,0.5324113965034485,0.029664091765880585,0.7171087265014648},{0.28112393617630005,0.14649420976638794,-0.2965766489505768,-0.003054781584069133,-0.6769251823425293,-0.6172890663146973,0.16801391541957855,-0.5956017971038818,-0.01689819246530533,-0.17697781324386597,0.3888658583164215,-0.6129558086395264,-0.5342885255813599,0.12835940718650818,0.0627724826335907,-0.32556283473968506},{0.6760247945785522,-0.9341753125190735,-0.4055038392543793,0.15752559900283813,0.20680150389671326,-0.37330931425094604,0.04100733995437622,-0.17199797928333282,-0.4017351567745209,-0.06875632703304291,-0.30642274022102356,-0.38481906056404114,0.5866094827651978,-0.39632585644721985,-0.7574695944786072,-0.35066884756088257},{0.34795495867729187,0.30777767300605774,-0.1946137398481369,0.07206474989652634,0.10799475759267807,-0.1389327347278595,-0.1296773999929428,0.17192481458187103,-0.010591110214591026,0.17278748750686646,0.1513686180114746,0.21347568929195404,-0.13275611400604248,0.1225319355726242,0.0229568500071764,-0.4013575315475464},{-0.4153434634208679,0.2865757942199707,0.6174334287643433,-0.9809486269950867,0.18414299190044403,0.22776126861572266,0.17252503335475922,0.3767121136188507,0.347061425447464,0.45857441425323486,0.4986506402492523,-0.4505957365036011,0.33415743708610535,-0.2387724369764328,0.09172482788562775,-0.2601431906223297},{0.15561290085315704,-0.3429808020591736,-0.2821725308895111,0.3573671877384186,-0.19177232682704926,-0.30249708890914917,-0.05241770297288895,0.30563798546791077,0.22865508496761322,-0.1670592725276947,-0.3305503726005554,0.27975183725357056,0.3857845366001129,0.3519921898841858,-0.23176775872707367,0.6325179934501648},{0.2531558573246002,0.306307852268219,-0.3000781536102295,0.06268952041864395,-0.10635891556739807,-0.1531994789838791,-0.28256112337112427,0.2015303671360016,-0.23036570847034454,-0.33599576354026794,-0.05567823722958565,0.07583547383546829,-0.5383583307266235,-0.11368736624717712,-0.26819080114364624,-0.18770910799503326},{0.13032139837741852,0.5605060458183289,0.3204542100429535,-0.3805103302001953,-0.3731127381324768,0.2529726028442383,-0.10891436785459518,0.021375713869929314,0.5059270858764648,0.25673529505729675,-0.22573894262313843,0.15703240036964417,-0.19165962934494019,-0.34712499380111694,0.13534420728683472,-0.32627376914024353},{-0.33428528904914856,-0.049440931528806686,-0.02667192369699478,0.22955024242401123,-0.018267376348376274,-0.009728127159178257,-0.17015741765499115,-0.026106223464012146,-0.3785436749458313,-0.12808772921562195,0.2293325960636139,0.07452824711799622,-0.1622537225484848,-0.2134726643562317,-0.38474857807159424,-0.08551011234521866},{-0.2662009000778198,0.15721474587917328,-0.1408528834581375,0.0133310966193676,-0.11218623071908951,0.2935245633125305,0.33352893590927124,0.10906759649515152,0.17074112594127655,-0.2460782378911972,-0.02979341521859169,-0.09806196391582489,-0.035567913204431534,0.04009494557976723,-0.020883256569504738,-0.12681986391544342},{0.16930590569972992,-0.42105308175086975,0.09684137254953384,0.12049181759357452,-0.0009501962922513485,0.2942425012588501,0.303645521402359,0.12235596776008606,-0.13443562388420105,-0.23296023905277252,-0.1040007695555687,-0.1640283465385437,-0.11733582615852356,-0.3765742778778076,0.051032114773988724,0.013585076667368412}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1490269899368286,0.31109386682510376,0.3410770297050476,-0.06138205900788307,-0.16574782133102417,0.03140419349074364,0.07848181575536728,0.24573366343975067,-0.0898299589753151,0.31303051114082336,0.45286259055137634,-0.3538682162761688,-0.08712473511695862,0.09721451252698898,0.014146530069410801,-0.035966724157333374},{-0.49692729115486145,0.23711176216602325,-0.2591324746608734,0.27238574624061584,0.3486022651195526,-0.08172806352376938,-0.30882933735847473,-0.27736538648605347,0.25430524349212646,0.3021351099014282,-0.07475269585847855,0.20891381800174713,-0.27367836236953735,0.16484108567237854,-0.25544077157974243,0.4086112380027771},{-0.36734458804130554,0.17700913548469543,-0.3077451288700104,0.07041309773921967,-0.41510987281799316,-0.2588294744491577,-0.10977782309055328,0.042861104011535645,-0.21581779420375824,0.3279741406440735,0.20410190522670746,-0.052568912506103516,0.1957380175590515,-0.3300594687461853,-0.02961486577987671,0.03899455815553665},{0.22754517197608948,-0.21463052928447723,0.08252265304327011,0.42865461111068726,-0.46210601925849915,-0.31096068024635315,0.24742045998573303,0.14060115814208984,0.2810365855693817,-0.07900486886501312,0.24427953362464905,0.10807251930236816,-0.2579464614391327,-0.07256443053483963,-0.02983965538442135,-0.3604160249233246},{-0.30031895637512207,0.028041072189807892,0.24046295881271362,-0.3412652909755707,0.11981247365474701,0.22662018239498138,-0.2980300784111023,0.26805970072746277,-0.2264454960823059,0.17908819019794464,-0.12651050090789795,-0.0071161603555083275,-0.13899493217468262,0.021602662280201912,-0.21522743999958038,-0.18877361714839935},{-0.017837470397353172,-0.2065584808588028,-0.05751703679561615,-0.3865305781364441,0.3071568012237549,0.019786352291703224,-0.008368848823010921,-0.10516563057899475,-0.20018452405929565,0.3541010916233063,0.3157499432563782,-0.08988162875175476,-0.14705084264278412,0.23673635721206665,-0.08735008537769318,-0.3597610890865326},{0.20557983219623566,-0.18095459043979645,0.28535130620002747,-0.31842297315597534,-0.37399721145629883,-0.1085791289806366,-0.38199761509895325,0.34986212849617004,-0.14053408801555634,-0.26953232288360596,-0.2395223081111908,-0.022391296923160553,-0.08307541161775589,-0.06787119060754776,0.4703584909439087,-0.3815656900405884},{-0.3093997538089752,0.3875243663787842,-0.05096620321273804,0.21449996531009674,0.006916659418493509,-0.20515145361423492,-0.129874587059021,0.08305709809064865,-0.0626133382320404,0.48684871196746826,0.1135576069355011,-0.2131175547838211,0.11446155607700348,-0.09299125522375107,0.06837005168199539,0.16371871531009674},{0.17255528271198273,0.2715817093849182,-0.1670035868883133,-0.34934908151626587,0.3650614023208618,-0.23572084307670593,0.2444573938846588,-0.35188722610473633,0.042189158499240875,0.010626955889165401,0.1104944720864296,0.1066613420844078,0.015604682266712189,-0.2277032434940338,-0.09432204067707062,0.2028191089630127},{-0.17435228824615479,-0.029754484072327614,-0.2658005356788635,-0.3084886968135834,0.22628343105316162,-0.4363347291946411,-0.1903783529996872,0.25575581192970276,-0.057176850736141205,0.17645566165447235,0.030360179021954536,-0.06619337201118469,-0.3515929877758026,0.006627727299928665,-0.2025948464870453,-0.35803043842315674},{-0.22671939432621002,-0.07574892789125443,-0.10659059882164001,-0.3234313130378723,-0.32098203897476196,-0.001888004131615162,0.13811634480953217,-0.4585545063018799,-0.00783461518585682,-0.03326782211661339,0.12477611005306244,-0.011300720274448395,0.30558812618255615,0.030094683170318604,0.17875893414020538,0.2199234962463379},{-0.2087840735912323,-0.07045681029558182,-0.4053184986114502,0.35007840394973755,0.08551416546106339,0.09172697365283966,0.12733633816242218,0.09004051983356476,-0.351216584444046,0.19817516207695007,-0.4112820029258728,-0.11412768065929413,-0.3291119337081909,0.3529701828956604,-0.30682578682899475,0.0685793086886406},{-0.09717180579900742,-0.4371951222419739,-0.06689009815454483,0.13517268002033234,-0.19824950397014618,-0.07760459184646606,-0.07844763249158859,0.34548118710517883,0.3937509059906006,0.0893847867846489,-0.11662723124027252,-0.24347026646137238,0.19621796905994415,-0.3101122975349426,0.17012648284435272,-0.21447713673114777},{-0.25311246514320374,-0.4730217754840851,-0.1836746484041214,-0.14167803525924683,-0.4744589924812317,0.3248147666454315,-0.07923085987567902,0.1959914118051529,-0.22358371317386627,-0.3216753304004669,-0.2915688455104828,0.38527023792266846,-0.10884718596935272,0.10002479702234268,-0.25314071774482727,0.35743415355682373},{-0.34693971276283264,0.3171423673629761,-0.18775352835655212,0.10539466142654419,-0.3475688099861145,0.09780354797840118,0.06153842806816101,-0.3898681402206421,0.12295333296060562,0.15667656064033508,-0.11428973823785782,0.08829055726528168,0.26313114166259766,-0.19061778485774994,-0.3306008577346802,-0.14063778519630432},{-0.1564580351114273,-0.3640040457248688,-0.5039250254631042,0.303550124168396,0.06314636021852493,0.10457297414541245,-0.24023927748203278,0.18692444264888763,-0.40560978651046753,-0.3012150228023529,-0.38291165232658386,0.251623272895813,-0.25343209505081177,0.22257165610790253,0.09486705809831619,0.34922969341278076}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07088795304298401,-0.08696981519460678,0.16320763528347015,-0.1012866348028183,-0.09463490545749664,0.11806785315275192,0.21182867884635925,-0.2316088229417801,-0.20368103682994843,0.26348748803138733,0.1186942607164383,0.10819244384765625,0.050496656447649,0.12894348800182343,-0.18141187727451324,0.14951607584953308,0.13822555541992188,-0.3031216859817505,-0.18564346432685852,-0.0933566465973854,-0.1491377055644989,0.06560799479484558,-0.1844824254512787,0.33864736557006836,-0.15746687352657318,-0.061767466366291046,0.10967455804347992,0.1974838823080063,-0.11072210222482681,-0.15702883899211884,0.19733020663261414,0.23841945827007294},{0.13986752927303314,-0.07150276750326157,0.1686936616897583,-0.13612860441207886,-0.0816677063703537,0.23733283579349518,0.05729900300502777,-0.04116716980934143,-0.02802954614162445,-0.04335400462150574,-0.09660196304321289,-0.005099776200950146,0.3610551357269287,0.21305423974990845,0.08924196660518646,0.01714426279067993,-0.21628530323505402,-0.250818133354187,0.10728365927934647,0.031730685383081436,0.1002994179725647,0.2882189154624939,0.26315605640411377,-0.1536441594362259,0.0516476035118103,0.2671394646167755,-0.33708351850509644,0.19076332449913025,-0.0014749083202332258,-0.23620407283306122,-0.09311828762292862,-0.016630537807941437},{-0.052659790962934494,-0.08853688091039658,0.2346828132867813,-0.18053476512432098,-0.1311134696006775,0.09659283608198166,-0.1775629222393036,0.22065095603466034,0.1727239489555359,0.029079526662826538,-0.19542942941188812,0.0015614200383424759,0.31984928250312805,-0.28827282786369324,0.11812026798725128,-0.054031852632761,-0.3531610071659088,0.25746816396713257,-0.28283730149269104,-0.05168037861585617,-0.055021464824676514,-0.10381175577640533,-0.010373702272772789,-0.02271522767841816,-0.032774731516838074,0.30926936864852905,-0.10943223536014557,0.09320056438446045,0.1984073370695114,-0.2895015478134155,-0.15247958898544312,-0.029864070937037468},{0.15246067941188812,-0.16468395292758942,0.013697515241801739,-0.34379154443740845,0.06976917386054993,-0.14459151029586792,-0.09884455054998398,0.17548343539237976,0.04411119595170021,0.19108043611049652,0.04676911234855652,-0.09493967890739441,-0.19796635210514069,-0.018247481435537338,0.25223928689956665,-0.1907743364572525,0.0335390605032444,-0.10293463617563248,-0.1418711394071579,0.12343292683362961,-0.15144969522953033,0.12573444843292236,-0.26367324590682983,0.2465173751115799,-0.2288486510515213,0.08086372911930084,-0.060638509690761566,-0.20429416000843048,0.11554059386253357,-0.011054362170398235,0.23477678000926971,-0.14115791022777557},{0.2512088119983673,-0.05682314559817314,0.0075076669454574585,0.24121549725532532,-0.3104732930660248,-0.09428152441978455,0.1732718050479889,-0.02236124314367771,0.14555475115776062,-0.16129475831985474,-0.000560051528736949,-0.07875627279281616,-0.18570570647716522,-0.13189764320850372,0.2737569510936737,0.2245366871356964,-0.035317424684762955,-0.30171945691108704,0.09313109517097473,-0.1313411295413971,-0.13423290848731995,0.22974219918251038,0.22016827762126923,0.022425655275583267,-0.09557650238275528,-0.10345906764268875,0.07258301973342896,0.23834167420864105,0.10597340762615204,0.09118296205997467,0.12299463897943497,-0.21293601393699646},{0.32158607244491577,-0.14876092970371246,0.014024787582457066,0.08314454555511475,-0.09487355500459671,-0.302275687456131,-0.20441122353076935,-0.27752685546875,-0.20555251836776733,0.0292389877140522,-0.02409382350742817,0.008638282306492329,-0.1109248623251915,-0.09364237636327744,-0.19139206409454346,-0.24969379603862762,0.1649966984987259,-0.002890489064157009,-0.2979174852371216,0.19038845598697662,-0.07642769813537598,-0.20141063630580902,0.2261585146188736,-0.14182612299919128,-0.1866714209318161,-0.20652829110622406,-0.12721429765224457,0.0998995304107666,-0.034320250153541565,0.2446669042110443,-0.2483789026737213,0.2169930785894394},{0.1674237698316574,0.10244070738554001,0.23689672350883484,-0.17126823961734772,0.2455470860004425,-0.20490895211696625,-0.2710179388523102,0.021506192162632942,0.2550713121891022,0.10953376442193985,-0.14016936719417572,0.1006203442811966,0.0416126623749733,0.2989340126514435,0.08905842155218124,-0.056620270013809204,-0.16948820650577545,0.10111235827207565,0.008528460748493671,-0.05933305621147156,-0.041581857949495316,0.17255619168281555,0.1683005690574646,0.09901212900876999,-0.23131291568279266,-0.20193064212799072,-0.25108787417411804,-0.29528510570526123,0.11902868747711182,-0.13292856514453888,0.29324445128440857,0.1873989850282669},{0.30232012271881104,-0.3424674868583679,0.082585409283638,-0.40601542592048645,-0.347187340259552,0.27727964520454407,0.3985152542591095,0.1607731282711029,-0.06349938362836838,0.06567943841218948,0.18261639773845673,-0.13127948343753815,0.05636163055896759,0.31797680258750916,-0.0516846626996994,0.20225466787815094,0.39261099696159363,-0.2706148624420166,-0.06410887837409973,-0.36037927865982056,0.2015015035867691,0.22008301317691803,0.19401457905769348,0.13464577496051788,0.12816664576530457,0.1168166995048523,0.15199799835681915,0.25194787979125977,-0.00726691447198391,-0.2847720682621002,0.2296198457479477,0.028008807450532913},{0.07267782837152481,-0.11074042320251465,0.25042933225631714,0.2498328983783722,-0.19024091958999634,-0.25062862038612366,-0.06550435721874237,0.2453383058309555,-0.21721641719341278,-0.13960744440555573,-0.0026268346700817347,0.07166450470685959,0.16793760657310486,-0.33400920033454895,0.17590393126010895,-0.18514013290405273,-0.19443702697753906,0.17774701118469238,-0.2513555884361267,0.2849285304546356,-0.3785246014595032,-0.28090497851371765,-0.30193251371383667,0.26814401149749756,0.07252408564090729,0.0396757647395134,0.29296889901161194,0.19088099896907806,-0.1407141536474228,-0.30080682039260864,-0.16722096502780914,0.16327594220638275},{0.2795138657093048,0.03601035848259926,0.021783649921417236,0.21785376965999603,0.011720019392669201,0.23227225244045258,-0.07762789726257324,0.18797050416469574,-0.015868254005908966,0.034783463925123215,0.15675434470176697,0.11296496540307999,-0.03555931895971298,-0.27747830748558044,0.1680353581905365,0.1668967455625534,-0.010916976258158684,-0.11214327812194824,-0.03534877672791481,0.05820215120911598,0.07334859669208527,-0.2902348041534424,0.31647440791130066,0.06471420079469681,-0.011653922498226166,0.09208980947732925,-0.36556679010391235,-0.21008916199207306,-0.10675331205129623,0.007216147147119045,0.06881187111139297,0.1677071452140808},{-0.07913734763860703,0.10100254416465759,-0.037063755095005035,0.19410215318202972,-0.04755071923136711,0.32520994544029236,0.10950981825590134,-0.06871271878480911,0.23902639746665955,-0.30337274074554443,-0.15821053087711334,0.13942989706993103,-0.08900594711303711,0.047117285430431366,-0.28013700246810913,0.05133979395031929,0.0667819157242775,0.14687278866767883,0.12444640696048737,-0.12138763815164566,-0.2589538097381592,0.16632631421089172,0.2716311514377594,0.22163763642311096,-0.3128145933151245,0.3134251832962036,-0.19344115257263184,0.04151096194982529,-0.10941046476364136,0.15478011965751648,0.19766665995121002,0.24780988693237305},{-0.14274345338344574,0.2359345406293869,-0.11176755279302597,-0.018576333299279213,-0.20176513493061066,-0.1260128617286682,0.15627042949199677,-0.24595272541046143,-0.010076649487018585,-0.1813908964395523,-0.26546958088874817,-0.07218589633703232,0.16255126893520355,-0.3155486285686493,-0.09211515635251999,-0.3651723861694336,-0.1583116203546524,-0.018228838220238686,0.2438695877790451,-0.3236815929412842,0.03578340634703636,-0.10850188881158829,0.03358497843146324,0.29285550117492676,-0.17937535047531128,0.16996295750141144,0.2920319736003876,-0.11760924011468887,-0.05294961854815483,0.29894551634788513,-0.11966359615325928,-0.22000950574874878},{-0.0667891725897789,0.21529920399188995,0.2478763610124588,-0.34090763330459595,0.3055151402950287,0.03706001862883568,-0.12028203159570694,-0.017462801188230515,0.1295519471168518,-0.300277978181839,-0.04188898578286171,0.0079247010871768,0.23978407680988312,0.041649963706731796,0.008251028135418892,-0.03354949131608009,0.23867546021938324,-0.2729117274284363,0.352694034576416,0.11057405173778534,-0.18336701393127441,0.216671422123909,-0.07974882423877716,-0.1902337223291397,0.2542089521884918,-0.1145104467868805,-0.038932979106903076,-0.14711742103099823,-0.021523060277104378,-0.1119304820895195,0.2637813985347748,0.21846722066402435},{0.13678473234176636,-0.16034987568855286,-0.15332087874412537,0.109097920358181,0.11994384974241257,0.28357645869255066,-0.08329778909683228,-0.19585905969142914,0.25290486216545105,0.04493723064661026,0.050185658037662506,0.05534753203392029,-0.24605821073055267,0.04542100429534912,-0.15919475257396698,-0.2384028136730194,0.05845973640680313,-0.05879628658294678,0.2391194850206375,0.30327221751213074,-0.1990198791027069,0.05113542079925537,-0.11431772261857986,-0.008060675114393234,0.05787111446261406,-0.24885593354701996,-0.1412094682455063,-0.1736527532339096,-0.1339835226535797,-0.12050088495016098,0.2632482349872589,-0.2550206482410431},{0.00851831492036581,0.2932986915111542,0.19046014547348022,-0.15322645008563995,-0.0712779238820076,-0.152340829372406,0.15666863322257996,-0.07198425382375717,0.18652303516864777,0.021896425634622574,0.17748652398586273,0.1407712996006012,0.034123651683330536,0.02815934829413891,-0.08160673826932907,0.22898460924625397,-0.22980524599552155,-0.37783539295196533,-0.2247031033039093,0.14543850719928741,0.05845461040735245,-0.2098502665758133,-0.2794726490974426,-0.18733668327331543,-0.2389526218175888,0.012945558875799179,0.3076153099536896,0.007786044385284185,-0.01808939129114151,0.1444753259420395,-0.14144688844680786,0.06238290295004845},{-0.18403784930706024,-0.17468982934951782,-0.2390427142381668,0.06366094201803207,-0.2623162269592285,-0.1070094108581543,-0.10390590131282806,-0.11049295216798782,-0.29989421367645264,-0.16468897461891174,0.08467190712690353,0.16681239008903503,-0.25780680775642395,0.2639208436012268,-0.022788338363170624,0.19867850840091705,0.04424509406089783,0.0022817691788077354,0.03500514477491379,0.11814159154891968,0.1444588601589203,0.3271745443344116,0.09239339083433151,0.21484044194221497,0.10462044924497604,-0.22849005460739136,-0.13478495180606842,0.27381259202957153,0.007779160514473915,-0.2301683872938156,-0.14751692116260529,-0.13231335580348969},{-0.2808745801448822,-0.20315521955490112,-0.3383296728134155,0.0758727416396141,-0.10750845074653625,-0.08031411468982697,-0.12699204683303833,0.08546723425388336,-0.05177786573767662,0.0941103920340538,-0.25811827182769775,0.008870924822986126,0.12918327748775482,-0.06363105028867722,0.04181010276079178,0.2052963525056839,-0.16790638864040375,-0.10013838112354279,0.16913552582263947,0.10256223380565643,0.2094588279724121,-0.008225912228226662,-0.255741149187088,0.05739136412739754,0.16843338310718536,-0.30765974521636963,0.1752973049879074,-0.0019205085700377822,0.05414852127432823,-0.12543514370918274,0.19807521998882294,-0.08064939826726913},{0.2537345588207245,-0.05723457783460617,0.058888476341962814,0.12937891483306885,-0.30420172214508057,-0.007503971923142672,0.159934401512146,0.19519615173339844,-0.07354702055454254,-0.11175556480884552,0.32317018508911133,-0.16573205590248108,-0.001360398018732667,-0.030800746753811836,-0.15526069700717926,0.20655885338783264,0.005143904127180576,-0.04729476198554039,0.11537720263004303,-0.2715613543987274,0.038629595190286636,-0.3104060888290405,-0.2472165822982788,0.25850120186805725,-0.11893847584724426,-0.13621626794338226,0.16769015789031982,-0.020731596276164055,-0.16715727746486664,-0.006104909349232912,-0.09017349779605865,-0.056981269270181656},{0.30268973112106323,-0.02638593129813671,0.052214182913303375,0.0710676982998848,-0.009109157137572765,-0.13313248753547668,0.1318068653345108,-0.2350250482559204,0.22947335243225098,0.26259276270866394,0.011000102385878563,0.18003733456134796,0.23684538900852203,0.3207852840423584,-0.2978496551513672,-0.2788410782814026,-0.3080451786518097,0.009220926091074944,-0.1490214318037033,-0.3115183115005493,-0.18278928101062775,0.27995535731315613,0.06732890754938126,0.11200907826423645,-0.15505915880203247,-0.05788223817944527,-0.13934394717216492,-0.17981237173080444,0.2724813222885132,0.14156074821949005,-0.269255667924881,-0.1274120956659317},{-0.12148836255073547,0.17351199686527252,0.29914194345474243,-0.06153338775038719,-0.006413580384105444,0.05138523131608963,-0.0022328607738018036,-0.31860801577568054,0.18576867878437042,0.22429820895195007,0.20354703068733215,0.20687375962734222,-0.2696753442287445,0.20198014378547668,-0.27214306592941284,0.30925479531288147,0.13784994184970856,-0.24834603071212769,0.27318939566612244,0.1404498815536499,-0.28960928320884705,0.27802908420562744,-0.3077394664287567,0.11535083502531052,0.13617181777954102,0.21417838335037231,0.08825361728668213,0.09540680050849915,-0.2162882536649704,0.2568577229976654,-0.1031222864985466,0.0910385474562645},{-0.1149953305721283,-0.05668853595852852,0.08254601061344147,0.2290765941143036,0.025072481483221054,0.22983351349830627,-0.29883667826652527,-0.1497155725955963,-0.220132514834404,-0.09919514507055283,-0.1759483963251114,-0.14323866367340088,0.05111202225089073,-0.13946305215358734,0.1463363617658615,-0.14722415804862976,0.12235665321350098,-0.01447953563183546,-0.2725571095943451,-0.22726860642433167,0.09401783347129822,0.19421029090881348,-0.13230176270008087,0.33149608969688416,-0.33471569418907166,0.04640835523605347,0.0774097666144371,-0.08684235066175461,-0.00814859289675951,-0.18137268722057343,0.3151877224445343,0.0676860585808754},{0.3527407646179199,0.004276683554053307,0.03776802495121956,0.20606468617916107,-0.1449904888868332,0.22182807326316833,-0.0702311247587204,0.21954290568828583,0.15031397342681885,0.08478964120149612,0.07025551050901413,-0.34560561180114746,-0.2664741575717926,-0.08407951891422272,0.09514176845550537,-0.08612391352653503,0.2706802785396576,0.13677866756916046,-0.18874655663967133,-0.22653134167194366,0.2791218161582947,0.256964772939682,0.27725040912628174,0.10784785449504852,-0.08897460252046585,0.002430359600111842,-0.1074507087469101,-0.17652294039726257,0.04569540545344353,0.04942380636930466,-0.16128285229206085,0.12976804375648499},{-0.025532720610499382,0.026745688170194626,-0.048480238765478134,-0.23951849341392517,-0.10124368965625763,-0.23680326342582703,-0.20989687740802765,-0.17592015862464905,0.0106049794703722,-0.020235197618603706,-0.23864758014678955,0.03529542312026024,-0.24856090545654297,-0.14856894314289093,0.0018549624364823103,0.08027059584856033,0.2645539939403534,-0.16590216755867004,-0.34300634264945984,0.2699969708919525,-0.1426672339439392,0.24037134647369385,-0.02270020917057991,-0.0593087263405323,0.04551504924893379,0.1181870698928833,-0.05788488686084747,-0.27591994404792786,0.19581842422485352,0.26021984219551086,-0.14199021458625793,0.18620535731315613},{-0.26961174607276917,-0.031368229538202286,0.03642997890710831,-0.010104803368449211,0.004961954429745674,0.08951958268880844,-0.1979886293411255,0.07889430969953537,-0.18786552548408508,-0.18449053168296814,0.08803106099367142,-0.1278013437986374,-0.15657272934913635,0.2786087989807129,0.00742596248164773,-0.00736531475558877,0.2050703912973404,-0.23667557537555695,-0.1830601990222931,0.2806662321090698,0.018038500100374222,0.23541004955768585,-0.0142067177221179,0.03732432797551155,-0.20259405672550201,-0.1379479467868805,0.030838362872600555,0.28832826018333435,0.006252267863601446,-0.020823663100600243,0.253499835729599,0.2844862639904022}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10565764456987381,0.062241505831480026,0.2121928632259369,0.023179467767477036},{0.056521542370319366,-0.045037440955638885,0.010053263045847416,0.1353542059659958},{-0.12791374325752258,0.10085170716047287,0.042832475155591965,0.1008257120847702},{0.31593528389930725,0.048983536660671234,0.0887226015329361,0.36558276414871216},{-0.04851486533880234,0.06339288502931595,0.2652161121368408,0.005809495225548744},{-0.13268828392028809,0.18514584004878998,0.16668370366096497,-0.015442661009728909},{-0.21817153692245483,-0.009777834638953209,0.011608647182583809,-0.09439609199762344},{-0.2676156759262085,-0.08439032733440399,0.26220089197158813,-0.24857638776302338},{0.2644243836402893,-0.140633687376976,-0.21855880320072174,-0.3023449182510376},{0.06616001576185226,0.21757012605667114,0.2730615437030792,-0.30236539244651794},{-0.07157199829816818,-0.11038097739219666,-0.12294036895036697,0.10338384658098221},{0.23309899866580963,-0.10472235083580017,0.007308148313313723,0.12242135405540466},{0.21172110736370087,0.26126226782798767,-0.06040596216917038,0.09620009362697601},{-0.0009360079420730472,0.002555151004344225,-0.26403510570526123,0.051854830235242844},{0.10175306349992752,0.22356672585010529,0.2561163604259491,0.21955832839012146},{0.1277313083410263,0.02764388732612133,0.18802666664123535,0.22779306769371033},{-0.21997162699699402,-0.09867638349533081,-0.09762157499790192,-0.18640846014022827},{-0.10407161712646484,0.09533096104860306,-0.08024072647094727,-0.08099337667226791},{-0.26142942905426025,0.13087213039398193,0.12355824559926987,0.28525248169898987},{-0.029484175145626068,0.28594401478767395,-0.13097956776618958,0.14626185595989227},{-0.16922757029533386,-0.27430224418640137,-0.12177788466215134,-0.01488499902188778},{0.2654528021812439,0.27928271889686584,0.0418003611266613,-0.1842178851366043},{0.0003714561462402344,0.14271202683448792,0.15541306138038635,0.13418923318386078},{-0.07753688097000122,0.29439711570739746,-0.01897355541586876,-0.10097867995500565},{0.0038653328083455563,-0.00692130858078599,-0.050756651908159256,-0.01780771277844906},{0.2224346250295639,-0.26919081807136536,-0.053197380155324936,0.024311654269695282},{-0.008569731377065182,-0.27433910965919495,-0.13981612026691437,-0.25352543592453003},{0.1217624619603157,-0.13358403742313385,0.18697622418403625,0.07685886323451996},{0.0005595108377747238,-0.0016983060631901026,0.00011927651212317869,0.00032790497061796486},{-0.3559948205947876,0.3402065634727478,0.18206886947155,0.00032199537963606417},{0.2927958369255066,-0.13343387842178345,0.16487078368663788,-0.0319417379796505},{0.08205807954072952,-0.310560941696167,0.30948784947395325,-0.19794243574142456}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09800083190202713,-0.03648691624403,0.009346398524940014,0.03775113821029663,-0.0653781071305275,-0.10706592351198196,0.05036402493715286,0.02945542149245739,0.0010583964176476002,-0.021160637959837914,-0.04329661652445793,-0.00031961611239239573,0.05917005613446236,0.043466318398714066,-0.09827777743339539,-0.009247452951967716};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.021048234775662422,0.011979064904153347,0.01630152203142643,-0.004750221036374569,0.0053956639021635056,0.02264193445444107,0.02561936527490616,0.023782998323440552,0.010558124631643295,0.03586604818701744,0.03812810778617859,-0.022733520716428757,0.017094863578677177,-0.021656950935721397,-0.05332209914922714,0.01735365018248558};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01913454756140709,0.012079290114343166,0.0010345048503950238,-0.0038993845228105783,0.019548634067177773,0.0015771175967529416,-0.012526441365480423,0.022373534739017487,-0.037517569959163666,-0.0060046459548175335,-0.023648351430892944,-0.002947048982605338,0.00795341283082962,-0.019173165783286095,0.008367719128727913,0.05273006483912468,-0.002482606330886483,-0.03655383735895157,0.01794981211423874,-0.012703736312687397,-0.03460265323519707,0.011438182555139065,0.05623914673924446,0.016552288085222244,-0.006091481540352106,0.030221255496144295,-0.02912447415292263,0.043253518640995026,0.022793613374233246,-0.0025342986918985844,0.015888014808297157,0.023915786296129227};
static const float action_parameterization_distribution_linear_bias[4] = {0.008275161497294903,-0.011405698955059052,0.01465015858411789,0.005378358997404575};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.0378333255648613,0.2960028648376465,-0.10989359021186829,0.1845342218875885,0.07137702405452728,0.03410370647907257,0.6378495097160339,-0.15616708993911743},{-0.13348568975925446,-0.02760830521583557,-0.24966230988502502,-0.21498027443885803,-0.4235718548297882,-0.2674764394760132,0.11384431272745132,-0.28168222308158875},{-0.20073534548282623,0.014076508581638336,0.2769332826137543,0.25350549817085266,0.20674511790275574,-0.04649990051984787,0.4402713477611542,-0.17322026193141937},{0.01417218241840601,0.084081269800663,-0.1145179495215416,0.03392070159316063,-0.02827475592494011,-0.07797005027532578,0.3773324489593506,-0.2545762062072754},{-0.2377321720123291,-0.11576567590236664,-0.17630721628665924,-0.1154114231467247,-0.07218962162733078,0.1638714224100113,0.25410768389701843,-0.08830927312374115},{-0.2992975413799286,-0.029103277251124382,0.49048787355422974,0.26771894097328186,0.12669354677200317,-0.12558820843696594,-0.07988927513360977,-0.18184946477413177},{-0.23346549272537231,0.016624728217720985,0.5377357602119446,-0.16460981965065002,-0.1839558333158493,-0.4304424226284027,-0.06466717272996902,-0.1452207863330841},{-0.27558010816574097,-0.3673509955406189,0.6544702649116516,-0.027518905699253082,-0.2644748389720917,0.2154734581708908,0.21406246721744537,-0.26853275299072266},{-0.3870353400707245,0.2796652317047119,-0.066806361079216,0.4027272164821625,0.053116969764232635,-0.333422988653183,0.049214161932468414,0.09209450334310532},{-0.4455345869064331,-0.348873496055603,-0.12274704873561859,-0.2096065729856491,-0.5422000885009766,0.14902009069919586,-0.017609387636184692,0.17033948004245758},{0.06242240220308304,0.29352641105651855,0.22641000151634216,-0.035485461354255676,0.2097114473581314,0.18706804513931274,-0.19364584982395172,0.25076156854629517},{0.10547062009572983,-0.017225846648216248,0.2391061782836914,0.2193613350391388,-0.291538804769516,0.358096718788147,0.009950323030352592,-0.19990232586860657},{0.045935191214084625,-0.3637903928756714,0.24693360924720764,-0.0837218165397644,-0.3597346842288971,-0.03507516533136368,-0.15699784457683563,-0.11019936949014664},{-0.2827584147453308,-0.28930410742759705,0.3426783084869385,0.32808932662010193,-0.2653582990169525,-0.03975294902920723,-0.2837894856929779,0.22757847607135773},{0.005630263593047857,-0.22893033921718597,0.17284980416297913,-0.23786069452762604,-0.2963733673095703,-0.09976612776517868,0.23108482360839844,0.016568172723054886},{0.13125425577163696,-0.12996701896190643,0.07171901315450668,-0.24208149313926697,0.05004158616065979,0.1051425114274025,0.07457057386636734,0.4153504967689514},{-0.11693211644887924,-0.37015700340270996,-0.12832406163215637,0.12441831082105637,-0.22441275417804718,-0.12833422422409058,-0.11646035313606262,0.13322748243808746},{-0.2535444498062134,-0.33588308095932007,0.05964886397123337,0.029722681269049644,0.09889449924230576,-0.18079011142253876,0.36777037382125854,0.15179646015167236},{-0.0560946986079216,0.1024198904633522,-0.23489433526992798,0.10374754667282104,0.08027846366167068,0.20396247506141663,-0.19402191042900085,0.3319908678531647},{0.05170249566435814,-0.054183170199394226,-0.3384558856487274,0.09279876202344894,-0.09143736213445663,-0.01523657701909542,-0.2736469805240631,-0.015511819161474705},{-0.005641339346766472,-0.17115387320518494,0.09172920137643814,-0.09086821228265762,0.3036211431026459,0.06838614493608475,0.04584856703877449,0.39423370361328125},{-0.07999227195978165,0.0412471666932106,-0.23943506181240082,0.2853356599807739,0.3492755591869354,0.3941662907600403,0.24503742158412933,-0.30487218499183655},{-0.5360755920410156,-0.2243502289056778,0.17066675424575806,-0.09929456561803818,0.2171349823474884,-0.2054445743560791,0.2955446243286133,-0.2660882771015167},{-0.28155431151390076,-0.03350227326154709,-0.0860867127776146,-0.4884403347969055,0.25229859352111816,0.10012448579072952,-0.22386617958545685,0.16274859011173248},{-0.32164454460144043,-0.19914966821670532,-0.04496924579143524,-0.042437903583049774,-0.03189229965209961,0.25216490030288696,0.3412590026855469,-0.14472682774066925},{-0.312590628862381,0.05209103226661682,-0.3918050229549408,-0.36377468705177307,0.17012810707092285,0.0886729434132576,-0.055362895131111145,0.04427783563733101},{0.27606284618377686,0.38141560554504395,-0.3054075539112091,0.1431267112493515,0.2104615718126297,0.42618176341056824,-0.22630828619003296,-0.16978560388088226},{0.32785260677337646,0.24821192026138306,0.03822365775704384,0.03551705181598663,0.28377318382263184,0.2359917312860489,0.3502402901649475,0.3431464731693268},{-0.18356242775917053,0.3730381429195404,0.1380976438522339,-0.03406912460923195,0.235128253698349,0.10512816905975342,-0.2720681130886078,-0.3100394904613495},{-0.2789987027645111,-0.2199496179819107,0.0672142431139946,-0.30254673957824707,-0.3011770248413086,-0.11580189317464828,0.42222893238067627,-0.08936341106891632},{0.30080029368400574,-0.23194845020771027,0.35864853858947754,-0.35017573833465576,-0.0023225760087370872,0.2484228014945984,0.3490731120109558,-0.31665313243865967},{0.12150333821773529,0.4269565939903259,0.43739524483680725,-0.29024913907051086,-0.3383925259113312,0.03818193078041077,0.40639564394950867,-0.04246564581990242}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.006149228196591139,0.4333729147911072,-0.14800682663917542,0.1809261441230774,-0.4401293992996216,0.316204309463501,0.2859639525413513,0.10889071226119995},{-0.5015701055526733,-0.4284723699092865,-0.3596493899822235,-0.44906705617904663,-0.48049265146255493,0.4948229491710663,0.3049178123474121,-0.352108359336853},{0.11353130638599396,-0.13879838585853577,0.13767646253108978,0.19004277884960175,-0.005377586465328932,0.4507969915866852,-0.2644864618778229,-0.5150740742683411},{0.3903198838233948,-0.10326658189296722,0.204312264919281,-0.029941806569695473,0.45512905716896057,0.44642260670661926,0.49120715260505676,0.3915883004665375},{0.09687057137489319,0.16934822499752045,-0.12598532438278198,-0.21003291010856628,0.05868636816740036,-0.3874782621860504,-0.5293321013450623,0.5304796099662781},{0.46002814173698425,0.138419508934021,-0.03069707378745079,-0.32149067521095276,-0.4406316876411438,-0.4904927909374237,-0.08413245528936386,0.4099169075489044},{-0.47293251752853394,-0.3012620508670807,-0.13730654120445251,-0.22833873331546783,0.0036380146630108356,0.5240709185600281,-0.4846113622188568,0.5005940794944763},{0.10696357488632202,0.05059070512652397,0.004445734433829784,0.015627983957529068,0.3055916726589203,-0.4378575086593628,0.2896813452243805,-0.3483809530735016}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07910312712192535,0.02423524297773838,0.05847278982400894,-0.031649358570575714,-0.0629841536283493,0.02110971137881279,0.04427805915474892,-0.02676856890320778};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.01299300417304039,0.023350846022367477,-0.06923801451921463,0.06121248006820679,0.010179013945162296,-0.006225266959518194,0.06270305812358856,-0.0868241935968399};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

