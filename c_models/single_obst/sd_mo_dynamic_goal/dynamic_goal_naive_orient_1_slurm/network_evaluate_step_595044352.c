#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.30880478024482727,0.039036523550748825,0.0542692169547081,0.25711745023727417,0.32578665018081665,-0.23372916877269745,-0.2974506616592407,0.1367245763540268,0.36495256423950195,-0.3014206886291504,0.4686453640460968,0.08867796510457993,0.2589150369167328,0.0993780642747879,-0.3012447953224182,0.014936640858650208},{-0.3381645381450653,-0.20089618861675262,-0.27954691648483276,-0.07392716407775879,0.18768912553787231,0.4082355499267578,0.17408177256584167,-0.011118501424789429,0.18116222321987152,0.23735404014587402,-0.09745553880929947,-0.005449092481285334,-0.10504575073719025,0.11080661416053772,0.2857847213745117,-0.22608065605163574},{-0.03577425330877304,0.21090388298034668,0.2259783148765564,0.31274160742759705,0.05507754907011986,-0.311244934797287,0.8428978323936462,-0.2812172770500183,-0.22927433252334595,0.0007329959189519286,0.0010189934400841594,-0.25340959429740906,0.34885719418525696,0.6374388337135315,-0.5158352255821228,0.1855679601430893},{0.16407868266105652,-0.1643315553665161,-0.14757530391216278,-0.03258749842643738,-0.17377935349941254,0.097892627120018,-0.05169177055358887,-0.22290247678756714,-0.005233094096183777,-0.10589856654405594,0.6014426946640015,-0.22403912246227264,-0.33452484011650085,-0.1993977278470993,0.22227118909358978,-0.06866170465946198},{-0.17824715375900269,-0.0275470819324255,0.17976897954940796,-0.4156501591205597,0.49362027645111084,0.23786014318466187,0.23403283953666687,-0.20924624800682068,-0.18867680430412292,0.29369989037513733,-0.08099190890789032,-0.4386310577392578,0.002990641864016652,-0.22234268486499786,0.4340023100376129,-0.018582172691822052},{-0.02339709922671318,-0.13351471722126007,-0.07264553755521774,-0.08087872713804245,0.08045480400323868,-0.2482837736606598,0.5966861844062805,-0.31202957034111023,-0.22060388326644897,-0.19274269044399261,0.16759032011032104,0.07745233923196793,0.33141934871673584,0.02343275398015976,0.3021783232688904,0.24678461253643036},{-0.13581962883472443,0.2570933997631073,-0.051747363060712814,0.08950206637382507,-0.28445860743522644,-0.10264167189598083,-0.07595154643058777,0.023188164457678795,0.35107818245887756,0.31936389207839966,-0.2988346517086029,-0.1437947303056717,0.25870949029922485,-0.07327073067426682,-0.10691133141517639,0.228563129901886},{-0.3650204539299011,0.1916763037443161,-0.00156557431910187,-0.3018432855606079,0.36396723985671997,-0.2893914580345154,-0.3619953691959381,-0.5206189751625061,-0.07649260759353638,-0.23413026332855225,0.5606204867362976,0.14891837537288666,0.00666464027017355,0.4612002670764923,0.05119762569665909,0.6210857033729553},{0.2947467863559723,0.11360889673233032,-0.2068149447441101,0.04821294918656349,-0.627896785736084,-0.5805312395095825,0.17190581560134888,-0.5831934809684753,-0.05548018589615822,-0.15475121140480042,0.31878751516342163,-0.5906364321708679,-0.517966628074646,0.08974344283342361,0.054105836898088455,-0.3218996822834015},{0.6744247078895569,-0.8355841636657715,-0.38129085302352905,0.13794827461242676,0.18208369612693787,-0.3449638783931732,-0.016245394945144653,-0.23002184927463531,-0.40314826369285583,-0.02839510142803192,-0.3142661154270172,-0.3372255265712738,0.592802107334137,-0.3089297413825989,-0.7243301272392273,-0.2968182861804962},{0.31223955750465393,0.32638460397720337,-0.1405705362558365,0.06897185742855072,0.06719227135181427,-0.18958981335163116,-0.11462385952472687,0.14806795120239258,-0.03227083384990692,0.23560456931591034,0.18449997901916504,0.2269928753376007,-0.14010152220726013,0.15614774823188782,0.03707249090075493,-0.34994322061538696},{-0.4604767858982086,0.2911882698535919,0.5857393145561218,-0.9003163576126099,0.12203289568424225,0.14805839955806732,0.1418602168560028,0.33437100052833557,0.3397817015647888,0.44955167174339294,0.4858529567718506,-0.3748680353164673,0.331294447183609,-0.20988142490386963,0.06912564486265182,-0.21342970430850983},{0.12754198908805847,-0.2662929594516754,-0.2695888876914978,0.32408908009529114,-0.22542913258075714,-0.2839631140232086,-0.0905444473028183,0.331263929605484,0.26233819127082825,-0.15309153497219086,-0.2667391300201416,0.2989383637905121,0.36050841212272644,0.3251078426837921,-0.19096943736076355,0.626886248588562},{0.2626071870326996,0.29405921697616577,-0.31264960765838623,0.07998287677764893,-0.08240548521280289,-0.14663012325763702,-0.2606853246688843,0.18012495338916779,-0.2802761495113373,-0.3689657747745514,-0.0702337920665741,0.11955971270799637,-0.6064645051956177,-0.07872780412435532,-0.2686862647533417,-0.14889100193977356},{0.14685262739658356,0.5868232846260071,0.4074738025665283,-0.445389986038208,-0.35462307929992676,0.2558130919933319,-0.08668749779462814,0.03576726093888283,0.5254470109939575,0.3129507899284363,-0.21117350459098816,0.1436031609773636,-0.21506871283054352,-0.34963375329971313,0.18928465247154236,-0.3413197696208954},{-0.3066911995410919,-0.05521512031555176,-0.03945993632078171,0.23027518391609192,-0.02440737746655941,0.026823757216334343,-0.14292658865451813,-0.023700660094618797,-0.37109318375587463,-0.08769962936639786,0.2671218812465668,0.09331061691045761,-0.19118492305278778,-0.22273705899715424,-0.3981409966945648,-0.09654541313648224},{-0.2853419780731201,0.15429341793060303,-0.2058521807193756,-0.00872001238167286,-0.13403697311878204,0.32387709617614746,0.3231842517852783,0.15012846887111664,0.22061865031719208,-0.2437654733657837,-0.054456837475299835,-0.11030957102775574,-0.022345280274748802,0.04459146037697792,-0.022574130445718765,-0.1491328924894333},{0.11074377596378326,-0.4614700973033905,0.1488480567932129,0.1785544753074646,-0.00023021636297926307,0.28875330090522766,0.33513832092285156,0.1273001730442047,-0.13161876797676086,-0.2694205045700073,-0.1198057010769844,-0.11424680799245834,-0.127910315990448,-0.3908291757106781,0.09347394853830338,0.015269167721271515}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14720459282398224,0.31159508228302,0.3446880578994751,-0.09046880155801773,-0.19153852760791779,0.06888465583324432,0.06830443441867828,0.2566030025482178,-0.06578708440065384,0.2964988946914673,0.47664958238601685,-0.36624160408973694,-0.127300426363945,0.06517460197210312,0.006945805158466101,-0.03480956703424454},{-0.5405674576759338,0.22416920959949493,-0.3059302270412445,0.2672494053840637,0.34968507289886475,-0.14594677090644836,-0.3447173237800598,-0.2705131769180298,0.28264254331588745,0.31092172861099243,-0.09325247257947922,0.22974438965320587,-0.3265289068222046,0.161742702126503,-0.27166205644607544,0.4346078634262085},{-0.4062143862247467,0.19185729324817657,-0.36246952414512634,0.026820456609129906,-0.4077025353908539,-0.3056015968322754,-0.11061525344848633,0.0232144333422184,-0.2315463423728943,0.3507452607154846,0.2070760726928711,-0.0693540945649147,0.24290865659713745,-0.34842604398727417,-0.05112170800566673,0.030296480283141136},{0.23417390882968903,-0.2200220376253128,0.08401697874069214,0.4424622356891632,-0.4546926021575928,-0.3396008312702179,0.26923251152038574,0.1160292848944664,0.3102574944496155,-0.08115429431200027,0.30411791801452637,0.10359326750040054,-0.26025259494781494,-0.04119279235601425,-0.017443766817450523,-0.34618639945983887},{-0.3530718982219696,0.006082136183977127,0.24126958847045898,-0.3641946315765381,0.14139513671398163,0.30694660544395447,-0.3208972215652466,0.2540088891983032,-0.21502511203289032,0.19046778976917267,-0.12861287593841553,-0.01058873999863863,-0.14017564058303833,-0.00944637693464756,-0.1982053518295288,-0.20549514889717102},{0.006856006104499102,-0.21820786595344543,-0.023499710485339165,-0.364762544631958,0.2958773374557495,0.08204426616430283,-0.02007184736430645,-0.09483720362186432,-0.2055312693119049,0.3587702512741089,0.30938950181007385,-0.08255378901958466,-0.16298361122608185,0.24511529505252838,-0.05834624916315079,-0.3638306260108948},{0.22338947653770447,-0.14931251108646393,0.302147775888443,-0.2944319248199463,-0.3723304569721222,-0.04569365456700325,-0.38079649209976196,0.34233003854751587,-0.12863118946552277,-0.24810245633125305,-0.26914551854133606,-0.027319056913256645,-0.0528276152908802,-0.07816052436828613,0.46862179040908813,-0.3898444175720215},{-0.29697757959365845,0.3894204795360565,-0.05267107114195824,0.2529434263706207,0.015489157289266586,-0.2453875094652176,-0.0972435474395752,0.09620977938175201,-0.03712214529514313,0.48625922203063965,0.1660536825656891,-0.2130582332611084,0.03641316294670105,-0.07716935127973557,0.06838023662567139,0.18310149013996124},{0.14532315731048584,0.27962008118629456,-0.1588113009929657,-0.3468610346317291,0.3877471089363098,-0.21108509600162506,0.2437145859003067,-0.35865411162376404,0.08900385349988937,0.03090066835284233,0.13946647942066193,0.1030927449464798,-0.02388346754014492,-0.2715144455432892,-0.09365758299827576,0.21672721207141876},{-0.2046002596616745,-0.005492625292390585,-0.28958243131637573,-0.34240084886550903,0.23977938294410706,-0.45463359355926514,-0.21256011724472046,0.25104448199272156,-0.11454148590564728,0.19583041965961456,-0.016565479338169098,-0.07089979946613312,-0.3712838292121887,-0.01251972746104002,-0.2238299399614334,-0.35610905289649963},{-0.26385369896888733,-0.10231748223304749,-0.1004328578710556,-0.34889936447143555,-0.3279385566711426,-0.0014100124826654792,0.1274166703224182,-0.483527809381485,0.018619529902935028,-0.045750971883535385,0.1475071758031845,-0.0012025185860693455,0.4127558767795563,0.03315248712897301,0.21873661875724792,0.23451481759548187},{-0.2311941236257553,-0.05379817262291908,-0.4406038224697113,0.3562264144420624,0.12469884753227234,0.012632296420633793,0.15133926272392273,0.07492871582508087,-0.38624849915504456,0.2199486941099167,-0.36235612630844116,-0.1373514086008072,-0.3728489875793457,0.4031820297241211,-0.34195464849472046,0.1056622639298439},{-0.13874055445194244,-0.45285969972610474,-0.09582147747278214,0.15700630843639374,-0.19392362236976624,-0.10486030578613281,-0.07998494803905487,0.3823135793209076,0.42422229051589966,0.0935661792755127,-0.09629075229167938,-0.263366162776947,0.16440045833587646,-0.36289167404174805,0.154892235994339,-0.2124941498041153},{-0.25567150115966797,-0.47440966963768005,-0.1750490814447403,-0.11581724137067795,-0.4622288942337036,0.3584093153476715,-0.06987283378839493,0.20017197728157043,-0.19507110118865967,-0.3269616365432739,-0.29832908511161804,0.39611077308654785,-0.1922369748353958,0.07160360366106033,-0.27290722727775574,0.3695792555809021},{-0.32616227865219116,0.3340699076652527,-0.16790659725666046,0.10339962691068649,-0.35885369777679443,0.19624505937099457,0.04999624937772751,-0.37361812591552734,0.09808632731437683,0.1652950793504715,-0.14992904663085938,0.07980772852897644,0.2710469365119934,-0.22943192720413208,-0.34085896611213684,-0.16595539450645447},{-0.15841086208820343,-0.36303895711898804,-0.5228285789489746,0.2880338430404663,0.044201597571372986,0.12376467883586884,-0.2508338689804077,0.19743075966835022,-0.4197402596473694,-0.3157561719417572,-0.3891867697238922,0.24115417897701263,-0.22436076402664185,0.19288134574890137,0.09013582766056061,0.3439992070198059}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.05638246238231659,-0.10902398824691772,0.13210105895996094,-0.10977350920438766,-0.08821216225624084,0.12420661747455597,0.1784507930278778,-0.24193446338176727,-0.16864663362503052,0.2936328947544098,0.08552971482276917,0.12344484776258469,0.09065330028533936,0.13866908848285675,-0.1765909492969513,0.1435128003358841,0.11481628566980362,-0.2991960048675537,-0.2314668744802475,-0.07481325417757034,-0.18417100608348846,0.1150047555565834,-0.19810983538627625,0.3590867221355438,-0.18778210878372192,-0.04084001109004021,0.10591171681880951,0.17790377140045166,-0.25123274326324463,-0.17582246661186218,0.2373022884130478,0.2621625065803528},{0.15873517096042633,-0.0644022673368454,0.16334596276283264,-0.0926566943526268,-0.08971695601940155,0.2288864403963089,0.023055171594023705,-0.06432963907718658,-0.03153873607516289,-0.04459836333990097,-0.10749299824237823,0.005565543193370104,0.3859235644340515,0.21212491393089294,0.10983405262231827,0.03887942060828209,-0.24093039333820343,-0.2730073034763336,0.11218951642513275,0.043077535927295685,0.08165960758924484,0.2981416583061218,0.27168408036231995,-0.15026894211769104,0.04990648478269577,0.27901768684387207,-0.35700342059135437,0.19532662630081177,0.0746963769197464,-0.23918764293193817,-0.08892003446817398,-0.028950486332178116},{-0.0560762882232666,-0.0838325023651123,0.20180800557136536,-0.17956484854221344,-0.1521880030632019,0.06947823613882065,-0.2124313861131668,0.20619326829910278,0.20816569030284882,0.02633746899664402,-0.21221201121807098,0.031123271211981773,0.3325875997543335,-0.2659439742565155,0.10442998260259628,-0.061206817626953125,-0.3655034899711609,0.25576773285865784,-0.3373546302318573,-0.0464286282658577,-0.06438840180635452,-0.08709289133548737,-0.05655081197619438,-0.036995597183704376,-0.047265246510505676,0.35508713126182556,-0.07820429652929306,0.08568478375673294,0.2379274219274521,-0.3278023898601532,-0.12583200633525848,-0.003047490492463112},{0.14615023136138916,-0.22674207389354706,0.007244208361953497,-0.3807867765426636,0.07646311819553375,-0.12010925263166428,-0.061824824661016464,0.19137334823608398,0.05710135027766228,0.2149282991886139,0.04287782683968544,-0.13064484298229218,-0.20085252821445465,-0.024443643167614937,0.23925349116325378,-0.22287584841251373,0.05544355884194374,-0.06710736453533173,-0.1550629884004593,0.12508806586265564,-0.15792080760002136,0.14804604649543762,-0.25880229473114014,0.292366623878479,-0.2428322434425354,0.043811943382024765,-0.05850252881646156,-0.23959510028362274,0.0683787390589714,0.01653187721967697,0.22498759627342224,-0.15161772072315216},{0.2612016797065735,-0.04257326200604439,0.006738557480275631,0.25836655497550964,-0.30504778027534485,-0.0957970842719078,0.16919733583927155,-0.017284076660871506,0.13297510147094727,-0.18126548826694489,0.007653987500816584,-0.07249688357114792,-0.20365969836711884,-0.13603337109088898,0.2776453495025635,0.24541497230529785,-0.044685281813144684,-0.33544573187828064,0.11132948100566864,-0.13912369310855865,-0.12644356489181519,0.22432279586791992,0.23770704865455627,0.00467001274228096,-0.10199115425348282,-0.09138865768909454,0.05071604624390602,0.25194883346557617,0.23131005465984344,0.08305685967206955,0.13702772557735443,-0.2143012136220932},{0.3067287802696228,-0.16125765442848206,0.01681818626821041,0.07591406255960464,-0.11738467961549759,-0.3084838390350342,-0.2167259007692337,-0.29707735776901245,-0.18628358840942383,0.04190756753087044,-0.03781904652714729,0.0015587721718475223,-0.09916160255670547,-0.08018142729997635,-0.202993705868721,-0.2815645635128021,0.1690123975276947,0.022389594465494156,-0.3186101019382477,0.20432953536510468,-0.08364330977201462,-0.1872391253709793,0.20369203388690948,-0.138993039727211,-0.16275730729103088,-0.22991755604743958,-0.11803445219993591,0.07700826227664948,0.0830022394657135,0.2409549504518509,-0.26892343163490295,0.1934557855129242},{0.17851325869560242,0.08392739295959473,0.22427760064601898,-0.15423309803009033,0.24349980056285858,-0.20422811806201935,-0.29560548067092896,-0.007841230370104313,0.2799976170063019,0.12481806427240372,-0.15628989040851593,0.12461940199136734,0.06679320335388184,0.3067276179790497,0.09949364513158798,-0.05331198126077652,-0.19783739745616913,0.11277113109827042,-0.012877906672656536,-0.05179605260491371,-0.073722705245018,0.20415742695331573,0.1731029897928238,0.12048836797475815,-0.26579549908638,-0.21155324578285217,-0.2611014246940613,-0.31900522112846375,0.1093243882060051,-0.13628238439559937,0.3207007944583893,0.1681753396987915},{0.32004761695861816,-0.3629915416240692,0.0764491930603981,-0.41577771306037903,-0.32664838433265686,0.2951413691043854,0.404786616563797,0.18560777604579926,-0.07474817335605621,0.09449291229248047,0.17144925892353058,-0.1370837390422821,0.06120982766151428,0.3007505536079407,-0.03515922650694847,0.20883148908615112,0.39445069432258606,-0.26368317008018494,-0.06568025797605515,-0.3748316764831543,0.19037868082523346,0.22818322479724884,0.2009066492319107,0.14422793686389923,0.13112136721611023,0.11828982084989548,0.16136810183525085,0.27185195684432983,-0.11047393828630447,-0.2720399498939514,0.2453521192073822,0.05968526378273964},{0.0664045512676239,-0.11407012492418289,0.21776846051216125,0.25894150137901306,-0.19847701489925385,-0.2795276343822479,-0.06841704249382019,0.24710732698440552,-0.19079093635082245,-0.1706220656633377,0.008670556358993053,0.09720748662948608,0.14929088950157166,-0.3237932622432709,0.15814410150051117,-0.18053920567035675,-0.20236393809318542,0.17053118348121643,-0.28091946244239807,0.2731679379940033,-0.3645123839378357,-0.28264090418815613,-0.31982898712158203,0.26317140460014343,0.07880812138319016,0.06919115036725998,0.3201445937156677,0.19995512068271637,-0.16121266782283783,-0.3168571889400482,-0.14985127747058868,0.17416220903396606},{0.3098476529121399,0.05359514057636261,0.023369506001472473,0.24696992337703705,0.02516902983188629,0.23517850041389465,-0.06741062551736832,0.211862713098526,-0.04791183024644852,0.021745583042502403,0.16366906464099884,0.12241602689027786,-0.07374405115842819,-0.29951342940330505,0.18215274810791016,0.2064749300479889,-0.014416787773370743,-0.15617021918296814,-0.011845809407532215,0.02709605172276497,0.08489731699228287,-0.316068559885025,0.3502384424209595,0.03952920064330101,-0.04392927139997482,0.11277669668197632,-0.37957727909088135,-0.17940524220466614,-0.0040336851961910725,0.009729261510074139,0.08283976465463638,0.19400575757026672},{-0.07897724956274033,0.09390026330947876,-0.05369098111987114,0.20284496247768402,-0.0636453852057457,0.3145968019962311,0.09761237353086472,-0.08159192651510239,0.2525478005409241,-0.3031522035598755,-0.16606174409389496,0.14942817389965057,-0.085989810526371,0.06346152722835541,-0.2837728261947632,0.048112910240888596,0.063131183385849,0.15421344339847565,0.09994873404502869,-0.11595385521650314,-0.268481582403183,0.17200833559036255,0.257865846157074,0.22905035316944122,-0.34201547503471375,0.3319840431213379,-0.17889676988124847,0.01903590001165867,-0.10886412858963013,0.1484818011522293,0.20227494835853577,0.2512536346912384},{-0.17955952882766724,0.257003515958786,-0.09688594192266464,-0.021992580965161324,-0.2241993546485901,-0.1471630483865738,0.1488288789987564,-0.27752313017845154,0.0022627157159149647,-0.20542791485786438,-0.24622678756713867,-0.07084184885025024,0.17595303058624268,-0.293944388628006,-0.10984531790018082,-0.3846009373664856,-0.15479512512683868,-0.00766067486256361,0.2610565721988678,-0.2990870177745819,0.04989169165492058,-0.11934242397546768,0.0167044997215271,0.2901040315628052,-0.14302952587604523,0.1477869600057602,0.2961944043636322,-0.128511443734169,-0.07140789926052094,0.2918722629547119,-0.1525263637304306,-0.27291885018348694},{-0.05342991650104523,0.23194842040538788,0.24603484570980072,-0.34505337476730347,0.3218540847301483,0.030843695625662804,-0.10981899499893188,0.0022932393476366997,0.13168130815029144,-0.29013144969940186,-0.04985106736421585,0.019860465079545975,0.2141888290643692,0.021458331495523453,0.007360085844993591,-0.03245758265256882,0.23976609110832214,-0.287472665309906,0.3365389108657837,0.08087726682424545,-0.17242957651615143,0.19942885637283325,-0.09317254275083542,-0.21281374990940094,0.24509529769420624,-0.09343554824590683,-0.025599107146263123,-0.12222674489021301,0.0315263494849205,-0.11806046962738037,0.28904780745506287,0.26172006130218506},{0.09530313313007355,-0.19480296969413757,-0.172324076294899,0.08973291516304016,0.07162734121084213,0.2800711691379547,-0.10877948254346848,-0.25120043754577637,0.2918984889984131,0.03995159640908241,0.05334768071770668,0.04340916872024536,-0.20890365540981293,0.0956805869936943,-0.18947355449199677,-0.2830418646335602,0.0629868432879448,-0.02350195124745369,0.20949089527130127,0.3538947105407715,-0.2179345041513443,0.09552595019340515,-0.1318540871143341,0.026949338614940643,0.06906798481941223,-0.2791634202003479,-0.1491379290819168,-0.2492797076702118,-0.05315665528178215,-0.13759511709213257,0.23899902403354645,-0.3187660276889801},{-0.03977044299244881,0.31626519560813904,0.17291538417339325,-0.17788740992546082,-0.10472189635038376,-0.1833290308713913,0.15721194446086884,-0.08760996162891388,0.20368151366710663,-0.027143750339746475,0.22127804160118103,0.1584823876619339,0.02197292633354664,0.07049226015806198,-0.12193930149078369,0.2056167870759964,-0.20879346132278442,-0.37760064005851746,-0.2542489469051361,0.1565510630607605,0.09625081717967987,-0.2442917376756668,-0.31622862815856934,-0.20639516413211823,-0.22792881727218628,0.05166289582848549,0.33901745080947876,-0.008470909669995308,-0.12420598417520523,0.11336041241884232,-0.15951134264469147,0.07784245908260345},{-0.20707744359970093,-0.18997105956077576,-0.2512614130973816,0.06368514895439148,-0.2820565104484558,-0.13251346349716187,-0.10520347952842712,-0.1293633133172989,-0.2792671322822571,-0.1811380833387375,0.10311732441186905,0.17685796320438385,-0.2630167305469513,0.2764822840690613,-0.03922965005040169,0.1813337504863739,0.04815000295639038,0.013605093583464622,0.024157214909791946,0.11194281280040741,0.1538778692483902,0.32123520970344543,0.08358125388622284,0.22383050620555878,0.12390191853046417,-0.24069836735725403,-0.11503789573907852,0.2579781413078308,0.005090848542749882,-0.23009082674980164,-0.15903115272521973,-0.1634826809167862},{-0.3280646502971649,-0.21973557770252228,-0.3853655457496643,0.07654692232608795,-0.16368761658668518,-0.10765183717012405,-0.1502009928226471,0.0444159135222435,-0.010365341790020466,0.07728424668312073,-0.24413764476776123,0.014143705368041992,0.16374200582504272,-0.016816500574350357,0.008060176856815815,0.1655793935060501,-0.15549327433109283,-0.07233056426048279,0.14063970744609833,0.12272753566503525,0.214072585105896,0.013257068581879139,-0.28712356090545654,0.07667610794305801,0.2413794994354248,-0.29810360074043274,0.18737910687923431,-0.024996967986226082,0.03743138909339905,-0.15632186830043793,0.18950533866882324,-0.1175556629896164},{0.26579588651657104,-0.04994794353842735,0.05425900220870972,0.12452001869678497,-0.2959064841270447,-0.008011908270418644,0.1535724252462387,0.2074507474899292,-0.0824853852391243,-0.11092178523540497,0.31147706508636475,-0.173355370759964,-0.016383662819862366,-0.051003534346818924,-0.1501975655555725,0.22245731949806213,0.01095205545425415,-0.06708856672048569,0.11909300833940506,-0.27687880396842957,0.037829723209142685,-0.3085639178752899,-0.24167770147323608,0.2558469772338867,-0.13568240404129028,-0.1293884664773941,0.1691603660583496,-0.011777274310588837,-0.16662539541721344,-0.004723984282463789,-0.09430187940597534,-0.0382072776556015},{0.2955629229545593,-0.04382338747382164,0.06540150195360184,0.06961334496736526,-0.012250270694494247,-0.11826647073030472,0.15046462416648865,-0.2360222190618515,0.22983166575431824,0.2739450931549072,0.013078171759843826,0.17029713094234467,0.25501981377601624,0.33288344740867615,-0.2996060252189636,-0.2989515960216522,-0.3063947260379791,0.03908160328865051,-0.14295512437820435,-0.301660418510437,-0.18615050613880157,0.28471672534942627,0.06788758188486099,0.12758687138557434,-0.13302437961101532,-0.07762562483549118,-0.1470029503107071,-0.1903720498085022,0.2602168023586273,0.1532275378704071,-0.27508309483528137,-0.1478138118982315},{-0.10678917914628983,0.1743883639574051,0.2972923517227173,-0.046185318380594254,-0.010378962382674217,0.054980624467134476,-0.014728388749063015,-0.31787192821502686,0.1937956064939499,0.24375800788402557,0.18307499587535858,0.21584367752075195,-0.2564448118209839,0.19366247951984406,-0.2696516215801239,0.30787646770477295,0.13436177372932434,-0.25031137466430664,0.2653254568576813,0.1354249268770218,-0.29721057415008545,0.29236701130867004,-0.30993786454200745,0.11571772396564484,0.16940094530582428,0.22184589505195618,0.08834990113973618,0.10851454734802246,-0.2142193764448166,0.2482350617647171,-0.09211792796850204,0.10119583457708359},{-0.13704374432563782,-0.05581001192331314,0.048247285187244415,0.2432929277420044,-0.017497722059488297,0.20406857132911682,-0.3432473838329315,-0.18869554996490479,-0.19006076455116272,-0.10801535844802856,-0.18365442752838135,-0.13422662019729614,0.08585833758115768,-0.10524351894855499,0.13089843094348907,-0.16013343632221222,0.12544965744018555,-0.008433427661657333,-0.2946043312549591,-0.20545722544193268,0.08662065118551254,0.21370255947113037,-0.1587097942829132,0.33940407633781433,-0.2898614704608917,0.06264436990022659,0.08264876902103424,-0.09693681448698044,0.06281735748052597,-0.21680116653442383,0.31685248017311096,0.043765295296907425},{0.35957905650138855,-0.05864035338163376,0.06126970052719116,0.15626905858516693,-0.14097647368907928,0.2473638653755188,-0.0274719949811697,0.25179487466812134,0.16137972474098206,0.12629951536655426,0.032051101326942444,-0.40519577264785767,-0.27201324701309204,-0.08165999501943588,0.08411937952041626,-0.12990574538707733,0.3128628730773926,0.20092225074768066,-0.20696842670440674,-0.21343085169792175,0.27047863602638245,0.2864396572113037,0.26155364513397217,0.1454649418592453,-0.07900039851665497,-0.035054028034210205,-0.0954267680644989,-0.22327016294002533,0.18754461407661438,0.08351100981235504,-0.20238584280014038,0.12269628047943115},{-0.01883610524237156,0.02241416834294796,-0.06118566915392876,-0.2454700917005539,-0.10681890696287155,-0.24272292852401733,-0.2290486991405487,-0.17917849123477936,0.01761341281235218,-0.014975875616073608,-0.26032277941703796,0.026388181373476982,-0.24782906472682953,-0.15362480282783508,0.0018576011061668396,0.08476854115724564,0.2706422209739685,-0.17150485515594482,-0.35622286796569824,0.27814799547195435,-0.15340471267700195,0.2601803243160248,-0.025753865018486977,-0.049591802060604095,0.042334116995334625,0.12235742062330246,-0.05433665215969086,-0.2850123345851898,0.21743126213550568,0.2571243643760681,-0.15239131450653076,0.19182100892066956},{-0.2798198163509369,-0.004876084625720978,0.045928146690130234,-0.0047176070511341095,0.019443536177277565,0.08502808213233948,-0.1839134842157364,0.09625225514173508,-0.20926310122013092,-0.2145753651857376,0.12816807627677917,-0.11411783844232559,-0.17688241600990295,0.26914092898368835,0.014274436049163342,0.011704555712640285,0.19587980210781097,-0.2617669403553009,-0.1560409516096115,0.25939080119132996,0.04025529325008392,0.19928452372550964,-0.002643271116539836,0.007798792794346809,-0.24634507298469543,-0.1253887265920639,0.02243882045149803,0.3188207745552063,0.02358248084783554,-0.023516464978456497,0.2811788320541382,0.29547134041786194}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.09356244653463364,0.138670414686203,0.3438109755516052,-0.03669625520706177},{0.05974207818508148,-0.09918256103992462,0.03737756982445717,0.2162572294473648},{-0.12806905806064606,0.12487033754587173,0.10875680297613144,0.121906578540802},{0.33532580733299255,0.043691180646419525,0.0815567672252655,0.4405485689640045},{-0.05438113212585449,0.07494798302650452,0.30439457297325134,0.014911865815520287},{-0.143705353140831,0.23028907179832458,0.22001488506793976,-0.017888285219669342},{-0.29117611050605774,-0.025490256026387215,0.050238236784935,-0.09628275781869888},{-0.3410964906215668,-0.12468703091144562,0.348428875207901,-0.28026068210601807},{0.2889319360256195,-0.14342045783996582,-0.2563544809818268,-0.36659005284309387},{0.0714748352766037,0.2876092195510864,0.3021262288093567,-0.3725023865699768},{-0.14784102141857147,-0.18084938824176788,-0.11890527606010437,0.13989031314849854},{0.3374425768852234,-0.15407925844192505,-0.01971227116882801,0.18463701009750366},{0.2467169165611267,0.2822664678096771,-0.06353407353162766,0.12208776921033859},{-0.0002460753603372723,0.014774903655052185,-0.288419246673584,0.062075402587652206},{0.10132263600826263,0.2509765326976776,0.31930720806121826,0.2535865604877472},{0.15386298298835754,0.0030107710044831038,0.2480698823928833,0.2771495282649994},{-0.24923990666866302,-0.10025836527347565,-0.09029407054185867,-0.23555541038513184},{-0.13457246124744415,0.13713254034519196,-0.10858721286058426,-0.11315841227769852},{-0.3059285879135132,0.13763897120952606,0.15731750428676605,0.34497466683387756},{-0.02982601337134838,0.308824360370636,-0.1666649580001831,0.16117264330387115},{-0.23784808814525604,-0.34144461154937744,-0.1339023858308792,0.001965396571904421},{0.3300262987613678,0.3865247368812561,0.017049917951226234,-0.2675633132457733},{-0.0028977186884731054,0.16462229192256927,0.20813219249248505,0.17163820564746857},{-0.06648112833499908,0.38367316126823425,-0.0559907890856266,-0.16515439748764038},{0.004428119398653507,-0.0563790388405323,-0.08880002796649933,-0.023157067596912384},{0.2695635259151459,-0.3391961455345154,-0.0356769897043705,0.030453795567154884},{-0.02504001371562481,-0.32990437746047974,-0.16814763844013214,-0.2724037766456604},{0.13748015463352203,-0.1822095662355423,0.22332793474197388,0.12021052092313766},{0.012741304002702236,-0.02560959756374359,0.009736329317092896,-0.009411728009581566},{-0.3986644148826599,0.3699096441268921,0.20412024855613708,-0.0017554748337715864},{0.3456929624080658,-0.1528742015361786,0.18770073354244232,-0.037401486188173294},{0.11209278553724289,-0.354068785905838,0.37211301922798157,-0.22708967328071594}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.08907614648342133,-0.03311162069439888,0.022234801203012466,0.0464448556303978,-0.07902252674102783,-0.11077996343374252,0.036285437643527985,0.04309915378689766,0.032565176486968994,-0.019186777994036674,-0.04695466160774231,-0.006711327936500311,0.05901240557432175,0.02492150105535984,-0.09470800310373306,-0.00946246087551117};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.029179519042372704,0.0021572010591626167,0.00502863759174943,0.007551558315753937,0.00629435945302248,-0.015086762607097626,0.028241794556379318,0.03313811495900154,0.014507219195365906,0.027886465191841125,0.031248455867171288,-0.006086417008191347,0.05176769942045212,-0.03245377913117409,-0.04686165973544121,0.010940141044557095};
static const float actor_encoder_feed_forward_0_bias[32] = {0.004698027856647968,0.011480556800961494,0.010575000196695328,-0.002743890043348074,0.01697794906795025,0.004058200400322676,0.007733358535915613,0.021477393805980682,-0.03917309641838074,-0.013755613006651402,0.00010412987467134371,0.001734370132908225,0.00879460759460926,-0.005032997112721205,0.0018041696166619658,0.039654508233070374,-0.001967341173440218,-0.023158391937613487,0.027189206331968307,-0.01634908840060234,-0.021538574248552322,-0.0075551425106823444,0.05256287753582001,0.010247304104268551,0.0057388003915548325,0.024636534973978996,-0.029083533212542534,0.04315123334527016,0.0057481639087200165,-0.0010312095982953906,0.01913633570075035,0.0120224105194211};
static const float action_parameterization_distribution_linear_bias[4] = {-0.006475962232798338,-0.015020693652331829,0.0047674053348600864,0.010269839316606522};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.03953113779425621,0.27611348032951355,-0.14427156746387482,0.1873875856399536,0.10185118019580841,0.05008227378129959,0.48563486337661743,-0.10339046269655228},{-0.20674161612987518,-0.029426541179418564,-0.2708802819252014,-0.21190446615219116,-0.3979911804199219,-0.25888001918792725,0.033690545707941055,-0.259974867105484},{-0.2660163938999176,0.016143757849931717,0.26446953415870667,0.26632124185562134,0.2232627272605896,-0.0487842932343483,0.39929136633872986,-0.16716794669628143},{-0.009701752103865147,0.08676087111234665,-0.13289956748485565,0.03989114984869957,-0.01174030639231205,-0.08053012192249298,0.3659556806087494,-0.24727195501327515},{-0.29115182161331177,-0.12634141743183136,-0.18902111053466797,-0.10059002041816711,-0.054902441799640656,0.15710388123989105,0.2373598963022232,-0.0767216607928276},{-0.34193363785743713,-0.038609329611063004,0.4547812342643738,0.2726133465766907,0.15204116702079773,-0.12746205925941467,-0.09238176047801971,-0.16331569850444794},{-0.2730681598186493,0.005009572021663189,0.5100473761558533,-0.15989041328430176,-0.15833452343940735,-0.43688011169433594,-0.06818246096372604,-0.12245604395866394},{-0.29406440258026123,-0.3714049458503723,0.610171914100647,-0.041641317307949066,-0.21593333780765533,0.22401511669158936,0.20452822744846344,-0.24188819527626038},{-0.3992261290550232,0.2825418710708618,-0.07107731699943542,0.39363613724708557,0.08882934600114822,-0.3253614008426666,0.02529011107981205,0.11583878099918365},{-0.4548979699611664,-0.3352523744106293,-0.09037157893180847,-0.19999441504478455,-0.5341026186943054,0.13436086475849152,-0.037663593888282776,0.17346249520778656},{0.022820979356765747,0.3148840069770813,0.26778629422187805,-0.013352995738387108,0.1997142881155014,0.15411750972270966,-0.20461320877075195,0.24130496382713318},{0.08308301866054535,0.010636803694069386,0.27866992354393005,0.24062682688236237,-0.3042524755001068,0.32477226853370667,0.002693174872547388,-0.21430742740631104},{0.00539278332144022,-0.3494608998298645,0.27307090163230896,-0.06514617800712585,-0.3611181974411011,-0.06116921082139015,-0.16590265929698944,-0.10821446776390076},{-0.30137303471565247,-0.27508288621902466,0.3382440507411957,0.3384586274623871,-0.25269269943237305,-0.05537903681397438,-0.2868105173110962,0.23540017008781433},{-0.009604448452591896,-0.21282757818698883,0.16392984986305237,-0.22573137283325195,-0.28595778346061707,-0.11712885648012161,0.23691651225090027,0.023636426776647568},{0.11453238874673843,-0.09641025960445404,0.060281358659267426,-0.2312525361776352,0.061661865562200546,0.082699716091156,0.0925295427441597,0.41061529517173767},{-0.1112959235906601,-0.34721240401268005,-0.1690528392791748,0.11888230592012405,-0.2067265808582306,-0.12915177643299103,-0.11698994040489197,0.13723422586917877},{-0.2488672137260437,-0.34005942940711975,0.033478640019893646,0.04333820939064026,0.1144929751753807,-0.18663151562213898,0.35191676020622253,0.17331799864768982},{-0.05967705696821213,0.08294814079999924,-0.260021835565567,0.12042324990034103,0.10065022855997086,0.19808000326156616,-0.21940816938877106,0.3640953302383423},{0.0724848285317421,-0.042346756905317307,-0.36400657892227173,0.09699223190546036,-0.06862697005271912,-0.019839297980070114,-0.291638046503067,0.00023121725826058537},{0.004451606888324022,-0.1475912183523178,0.06864020973443985,-0.08816589415073395,0.33281004428863525,0.062434084713459015,0.014119046740233898,0.40417057275772095},{-0.059785570949316025,0.08121679723262787,-0.2605668902397156,0.2966465651988983,0.3747706413269043,0.37798944115638733,0.24103432893753052,-0.31164082884788513},{-0.5157127380371094,-0.1764039248228073,0.15825796127319336,-0.07057417184114456,0.23086854815483093,-0.23689419031143188,0.30087152123451233,-0.28263553977012634},{-0.2794025242328644,-0.00806503463536501,-0.09036260098218918,-0.4335814118385315,0.254512757062912,0.0620296336710453,-0.24464866518974304,0.1587344855070114},{-0.3434755802154541,-0.1932840794324875,-0.026888879016041756,-0.0023772940039634705,-0.048249080777168274,0.2142745554447174,0.3792854845523834,-0.13285095989704132},{-0.31777575612068176,0.052716247737407684,-0.3851529359817505,-0.3428558111190796,0.1748833954334259,0.06743083894252777,-0.016169434413313866,0.05954710766673088},{0.2533857822418213,0.38132038712501526,-0.2964284420013428,0.16018149256706238,0.21785548329353333,0.40806880593299866,-0.2144782692193985,-0.152437224984169},{0.28866031765937805,0.24988538026809692,0.0424637496471405,0.051138490438461304,0.29525381326675415,0.22281573712825775,0.33677977323532104,0.3617401719093323},{-0.22882531583309174,0.38045597076416016,0.1350976526737213,-0.015826642513275146,0.24162280559539795,0.07883265614509583,-0.26674458384513855,-0.30485081672668457},{-0.3157880902290344,-0.2104566991329193,0.05523211136460304,-0.2905900478363037,-0.2910440266132355,-0.14416581392288208,0.41634923219680786,-0.08590106666088104},{0.26503491401672363,-0.23037993907928467,0.33013442158699036,-0.3479459285736084,0.02436392940580845,0.23490512371063232,0.3213229477405548,-0.3007386326789856},{0.07773751765489578,0.4145166277885437,0.3939225971698761,-0.28695476055145264,-0.29353082180023193,0.0395546592772007,0.3312111496925354,0.0015245830873027444}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.012707699090242386,0.44835779070854187,-0.16381655633449554,0.18010228872299194,-0.416018545627594,0.3159896731376648,0.31791844964027405,0.1089523434638977},{-0.5117466449737549,-0.41817381978034973,-0.35734015703201294,-0.44966474175453186,-0.46364519000053406,0.49244481325149536,0.3689938485622406,-0.35937485098838806},{0.12201245874166489,-0.1642744541168213,0.15538543462753296,0.19805853068828583,-0.018951408565044403,0.45571401715278625,-0.29168084263801575,-0.5162766575813293},{0.4252222776412964,-0.08246753364801407,0.20880553126335144,0.0032323284540325403,0.4895135164260864,0.4441763758659363,0.5465922355651855,0.3789854645729065},{0.10189308971166611,0.18773703277111053,-0.15062011778354645,-0.2519751787185669,0.07965613156557083,-0.4305664598941803,-0.5297003388404846,0.5849147439002991},{0.4599149525165558,0.1205625832080841,-0.01618574932217598,-0.33639687299728394,-0.4697224497795105,-0.48923826217651367,-0.12156031280755997,0.4140124022960663},{-0.46938422322273254,-0.31989678740501404,-0.12172326445579529,-0.22728730738162994,-0.01868138462305069,0.5235949754714966,-0.5181053876876831,0.5016574859619141},{0.18860948085784912,0.0686003714799881,0.0038634054362773895,0.0530698299407959,0.3659684360027313,-0.4829801321029663,0.3338371515274048,-0.36721640825271606}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.10750074684619904,0.018854865804314613,0.048430245369672775,-0.023090867325663567,-0.046649862080812454,0.02085931785404682,0.0332215242087841,-0.008814922533929348};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.018889622762799263,0.008227722719311714,-0.05295591801404953,0.06164970621466637,-0.014068297110497952,-0.005472590681165457,0.03102465160191059,-0.08783164620399475};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

