#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2569887638092041,-0.10661874711513519,0.28293150663375854,0.18247736990451813,-0.32230183482170105,0.2556925415992737,-0.07040561735630035,-0.1445191353559494,0.13508346676826477,0.30362042784690857,0.11331839859485626,0.04777369275689125,0.2397516816854477,-0.27416151762008667,0.27202358841896057,-0.0569104328751564},{-0.16259711980819702,-0.4063306450843811,0.34542396664619446,0.15985199809074402,-0.2922874689102173,0.1547529250383377,-0.4080893397331238,-0.01179935596883297,-0.08828278630971909,-0.19708192348480225,0.057299863547086716,-0.260238379240036,-0.01358780823647976,-0.31688037514686584,-0.24576574563980103,0.07533536851406097},{-0.030645474791526794,-0.25287601351737976,-0.3390682339668274,0.16756056249141693,0.19641679525375366,0.4427523910999298,0.08383886516094208,-0.05367203429341316,-0.026293275877833366,-0.3946132957935333,-0.40952736139297485,0.6981799602508545,-0.12899711728096008,-0.2639257311820984,-0.3229748010635376,0.23679345846176147},{0.13270126283168793,0.22217784821987152,0.40100082755088806,-0.0290451068431139,-0.41679254174232483,-0.021274711936712265,0.2866538465023041,0.05116968974471092,0.2958761155605316,-0.4075384736061096,0.028066545724868774,0.39368313550949097,-0.2708204388618469,0.09020839631557465,0.44853442907333374,-0.4665028154850006},{-0.11509766429662704,-0.044398657977581024,0.32212987542152405,-0.02505585178732872,0.34245896339416504,0.43916311860084534,0.23717157542705536,-0.007633276749402285,0.1351402848958969,0.2200598567724228,0.28734198212623596,-0.3459639549255371,-0.31049108505249023,-0.4057141840457916,0.455290287733078,0.07172827422618866},{-0.18512994050979614,-0.21009279787540436,-0.23579952120780945,-0.13305149972438812,0.18992067873477936,0.18127770721912384,0.05068304017186165,-0.13708283007144928,0.3754461407661438,-0.28116312623023987,-0.4074055254459381,0.21523860096931458,0.22299611568450928,-0.13253629207611084,-0.07365455478429794,0.07168889790773392},{0.03292141854763031,0.02909785322844982,0.05565767362713814,-0.43218791484832764,0.23521792888641357,0.03707633167505264,0.09459292143583298,0.41370922327041626,0.3421001434326172,0.04052985832095146,-0.43818846344947815,0.0159656573086977,-0.09236332029104233,0.13807573914527893,-0.15358954668045044,-0.24572589993476868},{-0.26055416464805603,0.26318925619125366,0.2602362632751465,0.3900073766708374,-0.4425193965435028,-0.05400337651371956,0.4266515076160431,0.4398348927497864,-0.14656056463718414,0.4097305238246918,-0.5808600187301636,-0.3326721489429474,0.3411971628665924,0.1813252717256546,0.2559552788734436,0.32656729221343994},{0.32577720284461975,-0.2480025589466095,0.604271650314331,0.11189821362495422,0.07567039132118225,0.08589889109134674,0.18191401660442352,-0.4915042519569397,-0.1431615650653839,-0.4658566415309906,-0.17072837054729462,-0.048559654504060745,-0.1442219465970993,0.6065225601196289,0.4693874418735504,-0.2568005323410034},{0.25476861000061035,-0.5929874777793884,-0.5062927603721619,-0.20232757925987244,-0.2558923065662384,0.21714623272418976,0.22999107837677002,0.2039383500814438,0.5257313251495361,0.24372828006744385,0.0729726031422615,-0.3012436330318451,-0.04477398470044136,0.40079063177108765,-0.11795683205127716,-0.5020485520362854},{0.19577039778232574,0.33616992831230164,0.43475303053855896,-0.5824534893035889,-0.32739919424057007,0.18327879905700684,0.179640531539917,0.48526641726493835,-0.3321169912815094,0.04948529601097107,-0.1394127756357193,0.025389527902007103,-0.21837018430233002,-0.21870890259742737,0.32913967967033386,-0.3463136553764343},{-0.06807508319616318,-0.33357593417167664,0.160659059882164,0.4669784903526306,0.6756940484046936,0.4347533881664276,0.33569884300231934,0.3245728313922882,0.0009511165553703904,0.05071192607283592,0.2432105392217636,-0.3322441875934601,-0.5250720977783203,-0.4273183047771454,0.5991721153259277,0.01731269061565399},{-0.27739500999450684,0.4481353461742401,0.004437828436493874,-0.5982955098152161,0.09923655539751053,0.0037049867678433657,0.1460777372121811,0.16902068257331848,0.07975669205188751,0.12490984052419662,0.01551508903503418,0.1337677389383316,0.4760133922100067,0.35860127210617065,-0.03793396055698395,-0.12856018543243408},{0.08912251889705658,-0.3598968982696533,-0.2031126320362091,-0.13328269124031067,-0.5182436108589172,0.024697698652744293,-0.16308653354644775,-0.24871671199798584,-0.2619445323944092,-0.119015634059906,-0.4730490744113922,0.004289594478905201,-0.20204482972621918,0.5472312569618225,0.2609686553478241,-0.007752687204629183},{0.03131719306111336,-0.3390381932258606,-0.28854748606681824,0.22028176486492157,-0.05612720549106598,-0.32550960779190063,0.2891266345977783,-0.069636270403862,0.04013000801205635,0.28375232219696045,0.08202727884054184,0.12876564264297485,0.2720557451248169,-0.07456214725971222,-0.30231136083602905,0.2614133656024933},{0.33728545904159546,0.005170523654669523,-0.22141145169734955,-0.2152116447687149,-0.35478678345680237,0.21293878555297852,0.36611440777778625,-0.09907993674278259,0.21180622279644012,0.3665844798088074,-0.15895743668079376,0.0815591886639595,-0.26345738768577576,0.28468841314315796,-0.11781713366508484,-0.014330163598060608},{-0.2570613920688629,-0.20973697304725647,0.20448777079582214,0.16900375485420227,-0.24099479615688324,0.12001247704029083,-0.21287040412425995,-0.1603042483329773,-0.22801226377487183,-0.27150195837020874,-0.0928136333823204,-0.2934964895248413,0.1260508894920349,-0.25272610783576965,0.008543013595044613,-0.21131813526153564},{-0.269047349691391,0.2011405974626541,-0.38573575019836426,-0.22192281484603882,0.024376869201660156,0.3722365200519562,-0.22951875627040863,-0.25108304619789124,0.18525436520576477,0.19371454417705536,0.3594617545604706,-0.09360170364379883,-0.376994252204895,0.3240965008735657,0.040276844054460526,-0.4205608069896698}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06728910654783249,-0.027383645996451378,-0.11570366472005844,-0.341309130191803,0.3336108326911926,0.3135968744754791,0.09980107098817825,0.04424096643924713,-0.12718892097473145,-0.13716301321983337,-0.042446453124284744,0.0900152325630188,0.18074139952659607,0.37084653973579407,0.08968383073806763,0.0702499970793724},{-0.2353796809911728,-0.30083775520324707,-0.05237625166773796,0.09596224129199982,0.24202124774456024,-0.3354269862174988,0.08022160828113556,0.06642976403236389,-0.08604378998279572,0.23812805116176605,-0.25282031297683716,0.3092595934867859,-0.3581520915031433,0.20271819829940796,-0.44412022829055786,-0.3500628173351288},{0.10557933151721954,0.21684767305850983,-0.3547804057598114,-0.5103715062141418,0.14788587391376495,0.50066739320755,-0.09231481701135635,0.06798231601715088,-0.2542167603969574,-0.30624473094940186,0.00952521339058876,0.34723252058029175,-0.31462058424949646,-0.2353120595216751,0.12890934944152832,-0.07272855937480927},{0.18909958004951477,-0.05511294677853584,0.08307797461748123,0.1945662945508957,-0.5148020386695862,0.0037315585650503635,0.08562367409467697,-0.1850607544183731,0.30147120356559753,0.3772341012954712,-0.18190211057662964,-0.13719838857650757,-0.4391045570373535,-0.42103883624076843,0.14971400797367096,0.17927245795726776},{-0.16135506331920624,0.13308121263980865,-0.018940607085824013,0.24654081463813782,-0.2561001181602478,0.05223941057920456,0.012103823013603687,0.13789407908916473,0.29447269439697266,-0.317336767911911,0.1923225075006485,0.31909996271133423,0.19957073032855988,-0.44402217864990234,0.014479179866611958,-0.010076072998344898},{0.24820107221603394,0.2551962733268738,-0.058031365275382996,0.19939793646335602,-0.4700602889060974,-0.42224159836769104,0.222136452794075,0.27788054943084717,0.13833458721637726,0.3497880697250366,0.23241892457008362,-0.20565669238567352,-0.03150159865617752,-0.18024767935276031,-0.02130456082522869,0.2803679406642914},{-0.09708996117115021,0.2693839371204376,0.2779104709625244,-0.3677198588848114,-0.255939781665802,0.028979074209928513,-0.3256567120552063,-0.06751476973295212,0.16747163236141205,0.08269751071929932,-0.14407086372375488,-0.19058752059936523,-0.33633631467819214,-0.03629612922668457,0.21317166090011597,0.04365354776382446},{-0.18467122316360474,-0.14847511053085327,-0.49862661957740784,0.2867441773414612,-0.35113459825515747,-0.25232332944869995,-0.24320852756500244,-0.42039477825164795,0.13651776313781738,-0.29110679030418396,0.024177707731723785,0.14181795716285706,-0.18508155643939972,0.43153005838394165,-0.07959204912185669,-0.3727687895298004},{-0.31578975915908813,0.26845142245292664,0.0026120205875486135,-0.01320189144462347,0.2728314697742462,-0.25078657269477844,0.3373364210128784,0.14376404881477356,0.32980358600616455,0.29589152336120605,0.2670848071575165,0.33973217010498047,0.18736732006072998,-0.05330730974674225,0.2804710865020752,0.12244565039873123},{0.04066537320613861,-0.2726554572582245,-0.19909586012363434,-0.09366434812545776,0.28102031350135803,-0.1835946887731552,-0.29073137044906616,-0.18086037039756775,0.09644901007413864,-0.3956112861633301,-0.2854333221912384,0.37872418761253357,0.1222764253616333,0.1660083681344986,-0.37746793031692505,0.2328193634748459},{-0.08626237511634827,-0.4620990455150604,0.3471398651599884,0.30206891894340515,0.22575323283672333,0.17629121243953705,0.21201708912849426,-0.1659621298313141,0.2661396861076355,-0.3188721537590027,0.21316692233085632,0.4072195589542389,0.5168156027793884,0.10792544484138489,-0.13471385836601257,0.10861045122146606},{0.06578001379966736,0.0037055471912026405,0.37607067823410034,-0.010411269962787628,-0.25239574909210205,-0.1595643311738968,0.4417470693588257,0.28423839807510376,-0.2621484398841858,-0.21023410558700562,-0.10113644599914551,-0.29367297887802124,-0.04063093662261963,-0.2915409505367279,-0.3980047404766083,0.04740876331925392},{-0.09795422106981277,-0.3173656165599823,0.3996541500091553,-0.20528559386730194,0.3552129864692688,-0.3198913633823395,-0.47275522351264954,0.08826957643032074,0.08252210170030594,0.0726303905248642,-0.33468860387802124,0.11861135065555573,0.10162495821714401,-0.26671892404556274,-0.4170442521572113,-0.002619828563183546},{0.33189359307289124,-0.34527385234832764,0.4755500257015228,0.06840693950653076,-0.041230447590351105,0.32043957710266113,-0.1070931926369667,-0.23939326405525208,-0.459616482257843,0.11911739408969879,-0.009031139314174652,-0.3736613988876343,-0.09051716327667236,0.17510786652565002,0.29458582401275635,0.03320874273777008},{-0.10853583365678787,0.23190510272979736,0.1271180957555771,-0.4150998294353485,-0.23051105439662933,0.20260107517242432,0.3021448254585266,-0.23478727042675018,0.17778490483760834,-0.34156468510627747,0.03238673135638237,0.10369861871004105,-0.0631035640835762,0.14759062230587006,-0.006425792817026377,0.08882717043161392},{-0.2493516504764557,0.37904202938079834,-0.4292682409286499,0.36926600337028503,0.14817741513252258,-0.4353257715702057,-0.033181071281433105,-0.08485400676727295,-0.3138676583766937,0.35053664445877075,-0.36496901512145996,0.3215544819831848,-0.06393999606370926,-0.2625831663608551,-0.2778322100639343,-0.5247309803962708}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1948232799768448,0.14192375540733337,-0.06754083931446075,-0.028274936601519585,-0.13258153200149536,0.05464104190468788,0.2778722941875458,0.07694407552480698,-0.2248217761516571,-0.15577325224876404,0.16010704636573792,-0.3174974322319031,-0.24917230010032654,0.22542434930801392,0.24482345581054688,0.3133779466152191,-0.2695644795894623,-0.29318833351135254,-0.21907475590705872,0.07948685437440872,-0.07102644443511963,-0.2986055612564087,-0.20365670323371887,-0.32004818320274353,-0.3015240430831909,0.21134793758392334,-0.20060163736343384,0.003987640142440796,-0.0010409136302769184,-0.04457877576351166,0.22683307528495789,-0.22239921987056732},{0.2770724296569824,0.18658168613910675,0.1648876965045929,-0.14144402742385864,0.17016738653182983,-0.07985835522413254,0.4203696548938751,0.14744026958942413,-0.18633992969989777,-0.10311484336853027,-0.10901548713445663,-0.3100548982620239,-0.16544273495674133,0.2832096517086029,-0.24158215522766113,-0.190376877784729,-0.00018395167717244476,0.2542954385280609,-0.3738422095775604,-0.22571934759616852,-0.08451107889413834,0.2951483726501465,0.055637579411268234,0.014684719033539295,0.21456828713417053,-0.3614013195037842,-0.04517793282866478,0.1299639344215393,0.1633962243795395,-0.1443660855293274,-0.006767874583601952,0.1410149186849594},{0.1147729903459549,0.030989177525043488,-0.19464604556560516,0.15119034051895142,-0.20653922855854034,-0.21031111478805542,-0.2087811976671219,0.03782763332128525,-0.15101255476474762,0.44692113995552063,-0.29928889870643616,-0.30200278759002686,0.08245876431465149,-0.4066077768802643,-0.17691387236118317,0.10808466374874115,-0.16939254105091095,-0.15952695906162262,0.14186419546604156,-0.11791563779115677,0.27427518367767334,0.27653929591178894,-0.22272413969039917,0.014860629104077816,-0.292636901140213,0.025946425274014473,0.1351112574338913,-0.1274159699678421,-0.001024034689180553,-0.2936684787273407,-0.19731895625591278,-0.061316534876823425},{0.46162882447242737,0.04279639944434166,0.18504789471626282,-0.1416272670030594,-0.2874312400817871,-0.06372659653425217,-0.20030589401721954,0.31228530406951904,0.2730896770954132,-0.34010282158851624,-0.07882804423570633,0.36472514271736145,0.11170729249715805,-0.10041990876197815,-0.22443458437919617,0.27831941843032837,-0.3006814122200012,0.223336860537529,0.0784112960100174,0.13368798792362213,-0.04930077865719795,-0.15946896374225616,0.28995150327682495,0.1676967740058899,0.2206406146287918,-0.4195728302001953,0.2956359386444092,-0.23346325755119324,-0.0769193023443222,0.16688068211078644,-0.20116013288497925,0.18267926573753357},{-0.06690163165330887,-0.0775507390499115,-0.12472085654735565,0.17387473583221436,0.180476576089859,-0.21166381239891052,-0.45649024844169617,-0.09480274468660355,-0.09283052384853363,-0.25310689210891724,0.1171996146440506,0.26655325293540955,-0.03427073359489441,-0.16489630937576294,-0.08617286384105682,0.09961116313934326,-0.08911174535751343,-0.11307868361473083,-0.30922141671180725,-0.20013427734375,-0.07818613201379776,-0.4433937668800354,0.17435112595558167,0.14611706137657166,-0.13225233554840088,0.3692927062511444,-0.17837220430374146,0.13546985387802124,0.3851255476474762,0.39124754071235657,-0.10927966982126236,0.4411922097206116},{-0.36893901228904724,0.039410579949617386,-0.3101392388343811,-0.0738302543759346,-0.24790480732917786,0.26996174454689026,0.2377530187368393,0.014650843106210232,0.19782796502113342,0.30103981494903564,0.3657419979572296,-0.2886570394039154,-0.3225517272949219,0.1723894625902176,0.3731733560562134,-0.3286936283111572,-0.16579049825668335,-0.2697974145412445,0.1901453286409378,0.10133843868970871,0.0869346633553505,0.21889109909534454,0.1190231665968895,-0.10660211741924286,-0.42917171120643616,0.42594730854034424,-0.12762252986431122,0.23386333882808685,0.39746740460395813,0.11373253911733627,0.042464107275009155,0.006996810901910067},{0.17141999304294586,-0.13025715947151184,-0.154532328248024,-0.3649085462093353,-0.06601104885339737,0.22234728932380676,0.3427739441394806,0.1851424127817154,0.04384874179959297,0.4222831130027771,-0.0019287281902506948,-0.04416457191109657,-0.45421892404556274,-0.16400843858718872,-0.14485149085521698,0.17508190870285034,-0.3211009204387665,-0.22927770018577576,0.18935942649841309,-0.059781163930892944,-0.13351872563362122,-0.12316302210092545,-0.2013726532459259,-0.21523717045783997,0.14318376779556274,-0.25086429715156555,-0.07847509533166885,-0.22699157893657684,0.3042849600315094,0.051436133682727814,-0.19801448285579681,-0.319502055644989},{0.02369409054517746,0.16624420881271362,0.048513252288103104,-0.05903363227844238,0.13174521923065186,-0.3403526544570923,-0.08249807357788086,-0.17065751552581787,-0.037044260650873184,-0.2061913013458252,-0.33174532651901245,-0.08557043224573135,-0.11036278307437897,0.020192179828882217,-0.14458277821540833,0.4183308482170105,-0.03531702980399132,-0.16360774636268616,0.08660893142223358,0.34411779046058655,-0.13245752453804016,-0.2226666659116745,0.2723222076892853,0.11644920706748962,-0.03162287548184395,-0.33055686950683594,-0.32618454098701477,-0.3108963966369629,-0.3457080125808716,-0.30196109414100647,0.03175683692097664,-0.3361959159374237},{0.11963361501693726,0.40311098098754883,-0.2676083743572235,-0.3783476650714874,-0.2554563581943512,0.13938643038272858,0.06587958335876465,0.140812948346138,0.04743443429470062,-0.30679187178611755,-0.12270428985357285,0.34331807494163513,-0.29395127296447754,-0.1850864440202713,0.22698168456554413,-0.24799636006355286,0.27817511558532715,0.18057167530059814,0.4069133400917053,0.0488431453704834,0.1536398082971573,0.1446005254983902,0.30715280771255493,-0.12943892180919647,0.417572557926178,-0.2760128676891327,0.18524089455604553,0.38402059674263,-0.2977834641933441,0.21116280555725098,0.0575772188603878,0.12435326725244522},{-0.1810702085494995,0.08498121052980423,-0.27047163248062134,-0.14428602159023285,0.187436044216156,-0.2114882469177246,0.10696472227573395,-0.02502555586397648,0.1911059021949768,-0.013878906145691872,-0.32246869802474976,-0.31961071491241455,-0.32204416394233704,-0.06226636469364166,-0.2804655134677887,0.10489241033792496,0.03748165816068649,-0.22318382561206818,0.21084731817245483,0.1115797683596611,0.03720653057098389,-0.048944953829050064,0.2769354581832886,-0.16339971125125885,0.3119977116584778,0.11299286782741547,-0.2934094965457916,-0.020983684808015823,-0.024714894592761993,0.10636653751134872,-0.17460350692272186,0.08250761032104492},{0.11080896854400635,0.10552797466516495,0.16817931830883026,-0.3001440763473511,-0.4171846807003021,-0.22075548768043518,-0.2870965898036957,0.06434058398008347,-0.3320583403110504,0.48357075452804565,0.22291693091392517,-0.20802584290504456,-0.453042596578598,-0.12252828478813171,-0.12772662937641144,-0.08667149394750595,0.14809344708919525,-0.19225437939167023,0.3292618989944458,-0.12616795301437378,-0.16608355939388275,0.031866006553173065,0.27748993039131165,0.19898509979248047,0.17275656759738922,-0.17669044435024261,0.0774846076965332,-0.07010015100240707,-0.03464942425489426,0.01093512773513794,-0.024809762835502625,0.1300164759159088},{-0.1498604714870453,-0.0842784196138382,0.2399219274520874,0.27216836810112,0.2633236050605774,0.004471288528293371,0.05491191893815994,-0.1869518905878067,-0.07070797681808472,-0.2991029620170593,0.29534485936164856,-0.1934678852558136,-0.18972887098789215,-0.20840933918952942,0.27911490201950073,-0.003453605342656374,0.013131794519722462,0.0324268713593483,0.40974971652030945,0.06908107548952103,-0.1961556226015091,0.24231477081775665,0.1211429312825203,-0.08318985253572464,0.2595655024051666,-0.13876937329769135,-0.13305789232254028,0.2390103042125702,0.15101128816604614,0.043054088950157166,-0.2531343996524811,-0.22959302365779877},{0.3674124777317047,-0.20703524351119995,0.019274596124887466,-0.26173925399780273,-0.10812481492757797,-0.17522785067558289,0.007904401049017906,0.2163461595773697,0.17057369649410248,0.0751226618885994,0.2343805730342865,0.3677750527858734,-0.4481693506240845,-0.4822445213794708,0.033687617629766464,-0.25248122215270996,-0.32161659002304077,-0.40017953515052795,0.423333078622818,-0.19777123630046844,0.42801639437675476,-0.16586682200431824,0.10617128014564514,0.1498132050037384,0.1533944308757782,-0.16961391270160675,0.21084514260292053,6.557536107720807e-05,0.15516193211078644,0.07069778442382812,-0.3004637658596039,0.08492519706487656},{0.2577280104160309,-0.048303235322237015,-0.011627573519945145,0.3823052942752838,-0.09463553875684738,-0.1963914930820465,-0.04927647113800049,0.1520788073539734,0.20359215140342712,0.2636128067970276,0.11409906297922134,-0.10464400798082352,0.06424614787101746,0.20305192470550537,-0.11434990167617798,0.10376401990652084,0.22391323745250702,-0.24047330021858215,0.10602443665266037,-0.3545807898044586,0.28698909282684326,0.1326664835214615,-0.1002747043967247,0.20655065774917603,0.24494297802448273,0.08653224259614944,0.13710863888263702,0.06092570349574089,0.08766210079193115,-0.13874730467796326,0.0024127133656293154,0.38044223189353943},{0.020494673401117325,-0.17678721249103546,-0.06350847333669662,0.09003569930791855,-0.2972003221511841,0.04215686395764351,0.06699009239673615,-0.21353238821029663,-0.2230004072189331,-0.0035420069471001625,0.22046948969364166,0.1595412790775299,0.0369383804500103,0.23796431720256805,-0.005451851058751345,-0.040260668843984604,-0.21957029402256012,0.2892623543739319,-0.08625701069831848,-0.2318788319826126,-0.22915755212306976,-0.041969019919633865,0.1887255311012268,0.01536615565419197,-0.04678913950920105,-0.10038770735263824,-0.15941323339939117,0.26541581749916077,0.08716271072626114,-0.18572351336479187,0.28213050961494446,0.1256580650806427},{0.1646874099969864,-0.183594211935997,-0.017699215561151505,-0.20066606998443604,-0.045085836201906204,0.16910742223262787,0.06430156528949738,0.2871074378490448,-0.16522440314292908,0.006690499372780323,0.26363226771354675,0.1069791167974472,0.030631227418780327,-0.10917102545499802,0.011745358817279339,0.2135448157787323,-0.37404853105545044,-0.20979103446006775,-0.030196407809853554,0.0632084384560585,0.03733605891466141,0.27659010887145996,0.20693691074848175,0.15531030297279358,0.04408439248800278,0.18580181896686554,0.0027336229104548693,-0.04630614072084427,0.12680956721305847,-0.1373567283153534,-0.25709596276283264,0.3075311779975891},{0.1043165847659111,0.009432214312255383,-0.38246551156044006,0.17065483331680298,0.09410441666841507,0.0010623466223478317,0.3256566524505615,0.040022555738687515,0.11558545380830765,-0.14451943337917328,0.20866969227790833,-0.27787354588508606,-0.4301859736442566,0.2844490706920624,0.08761981129646301,0.016515707597136497,0.040596187114715576,-0.09075925499200821,-0.19164574146270752,-0.007972870022058487,-0.05368388071656227,0.23471681773662567,0.05931850150227547,-0.1998102217912674,-0.12998470664024353,-0.15012593567371368,0.03357098996639252,0.37259426712989807,0.2587425112724304,-0.1918392926454544,0.2031644582748413,0.1947685331106186},{-0.07706093043088913,-0.007343652658164501,-0.08985631912946701,-0.08633910864591599,-0.23523765802383423,-0.011955696158111095,0.24503228068351746,0.17504362761974335,0.14482279121875763,-0.0025291424244642258,0.19986708462238312,-0.025928029790520668,0.21051040291786194,0.2213214486837387,0.1727263480424881,-0.083377406001091,0.13843810558319092,0.20253752171993256,0.21226371824741364,0.035659488290548325,0.15701265633106232,0.29426783323287964,0.07229025661945343,0.15169242024421692,-0.02342437393963337,-0.06581233441829681,-0.14028209447860718,-0.21429170668125153,0.13297854363918304,-0.2763727903366089,0.059610284864902496,-0.07826735824346542},{-0.37504732608795166,0.01726905256509781,-0.39194467663764954,-0.3263044059276581,0.049007415771484375,-0.009522288106381893,0.1605420559644699,-0.21535572409629822,0.07150229066610336,0.3818059265613556,0.012738156132400036,-0.28195419907569885,0.04539649188518524,-0.16856646537780762,-0.3287259340286255,-0.0015858549159020185,-0.18603001534938812,0.11681888997554779,-0.1255227029323578,-0.03836962580680847,-0.2961227297782898,0.16531939804553986,0.09597717225551605,0.05426909029483795,-0.10744541883468628,0.37975794076919556,0.034083299338817596,-0.20417800545692444,-0.18192365765571594,-0.017806202173233032,-0.223125159740448,-0.26650702953338623},{-0.0038864060770720243,-0.26428478956222534,-0.27201560139656067,-0.04368704557418823,-0.30441296100616455,-0.14865103363990784,0.17983105778694153,-0.28221723437309265,-0.22230879962444305,0.17028895020484924,0.17769744992256165,0.08885420858860016,0.12317772209644318,-0.1328861117362976,0.2696145474910736,-0.25420743227005005,0.11014374345541,0.2702787220478058,0.038000527769327164,0.2844412326812744,0.011925878003239632,-0.11108753830194473,-0.29895079135894775,0.23670952022075653,-0.11230833828449249,-0.15249374508857727,0.10941243916749954,0.04129589721560478,-0.1255602091550827,-0.32721421122550964,-0.036365821957588196,-0.18980377912521362},{0.2141861468553543,0.0997171476483345,-0.09634125977754593,0.2443901151418686,-0.2807129919528961,0.03749525919556618,-0.11169926077127457,-0.23749670386314392,-0.07935693114995956,0.2834300696849823,-0.3586755394935608,-0.1391851007938385,0.026310747489333153,-0.24517123401165009,-0.38737645745277405,-0.21959567070007324,-0.1785673201084137,-0.38403961062431335,-0.2890832722187042,0.2474294751882553,0.2245500236749649,0.02518039382994175,-0.3640061616897583,0.3446884751319885,0.10888145864009857,0.31547480821609497,-0.32855740189552307,-0.18033860623836517,0.1318805068731308,-0.23157021403312683,0.03018215112388134,0.19468539953231812},{-0.059187497943639755,-0.30519574880599976,-0.03626331686973572,-0.3047655522823334,-0.041767384856939316,0.3011247515678406,0.20772603154182434,0.024643627926707268,-0.101263627409935,0.004166521597653627,-0.17738699913024902,0.09289711713790894,0.1100623831152916,0.08363272994756699,0.10698520392179489,0.047771647572517395,-0.05498280003666878,0.16060994565486908,-0.12821288406848907,0.1562037318944931,0.18060633540153503,0.2699257731437683,-0.05634136125445366,-0.23965372145175934,0.1635010540485382,0.17073307931423187,0.26378291845321655,0.17347164452075958,0.01785198785364628,0.10297635942697525,0.01803070493042469,-0.10946307331323624},{0.04822731763124466,-0.23531074821949005,0.3106409013271332,0.028580648824572563,0.3065679371356964,-0.07954661548137665,-0.14143258333206177,-0.16564957797527313,0.17335101962089539,-0.0613529272377491,0.028047388419508934,0.04520834609866142,-0.2159148007631302,0.06691744178533554,-0.14087820053100586,-0.25683918595314026,-0.050234146416187286,-0.039383966475725174,0.1995275765657425,0.2618488371372223,0.04315062612295151,0.0032799390610307455,0.13449151813983917,0.3645041584968567,-0.12395016849040985,-0.10661838948726654,0.13851861655712128,-0.1266576051712036,-0.20158442854881287,-0.22643129527568817,0.2820987403392792,-0.0017522681737318635},{0.20046094059944153,-0.08722003549337387,0.06044222041964531,0.10972417145967484,-0.019884765148162842,0.066163569688797,-0.24065753817558289,0.3198455274105072,-0.11195290833711624,-0.05040765926241875,0.11873810738325119,-0.29477939009666443,0.037361640483140945,-0.05270548164844513,-0.1182185709476471,0.34746837615966797,-0.059728942811489105,-0.17653591930866241,0.035874273627996445,0.015218249522149563,-0.19380737841129303,0.19130700826644897,0.2046334445476532,0.24076992273330688,-0.2549121379852295,0.11692875623703003,-0.06420274823904037,0.09196405112743378,-0.28947123885154724,0.2654052972793579,-0.04203880950808525,0.03808867186307907}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.2895834743976593,-0.15732815861701965,0.18473133444786072,-0.2250768095254898},{0.22127991914749146,-0.27756601572036743,0.2817257344722748,0.251564621925354},{-0.4217946529388428,0.029149454087018967,0.23307211697101593,-0.05377490073442459},{0.2996998429298401,0.5580078959465027,0.3520752489566803,0.01747847907245159},{-0.37168556451797485,0.22636185586452484,-0.3110508620738983,0.1297726035118103},{0.0058084772899746895,-0.15409043431282043,0.059477549046278,0.4821856617927551},{-0.10890226066112518,-0.22391366958618164,-0.5141242146492004,0.08535172790288925},{-0.1202833354473114,-0.42321598529815674,0.2242373675107956,-0.045924413949251175},{-0.16093596816062927,0.21189366281032562,-0.07556097954511642,-0.1505679488182068},{0.392706960439682,-0.025199607014656067,-0.20349101722240448,-0.2823556959629059},{0.28054264187812805,-0.26466992497444153,0.38380739092826843,0.35572686791419983},{-0.13324053585529327,-0.0056547787971794605,0.580710232257843,-0.13493746519088745},{-0.4105924069881439,0.31113389134407043,-0.060975536704063416,-0.09201963245868683},{-0.22436708211898804,0.02221556380391121,-0.30769848823547363,0.14769785106182098},{0.2061133235692978,-0.08004619181156158,0.2636195123195648,0.1872628629207611},{-0.14935918152332306,-0.3080562651157379,-0.15022790431976318,-0.10357917100191116},{-0.4476988911628723,0.07584228366613388,-0.07549189776182175,0.4005749225616455},{-0.3997984528541565,-0.15593385696411133,-0.263012170791626,0.28845444321632385},{-0.0939844399690628,-0.22518204152584076,0.5167827010154724,0.060793373733758926},{-0.19376040995121002,-0.18993113934993744,-0.02771047130227089,-0.20383894443511963},{0.20978710055351257,0.16300226747989655,0.18905340135097504,-0.251491904258728},{-0.011996373534202576,-0.35819515585899353,-0.2450016736984253,0.41806110739707947},{0.3179250657558441,-0.23438484966754913,0.25559014081954956,0.0759514719247818},{-0.3546317219734192,-0.06429511308670044,-0.26085031032562256,-0.4203436076641083},{-0.3315432369709015,-0.23384533822536469,0.08064182102680206,-0.1388305127620697},{0.3255476951599121,0.29840731620788574,-0.1481342911720276,0.1330089271068573},{0.1574426144361496,-0.22401440143585205,0.30697908997535706,0.10333586484193802},{-0.05551358684897423,-0.18865494430065155,0.010461616329848766,0.4260120391845703},{0.20324194431304932,0.07181201130151749,0.049748893827199936,0.03126143664121628},{-0.21070361137390137,0.108657106757164,0.37498190999031067,0.018443794921040535},{-0.21890468895435333,-0.1472274363040924,0.051294248551130295,0.3023678958415985},{0.25456371903419495,0.2580721080303192,0.3651713728904724,-0.06692274659872055}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.016072915866971016,-0.013084247708320618,-0.003375986125320196,0.05586199462413788,0.03866825997829437,-0.05675951763987541,-0.03231540694832802,0.07590467482805252,-0.08061832189559937,-0.04235982894897461,0.004713754635304213,-0.022704798728227615,-0.04718656465411186,0.06139155104756355,-0.01479607168585062,-0.04112628847360611};
static const float actor_encoder_self_encoder_2_bias[16] = {0.004035685211420059,-0.005691104102879763,-0.015945758670568466,0.0143667571246624,-0.05219211056828499,0.03179097920656204,-0.02396463043987751,-0.012370365671813488,0.03829752281308174,-0.0535130500793457,0.017028847709298134,-0.015795981511473656,-0.008200950920581818,-0.03414303436875343,0.01708412729203701,-0.03394661098718643};
static const float actor_encoder_feed_forward_0_bias[32] = {0.020326904952526093,0.04228010028600693,-0.00829161424189806,-0.0049614873714745045,-0.019777441397309303,0.02223614789545536,-0.029638417065143585,-0.0006558698369190097,-0.0005640393937937915,-0.03082001395523548,-0.0017950787441805005,0.03389983996748924,0.023333998396992683,0.008143887855112553,0.03654605150222778,-0.046442024409770966,0.009167506359517574,-0.0065617733635008335,0.026944246143102646,-0.023574624210596085,-0.013786710798740387,0.016202988103032112,-0.005882333032786846,-0.03410525619983673,-0.031756844371557236,-0.00506841903552413,0.019167259335517883,0.026953110471367836,-0.028543738648295403,0.03646606579422951,0.03829914703965187,-0.009379067458212376};
static const float action_parameterization_distribution_linear_bias[4] = {-0.008646378293633461,0.00920464564114809,0.013695787638425827,0.023587582632899284};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3649800419807434,-0.3271237909793854,-0.18065281212329865,0.1662684679031372,-0.2777743637561798,0.08481678366661072,-0.3336148262023926,0.017351720482110977},{0.20687445998191833,0.16999730467796326,0.3847501277923584,0.36214855313301086,-0.16498157382011414,-0.38384151458740234,0.31818392872810364,0.419145792722702},{0.08089064806699753,0.2276799976825714,0.11561635136604309,-0.045442499220371246,0.3223031759262085,0.1873079389333725,0.0027866882737725973,0.2872120141983032},{0.10806602239608765,-0.3125119209289551,0.3410288691520691,-0.17143048346042633,-0.2312052696943283,0.0878433883190155,0.32253918051719666,0.28775906562805176},{-0.27777767181396484,-0.05371949449181557,-0.04643026739358902,-0.29944872856140137,0.14985209703445435,0.12722600996494293,0.3470943570137024,0.30218151211738586},{-0.08490494638681412,0.232761412858963,-0.009125295095145702,-0.2388761341571808,0.3527335822582245,0.1261567622423172,0.11553467810153961,-0.147093266248703},{-0.007667148485779762,0.21704813838005066,0.13548363745212555,-0.18516041338443756,0.44457530975341797,-0.11657050997018814,0.17025020718574524,0.12577234208583832},{0.07889467477798462,-0.3464582562446594,-0.06876315176486969,-0.2674635052680969,0.2699204683303833,-0.010189894586801529,-0.15639540553092957,-0.29788777232170105},{-0.25687023997306824,0.2263503223657608,-0.06316322833299637,-0.14063569903373718,-0.06981835514307022,0.4126511514186859,0.3714729845523834,0.27099037170410156},{-0.0009803154971450567,-0.10043453425168991,-0.307186096906662,0.23765790462493896,0.2444922924041748,0.3053390681743622,0.3488449454307556,-0.327956885099411},{-0.16238480806350708,-0.35093697905540466,0.34325680136680603,0.15374471247196198,-0.012722729705274105,-0.266509085893631,0.05808904767036438,-0.33337488770484924},{0.23233464360237122,0.0667131096124649,0.3805370330810547,0.38213199377059937,-0.14343714714050293,0.3208053410053253,0.24609699845314026,-0.33597496151924133},{-0.3939264714717865,0.16700248420238495,-0.3681890070438385,0.41647735238075256,-0.04597583785653114,0.41796180605888367,0.07244622707366943,0.27167484164237976},{-0.05349021404981613,0.21608713269233704,-0.1434336155653,-0.12093311548233032,-0.0005015736096538603,0.11158779263496399,0.36218297481536865,0.033971019089221954},{0.13374535739421844,-0.29337814450263977,-0.34493130445480347,-0.16184374690055847,0.1353716403245926,-0.20918552577495575,0.176803857088089,-0.047567665576934814},{-0.4430151581764221,-0.2991155982017517,-0.23400138318538666,0.024783125147223473,-0.001544472761452198,0.17454785108566284,0.2771223187446594,-0.012452843599021435},{-0.1514912247657776,-0.2714681625366211,0.2617354989051819,-0.33396777510643005,0.03264807537198067,-0.004164181649684906,-0.3790079653263092,-0.2086777687072754},{0.06191946938633919,0.22725534439086914,0.17373248934745789,0.19432376325130463,-0.08479949831962585,0.33062466979026794,0.32875120639801025,-0.15795661509037018},{0.05693181976675987,-0.3349207937717438,-0.05498677119612694,-0.08001244068145752,-0.1377553939819336,-0.3399890959262848,0.09065557271242142,-0.2766910493373871},{-0.042760420590639114,0.0031391859520226717,0.13840506970882416,-0.32999613881111145,0.05209313705563545,0.12004274874925613,0.12507665157318115,-0.10304533690214157},{0.07906701415777206,-0.1048455610871315,0.09417595714330673,-0.28491678833961487,-0.002641129307448864,0.004049588926136494,0.03430301323533058,-0.23058609664440155},{-0.3347000479698181,0.19231264293193817,0.17851223051548004,-0.2582956552505493,-0.4669494926929474,0.02346433699131012,0.2096104621887207,0.02269234135746956},{0.2661149501800537,0.10908147692680359,-0.3589465916156769,0.11712208390235901,-0.03938457742333412,0.2505343556404114,0.3170238435268402,0.3183198571205139},{-0.025836067274212837,-0.14063258469104767,0.05714765563607216,0.31026512384414673,-0.27821919322013855,-0.029792865738272667,-0.0782172754406929,-0.2963012456893921},{0.2112264484167099,0.09973505139350891,-0.40708115696907043,0.342183381319046,-0.27800846099853516,-0.3353457450866699,-0.3089534044265747,0.21276670694351196},{0.04712579771876335,0.384591668844223,-0.2808372676372528,-0.06012863293290138,0.08668354898691177,-0.24802863597869873,0.36240750551223755,-0.2578083872795105},{-0.07191162556409836,0.0938963070511818,-0.15817105770111084,-0.16376711428165436,0.020937399938702583,-0.18451400101184845,-0.0634937733411789,-0.11919304728507996},{0.14444398880004883,-0.16984029114246368,-0.04421407729387283,-0.10653175413608551,0.0076403189450502396,0.011900719255208969,-0.16108575463294983,0.11525677144527435},{0.3616381883621216,0.05549217760562897,-0.3837023675441742,-0.19476257264614105,-0.2436409741640091,0.10803810507059097,0.27108073234558105,0.1099996343255043},{0.40361520648002625,-0.3067462146282196,-0.009990529157221317,-0.03906412795186043,0.1298571676015854,-0.12284647673368454,0.248380646109581,0.3760848939418793},{-0.276467889547348,-0.18460048735141754,0.0492677167057991,-0.27870962023735046,0.32996267080307007,-0.22962124645709991,0.09604951739311218,0.08145210146903992},{0.11611244827508926,-0.011135170236229897,-0.15247036516666412,0.2790278494358063,0.054349157959222794,0.06001999229192734,0.0044807870872318745,-0.02657732367515564}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23162946105003357,0.43652528524398804,-0.6191850900650024,-0.5212283730506897,-0.3228929042816162,0.050293028354644775,-0.46785181760787964,0.5462675094604492},{-0.023500919342041016,0.5381439924240112,-0.20981866121292114,0.5642856955528259,-0.005961301736533642,0.07951522618532181,-0.23217777907848358,0.0637299194931984},{-0.4602712392807007,-0.21719834208488464,-0.15787136554718018,-0.19103214144706726,0.5505257844924927,0.21129658818244934,0.03510401397943497,0.47538143396377563},{-0.47148144245147705,-0.479923814535141,0.3696674108505249,0.33761507272720337,-0.5284990072250366,-0.1813228875398636,0.5226664543151855,0.258566290140152},{-0.3587687313556671,-0.3140125274658203,-0.3491894006729126,-0.2769685983657837,0.3525294363498688,-0.31056949496269226,0.556423544883728,-0.45303797721862793},{-0.05114731565117836,0.1970025897026062,0.33309316635131836,-0.6013643145561218,0.5255299806594849,-0.32857614755630493,-0.4604787230491638,-0.34290507435798645},{-0.4255008101463318,0.18943876028060913,0.07854785770177841,-0.4090558588504791,-0.04238050431013107,-0.5628771185874939,0.49324730038642883,0.018441395834088326},{-0.44086697697639465,-0.27432340383529663,-0.2480769157409668,-0.3785097301006317,-0.34875234961509705,0.1534738689661026,0.5947718620300293,-0.32638901472091675}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03641951456665993,-0.016933957114815712,-0.004832254722714424,0.007929984480142593,-0.03301026299595833,-0.007630730513483286,-0.02026405744254589,0.04318496212363243};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0019386315252631903,-0.016091052442789078,-0.006996472366154194,0.014150325208902359,-0.04378979280591011,0.014072556048631668,-0.04705541580915451,-0.007079154718667269};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

