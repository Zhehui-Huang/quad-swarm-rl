#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.32773953676223755,-0.09756802022457123,0.299685001373291,0.1436217576265335,-0.2690768241882324,0.30163466930389404,-0.009969741106033325,-0.1369975507259369,0.12080571800470352,0.33041292428970337,0.10542807728052139,0.029742131009697914,0.2181740701198578,-0.24193428456783295,0.27875885367393494,-0.04394659772515297},{-0.18291223049163818,-0.42805299162864685,0.33978456258773804,0.09637922793626785,-0.20705662667751312,0.16924679279327393,-0.4132077693939209,-0.05130477249622345,-0.09967058897018433,-0.1921876221895218,0.03625640273094177,-0.20490440726280212,-0.008918293751776218,-0.33143627643585205,-0.27165687084198,0.12434633821249008},{-0.11301476508378983,-0.2198181003332138,-0.4647561013698578,0.17856352031230927,0.24995480477809906,0.5740749835968018,0.0460532046854496,-0.042989879846572876,0.11119705438613892,-0.509884774684906,-0.40680885314941406,0.8082309365272522,-0.23044227063655853,-0.3047560155391693,-0.39351749420166016,0.2843710482120514},{0.17139916121959686,0.273163378238678,0.36506712436676025,-0.006928888149559498,-0.38562074303627014,-0.012496478855609894,0.2735055685043335,0.0746702253818512,0.3298570215702057,-0.3139745891094208,0.007358979433774948,0.41576361656188965,-0.2424275279045105,-0.024658385664224625,0.4803982675075531,-0.4631727337837219},{-0.070370614528656,0.017997508868575096,0.305251806974411,-0.0705358237028122,0.31440427899360657,0.4387710690498352,0.149734228849411,-0.017566069960594177,0.1281500607728958,0.19864633679389954,0.26939958333969116,-0.34949323534965515,-0.18667565286159515,-0.43345746397972107,0.36982643604278564,0.10249922424554825},{-0.26227959990501404,-0.19972790777683258,-0.20630612969398499,-0.055667635053396225,0.20936089754104614,0.20389236509799957,0.04028140380978584,-0.11968645453453064,0.34574344754219055,-0.30388888716697693,-0.46436119079589844,0.24545584619045258,0.10620257258415222,-0.14537887275218964,-0.019721824675798416,0.07050754874944687},{0.0649733915925026,0.08952290564775467,0.017358558252453804,-0.42640450596809387,0.22377333045005798,-0.022723089903593063,0.06389638036489487,0.3942502737045288,0.3530605137348175,0.07858133316040039,-0.43214982748031616,-0.06104804202914238,-0.008882323279976845,0.14620815217494965,-0.22119885683059692,-0.24568530917167664},{-0.26977989077568054,0.44120272994041443,0.4011616110801697,0.3846015930175781,-0.4940440356731415,-0.08083632588386536,0.5791966915130615,0.5505201816558838,-0.24679768085479736,0.354758083820343,-0.70976722240448,-0.4531342685222626,0.4661380648612976,0.09330902248620987,0.2810208797454834,0.44981667399406433},{0.3671444058418274,-0.2877703011035919,0.6202543377876282,0.07772162556648254,-0.012101843021810055,0.05373387411236763,0.0994006022810936,-0.6609485149383545,-0.2506418228149414,-0.44407662749290466,-0.17120425403118134,0.010563081130385399,-0.06054188683629036,0.7135424613952637,0.44323861598968506,-0.31498241424560547},{0.20695383846759796,-0.5573482513427734,-0.6421570181846619,-0.38599249720573425,-0.24945802986621857,0.23471489548683167,0.13720278441905975,0.14442749321460724,0.6146003007888794,0.2698434591293335,0.20526008307933807,-0.2706705331802368,-0.10380638390779495,0.43285512924194336,-0.22002609074115753,-0.5654868483543396},{0.23247697949409485,0.40108034014701843,0.40416470170021057,-0.6490576267242432,-0.33760643005371094,0.14047591388225555,0.1829347461462021,0.385564923286438,-0.40054187178611755,0.054837994277477264,-0.1017300933599472,-0.029520612210035324,-0.13195112347602844,-0.166990727186203,0.2567843496799469,-0.40117692947387695},{-0.06029453128576279,-0.4491514265537262,0.19404688477516174,0.6499390006065369,0.817866861820221,0.4552554786205292,0.4335840940475464,0.41203615069389343,0.02996812015771866,-0.06385551393032074,0.25542256236076355,-0.46329689025878906,-0.6205770969390869,-0.4143304228782654,0.7794066667556763,-0.047566577792167664},{-0.24653930962085724,0.4093922972679138,-0.06021715700626373,-0.59156733751297,0.17798857390880585,0.06289758533239365,0.20685333013534546,0.1975756138563156,0.07273510098457336,0.06331449747085571,0.04792981594800949,0.19634731113910675,0.38514789938926697,0.34576764702796936,-0.08362933993339539,-0.11709165573120117},{0.0765707939863205,-0.3882089853286743,-0.2634437382221222,-0.21678562462329865,-0.48790985345840454,0.006708537228405476,-0.2945452630519867,-0.29754045605659485,-0.24163363873958588,-0.018439020961523056,-0.45906001329421997,-0.022881995886564255,-0.17843706905841827,0.4173721671104431,0.16559934616088867,-0.029069935902953148},{0.07204469293355942,-0.27453166246414185,-0.23176661133766174,0.18386298418045044,-0.09412108361721039,-0.4520951211452484,0.29536667466163635,-0.08479712158441544,-0.03028162010014057,0.3910033106803894,0.05772773548960686,0.03334417566657066,0.31511664390563965,0.01950184628367424,-0.27722662687301636,0.20368139445781708},{0.3833870589733124,-0.00919017568230629,-0.22399291396141052,-0.1730707436800003,-0.3182758390903473,0.1578807234764099,0.3145677149295807,-0.06270357221364975,0.20118169486522675,0.3459658622741699,-0.1543119102716446,0.04515994340181351,-0.1827598363161087,0.23683948814868927,-0.08191541582345963,-0.005754951387643814},{-0.23870567977428436,-0.17652350664138794,0.22338320314884186,0.11944490671157837,-0.20418715476989746,0.07694477587938309,-0.1650635004043579,-0.08360116928815842,-0.1854681819677353,-0.2693350911140442,-0.03427135944366455,-0.25725704431533813,0.09096882492303848,-0.19902680814266205,0.06538459658622742,-0.21240131556987762},{-0.21391551196575165,0.2508202791213989,-0.31868618726730347,-0.20334893465042114,0.05292534828186035,0.3137094974517822,-0.18077518045902252,-0.19824424386024475,0.13893388211727142,0.16089469194412231,0.3265315294265747,-0.12112554907798767,-0.3242435157299042,0.311644583940506,0.01425927970558405,-0.41230106353759766}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04805650934576988,-0.04151419550180435,-0.09267069399356842,-0.3499668836593628,0.307429701089859,0.2997065484523773,0.07796163856983185,0.0486321747303009,-0.08914782851934433,-0.15062445402145386,-0.009440043941140175,0.06207836791872978,0.2022952437400818,0.3396349251270294,0.10791655629873276,0.06520532816648483},{-0.17098203301429749,-0.3065769672393799,-0.05743982642889023,0.04795404523611069,0.22687704861164093,-0.2998124063014984,0.02973567508161068,0.0629611536860466,-0.05447803810238838,0.27047181129455566,-0.24323730170726776,0.3099110722541809,-0.38881903886795044,0.18359926342964172,-0.34035971760749817,-0.3535152077674866},{0.027235737070441246,0.20924779772758484,-0.3804267942905426,-0.5053536295890808,0.19987493753433228,0.44156065583229065,-0.08502667397260666,0.06847068667411804,-0.27249881625175476,-0.29222819209098816,-0.014004150405526161,0.3357102572917938,-0.2827926576137543,-0.15227428078651428,0.09990756213665009,-0.06819528341293335},{0.1667298823595047,-0.05883605778217316,0.0950368344783783,0.1942572146654129,-0.4749175012111664,-0.00777225848287344,0.09077353775501251,-0.187001571059227,0.2770177125930786,0.36891472339630127,-0.16160117089748383,-0.15344800055027008,-0.4122168719768524,-0.3975197970867157,0.18709395825862885,0.1775514781475067},{-0.06321903318166733,0.15203061699867249,0.012834010645747185,0.2630290687084198,-0.23694558441638947,0.08801952004432678,-0.006832998711615801,0.17981639504432678,0.2448422759771347,-0.23159918189048767,0.18758155405521393,0.23774580657482147,0.18377768993377686,-0.4474247097969055,0.02136879414319992,0.02016153186559677},{0.2036779224872589,0.2642667889595032,-0.029140759259462357,0.19356438517570496,-0.49116531014442444,-0.43954676389694214,0.2695348858833313,0.315616250038147,0.09303410351276398,0.3739842176437378,0.2353316694498062,-0.22806425392627716,-0.0015218991320580244,-0.1458195298910141,-0.1148788258433342,0.29699909687042236},{-0.10994752496480942,0.26360565423965454,0.29033607244491577,-0.3728112578392029,-0.25011205673217773,0.009200932458043098,-0.35670119524002075,-0.04260404035449028,0.19140586256980896,0.08309624344110489,-0.14193221926689148,-0.2240215688943863,-0.32166460156440735,-0.04341142252087593,0.1929835081100464,0.01924903690814972},{-0.11997513473033905,-0.1430288553237915,-0.45419394969940186,0.28883031010627747,-0.3250691294670105,-0.22239995002746582,-0.24105222523212433,-0.391076922416687,0.1469886600971222,-0.22190812230110168,0.05647537484765053,0.07803817093372345,-0.1560210883617401,0.43514060974121094,-0.04765091463923454,-0.3100943863391876},{-0.32777076959609985,0.2605564296245575,-0.013936643488705158,-0.04068417474627495,0.28017550706863403,-0.26856690645217896,0.29058483242988586,0.13987426459789276,0.3516393005847931,0.30799660086631775,0.2534697353839874,0.3061748743057251,0.1725882589817047,-0.062205757945775986,0.2664985656738281,0.0967855378985405},{0.07080235332250595,-0.2678816020488739,-0.15690533816814423,-0.13293859362602234,0.25074705481529236,-0.16434147953987122,-0.29697132110595703,-0.15111084282398224,0.06567639112472534,-0.35301464796066284,-0.26687687635421753,0.3263263702392578,0.12292533367872238,0.13159383833408356,-0.38257232308387756,0.23136970400810242},{-0.04971986263990402,-0.4482704997062683,0.28130489587783813,0.29027658700942993,0.24346087872982025,0.1524132490158081,0.16924113035202026,-0.1282891184091568,0.2327544242143631,-0.2533177435398102,0.19900138676166534,0.3448093831539154,0.49722033739089966,0.1022428646683693,-0.09320563822984695,0.08901455253362656},{0.057920388877391815,-0.006166957784444094,0.42278507351875305,-0.01671305112540722,-0.2538878917694092,-0.17206977307796478,0.43256497383117676,0.30451881885528564,-0.24506880342960358,-0.1802656054496765,-0.06149454414844513,-0.3642841577529907,-0.018509576097130775,-0.29239681363105774,-0.3576297163963318,0.07861532270908356},{-0.1397980898618698,-0.31805741786956787,0.4301559329032898,-0.22467201948165894,0.36802536249160767,-0.30406367778778076,-0.452562540769577,0.07586677372455597,0.07670529931783676,0.058275945484638214,-0.32917580008506775,0.11697331815958023,0.1093449741601944,-0.29611632227897644,-0.3109194338321686,0.007686297874897718},{0.37010082602500916,-0.3424818515777588,0.4486615061759949,0.08045955747365952,-0.0935753732919693,0.32922425866127014,-0.11602123826742172,-0.22248351573944092,-0.3994568884372711,0.11016710102558136,0.01866491325199604,-0.36905354261398315,-0.11878041177988052,0.11322534829378128,0.2966634929180145,0.02860959619283676},{-0.10569418221712112,0.206532284617424,0.12443400919437408,-0.48505035042762756,-0.19283904135227203,0.20480754971504211,0.2426554262638092,-0.25032126903533936,0.21581852436065674,-0.29628226161003113,0.0347723513841629,0.09672721475362778,-0.06213699281215668,0.20503288507461548,0.03617212548851967,0.07279868423938751},{-0.13437682390213013,0.4222342073917389,-0.44321945309638977,0.3712046444416046,0.09027089923620224,-0.3762660026550293,-0.02433033101260662,-0.07177732139825821,-0.31110069155693054,0.4009969234466553,-0.30948537588119507,0.27030062675476074,-0.09044218063354492,-0.32837122678756714,-0.18908198177814484,-0.46915653347969055}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.14231981337070465,0.1077960729598999,-0.0024879351258277893,-0.05119342356920242,-0.10103719681501389,0.01422584056854248,0.26734763383865356,0.08220826834440231,-0.17306220531463623,-0.16718173027038574,0.12644581496715546,-0.27213138341903687,-0.21658998727798462,0.2463652789592743,0.21355174481868744,0.31352686882019043,-0.2643202245235443,-0.2764899432659149,-0.192710742354393,0.12875328958034515,-0.0643046423792839,-0.3285251557826996,-0.2546248733997345,-0.2752320468425751,-0.23555073142051697,0.1372397243976593,-0.21594233810901642,-0.04849953204393387,-0.05686558783054352,-0.011116035282611847,0.22020523250102997,-0.21450375020503998},{0.29448994994163513,0.15443801879882812,0.17675364017486572,-0.08705967664718628,0.1374605894088745,-0.13986673951148987,0.37700703740119934,0.13857229053974152,-0.12981745600700378,-0.08044307678937912,-0.1252930909395218,-0.2668270766735077,-0.1754566729068756,0.24707716703414917,-0.2619611322879791,-0.19821599125862122,-0.040792230516672134,0.19255805015563965,-0.36516818404197693,-0.2273186445236206,-0.029512541368603706,0.21904940903186798,0.025810444727540016,0.027868198230862617,0.21822156012058258,-0.33756595849990845,-0.05135919898748398,0.07407847791910172,0.17575618624687195,-0.11358699947595596,-0.0634937584400177,0.20587848126888275},{0.16838592290878296,0.036043357104063034,-0.14073535799980164,0.14150363206863403,-0.15665952861309052,-0.16165988147258759,-0.21516406536102295,0.054447025060653687,-0.156300887465477,0.3510552644729614,-0.3220299482345581,-0.28040751814842224,0.16965602338314056,-0.40070128440856934,-0.15843789279460907,0.09698891639709473,-0.09313526749610901,-0.12277978658676147,0.18125618994235992,-0.09802252799272537,0.24165284633636475,0.2762327492237091,-0.23776686191558838,0.023388322442770004,-0.2697746157646179,-0.016705293208360672,0.12469420582056046,-0.07963443547487259,-0.03271448239684105,-0.2204740196466446,-0.12480922043323517,-0.08152463287115097},{0.4138789176940918,0.05153054744005203,0.15203982591629028,-0.18650664389133453,-0.256719708442688,-0.047240000218153,-0.14126957952976227,0.293514221906662,0.23798634111881256,-0.3046131432056427,-0.07077529281377792,0.27973470091819763,0.11250406503677368,-0.02731405198574066,-0.24470730125904083,0.30415263772010803,-0.297481894493103,0.2646547555923462,0.022587234154343605,0.1291884332895279,-0.10017471760511398,-0.10280942916870117,0.2863975763320923,0.1674155741930008,0.17932385206222534,-0.38289839029312134,0.26341331005096436,-0.2105323225259781,-0.06175100430846214,0.07867852598428726,-0.1946624368429184,0.12967917323112488},{-0.06475783884525299,-0.06882326304912567,-0.10933439433574677,0.12270911782979965,0.2181592881679535,-0.1517927646636963,-0.4167539179325104,-0.08836577087640762,-0.10136815160512924,-0.31003931164741516,0.14226572215557098,0.24712570011615753,-0.03740980848670006,-0.11067165434360504,-0.09724064916372299,0.11824852228164673,-0.018230602145195007,-0.041901350021362305,-0.307270348072052,-0.1980627477169037,-0.16640709340572357,-0.3647601902484894,0.13619859516620636,0.1434253603219986,-0.09909311681985855,0.3470954895019531,-0.1838628351688385,0.20624250173568726,0.3188099265098572,0.39109861850738525,-0.029846152290701866,0.3847754895687103},{-0.2874504029750824,0.013699967414140701,-0.22692616283893585,-0.05690869688987732,-0.20351998507976532,0.23684051632881165,0.20372600853443146,0.013856993988156319,0.26369258761405945,0.2326117902994156,0.33194756507873535,-0.22852723300457,-0.2645331919193268,0.19550110399723053,0.33228600025177,-0.330635130405426,-0.12821464240550995,-0.2563777267932892,0.22201092541217804,0.10282406210899353,0.09121393412351608,0.17635534703731537,0.06186879798769951,-0.07538040727376938,-0.34937211871147156,0.35560616850852966,-0.14499832689762115,0.203097864985466,0.34088122844696045,0.18358106911182404,0.055720746517181396,0.02251550927758217},{0.20513181388378143,-0.1553696244955063,-0.1278131604194641,-0.3161308765411377,-0.04828653484582901,0.2341976761817932,0.30675002932548523,0.18253278732299805,0.09005769342184067,0.34903064370155334,-0.01078331284224987,-0.02330975979566574,-0.4502590596675873,-0.17090120911598206,-0.16118121147155762,0.16326846182346344,-0.2654764652252197,-0.22376638650894165,0.21680906414985657,-0.07470645755529404,-0.125980406999588,-0.15361538529396057,-0.235178142786026,-0.21365220844745636,0.14190001785755157,-0.23020750284194946,-0.0857710912823677,-0.2083827555179596,0.29519176483154297,0.12685127556324005,-0.1674148142337799,-0.2961002588272095},{0.023341482505202293,0.15048451721668243,0.07098428159952164,-0.004237946588546038,0.12557353079319,-0.3290574252605438,-0.12973226606845856,-0.1636458784341812,-0.011758825741708279,-0.23910187184810638,-0.3133586347103119,-0.032942116260528564,-0.12056640535593033,-0.02559131756424904,-0.12503626942634583,0.37833449244499207,-0.013169334270060062,-0.16336646676063538,0.12381316721439362,0.34010589122772217,-0.10013482719659805,-0.25020045042037964,0.25075042247772217,0.09835002571344376,-0.03668699041008949,-0.31613725423812866,-0.3091683089733124,-0.3192904591560364,-0.34230417013168335,-0.2274458259344101,0.038014840334653854,-0.3005024492740631},{0.08627747744321823,0.3139581084251404,-0.2681390643119812,-0.31777653098106384,-0.22372210025787354,0.07262834161520004,0.06606309115886688,0.0752580463886261,0.1398504376411438,-0.28128382563591003,-0.21269886195659637,0.3288668096065521,-0.24575944244861603,-0.1974538415670395,0.19609041512012482,-0.27425098419189453,0.26703429222106934,0.15537983179092407,0.3404509425163269,0.031408973038196564,0.21442389488220215,0.06034429371356964,0.26649802923202515,-0.0918600857257843,0.3674338757991791,-0.21099266409873962,0.118695467710495,0.3286427855491638,-0.2864075303077698,0.21552954614162445,-0.01638498157262802,0.1546093374490738},{-0.17734460532665253,0.13170230388641357,-0.23010791838169098,-0.16411438584327698,0.1870245486497879,-0.14436325430870056,0.08923610299825668,-0.0001776665885699913,0.14791883528232574,-0.04870771989226341,-0.26740142703056335,-0.2836611568927765,-0.3196881115436554,-0.05580760911107063,-0.2418825924396515,0.09627249091863632,0.07421893626451492,-0.1970827877521515,0.2730787396430969,0.10407982021570206,-0.0028436053544282913,-0.010478767566382885,0.2802808880805969,-0.20031912624835968,0.3116626441478729,0.10083597153425217,-0.2557780146598816,0.02348313294351101,-0.029488010331988335,0.13985486328601837,-0.10942401736974716,0.09451710432767868},{0.09277621656656265,0.02269645221531391,0.21642692387104034,-0.26976555585861206,-0.3168722987174988,-0.23803085088729858,-0.2767009437084198,0.011329123750329018,-0.21834994852542877,0.4272458553314209,0.15421494841575623,-0.23641255497932434,-0.38528937101364136,-0.0456329770386219,-0.21538692712783813,-0.09089621901512146,0.21738427877426147,-0.15872858464717865,0.28131812810897827,-0.1458963006734848,-0.18939292430877686,0.003724632551893592,0.16244865953922272,0.23048926889896393,0.16888540983200073,-0.1249735951423645,0.0007150968885980546,-0.08517201244831085,-0.060695335268974304,0.034687284380197525,-0.026580210775136948,0.12467097491025925},{-0.16590534150600433,-0.13389171659946442,0.21567164361476898,0.28789398074150085,0.26547715067863464,-0.055987220257520676,0.07289440184831619,-0.22030140459537506,-0.015398422256112099,-0.26148268580436707,0.25834760069847107,-0.22235725820064545,-0.19762998819351196,-0.19911934435367584,0.23984184861183167,-0.00046729817404411733,-0.012474640272557735,0.01525962445884943,0.3527236580848694,0.051760874688625336,-0.1735580712556839,0.20904484391212463,0.09908679872751236,-0.05520455166697502,0.23948323726654053,-0.10093893110752106,-0.1834276169538498,0.20439413189888,0.14492425322532654,0.014381335116922855,-0.30801865458488464,-0.23209306597709656},{0.3029080331325531,-0.2563983201980591,0.006812382955104113,-0.3164665699005127,-0.022375792264938354,-0.16305461525917053,0.10563052445650101,0.16584840416908264,0.21791048347949982,0.06322681158781052,0.19400295615196228,0.26505404710769653,-0.43033406138420105,-0.3617337942123413,-0.02883298695087433,-0.21686451137065887,-0.2571865916252136,-0.31149008870124817,0.32815757393836975,-0.17226672172546387,0.3409293591976166,-0.10763214528560638,0.008845235221087933,0.19198110699653625,0.12607240676879883,-0.11429359763860703,0.12753529846668243,0.036400698125362396,0.09812285751104355,-0.004318815190345049,-0.2765587568283081,0.00621380377560854},{0.2583805024623871,-0.036189574748277664,-0.020054638385772705,0.3528984487056732,-0.0937737226486206,-0.16672870516777039,-0.02962583862245083,0.16831979155540466,0.18936432898044586,0.24560557305812836,0.12318213284015656,-0.12830032408237457,0.057098016142845154,0.21363472938537598,-0.1208004578948021,0.11846420168876648,0.23570400476455688,-0.23699530959129333,0.11375875771045685,-0.34293133020401,0.24774008989334106,0.16327619552612305,-0.08925482630729675,0.20022934675216675,0.24786688387393951,0.08172596246004105,0.1551916003227234,0.0966654047369957,0.0792505219578743,-0.14376647770404816,0.029806014150381088,0.360176146030426},{0.07401052117347717,-0.20070049166679382,0.006869356147944927,0.10353263467550278,-0.27372848987579346,-0.0012900142464786768,0.04722404479980469,-0.21556289494037628,-0.15844428539276123,-0.030372582376003265,0.17899715900421143,0.2073339819908142,0.09879656881093979,0.2510029673576355,-0.03826575726270676,-0.032810844480991364,-0.218197301030159,0.26118290424346924,-0.06742026656866074,-0.21619825065135956,-0.21248306334018707,-0.1034359335899353,0.1349274069070816,0.045384425669908524,-0.00312718260101974,-0.14014220237731934,-0.17356249690055847,0.22043710947036743,0.05474058911204338,-0.14487944543361664,0.26645034551620483,0.16609685122966766},{0.17275293171405792,-0.2364833950996399,0.023425526916980743,-0.19120602309703827,0.00013906016829423606,0.1518140435218811,0.06902159005403519,0.2652314007282257,-0.08810696005821228,-0.028389817103743553,0.21480265259742737,0.12463372200727463,0.05965295061469078,-0.09914112836122513,-0.013506348244845867,0.2027485966682434,-0.3351570963859558,-0.18708422780036926,-0.03139341250061989,0.08262992650270462,0.038236238062381744,0.2456015646457672,0.142983078956604,0.19003908336162567,0.0624772310256958,0.17987775802612305,-0.029210185632109642,-0.061564404517412186,0.08391226828098297,-0.09542090445756912,-0.2557104527950287,0.31705981492996216},{0.16298623383045197,0.02005263790488243,-0.35385382175445557,0.11641369014978409,0.04412763938307762,-0.04220859333872795,0.3271454870700836,0.11280666291713715,0.1007305160164833,-0.11453177779912949,0.21233850717544556,-0.24504125118255615,-0.4019744098186493,0.23878096044063568,0.08872369676828384,0.0525905005633831,-0.02363370731472969,-0.09988895803689957,-0.15440675616264343,0.06624731421470642,-0.03239656612277031,0.21614226698875427,0.1010008454322815,-0.16862118244171143,-0.07572720944881439,-0.23245671391487122,0.06699428707361221,0.32950010895729065,0.22208799421787262,-0.1914302259683609,0.18209707736968994,0.17658579349517822},{-0.06895485520362854,0.0068044173531234264,-0.07969285547733307,-0.07648392021656036,-0.237675741314888,-0.037054963409900665,0.21648119390010834,0.17839986085891724,0.1343860775232315,0.015171893872320652,0.1831192970275879,-0.005127291660755873,0.240931436419487,0.20028024911880493,0.17734776437282562,-0.1034790575504303,0.11514060944318771,0.19228048622608185,0.21401944756507874,0.052715543657541275,0.19909560680389404,0.2759009897708893,0.08455081284046173,0.16722625494003296,-0.027544226497411728,-0.07508828490972519,-0.13196688890457153,-0.2520160675048828,0.13583308458328247,-0.27429765462875366,0.029812637716531754,-0.06257038563489914},{-0.33732882142066956,0.046200353652238846,-0.33219441771507263,-0.32682251930236816,0.03422805666923523,-0.0019776681438088417,0.12176311016082764,-0.1632058471441269,0.05833931639790535,0.34930017590522766,0.01975223794579506,-0.2236626297235489,0.06248221918940544,-0.19339707493782043,-0.3076430559158325,0.013812572695314884,-0.17005282640457153,0.12082954496145248,-0.06822697818279266,0.009768401272594929,-0.29521214962005615,0.15333350002765656,0.10273191332817078,0.04703935235738754,-0.0860837772488594,0.34216734766960144,0.04499666765332222,-0.2011726200580597,-0.19406621158123016,0.019970141351222992,-0.20640821754932404,-0.25893622636795044},{-0.007715446874499321,-0.26145485043525696,-0.28174668550491333,-0.050607770681381226,-0.32737767696380615,-0.1494908481836319,0.18413357436656952,-0.27885475754737854,-0.21963967382907867,0.17708046734333038,0.20077259838581085,0.09034772217273712,0.12116353958845139,-0.15326185524463654,0.2771840989589691,-0.26941996812820435,0.09050798416137695,0.25694313645362854,0.04761303588747978,0.27659088373184204,0.011445361189544201,-0.12034463882446289,-0.27835899591445923,0.22285297513008118,-0.11443182826042175,-0.1562100648880005,0.11876572668552399,0.042147181928157806,-0.11883874237537384,-0.32611265778541565,-0.03460432216525078,-0.19031040370464325},{0.23005278408527374,0.10533361881971359,-0.05145720764994621,0.21593134105205536,-0.23731757700443268,0.10558097064495087,-0.08381198346614838,-0.18951229751110077,-0.09426818788051605,0.2019597589969635,-0.3371598422527313,-0.1410149186849594,0.023997535929083824,-0.20507290959358215,-0.39280492067337036,-0.1577642858028412,-0.10569899529218674,-0.31419339776039124,-0.2563740909099579,0.2200256586074829,0.14324204623699188,0.09055706858634949,-0.3857429027557373,0.32422083616256714,0.14744235575199127,0.30039358139038086,-0.3112415373325348,-0.10318083316087723,0.0779397189617157,-0.20504923164844513,0.11957456916570663,0.16456565260887146},{-0.05194287374615669,-0.30335479974746704,-0.04444153234362602,-0.3077661097049713,-0.0727715715765953,0.292228102684021,0.2064352184534073,0.03298715874552727,-0.10032473504543304,0.01230618916451931,-0.1521075963973999,0.1015806570649147,0.10530858486890793,0.05753585323691368,0.11623414605855942,0.03521395102143288,-0.08474364131689072,0.13951663672924042,-0.11449332535266876,0.14888538420200348,0.19147849082946777,0.2525607943534851,-0.031732507050037384,-0.24883942306041718,0.16895802319049835,0.15940231084823608,0.2814575731754303,0.1670016646385193,0.024333138018846512,0.11094997078180313,0.01585034653544426,-0.10297749191522598},{-0.0336812324821949,-0.20721983909606934,0.21460896730422974,0.0637005940079689,0.2746712267398834,-0.01952674798667431,-0.12667852640151978,-0.20438040792942047,0.13249175250530243,-0.03582625091075897,0.08263988047838211,0.0007646784652024508,-0.34022021293640137,0.05978350713849068,-0.09165273606777191,-0.25953108072280884,-0.04458896815776825,-0.06436999142169952,0.17518940567970276,0.1899605393409729,0.023167671635746956,0.05679174140095711,0.1665610671043396,0.29286789894104004,-0.19282755255699158,-0.031231733039021492,0.16880905628204346,-0.06719869375228882,-0.13650180399417877,-0.2691600024700165,0.29297935962677,0.020299868658185005},{0.1941378265619278,-0.08216893672943115,0.04124176502227783,0.09434332698583603,-0.018318381160497665,0.040545057505369186,-0.2238960713148117,0.3062226176261902,-0.11496397107839584,-0.021045615896582603,0.11297798901796341,-0.3195914328098297,0.08412756770849228,-0.04920799657702446,-0.12785600125789642,0.32579469680786133,-0.08889586478471756,-0.17064598202705383,0.00899041723459959,0.02233138494193554,-0.1818639189004898,0.17766894400119781,0.21667741239070892,0.25877293944358826,-0.2607685923576355,0.11552359163761139,-0.08028355985879898,0.06548409909009933,-0.2738899290561676,0.2324506640434265,-0.06040273234248161,0.021267129108309746}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.22261561453342438,-0.12871411442756653,0.07642437517642975,-0.1493508219718933},{0.20265547931194305,-0.2511651813983917,0.2713891565799713,0.228944793343544},{-0.26419365406036377,0.0348021499812603,0.09099669009447098,-0.029457954689860344},{0.29264312982559204,0.42359480261802673,0.304083913564682,0.03642076998949051},{-0.2699122726917267,0.15695767104625702,-0.26938027143478394,0.1278456151485443},{0.02279357612133026,-0.08877544105052948,0.07277943938970566,0.29350587725639343},{-0.10498946160078049,-0.18050546944141388,-0.35883793234825134,-0.04275715351104736},{-0.10922250151634216,-0.3535141944885254,0.14659620821475983,-0.06188689544796944},{-0.10824348777532578,0.15215136110782623,-0.0870562195777893,-0.09739160537719727},{0.23336300253868103,-0.010610461235046387,-0.09462805092334747,-0.17915688455104828},{0.2271566241979599,-0.19623883068561554,0.2959511876106262,0.22765561938285828},{-0.034953296184539795,0.002806205302476883,0.37914231419563293,-0.08766327053308487},{-0.3038399815559387,0.23393124341964722,-0.04463609308004379,-0.0839318260550499},{-0.16649003326892853,0.0068787746131420135,-0.2205888032913208,0.0575668103992939},{0.2009267807006836,-0.03825845941901207,0.22150030732154846,0.07233063131570816},{-0.14119331538677216,-0.2790020704269409,-0.11956876516342163,-0.08097905665636063},{-0.25450438261032104,0.04684390500187874,-0.05780114233493805,0.297954261302948},{-0.2652152478694916,-0.13763348758220673,-0.22928574681282043,0.1874467432498932},{-0.07049036026000977,-0.11694423109292984,0.37132883071899414,0.06891270726919174},{-0.14483676850795746,-0.16819895803928375,-0.01658753864467144,-0.17471902072429657},{0.15826380252838135,0.12143750488758087,0.12141706049442291,-0.1539670079946518},{-0.0025087010581046343,-0.26333534717559814,-0.15146158635616302,0.2559881806373596},{0.28415027260780334,-0.15447036921977997,0.17372649908065796,0.03185192123055458},{-0.2767813801765442,-0.08582106977701187,-0.284776508808136,-0.21744869649410248},{-0.24739989638328552,-0.17373855412006378,-5.191631134948693e-05,-0.12056273221969604},{0.18241004645824432,0.18720777332782745,-0.06452595442533493,0.15381503105163574},{0.19005389511585236,-0.20740261673927307,0.22379449009895325,0.08313014358282089},{-0.04356210306286812,-0.15565377473831177,0.010290184058248997,0.3007522523403168},{0.05471130087971687,0.03741639479994774,0.03105459176003933,0.01567964255809784},{-0.1582304686307907,0.10115638375282288,0.23763442039489746,0.019217437133193016},{-0.138220876455307,-0.13440336287021637,0.08571122586727142,0.20082207024097443},{0.19800227880477905,0.21137972176074982,0.23691752552986145,-0.017150787636637688}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.05472232773900032,0.004250216763466597,-0.009297212585806847,0.04380136728286743,0.04102720320224762,-0.05368302762508392,-0.009446252137422562,0.05626300349831581,-0.06958401203155518,-0.07751407474279404,-0.004232313483953476,0.05669813230633736,-0.019846992567181587,0.04973634332418442,-0.02415088564157486,-0.030076397582888603};
static const float actor_encoder_self_encoder_2_bias[16] = {0.007770720403641462,-0.01293617207556963,-0.008535582572221756,-0.008786670863628387,-0.05350055918097496,0.02089734561741352,-0.025195948779582977,-0.005858635995537043,0.018843557685613632,-0.03315502777695656,0.004239843226969242,-0.01763984188437462,-0.012153733521699905,-0.02601456083357334,-0.01831350103020668,-0.03975894674658775};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.003176651429384947,0.062008295208215714,-0.021448766812682152,0.015231131576001644,-0.016147155314683914,0.03223303332924843,-0.04295828193426132,-0.012802754528820515,-0.022739820182323456,-0.021213889122009277,-0.006150349508970976,0.02793867141008377,0.006695770192891359,0.01147329993546009,0.05239382013678551,-0.047242071479558945,0.015815069898962975,-0.006410414818674326,0.018160397186875343,-0.034919220954179764,-0.006104018539190292,0.03174566105008125,2.5720257326611318e-05,-0.04374418035149574,-0.05691589042544365,0.01867069862782955,0.025017913430929184,0.029410196468234062,-0.007256462238729,0.021045956760644913,0.029123149812221527,0.0032180019188672304};
static const float action_parameterization_distribution_linear_bias[4] = {0.009074794128537178,0.013717755675315857,0.011204070411622524,0.03781475871801376};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.40669137239456177,-0.3898000121116638,-0.1425689458847046,0.22077247500419617,-0.19711045920848846,0.11299765110015869,-0.31147336959838867,0.044520385563373566},{0.2007608264684677,0.09827788174152374,0.3971380591392517,0.37398022413253784,-0.1207437813282013,-0.33479011058807373,0.31815770268440247,0.39358073472976685},{0.06893324851989746,0.15952369570732117,0.1089666560292244,-0.053720634430646896,0.33459797501564026,0.23099009692668915,-0.008021315559744835,0.23743653297424316},{0.11800755560398102,-0.38589251041412354,0.33596059679985046,-0.15893763303756714,-0.22697557508945465,0.11294830590486526,0.32449260354042053,0.2520262897014618},{-0.24029730260372162,-0.0945688933134079,-0.0424349419772625,-0.2703321874141693,0.14901475608348846,0.13578291237354279,0.36014655232429504,0.2810901999473572},{-0.039181195199489594,0.18899719417095184,-0.003484289161860943,-0.19965717196464539,0.3462347686290741,0.12976467609405518,0.12844111025333405,-0.16644591093063354},{0.015226399526000023,0.14915284514427185,0.1468946635723114,-0.15049061179161072,0.4364459812641144,-0.09519187361001968,0.16588559746742249,0.09121853113174438},{0.061157841235399246,-0.46600091457366943,-0.028899526223540306,-0.23018112778663635,0.2911166548728943,0.05720003321766853,-0.16056740283966064,-0.34646010398864746},{-0.2535709738731384,0.15781907737255096,0.0017276016296818852,-0.08040370047092438,0.022537410259246826,0.46127551794052124,0.3756331205368042,0.28814613819122314},{0.001600353280082345,-0.14818675816059113,-0.2778319716453552,0.27459466457366943,0.2964039742946625,0.3262771964073181,0.33831271529197693,-0.32824891805648804},{-0.15423278510570526,-0.38537701964378357,0.3580072522163391,0.17888420820236206,0.025004638358950615,-0.2638644874095917,0.034764595329761505,-0.333901047706604},{0.249001607298851,0.027659054845571518,0.4094376564025879,0.40276455879211426,-0.10069943964481354,0.33189260959625244,0.21088948845863342,-0.33273470401763916},{-0.37584826350212097,0.13340409100055695,-0.3533999025821686,0.4350995123386383,-0.013242418877780437,0.42501604557037354,-0.0016492829890921712,0.25996676087379456},{-0.05704142153263092,0.16477003693580627,-0.1350322812795639,-0.11880683898925781,0.024780821055173874,0.16199138760566711,0.27882787585258484,-0.0031491112895309925},{0.11597583442926407,-0.36255350708961487,-0.3641538619995117,-0.17388798296451569,0.13265839219093323,-0.1443442404270172,0.09802601486444473,-0.11475363373756409},{-0.47333624958992004,-0.35835614800453186,-0.29939234256744385,-0.016614899039268494,-0.05398492515087128,0.22568729519844055,0.1587548553943634,-0.11882156878709793},{-0.17837606370449066,-0.3289484977722168,0.22034616768360138,-0.36265647411346436,-0.0031603900715708733,0.04146591201424599,-0.43079259991645813,-0.30518779158592224},{0.06594857573509216,0.21743372082710266,0.1279529184103012,0.19494038820266724,-0.11626003682613373,0.33591797947883606,0.2797427475452423,-0.22213025391101837},{0.06869115680456161,-0.33944758772850037,-0.08668482303619385,-0.053179819136857986,-0.14491377770900726,-0.3406440317630768,0.03751515969634056,-0.3125661015510559},{-0.029297076165676117,-0.008552610874176025,0.09810329228639603,-0.3009687066078186,0.0442500039935112,0.1207212433218956,0.07051167637109756,-0.15010669827461243},{0.10133711993694305,-0.11393184214830399,0.05866340920329094,-0.2549247443675995,-0.005780111998319626,-0.003414295380935073,-0.03947704657912254,-0.2694724500179291},{-0.30698734521865845,0.16950489580631256,0.1293872743844986,-0.23399507999420166,-0.47263193130493164,0.007676651235669851,0.1230146661400795,-0.01659667119383812},{0.3008342385292053,0.105750173330307,-0.43682873249053955,0.12712129950523376,-0.07147429138422012,0.21699421107769012,0.22305616736412048,0.2689405381679535},{0.030521735548973083,-0.1202809289097786,-0.041345272213220596,0.3190494179725647,-0.32896891236305237,-0.07836128771305084,-0.17012284696102142,-0.33867859840393066},{0.2356799691915512,0.07295849919319153,-0.47112658619880676,0.3330332040786743,-0.3068881928920746,-0.3481973707675934,-0.3447950482368469,0.15311092138290405},{0.07295257598161697,0.34720519185066223,-0.32829904556274414,-0.05401800945401192,0.07766471058130264,-0.2521131932735443,0.3146486282348633,-0.3013593554496765},{-0.047799885272979736,0.053971391171216965,-0.16404195129871368,-0.13763581216335297,0.03802108019590378,-0.17979994416236877,-0.09249614179134369,-0.14696885645389557},{0.17206665873527527,-0.18956787884235382,-0.06750772893428802,-0.08705206215381622,0.009873154573142529,0.003616997739300132,-0.1991140991449356,0.08538635075092316},{0.3823222517967224,0.03994055837392807,-0.406152606010437,-0.1812230348587036,-0.24953772127628326,0.1062830314040184,0.2365415245294571,0.07113266736268997},{0.4243382215499878,-0.3088158667087555,-0.04321757331490517,-0.02758614905178547,0.11336828768253326,-0.12583954632282257,0.2120683491230011,0.33604753017425537},{-0.20847271382808685,-0.1670105755329132,0.026654409244656563,-0.23069657385349274,0.33216995000839233,-0.2567761242389679,0.05133035406470299,0.09228742867708206},{0.23267529904842377,0.026947274804115295,-0.1468794047832489,0.3630562126636505,0.09507681429386139,0.009854009374976158,-0.030209403485059738,0.039758987724781036}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24110405147075653,0.4028235077857971,-0.606705904006958,-0.5425676703453064,-0.25878480076789856,0.06309743970632553,-0.4097026288509369,0.5451613664627075},{-0.03714524582028389,0.5462102890014648,-0.21322956681251526,0.5018172860145569,-0.01820290833711624,0.03230610489845276,-0.2542136609554291,-0.002868002513423562},{-0.4619368612766266,-0.19127844274044037,-0.15902239084243774,-0.24960854649543762,0.5205869078636169,0.1758851706981659,-0.003309841500595212,0.43145501613616943},{-0.4799165725708008,-0.44564780592918396,0.2715030610561371,0.3878073990345001,-0.5151910781860352,-0.17915695905685425,0.44401517510414124,0.190834179520607},{-0.28675517439842224,-0.318778395652771,-0.2908935844898224,-0.29738298058509827,0.32466816902160645,-0.2651529312133789,0.46573320031166077,-0.41905322670936584},{-0.07941759377717972,0.15669159591197968,0.29431116580963135,-0.5467495918273926,0.5380914807319641,-0.3072829842567444,-0.4092952013015747,-0.3014465570449829},{-0.41110050678253174,0.15506696701049805,0.07068217545747757,-0.3441065549850464,-0.02363402023911476,-0.5310655832290649,0.5113513469696045,0.07484086602926254},{-0.3887385427951813,-0.3138849437236786,-0.21570158004760742,-0.4425044655799866,-0.3036859929561615,0.08878044784069061,0.4707092344760895,-0.3153764307498932}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.02269425429403782,-0.0555068701505661,-0.02240670658648014,0.009661138989031315,-0.03260420262813568,-0.012074001133441925,-0.09288156777620316,0.009806351736187935};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.014386829920113087,-0.05407681316137314,-0.01640121266245842,0.07763694226741791,-0.02593792788684368,0.03952452167868614,-0.029475100338459015,0.04893993213772774};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

