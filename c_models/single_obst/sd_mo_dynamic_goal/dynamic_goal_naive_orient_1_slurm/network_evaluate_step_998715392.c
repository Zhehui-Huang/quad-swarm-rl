#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3921353220939636,-0.19889189302921295,0.3832268714904785,0.14002634584903717,-0.4279276728630066,0.11862464994192123,0.010965007357299328,-0.206483393907547,0.10104553401470184,0.4570026099681854,0.08004558831453323,-0.012075691483914852,0.15725190937519073,-0.1172531321644783,0.43134841322898865,-0.12869003415107727},{-0.3707699775695801,-0.17933127284049988,0.27526041865348816,0.14408303797245026,-0.2781035900115967,-0.01798401027917862,-0.38806232810020447,0.05698242783546448,-0.15930424630641937,-0.11653050780296326,0.11906560510396957,-0.14224430918693542,0.16027215123176575,-0.30744603276252747,-0.24224890768527985,0.0952720195055008},{0.14783942699432373,-0.2196454554796219,-0.2338593751192093,0.01670232228934765,0.11801206320524216,0.16212090849876404,-0.07179521024227142,-0.008178465068340302,-0.06490273773670197,-0.20788292586803436,-0.2093520313501358,0.40720659494400024,0.02048693597316742,-0.15740922093391418,-0.32623231410980225,0.21510641276836395},{0.1916925013065338,0.18178513646125793,0.2821398377418518,-0.06350149214267731,-0.3640539348125458,0.01009681448340416,0.13596221804618835,0.0903165340423584,0.5229487419128418,-0.3811110258102417,0.013802207075059414,0.11859743297100067,-0.265503466129303,-0.07275567203760147,0.29935523867607117,-0.3543321192264557},{-0.08484801650047302,0.17590081691741943,0.2213280200958252,-0.09651360660791397,0.21930046379566193,0.2556494176387787,0.23330193758010864,-0.0438089482486248,-0.07436953485012054,0.23482410609722137,0.29099562764167786,-0.10432267189025879,-0.07760537415742874,-0.37299028038978577,0.32062608003616333,0.12802369892597198},{-0.07588305324316025,-0.19019488990306854,-0.18105070292949677,-0.2881026566028595,0.11988432705402374,0.05428257957100868,-0.04517915099859238,-0.1552283614873886,0.22576822340488434,-0.25190430879592896,-0.32804712653160095,0.21407359838485718,0.3828018605709076,-0.03462953865528107,-0.12120195478200912,0.2167847901582718},{-0.12641304731369019,0.10800879448652267,0.051578447222709656,-0.23993711173534393,0.265194833278656,0.031594716012477875,0.06934745609760284,0.3882652223110199,0.24733568727970123,-0.03601151332259178,-0.4043533205986023,0.2832317352294922,-0.04330775514245033,0.16454707086086273,-0.19155286252498627,-0.130057692527771},{0.05357663705945015,-0.10942137241363525,0.20316195487976074,0.20296147465705872,-0.3250424265861511,-0.020081719383597374,0.273694783449173,0.32121753692626953,-0.009289600886404514,0.17902477085590363,-0.4243007004261017,-0.2719109356403351,0.2361787110567093,0.2388344407081604,0.22362926602363586,0.15525661408901215},{0.3438197374343872,-0.17732790112495422,0.3743049204349518,-0.031376373022794724,0.1102144867181778,0.11976605653762817,-0.23805315792560577,-0.23029522597789764,0.21148033440113068,-0.2743222415447235,0.0053672827780246735,-0.2766615152359009,-0.1865234524011612,0.3084711730480194,0.15934941172599792,-0.08715119957923889},{0.04555230587720871,-0.12743301689624786,-0.4260907471179962,-0.07662603259086609,-0.33125513792037964,0.21685168147087097,0.39106494188308716,0.17639963328838348,0.39419034123420715,0.3953036665916443,0.009907297790050507,-0.3055671453475952,0.07242398709058762,0.2849832773208618,-0.10045834630727768,-0.39818304777145386},{-0.001658222870901227,0.26076337695121765,0.3406672775745392,-0.2688426077365875,-0.28738632798194885,0.1973671317100525,0.20561321079730988,0.340946227312088,-0.3045840263366699,-0.031579215079545975,-0.03514837846159935,0.19232526421546936,-0.2709212899208069,-0.19050824642181396,0.3302851915359497,-0.3881720006465912},{0.0030964696779847145,-0.17618495225906372,0.01138282846659422,0.19611531496047974,0.3474734127521515,0.3408007323741913,0.416727751493454,-0.03326814994215965,0.007225614972412586,-0.06645724177360535,0.29163601994514465,-0.17545634508132935,0.03168243542313576,-0.22777292132377625,0.307892769575119,0.30211228132247925},{-0.08152274787425995,0.2554458975791931,0.10462722182273865,-0.3431040048599243,0.09370910376310349,0.10042817890644073,0.3425195515155792,-0.057652249932289124,0.09374798834323883,0.023508621379733086,-0.0863168016076088,0.17897264659404755,0.1341160535812378,0.2584124207496643,0.14826525747776031,-0.297037273645401},{-0.2238834947347641,-0.24417264759540558,-0.23745018243789673,0.002225408796221018,-0.16639074683189392,0.07048516720533371,-0.2706200182437897,0.045531004667282104,-0.006200165022164583,-0.04132984206080437,-0.2746583819389343,-0.02100474387407303,-0.36643144488334656,0.07802467048168182,0.21004001796245575,0.08332078903913498},{-0.265268474817276,-0.3076246380805969,-0.276956707239151,0.32484984397888184,0.13454550504684448,-0.3687106966972351,0.2757956385612488,-0.13268285989761353,0.096037358045578,0.2973167896270752,0.09339546412229538,0.20041170716285706,0.1884291023015976,-0.003925195895135403,-0.23437240719795227,0.27960607409477234},{0.4110957086086273,-0.07499344646930695,-0.24532192945480347,-0.3755825161933899,-0.5906062126159668,0.2865794003009796,0.4501294493675232,-0.26973333954811096,0.1526051014661789,0.0740022286772728,-0.310352623462677,0.11854739487171173,-0.49758708477020264,0.5796918272972107,-0.2872689366340637,0.011038911528885365},{-0.3373970091342926,-0.36434051394462585,0.4072938859462738,0.3193891942501068,-0.25523295998573303,0.24267713725566864,-0.07790899276733398,-0.24384331703186035,0.27950742840766907,-0.4160633683204651,-0.3052213490009308,-0.655593752861023,-0.330290824174881,-0.44767799973487854,0.07979188114404678,-0.2349780648946762},{-0.3577849566936493,0.26778239011764526,-0.5491008162498474,-0.04863220453262329,0.0017637566197663546,0.3409166634082794,-0.39313530921936035,-0.411030650138855,0.22633297741413116,0.14735881984233856,0.38463348150253296,-0.0243234820663929,-0.22947944700717926,0.2510463297367096,0.1325870156288147,-0.46439501643180847}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04338861256837845,-0.09962641447782516,-0.20701844990253448,-0.41618895530700684,0.34808820486068726,0.27928802371025085,0.04497537389397621,0.06658859550952911,-0.17998334765434265,-0.11316168308258057,-0.057219576090574265,0.060361966490745544,0.19346345961093903,0.42430925369262695,0.06684884428977966,0.10478843003511429},{-0.1264415979385376,-0.2275724709033966,-0.05667159706354141,0.14476889371871948,0.3090127408504486,-0.21876347064971924,0.12297393381595612,0.04500572383403778,-0.05285687372088432,0.2585737705230713,-0.14983798563480377,0.34035277366638184,-0.3424701690673828,0.18653085827827454,-0.3174225687980652,-0.24589960277080536},{0.11238907277584076,0.17304590344429016,-0.3147159516811371,-0.6117286086082458,0.16988712549209595,0.429583877325058,-0.08582770824432373,0.10416918247938156,-0.239090234041214,-0.23452122509479523,-0.01747061498463154,0.2739354074001312,-0.24200581014156342,-0.2179458737373352,0.11025539040565491,-0.01874946616590023},{0.1417822688817978,-0.02696572057902813,0.062285177409648895,0.15021730959415436,-0.4874662160873413,-0.0004084138781763613,0.06670550256967545,-0.2688853144645691,0.3090866208076477,0.32486584782600403,-0.10790082812309265,-0.20137158036231995,-0.42225027084350586,-0.3254346549510956,0.17942969501018524,0.23855368793010712},{-0.040010809898376465,0.08927037566900253,0.023815732449293137,0.3406761884689331,-0.23839953541755676,0.007913194596767426,-0.04035218432545662,0.21838293969631195,0.2192004770040512,-0.2879192531108856,0.009415886364877224,0.36787405610084534,0.10280768573284149,-0.4362911283969879,-0.050153642892837524,-0.14305707812309265},{0.14234592020511627,0.11425964534282684,-0.010334955528378487,0.16078071296215057,-0.34196096658706665,-0.3973541259765625,0.16220271587371826,0.2701346278190613,0.13739122450351715,0.410765677690506,0.19770456850528717,-0.2537752687931061,0.0168168768286705,-0.15937888622283936,-0.09250535070896149,0.2939373552799225},{-0.025217872112989426,0.1372797042131424,0.3177872896194458,-0.3469844460487366,-0.148551344871521,0.08281214535236359,-0.2950610816478729,-0.06153317168354988,0.13910232484340668,0.07088949531316757,-0.10265088081359863,-0.29128947854042053,-0.2136295586824417,-0.01593148149549961,0.14045709371566772,0.07648254185914993},{-0.12273463606834412,-0.16255012154579163,-0.36108845472335815,0.2947620749473572,-0.23389406502246857,-0.30413711071014404,-0.1532350480556488,-0.3300718665122986,0.03283839672803879,-0.12875084578990936,-0.12026887387037277,0.1304663121700287,-0.17042721807956696,0.40327152609825134,-0.08126857876777649,-0.3685849905014038},{-0.15587307512760162,0.27417832612991333,-0.028911983594298363,-0.031147483736276627,0.3051615357398987,-0.20177118480205536,0.3682791292667389,0.11212228983640671,0.22298885881900787,0.3562573194503784,0.17083732783794403,0.3108469247817993,0.20988023281097412,-0.04082145169377327,0.24486187100410461,0.10896623134613037},{0.08716489374637604,-0.2796030342578888,-0.025515172630548477,-0.1437690407037735,0.307399719953537,-0.04497499763965607,-0.30044129490852356,-0.2301146686077118,0.04859152063727379,-0.44681739807128906,-0.13116273283958435,0.2013336718082428,0.12085326761007309,0.1558533012866974,-0.30326783657073975,0.2974989712238312},{-0.09494106471538544,-0.31055358052253723,0.44608914852142334,0.24403035640716553,0.2161404937505722,0.1380409449338913,0.07122907787561417,-0.1444079577922821,0.10451232641935349,-0.1906876266002655,0.00371090997941792,0.40573209524154663,0.23474177718162537,0.1483895182609558,-0.18115925788879395,-0.019921883940696716},{0.0024448956828564405,-0.1129024401307106,0.2591477334499359,-0.0019407846266403794,-0.15217937529087067,-0.22460225224494934,0.46398302912712097,0.3151731491088867,-0.26346489787101746,-0.3433259427547455,-0.08988270908594131,-0.3413103520870209,0.046388473361730576,-0.36897850036621094,-0.3500891625881195,-0.005085294600576162},{-0.06143913045525551,-0.3009170889854431,0.3091168999671936,-0.20760755240917206,0.2985767722129822,-0.30679553747177124,-0.3234642446041107,0.16999003291130066,0.07488249987363815,-0.06209952011704445,-0.24988265335559845,0.0769820436835289,0.06410280615091324,-0.22754177451133728,-0.33229315280914307,0.01907244138419628},{0.2948955297470093,-0.2641969919204712,0.40067368745803833,0.15356221795082092,0.03573330119252205,0.299912691116333,-0.08635833859443665,-0.21535497903823853,-0.5015192627906799,0.11431201547384262,0.04759298637509346,-0.3586079180240631,-0.011861849576234818,0.18769320845603943,0.35196465253829956,0.04031412675976753},{-0.22873282432556152,0.1375272125005722,0.11246040463447571,-0.29110997915267944,-0.17813830077648163,0.018747534602880478,0.2109326869249344,-0.10612618923187256,0.16956506669521332,-0.3395068049430847,-0.02849658392369747,0.03631071373820305,0.0005294321454130113,0.03781697899103165,-0.11939132958650589,0.03366651386022568},{-0.22410321235656738,0.3010767996311188,-0.280267596244812,0.3516201972961426,0.1224462240934372,-0.374022513628006,-0.080909363925457,-0.09177985042333603,-0.35739222168922424,0.2675776779651642,-0.3003985583782196,0.31203609704971313,-0.08046340942382812,-0.20034444332122803,-0.26336750388145447,-0.5372934341430664}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11782051622867584,0.005846149753779173,-0.04196303337812424,-0.04735281690955162,-0.12009391188621521,0.024802422150969505,0.27171987295150757,0.07261209189891815,-0.1341443806886673,-0.21317821741104126,0.13398341834545135,-0.2665402889251709,-0.1669415831565857,0.21234697103500366,0.23225322365760803,0.29053980112075806,-0.22613267600536346,-0.3254004716873169,-0.16865645349025726,0.06514842808246613,-0.040059369057416916,-0.34871479868888855,-0.24328263103961945,-0.2670762836933136,-0.29760679602622986,0.18021216988563538,-0.21211282908916473,-0.0254838690161705,-0.023185238242149353,0.030249565839767456,0.24603886902332306,-0.17244546115398407},{0.2890665829181671,0.2183513045310974,0.15996655821800232,-0.06510981172323227,0.10028956085443497,-0.0972302034497261,0.26943427324295044,0.14542365074157715,-0.18475665152072906,-0.17870935797691345,-0.04791722446680069,-0.22808726131916046,-0.16476015746593475,0.16635508835315704,-0.20103590190410614,-0.31693562865257263,-0.05738876014947891,0.13270430266857147,-0.2739427983760834,-0.2724646329879761,0.02230440266430378,0.22360271215438843,0.09871546924114227,-0.11496935784816742,0.1515229493379593,-0.28182923793792725,0.04066874086856842,0.06687591969966888,0.22837454080581665,-0.09816724807024002,-0.030140431597828865,0.2797412574291229},{0.226339191198349,0.0834338366985321,-0.03453930839896202,0.10264118015766144,-0.1497679203748703,-0.13500317931175232,-0.2133268415927887,0.12643714249134064,-0.1262890249490738,0.3450826108455658,-0.2962077856063843,-0.22400937974452972,0.17016057670116425,-0.31802284717559814,-0.17700393497943878,0.12475093454122543,-0.07308170944452286,-0.08569233864545822,0.22126330435276031,-0.025287598371505737,0.1770101934671402,0.289042204618454,-0.26751407980918884,0.06482968479394913,-0.16648273169994354,-0.10176727920770645,0.11343425512313843,-0.03543665260076523,-0.0830390453338623,-0.16423667967319489,-0.036365583539009094,-0.15772590041160583},{0.3189592957496643,0.044066447764635086,0.09484538435935974,-0.1338442862033844,-0.24410177767276764,-0.08400791883468628,-0.11615464836359024,0.2054573893547058,0.2368829846382141,-0.19344666600227356,-0.13390028476715088,0.2438691109418869,0.12941887974739075,-0.08423555642366409,-0.24519041180610657,0.32826146483421326,-0.3050561249256134,0.27615153789520264,-0.057736024260520935,0.044801536947488785,-0.07455164194107056,-0.09605716913938522,0.2669312357902527,0.1701848953962326,0.162558913230896,-0.3132946789264679,0.2824245095252991,-0.1905413120985031,-0.045911744236946106,-0.003520888974890113,-0.31495997309684753,0.13650445640087128},{-0.0288764126598835,-0.021321812644600868,-0.08188281953334808,0.04370592534542084,0.20052286982536316,-0.1330384910106659,-0.3783974349498749,0.015952903777360916,-0.14805057644844055,-0.2175055295228958,0.16945646703243256,0.21787643432617188,-0.09778008610010147,-0.08734489232301712,-0.07199692726135254,0.21558640897274017,-0.027473697438836098,0.015332596376538277,-0.32801225781440735,-0.042020440101623535,-0.19757427275180817,-0.31684738397598267,0.16829195618629456,0.2233562171459198,-0.05644053965806961,0.2694897949695587,-0.1603875607252121,0.2598503530025482,0.2783559560775757,0.35293495655059814,0.025690319016575813,0.2818356156349182},{-0.19246602058410645,-0.11965206265449524,-0.1177007257938385,-0.09847432374954224,-0.10622496902942657,0.21735325455665588,0.2207864224910736,0.056464556604623795,0.32848232984542847,0.12149108201265335,0.27601704001426697,-0.21595917642116547,-0.14066247642040253,0.24860914051532745,0.23760974407196045,-0.3313366770744324,-0.069496288895607,-0.230730339884758,0.23198074102401733,0.18199144303798676,0.061226729303598404,0.13240869343280792,-0.0168504249304533,0.0020717077422887087,-0.3258664608001709,0.28336605429649353,-0.20478127896785736,0.1528177112340927,0.2933551073074341,0.2230638712644577,0.10977747291326523,0.040593355894088745},{0.1561899334192276,-0.13148657977581024,-0.1345808506011963,-0.3253493905067444,0.010409694164991379,0.23319117724895477,0.27420565485954285,0.11672534793615341,0.10570993274450302,0.2900944948196411,-4.01099277951289e-05,0.01298215240240097,-0.44443753361701965,-0.1231590062379837,-0.13522766530513763,0.017580930143594742,-0.273554265499115,-0.21947424113750458,0.17761054635047913,-0.09194063395261765,-0.11905200034379959,-0.14949849247932434,-0.22334258258342743,-0.26066574454307556,0.17334628105163574,-0.2505577802658081,-0.12378808110952377,-0.21686923503875732,0.3340017795562744,0.12585923075675964,-0.18370321393013,-0.26713281869888306},{0.06337086856365204,0.20095022022724152,0.055453792214393616,-0.1050562933087349,0.13262365758419037,-0.273769348859787,-0.06598787754774094,-0.14352615177631378,0.005756253842264414,-0.30896005034446716,-0.28416821360588074,-0.07297925651073456,-0.1371348798274994,0.04094066098332405,-0.09940793365240097,0.3777927756309509,0.005276234354823828,-0.15257087349891663,0.1456594169139862,0.31530100107192993,-0.1680012196302414,-0.20262424647808075,0.2830572724342346,0.06715217232704163,-0.013301258906722069,-0.32868310809135437,-0.3099496066570282,-0.22325170040130615,-0.3439813256263733,-0.24158988893032074,0.10635244101285934,-0.3574618399143219},{0.04471510648727417,0.35806915163993835,-0.33484846353530884,-0.3560445308685303,-0.2423444241285324,0.04095467925071716,0.0960632786154747,0.09008864313364029,0.15748853981494904,-0.21570564806461334,-0.24230974912643433,0.2718072235584259,-0.29008346796035767,-0.14153197407722473,0.1639745682477951,-0.2279822677373886,0.2139250636100769,0.11449231207370758,0.270907461643219,0.07080207765102386,0.21984387934207916,0.08101817965507507,0.28635120391845703,-0.1057271733880043,0.46405598521232605,-0.17549264430999756,0.15807852149009705,0.28950706124305725,-0.20074625313282013,0.12115959823131561,-0.004068235866725445,0.08911650627851486},{-0.1799619048833847,0.09926574677228928,-0.29952454566955566,-0.1621042937040329,0.11972615867853165,-0.1755843609571457,0.07879812270402908,0.016849353909492493,0.1507679671049118,-0.0007684244774281979,-0.23263423144817352,-0.3021007776260376,-0.38244202733039856,-0.12348227947950363,-0.22010405361652374,0.07291503250598907,0.00613477872684598,-0.24401122331619263,0.25172609090805054,0.08038774132728577,0.0728616714477539,-0.015277132391929626,0.3445483148097992,-0.23785294592380524,0.3163844347000122,0.13357385993003845,-0.21143759787082672,0.07720141112804413,0.024913735687732697,0.08671154826879501,-0.15289205312728882,0.14613252878189087},{0.06650913506746292,-0.05878744646906853,0.2012389898300171,-0.25128236413002014,-0.22088623046875,-0.22661815583705902,-0.25989994406700134,-0.10472320765256882,-0.1501566469669342,0.302603155374527,0.10758112370967865,-0.2668141722679138,-0.33134227991104126,0.0056560346856713295,-0.20724184811115265,-0.22617000341415405,0.26558586955070496,-0.1530284732580185,0.271006315946579,-0.21731328964233398,-0.1865617036819458,-0.0151206748560071,0.1446332484483719,0.1657068133354187,0.1489807516336441,-0.13027705252170563,-0.07649128884077072,-0.08757398277521133,-0.06573870033025742,0.0359768271446228,-0.07860252261161804,0.17632824182510376},{-0.21843671798706055,-0.043999604880809784,0.24892783164978027,0.34788912534713745,0.26865413784980774,-0.012369377538561821,0.05130339786410332,-0.21937726438045502,-0.08481532335281372,-0.18858206272125244,0.27605345845222473,-0.24696803092956543,-0.20625270903110504,-0.202715665102005,0.28147876262664795,0.002533033024519682,-0.023299047723412514,0.019614053890109062,0.32413250207901,0.07441598922014236,-0.16633927822113037,0.20810849964618683,0.10427514463663101,-0.11473758518695831,0.19166511297225952,-0.09557904303073883,-0.14495624601840973,0.20790834724903107,0.205881729722023,-0.023694520816206932,-0.27155598998069763,-0.24378453195095062},{0.21595755219459534,-0.22015085816383362,0.0005854421178810298,-0.3342769742012024,0.1322443038225174,-0.030101943761110306,0.1700640618801117,0.07562955468893051,0.23806102573871613,0.03857656940817833,0.15445810556411743,0.18404926359653473,-0.3748786449432373,-0.21818499267101288,-0.048065848648548126,-0.23383605480194092,-0.1045246496796608,-0.1986742466688156,0.25105324387550354,-0.2339036762714386,0.24392561614513397,0.01935390755534172,-0.0141573715955019,0.17621436715126038,0.11098136752843857,-0.06167655065655708,0.12720590829849243,0.16245736181735992,0.13016414642333984,-0.07022203505039215,-0.18498015403747559,-0.10028592497110367},{0.22068257629871368,-0.041482534259557724,-0.0577184334397316,0.40938547253608704,-0.09903544932603836,-0.18200023472309113,-0.07267440110445023,0.10694066435098648,0.15924324095249176,0.2859783172607422,0.12641306221485138,-0.15435676276683807,0.010961461812257767,0.20532724261283875,-0.09776758402585983,0.05912350118160248,0.21058925986289978,-0.22610266506671906,0.05820805951952934,-0.31607985496520996,0.3062414824962616,0.16382770240306854,-0.05978291109204292,0.1881038248538971,0.19342190027236938,0.07486908882856369,0.09755174070596695,0.07047858834266663,0.049149300903081894,-0.15980254113674164,-0.02909238077700138,0.39101970195770264},{0.03737758845090866,-0.2773549556732178,-0.08006540685892105,0.1144893690943718,-0.24834580719470978,-0.005183364264667034,0.05199619382619858,-0.2642594873905182,-0.17236585915088654,-0.07282323390245438,0.19044005870819092,0.15994729101657867,0.0840642973780632,0.26205793023109436,-0.05430014058947563,-0.10957540571689606,-0.2191048413515091,0.2595258951187134,-0.08490712195634842,-0.2606794238090515,-0.18984027206897736,-0.0777081549167633,0.17108191549777985,-0.013150415383279324,-0.04828895628452301,-0.0915193036198616,-0.19551412761211395,0.22325314581394196,0.057252272963523865,-0.16664661467075348,0.2259114682674408,0.19984304904937744},{0.14469926059246063,-0.22452972829341888,-0.06435754150152206,-0.1831878125667572,-0.08541339635848999,0.16796475648880005,0.03060217946767807,0.24273858964443207,-0.07868556678295135,-0.016873348504304886,0.2699422538280487,0.12764891982078552,-0.02405794896185398,-0.10984395444393158,0.05950441211462021,0.13396352529525757,-0.3848848044872284,-0.2915875017642975,-0.042249321937561035,0.051278989762067795,0.11067214608192444,0.22625458240509033,0.25899508595466614,0.15245865285396576,0.04778990149497986,0.22494152188301086,0.020221387967467308,-0.07042983174324036,0.19196246564388275,-0.09203892946243286,-0.22664667665958405,0.366357684135437},{0.21680252254009247,-0.0386442132294178,-0.23349128663539886,0.1511658877134323,0.08127155154943466,-0.0775267705321312,0.27523335814476013,0.12224023044109344,0.12189871072769165,-0.20156754553318024,0.19522714614868164,-0.16913406550884247,-0.33822163939476013,0.24323312938213348,0.06311888247728348,0.0597778782248497,0.05412765219807625,-0.050661906599998474,-0.14231786131858826,0.095708467066288,-0.06918704509735107,0.16124100983142853,0.046669814735651016,-0.11821142584085464,0.04898327961564064,-0.34152302145957947,0.029503000900149345,0.3780427575111389,0.18622800707817078,-0.13055706024169922,0.19967533648014069,0.16476336121559143},{-0.1061963140964508,-0.0357409343123436,-0.11135473847389221,-0.03459399938583374,-0.23835636675357819,-0.039828184992074966,0.20673894882202148,0.13101288676261902,0.14227479696273804,0.029131585732102394,0.2467184066772461,-0.001896780333481729,0.20068003237247467,0.1707189977169037,0.18398180603981018,-0.12771911919116974,0.10800459235906601,0.1554328352212906,0.22672250866889954,0.04199477657675743,0.18829242885112762,0.2303462028503418,0.06338328868150711,0.12974314391613007,-0.05083146691322327,-0.07997570186853409,-0.1040019690990448,-0.27144545316696167,0.17086876928806305,-0.24226906895637512,-0.023563286289572716,-0.01939370483160019},{-0.25710174441337585,0.10906446725130081,-0.2558264434337616,-0.33304065465927124,-0.03802797198295593,0.07175198197364807,0.09500695765018463,-0.06926719099283218,-0.019329199567437172,0.27211132645606995,0.06057894602417946,-0.18371599912643433,0.124460369348526,-0.2061665803194046,-0.30344122648239136,-0.03097480721771717,-0.17805160582065582,0.1506386399269104,-0.0008972269133664668,-0.028236858546733856,-0.30232152342796326,0.15605202317237854,0.11226946860551834,0.022260332480072975,-0.0033827493898570538,0.22511450946331024,0.04134196788072586,-0.13576841354370117,-0.17746597528457642,0.052225373685359955,-0.0970599502325058,-0.23084451258182526},{0.004801585339009762,-0.20483987033367157,-0.21415391564369202,-0.01877063512802124,-0.3554157614707947,-0.12842990458011627,0.15315888822078705,-0.2911505103111267,-0.19997145235538483,0.1804974526166916,0.15318787097930908,0.12547257542610168,0.13870547711849213,-0.11835817992687225,0.3171558380126953,-0.31777238845825195,0.09464382380247116,0.24199150502681732,0.0629064068198204,0.2386282980442047,0.042883966118097305,-0.09816254675388336,-0.2776111960411072,0.17968007922172546,-0.18607814610004425,-0.17936909198760986,0.10766372084617615,0.05317186191678047,-0.11147723346948624,-0.2935631275177002,-0.006293612997978926,-0.1455247849225998},{0.23545406758785248,0.21095502376556396,-0.06794021278619766,0.18054845929145813,-0.2882044017314911,0.18678472936153412,-0.06505776941776276,-0.1290467381477356,-0.19031059741973877,0.1776653379201889,-0.25276339054107666,-0.15833690762519836,-0.028783682733774185,-0.19894476234912872,-0.358323335647583,-0.11624564975500107,-0.07320017367601395,-0.2669297158718109,-0.23399139940738678,0.2552342116832733,0.09119462221860886,0.12520188093185425,-0.33342957496643066,0.3188880681991577,0.18463365733623505,0.24934940040111542,-0.28135237097740173,-0.008183415047824383,0.07135610282421112,-0.2517610490322113,0.1442914754152298,0.09797494858503342},{-0.019838575273752213,-0.31483393907546997,0.009175523184239864,-0.24654605984687805,-0.10166513174772263,0.27562013268470764,0.13809427618980408,0.009303716942667961,-0.05295063182711601,0.003207319648936391,-0.18546020984649658,0.19752071797847748,0.13662096858024597,0.08584491908550262,0.18968620896339417,-0.04216529801487923,-0.08634178340435028,0.08721437305212021,-0.07777944952249527,0.15582053363323212,0.24489907920360565,0.21644742786884308,-0.045074380934238434,-0.27863219380378723,0.052514903247356415,0.11436331272125244,0.2920660078525543,0.11791601032018661,-0.009859551675617695,0.2081492692232132,0.025874344632029533,-0.09385134279727936},{0.016867835074663162,-0.16680103540420532,0.21798962354660034,0.00766559736803174,0.29438939690589905,-0.039572689682245255,-0.11320491880178452,-0.1567697674036026,0.12801623344421387,-0.06341662257909775,0.07676730304956436,-0.002512426348403096,-0.3175448179244995,0.01339635718613863,-0.09816090762615204,-0.22304081916809082,-0.05675535276532173,-0.05453949049115181,0.21516765654087067,0.23550906777381897,0.038592733442783356,0.04762847721576691,0.18506823480129242,0.3400774598121643,-0.14363236725330353,-0.030043145641684532,0.20456652343273163,-0.10818365216255188,-0.19097702205181122,-0.25078245997428894,0.2874806523323059,0.000925903266761452},{0.17005565762519836,-0.0900806337594986,0.01611534133553505,0.14637771248817444,-0.023583944886922836,0.05180864781141281,-0.2675994336605072,0.23652732372283936,-0.046523258090019226,-0.02294107712805271,0.09224472939968109,-0.28521376848220825,-0.021856142207980156,-0.011265902779996395,-0.10834705084562302,0.2579966187477112,-0.08896539360284805,-0.20757119357585907,0.015387682244181633,-0.03738820552825928,-0.1722176969051361,0.2010185718536377,0.22288474440574646,0.20853272080421448,-0.29973676800727844,0.1302986741065979,-0.0686681866645813,0.0771569311618805,-0.27806320786476135,0.2520936131477356,-0.04779842868447304,0.04738771170377731}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.14624300599098206,-0.0748564600944519,0.04485350102186203,-0.099937804043293},{0.171488419175148,-0.28971248865127563,0.22473236918449402,0.1960715800523758},{-0.16154637932777405,0.07808953523635864,0.02385815978050232,-0.006086776498705149},{0.2772217094898224,0.4105778634548187,0.2933187484741211,0.038207121193408966},{-0.22385205328464508,0.1019802987575531,-0.2525516450405121,0.07034503668546677},{-0.022265994921326637,-0.027171503752470016,0.04609077796339989,0.2658076286315918},{-0.11059078574180603,-0.07403406500816345,-0.25684595108032227,-0.024533171206712723},{-0.11966640502214432,-0.19830921292304993,0.09431948512792587,-0.06868679076433182},{-0.01935448683798313,0.051058579236269,-0.055150266736745834,-0.08047766983509064},{0.15833337604999542,0.0034217648208141327,-0.07097863405942917,-0.0983085110783577},{0.12103822082281113,-0.098713219165802,0.25954270362854004,0.22228458523750305},{0.017100626602768898,-0.009114005602896214,0.23063956201076508,-0.061269063502550125},{-0.2888965606689453,0.1800975501537323,-0.019491223618388176,-0.11540436744689941},{-0.1340322643518448,0.07590676099061966,-0.17304697632789612,0.06067763641476631},{0.15774580836296082,0.048605941236019135,0.20978018641471863,0.07223080098628998},{-0.11219760030508041,-0.34530365467071533,-0.11414888501167297,-0.08253053575754166},{-0.1818327158689499,0.049409039318561554,-0.08782031387090683,0.2130688577890396},{-0.2053145468235016,-0.11938222497701645,-0.19427500665187836,0.15679731965065002},{-0.0599956288933754,-0.02957870438694954,0.27186861634254456,0.07031383365392685},{-0.1361680030822754,-0.12144870311021805,0.01225039828568697,-0.14619353413581848},{0.12556473910808563,0.08279550820589066,0.08132094144821167,-0.1003630980849266},{-0.029614711180329323,-0.1729859858751297,-0.06813084334135056,0.19560299813747406},{0.3187156319618225,-0.15011964738368988,0.12270084768533707,0.01561996340751648},{-0.2853986918926239,-0.12363410741090775,-0.29787981510162354,-0.2792704701423645},{-0.12199939787387848,-0.11891292035579681,-0.0495925098657608,-0.09584220498800278},{0.09799686819314957,0.07467066496610641,-0.021021872758865356,0.0965154767036438},{0.1374494731426239,-0.16354309022426605,0.19246099889278412,0.052839234471321106},{-0.08328144997358322,-0.1231589987874031,-0.006647959351539612,0.20369967818260193},{0.058187440037727356,0.03053380362689495,0.03622060641646385,0.043211519718170166},{-0.12002567946910858,0.10182779282331467,0.17099368572235107,-0.0041792490519583225},{-0.15807214379310608,-0.12435638159513474,0.05973711982369423,0.1389874368906021},{0.18035945296287537,0.18660439550876617,0.214786097407341,-0.031185882166028023}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11672206223011017,-0.09381258487701416,0.02628321759402752,0.08505409955978394,0.11777327209711075,-0.08963184803724289,0.07502966374158859,-0.029348338022828102,-0.05492269620299339,-0.09953348338603973,-0.010769834741950035,0.06764105707406998,-0.024751760065555573,0.04902474209666252,0.09248821437358856,-0.044950954616069794};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.049064602702856064,0.0632534772157669,0.014791612513363361,-0.011961142532527447,-0.018281785771250725,0.06622418761253357,-0.058359622955322266,-0.07709439098834991,0.05726233869791031,0.008965491317212582,-0.014896112494170666,-0.04143977910280228,0.020626071840524673,-0.08162178844213486,0.004701313097029924,-0.06553129851818085};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0458245649933815,0.005013640038669109,-0.04753776639699936,0.0337299145758152,0.0021303524263203144,0.017319142818450928,-0.05443836748600006,-0.04248468577861786,-0.02582789957523346,-0.012177693657577038,0.020788123831152916,0.04155941307544708,0.03958209604024887,-0.043289732187986374,0.03199032321572304,-0.09447430074214935,-0.004564983770251274,-0.03369324654340744,0.034872472286224365,-0.0483999140560627,0.028326865285634995,-0.0019918864127248526,0.04063395783305168,-0.07243532687425613,-0.06163042411208153,0.0677751898765564,0.047668639570474625,-0.02758084051311016,0.08239968866109848,0.03567572310566902,-0.0019450820982456207,0.06502747535705566};
static const float action_parameterization_distribution_linear_bias[4] = {0.038447845727205276,0.07640787214040756,0.015257542952895164,0.04179007560014725};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.30798932909965515,-0.12779118120670319,-0.012071048840880394,0.15103384852409363,0.030841292813420296,0.02227293699979782,-0.19330380856990814,0.02838600054383278},{0.023968342691659927,0.1186709925532341,0.2636398673057556,0.30839598178863525,-0.13214249908924103,-0.21512766182422638,0.31477949023246765,0.08979535102844238},{0.004677243065088987,0.22596746683120728,-0.0007280249265022576,-0.02871239185333252,0.27786001563072205,0.24629497528076172,-0.09918266534805298,0.034145090728998184},{0.12478947639465332,-0.21044014394283295,0.3096816837787628,-0.24522647261619568,-0.32068780064582825,0.013366779312491417,0.17277240753173828,0.16391588747501373},{-0.2112550288438797,0.01728050410747528,0.020077122375369072,-0.35032403469085693,0.03902482986450195,0.054651033133268356,0.21625328063964844,0.25589632987976074},{-0.05189976096153259,0.270694762468338,-0.05880637839436531,-0.27786892652511597,0.11044941842556,-0.02273319661617279,-0.0012008866760879755,-0.20280659198760986},{-0.02130410075187683,0.3085685670375824,0.20318205654621124,-0.19364409148693085,0.20016711950302124,-0.29381102323532104,0.24942106008529663,0.07583228498697281},{0.006243760231882334,-0.2079838365316391,0.1300545185804367,-0.12375953793525696,0.310759037733078,-0.13257285952568054,0.03939823806285858,-0.30152130126953125},{-0.15845997631549835,0.27501267194747925,0.18438193202018738,-0.011637416668236256,0.021464912220835686,0.21251191198825836,0.36656519770622253,0.3531215190887451},{0.06868284195661545,-0.06849426031112671,-0.2260601967573166,0.3675895929336548,0.24914517998695374,0.14801038801670074,0.16995035111904144,-0.26624631881713867},{-0.11617843061685562,-0.31026819348335266,0.3552229404449463,0.24503140151500702,-0.033653177320957184,-0.3490431606769562,-0.1116756796836853,-0.29497721791267395},{0.33837616443634033,0.0585460439324379,0.3501414954662323,0.5027732253074646,-0.14380963146686554,0.17078937590122223,0.1140231043100357,-0.3108133375644684},{-0.2836517095565796,0.17001792788505554,-0.3464089632034302,0.4008225202560425,-0.04246332123875618,0.20095917582511902,0.02502080611884594,0.23964066803455353},{-0.028690939769148827,0.18447890877723694,-0.12653613090515137,-0.18713423609733582,0.02184482105076313,0.06205721199512482,0.3108753263950348,-0.06688021868467331},{0.14657926559448242,-0.3018186092376709,-0.2635737359523773,-0.19150416553020477,0.18758954107761383,-0.158072829246521,0.18360535800457,-0.1711845099925995},{-0.33652788400650024,-0.30982282757759094,-0.21376049518585205,-0.04246033355593681,0.023646270856261253,0.14550696313381195,0.17785455286502838,-0.030774740502238274},{-0.24603435397148132,-0.2739083766937256,0.15813130140304565,-0.17742474377155304,0.02115621604025364,0.09926880151033401,-0.40269333124160767,-0.22340506315231323},{0.016094813123345375,0.2677086889743805,0.06648243963718414,0.2507669925689697,-0.1498497873544693,0.33774933218955994,0.2835768163204193,-0.1510293185710907},{-0.016380049288272858,-0.2768869698047638,-0.10237418860197067,0.0016860427567735314,-0.10604611784219742,-0.35443735122680664,0.07924506068229675,-0.20812588930130005},{-0.1181056872010231,0.0197108443826437,0.07437421381473541,-0.26402825117111206,0.12297490984201431,0.0223824642598629,0.09191613644361496,0.017317553982138634},{0.03117966465651989,-0.059944476932287216,0.07964644581079483,-0.122169628739357,0.08254540711641312,-0.03785373643040657,0.10239038616418839,-0.1801726520061493},{-0.2867812216281891,0.2266649752855301,0.20382510125637054,-0.28098762035369873,-0.34706953167915344,-0.0341174378991127,0.21257899701595306,0.010431106202304363},{0.27989324927330017,0.056270163506269455,-0.40511074662208557,-0.03660859912633896,-0.10181619971990585,0.21421074867248535,0.20261280238628387,0.2488575279712677},{0.01120274793356657,-0.2246207743883133,-0.046682532876729965,0.11057282984256744,-0.366923987865448,-0.09600189328193665,-0.3081059157848358,-0.33544108271598816},{0.1298675835132599,-0.13430963456630707,-0.3469963073730469,0.35186874866485596,-0.3233478367328644,-0.08115821331739426,-0.45620420575141907,0.06772773712873459},{0.0022630253806710243,0.3021922707557678,-0.1295897513628006,-0.061236120760440826,0.10168177634477615,-0.13629083335399628,0.22746525704860687,-0.3030969202518463},{-0.0902567058801651,0.12607209384441376,-0.05262533947825432,-0.24429233372211456,0.04429870471358299,-0.13794758915901184,-0.18608185648918152,-0.0902387797832489},{0.07983149588108063,-0.1548413336277008,0.03258109092712402,-0.09919500350952148,0.08353729546070099,0.07691379636526108,-0.2913266718387604,0.1415739804506302},{0.19234205782413483,0.03823956474661827,-0.2873573303222656,-0.1375245898962021,-0.16974444687366486,0.1682225465774536,0.15987733006477356,0.0680023804306984},{0.2697300314903259,-0.39330294728279114,0.011727657169103622,-0.060949064791202545,0.07610432058572769,-0.12169007956981659,0.11597470194101334,0.2348923236131668},{-0.32660818099975586,-0.2621835172176361,0.028310390189290047,-0.3698360323905945,0.252219557762146,-0.41134852170944214,-0.07689239829778671,0.06912418454885483},{0.29198986291885376,0.19401879608631134,-0.016180815175175667,0.17336194217205048,0.10084448754787445,-0.25309908390045166,-0.08395396918058395,0.14942508935928345}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.19150947034358978,0.36899176239967346,-0.4234958291053772,-0.48371362686157227,-0.15729118883609772,-0.11650168895721436,-0.32496175169944763,0.46359118819236755},{0.0160821545869112,0.3544878661632538,-0.22309815883636475,0.4396683871746063,-0.037317246198654175,-0.07898307591676712,-0.31221091747283936,-0.06487759947776794},{-0.27406176924705505,-0.20724742114543915,-0.14631254971027374,-0.16799212992191315,0.38893041014671326,0.19950918853282928,-0.1115664541721344,0.35306379199028015},{-0.45090413093566895,-0.41617223620414734,0.2832646071910858,0.17616215348243713,-0.4830074608325958,-0.1858128011226654,0.39609548449516296,0.21133430302143097},{-0.2571835517883301,-0.19662083685398102,-0.28104665875434875,-0.17781485617160797,0.3143240213394165,-0.21376778185367584,0.39086657762527466,-0.31592994928359985},{-0.05529364198446274,0.2842017412185669,0.08095920085906982,-0.5763154029846191,0.5100888609886169,-0.21526765823364258,-0.49635738134384155,-0.33318641781806946},{-0.24747402966022491,0.1009262353181839,0.05003774166107178,-0.3983006477355957,0.050145018845796585,-0.4474774897098541,0.3682764768600464,0.08635425567626953},{-0.26756206154823303,-0.12422049045562744,-0.1060589924454689,-0.342146635055542,-0.3536958694458008,0.06700517237186432,0.5419192314147949,-0.31534937024116516}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.048275426030159,-0.07216177880764008,-0.08963564783334732,0.04309671372175217,0.13720577955245972,0.01621503382921219,0.06734443455934525,0.016711026430130005};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.010864533483982086,0.017722032964229584,-0.02236122079193592,-0.06684505939483643,-0.0649840459227562,-0.02032836340367794,0.02053389512002468,-0.1500261127948761};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

