#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2887894809246063,-0.19113145768642426,0.332958847284317,0.22929444909095764,-0.37039273977279663,0.17213238775730133,-0.007265371736139059,-0.20840319991111755,0.08453866839408875,0.4135144054889679,0.12574011087417603,0.05308949574828148,0.16243314743041992,-0.19963602721691132,0.34471744298934937,-0.10315902531147003},{-0.3570632040500641,-0.2910251319408417,0.2971097528934479,0.19247405230998993,-0.24903199076652527,0.051843155175447464,-0.3832476735115051,-0.005235310178250074,-0.1754356324672699,-0.14211900532245636,0.12381819635629654,-0.17901727557182312,0.2326778620481491,-0.37890616059303284,-0.20832686126232147,0.09271780401468277},{0.16116027534008026,-0.23631636798381805,-0.26133009791374207,0.08283534646034241,0.10092809051275253,0.14529408514499664,-0.053064439445734024,0.02668841741979122,-0.13370591402053833,-0.198996439576149,-0.18937435746192932,0.41584402322769165,-0.004594771191477776,-0.16255268454551697,-0.4096384048461914,0.24246732890605927},{0.13408732414245605,0.1778063029050827,0.32696014642715454,-0.04176752641797066,-0.326905757188797,-0.043942999094724655,0.19067902863025665,0.13429702818393707,0.48237666487693787,-0.37755444645881653,0.04288477450609207,0.16251026093959808,-0.3400129973888397,-0.02908509597182274,0.34112051129341125,-0.4114542007446289},{-0.05931179225444794,0.054990820586681366,0.24026523530483246,-0.10259368270635605,0.24146078526973724,0.2804247736930847,0.2994459569454193,-0.0548614077270031,-0.033637721091508865,0.26110905408859253,0.34267187118530273,-0.194537952542305,-0.13525503873825073,-0.3095288574695587,0.4156126081943512,0.15197719633579254},{0.022034354507923126,-0.18500514328479767,-0.14022286236286163,-0.24129822850227356,0.12598052620887756,0.003442882327362895,0.019230781123042107,-0.13768969476222992,0.2077532708644867,-0.2414509803056717,-0.30772432684898376,0.1867254078388214,0.4343772828578949,0.003603417193517089,-0.018540270626544952,0.11577504873275757},{-0.0512760654091835,-0.014147767797112465,0.08631309121847153,-0.21898320317268372,0.2100784331560135,0.022627120837569237,0.0715944766998291,0.3340081572532654,0.32341450452804565,-0.007353133521974087,-0.3255734145641327,0.18900525569915771,-0.10225529223680496,0.2084978222846985,-0.17066556215286255,-0.2398747205734253},{0.023266538977622986,0.020713847130537033,0.23668093979358673,0.24062679708003998,-0.40432533621788025,-0.039059821516275406,0.36516276001930237,0.34120479226112366,-0.10533218085765839,0.24826276302337646,-0.49958595633506775,-0.3252621293067932,0.22567543387413025,0.31716808676719666,0.22756421566009521,0.12788279354572296},{0.28393256664276123,-0.24140861630439758,0.3341149389743805,-0.06257631629705429,0.25076645612716675,0.07595387101173401,-0.1326664835214615,-0.21240432560443878,0.09919971972703934,-0.3153105080127716,0.04713066294789314,-0.2999386787414551,-0.17705371975898743,0.3564939498901367,0.1598472148180008,-0.11331122368574142},{0.0068531823344528675,-0.3800748884677887,-0.4575929045677185,-0.027572913095355034,-0.31945231556892395,0.20997512340545654,0.33154019713401794,0.24165214598178864,0.44841182231903076,0.33769690990448,-0.021938765421509743,-0.2944044768810272,0.10083508491516113,0.26384562253952026,-0.06075180321931839,-0.33075645565986633},{0.08998463302850723,0.2398522049188614,0.4416545033454895,-0.3405943214893341,-0.32634833455085754,0.2126251608133316,0.14913387596607208,0.38560396432876587,-0.3222559988498688,-0.03207104280591011,-0.043678779155015945,0.16708296537399292,-0.3039245009422302,-0.18284153938293457,0.3352999687194824,-0.3416917324066162},{0.14808239042758942,-0.14789825677871704,-0.04206617921590805,0.1243136078119278,0.3220674395561218,0.27754727005958557,0.4336434006690979,0.0011448333971202374,0.001984903123229742,0.01275347825139761,0.2536439299583435,-0.08893550932407379,-0.07980364561080933,-0.21433547139167786,0.21693706512451172,0.2956943213939667},{-0.16287893056869507,0.3658623993396759,0.15884283185005188,-0.32293230295181274,0.031705208122730255,0.12551294267177582,0.276212215423584,-0.04972182586789131,0.10030243545770645,0.019323552027344704,-0.06139025837182999,0.1440165787935257,0.23090648651123047,0.30771729350090027,0.12621131539344788,-0.21509729325771332},{-0.2388283759355545,-0.21696504950523376,-0.19998876750469208,-0.020680690184235573,-0.17310583591461182,0.0901734009385109,-0.32664433121681213,0.10653933137655258,-0.08520876616239548,-0.033185143023729324,-0.28652459383010864,-0.07667896151542664,-0.31839632987976074,0.10897795110940933,0.24795274436473846,0.0881805419921875},{-0.11739569157361984,-0.4094682037830353,-0.25726625323295593,0.3345167636871338,0.03903528302907944,-0.357408732175827,0.2865995764732361,-0.07565765827894211,-0.0233925674110651,0.30884790420532227,0.08733879774808884,0.19720537960529327,0.19040101766586304,-0.02540946565568447,-0.18574725091457367,0.18803738057613373},{0.5240106582641602,-0.09925805032253265,-0.2544083893299103,-0.4189041256904602,-0.6155079007148743,0.32592177391052246,0.4251449704170227,-0.30699974298477173,0.17575986683368683,0.12103714793920517,-0.31426548957824707,0.05453616380691528,-0.5514019131660461,0.5339123606681824,-0.28539642691612244,0.03733517602086067},{-0.36629554629325867,-0.3961220383644104,0.39176058769226074,0.3664054274559021,-0.32060864567756653,0.3441615402698517,-0.14208543300628662,-0.3059713840484619,0.2477365881204605,-0.4590890407562256,-0.3499825596809387,-0.6454768776893616,-0.21245785057544708,-0.5129441022872925,-0.021464839577674866,-0.2015986442565918},{-0.35866570472717285,0.28776511549949646,-0.48428043723106384,-0.0023145603481680155,0.04040757194161415,0.3356618881225586,-0.265445739030838,-0.4094923436641693,0.22253835201263428,0.24491234123706818,0.40577900409698486,-0.09557964652776718,-0.25839734077453613,0.32204940915107727,0.15990011394023895,-0.5074114799499512}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14384223520755768,-0.08549197763204575,-0.17599906027317047,-0.4175586998462677,0.4230795204639435,0.2813390791416168,0.0763978362083435,0.10062489658594131,-0.29363927245140076,-0.10411953926086426,-0.11433718353509903,-0.01518529187887907,0.23353460431098938,0.5265477895736694,0.1614471822977066,0.06170164421200752},{-0.19366593658924103,-0.27254197001457214,-0.03347082436084747,0.1382734775543213,0.2835293710231781,-0.28327202796936035,0.18287742137908936,0.06368590146303177,-0.07949499040842056,0.2535424530506134,-0.1394226998090744,0.3447369337081909,-0.35309675335884094,0.2222411334514618,-0.3786967992782593,-0.25932350754737854},{0.12159324437379837,0.2545713484287262,-0.419769287109375,-0.5471048355102539,0.1400740146636963,0.4791910648345947,-0.10317447036504745,0.10416162759065628,-0.22708992660045624,-0.25118935108184814,-0.023542890325188637,0.2998897135257721,-0.35293295979499817,-0.31072112917900085,0.17563149333000183,-0.07213598489761353},{0.2071348875761032,-0.03620376065373421,0.08440333604812622,0.198252335190773,-0.5179377198219299,0.03863378241658211,0.03956006467342377,-0.262753427028656,0.3598509728908539,0.3874566853046417,-0.09175491333007812,-0.1689426749944687,-0.3833041191101074,-0.37702736258506775,0.21176603436470032,0.2334805428981781},{-0.1861869990825653,0.042235616594552994,0.053466569632291794,0.2608470320701599,-0.23231975734233856,0.008248236030340195,-0.05723278596997261,0.183214470744133,0.23585940897464752,-0.33432281017303467,0.04006568342447281,0.4139291048049927,0.12952829897403717,-0.41666948795318604,-0.08032285422086716,-0.12615761160850525},{0.26524055004119873,0.23807387053966522,-0.043333813548088074,0.155982106924057,-0.37435173988342285,-0.41518741846084595,0.2602083683013916,0.29710763692855835,0.10820471495389938,0.5040591955184937,0.23532626032829285,-0.2768425941467285,-0.001194550539366901,-0.14431032538414001,-0.05366267263889313,0.3115975558757782},{-0.02688666433095932,0.160084068775177,0.3386225402355194,-0.3820681869983673,-0.17114943265914917,0.0659303143620491,-0.3012334108352661,-0.06945884227752686,0.08352909982204437,0.10292267054319382,-0.16019125282764435,-0.28450706601142883,-0.2948703467845917,0.07512611895799637,0.21223507821559906,0.06007895618677139},{-0.20610767602920532,-0.20728743076324463,-0.41298168897628784,0.2856563329696655,-0.2949165999889374,-0.3240090310573578,-0.20666024088859558,-0.3490888476371765,0.01884530857205391,-0.2494942843914032,-0.1264873892068863,0.17552870512008667,-0.21771836280822754,0.40710827708244324,-0.14754605293273926,-0.3957539200782776},{-0.2615065276622772,0.2848275303840637,0.015091213397681713,-0.002504912670701742,0.3143736720085144,-0.19612929224967957,0.416974276304245,0.10495258867740631,0.3082687556743622,0.3867933452129364,0.3237634599208832,0.29711344838142395,0.2441454976797104,-0.0543242022395134,0.3052511215209961,0.15407128632068634},{0.13680128753185272,-0.2554984986782074,-0.05593476444482803,-0.15230484306812286,0.312101811170578,-0.039958078414201736,-0.2864588499069214,-0.2345716804265976,0.079355888068676,-0.46981802582740784,-0.21595454216003418,0.22956863045692444,0.12073130160570145,0.17099516093730927,-0.31690675020217896,0.25941741466522217},{-0.190040722489357,-0.37487179040908813,0.49171850085258484,0.2684597671031952,0.22299614548683167,0.13324867188930511,0.1653771847486496,-0.15102438628673553,0.15454740822315216,-0.25518980622291565,0.03265964984893799,0.377828449010849,0.3859674334526062,0.13089600205421448,-0.2484205961227417,-0.0016760005382820964},{0.025614621117711067,-0.19006048142910004,0.3148081600666046,0.05791283771395683,-0.12035293877124786,-0.20139920711517334,0.4408377707004547,0.2601899206638336,-0.25340735912323,-0.39344674348831177,-0.1342945545911789,-0.2926238477230072,-0.009951350279152393,-0.30318883061408997,-0.38702526688575745,-0.001587033155374229},{-0.0756181851029396,-0.33789411187171936,0.3129659593105316,-0.18258224427700043,0.3035293221473694,-0.35115596652030945,-0.38295334577560425,0.17979957163333893,0.12240763008594513,-0.042732927948236465,-0.30291515588760376,0.08752340078353882,0.07500740140676498,-0.3349016606807709,-0.40774762630462646,-0.019845133647322655},{0.3067343533039093,-0.3539663255214691,0.4899715781211853,0.1305377036333084,0.10311990231275558,0.302421510219574,-0.09552079439163208,-0.24135753512382507,-0.5447465777397156,0.09046655148267746,0.003136531449854374,-0.42532312870025635,0.026281319558620453,0.28596174716949463,0.32969018816947937,0.07225460559129715},{-0.2204698771238327,0.17476700246334076,0.08672793209552765,-0.3379572629928589,-0.20852504670619965,0.12588508427143097,0.22916586697101593,-0.19065411388874054,0.2135797142982483,-0.3902651071548462,-0.005810353439301252,0.0890999361872673,-0.08575417846441269,0.07619281858205795,-0.04385308548808098,0.0014413496246561408},{-0.18098235130310059,0.352806031703949,-0.347230464220047,0.2996678054332733,0.17818701267242432,-0.39821314811706543,-0.14191053807735443,-0.056457046419382095,-0.4271097779273987,0.2760878801345825,-0.42815420031547546,0.30913054943084717,-0.08100233227014542,-0.16596713662147522,-0.27401453256607056,-0.5551314949989319}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.19485610723495483,0.011983845382928848,-0.0802936926484108,-0.0008353872108273208,-0.11100751906633377,-0.010884808376431465,0.299165278673172,-0.003507460467517376,-0.10275562852621078,-0.14086639881134033,0.09099183231592178,-0.3337060213088989,-0.21462908387184143,0.23231416940689087,0.197734534740448,0.2597334682941437,-0.2821573317050934,-0.32531943917274475,-0.2602236270904541,0.016810758039355278,-0.017851337790489197,-0.37558144330978394,-0.2249550074338913,-0.293645441532135,-0.3258776366710663,0.25973382592201233,-0.28513097763061523,-0.05183056741952896,-0.0025436480063945055,-0.02015060745179653,0.15980164706707,-0.14545048773288727},{0.20837464928627014,0.25546795129776,0.0838722512125969,-0.08201353251934052,0.11644337326288223,-0.04550952464342117,0.32548561692237854,0.10171574354171753,-0.24683316051959991,-0.14935220777988434,-0.042672231793403625,-0.3157636225223541,-0.20343363285064697,0.21190039813518524,-0.19502635300159454,-0.3060414791107178,-0.022620968520641327,0.19729356467723846,-0.36062681674957275,-0.33073100447654724,-0.03572072833776474,0.3084098696708679,0.1511218398809433,-0.12220646440982819,0.13582369685173035,-0.24510695040225983,0.014755204319953918,0.15395528078079224,0.2216179221868515,-0.1582133173942566,-0.02285347506403923,0.22028601169586182},{0.26230040192604065,0.0740555003285408,-0.05711306631565094,0.19426897168159485,-0.24020148813724518,-0.2084592878818512,-0.32591894268989563,0.16400903463363647,-0.11250210553407669,0.38288384675979614,-0.26315125823020935,-0.13748440146446228,0.13345548510551453,-0.4319889545440674,-0.11540249735116959,0.0751127377152443,-0.1765986829996109,-0.20334362983703613,0.3009650409221649,-0.02710641920566559,0.2990967929363251,0.18866948783397675,-0.24376429617404938,0.0024267917033284903,-0.22999307513237,-0.10658231377601624,0.18464712798595428,-0.138784721493721,-0.03320804238319397,-0.13215799629688263,-0.11273113638162613,-0.05215851217508316},{0.3515471816062927,0.08678828179836273,0.0860159620642662,-0.13201218843460083,-0.2896614074707031,-0.09161865711212158,-0.1798182874917984,0.2723033130168915,0.25869739055633545,-0.22139103710651398,-0.08446665108203888,0.3219566345214844,0.08238854259252548,-0.1680479198694229,-0.20509293675422668,0.30576321482658386,-0.32791823148727417,0.2081245481967926,0.007074078544974327,0.09666507691144943,-0.03170112892985344,-0.11658554524183273,0.2948927879333496,0.1641996204853058,0.1764059215784073,-0.3463619351387024,0.34316781163215637,-0.2384151965379715,-0.023832108825445175,0.048495277762413025,-0.29137957096099854,0.1804180145263672},{-0.03187219798564911,-0.06301166117191315,-0.08199907839298248,0.05175630375742912,0.18141555786132812,-0.20171388983726501,-0.37458935379981995,-0.02588389441370964,-0.1268744170665741,-0.1719573587179184,0.13489753007888794,0.23392358422279358,-0.052068524062633514,-0.08637676388025284,-0.0935458242893219,0.2026514858007431,-0.08087340742349625,-0.037748660892248154,-0.340040385723114,-0.07866566628217697,-0.1482243686914444,-0.3855343461036682,0.17069827020168304,0.2271365374326706,-0.06527101993560791,0.29107916355133057,-0.17353130877017975,0.18314045667648315,0.31230759620666504,0.35128235816955566,-0.04458984360098839,0.30921855568885803},{-0.26651912927627563,-0.062388598918914795,-0.19712787866592407,-0.03409687429666519,-0.1846289187669754,0.25457340478897095,0.20254330337047577,0.02399580366909504,0.28784456849098206,0.16036705672740936,0.341576486825943,-0.23369143903255463,-0.1975250244140625,0.223166361451149,0.3097338378429413,-0.3775874078273773,-0.11834250390529633,-0.24523024260997772,0.23045487701892853,0.07600083202123642,0.09379368275403976,0.143914595246315,0.03519441932439804,-0.05366778001189232,-0.37521862983703613,0.36253297328948975,-0.2018391191959381,0.17715220153331757,0.3858693838119507,0.21518917381763458,0.07038426399230957,0.09222735464572906},{0.1674443632364273,-0.09939201176166534,-0.16651195287704468,-0.31900590658187866,-0.050818588584661484,0.22629715502262115,0.2582295536994934,0.14712418615818024,0.07671759277582169,0.3519347906112671,0.006597079336643219,0.002876885002478957,-0.4254240095615387,-0.17316296696662903,-0.1345551759004593,0.05468277260661125,-0.31280383467674255,-0.24485120177268982,0.1838848888874054,-0.1090429276227951,-0.09338235855102539,-0.14791734516620636,-0.19324086606502533,-0.27508947253227234,0.16935577988624573,-0.23743048310279846,-0.08949968963861465,-0.21762001514434814,0.3628078103065491,0.10924363881349564,-0.19136163592338562,-0.2611256539821625},{0.06145714968442917,0.1746254563331604,0.05345655605196953,-0.14288000762462616,0.1541232168674469,-0.29992955923080444,-0.03836784139275551,-0.16048498451709747,-0.005144202150404453,-0.2689765691757202,-0.33925268054008484,-0.12298161536455154,-0.11279204487800598,0.06465122103691101,-0.15951509773731232,0.42754048109054565,0.012038325890898705,-0.12780198454856873,0.09276936203241348,0.3371274471282959,-0.1987832486629486,-0.18118222057819366,0.2828109562397003,0.09143927693367004,0.010834730230271816,-0.34023937582969666,-0.34044963121414185,-0.21046613156795502,-0.3878138065338135,-0.28803402185440063,0.0929073765873909,-0.4031493663787842},{0.023317210376262665,0.5303544998168945,-0.4479979872703552,-0.40719133615493774,-0.3354746103286743,0.19252698123455048,0.06090066581964493,0.1746295839548111,-0.05491115152835846,-0.2838561236858368,-0.07796791195869446,0.304558664560318,-0.4616048038005829,-0.26339712738990784,0.25806233286857605,-0.20172767341136932,0.22260959446430206,0.16759972274303436,0.4110710024833679,0.051089707762002945,0.1460435688495636,0.26157882809638977,0.4203702211380005,-0.19077683985233307,0.47902798652648926,-0.23138494789600372,0.3140266537666321,0.4557713270187378,-0.15373869240283966,0.08658025413751602,0.053716059774160385,0.09981093555688858},{-0.2868880033493042,0.08908316493034363,-0.440390020608902,-0.23345786333084106,0.11032414436340332,-0.2840196490287781,0.1864205002784729,-0.060011789202690125,0.21077755093574524,0.1659080535173416,-0.332462877035141,-0.4267919957637787,-0.46339696645736694,-0.11924999207258224,-0.3068787157535553,0.14296947419643402,-0.07879345118999481,-0.2671871781349182,0.09585490077733994,0.07868949323892593,0.0765945091843605,-0.0039582583121955395,0.4192968010902405,-0.14454467594623566,0.36008480191230774,0.20246976613998413,-0.2759432792663574,0.013149334117770195,-0.0019141113152727485,-0.0683371052145958,-0.2871238589286804,0.09895691275596619},{0.08412403613328934,0.04086332768201828,0.10201719403266907,-0.2980632781982422,-0.31493258476257324,-0.22886613011360168,-0.2557927370071411,-0.022417109459638596,-0.20901979506015778,0.39247530698776245,0.1539296954870224,-0.28699102997779846,-0.388950914144516,-0.08228842169046402,-0.21217769384384155,-0.11948657780885696,0.19366833567619324,-0.1605275720357895,0.26858624815940857,-0.20627179741859436,-0.1841599941253662,0.05432895943522453,0.23823852837085724,0.1746942400932312,0.20617416501045227,-0.13675980269908905,-0.021227650344371796,-0.05630752071738243,-0.03210277110338211,-0.02611808106303215,-0.08613669872283936,0.16959470510482788},{-0.20299676060676575,-0.03425776958465576,0.21590131521224976,0.24843516945838928,0.2721916139125824,0.013454257510602474,0.09722098708152771,-0.1902855634689331,-0.12351148575544357,-0.22566618025302887,0.2967047691345215,-0.23919209837913513,-0.21732543408870697,-0.18192557990550995,0.2776709794998169,0.048928152769804,0.006383542437106371,0.05614886432886124,0.36290082335472107,0.10236144810914993,-0.2284703552722931,0.28701314330101013,0.11346887052059174,-0.06174523010849953,0.26394277811050415,-0.14429086446762085,-0.11852972209453583,0.25370967388153076,0.18068327009677887,-0.033064525574445724,-0.23937760293483734,-0.2990913689136505},{0.2665461599826813,-0.2582987844944,-0.029241399839520454,-0.3111881911754608,0.0719086080789566,-0.16484792530536652,0.12504823505878448,0.09577769786119461,0.2865189015865326,0.1142386645078659,0.1174636259675026,0.22229371964931488,-0.3574184775352478,-0.311614990234375,-0.07920568436384201,-0.2287931889295578,-0.20695450901985168,-0.27177566289901733,0.26429030299186707,-0.22296343743801117,0.34315094351768494,-0.07468150556087494,-0.013322154060006142,0.1903165727853775,0.1450815349817276,-0.10921245813369751,0.10614128410816193,0.05018342286348343,0.15195301175117493,-0.06544472277164459,-0.2916997969150543,-0.06403062492609024},{0.21895082294940948,-0.12760482728481293,-0.0383760891854763,0.4444940984249115,-0.08460163325071335,-0.2724623382091522,-0.0430840402841568,0.04782645404338837,0.263449490070343,0.3816797733306885,0.0621069110929966,-0.1676594614982605,0.1020461916923523,0.2343396097421646,-0.13386555016040802,0.039588816463947296,0.1676076203584671,-0.27626490592956543,0.005134694278240204,-0.3673814833164215,0.36413252353668213,0.06868833303451538,-0.1111190989613533,0.222158282995224,0.15566691756248474,0.16717229783535004,0.043158773332834244,-0.030397526919841766,0.08684805035591125,-0.1660911738872528,-0.0918855145573616,0.4139748215675354},{-0.013191517442464828,-0.2641820013523102,-0.12125963717699051,0.13174723088741302,-0.26532912254333496,-0.009932816959917545,0.06087193638086319,-0.2939288318157196,-0.13927872478961945,-0.01381333451718092,0.182295024394989,0.1074218675494194,0.0731646716594696,0.24483774602413177,-0.0596882589161396,-0.10998166352510452,-0.23772476613521576,0.264915406703949,-0.14495684206485748,-0.3133087456226349,-0.17631907761096954,-0.07677148282527924,0.1920343041419983,0.0006060398882254958,-0.06060931831598282,-0.023409467190504074,-0.23898403346538544,0.2234696000814438,0.0926765501499176,-0.2127545028924942,0.1985718011856079,0.2065325677394867},{0.10827214270830154,-0.17161548137664795,-0.1595701277256012,-0.16700239479541779,-0.14676345884799957,0.12855052947998047,0.034115273505449295,0.2379714846611023,-0.14011850953102112,0.0829305499792099,0.26704642176628113,0.09238333255052567,-0.08903180807828903,-0.1784932166337967,0.04271291568875313,0.16119739413261414,-0.4856487810611725,-0.2972048819065094,-0.062063608318567276,0.017020229250192642,0.13524268567562103,0.24686208367347717,0.33649080991744995,0.10584704577922821,0.04571017622947693,0.24428220093250275,0.0328640453517437,-0.07305201888084412,0.22754301130771637,-0.16918854415416718,-0.3325289487838745,0.39278116822242737},{0.16484799981117249,0.0007570869638584554,-0.2671864628791809,0.19148629903793335,0.0844179168343544,-0.032719388604164124,0.2596428692340851,0.10312008857727051,0.11875830590724945,-0.19472551345825195,0.2364870309829712,-0.1877204030752182,-0.4166182279586792,0.23642142117023468,0.07495283335447311,0.019586684182286263,0.043522730469703674,-0.07772116363048553,-0.14337420463562012,0.025905195623636246,-0.04718945920467377,0.18594560027122498,0.09093841910362244,-0.16338711977005005,-0.0012348582968115807,-0.23039181530475616,0.03460196778178215,0.39157918095588684,0.28336161375045776,-0.14191855490207672,0.20451655983924866,0.22421795129776},{-0.032373785972595215,-0.04023440554738045,-0.06748270243406296,-0.03064795210957527,-0.2524327039718628,-0.030730918049812317,0.1874835193157196,0.20662027597427368,0.148079976439476,-0.007513700518757105,0.23110121488571167,0.03129814937710762,0.2176666110754013,0.1508854776620865,0.17883500456809998,-0.09528610110282898,0.1275695413351059,0.1658441573381424,0.2528946101665497,0.08181148022413254,0.19725088775157928,0.22658580541610718,0.05468345806002617,0.14119839668273926,-0.02234337478876114,-0.10144362598657608,-0.11016754060983658,-0.25569573044776917,0.17190545797348022,-0.21596825122833252,0.042692702263593674,-0.027927253395318985},{-0.36090898513793945,0.08836498856544495,-0.32240810990333557,-0.32799583673477173,-0.00865977630019188,0.05477422848343849,0.12665019929409027,-0.1601105034351349,0.005223369691520929,0.3164815306663513,0.07695980370044708,-0.22206242382526398,0.013331037946045399,-0.15682339668273926,-0.29442107677459717,-0.050129637122154236,-0.1897687017917633,0.11893413215875626,-0.03616702929139137,-0.09628427028656006,-0.31379708647727966,0.18052366375923157,0.1461857408285141,0.00915158074349165,-0.042668964713811874,0.3132626712322235,0.02662471868097782,-0.143864706158638,-0.15147745609283447,0.0055245631374418736,-0.1604316085577011,-0.23548433184623718},{0.017601152881979942,-0.23104728758335114,-0.2146056592464447,-0.02175484038889408,-0.33637186884880066,-0.17391382157802582,0.1585369110107422,-0.28941068053245544,-0.18757155537605286,0.18036691844463348,0.13125935196876526,0.12252938747406006,0.13977931439876556,-0.10653050243854523,0.2976466119289398,-0.3019319474697113,0.07398790121078491,0.22438134253025055,0.043933067470788956,0.2584940493106842,0.05459430068731308,-0.14170271158218384,-0.29867488145828247,0.21965879201889038,-0.15131263434886932,-0.17586669325828552,0.08186620473861694,0.0035114267375320196,-0.12824520468711853,-0.29033005237579346,-0.03530856594443321,-0.15294992923736572},{0.2145310491323471,0.18086323142051697,-0.07242872565984726,0.14572952687740326,-0.26663631200790405,0.17933137714862823,-0.04957647994160652,-0.1493586003780365,-0.20033374428749084,0.20360040664672852,-0.2600535750389099,-0.15920187532901764,-0.04278305172920227,-0.17588402330875397,-0.3695438504219055,-0.13818635046482086,-0.08434153348207474,-0.25957414507865906,-0.21760740876197815,0.29085540771484375,0.08473044633865356,0.1340055763721466,-0.3302578032016754,0.3323115110397339,0.1857430338859558,0.2519310712814331,-0.28208687901496887,-0.030396943911910057,0.06948383897542953,-0.26685482263565063,0.1390102058649063,0.08937999606132507},{0.00481793936342001,-0.32474905252456665,0.018511496484279633,-0.30019611120224,-0.04087474197149277,0.25451385974884033,0.19128961861133575,0.02367975376546383,-0.02699441835284233,0.012295592576265335,-0.24381016194820404,0.13659417629241943,0.16480597853660583,0.11384399980306625,0.11702808737754822,0.0249779149889946,-0.06688868999481201,0.1372983157634735,-0.12592341005802155,0.17824700474739075,0.21090880036354065,0.23109941184520721,-0.09450570493936539,-0.21586966514587402,0.12176509201526642,0.116517573595047,0.23767396807670593,0.1201692670583725,-0.03875884786248207,0.17005452513694763,0.031277891248464584,-0.12460841983556747},{0.03539765998721123,-0.18268507719039917,0.2477646768093109,-0.012822254560887814,0.29203319549560547,-0.030366472899913788,-0.11751316487789154,-0.15521091222763062,0.14179721474647522,-0.07135958224534988,0.0690937414765358,0.00792889017611742,-0.23556073009967804,0.024857133626937866,-0.10956612974405289,-0.23979616165161133,-0.04049282521009445,-0.03010578453540802,0.22249895334243774,0.26789242029190063,0.015575609169900417,0.05591217800974846,0.1724747121334076,0.33796262741088867,-0.1464313566684723,-0.09364309161901474,0.2141287475824356,-0.09096990525722504,-0.23265741765499115,-0.2370242476463318,0.30234524607658386,-0.014216912910342216},{0.20918960869312286,-0.03574826568365097,0.05353232100605965,0.14681001007556915,-0.05367627739906311,0.07464902848005295,-0.29717960953712463,0.30128607153892517,-0.10844085365533829,-0.06511537730693817,0.12576614320278168,-0.2454434037208557,0.005164314527064562,-0.05928315967321396,-0.067081019282341,0.2713640630245209,-0.06915780156850815,-0.2031686156988144,0.06269042938947678,-0.026087600737810135,-0.15260784327983856,0.20182211697101593,0.23417125642299652,0.19770067930221558,-0.29240262508392334,0.11654919385910034,-0.04251643270254135,0.0834440290927887,-0.26935458183288574,0.3087940514087677,-0.013475833460688591,0.06510670483112335}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.25124433636665344,-0.10220760107040405,0.18853339552879333,-0.21427495777606964},{0.21778832376003265,-0.37610235810279846,0.30601775646209717,0.30009815096855164},{-0.36958423256874084,0.11564228683710098,0.10164742916822433,-0.011101375333964825},{0.24104219675064087,0.5837014317512512,0.3831068277359009,0.03206099942326546},{-0.3028948903083801,0.14305317401885986,-0.3529854416847229,0.10882280021905899},{-0.07072324305772781,-0.10388260334730148,0.11592516303062439,0.5392604470252991},{-0.08489497005939484,-0.10568977892398834,-0.44917914271354675,0.04577849805355072},{-0.1498822569847107,-0.28923770785331726,0.2720034122467041,-0.07823777943849564},{-0.08364669233560562,0.15464183688163757,-0.11521561443805695,-0.18129795789718628},{0.308834969997406,0.06987619400024414,-0.11328377574682236,-0.28295499086380005},{0.2097129225730896,-0.10723166912794113,0.3566359281539917,0.30174046754837036},{-0.11707089841365814,-0.0018610204569995403,0.5132946968078613,-0.12028184533119202},{-0.4655100405216217,0.31325632333755493,0.0007991105085238814,-0.15613782405853271},{-0.2063591033220291,0.15018491446971893,-0.28782421350479126,0.13194677233695984},{0.15210458636283875,0.02907516062259674,0.31475475430488586,0.1470814049243927},{-0.16398762166500092,-0.3439720869064331,-0.14644944667816162,-0.15669095516204834},{-0.4311002492904663,0.028808733448386192,-0.1108458936214447,0.37067079544067383},{-0.3496757745742798,-0.15248657763004303,-0.22291363775730133,0.2782553732395172},{-0.0745689645409584,-0.21258509159088135,0.46928516030311584,0.05548454076051712},{-0.2655639946460724,-0.21593599021434784,0.03829821199178696,-0.21238291263580322},{0.19039402902126312,0.17672275006771088,0.1948515772819519,-0.2692970037460327},{-0.02658376656472683,-0.3903065025806427,-0.12091966718435287,0.40180549025535583},{0.49330204725265503,-0.32296013832092285,0.1288880705833435,0.10677500814199448},{-0.3679986298084259,-0.09336231648921967,-0.3113023042678833,-0.4046948552131653},{-0.1450854241847992,-0.3324447572231293,-0.13128113746643066,-0.10258211195468903},{0.20792503654956818,0.2150367945432663,-0.10556960850954056,0.08329840749502182},{0.12175969034433365,-0.22829286754131317,0.36444616317749023,0.08238131552934647},{-0.06343916058540344,-0.21266280114650726,-0.057034142315387726,0.3795417845249176},{0.2034674733877182,0.062075719237327576,0.07020553946495056,0.053896043449640274},{-0.1763826608657837,0.12071876227855682,0.3093453347682953,0.04620467871427536},{-0.30179184675216675,-0.06634709984064102,0.08994642645120621,0.31913888454437256},{0.35436585545539856,0.2416045218706131,0.2873147130012512,-0.04406849294900894}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09102741628885269,-0.1320509910583496,0.09028224647045135,0.09632067382335663,0.08849670737981796,-0.1944667547941208,0.09718044102191925,0.027198513969779015,-0.08295487612485886,-0.04168209061026573,-0.0012994714779779315,-0.024167360737919807,-0.012053793296217918,0.10127779096364975,0.11860376596450806,-0.025018054991960526};
static const float actor_encoder_self_encoder_2_bias[16] = {0.01806580275297165,0.05502714216709137,0.045972246676683426,-0.058142051100730896,-0.05085292458534241,0.07830093055963516,-0.0613798126578331,-0.09464297443628311,0.03319694101810455,-0.022159088402986526,-0.025351515039801598,0.007625263649970293,-0.014672089368104935,-0.07991352677345276,0.044505685567855835,-0.09029730409383774};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0466795489192009,-0.010953674092888832,-0.06065067648887634,0.05743785575032234,0.011263496242463589,0.019345661625266075,-0.050442829728126526,-0.05456100404262543,-0.006869689095765352,-0.027798719704151154,0.0171554796397686,0.02281145192682743,-0.0032318823505192995,-0.013059149496257305,0.03313274681568146,-0.08566811680793762,-0.0007913273293524981,-0.02883203886449337,0.02048211544752121,-0.06730753928422928,0.015450033359229565,-0.010951249860227108,0.01400400884449482,-0.06608138233423233,-0.07171405106782913,0.06421196460723877,0.025706438347697258,-0.012863813899457455,0.05320039764046669,0.017947807908058167,-0.007158634252846241,0.05135801061987877};
static const float action_parameterization_distribution_linear_bias[4] = {0.027113258838653564,0.06337586790323257,0.004307093098759651,0.040491051971912384};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3204123377799988,-0.23295655846595764,-0.130341038107872,0.192147359251976,-0.11939685046672821,0.06996732950210571,-0.27648836374282837,-0.004107838496565819},{0.10092919319868088,0.16167885065078735,0.31099340319633484,0.32858824729919434,-0.11722128093242645,-0.30727487802505493,0.31064823269844055,0.2544015347957611},{0.022478023543953896,0.2144436538219452,0.042873021215200424,-0.08064762502908707,0.33645230531692505,0.23845542967319489,-0.0490744449198246,0.16122354567050934},{0.08213350921869278,-0.27448540925979614,0.2599729001522064,-0.2627721130847931,-0.24364939332008362,0.07764412462711334,0.22014279663562775,0.21006706357002258},{-0.23891398310661316,0.005804356187582016,-0.08399390429258347,-0.3857988119125366,0.12296230345964432,0.0788733959197998,0.28401193022727966,0.2536269426345825},{-0.05762924998998642,0.29637476801872253,-0.05946668982505798,-0.30299705266952515,0.26906856894493103,0.04812641069293022,0.031886398792266846,-0.19025124609470367},{0.020788444206118584,0.3109161853790283,0.144618421792984,-0.21392449736595154,0.34474921226501465,-0.2180107980966568,0.14850208163261414,0.10769304633140564},{0.08130928874015808,-0.22720137238502502,-0.03638486936688423,-0.2609683871269226,0.2780632972717285,-0.13083016872406006,-0.17002183198928833,-0.29718974232673645},{-0.2187807708978653,0.3063732981681824,0.02562745101749897,-0.05924571305513382,0.011235776357352734,0.28482016921043396,0.3959660828113556,0.3692159950733185},{0.03271223604679108,-0.014406891539692879,-0.28609699010849,0.29374992847442627,0.28943878412246704,0.20126056671142578,0.2554226517677307,-0.25327998399734497},{-0.137598916888237,-0.2857881188392639,0.333096444606781,0.16710083186626434,-0.0042675938457250595,-0.3370875418186188,-0.07448797672986984,-0.3193259537220001},{0.2887274920940399,0.09189511090517044,0.3582920730113983,0.35891616344451904,-0.1569177806377411,0.24858158826828003,0.11400967091321945,-0.3636457026004791},{-0.33171650767326355,0.17424067854881287,-0.3748856782913208,0.4040016829967499,-0.021083198487758636,0.34582003951072693,-0.011375597678124905,0.2617892920970917},{0.012687629088759422,0.22474753856658936,-0.14951825141906738,-0.14381739497184753,0.04792145639657974,0.054033949971199036,0.3129238784313202,0.01695057563483715},{0.214155375957489,-0.2657714784145355,-0.3404385447502136,-0.1898900717496872,0.1896943747997284,-0.21661385893821716,0.19342194497585297,-0.06078119948506355},{-0.3864442706108093,-0.3428904712200165,-0.25532984733581543,0.010157153941690922,0.04485905170440674,0.14546790719032288,0.26337718963623047,-0.004179075825959444},{-0.15696819126605988,-0.2717629671096802,0.17179988324642181,-0.32233676314353943,0.10605831444263458,0.018678810447454453,-0.4184679687023163,-0.18833941221237183},{0.07695235311985016,0.24349413812160492,0.07673921436071396,0.17680083215236664,-0.022867759689688683,0.3365364372730255,0.30206209421157837,-0.14809852838516235},{0.043433450162410736,-0.3114945590496063,-0.15065604448318481,-0.06567156314849854,-0.06803570687770844,-0.35536614060401917,0.09889731556177139,-0.23679065704345703},{-0.055661022663116455,0.012683688662946224,0.018440568819642067,-0.27712205052375793,0.1158815547823906,0.10440686345100403,0.18536418676376343,-0.03970523923635483},{0.0758826807141304,-0.07280857115983963,0.008425216190516949,-0.20633944869041443,0.04054656997323036,-0.039034973829984665,0.12141053378582001,-0.1583692729473114},{-0.3127340078353882,0.18084624409675598,0.1257142573595047,-0.25307944416999817,-0.4056369364261627,-0.026817267760634422,0.2829979956150055,0.061492130160331726},{0.2776099741458893,0.06970534473657608,-0.40634554624557495,0.04971781000494957,-0.023584682494401932,0.23046359419822693,0.322953999042511,0.3452433943748474},{0.001834407215937972,-0.19685493409633636,-0.008080457337200642,0.204270139336586,-0.29509657621383667,-0.04108857363462448,-0.09154309332370758,-0.277161180973053},{0.15431080758571625,-0.051874008029699326,-0.4349919855594635,0.3350397050380707,-0.26935988664627075,-0.19817213714122772,-0.36613017320632935,0.1480303257703781},{-0.01833818480372429,0.30850160121917725,-0.27519798278808594,-0.07053931057453156,0.1305883824825287,-0.15359871089458466,0.3364603519439697,-0.3066006004810333},{-0.11876220256090164,0.0686151459813118,-0.14529094099998474,-0.18100754916667938,0.08089885115623474,-0.12260694801807404,-0.08381203562021255,-0.1420893669128418},{0.07403229922056198,-0.18487054109573364,-0.022290904074907303,-0.10503873229026794,0.08116208016872406,0.05934775620698929,-0.19574810564517975,0.08330103754997253},{0.26336246728897095,0.04344027861952782,-0.3444429337978363,-0.2327335923910141,-0.19552594423294067,0.13065502047538757,0.22275729477405548,0.07803954929113388},{0.30315908789634705,-0.33886003494262695,0.036192238330841064,-0.07200212776660919,0.1445528268814087,-0.1182934045791626,0.18603788316249847,0.3282225430011749},{-0.31480729579925537,-0.23873956501483917,0.03739365190267563,-0.34386953711509705,0.30183130502700806,-0.2573463022708893,0.005826825276017189,0.08674529939889908},{0.1537916362285614,0.11665351688861847,-0.11081039160490036,0.2497096210718155,0.04575874283909798,-0.03688402473926544,-0.015058179385960102,0.03514141961932182}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24268287420272827,0.43718576431274414,-0.5473871827125549,-0.5291497707366943,-0.22304093837738037,-0.04987959563732147,-0.4331616759300232,0.5784979462623596},{-0.06573555618524551,0.47520026564598083,-0.26826170086860657,0.6225239634513855,-0.027972931042313576,-0.005896769464015961,-0.3379102945327759,0.0261459369212389},{-0.3933027684688568,-0.1944742351770401,-0.12371522933244705,-0.09330423176288605,0.4703821539878845,0.2517011761665344,-0.04501514509320259,0.41016602516174316},{-0.5073924660682678,-0.5398827791213989,0.329984575510025,0.32752686738967896,-0.47393807768821716,-0.22075317800045013,0.4309426248073578,0.2314804196357727},{-0.3023119270801544,-0.23396120965480804,-0.3152655363082886,-0.22920165956020355,0.3327290117740631,-0.2185148000717163,0.5206015706062317,-0.41418683528900146},{-0.02203725092113018,0.21950660645961761,0.20856502652168274,-0.5417129397392273,0.5397568345069885,-0.2701582610607147,-0.4689962565898895,-0.40169697999954224},{-0.3402901291847229,0.17328038811683655,0.0941237136721611,-0.49032846093177795,-0.01984964683651924,-0.5320715308189392,0.5009427070617676,0.028529629111289978},{-0.39217761158943176,-0.1976587474346161,-0.1313888430595398,-0.32907089591026306,-0.3449971377849579,0.14101438224315643,0.5542968511581421,-0.3130868077278137}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.006707695312798023,-0.13261228799819946,-0.13266173005104065,-0.00613634055480361,0.10038387775421143,0.03726675733923912,0.0811772570014,0.06862597167491913};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.04368329420685768,-0.044725410640239716,-0.03284740075469017,-0.11874970048666,-0.08228109776973724,-0.06864024698734283,-0.008948744274675846,-0.1489461064338684};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

