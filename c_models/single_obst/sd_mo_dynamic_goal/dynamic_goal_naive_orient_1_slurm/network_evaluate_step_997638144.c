#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.348877876996994,-0.1126868799328804,0.28902667760849,0.11511056870222092,-0.2851083278656006,0.29193419218063354,0.00675165094435215,-0.11029315739870071,0.1022351086139679,0.3205152750015259,0.08826112002134323,0.01069908682256937,0.21452966332435608,-0.2188713252544403,0.25597625970840454,-0.03018856793642044},{-0.20919659733772278,-0.400905579328537,0.2781088948249817,0.06524129956960678,-0.209064319729805,0.15717141330242157,-0.42931243777275085,-0.04254879057407379,-0.10861088335514069,-0.21348249912261963,0.013593073934316635,-0.18623550236225128,-0.01838095486164093,-0.3253664970397949,-0.28290823101997375,0.11647825688123703},{-0.16279113292694092,-0.26872220635414124,-0.47661516070365906,0.2064511775970459,0.28414463996887207,0.6368779540061951,0.022782864049077034,-0.024952303618192673,0.16730356216430664,-0.5791144967079163,-0.4353282153606415,0.8543476462364197,-0.27456387877464294,-0.3293361961841583,-0.45016318559646606,0.34243831038475037},{0.18409530818462372,0.2482270747423172,0.3804990351200104,-0.03308854624629021,-0.3901207149028778,-0.026295611634850502,0.2696322202682495,0.08336582779884338,0.31871265172958374,-0.304056853055954,0.006201783660799265,0.40933758020401,-0.23084324598312378,-0.013300105929374695,0.47537118196487427,-0.4687715172767639},{-0.0906490609049797,0.04411608725786209,0.3093152344226837,-0.06872604042291641,0.30228501558303833,0.43080222606658936,0.16567344963550568,-0.04245971515774727,0.11760501563549042,0.20148515701293945,0.291353315114975,-0.33403998613357544,-0.16410395503044128,-0.4428062438964844,0.3504132628440857,0.10212642699480057},{-0.28440791368484497,-0.17966759204864502,-0.2173812985420227,-0.02729509398341179,0.20846450328826904,0.2441515326499939,0.010569145902991295,-0.08607835322618484,0.3315426707267761,-0.3095760941505432,-0.4454507827758789,0.2395152598619461,0.0805281549692154,-0.17224706709384918,0.0010427385568618774,0.10966911166906357},{0.05592915788292885,0.1292399913072586,0.04767497256398201,-0.41421985626220703,0.13212339580059052,-0.03322966396808624,0.030319679528474808,0.3576732873916626,0.3180203139781952,0.06514043360948563,-0.4050770401954651,-0.03820516914129257,-0.0033141470048576593,0.17814695835113525,-0.23687097430229187,-0.22975046932697296},{-0.28145235776901245,0.46604177355766296,0.42255890369415283,0.36930426955223083,-0.4699873626232147,-0.053319964557886124,0.5927388072013855,0.5244874358177185,-0.2546626627445221,0.28579145669937134,-0.7356860041618347,-0.4358981251716614,0.45924365520477295,0.044519755989313126,0.23577184975147247,0.45945075154304504},{0.40784889459609985,-0.30509912967681885,0.630891740322113,0.10025018453598022,0.008872010745108128,0.059663739055395126,0.14067880809307098,-0.6866716742515564,-0.25077226758003235,-0.3846045732498169,-0.15274983644485474,0.010366168804466724,-0.06868167966604233,0.7499203085899353,0.48608270287513733,-0.3388517200946808},{0.179936483502388,-0.6177056431770325,-0.6595174670219421,-0.3844052851200104,-0.22598017752170563,0.24830344319343567,0.14323553442955017,0.11112885922193527,0.6389415264129639,0.2911736071109772,0.22269900143146515,-0.26555755734443665,-0.13839301466941833,0.4649231731891632,-0.21414165198802948,-0.6018020510673523},{0.20567384362220764,0.4211535155773163,0.41538676619529724,-0.5659218430519104,-0.37471795082092285,0.12811656296253204,0.18222850561141968,0.45229867100715637,-0.4048376977443695,0.043637361377477646,-0.052756067365407944,-0.037756919860839844,-0.13535214960575104,-0.17893902957439423,0.2731236517429352,-0.41950371861457825},{-0.0691140815615654,-0.4551594853401184,0.183176651597023,0.6866084337234497,0.876224935054779,0.4585418403148651,0.453835129737854,0.4568224549293518,0.024695420637726784,-0.0300337802618742,0.250893235206604,-0.45561450719833374,-0.6643813252449036,-0.4183651804924011,0.8167303204536438,-0.03456784784793854},{-0.2215278148651123,0.37165510654449463,-0.07031011581420898,-0.6187458038330078,0.14710208773612976,0.09820320457220078,0.1824369877576828,0.17449963092803955,0.06926090270280838,0.007027121260762215,0.05880490690469742,0.18683594465255737,0.3589572310447693,0.32811930775642395,-0.10881616175174713,-0.11317902058362961},{0.02996390126645565,-0.39605629444122314,-0.2655147612094879,-0.2034509927034378,-0.45118555426597595,0.04697444662451744,-0.333284854888916,-0.3390635848045349,-0.2530818581581116,-0.027796374633908272,-0.41721633076667786,-0.021453924477100372,-0.18870118260383606,0.40839025378227234,0.1145685687661171,-0.007994994521141052},{0.052710048854351044,-0.2743525505065918,-0.22978368401527405,0.19732242822647095,-0.13789811730384827,-0.4452511668205261,0.28934940695762634,-0.0731523334980011,-0.021315922960639,0.37190988659858704,0.07446954399347305,0.03249048441648483,0.28690093755722046,-0.014582108706235886,-0.23017241060733795,0.22077447175979614},{0.354996919631958,0.0020107931923121214,-0.24024108052253723,-0.14862217009067535,-0.2752804458141327,0.14991645514965057,0.3334735631942749,-0.08588431775569916,0.15107686817646027,0.32365158200263977,-0.1434984803199768,0.061673060059547424,-0.1778378188610077,0.21603387594223022,-0.06934978812932968,-0.005206229165196419},{-0.2410501092672348,-0.21084743738174438,0.24063074588775635,0.11078501492738724,-0.23423145711421967,0.05449553206562996,-0.18426033854484558,-0.10195156186819077,-0.1948433220386505,-0.26963987946510315,-0.035017967224121094,-0.2865138649940491,0.07712099701166153,-0.19439178705215454,0.07659941166639328,-0.20484676957130432},{-0.23323452472686768,0.24773873388767242,-0.31538355350494385,-0.16662079095840454,0.04663299769163132,0.3047221004962921,-0.18654955923557281,-0.204432412981987,0.1167980432510376,0.1180560365319252,0.3378596305847168,-0.11688733100891113,-0.2906455397605896,0.297712504863739,0.006947691086679697,-0.39585790038108826}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.023823823779821396,-0.06264970451593399,-0.10135067999362946,-0.33775877952575684,0.3094581663608551,0.2909260392189026,0.07372816652059555,0.047835737466812134,-0.06738854944705963,-0.18578341603279114,0.0034641704987734556,0.06969990581274033,0.20189674198627472,0.28238922357559204,0.15046203136444092,0.04066046327352524},{-0.13657528162002563,-0.30209413170814514,-0.054769404232501984,0.03788098692893982,0.24377046525478363,-0.28013554215431213,0.024837851524353027,0.04712960869073868,-0.051538728177547455,0.27020806074142456,-0.21938446164131165,0.32631173729896545,-0.3770689368247986,0.15963256359100342,-0.2253020703792572,-0.3423176109790802},{0.026012472808361053,0.21119585633277893,-0.3876120150089264,-0.5173355340957642,0.20427928864955902,0.43787282705307007,-0.0860423743724823,0.061798661947250366,-0.26869523525238037,-0.23644737899303436,-0.011868981644511223,0.32814860343933105,-0.28606435656547546,-0.11928994208574295,0.11360542476177216,-0.09188435226678848},{0.13310781121253967,-0.0697220116853714,0.09173755347728729,0.17010080814361572,-0.43620944023132324,0.002580284373834729,0.05975140631198883,-0.19838912785053253,0.2763456404209137,0.35879209637641907,-0.1755768358707428,-0.14813268184661865,-0.42671528458595276,-0.3195071816444397,0.19269730150699615,0.12749308347702026},{-0.024677498266100883,0.14923521876335144,0.010637917555868626,0.2778127193450928,-0.232474222779274,0.09861058741807938,-0.010822955518960953,0.17107683420181274,0.24596060812473297,-0.211819127202034,0.1925123780965805,0.24261970818042755,0.184682697057724,-0.43025878071784973,0.02317180670797825,0.04681042954325676},{0.19432851672172546,0.2583507299423218,-0.004412662237882614,0.18882235884666443,-0.49406683444976807,-0.4433266818523407,0.26625576615333557,0.32698822021484375,0.05975034832954407,0.3692880868911743,0.2243460863828659,-0.2552010118961334,-0.0022877403534948826,-0.16863395273685455,-0.11453306674957275,0.2804219126701355},{-0.10865307599306107,0.2575041651725769,0.28579461574554443,-0.37264883518218994,-0.25026679039001465,0.007578741293400526,-0.353331595659256,-0.038619983941316605,0.18650351464748383,0.060123227536678314,-0.12781351804733276,-0.20524302124977112,-0.31520792841911316,-0.10961686819791794,0.18650376796722412,0.015553436242043972},{-0.09855891019105911,-0.12652531266212463,-0.47019538283348083,0.29081064462661743,-0.29783958196640015,-0.24779391288757324,-0.23654526472091675,-0.37070339918136597,0.13825565576553345,-0.19398653507232666,0.05316806584596634,0.051376547664403915,-0.14572212100028992,0.4176287353038788,-0.006160289514809847,-0.292959064245224},{-0.2998031973838806,0.24517762660980225,-0.012351805344223976,-0.05927891284227371,0.27612361311912537,-0.2760520875453949,0.2850993573665619,0.13662737607955933,0.3388596475124359,0.31955087184906006,0.25286582112312317,0.31047171354293823,0.1821494847536087,-0.11594410240650177,0.22781018912792206,0.09106404334306717},{0.09138529002666473,-0.27603352069854736,-0.12968739867210388,-0.1262587159872055,0.2350175678730011,-0.15724420547485352,-0.28684747219085693,-0.14777687191963196,0.05080949142575264,-0.36872950196266174,-0.2523724138736725,0.30932581424713135,0.11425559222698212,0.06983672827482224,-0.28173211216926575,0.22375357151031494},{-0.025271160528063774,-0.44258108735084534,0.2806430757045746,0.27066680788993835,0.2696128785610199,0.15930067002773285,0.14107917249202728,-0.13596466183662415,0.23118597269058228,-0.19592688977718353,0.16610515117645264,0.33886346220970154,0.46864038705825806,0.10468319058418274,-0.01741475984454155,0.03100057877600193},{0.051490843296051025,-0.008474687114357948,0.39392539858818054,-0.013899597339332104,-0.25186964869499207,-0.1920924037694931,0.4222572147846222,0.3030874729156494,-0.23649443686008453,-0.18675795197486877,-0.04633024334907532,-0.35119426250457764,-0.004081131424754858,-0.3005266487598419,-0.2848074734210968,0.08480702340602875},{-0.17043213546276093,-0.316778302192688,0.4156892001628876,-0.23111747205257416,0.38141950964927673,-0.30982837080955505,-0.468202143907547,0.06020163372159004,0.10250295698642731,0.057293061167001724,-0.3107498586177826,0.11269187927246094,0.10607613623142242,-0.25451353192329407,-0.18348948657512665,-0.007187096402049065},{0.3787922263145447,-0.3396225869655609,0.4555928707122803,0.08727080374956131,-0.09909408539533615,0.33931654691696167,-0.11032645404338837,-0.22496140003204346,-0.39325299859046936,0.08033015578985214,0.024838287383317947,-0.3480303883552551,-0.11605872213840485,0.07924497872591019,0.291917085647583,0.04790216311812401},{-0.09431786835193634,0.18629541993141174,0.13000719249248505,-0.4833446741104126,-0.17894330620765686,0.20620477199554443,0.23524537682533264,-0.25464826822280884,0.2421777993440628,-0.2604014277458191,0.07980416715145111,0.11095882207155228,-0.028342291712760925,0.19543063640594482,0.0534394346177578,0.06656558811664581},{-0.13225263357162476,0.3936319649219513,-0.45022255182266235,0.3992178440093994,0.0923895537853241,-0.37634944915771484,-0.017117243260145187,-0.08068833500146866,-0.3152107298374176,0.3653534948825836,-0.2917984426021576,0.25729888677597046,-0.10440437495708466,-0.2804323732852936,-0.09160128235816956,-0.4634987711906433}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12128432840108871,0.09904129058122635,0.012481532990932465,-0.04683682322502136,-0.09067009389400482,-0.0009086518548429012,0.26075315475463867,0.08240356296300888,-0.16093675792217255,-0.18413878977298737,0.10783551633358002,-0.2480469048023224,-0.17640285193920135,0.2399846911430359,0.21360141038894653,0.3134617805480957,-0.2602751553058624,-0.2752392590045929,-0.18168991804122925,0.13944317400455475,-0.04447215422987938,-0.35900744795799255,-0.2669791877269745,-0.26903286576271057,-0.21941661834716797,0.11327368766069412,-0.22279499471187592,-0.0708175078034401,-0.08787564933300018,0.0013153364416211843,0.2132115513086319,-0.2087390124797821},{0.2986854612827301,0.1475316733121872,0.18469588458538055,-0.07327134907245636,0.12961071729660034,-0.15600614249706268,0.3428131937980652,0.15330666303634644,-0.11868637800216675,-0.07060103118419647,-0.12530340254306793,-0.2438204288482666,-0.19423708319664001,0.2363692969083786,-0.2622520327568054,-0.19725054502487183,-0.05156572163105011,0.17691747844219208,-0.3492424786090851,-0.2114965319633484,-0.018412282690405846,0.20177176594734192,0.0169539637863636,0.031190363690257072,0.22156259417533875,-0.334819495677948,-0.05729744955897331,0.05849799886345863,0.15627402067184448,-0.09686695784330368,-0.07495786249637604,0.2112460732460022},{0.17028506100177765,0.050753362476825714,-0.1303502917289734,0.1425631046295166,-0.15108941495418549,-0.1406635344028473,-0.2150568664073944,0.05835115164518356,-0.17358897626399994,0.3360658586025238,-0.31514987349510193,-0.2707580626010895,0.18246398866176605,-0.40546587109565735,-0.13985806703567505,0.09606575220823288,-0.08143153041601181,-0.11405570060014725,0.19160111248493195,-0.10112577676773071,0.23539124429225922,0.27865859866142273,-0.21798929572105408,0.023648735135793686,-0.26452454924583435,-0.024083847180008888,0.1440252661705017,-0.0640825629234314,0.023595204576849937,-0.20369091629981995,-0.10267633199691772,-0.07663916796445847},{0.38782966136932373,0.05716768652200699,0.12916027009487152,-0.1814391165971756,-0.2473166137933731,-0.04128168523311615,-0.12772902846336365,0.2699832320213318,0.22717911005020142,-0.29594922065734863,-0.06018039211630821,0.25260019302368164,0.11939442902803421,-0.009420069865882397,-0.24311716854572296,0.2933095395565033,-0.29329100251197815,0.2622951567173004,-0.004734792746603489,0.10526110231876373,-0.09977629035711288,-0.08601751923561096,0.289826363325119,0.15611577033996582,0.15761372447013855,-0.3523506224155426,0.26122570037841797,-0.20462016761302948,-0.033488474786281586,0.051342759281396866,-0.2108316570520401,0.14045670628547668},{-0.06553991138935089,-0.05084801837801933,-0.11356157809495926,0.11749184131622314,0.20865319669246674,-0.13716016709804535,-0.4117269515991211,-0.0762733742594719,-0.10433744639158249,-0.3136943578720093,0.15226653218269348,0.2429039478302002,-0.05468941852450371,-0.11856000870466232,-0.0986819639801979,0.1255880892276764,-0.01845334656536579,-0.03414102643728256,-0.2968735694885254,-0.2008272260427475,-0.17857755720615387,-0.3451966643333435,0.13946834206581116,0.13396495580673218,-0.10483395308256149,0.34607425332069397,-0.17969658970832825,0.22215257585048676,0.26601168513298035,0.38024967908859253,-0.015072496607899666,0.3749510943889618},{-0.27365580201148987,0.03323686122894287,-0.23479706048965454,-0.05691331624984741,-0.20252269506454468,0.23942235112190247,0.2084551751613617,0.02108774520456791,0.2526089549064636,0.21119794249534607,0.3317614495754242,-0.22843244671821594,-0.2767900228500366,0.19758804142475128,0.33857497572898865,-0.33205747604370117,-0.11208336800336838,-0.24373973906040192,0.23894430696964264,0.10980645567178726,0.08395208418369293,0.19345349073410034,0.06464648246765137,-0.07988889515399933,-0.3332896828651428,0.3375883400440216,-0.13327547907829285,0.21976901590824127,0.28815558552742004,0.17767852544784546,0.07329849153757095,0.010986631736159325},{0.19431072473526,-0.13049328327178955,-0.1258993297815323,-0.2831040918827057,-0.03832007199525833,0.24246442317962646,0.2809296250343323,0.18841828405857086,0.07975109666585922,0.34038814902305603,0.000700330943800509,-0.012637202627956867,-0.4876992404460907,-0.17280691862106323,-0.14767353236675262,0.16329389810562134,-0.25050750374794006,-0.21390672028064728,0.22995631396770477,-0.08280017226934433,-0.13306057453155518,-0.1445101499557495,-0.2297862023115158,-0.2138291895389557,0.13080446422100067,-0.2098928689956665,-0.07332028448581696,-0.19246640801429749,0.29462358355522156,0.14366257190704346,-0.15116772055625916,-0.28998303413391113},{0.0036992160603404045,0.17540335655212402,0.05642234534025192,0.012036142870783806,0.12739063799381256,-0.3008623719215393,-0.1509087085723877,-0.14486709237098694,-0.037282105535268784,-0.24336446821689606,-0.2864691913127899,-0.020865153521299362,-0.161590576171875,-0.03672007471323013,-0.11174977570772171,0.3845311105251312,-0.00548950769007206,-0.15077464282512665,0.1447167545557022,0.334404319524765,-0.10741906613111496,-0.22902248799800873,0.2636435329914093,0.08966098725795746,-0.05781768634915352,-0.2806493937969208,-0.2867671847343445,-0.2985519468784332,-0.3251952826976776,-0.2295525223016739,0.053238414227962494,-0.2911357581615448},{0.07936796545982361,0.2878214418888092,-0.25731995701789856,-0.31335633993148804,-0.1977093517780304,0.04690331965684891,0.07110980898141861,0.04384813830256462,0.17297664284706116,-0.26987606287002563,-0.25048720836639404,0.32061490416526794,-0.24436131119728088,-0.18144360184669495,0.17708292603492737,-0.28505727648735046,0.26723918318748474,0.15177330374717712,0.30812227725982666,0.03897998109459877,0.22496284544467926,0.026484418660402298,0.252169668674469,-0.07633940875530243,0.36084407567977905,-0.2028956562280655,0.09270434826612473,0.3099086880683899,-0.2699773609638214,0.2190403938293457,-0.034474100917577744,0.15118032693862915},{-0.1863316297531128,0.12425997108221054,-0.22179147601127625,-0.14909160137176514,0.19889035820960999,-0.12714192271232605,0.06295935809612274,-0.006977459415793419,0.15063855051994324,-0.059350501745939255,-0.2509725093841553,-0.27537262439727783,-0.3008594214916229,-0.058602143079042435,-0.24341118335723877,0.09285806119441986,0.08507046103477478,-0.20529985427856445,0.28306230902671814,0.0749301165342331,-0.005257897544652224,-0.015717003494501114,0.2745705842971802,-0.2078331559896469,0.29900923371315,0.12136803567409515,-0.25992879271507263,0.02435486949980259,-0.0014762746868655086,0.1498805284500122,-0.11345493793487549,0.11325041949748993},{0.07419122755527496,0.006150800734758377,0.21149398386478424,-0.25581255555152893,-0.27550259232521057,-0.2575063705444336,-0.26475122570991516,-0.005762163084000349,-0.19609439373016357,0.42163750529289246,0.12042179703712463,-0.25691401958465576,-0.3972198963165283,-0.023314276710152626,-0.23849007487297058,-0.08755755424499512,0.22577239573001862,-0.1400851458311081,0.24997350573539734,-0.13545803725719452,-0.19373586773872375,-0.0070338197983801365,0.14266735315322876,0.24456416070461273,0.15734700858592987,-0.10216756910085678,-0.02133055031299591,-0.10214617848396301,-0.08247705549001694,0.024869145825505257,-0.051955822855234146,0.1214100643992424},{-0.17190927267074585,-0.12021571397781372,0.21033212542533875,0.30347275733947754,0.2461850494146347,-0.06476522237062454,0.06208314374089241,-0.2246859073638916,-0.01158716157078743,-0.2468760460615158,0.264081746339798,-0.22324928641319275,-0.22779028117656708,-0.20763655006885529,0.23986099660396576,-0.009603518061339855,-0.026206079870462418,-0.00034404860343784094,0.3525753915309906,0.04394736886024475,-0.16490723192691803,0.20882809162139893,0.10299202799797058,-0.0701325461268425,0.22482578456401825,-0.0906684622168541,-0.18245819211006165,0.2045634686946869,0.10633918642997742,0.010077384300529957,-0.31122270226478577,-0.22673159837722778},{0.2868745028972626,-0.25065723061561584,0.009892376139760017,-0.3185531497001648,0.01099351141601801,-0.1534811407327652,0.12161938101053238,0.15824902057647705,0.22917602956295013,0.04378663748502731,0.1760515570640564,0.247563436627388,-0.4308110773563385,-0.3400115966796875,-0.046482861042022705,-0.20571833848953247,-0.23354364931583405,-0.2799379527568817,0.31147798895835876,-0.16447168588638306,0.3207867443561554,-0.0899023786187172,-0.010887334123253822,0.19821038842201233,0.11460722237825394,-0.09681772440671921,0.10965245962142944,0.051137231290340424,0.04124697297811508,-0.019060637801885605,-0.2685212194919586,-0.014696723781526089},{0.2682907283306122,-0.03977654129266739,-0.011536961421370506,0.3293704390525818,-0.0975327119231224,-0.16374510526657104,-0.010009209625422955,0.1864449381828308,0.1874469369649887,0.24085083603858948,0.11679461598396301,-0.13946548104286194,0.0611613504588604,0.2117006480693817,-0.1271999478340149,0.1391720324754715,0.22917091846466064,-0.2184474915266037,0.11527010798454285,-0.32787564396858215,0.23452672362327576,0.16090893745422363,-0.08252972364425659,0.20467591285705566,0.2615562677383423,0.055561985820531845,0.1608375906944275,0.0912376269698143,0.06952572613954544,-0.1421504020690918,0.03589702397584915,0.3376460373401642},{0.08342074602842331,-0.1987285315990448,-0.0027652832213789225,0.0986611619591713,-0.27740103006362915,-0.022379416972398758,0.051642585545778275,-0.203565776348114,-0.15594637393951416,-0.01870036870241165,0.1620284467935562,0.21513615548610687,0.09440220147371292,0.2375922054052353,-0.028205005452036858,-0.026674607768654823,-0.23868636786937714,0.24509501457214355,-0.07026713341474533,-0.18820878863334656,-0.19941848516464233,-0.11846595257520676,0.15038006007671356,0.054583244025707245,0.010690505616366863,-0.1595437079668045,-0.1626976728439331,0.1986272633075714,0.0414433479309082,-0.15811127424240112,0.24372684955596924,0.16058987379074097},{0.1652185022830963,-0.23394037783145905,0.026036392897367477,-0.18227814137935638,0.018469233065843582,0.15324825048446655,0.05908411368727684,0.26075971126556396,-0.07810933887958527,-0.0360732264816761,0.20082619786262512,0.1315283626317978,0.04878612980246544,-0.10428847372531891,-0.013726694509387016,0.20428013801574707,-0.3282204866409302,-0.17547385394573212,-0.030465714633464813,0.08624955266714096,0.04118574410676956,0.23348942399024963,0.14153394103050232,0.19291213154792786,0.05228354409337044,0.18533380329608917,-0.030339600518345833,-0.06217499077320099,0.06591680645942688,-0.09435923397541046,-0.251291960477829,0.31269535422325134},{0.17484484612941742,-0.019105784595012665,-0.31038448214530945,0.1223563477396965,0.06838146597146988,-0.0607275515794754,0.32271403074264526,0.10459549725055695,0.13412702083587646,-0.1278517246246338,0.18109184503555298,-0.22384558618068695,-0.347156286239624,0.24235782027244568,0.06745930016040802,0.03632457181811333,-0.01862523704767227,-0.10684751719236374,-0.15833137929439545,0.07321939617395401,-0.027817469090223312,0.18203410506248474,0.06933178007602692,-0.1513906717300415,-0.06870340555906296,-0.23799417912960052,0.03471129387617111,0.2961912155151367,0.19681431353092194,-0.15793895721435547,0.16933272778987885,0.1823800802230835},{-0.0912185087800026,0.006205074023455381,-0.09191544353961945,-0.06259411573410034,-0.23865525424480438,-0.03129422664642334,0.2120669037103653,0.1574428379535675,0.12369049340486526,0.02969735860824585,0.1810237318277359,-0.001425827038474381,0.2510107159614563,0.1903347223997116,0.19728034734725952,-0.12747040390968323,0.11266613006591797,0.18085135519504547,0.20056971907615662,0.0396861806511879,0.21455702185630798,0.2643188536167145,0.08405342698097229,0.15883998572826385,-0.046768493950366974,-0.05695236846804619,-0.1329256147146225,-0.262004017829895,0.14835841953754425,-0.2805928885936737,0.014711207710206509,-0.049444522708654404},{-0.3106909990310669,0.049522727727890015,-0.310016930103302,-0.33138808608055115,0.022746514528989792,-0.0024852531496435404,0.11320159584283829,-0.14576223492622375,0.045453522354364395,0.3433258831501007,0.018233345821499825,-0.18395937979221344,0.07752751559019089,-0.2014867067337036,-0.29864877462387085,0.018315332010388374,-0.16999506950378418,0.10718611627817154,-0.04133458063006401,0.027891073375940323,-0.280743807554245,0.1383938491344452,0.09130136668682098,0.04255439713597298,-0.06312939524650574,0.3146800398826599,0.053180959075689316,-0.2028249055147171,-0.1702701449394226,0.0442940890789032,-0.19694331288337708,-0.2514258325099945},{-0.006038706749677658,-0.2634562849998474,-0.26915043592453003,-0.051274433732032776,-0.32315734028816223,-0.14743229746818542,0.17949168384075165,-0.2706795036792755,-0.20777028799057007,0.16360600292682648,0.20746922492980957,0.09032166004180908,0.12113530188798904,-0.15271545946598053,0.2646968364715576,-0.26936963200569153,0.09309842437505722,0.2587561309337616,0.055085889995098114,0.2721198499202728,0.0008539958507753909,-0.11311208456754684,-0.2745196223258972,0.22050902247428894,-0.11633054912090302,-0.15063980221748352,0.1172199472784996,0.043406322598457336,-0.12827439606189728,-0.315339595079422,-0.025419767946004868,-0.18884919583797455},{0.23157954216003418,0.14618802070617676,-0.05316207557916641,0.20199719071388245,-0.24438945949077606,0.1435723751783371,-0.09363812953233719,-0.16601714491844177,-0.13547806441783905,0.1785694658756256,-0.2967143654823303,-0.1353498101234436,-0.02214266173541546,-0.2029917687177658,-0.377329021692276,-0.147146537899971,-0.08158167451620102,-0.29929909110069275,-0.22375977039337158,0.21077598631381989,0.11058682948350906,0.1272376924753189,-0.3774923086166382,0.299721360206604,0.15187586843967438,0.30015459656715393,-0.27318277955055237,-0.05751240253448486,0.059618446975946426,-0.19588857889175415,0.15593869984149933,0.14733478426933289},{-0.05290132388472557,-0.3052253723144531,-0.04012475907802582,-0.30237504839897156,-0.07764308154582977,0.28510582447052,0.19839556515216827,0.038942109793424606,-0.08769889920949936,0.010122456587851048,-0.14500917494297028,0.1037404015660286,0.09997488558292389,0.049358054995536804,0.10921619087457657,0.03268606215715408,-0.09456179291009903,0.132315531373024,-0.10996076464653015,0.1455199271440506,0.19114890694618225,0.2509164810180664,-0.019660208374261856,-0.2520991861820221,0.16379910707473755,0.1646425873041153,0.2833244204521179,0.1577019989490509,0.012499099597334862,0.11753380298614502,0.013075810857117176,-0.09598222374916077},{-0.014620615169405937,-0.2091863453388214,0.22484897077083588,0.07387059926986694,0.2669542133808136,-0.034250300377607346,-0.14359159767627716,-0.19685542583465576,0.14775459468364716,-0.043473709374666214,0.08022753894329071,0.012494295835494995,-0.33543860912323,0.051489561796188354,-0.09667401760816574,-0.2565724551677704,-0.05151748284697533,-0.06861305236816406,0.19466613233089447,0.20068450272083282,0.029047532007098198,0.041748132556676865,0.16735593974590302,0.2964651584625244,-0.180819571018219,-0.048155609518289566,0.1654534935951233,-0.07261891663074493,-0.1370781809091568,-0.2493162900209427,0.29381370544433594,0.02513056807219982},{0.19190619885921478,-0.09926332533359528,0.05310242623090744,0.1038142591714859,-0.011359415017068386,0.03905661404132843,-0.22606056928634644,0.2936449944972992,-0.09532375633716583,-0.02755720354616642,0.09728829562664032,-0.31140515208244324,0.11463876068592072,-0.04390830546617508,-0.1270684450864792,0.3089155852794647,-0.08046337217092514,-0.16984038054943085,0.004155108705163002,0.017790915444493294,-0.1721486747264862,0.1604612022638321,0.20661520957946777,0.262281209230423,-0.2651737332344055,0.1202288419008255,-0.0932183712720871,0.05327561870217323,-0.26058855652809143,0.24708697199821472,-0.06547055393457413,0.030471520498394966}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.17936637997627258,-0.10844296216964722,0.03469396382570267,-0.10323505103588104},{0.19681335985660553,-0.2397649586200714,0.2649554908275604,0.22369371354579926},{-0.19227269291877747,0.02820606529712677,0.05212090164422989,-0.03227227181196213},{0.267886757850647,0.37404486536979675,0.2896212637424469,0.0361323319375515},{-0.2427009642124176,0.1413692981004715,-0.24442945420742035,0.10266885906457901},{0.017541663721203804,-0.06768497079610825,0.06873144954442978,0.2167431116104126},{-0.1014941930770874,-0.1513967514038086,-0.30689212679862976,-0.06447209417819977},{-0.08950039744377136,-0.3023861050605774,0.113191619515419,-0.05890215188264847},{-0.08194392174482346,0.14237691462039948,-0.08806779980659485,-0.07411060482263565},{0.1838303804397583,-0.03219466283917427,-0.06088590994477272,-0.1392146497964859},{0.20158031582832336,-0.1768302470445633,0.269538015127182,0.19220972061157227},{-0.01578754372894764,0.004218504298478365,0.30627986788749695,-0.06896129995584488},{-0.2783757448196411,0.22285665571689606,-0.04545686021447182,-0.06986697018146515},{-0.13452143967151642,0.017460664734244347,-0.20115023851394653,0.020301271229982376},{0.1806728094816208,-0.015613415278494358,0.19765134155750275,0.05452239513397217},{-0.11187873035669327,-0.25593510270118713,-0.10649295896291733,-0.06809898465871811},{-0.21936655044555664,0.050467267632484436,-0.07121803611516953,0.24375955760478973},{-0.22475025057792664,-0.11511114984750748,-0.21545447409152985,0.15370358526706696},{-0.060490742325782776,-0.07767859846353531,0.300614595413208,0.0726022943854332},{-0.1263469159603119,-0.15176089107990265,-0.005302290432155132,-0.14492441713809967},{0.13218338787555695,0.09973558038473129,0.10280979424715042,-0.12285856157541275},{-0.008284908719360828,-0.21712197363376617,-0.10824931412935257,0.19647403061389923},{0.26303279399871826,-0.10690338164567947,0.1352049857378006,0.00805269181728363},{-0.2321995496749878,-0.09814611077308655,-0.25566649436950684,-0.147660031914711},{-0.21268612146377563,-0.15316210687160492,-0.017677361145615578,-0.12122886627912521},{0.13323882222175598,0.13564522564411163,-0.03447835147380829,0.13743513822555542},{0.1689169704914093,-0.18335837125778198,0.20143786072731018,0.0638098493218422},{-0.048261526972055435,-0.1369602382183075,0.005586404353380203,0.26477083563804626},{0.019228620454669,0.006731613073498011,0.016390670090913773,0.009685560129582882},{-0.11525999754667282,0.1028585359454155,0.17542903125286102,0.016330990940332413},{-0.1196298897266388,-0.11952938139438629,0.08018134534358978,0.15078556537628174},{0.1602446585893631,0.18158824741840363,0.172556534409523,-0.011758384294807911}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.061751216650009155,0.0005407501594163477,-0.0010126607958227396,0.04800794646143913,0.050476279109716415,-0.0369902029633522,0.009073751978576183,0.05394924432039261,-0.0649605318903923,-0.08821462094783783,-0.025441482663154602,0.07084134221076965,-0.03402550518512726,0.03826463595032692,-0.02627864107489586,-0.01667073555290699};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.004616652149707079,-0.0005008730222471058,-0.010574676096439362,-0.014121698215603828,-0.055608343333005905,0.01649709977209568,-0.022229282185435295,-0.004506964236497879,0.018374308943748474,-0.04735720902681351,-0.00858359131962061,-0.016883503645658493,-0.008329026401042938,-0.020912617444992065,-0.014950226061046124,-0.04685524106025696};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.002484886208549142,0.06050732359290123,-0.024008827283978462,0.017386598512530327,-0.013958008028566837,0.036634281277656555,-0.042038630694150925,-0.021497737616300583,-0.032176949083805084,-0.018251052126288414,-0.01422293484210968,0.0325823575258255,0.01599358767271042,0.013580117374658585,0.06326065212488174,-0.051588352769613266,0.022822383791208267,-0.005046078469604254,0.016696972772479057,-0.03296102210879326,0.0009528865339234471,0.024471869692206383,-0.010434996336698532,-0.04263365641236305,-0.05438448488712311,0.013421020470559597,0.022909799590706825,0.03221631050109863,0.007100972812622786,0.021079858765006065,0.027653967961668968,0.003101309761404991};
static const float action_parameterization_distribution_linear_bias[4] = {0.008136617951095104,0.02354726381599903,0.01504224631935358,0.04199853911995888};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4416118860244751,-0.3683811128139496,-0.12234127521514893,0.2487141340970993,-0.1556214988231659,0.10053829848766327,-0.2873001992702484,0.07046722620725632},{0.2116418331861496,0.11542007327079773,0.40721961855888367,0.3848002552986145,-0.09861189126968384,-0.3388719856739044,0.3300751745700836,0.3985380232334137},{0.06707600504159927,0.18360576033592224,0.11314588040113449,-0.054093167185783386,0.33679071068763733,0.22045834362506866,-0.0029076768551021814,0.23133137822151184},{0.12009630352258682,-0.36554020643234253,0.3487803041934967,-0.1509101241827011,-0.22087673842906952,0.09735801070928574,0.3470146954059601,0.2539404630661011},{-0.23232249915599823,-0.0812046080827713,-0.02849278785288334,-0.2627815902233124,0.14949831366539001,0.11641670018434525,0.382393479347229,0.27795884013175964},{-0.039082735776901245,0.18208925426006317,0.008708987385034561,-0.19059601426124573,0.34261181950569153,0.11156275123357773,0.14208248257637024,-0.17089124023914337},{0.014319442212581635,0.1437692642211914,0.1544589251279831,-0.14049915969371796,0.4335894286632538,-0.11279322952032089,0.17695194482803345,0.08475837856531143},{0.05353979393839836,-0.4730514883995056,-0.014694735407829285,-0.2159568965435028,0.29879873991012573,0.05195030942559242,-0.13963450491428375,-0.347778856754303},{-0.2564399838447571,0.15702563524246216,0.029145343229174614,-0.0619058758020401,0.048249803483486176,0.47957703471183777,0.41762495040893555,0.28063592314720154},{-0.00042793902684934437,-0.16601833701133728,-0.25769561529159546,0.28313398361206055,0.31308048963546753,0.33445870876312256,0.3779321312904358,-0.3352947235107422},{-0.1583193838596344,-0.3971445858478546,0.3639094829559326,0.1774328052997589,0.03106820024549961,-0.2672313451766968,0.03741408511996269,-0.3502644896507263},{0.24843266606330872,0.026840535923838615,0.4122188985347748,0.39964714646339417,-0.09723231941461563,0.3245534300804138,0.2025119513273239,-0.34443598985671997},{-0.3740573823451996,0.13822579383850098,-0.35591384768486023,0.4309624135494232,-0.01566900871694088,0.40391308069229126,-0.030504649505019188,0.24135281145572662},{-0.0534043163061142,0.1734839677810669,-0.11963611096143723,-0.11765208095312119,0.03525573015213013,0.15694591403007507,0.27320367097854614,-0.018168838694691658},{0.11245421320199966,-0.39894163608551025,-0.35644450783729553,-0.169356107711792,0.14365394413471222,-0.1359577178955078,0.10047685354948044,-0.1382017284631729},{-0.4831323027610779,-0.3871864080429077,-0.2962723970413208,-0.016066383570432663,-0.05154569447040558,0.23869304358959198,0.15410840511322021,-0.1596851646900177},{-0.18999022245407104,-0.35519275069236755,0.19370590150356293,-0.34980466961860657,-0.018859457224607468,0.022588960826396942,-0.4556156098842621,-0.3349321782588959},{0.06648964434862137,0.19930300116539001,0.10967003554105759,0.2164340615272522,-0.12787596881389618,0.30551838874816895,0.24250006675720215,-0.23700782656669617},{0.07540623098611832,-0.3568478226661682,-0.09840406477451324,-0.02468131296336651,-0.15090885758399963,-0.3682163953781128,0.0043723005801439285,-0.32388830184936523},{-0.013786026276648045,-0.010451034642755985,0.08918768912553787,-0.27367454767227173,0.03989113122224808,0.09801233559846878,0.04541971907019615,-0.16514582931995392},{0.1190260499715805,-0.11162038892507553,0.047123901546001434,-0.2303556650876999,-0.005741539876908064,-0.023729823529720306,-0.06556220352649689,-0.275921493768692},{-0.2926344573497772,0.16775302588939667,0.11857477575540543,-0.22131280601024628,-0.4685817360877991,-0.0017398990457877517,0.10074357688426971,-0.029197517782449722},{0.3111345171928406,0.11822125315666199,-0.4554961919784546,0.1342274248600006,-0.07450596988201141,0.21105104684829712,0.2019636631011963,0.24689753353595734},{0.046872034668922424,-0.09358209371566772,-0.06162896752357483,0.3186228275299072,-0.3394339382648468,-0.08722672611474991,-0.1957775503396988,-0.36504748463630676},{0.2366432398557663,0.08096108585596085,-0.5021018981933594,0.3198290467262268,-0.3191439211368561,-0.36780980229377747,-0.35092929005622864,0.13332079350948334},{0.07733903080224991,0.34666886925697327,-0.3433613181114197,-0.05256224796175957,0.07732478529214859,-0.2642793357372284,0.319781631231308,-0.3108988106250763},{-0.04781195521354675,0.05542755126953125,-0.17344772815704346,-0.12853479385375977,0.041282691061496735,-0.19418498873710632,-0.0868583396077156,-0.1513105183839798},{0.15501350164413452,-0.19717487692832947,-0.08369223028421402,-0.08141973614692688,0.009259677492082119,-0.0073849912732839584,-0.19781047105789185,0.08205371350049973},{0.35216256976127625,0.03415610268712044,-0.4104956388473511,-0.1701614409685135,-0.24843363463878632,0.09555484354496002,0.24488545954227448,0.06932187080383301},{0.41419777274131775,-0.3088788092136383,-0.05465591326355934,-0.016397442668676376,0.10913410782814026,-0.14316096901893616,0.2242860496044159,0.337724506855011},{-0.2033156454563141,-0.15754880011081696,0.025652000680565834,-0.21136325597763062,0.332587331533432,-0.27996981143951416,0.06146082282066345,0.10059884190559387},{0.25827479362487793,0.0334588997066021,-0.14266937971115112,0.3931998014450073,0.10910321027040482,-0.014653521589934826,-0.0036210562102496624,0.06101340800523758}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23208829760551453,0.3885355293750763,-0.599189043045044,-0.46111783385276794,-0.2509440779685974,0.08726608753204346,-0.406325101852417,0.5100993514060974},{-0.03535075858235359,0.572179913520813,-0.2074325531721115,0.4452912509441376,-0.02099240943789482,0.01213294267654419,-0.2499634176492691,0.022867538034915924},{-0.4609696865081787,-0.16792283952236176,-0.16698266565799713,-0.3081592619419098,0.5072880387306213,0.15442021191120148,-0.011118782684206963,0.45988771319389343},{-0.4406068027019501,-0.39385122060775757,0.26926693320274353,0.379098504781723,-0.504472017288208,-0.13360144197940826,0.3312842547893524,0.18410086631774902},{-0.23579968512058258,-0.31101468205451965,-0.26153087615966797,-0.23208367824554443,0.3150034546852112,-0.2408439964056015,0.42199835181236267,-0.37712088227272034},{-0.07081994414329529,0.1405496597290039,0.2884393334388733,-0.5053235292434692,0.5328200459480286,-0.2764233350753784,-0.42601945996284485,-0.31095126271247864},{-0.41261324286460876,0.1277097910642624,0.06457436829805374,-0.28946614265441895,-0.020505277439951897,-0.5122361183166504,0.5060111880302429,0.04960721731185913},{-0.39276209473609924,-0.2970344126224518,-0.22415791451931,-0.48871004581451416,-0.29901123046875,0.0437798872590065,0.44860368967056274,-0.28447774052619934}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.012964644469320774,-0.0449516735970974,-0.01323092170059681,0.03713781386613846,-0.02071940340101719,-0.03026963770389557,-0.09175843745470047,0.015977643430233};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.010648854076862335,-0.08210687339305878,-0.024658318608999252,0.1318041980266571,-0.024012863636016846,0.058857664465904236,-0.03410474956035614,0.022363580763339996};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

