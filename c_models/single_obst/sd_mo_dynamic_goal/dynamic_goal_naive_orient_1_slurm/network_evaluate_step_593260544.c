#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.28200197219848633,0.015123550780117512,-0.12961041927337646,0.3001912236213684,0.2669285833835602,-0.2117851972579956,-0.22180931270122528,0.11060353368520737,0.2807685136795044,-0.30433014035224915,0.5971323251724243,-0.021212143823504448,0.2846583425998688,0.11029047518968582,-0.43821805715560913,0.05203896388411522},{-0.23171335458755493,-0.2880154252052307,-0.31466567516326904,-0.17936398088932037,0.08699838072061539,0.25926393270492554,0.06433181464672089,0.05789583548903465,0.2283802032470703,0.18444280326366425,-0.16892950236797333,-0.08795749396085739,-0.17625486850738525,0.07335064560174942,0.32039111852645874,-0.3027273416519165},{0.14112237095832825,0.1945503205060959,0.1922406256198883,0.35540229082107544,-0.09779194742441177,-0.24384628236293793,0.46602821350097656,-0.05491463840007782,-0.020918836817145348,-0.11238805204629898,-0.05761988088488579,-0.010319419205188751,0.0678819790482521,0.4544317424297333,-0.271619588136673,-0.05923391878604889},{0.11037519574165344,-0.16525201499462128,-0.1365060657262802,-0.11747089773416519,0.043154917657375336,0.09383532404899597,0.07445527613162994,-0.20138145983219147,-0.1685844361782074,0.1754344403743744,0.5098471641540527,-0.2052430510520935,-0.17598338425159454,-0.15200275182724,0.18078605830669403,0.12538111209869385},{-0.3325273394584656,0.04664839804172516,0.14417429268360138,-0.2081359624862671,0.26228296756744385,0.28168395161628723,0.14765019714832306,-0.19632987678050995,-0.13603858649730682,0.1529364436864853,-0.14509478211402893,-0.3788977861404419,-0.03211730346083641,-0.15310190618038177,0.30178356170654297,-0.041340988129377365},{-0.0037401122972369194,-0.03573523834347725,-0.02097362093627453,-0.01812855154275894,0.09469137340784073,-0.10145778954029083,0.4154570400714874,-0.3411852717399597,-0.13427504897117615,-0.1578957885503769,0.29750242829322815,0.02797095663845539,0.21497489511966705,0.08430537581443787,0.2568162679672241,0.2894101142883301},{-0.1792154610157013,0.17368923127651215,-0.056510474532842636,0.0807613655924797,-0.2182292938232422,-0.08860577642917633,-0.16806289553642273,-0.02159103937447071,0.1472652405500412,0.3496919572353363,-0.21779854595661163,-0.08472936600446701,0.22658787667751312,0.06652186810970306,-0.1803925484418869,0.3026987910270691},{-0.12241461127996445,0.00406285747885704,-0.1557261198759079,-0.19141532480716705,0.3840610086917877,-0.2872903347015381,-0.2858966886997223,-0.42461684346199036,-0.056688133627176285,-0.22061356902122498,0.4011508822441101,-0.0490429550409317,0.2031400501728058,0.12866178154945374,-0.17369785904884338,0.4174126982688904},{0.24086470901966095,0.07385095953941345,-0.005983158014714718,0.0991002768278122,-0.40807318687438965,-0.42841458320617676,0.34852561354637146,-0.2800346612930298,-0.12080372869968414,0.2351399064064026,0.17179517447948456,-0.29280611872673035,-0.14864657819271088,0.024610240012407303,0.17549990117549896,-0.02671121060848236},{0.45573464035987854,-0.5185210108757019,-0.07255922257900238,-0.022454166784882545,0.24210380017757416,-0.1216476783156395,-0.2531503736972809,-0.1147160604596138,-0.18597671389579773,0.011367068625986576,-0.02703053504228592,-0.20190134644508362,0.36540132761001587,-0.08264852315187454,-0.5300548076629639,-0.14809148013591766},{0.27042385935783386,0.17506331205368042,-0.33001208305358887,0.08083070814609528,0.017407434061169624,-0.16661284863948822,-0.12760545313358307,0.15965493023395538,-0.14891409873962402,0.1508927345275879,0.18198376893997192,0.2342340648174286,-0.07804238051176071,0.22955791652202606,-0.04175092652440071,-0.2550079822540283},{-0.439362496137619,0.2706570625305176,0.22309553623199463,-0.2792184054851532,-0.27585235238075256,0.3387426733970642,0.05185616388916969,0.33180731534957886,0.21676573157310486,0.12605255842208862,0.24077476561069489,-0.12690946459770203,0.176803857088089,-0.06710993498563766,-0.08439253270626068,-0.15899328887462616},{0.09019017964601517,-0.23754554986953735,-0.21744702756404877,0.1779232919216156,-0.2356099635362625,-0.2577725052833557,-0.14193157851696014,0.2350192368030548,0.30619728565216064,-0.1688133329153061,-0.08355870097875595,0.03578728437423706,0.2752920389175415,0.13161829113960266,-0.17764544486999512,0.2943517565727234},{0.28048768639564514,0.20051056146621704,-0.1341901421546936,-0.11015192419290543,0.08583755046129227,-0.10708939284086227,-0.11809848994016647,0.3147665858268738,-0.21878404915332794,-0.17414842545986176,-0.1503841131925583,0.032760899513959885,-0.21364939212799072,-0.10489200055599213,-0.225080206990242,-0.026195669546723366},{0.17544615268707275,0.38152024149894714,0.3899417817592621,-0.3687073588371277,-0.36442336440086365,0.11039745062589645,0.03461840748786926,-0.15684504806995392,0.3763294517993927,0.3768172264099121,-0.1467345952987671,0.11406414955854416,-0.07671423256397247,-0.31256675720214844,0.03872500732541084,-0.1185653805732727},{-0.1821221113204956,-0.1974392682313919,-0.13260969519615173,0.438131719827652,-0.2290625423192978,-0.19488099217414856,-0.21878863871097565,-0.29909747838974,-0.5429143905639648,-0.24963654577732086,0.3392654061317444,0.2768533229827881,-0.6014626622200012,-0.36256396770477295,-0.6313433051109314,-0.17339904606342316},{-0.45580628514289856,0.18750569224357605,-0.3539639711380005,-0.174260675907135,-0.4411345422267914,0.1684330850839615,0.4816875159740448,0.08933428674936295,0.40603700280189514,-0.49021926522254944,0.22915582358837128,-0.35306093096733093,-0.20111720263957977,0.04433482140302658,-0.17756956815719604,-0.23274295032024384},{0.3408365845680237,-0.587565541267395,0.3049563467502594,0.23656930029392242,-0.10129685699939728,0.4843083322048187,0.2541870176792145,0.27503859996795654,-0.055291078984737396,-0.23596517741680145,-0.1315491795539856,-0.15996573865413666,-0.11488460749387741,-0.5498207807540894,0.24881227314472198,-0.10354065895080566}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.052679043263196945,0.31038904190063477,0.22650881111621857,-0.1370028555393219,-0.18143711984157562,0.03751607984304428,-0.014420708641409874,0.2524767816066742,-0.08811651170253754,0.3120194375514984,0.4686296880245209,-0.3850679397583008,0.034220606088638306,0.048658572137355804,0.0022853692062199116,-0.10656917840242386},{-0.39832156896591187,0.1908741146326065,-0.1846025288105011,0.3286885917186737,0.27360987663269043,-0.1449877768754959,-0.3148445785045624,-0.15415139496326447,0.3652283847332001,0.2665739357471466,-0.06375148147344589,0.22953256964683533,-0.40683692693710327,0.18058274686336517,-0.21913208067417145,0.44088834524154663},{-0.26629897952079773,0.110682412981987,-0.30496472120285034,0.16781556606292725,-0.46280622482299805,-0.23603934049606323,0.046294260770082474,0.14219526946544647,-0.19699254631996155,0.37072518467903137,0.22066305577754974,-0.13173803687095642,0.15313111245632172,-0.26179859042167664,-0.12192997336387634,-0.044362884014844894},{0.29740336537361145,-0.2095094919204712,0.10989940911531448,0.3940611183643341,-0.40675029158592224,-0.313657283782959,0.2864462435245514,0.03603944554924965,0.28365352749824524,-0.09184736758470535,0.33746010065078735,0.07606001198291779,-0.19222155213356018,0.025753164663910866,-0.007987345568835735,-0.43050840497016907},{-0.40986156463623047,-0.0670824646949768,0.1541643589735031,-0.26054051518440247,0.15963764488697052,0.3713163733482361,-0.2901127338409424,0.28137168288230896,-0.2336413860321045,0.20665276050567627,0.0019061019411310554,0.02584151178598404,-0.2661167085170746,-0.025261670351028442,-0.2875596284866333,-0.11582911014556885},{0.05142879858613014,-0.3097821772098541,-0.009619932621717453,-0.3536330759525299,0.21752607822418213,0.045370377600193024,-0.14370901882648468,-0.0623820424079895,-0.14960581064224243,0.38146570324897766,0.19453758001327515,0.013102401047945023,-0.299159437417984,0.08080210536718369,0.009961217641830444,-0.28915420174598694},{0.29047486186027527,-0.19827191531658173,0.34057703614234924,-0.2077966183423996,-0.4265730679035187,0.00843898393213749,-0.35038554668426514,0.34102585911750793,-0.10455651581287384,-0.24471262097358704,-0.27218618988990784,-0.017323490232229233,-0.074644073843956,-0.08833111077547073,0.49956440925598145,-0.38293102383613586},{-0.33515873551368713,0.35010823607444763,-0.08764979243278503,0.1700102835893631,-0.08192108571529388,-0.2202386111021042,-0.24291865527629852,0.07550935447216034,-0.00827362947165966,0.4894864857196808,0.13405725359916687,-0.11858776956796646,0.06776617467403412,-0.23993831872940063,0.10200436413288116,0.15608307719230652},{0.11874780803918839,0.288534939289093,-0.19476951658725739,-0.32092106342315674,0.3346935212612152,-0.19424819946289062,0.17768798768520355,-0.2919367551803589,0.05442366003990173,0.03634313866496086,0.10016429424285889,0.11171739548444748,0.03145327419042587,-0.38036078214645386,-0.06943383067846298,0.2071174681186676},{-0.19417650997638702,0.02954404428601265,-0.2843538522720337,-0.3400224447250366,0.21371692419052124,-0.3842989504337311,-0.11181640625,0.30840930342674255,-0.17381930351257324,0.14172133803367615,-0.04253179207444191,-0.11676538735628128,-0.36334913969039917,0.1132165789604187,-0.23091495037078857,-0.3306535482406616},{-0.15128633379936218,-0.16511984169483185,0.008027064613997936,-0.24836786091327667,-0.3205534815788269,-0.021592389792203903,0.13972602784633636,-0.34616127610206604,0.048471562564373016,-0.08339808881282806,0.2758053243160248,-0.0622524693608284,0.2584983706474304,0.1569960117340088,0.2187996804714203,0.2588562071323395},{-0.1077091246843338,-0.0267508402466774,-0.3629230856895447,0.3106176555156708,0.0934419333934784,0.16398993134498596,0.20354679226875305,0.1776053011417389,-0.43146297335624695,0.19644483923912048,-0.32181495428085327,-0.2299521565437317,-0.34238049387931824,0.35566410422325134,-0.3318421244621277,0.0829814150929451},{-0.20876793563365936,-0.469472199678421,-0.09895212203264236,0.14942479133605957,-0.22558678686618805,-0.044923558831214905,-0.11221037805080414,0.388165146112442,0.46237313747406006,0.1406431496143341,0.0015261736698448658,-0.17525166273117065,0.14890001714229584,-0.4110819399356842,0.09056533128023148,-0.17753323912620544},{-0.23763127624988556,-0.45484697818756104,-0.1396418809890747,-0.14020034670829773,-0.4957219660282135,0.5092494487762451,-0.15523368120193481,0.19955165684223175,-0.135550394654274,-0.24371089041233063,-0.3138067126274109,0.412826806306839,-0.15291035175323486,-0.04365123435854912,-0.21313026547431946,0.3309086263179779},{-0.31389790773391724,0.357565313577652,-0.23450103402137756,0.13340263068675995,-0.3669198155403137,0.16736820340156555,-0.014150517992675304,-0.32145264744758606,0.10201473534107208,0.21317562460899353,-0.26729142665863037,0.06408342719078064,0.24097269773483276,-0.32608985900878906,-0.3414715528488159,-0.16951096057891846},{-0.1302943229675293,-0.2696317434310913,-0.42617762088775635,0.22527237236499786,0.14052776992321014,0.03506636619567871,-0.23346415162086487,0.1651587039232254,-0.3424558937549591,-0.2534880042076111,-0.30862897634506226,0.2056795358657837,-0.18432050943374634,0.13417759537696838,0.042780812829732895,0.294223815202713}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10205674171447754,-0.048939138650894165,0.18208563327789307,-0.1388937383890152,-0.08323761075735092,0.10848429054021835,0.22186027467250824,-0.19833239912986755,-0.2174621820449829,0.2726806104183197,0.1383763998746872,0.11627933382987976,0.08470792323350906,0.17200952768325806,-0.1497071534395218,0.16228267550468445,0.12557066977024078,-0.3344416618347168,-0.16396722197532654,-0.06067592650651932,-0.1330805867910385,0.0800287202000618,-0.18582698702812195,0.2665524184703827,-0.10551716387271881,-0.06154806166887283,0.1092785969376564,0.20562736690044403,-0.21521450579166412,-0.13413549959659576,0.17461815476417542,0.2673034965991974},{0.22685524821281433,-0.05811018496751785,0.13524234294891357,-0.11103139817714691,-0.1350209265947342,0.24944761395454407,-0.012606593780219555,-0.0698866993188858,-0.042531244456768036,0.00600091926753521,-0.1368597149848938,0.012542017735540867,0.3996666371822357,0.18241125345230103,0.12451258301734924,0.07038290798664093,-0.23981888592243195,-0.3599492013454437,0.07646948844194412,0.05582895129919052,0.0571284219622612,0.2980894446372986,0.2091967612504959,-0.23453567922115326,0.05188664048910141,0.26342371106147766,-0.28782981634140015,0.17971171438694,0.10226716101169586,-0.23656359314918518,-0.044765155762434006,-0.00966410432010889},{-0.09334301203489304,-0.05566268786787987,0.27406948804855347,-0.23912867903709412,-0.16756406426429749,0.05161012336611748,-0.12386007606983185,0.2600369155406952,0.11495369672775269,-0.0005674621788784862,-0.16313275694847107,-0.020107584074139595,0.23549465835094452,-0.22728432714939117,0.09298036247491837,-0.03506368026137352,-0.310391366481781,0.26982444524765015,-0.24607156217098236,-0.04295403137803078,0.014297712594270706,-0.14785178005695343,-0.04667629674077034,-0.10745953023433685,-0.029938673600554466,0.2909369170665741,-0.062254153192043304,0.09551502764225006,0.2677251100540161,-0.24556384980678558,-0.20459085702896118,-0.027727337554097176},{0.14290282130241394,-0.13243131339550018,0.062438033521175385,-0.3445908725261688,0.1254304200410843,-0.14690200984477997,-0.07322648167610168,0.2768658697605133,0.02401769533753395,0.14145393669605255,0.144695445895195,-0.09156098961830139,-0.20759347081184387,-0.09572994709014893,0.29698535799980164,-0.23381398618221283,0.03395931422710419,-0.1306118220090866,-0.13079485297203064,0.0831025168299675,-0.10504117608070374,0.04877963289618492,-0.21180498600006104,0.23074820637702942,-0.26732614636421204,0.09737680107355118,-0.07798752933740616,-0.18576769530773163,0.06998893618583679,0.0059591298922896385,0.248477965593338,-0.11280357837677002},{0.21821008622646332,0.01802195981144905,0.038398873060941696,0.2648453116416931,-0.2484348565340042,-0.08102557808160782,0.20644669234752655,-0.04805600643157959,0.10909819602966309,-0.19573314487934113,0.0046506538055837154,-0.08253799378871918,-0.14853057265281677,-0.16378189623355865,0.27546456456184387,0.30993959307670593,-0.07397698611021042,-0.3452863395214081,0.17386354506015778,-0.11229817569255829,-0.11551979184150696,0.2074224203824997,0.2730300724506378,0.04362495243549347,-0.06333262473344803,-0.09191473573446274,-0.01911289617419243,0.2670731544494629,0.26651349663734436,0.12744344770908356,0.08260437846183777,-0.2528642416000366},{0.3205181360244751,-0.1509927362203598,0.024713395163416862,0.09200124442577362,-0.14110000431537628,-0.3221617043018341,-0.2054060399532318,-0.30409592390060425,-0.21158038079738617,0.02288568578660488,-0.038662850856781006,-0.023110419511795044,-0.16515928506851196,-0.05540113523602486,-0.21670033037662506,-0.22724005579948425,0.1780470609664917,-0.003881039097905159,-0.30351459980010986,0.15695589780807495,-0.04635719209909439,-0.2268240600824356,0.18373002111911774,-0.17143501341342926,-0.14111417531967163,-0.2307993471622467,-0.09602493792772293,0.14691172540187836,0.11114981770515442,0.2687739133834839,-0.23974403738975525,0.1876116842031479},{0.16222992539405823,0.07450095564126968,0.26101815700531006,-0.18299321830272675,0.22541484236717224,-0.20557165145874023,-0.24459755420684814,0.05094793066382408,0.27859437465667725,0.12486276030540466,-0.10621409118175507,0.09371982514858246,0.06216349080204964,0.361097127199173,0.11908628791570663,-0.11880216002464294,-0.18992353975772858,0.15167592465877533,0.014897055923938751,0.02627621963620186,-0.06263189762830734,0.21990731358528137,0.16315384209156036,0.16735538840293884,-0.22100883722305298,-0.25602951645851135,-0.25638890266418457,-0.37789350748062134,0.02706298604607582,-0.10213752090930939,0.22594228386878967,0.154621422290802},{0.2893610894680023,-0.30314409732818604,0.11495885998010635,-0.37227633595466614,-0.3348570466041565,0.2582576870918274,0.3635803163051605,0.13387084007263184,-0.09737635403871536,0.00877412874251604,0.22468651831150055,-0.12438317388296127,0.14123643934726715,0.3246054947376251,-0.024169787764549255,0.19417804479599,0.3691486418247223,-0.19440241158008575,-0.05062790960073471,-0.30774980783462524,0.15068472921848297,0.2118927240371704,0.23875749111175537,0.11190267652273178,0.10848145186901093,0.12008108198642731,0.126856729388237,0.27430447936058044,-0.20567870140075684,-0.24689851701259613,0.2515053451061249,-0.042226165533065796},{0.0074556926265358925,-0.07676719129085541,0.2649522125720978,0.21990130841732025,-0.1710127890110016,-0.3079313039779663,-0.056187428534030914,0.27157774567604065,-0.19279611110687256,-0.2719827890396118,0.09068931639194489,0.10251153260469437,0.11408583074808121,-0.2781963646411896,0.12454540282487869,-0.18113534152507782,-0.15888246893882751,0.1788986176252365,-0.22515134513378143,0.3308204114437103,-0.28761234879493713,-0.334174245595932,-0.2858392596244812,0.2966155707836151,0.10946007817983627,0.1092655137181282,0.24948889017105103,0.17223697900772095,-0.1609145849943161,-0.27069854736328125,-0.17002327740192413,0.15442444384098053},{0.29801321029663086,-0.019403211772441864,-0.03886177018284798,0.16566099226474762,0.01972692646086216,0.23968850076198578,-0.017864888533949852,0.2804099917411804,-0.017753226682543755,0.07691998779773712,0.17187322676181793,0.05764533579349518,-0.17412801086902618,-0.37568455934524536,0.10192105919122696,0.13744211196899414,0.10589978098869324,-0.1354757696390152,-0.06664925068616867,-0.06373145431280136,0.13030192255973816,-0.30703943967819214,0.25016260147094727,0.05778858810663223,-0.029930295422673225,0.12849180400371552,-0.2878630459308624,-0.22230464220046997,-0.015796808525919914,0.0026561131235212088,0.13952289521694183,0.219711035490036},{-0.12853991985321045,0.09111978113651276,-0.11259688436985016,0.15688909590244293,-0.1209930032491684,0.27203381061553955,0.12864845991134644,-0.007477177307009697,0.2902039587497711,-0.3032691478729248,-0.1387026160955429,0.15477651357650757,-0.17706528306007385,0.045405078679323196,-0.3108159303665161,-0.04239897057414055,0.11183923482894897,0.1674889177083969,0.07250609248876572,-0.14509402215480804,-0.2161092609167099,0.19756703078746796,0.18490257859230042,0.18474537134170532,-0.267304927110672,0.3617408275604248,-0.09073770046234131,-0.027200210839509964,-0.118787981569767,0.13276775181293488,0.214988112449646,0.28136247396469116},{-0.2012423574924469,0.3045515716075897,-0.056629255414009094,0.008268543519079685,-0.19536660611629486,-0.17615965008735657,0.13026323914527893,-0.33331534266471863,-0.0410994291305542,-0.2664104402065277,-0.21202273666858673,-0.038155850023031235,0.19375310838222504,-0.2507953941822052,-0.12349389493465424,-0.2800769507884979,-0.19222140312194824,-0.05537457391619682,0.3021072745323181,-0.2763707637786865,0.08521007001399994,-0.1902415156364441,0.06104753538966179,0.30539366602897644,-0.1523813009262085,0.17905834317207336,0.22308610379695892,-0.08901924639940262,-0.023128187283873558,0.30404433608055115,-0.1480700969696045,-0.2765793204307556},{-0.04656827449798584,0.19009551405906677,0.2191462367773056,-0.27165931463241577,0.26657286286354065,0.0017055952921509743,-0.13342131674289703,-0.025251884013414383,0.14717483520507812,-0.2862476110458374,-0.0689258873462677,0.02657446265220642,0.1624225229024887,0.03955209255218506,0.048906899988651276,-0.08879703283309937,0.22426384687423706,-0.2511219084262848,0.33858659863471985,0.08429624140262604,-0.17178452014923096,0.2290930449962616,-0.13053064048290253,-0.19983132183551788,0.25564947724342346,-0.1139480322599411,0.029714802280068398,-0.15706513822078705,0.04696271941065788,-0.13853983581066132,0.2676074802875519,0.22545573115348816},{0.05619509518146515,-0.176492378115654,-0.19098396599292755,0.05861808732151985,-0.005496326368302107,0.28696608543395996,-0.10602670162916183,-0.2834237515926361,0.3048454523086548,0.019334150478243828,0.052708614617586136,0.07527144998311996,-0.1404944211244583,0.13582001626491547,-0.2206362783908844,-0.30770060420036316,0.014340676367282867,-0.01979704201221466,0.18274366855621338,0.4024032950401306,-0.2200050950050354,0.11324140429496765,-0.1382184624671936,0.027563661336898804,0.14639313519001007,-0.31303101778030396,-0.15595947206020355,-0.2584024965763092,-0.10459381341934204,-0.19453778862953186,0.1610337644815445,-0.34579116106033325},{-0.10747486352920532,0.3273252248764038,0.12450271099805832,-0.1952284574508667,-0.11322180926799774,-0.2170247584581375,0.16270408034324646,-0.05690086632966995,0.224532812833786,-0.050176966935396194,0.2153894156217575,0.1868901401758194,-0.032141610980033875,0.05556727573275566,-0.12558318674564362,0.16417549550533295,-0.18874752521514893,-0.36950987577438354,-0.24795758724212646,0.11117329448461533,0.14725765585899353,-0.22854681313037872,-0.32776445150375366,-0.25278791785240173,-0.1589375138282776,0.09533605724573135,0.35005608201026917,-0.00574132613837719,-0.07775573432445526,0.08838216960430145,-0.13473457098007202,0.09049465507268906},{-0.22421173751354218,-0.17941749095916748,-0.1920408010482788,0.01705065369606018,-0.22853824496269226,-0.11766009777784348,-0.04477253928780556,-0.03501424938440323,-0.30172404646873474,-0.2470753788948059,0.201092928647995,0.14550623297691345,-0.30876174569129944,0.2408585101366043,-0.06315221637487411,0.15903639793395996,0.1004057377576828,0.02905186079442501,0.04831594228744507,0.1369578242301941,0.23774109780788422,0.2458108812570572,0.13089574873447418,0.26568350195884705,0.09798543900251389,-0.21821282804012299,-0.17785349488258362,0.2432231903076172,-0.025344204157590866,-0.17999006807804108,-0.1718009114265442,-0.13708233833312988},{-0.28787922859191895,-0.21396082639694214,-0.34188205003738403,0.05442219600081444,-0.10675208270549774,-0.0634189248085022,-0.09194327145814896,0.13227808475494385,-0.08565700054168701,0.07837899774312973,-0.1974477618932724,0.005457740742713213,0.14650875329971313,-0.11209027469158173,0.0410936139523983,0.19124196469783783,-0.09665823727846146,-0.1171882376074791,0.17013001441955566,0.03344864025712013,0.21249091625213623,-0.03920083865523338,-0.2209968864917755,0.058524418622255325,0.19580911099910736,-0.25267669558525085,0.16664816439151764,0.05494149774312973,0.07813183963298798,-0.13730654120445251,0.21970953047275543,-0.05912398174405098},{0.2581026256084442,0.0029682957101613283,0.03195023909211159,0.18563048541545868,-0.3404349684715271,-0.04039907827973366,0.06430627405643463,0.1586054563522339,-0.07024376094341278,-0.13794559240341187,0.2952187657356262,-0.09347371757030487,0.06739721447229385,-0.04706384986639023,-0.11239948868751526,0.279053270816803,-0.06472977250814438,-0.13100966811180115,0.10470275580883026,-0.2952430844306946,-0.04814005643129349,-0.2585253417491913,-0.1920812577009201,0.22050492465496063,-0.06718947738409042,-0.04428332671523094,0.13491788506507874,0.05699102208018303,-0.1620236039161682,-0.07333868741989136,-0.02937443181872368,-0.07469522953033447},{0.2960609197616577,-0.06582903861999512,0.06331336498260498,0.0584329329431057,-0.028371507301926613,-0.08555728197097778,0.1989324688911438,-0.23324646055698395,0.25724726915359497,0.2880147099494934,0.03999658674001694,0.139494389295578,0.22589083015918732,0.3199772834777832,-0.2937749922275543,-0.3605230450630188,-0.2329949140548706,0.0780375674366951,-0.1718946248292923,-0.34103405475616455,-0.15236634016036987,0.24098196625709534,0.054735541343688965,0.15357552468776703,-0.14735360443592072,-0.11702965199947357,-0.1272435337305069,-0.238841250538826,0.2546263635158539,0.19011665880680084,-0.33103567361831665,-0.13151252269744873},{-0.10122481733560562,0.15530797839164734,0.28014278411865234,-0.030811186879873276,-0.02050873637199402,0.08850438892841339,-0.016374025493860245,-0.32761794328689575,0.18181778490543365,0.25474071502685547,0.16293054819107056,0.21977637708187103,-0.2373492270708084,0.17623567581176758,-0.2480747252702713,0.3008420467376709,0.16615498065948486,-0.2582399547100067,0.2505749464035034,0.06456669420003891,-0.3455515503883362,0.30863696336746216,-0.24183592200279236,0.15991400182247162,0.19800910353660583,0.25856178998947144,0.04946916550397873,0.13710585236549377,-0.1655855029821396,0.24886736273765564,-0.05101887881755829,0.10614003241062164},{-0.12852753698825836,-0.10305946320295334,0.024740660563111305,0.18939745426177979,0.026694435626268387,0.22709901630878448,-0.260172575712204,-0.11348643153905869,-0.16803911328315735,-0.08447801321744919,-0.12277193367481232,-0.19241298735141754,0.006607077084481716,-0.20398806035518646,0.10403189063072205,-0.2020360380411148,0.2423972189426422,-0.021973811089992523,-0.28945624828338623,-0.2999911308288574,0.13513873517513275,0.15160632133483887,-0.15595051646232605,0.3360086679458618,-0.26586928963661194,0.04005547612905502,0.09172723442316055,-0.09944002330303192,0.16413752734661102,-0.19569021463394165,0.28467243909835815,0.12085934728384018},{0.30176663398742676,0.05956495925784111,0.0579533651471138,0.22629743814468384,-0.23660427331924438,0.1630544364452362,-0.08326475322246552,0.1548973023891449,0.11126326769590378,0.016278816387057304,0.10430987179279327,-0.310820609331131,-0.26094233989715576,0.04441964253783226,0.07142826914787292,-0.08509627729654312,0.2726099491119385,0.1454441249370575,-0.1867721527814865,-0.21760715544223785,0.3459048569202423,0.1845720261335373,0.23362505435943604,0.08402915298938751,-0.0015190686099231243,0.061732638627290726,-0.05283883586525917,-0.16569630801677704,0.2632504105567932,0.013038729317486286,-0.18235032260417938,0.11092852056026459},{-0.01959848403930664,0.021803569048643112,-0.03432092070579529,-0.26350137591362,-0.09530923515558243,-0.23036307096481323,-0.21941986680030823,-0.146316796541214,-0.03364604711532593,-0.022270778194069862,-0.24360717833042145,0.02374487929046154,-0.23924121260643005,-0.16287770867347717,0.012683085165917873,0.09826647490262985,0.26707226037979126,-0.1740056723356247,-0.32621029019355774,0.2592771351337433,-0.1774197220802307,0.254008412361145,0.034976109862327576,-0.03842872008681297,0.008728870190680027,0.1653413027524948,-0.07678689062595367,-0.26130273938179016,0.2199053317308426,0.2553158700466156,-0.12457292526960373,0.1804213970899582},{-0.2401232123374939,-0.029163042083382607,0.040758758783340454,-0.029193861410021782,0.09537684172391891,0.12796486914157867,-0.188823863863945,0.11241581290960312,-0.15913638472557068,-0.1407708376646042,0.06875021755695343,-0.140314981341362,-0.19378744065761566,0.25923749804496765,0.008088412694633007,0.03822485730051994,0.1941075176000595,-0.2551155984401703,-0.1644170880317688,0.3067858815193176,0.028726523742079735,0.26421162486076355,-0.06083692982792854,0.021759429946541786,-0.24329110980033875,-0.18532738089561462,0.0030274384189397097,0.294343501329422,-0.012629383243620396,0.0037957874592393637,0.29921701550483704,0.30164065957069397}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.1323746293783188,0.13753581047058105,0.30312380194664,-0.01199091225862503},{0.08428951352834702,-0.05284164473414421,0.053856708109378815,0.1619918942451477},{-0.1521611213684082,0.18762211501598358,0.10843907296657562,0.14650732278823853},{0.3215598464012146,0.0280333049595356,0.06059744209051132,0.39427322149276733},{-0.10124810039997101,0.07816863059997559,0.2745975852012634,-0.02279663272202015},{-0.1267949789762497,0.21198317408561707,0.20106717944145203,-0.07225783914327621},{-0.2277398556470871,-0.004039198160171509,0.0007892317371442914,-0.11303242295980453},{-0.3529318571090698,-0.1292741745710373,0.33461689949035645,-0.28345853090286255},{0.3080874979496002,-0.17685475945472717,-0.26935678720474243,-0.3586908280849457},{0.0524112731218338,0.2599570155143738,0.32197433710098267,-0.40076905488967896},{-0.13696467876434326,-0.15433770418167114,-0.19063511490821838,0.1901046484708786},{0.2751287519931793,-0.1644485592842102,0.020192686468362808,0.17383350431919098},{0.29156142473220825,0.28566303849220276,-0.06608079373836517,0.09262653440237045},{0.005295274779200554,0.06506837159395218,-0.28405869007110596,0.02209051139652729},{0.12075711786746979,0.2794381380081177,0.3205438256263733,0.3170810341835022},{0.14825917780399323,0.05468278005719185,0.26205432415008545,0.23673896491527557},{-0.20813027024269104,-0.09934425354003906,-0.13898998498916626,-0.18562594056129456},{-0.17826983332633972,0.10862252116203308,-0.13409419357776642,-0.13087621331214905},{-0.15703924000263214,0.18124040961265564,0.154813751578331,0.2615192234516144},{-0.03168950974941254,0.3307090103626251,-0.17186544835567474,0.06434860825538635},{-0.23436316847801208,-0.35083460807800293,-0.1332206428050995,0.006467828061431646},{0.28164201974868774,0.39472833275794983,0.028661921620368958,-0.2298622727394104},{-0.010685197077691555,0.15392154455184937,0.1699567288160324,0.14368389546871185},{-0.09675904363393784,0.36440256237983704,-0.06290822476148605,-0.13065007328987122},{0.030577775090932846,-0.02072172611951828,-0.06093297526240349,-0.016522224992513657},{0.2646481990814209,-0.3675902187824249,-0.03164657950401306,0.041933976113796234},{-0.00011583950981730595,-0.306757390499115,-0.17882733047008514,-0.22625021636486053},{0.09884048253297806,-0.091453917324543,0.21907758712768555,0.1219225600361824},{-0.0008526313467882574,-0.058247681707143784,0.07136274874210358,0.023115722462534904},{-0.3163468837738037,0.3412322998046875,0.2284214347600937,-0.09293291717767715},{0.3028309643268585,-0.1432722508907318,0.17115963995456696,-0.02127724699676037},{0.041227325797080994,-0.3192930817604065,0.3542695641517639,-0.25342994928359985}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.03615492582321167,-0.020571961998939514,0.02061028778553009,-0.03445615991950035,-0.04163729026913643,-0.1674124002456665,0.020197248086333275,0.04223344847559929,0.006348153576254845,-0.09026981145143509,0.11929143220186234,0.07348261773586273,-0.008135601878166199,-0.03149515390396118,0.08035234361886978,-0.017437169328331947};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0727379322052002,0.03879968822002411,0.0411892868578434,0.033613014966249466,0.046306561678647995,0.011953014880418777,0.05622680112719536,-0.0043008285574615,0.0005888806190341711,5.87782551519922e-06,-0.050883639603853226,-0.02593349851667881,0.047820501029491425,-0.024594029411673546,-0.034067582339048386,-0.013694367371499538};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07055051624774933,0.05883153900504112,0.018056588247418404,0.06201058626174927,0.04265925660729408,-0.026396414265036583,-0.042852818965911865,-0.011764774098992348,-0.02869168482720852,-0.0019598184153437614,-0.04393695667386055,0.05339522287249565,0.0544104166328907,-0.062400199472904205,0.07237056642770767,0.07042916864156723,-0.06613460928201675,-0.057424429804086685,0.0054316893219947815,0.014358939602971077,-0.03663365915417671,0.0033883415162563324,0.056817833334207535,0.010388504713773727,-0.020033154636621475,0.004586644005030394,-0.03443470597267151,0.049798160791397095,0.03157292306423187,-0.003375798463821411,0.02687499113380909,0.02920529432594776};
static const float action_parameterization_distribution_linear_bias[4] = {0.046482738107442856,0.00798778422176838,0.050085894763469696,0.04572055861353874};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.006918333005160093,0.242141455411911,-0.09449900686740875,0.15500332415103912,0.26780393719673157,0.17622971534729004,0.26614245772361755,0.016642915084958076},{-0.18315528333187103,-0.1028015986084938,-0.2258705496788025,-0.27896615862846375,-0.2735440135002136,-0.1398213505744934,-0.18596020340919495,-0.15163761377334595},{-0.2811596691608429,0.010538418777287006,0.24071574211120605,0.2004873901605606,0.22440436482429504,0.0006116374861449003,0.18850630521774292,-0.08451379090547562},{-0.03207702562212944,0.07684492319822311,-0.17569515109062195,-0.012336385436356068,-0.023824186995625496,-0.06602983921766281,0.19611303508281708,-0.14192238450050354},{-0.2954503893852234,-0.13535676896572113,-0.23705001175403595,-0.16086019575595856,-0.06467907130718231,0.18856851756572723,0.14496982097625732,-0.001996238250285387},{-0.3266730308532715,0.013293259777128696,0.3191526532173157,0.2566816806793213,0.16021597385406494,-0.05723318085074425,-0.11065863072872162,-0.09847763180732727},{-0.20860756933689117,0.0857735350728035,0.33040598034858704,-0.18044576048851013,-0.11157410591840744,-0.351899653673172,-0.08191683143377304,-0.13785789906978607},{-0.4460389316082001,-0.35616374015808105,0.516765296459198,-0.027972597628831863,-0.2435779869556427,0.17785023152828217,0.1711915135383606,-0.16896718740463257},{-0.2888394892215729,0.24025428295135498,-0.1573527604341507,0.4369606077671051,0.092550128698349,-0.401553213596344,0.07984140515327454,0.11615957319736481},{-0.27079638838768005,-0.3409202992916107,-0.15447071194648743,-0.13528580963611603,-0.47633764147758484,0.030270416289567947,-0.022164292633533478,0.1370880901813507},{0.17883248627185822,0.31981319189071655,0.19669294357299805,-0.004982418846338987,0.22346694767475128,0.03511595353484154,-0.25906193256378174,0.23785050213336945},{0.22497469186782837,0.005236857570707798,0.2515764832496643,0.2614394426345825,-0.1787237972021103,0.2628881335258484,-0.0018361336551606655,-0.22211700677871704},{0.12552979588508606,-0.2414034605026245,0.23283503949642181,-0.019329288974404335,-0.1670004278421402,-0.03894564509391785,-0.12226693332195282,-0.19404490292072296},{-0.203946053981781,-0.0781485065817833,0.3237735629081726,0.39450401067733765,-0.05075403302907944,-0.026725074276328087,-0.22841282188892365,0.06996140629053116},{-0.026913467794656754,-0.12765899300575256,0.08959195762872696,-0.18161824345588684,-0.3182469308376312,-0.1309095174074173,0.21107840538024902,-0.06224852427840233},{0.022452596575021744,-0.03080810233950615,-0.03010786697268486,-0.31145986914634705,-0.10350312292575836,0.05785946175456047,-0.04257924109697342,0.36917179822921753},{-0.02259226329624653,-0.19389404356479645,-0.22831524908542633,0.0339837521314621,-0.15902754664421082,-0.09989065676927567,-0.10103966295719147,0.03032941371202469},{-0.18690736591815948,-0.2400204837322235,0.04233970865607262,0.002017793245613575,0.12334505468606949,-0.19109511375427246,0.37755605578422546,0.11878044903278351},{0.03410857543349266,0.13824419677257538,-0.26998770236968994,0.11067158728837967,0.10274187475442886,0.1281685084104538,-0.1723552644252777,0.27170035243034363},{0.16744159162044525,-0.06306596845388412,-0.3864579200744629,0.07090956717729568,-0.09304975718259811,-0.11202756315469742,-0.25846877694129944,-0.019553303718566895},{0.0588163323700428,-0.1708974838256836,0.026963815093040466,-0.13339915871620178,0.24025072157382965,-0.10140221565961838,-0.040008753538131714,0.4353286921977997},{-0.009553223848342896,0.08321131020784378,-0.33699163794517517,0.19798243045806885,0.24738597869873047,0.24139881134033203,0.09785397350788116,-0.26667436957359314},{-0.39759862422943115,-0.11987625807523727,0.06272081285715103,-0.10561075806617737,0.15850144624710083,-0.3700226843357086,0.1325470209121704,-0.24654604494571686},{-0.06842280924320221,0.11124353110790253,-0.11759576946496964,-0.48078539967536926,0.2572633624076843,0.029160726815462112,-0.39045336842536926,0.15341562032699585},{-0.16238515079021454,-0.17695365846157074,-0.13602778315544128,0.05558882653713226,0.10871270298957825,0.33940184116363525,0.26659002900123596,-0.05552663281559944},{-0.1716829240322113,0.07879015058279037,-0.3397441506385803,-0.2545213997364044,0.13297352194786072,0.0382242314517498,-0.06394883990287781,0.05899112671613693},{0.30194082856178284,0.39756742119789124,-0.21151503920555115,0.24783745408058167,0.07680124789476395,0.310397207736969,-0.2988370656967163,-0.18078047037124634},{0.4015747904777527,0.25603342056274414,0.13124124705791473,0.09572785347700119,0.20048582553863525,0.07088396698236465,0.2101544886827469,0.3707946240901947},{-0.10072183609008789,0.35352814197540283,0.1556491106748581,0.044638216495513916,0.2649601697921753,0.010668960399925709,-0.40857991576194763,-0.2638383209705353},{-0.1606774479150772,-0.26762935519218445,0.006215677130967379,-0.17791277170181274,-0.2594163119792938,-0.1672409623861313,0.2266083061695099,0.005989528726786375},{0.41965484619140625,-0.3041354715824127,0.25966253876686096,-0.26029539108276367,0.11877579987049103,0.25406816601753235,0.0849437490105629,-0.161632239818573},{0.23587103188037872,0.378825843334198,0.42717456817626953,-0.20027248561382294,-0.19173213839530945,0.11269544810056686,0.21534813940525055,0.038844961673021317}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.029294194653630257,0.375329852104187,-0.1581716686487198,0.24620410799980164,-0.3920345604419708,0.22360846400260925,0.43727314472198486,0.04026804491877556},{-0.4022124111652374,-0.45555680990219116,-0.333429217338562,-0.38094258308410645,-0.4094494581222534,0.3887692987918854,0.4622960090637207,-0.4208817183971405},{-0.00029729874222539365,-0.14519056677818298,0.10998857766389847,0.011392568238079548,-0.08064138144254684,0.4011663496494293,-0.3038642704486847,-0.30685314536094666},{0.3900125026702881,-0.0002463647397235036,0.06986899673938751,-0.00846802070736885,0.5128248929977417,0.3764403760433197,0.40665632486343384,0.42521125078201294},{0.08221939206123352,0.2268853485584259,-0.13387472927570343,-0.05632125586271286,0.1192498579621315,-0.3216392993927002,-0.37494033575057983,0.4375104308128357},{0.413486510515213,0.09233803302049637,0.031130904331803322,-0.33737465739250183,-0.3717176914215088,-0.45888981223106384,-0.11737395823001862,0.4645613431930542},{-0.35055822134017944,-0.271584689617157,-0.0024557095021009445,-0.20607459545135498,0.07501009106636047,0.3403148651123047,-0.5050020813941956,0.5766657590866089},{0.12112680822610855,0.04917197301983833,0.01898602768778801,-0.0697799026966095,0.2936633229255676,-0.4967588186264038,0.3730166256427765,-0.4820694625377655}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.06084873527288437,0.027901586145162582,0.11622768640518188,-0.05079381540417671,-0.04295739158987999,-0.05457005649805069,0.09498099982738495,-0.027056630700826645};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.041282594203948975,-0.029368866235017776,0.044608160853385925,-0.10945014655590057,-0.0011743261711671948,0.012210078537464142,-0.011611316353082657,-0.07288435846567154};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

