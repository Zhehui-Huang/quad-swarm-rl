#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3536493480205536,-0.109637551009655,0.30342239141464233,0.12901632487773895,-0.2817418873310089,0.2882819175720215,0.017288032919168472,-0.12093473970890045,0.11605260521173477,0.3092438280582428,0.0946335420012474,0.0075455657206475735,0.21061843633651733,-0.22537435591220856,0.26955586671829224,-0.033015429973602295},{-0.1995716243982315,-0.4057258367538452,0.3071731925010681,0.0657849982380867,-0.20688174664974213,0.16052493453025818,-0.4170967936515808,-0.052246835082769394,-0.10147340595722198,-0.20045605301856995,0.028427090495824814,-0.18820613622665405,-0.020357366651296616,-0.31813594698905945,-0.2967699468135834,0.12114642560482025},{-0.13443657755851746,-0.26478448510169983,-0.4814434349536896,0.20843088626861572,0.2717418968677521,0.6103686690330505,0.04009908437728882,-0.039687611162662506,0.14423714578151703,-0.5737351179122925,-0.4220001995563507,0.8290930390357971,-0.268902063369751,-0.3203617334365845,-0.40767601132392883,0.3125497102737427},{0.18426789343357086,0.25756680965423584,0.3680793046951294,-0.03216575086116791,-0.37690478563308716,-0.026778196915984154,0.24456512928009033,0.08358553797006607,0.33050668239593506,-0.2996239960193634,0.008494041860103607,0.4185299873352051,-0.23279529809951782,-0.029388494789600372,0.4685783386230469,-0.47043925523757935},{-0.09364282339811325,0.04219180345535278,0.3195808231830597,-0.05970071628689766,0.31014135479927063,0.4424092471599579,0.16513049602508545,-0.02813315950334072,0.11742401868104935,0.20407870411872864,0.25948041677474976,-0.3400145471096039,-0.18918204307556152,-0.4360661804676056,0.34697213768959045,0.09872838109731674},{-0.2784755229949951,-0.1755831092596054,-0.2214037925004959,-0.0389799103140831,0.2010115385055542,0.23724780976772308,0.02052631974220276,-0.09784494340419769,0.3253727853298187,-0.31517598032951355,-0.4618533253669739,0.24435538053512573,0.06999952346086502,-0.16506452858448029,-0.010720019228756428,0.09300289303064346},{0.022761216387152672,0.1521972119808197,0.029660658910870552,-0.41616371273994446,0.1561838835477829,-0.023753736168146133,0.06679770350456238,0.3714442253112793,0.32835206389427185,0.05973289534449577,-0.4267442226409912,-0.02440822869539261,-0.004553926642984152,0.14338761568069458,-0.2499038279056549,-0.2112594097852707},{-0.30439266562461853,0.45725393295288086,0.42712530493736267,0.36878466606140137,-0.48019614815711975,-0.06770613044500351,0.5733597874641418,0.5365322828292847,-0.23218892514705658,0.3101010322570801,-0.7108022570610046,-0.43589743971824646,0.4544311761856079,0.060718365013599396,0.2805951237678528,0.45566898584365845},{0.39410677552223206,-0.3077167272567749,0.6372668743133545,0.09889937192201614,0.006612254772335291,0.06711333245038986,0.1197732612490654,-0.6896696090698242,-0.2485109567642212,-0.40818625688552856,-0.1742948293685913,0.015075001865625381,-0.06923070549964905,0.7459517121315002,0.45324400067329407,-0.3332860767841339},{0.204270139336586,-0.6074545383453369,-0.6745284199714661,-0.37927302718162537,-0.23066456615924835,0.2543908357620239,0.11803790926933289,0.11960192769765854,0.6163060665130615,0.2631232440471649,0.2134365737438202,-0.27672329545021057,-0.13026461005210876,0.4598921537399292,-0.22888781130313873,-0.6097494959831238},{0.20327205955982208,0.44086208939552307,0.3965446352958679,-0.5973457098007202,-0.3677229881286621,0.14213326573371887,0.19362065196037292,0.42879822850227356,-0.3954754173755646,0.04035850986838341,-0.06232733279466629,-0.02677319385111332,-0.13365407288074493,-0.1912814974784851,0.2549591660499573,-0.42247679829597473},{-0.048646438866853714,-0.4487628638744354,0.1904490441083908,0.6715965270996094,0.8619048595428467,0.46806636452674866,0.45509904623031616,0.4539119601249695,0.018818212673068047,-0.03715537488460541,0.27444782853126526,-0.446394681930542,-0.6299277544021606,-0.4121159017086029,0.8078460693359375,-0.04148603230714798},{-0.2374473512172699,0.37500816583633423,-0.08957812190055847,-0.5991964340209961,0.16806434094905853,0.07256951183080673,0.18887768685817719,0.19747419655323029,0.05893563851714134,0.019423475489020348,0.0681404322385788,0.1875554770231247,0.35515668988227844,0.3219550848007202,-0.10878901183605194,-0.11269640177488327},{0.03369034826755524,-0.3887365460395813,-0.2541455328464508,-0.1949789822101593,-0.4337646961212158,0.0331895537674427,-0.31353482604026794,-0.3155743479728699,-0.23397181928157806,-0.02189601957798004,-0.4581528902053833,-0.009255021810531616,-0.19658148288726807,0.3907093405723572,0.10997684299945831,0.0057415347546339035},{0.03979605436325073,-0.25911152362823486,-0.23136736452579498,0.20370569825172424,-0.12934371829032898,-0.4476277232170105,0.31898191571235657,-0.08184881508350372,-0.0391412228345871,0.37346237897872925,0.06631608307361603,0.03033480979502201,0.2934257686138153,-0.01044539362192154,-0.2382282316684723,0.21226342022418976},{0.3580710291862488,-0.001630334067158401,-0.23639555275440216,-0.13767383992671967,-0.2931196093559265,0.14559747278690338,0.32003915309906006,-0.07677654922008514,0.16925042867660522,0.3453138470649719,-0.15116217732429504,0.06077512353658676,-0.18396547436714172,0.2307702898979187,-0.05809943750500679,-0.016820143908262253},{-0.23682723939418793,-0.19896861910820007,0.2229968011379242,0.12382809817790985,-0.2311318814754486,0.06437236070632935,-0.16001293063163757,-0.0852263793349266,-0.1954323947429657,-0.26819053292274475,-0.03180084004998207,-0.2914300262928009,0.06787058711051941,-0.19312036037445068,0.0837860032916069,-0.2031002789735794},{-0.25404754281044006,0.25855815410614014,-0.30251041054725647,-0.2065252661705017,0.05884181708097458,0.31495535373687744,-0.17284803092479706,-0.19803179800510406,0.12206597626209259,0.14748495817184448,0.333910197019577,-0.1229395940899849,-0.3163217604160309,0.3050687313079834,0.02835722453892231,-0.39307865500450134}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.028154220432043076,-0.06365528702735901,-0.08676283061504364,-0.34458985924720764,0.3083106577396393,0.2971040606498718,0.07606888562440872,0.043318938463926315,-0.07112400233745575,-0.18556268513202667,0.004196829162538052,0.06746478378772736,0.19858531653881073,0.30760228633880615,0.1569215953350067,0.04853937029838562},{-0.14693497121334076,-0.2991028428077698,-0.055306557565927505,0.04000720754265785,0.23942048847675323,-0.28904110193252563,0.019461974501609802,0.051657382398843765,-0.04963495582342148,0.2677116096019745,-0.23141568899154663,0.3197619616985321,-0.3837837278842926,0.1670304834842682,-0.27004289627075195,-0.3533289134502411},{0.02656249888241291,0.21111562848091125,-0.38744452595710754,-0.513416588306427,0.20804598927497864,0.43470367789268494,-0.08338532596826553,0.06783989816904068,-0.2682968080043793,-0.24837371706962585,-0.014091890305280685,0.3323138356208801,-0.2790275514125824,-0.12686468660831451,0.096193827688694,-0.0777582973241806},{0.13860704004764557,-0.06774665415287018,0.09945029020309448,0.17386659979820251,-0.44285881519317627,-0.003026277758181095,0.07122167944908142,-0.18868541717529297,0.27686136960983276,0.3662799894809723,-0.17056283354759216,-0.15206296741962433,-0.4110923409461975,-0.33998775482177734,0.19710741937160492,0.14619773626327515},{-0.040931280702352524,0.1610632687807083,-0.00113466486800462,0.2629253566265106,-0.23922471702098846,0.0973408967256546,-0.017140697687864304,0.16895346343517303,0.2477179318666458,-0.21573995053768158,0.186911940574646,0.24764737486839294,0.1722789704799652,-0.45235756039619446,0.04687076061964035,0.024662110954523087},{0.19234980642795563,0.25558117032051086,-0.009318718686699867,0.1945432722568512,-0.49602949619293213,-0.4414880573749542,0.27211400866508484,0.33130666613578796,0.062300149351358414,0.3689798414707184,0.23333431780338287,-0.25149422883987427,0.0018477366538718343,-0.15500222146511078,-0.1281498521566391,0.29516568779945374},{-0.1148049384355545,0.2589423656463623,0.29503628611564636,-0.3670707941055298,-0.2577184736728668,0.0022864004131406546,-0.35285571217536926,-0.03656526282429695,0.18621017038822174,0.05718294903635979,-0.13038159906864166,-0.21889184415340424,-0.31538861989974976,-0.08971089869737625,0.19994603097438812,0.019035348668694496},{-0.1108425036072731,-0.13149888813495636,-0.45737424492836,0.2939143180847168,-0.3048988878726959,-0.24576860666275024,-0.24249383807182312,-0.38091862201690674,0.14707954227924347,-0.2103179544210434,0.05722666159272194,0.059165675193071365,-0.14477412402629852,0.4241952896118164,-0.017198385670781136,-0.29455557465553284},{-0.3131897449493408,0.24560989439487457,-0.00823343824595213,-0.052385363727808,0.27012762427330017,-0.27362146973609924,0.290945440530777,0.14086191356182098,0.3377377390861511,0.3007519543170929,0.2543829679489136,0.30153632164001465,0.1771579384803772,-0.10187924653291702,0.2500726580619812,0.1008782684803009},{0.08056917786598206,-0.27029937505722046,-0.1358071267604828,-0.13127529621124268,0.2342810034751892,-0.1617588996887207,-0.29568177461624146,-0.14892040193080902,0.047581806778907776,-0.3688003122806549,-0.2641945779323578,0.3160800039768219,0.10776810348033905,0.09270213544368744,-0.3079109191894531,0.22550217807292938},{-0.03639490529894829,-0.4448518753051758,0.288786381483078,0.2817979156970978,0.26419907808303833,0.15461736917495728,0.1557893455028534,-0.1210315153002739,0.23764781653881073,-0.21019935607910156,0.18610790371894836,0.33606860041618347,0.4936513602733612,0.12429764866828918,-0.039053089916706085,0.05620720610022545},{0.04729992151260376,-0.009272509254515171,0.40680938959121704,-0.016359448432922363,-0.2516195476055145,-0.18909798562526703,0.4293212890625,0.30211105942726135,-0.23178760707378387,-0.19829215109348297,-0.048923347145318985,-0.36117514967918396,-0.007448898162692785,-0.304399698972702,-0.29680106043815613,0.08235856890678406},{-0.15574781596660614,-0.3154643774032593,0.4191629886627197,-0.22772690653800964,0.3784247934818268,-0.3136930763721466,-0.4570860266685486,0.06345538794994354,0.10448050498962402,0.06838887184858322,-0.3099229633808136,0.11407552659511566,0.120259128510952,-0.2590383291244507,-0.23678003251552582,0.008880605921149254},{0.3776301443576813,-0.3351617753505707,0.4500964879989624,0.08419423550367355,-0.10094524919986725,0.33686625957489014,-0.11870631575584412,-0.22289930284023285,-0.3972319960594177,0.0887216106057167,0.017219655215740204,-0.3554595410823822,-0.12648837268352509,0.07980836927890778,0.3020751476287842,0.03160756081342697},{-0.1039009615778923,0.1939580738544464,0.12240666896104813,-0.4833150804042816,-0.18858292698860168,0.20779022574424744,0.24100522696971893,-0.24967285990715027,0.24401597678661346,-0.27928489446640015,0.0774226114153862,0.10814814269542694,-0.033799294382333755,0.19299404323101044,0.050066493451595306,0.07430724054574966},{-0.12227018922567368,0.4023967683315277,-0.43630853295326233,0.40067383646965027,0.07837533950805664,-0.381891667842865,-0.0007164302514865994,-0.06652196496725082,-0.3078398108482361,0.37984853982925415,-0.27768805623054504,0.2515101730823517,-0.08230813592672348,-0.3031335771083832,-0.11113592982292175,-0.4517703652381897}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1307123750448227,0.09493546932935715,0.004117251839488745,-0.045919839292764664,-0.07902534306049347,0.004717892035841942,0.2639332115650177,0.06781647354364395,-0.1560840755701065,-0.1807105392217636,0.11014646291732788,-0.269980788230896,-0.18643929064273834,0.2544449269771576,0.2058257758617401,0.3069741725921631,-0.2529965043067932,-0.2694219648838043,-0.1959989070892334,0.12947097420692444,-0.05613712593913078,-0.3490312099456787,-0.26812857389450073,-0.26921993494033813,-0.22647306323051453,0.12394917011260986,-0.22898073494434357,-0.062340956181287766,-0.07861258834600449,-0.00111299694981426,0.20978853106498718,-0.21267962455749512},{0.3051205575466156,0.14608736336231232,0.18786053359508514,-0.08429770171642303,0.12622588872909546,-0.15619631111621857,0.35191425681114197,0.16163906455039978,-0.12391786277294159,-0.07096266746520996,-0.12509696185588837,-0.24947421252727509,-0.1888449341058731,0.2357073575258255,-0.26581820845603943,-0.18823251128196716,-0.05452708527445793,0.18365982174873352,-0.3519507646560669,-0.20421864092350006,-0.019130699336528778,0.205377459526062,0.019880082458257675,0.036135416477918625,0.2234998345375061,-0.34471774101257324,-0.057077161967754364,0.0598134808242321,0.1563429832458496,-0.09902673959732056,-0.07213709503412247,0.20516648888587952},{0.17607520520687103,0.04879293963313103,-0.12700290977954865,0.14066769182682037,-0.1511000394821167,-0.14699505269527435,-0.21750958263874054,0.059390243142843246,-0.16882292926311493,0.3374025225639343,-0.31623008847236633,-0.26732394099235535,0.1832144558429718,-0.4002268612384796,-0.14569105207920074,0.09822996705770493,-0.08055561035871506,-0.1150568351149559,0.19479972124099731,-0.09632284194231033,0.23650217056274414,0.2745620608329773,-0.2279038429260254,0.023897457867860794,-0.2593790590763092,-0.028256982564926147,0.13755349814891815,-0.0682946965098381,-0.001454599085263908,-0.2023380994796753,-0.10673340409994125,-0.07895910739898682},{0.3974675238132477,0.05722877010703087,0.13485582172870636,-0.18481923639774323,-0.24525076150894165,-0.03999107703566551,-0.1276736855506897,0.2723507583141327,0.2320985496044159,-0.30000197887420654,-0.0652492567896843,0.2565871775150299,0.1157284826040268,-0.009613487869501114,-0.24358917772769928,0.2967495620250702,-0.29059037566185,0.26841896772384644,0.0017260920722037554,0.10843370854854584,-0.10283099114894867,-0.08861451596021652,0.2889973521232605,0.15929049253463745,0.16514064371585846,-0.36199405789375305,0.2627240717411041,-0.20506733655929565,-0.04360207915306091,0.059341635555028915,-0.20176394283771515,0.13400402665138245},{-0.0678599551320076,-0.05621600151062012,-0.11715739965438843,0.12289788573980331,0.2079751044511795,-0.14202317595481873,-0.40942463278770447,-0.0797920748591423,-0.10366557538509369,-0.3103376030921936,0.1491985023021698,0.2475980520248413,-0.057151004672050476,-0.11750958859920502,-0.09705515205860138,0.12261024117469788,-0.022945640608668327,-0.04252747818827629,-0.30366355180740356,-0.20189741253852844,-0.17237097024917603,-0.3514869809150696,0.1406908482313156,0.1356191337108612,-0.10594438761472702,0.34856903553009033,-0.1778525412082672,0.21659399569034576,0.29115623235702515,0.3809216022491455,-0.022472821176052094,0.38287484645843506},{-0.2830381989479065,0.031008413061499596,-0.2366197109222412,-0.05201880261301994,-0.1998959332704544,0.24415543675422668,0.20273709297180176,0.013292699120938778,0.2548215985298157,0.21488258242607117,0.3392479121685028,-0.22833403944969177,-0.2777109742164612,0.19484762847423553,0.3435039520263672,-0.3392830789089203,-0.11369912326335907,-0.24756425619125366,0.2366238832473755,0.101408950984478,0.08553911000490189,0.1884576976299286,0.06981603801250458,-0.08693020790815353,-0.34037402272224426,0.34564855694770813,-0.13362087309360504,0.2193710207939148,0.3177430033683777,0.1840108335018158,0.06731565296649933,0.020621947944164276},{0.20006144046783447,-0.1372814029455185,-0.12416461855173111,-0.29528048634529114,-0.04913707077503204,0.2346724271774292,0.28376302123069763,0.18524448573589325,0.08542036265134811,0.34972018003463745,-0.002207929966971278,-0.015213873237371445,-0.473854660987854,-0.17303279042243958,-0.15378260612487793,0.1618325412273407,-0.25761133432388306,-0.21745194494724274,0.2250698208808899,-0.0750337690114975,-0.12442859262228012,-0.15361708402633667,-0.23090553283691406,-0.21303671598434448,0.1349482238292694,-0.2167055755853653,-0.08093114197254181,-0.2027774453163147,0.2931957244873047,0.1399933397769928,-0.16100914776325226,-0.2927895486354828},{0.01323994342237711,0.16912536323070526,0.06607623398303986,0.004991089925169945,0.1276816725730896,-0.3064691126346588,-0.14663398265838623,-0.14931803941726685,-0.029952460899949074,-0.2440841943025589,-0.2947290241718292,-0.02562478929758072,-0.14804351329803467,-0.02792077697813511,-0.11819446831941605,0.3826060891151428,-0.005691670347005129,-0.15018798410892487,0.1385183334350586,0.33641400933265686,-0.10549253225326538,-0.23526069521903992,0.25537586212158203,0.09238649904727936,-0.05371353402733803,-0.2911704480648041,-0.2972937226295471,-0.3014378249645233,-0.33473679423332214,-0.2234974503517151,0.05136338621377945,-0.2948615252971649},{0.08816951513290405,0.29254499077796936,-0.25388768315315247,-0.3166187107563019,-0.2093464732170105,0.04730234667658806,0.06763031333684921,0.05475320667028427,0.1647185981273651,-0.2697647511959076,-0.24242693185806274,0.32709386944770813,-0.2314620465040207,-0.1912052035331726,0.18122710287570953,-0.2808195948600769,0.2663459777832031,0.14849060773849487,0.31790095567703247,0.041510649025440216,0.22407010197639465,0.03322211652994156,0.25373563170433044,-0.07730011641979218,0.3693046271800995,-0.2116459459066391,0.09675601124763489,0.3108271658420563,-0.28130894899368286,0.21872548758983612,-0.03193863481283188,0.151396706700325},{-0.1779714971780777,0.11929240822792053,-0.22548629343509674,-0.1478320211172104,0.18993593752384186,-0.14743898808956146,0.06841421872377396,-0.005980170797556639,0.15942054986953735,-0.03974338248372078,-0.2660210430622101,-0.27510085701942444,-0.30968815088272095,-0.059657175093889236,-0.24271634221076965,0.09251575917005539,0.06491400301456451,-0.21657302975654602,0.26907122135162354,0.0913335457444191,0.01023106463253498,-0.03176106512546539,0.2783549129962921,-0.20191234350204468,0.3041941225528717,0.10313048958778381,-0.2595462203025818,0.006500400137156248,-0.011431564576923847,0.14852333068847656,-0.1267925649881363,0.11243715137243271},{0.08249762654304504,0.010831913910806179,0.21776415407657623,-0.2659201920032501,-0.28135189414024353,-0.24731335043907166,-0.27133214473724365,-0.006217931862920523,-0.19794392585754395,0.42187389731407166,0.13301074504852295,-0.2603360712528229,-0.38358810544013977,-0.020521409809589386,-0.23593921959400177,-0.0900353193283081,0.23252853751182556,-0.13706734776496887,0.2561793625354767,-0.13594567775726318,-0.19806598126888275,0.0014263297198340297,0.14229419827461243,0.2417883276939392,0.16155405342578888,-0.10748203843832016,-0.022401822730898857,-0.09106811136007309,-0.08012258261442184,0.0305987149477005,-0.040904074907302856,0.1150902807712555},{-0.17162533104419708,-0.12752491235733032,0.210895374417305,0.2998153567314148,0.24817988276481628,-0.06528443843126297,0.07035248726606369,-0.22583678364753723,-0.009721897542476654,-0.25138765573501587,0.2596453130245209,-0.2203521579504013,-0.22015944123268127,-0.20727631449699402,0.23823145031929016,-0.007195069920271635,-0.023710716515779495,0.0005093060317449272,0.3507719039916992,0.04386788606643677,-0.16703318059444427,0.2089378833770752,0.10149531811475754,-0.06400219351053238,0.22911673784255981,-0.08975889533758163,-0.18336880207061768,0.20343691110610962,0.12280167639255524,0.00842110812664032,-0.3119373023509979,-0.2271571010351181},{0.29117482900619507,-0.2513205111026764,0.004533370491117239,-0.3175007402896881,0.0009435206302441657,-0.1523689478635788,0.12033823132514954,0.1557481586933136,0.22469444572925568,0.051713958382606506,0.184368297457695,0.24708077311515808,-0.43841367959976196,-0.34243109822273254,-0.04414314404129982,-0.21040119230747223,-0.2376403957605362,-0.2865390181541443,0.3093971908092499,-0.17085523903369904,0.32551562786102295,-0.08952078968286514,-0.0038508425932377577,0.19575251638889313,0.11358802020549774,-0.09944503754377365,0.11607281863689423,0.051191240549087524,0.06401367485523224,-0.017576245591044426,-0.2719973623752594,-0.008878749795258045},{0.2556169033050537,-0.03470749780535698,-0.02212638594210148,0.3409903645515442,-0.09757444262504578,-0.15972693264484406,-0.02005573734641075,0.1780078113079071,0.1848948448896408,0.24848200380802155,0.12414000183343887,-0.14307042956352234,0.060149822384119034,0.21310101449489594,-0.12238474190235138,0.1281944364309311,0.23131698369979858,-0.22870661318302155,0.11098460853099823,-0.3333895802497864,0.2387532889842987,0.16761590540409088,-0.08096884936094284,0.19994495809078217,0.25264227390289307,0.07360074669122696,0.16152770817279816,0.09588800370693207,0.07935517281293869,-0.14979860186576843,0.03340857848525047,0.34652242064476013},{0.08100491017103195,-0.20762333273887634,-0.0030555373523384333,0.09530708193778992,-0.26908794045448303,-0.01954672858119011,0.05141344666481018,-0.21094483137130737,-0.15109942853450775,-0.016986295580863953,0.16649267077445984,0.2028694599866867,0.09836820513010025,0.2473842203617096,-0.036122795194387436,-0.025067726150155067,-0.2326223999261856,0.2555915117263794,-0.0768454447388649,-0.18824027478694916,-0.20330557227134705,-0.11473549902439117,0.14366760849952698,0.05635112151503563,0.007866853848099709,-0.15912626683712006,-0.1714072823524475,0.2014513909816742,0.04046015068888664,-0.15591125190258026,0.2421666383743286,0.15870390832424164},{0.1702316254377365,-0.2401471883058548,0.029449785128235817,-0.18405142426490784,0.018470391631126404,0.1509067714214325,0.05977172404527664,0.2580609619617462,-0.07729201763868332,-0.03434547409415245,0.2032482624053955,0.12545394897460938,0.06063038110733032,-0.09804535657167435,-0.020191481336951256,0.201030895113945,-0.32583901286125183,-0.17816561460494995,-0.035760000348091125,0.08542725443840027,0.038639649748802185,0.23649774491786957,0.13560308516025543,0.1952255815267563,0.05547472462058067,0.18311849236488342,-0.037422064691782,-0.060970619320869446,0.06899885088205338,-0.09032727032899857,-0.25633329153060913,0.3128978908061981},{0.17074139416217804,0.003925229422748089,-0.3259246051311493,0.12149558216333389,0.05579332262277603,-0.04687390848994255,0.3267326056957245,0.11240588128566742,0.11465199291706085,-0.12727241218090057,0.19552364945411682,-0.22750692069530487,-0.37557005882263184,0.23773670196533203,0.08063267171382904,0.0456019826233387,-0.02086099423468113,-0.10165209323167801,-0.15299591422080994,0.06812778860330582,-0.03094884753227234,0.20130512118339539,0.08442836254835129,-0.16106286644935608,-0.07400525361299515,-0.23571906983852386,0.05584894120693207,0.3166072964668274,0.20815108716487885,-0.17156416177749634,0.17990481853485107,0.18121212720870972},{-0.08033408969640732,0.00928410142660141,-0.08709951490163803,-0.06932003051042557,-0.2423756867647171,-0.03494022414088249,0.22046732902526855,0.1713050901889801,0.12541250884532928,0.025694651529192924,0.18090474605560303,-0.001760481740348041,0.24130526185035706,0.19483062624931335,0.18974649906158447,-0.11050522327423096,0.1101938784122467,0.18734318017959595,0.20438849925994873,0.05040423572063446,0.2078254520893097,0.27024704217910767,0.08454037457704544,0.16517426073551178,-0.03568921610713005,-0.06969671696424484,-0.12826067209243774,-0.2583545446395874,0.14133702218532562,-0.28201746940612793,0.019571008160710335,-0.057554490864276886},{-0.32146450877189636,0.051520053297281265,-0.31793057918548584,-0.3218599855899811,0.020000848919153214,-0.002442223485559225,0.10964998602867126,-0.15537402033805847,0.05137532204389572,0.34495189785957336,0.021697597578167915,-0.19074827432632446,0.07603595405817032,-0.20721663534641266,-0.29752296209335327,0.010022795759141445,-0.1724710315465927,0.1047717034816742,-0.04662641882896423,0.01641266979277134,-0.2794884741306305,0.13503681123256683,0.09937465190887451,0.036689624190330505,-0.07352131605148315,0.32521554827690125,0.05318107455968857,-0.2066938579082489,-0.17649546265602112,0.04168359190225601,-0.20519128441810608,-0.245941162109375},{-0.00474115926772356,-0.2632976472377777,-0.2750178575515747,-0.052804816514253616,-0.32498899102211,-0.14927613735198975,0.1829332560300827,-0.2721203863620758,-0.21261735260486603,0.1695893257856369,0.20347972214221954,0.09168592095375061,0.1178027093410492,-0.15260963141918182,0.2705218493938446,-0.2688175439834595,0.08826814591884613,0.2567412555217743,0.05132748559117317,0.27438098192214966,0.006440922152251005,-0.11519540846347809,-0.27397286891937256,0.2221325933933258,-0.11607752740383148,-0.15347832441329956,0.12009070813655853,0.043140314519405365,-0.12431669235229492,-0.32089442014694214,-0.02755703032016754,-0.18901953101158142},{0.23195438086986542,0.13146647810935974,-0.04921283200383186,0.2073269784450531,-0.2404564917087555,0.1309848129749298,-0.09075406938791275,-0.17687661945819855,-0.12046510726213455,0.18740159273147583,-0.31236448884010315,-0.1369123011827469,0.0005744015797972679,-0.20296676456928253,-0.3821682035923004,-0.156103253364563,-0.08677733689546585,-0.304972380399704,-0.23534539341926575,0.21063566207885742,0.12253619730472565,0.11309924721717834,-0.37949907779693604,0.3069554269313812,0.15336786210536957,0.2975667119026184,-0.28609076142311096,-0.0717822015285492,0.06776098906993866,-0.19679415225982666,0.14582404494285583,0.15346857905387878},{-0.052001360803842545,-0.30624181032180786,-0.04242971912026405,-0.3058854937553406,-0.07363089919090271,0.28711527585983276,0.20270654559135437,0.03657221794128418,-0.09222368150949478,0.011757143773138523,-0.14992550015449524,0.10238447040319443,0.09945748001337051,0.05437074601650238,0.11232432723045349,0.03318430110812187,-0.09304039180278778,0.13466224074363708,-0.11348147690296173,0.14679837226867676,0.19172844290733337,0.25306084752082825,-0.023576442152261734,-0.24934521317481995,0.16477058827877045,0.16325229406356812,0.2832489609718323,0.16214466094970703,0.01773984357714653,0.11330123245716095,0.015801656991243362,-0.09875230491161346},{-0.023739024996757507,-0.20874755084514618,0.21874552965164185,0.06481961905956268,0.2759111225605011,-0.025369571521878242,-0.1390306055545807,-0.20087681710720062,0.1411568969488144,-0.04322872310876846,0.08460618555545807,-0.001396183972246945,-0.3348153531551361,0.05788922309875488,-0.09838082641363144,-0.2566578686237335,-0.04169078916311264,-0.0608978271484375,0.18707521259784698,0.19412437081336975,0.022118965163826942,0.05517994984984398,0.16502510011196136,0.29519468545913696,-0.187143936753273,-0.03576105087995529,0.16078636050224304,-0.06540403515100479,-0.13743062317371368,-0.2590390145778656,0.29689183831214905,0.01999080553650856},{0.1949368715286255,-0.09320452809333801,0.04600309953093529,0.11083078384399414,-0.028124820441007614,0.02914489060640335,-0.23091360926628113,0.3006608486175537,-0.10133064538240433,-0.014973348006606102,0.10012964904308319,-0.2979516386985779,0.09650614857673645,-0.05782957002520561,-0.11958958953619003,0.31144893169403076,-0.10004749894142151,-0.18825465440750122,0.006427450571209192,0.02547309920191765,-0.1612783670425415,0.14994052052497864,0.2167777270078659,0.25893765687942505,-0.261911004781723,0.11258087307214737,-0.08086077123880386,0.04190133884549141,-0.26027145981788635,0.24408486485481262,-0.07545642554759979,0.0396428182721138}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.19854256510734558,-0.12105654180049896,0.04627881199121475,-0.11883137375116348},{0.19905555248260498,-0.24240869283676147,0.27093106508255005,0.2244076430797577},{-0.22116710245609283,0.0285617895424366,0.05471744015812874,-0.024941250681877136},{0.280853807926178,0.3872407376766205,0.2921394407749176,0.04366898536682129},{-0.24722319841384888,0.14429907500743866,-0.2535568177700043,0.10705098509788513},{0.021956905722618103,-0.06626778095960617,0.07200157642364502,0.23988503217697144},{-0.10184023529291153,-0.1631457656621933,-0.32643136382102966,-0.06297611445188522},{-0.09877949208021164,-0.32150158286094666,0.1266007423400879,-0.060131363570690155},{-0.08670524507761002,0.14568723738193512,-0.0885859876871109,-0.0774635374546051},{0.1988016664981842,-0.02223190851509571,-0.0662894919514656,-0.14947128295898438},{0.2157551795244217,-0.1845564842224121,0.2711101472377777,0.20756740868091583},{-0.02152307704091072,-0.00044267307384870946,0.3234061300754547,-0.07147320359945297},{-0.2852502465248108,0.2241874486207962,-0.04361612722277641,-0.07561139762401581},{-0.14091061055660248,0.005554887931793928,-0.21437065303325653,0.03527689725160599},{0.18975064158439636,-0.02678655833005905,0.20257189869880676,0.061714671552181244},{-0.12355227768421173,-0.2561362087726593,-0.11272328346967697,-0.07343078404664993},{-0.23046359419822693,0.04012890160083771,-0.061540573835372925,0.25680509209632874},{-0.24081052839756012,-0.13023091852664948,-0.2188923954963684,0.16164939105510712},{-0.06324756890535355,-0.0820058137178421,0.3233025372028351,0.06996079534292221},{-0.13276433944702148,-0.15320834517478943,-0.01087877992540598,-0.15234506130218506},{0.13873642683029175,0.1016574278473854,0.10531600564718246,-0.13019731640815735},{-0.010963307693600655,-0.23598895967006683,-0.11337323486804962,0.21220934391021729},{0.27215707302093506,-0.12128599733114243,0.14710383117198944,0.01387814898043871},{-0.24588832259178162,-0.0965493768453598,-0.26761528849601746,-0.16447101533412933},{-0.22531823813915253,-0.15929901599884033,-0.019003918394446373,-0.12103740125894547},{0.1524074524641037,0.1618211716413498,-0.03985794261097908,0.14232809841632843},{0.17613419890403748,-0.1962737888097763,0.2068091332912445,0.07530906051397324},{-0.04405553266406059,-0.14786967635154724,0.006535759195685387,0.27375689148902893},{0.03330009803175926,0.007686370052397251,0.020717555657029152,0.011510007083415985},{-0.12229155004024506,0.10883386433124542,0.19861632585525513,0.00914421770721674},{-0.12525467574596405,-0.12922975420951843,0.07681185007095337,0.17173433303833008},{0.17711183428764343,0.18435443937778473,0.1888325810432434,-0.014313914813101292}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.054103411734104156,0.0035845893435180187,0.004454739857465029,0.04866687208414078,0.047850918024778366,-0.03916392847895622,0.006628022063523531,0.05239453911781311,-0.06776300072669983,-0.08491483330726624,-0.02468341402709484,0.06676992028951645,-0.030694404616951942,0.041101161390542984,-0.026603320613503456,-0.02047630585730076};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0006053424440324306,-0.0013659973628818989,-0.00917084701359272,-0.013854165561497211,-0.05127985402941704,0.01931978389620781,-0.020257284864783287,-0.0036534438841044903,0.018445132300257683,-0.044776082038879395,-0.0032673145178705454,-0.016975341364741325,-0.009332915768027306,-0.025174790993332863,-0.01378653571009636,-0.04536980390548706};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0036266299430280924,0.06386065483093262,-0.02316530980169773,0.019061952829360962,-0.018214108422398567,0.035570044070482254,-0.044394560158252716,-0.017596924677491188,-0.029684409499168396,-0.019571900367736816,-0.008263811469078064,0.03240087255835533,0.013710707426071167,0.009156657382845879,0.05992154777050018,-0.04933742806315422,0.02110835537314415,-0.006257377099245787,0.019536150619387627,-0.03368740528821945,-0.0013972279848530889,0.025439392775297165,-0.005960484500974417,-0.04519457742571831,-0.054683979600667953,0.015048381872475147,0.024155307561159134,0.029887737706303596,0.0014752844581380486,0.0224600937217474,0.025609614327549934,0.004322106949985027};
static const float action_parameterization_distribution_linear_bias[4] = {0.008925361558794975,0.01989578828215599,0.017070766538381577,0.0403633713722229};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.43860194087028503,-0.3713453710079193,-0.1245071068406105,0.2478160560131073,-0.16919973492622375,0.10254749655723572,-0.3058818578720093,0.0589698888361454},{0.21206782758235931,0.11193987727165222,0.4074033200740814,0.3861108422279358,-0.10499697178602219,-0.3360954821109772,0.31586122512817383,0.39018046855926514},{0.07128890603780746,0.17742854356765747,0.11226660013198853,-0.05207996070384979,0.3327305018901825,0.22214236855506897,-0.0256976131349802,0.22416336834430695},{0.11856065690517426,-0.37641024589538574,0.34824177622795105,-0.1513870358467102,-0.22453080117702484,0.10441701114177704,0.3282102942466736,0.24485346674919128},{-0.23789547383785248,-0.08917960524559021,-0.028196517378091812,-0.2632947564125061,0.14860491454601288,0.12821698188781738,0.3640303611755371,0.2706679105758667},{-0.039472561329603195,0.18126718699932098,0.012379948049783707,-0.19270086288452148,0.34228894114494324,0.12208300083875656,0.1243835985660553,-0.17311298847198486},{0.019075052812695503,0.14282719790935516,0.15823610126972198,-0.1416202187538147,0.43304112553596497,-0.10634846240282059,0.16031084954738617,0.08537177741527557},{0.06507688015699387,-0.46796712279319763,-0.011332932859659195,-0.21851083636283875,0.29547977447509766,0.053097084164619446,-0.1527075469493866,-0.3481895327568054},{-0.25459396839141846,0.16784150898456573,0.025843683630228043,-0.07011472433805466,0.04234950244426727,0.48452335596084595,0.41889700293540955,0.27711451053619385},{0.003255420131608844,-0.146437868475914,-0.25613752007484436,0.2795754373073578,0.30861160159111023,0.34133604168891907,0.37957990169525146,-0.33974000811576843},{-0.15450219810009003,-0.3846515119075775,0.36983010172843933,0.1782403290271759,0.027139635756611824,-0.25797462463378906,0.041401974856853485,-0.3520561158657074},{0.24871045351028442,0.0329730324447155,0.41844940185546875,0.40345054864883423,-0.09937033802270889,0.3358745872974396,0.21037785708904266,-0.3467377722263336},{-0.3722865581512451,0.15263110399246216,-0.3495728075504303,0.4375747740268707,-0.015275822021067142,0.4143272936344147,-0.02514646388590336,0.2445375919342041},{-0.05252552777528763,0.18295477330684662,-0.12367153912782669,-0.11258292198181152,0.0306453425437212,0.16254822909832,0.2731991708278656,-0.014082316309213638},{0.1155303344130516,-0.3800826072692871,-0.35720568895339966,-0.16352762281894684,0.1405138075351715,-0.13355064392089844,0.10513562709093094,-0.13159507513046265},{-0.47745460271835327,-0.37467870116233826,-0.29803845286369324,-0.008752715773880482,-0.051256708800792694,0.23907849192619324,0.15786221623420715,-0.14463159441947937},{-0.1775766909122467,-0.3490191698074341,0.20668812096118927,-0.35076749324798584,-0.011610247194766998,0.02955777756869793,-0.45163583755493164,-0.3228153586387634},{0.07399411499500275,0.2029915452003479,0.11680188030004501,0.21100519597530365,-0.12207961082458496,0.3179745376110077,0.24580247700214386,-0.23069219291210175},{0.07621318101882935,-0.35050496459007263,-0.09880523383617401,-0.038810476660728455,-0.1516042798757553,-0.35531023144721985,0.006341800559312105,-0.32920175790786743},{-0.014803728088736534,-0.006054703611880541,0.09090383350849152,-0.28422752022743225,0.040721360594034195,0.11299478262662888,0.047038666903972626,-0.1660657823085785},{0.11716420203447342,-0.10435105115175247,0.049897201359272,-0.23865436017513275,-0.008437784388661385,-0.010849777609109879,-0.06560127437114716,-0.2811289429664612},{-0.2900037169456482,0.18157987296581268,0.12052363902330399,-0.22384516894817352,-0.4728544354438782,0.00474597979336977,0.09863889962434769,-0.029052814468741417},{0.3135870099067688,0.12589140236377716,-0.45083877444267273,0.13255023956298828,-0.07707152515649796,0.21270008385181427,0.20073555409908295,0.24932944774627686},{0.04840337857604027,-0.09099798649549484,-0.05241962522268295,0.31974920630455017,-0.3356010317802429,-0.08300270140171051,-0.19411495327949524,-0.35838139057159424},{0.23323780298233032,0.09006042778491974,-0.4937075674533844,0.3247160017490387,-0.32121023535728455,-0.35775476694107056,-0.3573651611804962,0.1318102329969406},{0.07820403575897217,0.36015835404396057,-0.33870425820350647,-0.05382620543241501,0.07095395028591156,-0.255567729473114,0.3107990622520447,-0.31461137533187866},{-0.042574912309646606,0.07041436433792114,-0.17542919516563416,-0.13420213758945465,0.03247321397066116,-0.18612632155418396,-0.09881874918937683,-0.15653569996356964},{0.1670391857624054,-0.1862524151802063,-0.07979874312877655,-0.08110082894563675,0.004718162585049868,0.002317100763320923,-0.2014542520046234,0.07878506183624268},{0.36630216240882874,0.04391732066869736,-0.4099116325378418,-0.17075291275978088,-0.2497815191745758,0.10731278359889984,0.2427791953086853,0.066119484603405},{0.4222128987312317,-0.3013966381549835,-0.056098680943250656,-0.01828390173614025,0.10805101692676544,-0.1317795068025589,0.2171279340982437,0.33451762795448303},{-0.20507770776748657,-0.15592093765735626,0.013117041438817978,-0.21998590230941772,0.32828861474990845,-0.26761794090270996,0.052342403680086136,0.093460813164711},{0.2546294629573822,0.035969238728284836,-0.15217387676239014,0.38514193892478943,0.1032404750585556,-0.002244755160063505,-0.016242744401097298,0.051022857427597046}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2352672815322876,0.3955078125,-0.5982952117919922,-0.49180084466934204,-0.25620102882385254,0.0753985121846199,-0.400997132062912,0.5240855813026428},{-0.035824187099933624,0.5655139684677124,-0.21054545044898987,0.4716259241104126,-0.018010476604104042,0.02454976737499237,-0.25122490525245667,0.015583948232233524},{-0.4630877375602722,-0.17742377519607544,-0.16691090166568756,-0.28451719880104065,0.5161659717559814,0.16562168300151825,-0.010342114605009556,0.4489171802997589},{-0.46039021015167236,-0.4160749018192291,0.26803600788116455,0.37735286355018616,-0.5068069696426392,-0.15937913954257965,0.36364662647247314,0.18734441697597504},{-0.24936392903327942,-0.3046918213367462,-0.2677469849586487,-0.26527515053749084,0.3134525716304779,-0.2393176257610321,0.4398876130580902,-0.38207146525382996},{-0.07768458873033524,0.14163541793823242,0.2918998897075653,-0.5272505879402161,0.5353294610977173,-0.29337000846862793,-0.42037051916122437,-0.3141239285469055},{-0.41213518381118774,0.13588044047355652,0.06943128257989883,-0.3133731484413147,-0.02248748205602169,-0.5239405035972595,0.5066840052604675,0.05667765438556671},{-0.3910633325576782,-0.3034025728702545,-0.21998919546604156,-0.46416765451431274,-0.2971649467945099,0.06238662078976631,0.4595269560813904,-0.294897198677063}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.011376000940799713,-0.03969719633460045,-0.012559983879327774,0.03102557733654976,-0.024710185825824738,-0.02111632004380226,-0.09958113729953766,0.010674925521016121};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012040875852108002,-0.0738520696759224,-0.020216824486851692,0.1073041781783104,-0.02648148499429226,0.04738442227244377,-0.03434720262885094,0.030368203297257423};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

