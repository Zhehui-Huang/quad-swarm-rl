#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.23817512392997742,-0.08293046802282333,0.2794789671897888,0.18540115654468536,-0.3128272294998169,0.2682982087135315,-0.08308308571577072,-0.14778517186641693,0.1400633007287979,0.3179596960544586,0.10232129693031311,0.053708404302597046,0.2502628564834595,-0.28638577461242676,0.24108947813510895,-0.043090108782052994},{-0.15592917799949646,-0.3871672451496124,0.34849289059638977,0.15302284061908722,-0.3195531964302063,0.12925612926483154,-0.3876713514328003,-0.007296259514987469,-0.10776520520448685,-0.1952861249446869,0.0415218286216259,-0.24079518020153046,0.009258879348635674,-0.3068729341030121,-0.24590736627578735,0.09890490770339966},{0.015647396445274353,-0.2922494411468506,-0.31927603483200073,0.14782875776290894,0.2163781374692917,0.3859861195087433,0.05950964614748955,-0.031518157571554184,-0.034302398562431335,-0.33442190289497375,-0.3463495075702667,0.6068602204322815,-0.12737558782100677,-0.26191455125808716,-0.3060654103755951,0.1851072907447815},{0.11466500163078308,0.24947473406791687,0.38346266746520996,-0.04454401880502701,-0.4256768822669983,-0.012813241221010685,0.284253865480423,0.05879976227879524,0.3203733265399933,-0.4060179889202118,0.018904808908700943,0.38452139496803284,-0.24547837674617767,0.08223219960927963,0.4313257336616516,-0.4378938376903534},{-0.10239579528570175,-0.039359577000141144,0.3392888605594635,-0.022851482033729553,0.3362296223640442,0.4180338680744171,0.27091220021247864,0.0027853860519826412,0.12867547571659088,0.2432526797056198,0.2809407413005829,-0.3753775656223297,-0.33484113216400146,-0.4001341760158539,0.4496631920337677,0.06901416927576065},{-0.17271281778812408,-0.242195725440979,-0.20527254045009613,-0.11280964314937592,0.20432764291763306,0.16054770350456238,0.07741580903530121,-0.1537218540906906,0.36537784337997437,-0.307375431060791,-0.4246184229850769,0.2092624306678772,0.210636168718338,-0.12656202912330627,-0.02204686962068081,0.05304189771413803},{0.012118929997086525,-0.010619605891406536,0.07991353422403336,-0.38004258275032043,0.24969488382339478,0.059081800282001495,0.10710298269987106,0.4141552448272705,0.3478061556816101,-0.007053793407976627,-0.42143383622169495,0.029697278514504433,-0.17237965762615204,0.1451154351234436,-0.11821885406970978,-0.27764812111854553},{-0.2017667591571808,0.20350633561611176,0.24948489665985107,0.3987199068069458,-0.4374135136604309,-0.07743486016988754,0.4008316695690155,0.40759941935539246,-0.13950228691101074,0.41511353850364685,-0.5029309391975403,-0.34755614399909973,0.3252584934234619,0.20830070972442627,0.2565111517906189,0.269174188375473},{0.34197455644607544,-0.24105767905712128,0.5780145525932312,0.0805974081158638,0.0861801728606224,0.08658017218112946,0.16733282804489136,-0.462695449590683,-0.13063302636146545,-0.4759521484375,-0.13086466491222382,-0.08661600202322006,-0.1381063610315323,0.5987873673439026,0.4438056945800781,-0.2515231668949127},{0.2176857888698578,-0.560678243637085,-0.4752478301525116,-0.18433575332164764,-0.269936740398407,0.2466038018465042,0.28573623299598694,0.20705965161323547,0.49268609285354614,0.21406716108322144,-0.01230852585285902,-0.26686081290245056,-0.045739687979221344,0.3945602476596832,-0.10169341415166855,-0.4635656774044037},{0.1828048676252365,0.2950391471385956,0.44437652826309204,-0.5178377032279968,-0.3045084774494171,0.22168242931365967,0.17332498729228973,0.5025750994682312,-0.30688774585723877,0.007311441004276276,-0.13978035748004913,0.03802693635225296,-0.31312575936317444,-0.22972701489925385,0.36562293767929077,-0.3735438883304596},{-0.0734696015715599,-0.3515976667404175,0.15699203312397003,0.42780041694641113,0.6524966955184937,0.43364307284355164,0.33929386734962463,0.27991777658462524,0.0019991963636130095,0.0449126735329628,0.24914753437042236,-0.31810227036476135,-0.5346844792366028,-0.37769973278045654,0.56993567943573,0.006130373105406761},{-0.28261587023735046,0.46078285574913025,0.028820397332310677,-0.557375967502594,0.09755139797925949,0.0018624565564095974,0.14478953182697296,0.1757839322090149,0.08487629145383835,0.1375187337398529,-0.0061555965803563595,0.14116384088993073,0.47247064113616943,0.32558298110961914,-0.016212480142712593,-0.11895067989826202},{0.10795564204454422,-0.35066938400268555,-0.22414381802082062,-0.12360048294067383,-0.5090550184249878,0.02472260408103466,-0.16202221810817719,-0.21895833313465118,-0.2561098337173462,-0.12093960493803024,-0.4586712419986725,0.006070942152291536,-0.19208717346191406,0.5313231348991394,0.24534110724925995,0.002350035822018981},{-0.0064237117767333984,-0.3514265716075897,-0.2858092486858368,0.23979097604751587,-0.044547755271196365,-0.29245978593826294,0.2752875089645386,-0.07624860107898712,0.06093855947256088,0.24225535988807678,0.06564287841320038,0.16036692261695862,0.22783343493938446,-0.0736457109451294,-0.28314730525016785,0.25265106558799744},{0.34404587745666504,0.0015932278474792838,-0.22878065705299377,-0.22487521171569824,-0.3497677743434906,0.23067452013492584,0.38597291707992554,-0.10619073361158371,0.21547360718250275,0.37125644087791443,-0.17076438665390015,0.08140827715396881,-0.2793974280357361,0.3092923164367676,-0.13494445383548737,-0.010731534101068974},{-0.30400794744491577,-0.2306409627199173,0.20096524059772491,0.19961926341056824,-0.25893259048461914,0.13138899207115173,-0.22757989168167114,-0.1830025613307953,-0.21315182745456696,-0.2747633457183838,-0.08711621910333633,-0.2943819761276245,0.12063882499933243,-0.2835911512374878,0.01256514247506857,-0.2306368052959442},{-0.24834021925926208,0.20721817016601562,-0.35628989338874817,-0.20371854305267334,0.022356906905770302,0.36345916986465454,-0.2080516815185547,-0.23228193819522858,0.15128561854362488,0.20612286031246185,0.34007588028907776,-0.11079475283622742,-0.38315701484680176,0.30284300446510315,0.05817835032939911,-0.40292996168136597}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06051221489906311,-0.02410067990422249,-0.11200004816055298,-0.3360894024372101,0.34841740131378174,0.3067026138305664,0.1008211076259613,0.04980753734707832,-0.14704297482967377,-0.13421861827373505,-0.05933175981044769,0.0880410224199295,0.1845819652080536,0.3992277979850769,0.08030390739440918,0.07011371850967407},{-0.2458515763282776,-0.29381054639816284,-0.07021993398666382,0.10797587782144547,0.24791806936264038,-0.33832523226737976,0.07475567609071732,0.05945359542965889,-0.08517438918352127,0.22954358160495758,-0.26696690917015076,0.3322187662124634,-0.3624076247215271,0.20376986265182495,-0.4473623037338257,-0.3553401827812195},{0.09723740071058273,0.21358440816402435,-0.3572729229927063,-0.49812549352645874,0.14331243932247162,0.4874432384967804,-0.09131065011024475,0.07880213856697083,-0.2432747632265091,-0.3074820935726166,0.015620216727256775,0.34349605441093445,-0.3148450553417206,-0.24623098969459534,0.12065885961055756,-0.07100428640842438},{0.1950710564851761,-0.07938596606254578,0.09783496707677841,0.20423248410224915,-0.4989590644836426,0.00909573957324028,0.08509939908981323,-0.186172753572464,0.30449336767196655,0.38622748851776123,-0.1661730259656906,-0.14775356650352478,-0.4213371276855469,-0.4136475622653961,0.14164824783802032,0.19562311470508575},{-0.15010546147823334,0.1363762468099594,-0.024135345593094826,0.22955851256847382,-0.25531941652297974,0.07649285346269608,0.0037302463315427303,0.11469746381044388,0.29821690917015076,-0.3175516724586487,0.19218242168426514,0.3428088426589966,0.19447627663612366,-0.4489499628543854,0.03293933719396591,-0.018107205629348755},{0.2529078722000122,0.2501404285430908,-0.06489913165569305,0.193197101354599,-0.4659123420715332,-0.4264006018638611,0.2083660066127777,0.27083709836006165,0.1402435302734375,0.33773091435432434,0.22191567718982697,-0.20832735300064087,-0.03787920996546745,-0.18629692494869232,-0.01660037413239479,0.26792675256729126},{-0.0914507508277893,0.28021353483200073,0.2741749882698059,-0.36867159605026245,-0.2572297155857086,0.033088430762290955,-0.31738534569740295,-0.06745374947786331,0.16272756457328796,0.08546075224876404,-0.14778707921504974,-0.18256829679012299,-0.3375840485095978,-0.02774973027408123,0.2222035974264145,0.05086261034011841},{-0.1715559959411621,-0.13179495930671692,-0.4907704293727875,0.27288252115249634,-0.359120637178421,-0.24154804646968842,-0.23088759183883667,-0.4211219251155853,0.12752646207809448,-0.27693766355514526,0.024643603712320328,0.1519174575805664,-0.19231314957141876,0.4313759207725525,-0.0652855634689331,-0.37314876914024353},{-0.3200201392173767,0.2836695611476898,-0.003571017412468791,-0.019635502249002457,0.2779618501663208,-0.2626214027404785,0.3282286822795868,0.14935730397701263,0.3079712986946106,0.29354292154312134,0.2375985085964203,0.3440437912940979,0.1701022833585739,-0.04299966245889664,0.2770722210407257,0.10549061000347137},{0.03493392840027809,-0.2715010643005371,-0.20265518128871918,-0.09111914038658142,0.29189860820770264,-0.18741224706172943,-0.29541921615600586,-0.1827591210603714,0.0846584141254425,-0.3998938798904419,-0.3019446134567261,0.38076260685920715,0.12239836901426315,0.18435177206993103,-0.3771173059940338,0.22756165266036987},{-0.11335432529449463,-0.44043031334877014,0.3286673128604889,0.2914220988750458,0.23088519275188446,0.15052814781665802,0.1829288899898529,-0.15280114114284515,0.23349589109420776,-0.3232278525829315,0.15675175189971924,0.4108341634273529,0.47703462839126587,0.10470474511384964,-0.14666898548603058,0.05646119639277458},{0.07217858731746674,2.640551610966213e-05,0.3685399293899536,-0.007306615822017193,-0.23732684552669525,-0.14986790716648102,0.434325248003006,0.2669292092323303,-0.2630542516708374,-0.22150865197181702,-0.10735487937927246,-0.2703545093536377,-0.03729045391082764,-0.27358198165893555,-0.3945738673210144,0.049814656376838684},{-0.09204207360744476,-0.3232673704624176,0.40411385893821716,-0.19497501850128174,0.34556761384010315,-0.3227749764919281,-0.46066129207611084,0.09719102829694748,0.0951884463429451,0.07883395999670029,-0.32002630829811096,0.11569195985794067,0.10830686241388321,-0.2712392807006836,-0.4245840907096863,0.011625225655734539},{0.322554349899292,-0.3433443307876587,0.4797648787498474,0.06785167753696442,-0.024207916110754013,0.3185408115386963,-0.11017502844333649,-0.2413095235824585,-0.48128578066825867,0.12352969497442245,-0.025958966463804245,-0.379612535238266,-0.08638179302215576,0.196605384349823,0.2861045002937317,0.02724423259496689},{-0.11998622864484787,0.2226656675338745,0.12376471608877182,-0.3930410146713257,-0.211850106716156,0.1907639503479004,0.2974705398082733,-0.23309151828289032,0.1716305911540985,-0.33062371611595154,0.021281911060214043,0.1027398407459259,-0.05625693500041962,0.15333984792232513,-0.029142146930098534,0.09105493128299713},{-0.2609880864620209,0.35926124453544617,-0.4107927978038788,0.37161749601364136,0.18426170945167542,-0.42843207716941833,-0.04678347706794739,-0.09256953001022339,-0.33649659156799316,0.3476417362689972,-0.372333824634552,0.31934985518455505,-0.04616226255893707,-0.22322331368923187,-0.28162193298339844,-0.529780387878418}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.18761299550533295,0.13947506248950958,-0.06517838686704636,-0.020504269748926163,-0.1455794870853424,0.05230779945850372,0.26722094416618347,0.08483439683914185,-0.22183842957019806,-0.15176254510879517,0.16527041792869568,-0.30957460403442383,-0.2522892355918884,0.21481050550937653,0.248888298869133,0.31185951828956604,-0.27955162525177,-0.3044678866863251,-0.2113630473613739,0.08078313618898392,-0.061319347470998764,-0.31038010120391846,-0.19904497265815735,-0.32114243507385254,-0.3041308522224426,0.20825918018817902,-0.1995408535003662,-0.0021955217234790325,0.001131974859163165,-0.03862945735454559,0.2214651256799698,-0.2182467132806778},{0.27599209547042847,0.20664741098880768,0.15833240747451782,-0.13021612167358398,0.14253664016723633,-0.07078416645526886,0.4094807207584381,0.1553182452917099,-0.20140059292316437,-0.10161951929330826,-0.0866229236125946,-0.30348488688468933,-0.18938778340816498,0.2675289213657379,-0.22123757004737854,-0.20021870732307434,-0.008109137415885925,0.24249267578125,-0.3581264913082123,-0.23093809187412262,-0.07578151673078537,0.3011897802352905,0.0783185139298439,-0.0032395224552601576,0.20633646845817566,-0.3627255856990814,-0.022951995953917503,0.13839830458164215,0.1807095855474472,-0.14292961359024048,-0.009628723375499249,0.14340676367282867},{0.11251670122146606,0.03357814624905586,-0.1927468180656433,0.15268221497535706,-0.1961926519870758,-0.20623698830604553,-0.21265770494937897,0.041020963340997696,-0.15508690476417542,0.4405609667301178,-0.3037777543067932,-0.3012084364891052,0.08845529705286026,-0.39579880237579346,-0.18187128007411957,0.10399842262268066,-0.16712769865989685,-0.1526523232460022,0.14277754724025726,-0.11702175438404083,0.2729942202568054,0.2817736864089966,-0.22831591963768005,0.007109703496098518,-0.29123395681381226,0.02883131429553032,0.12423292547464371,-0.1247689351439476,-0.008476728573441505,-0.2881801724433899,-0.19376006722450256,-0.06785587221384048},{0.4372117817401886,0.0515570342540741,0.17206144332885742,-0.1335521638393402,-0.28214898705482483,-0.04955105856060982,-0.20256875455379486,0.2870752513408661,0.2698732018470764,-0.3384574353694916,-0.07635347545146942,0.35915622115135193,0.10886716097593307,-0.09903182089328766,-0.21373099088668823,0.2549121677875519,-0.29291874170303345,0.22072097659111023,0.06393328309059143,0.10929984599351883,-0.05024358630180359,-0.15545786917209625,0.29256391525268555,0.14593543112277985,0.19713056087493896,-0.399852454662323,0.29670795798301697,-0.22500520944595337,-0.0675780400633812,0.164886474609375,-0.19622479379177094,0.194304957985878},{-0.04380544647574425,-0.12731227278709412,-0.09927656501531601,0.15656334161758423,0.22099795937538147,-0.2368975728750229,-0.4424411654472351,-0.09798453748226166,-0.05006764829158783,-0.2581712305545807,0.08120724558830261,0.2620956599712372,0.012735440395772457,-0.13803710043430328,-0.13200801610946655,0.12041085958480835,-0.07069076597690582,-0.0902872085571289,-0.32623255252838135,-0.17741607129573822,-0.0857984870672226,-0.45874491333961487,0.13044774532318115,0.18863064050674438,-0.10833902657032013,0.3535829186439514,-0.21420635282993317,0.1210678368806839,0.3592364192008972,0.39765432476997375,-0.11033058166503906,0.42105627059936523},{-0.35629552602767944,0.022098194807767868,-0.29897499084472656,-0.08585706353187561,-0.2389521449804306,0.25996071100234985,0.2482883334159851,0.01997186616063118,0.20813073217868805,0.29938793182373047,0.3536188006401062,-0.2922300100326538,-0.3124903738498688,0.17570526897907257,0.3545244336128235,-0.3115105926990509,-0.16635198891162872,-0.2646465599536896,0.18267309665679932,0.1145210713148117,0.07802771031856537,0.21459437906742096,0.10529070347547531,-0.08110933750867844,-0.41681936383247375,0.41975584626197815,-0.1385306417942047,0.22522827982902527,0.3829685151576996,0.11097421497106552,0.04221218079328537,0.0010459116892889142},{0.16082020103931427,-0.13941822946071625,-0.14396223425865173,-0.34659960865974426,-0.03580046072602272,0.23194345831871033,0.33622848987579346,0.16272473335266113,0.053725145757198334,0.39673182368278503,-0.013280747458338737,-0.04435945674777031,-0.4311862885951996,-0.14291991293430328,-0.14987003803253174,0.14689306914806366,-0.29891085624694824,-0.21827977895736694,0.18121874332427979,-0.07934858649969101,-0.13820146024227142,-0.12304932624101639,-0.22727160155773163,-0.2256566882133484,0.13125725090503693,-0.23425811529159546,-0.09768742322921753,-0.22099025547504425,0.3025457561016083,0.06843169778585434,-0.19238819181919098,-0.315250962972641},{0.02995762974023819,0.18900641798973083,0.056138209998607635,-0.06305695325136185,0.12236173450946808,-0.31254899501800537,-0.08840911090373993,-0.15410688519477844,-0.05183320492506027,-0.22325950860977173,-0.31489595770835876,-0.07844861596822739,-0.11776000261306763,0.026050152257084846,-0.12802806496620178,0.4186249375343323,-0.02108960784971714,-0.1525319367647171,0.10739254206418991,0.3431547284126282,-0.1449463665485382,-0.20601870119571686,0.2832425534725189,0.0983157604932785,-0.029604651033878326,-0.34227633476257324,-0.31396055221557617,-0.2855357527732849,-0.35495850443840027,-0.28898951411247253,0.05177108198404312,-0.34799057245254517},{0.11219872534275055,0.4076007604598999,-0.2719286382198334,-0.3835543394088745,-0.24446038901805878,0.15211378037929535,0.07939007133245468,0.13663272559642792,0.03888678923249245,-0.31383761763572693,-0.12349482625722885,0.3303585648536682,-0.2994500398635864,-0.16677099466323853,0.22749021649360657,-0.2452794760465622,0.2888205349445343,0.19488903880119324,0.40309643745422363,0.04797961190342903,0.13512490689754486,0.1602303385734558,0.3044236898422241,-0.12860240042209625,0.41983842849731445,-0.27101102471351624,0.1802552193403244,0.3971513509750366,-0.3012253940105438,0.2025882750749588,0.07135018706321716,0.11651190370321274},{-0.17305146157741547,0.09116230905056,-0.27002155780792236,-0.13687042891979218,0.16333769261837006,-0.21652163565158844,0.08849550783634186,-0.01577393338084221,0.191079244017601,-0.00736840208992362,-0.3173374533653259,-0.30449149012565613,-0.32985594868659973,-0.07688701897859573,-0.2723621428012848,0.10015895217657089,0.021792886778712273,-0.24049903452396393,0.22225657105445862,0.11579784750938416,0.05607597157359123,-0.063228540122509,0.2898685336112976,-0.1703033149242401,0.3087400496006012,0.10629045963287354,-0.28720149397850037,-0.029907885938882828,-0.022862693294882774,0.1158161610364914,-0.18539175391197205,0.08581850677728653},{0.10319449752569199,0.09712108224630356,0.17426346242427826,-0.3101687729358673,-0.38894808292388916,-0.1964946836233139,-0.2629355192184448,0.05172453820705414,-0.3257540464401245,0.4673219621181488,0.2146088182926178,-0.23249231278896332,-0.4430435001850128,-0.08376084268093109,-0.14194531738758087,-0.08513744175434113,0.17848052084445953,-0.16105526685714722,0.31085485219955444,-0.1332613080739975,-0.20072947442531586,0.05858709663152695,0.2532512843608856,0.20550976693630219,0.17245930433273315,-0.17393852770328522,0.05493215098977089,-0.04603245481848717,-0.05183161422610283,0.003135430859401822,-0.0021006984170526266,0.1077234297990799},{-0.15356917679309845,-0.09392330795526505,0.24635162949562073,0.2671125829219818,0.29067614674568176,0.006219652947038412,0.06619647145271301,-0.19973650574684143,-0.06348871439695358,-0.31146034598350525,0.285842627286911,-0.200814351439476,-0.17393507063388824,-0.19153238832950592,0.27055856585502625,-0.005129301454871893,0.03252459689974785,0.04916824400424957,0.4007497727870941,0.06591252982616425,-0.21089869737625122,0.24675990641117096,0.1042017713189125,-0.07476305961608887,0.26488611102104187,-0.13504329323768616,-0.14260809123516083,0.2448364794254303,0.1452404111623764,0.042983528226614,-0.24232909083366394,-0.23054984211921692},{0.3562503457069397,-0.24684275686740875,0.02785062976181507,-0.2611841559410095,-0.048769719898700714,-0.16992881894111633,0.02893967181444168,0.1779242604970932,0.20814743638038635,0.06537994742393494,0.20323289930820465,0.3400892913341522,-0.4048287272453308,-0.42685967683792114,-0.0014572573127225041,-0.26567542552948,-0.28166812658309937,-0.3633021414279938,0.3883890211582184,-0.20690451562404633,0.4051114320755005,-0.16117873787879944,0.055917318910360336,0.1624433845281601,0.14758820831775665,-0.16002829372882843,0.16061431169509888,0.009339869022369385,0.1392831802368164,0.06973563879728317,-0.28489387035369873,0.06488832831382751},{0.2507895231246948,-0.06671739369630814,-0.01694362610578537,0.38224858045578003,-0.08211661875247955,-0.20372873544692993,-0.038087669759988785,0.14403171837329865,0.21258634328842163,0.2700618803501129,0.10526562482118607,-0.11935911327600479,0.07411497086286545,0.21427054703235626,-0.1322454959154129,0.10568521916866302,0.22601908445358276,-0.23228077590465546,0.08943893760442734,-0.35345426201820374,0.2861011028289795,0.13615217804908752,-0.11528604477643967,0.214600071310997,0.2440422773361206,0.09172157198190689,0.12035664170980453,0.05721709504723549,0.08939170092344284,-0.1501903235912323,-0.006454084068536758,0.3712642192840576},{0.022534336894750595,-0.1890472024679184,-0.0652424618601799,0.08440934121608734,-0.29923683404922485,0.03859616443514824,0.07900061458349228,-0.21138209104537964,-0.21729204058647156,0.00362525531090796,0.2161203771829605,0.14650842547416687,0.03313573822379112,0.2461516559123993,-0.020749878138303757,-0.029831845313310623,-0.22353143990039825,0.29441964626312256,-0.09852040559053421,-0.22186222672462463,-0.2342624068260193,-0.036194607615470886,0.18294657766819,0.02844560332596302,-0.044362105429172516,-0.10359657555818558,-0.17100074887275696,0.26323243975639343,0.08155225217342377,-0.19865168631076813,0.27737748622894287,0.10869850963354111},{0.17141003906726837,-0.1937463879585266,-0.01375134103000164,-0.19865289330482483,-0.041180532425642014,0.16730278730392456,0.06602215021848679,0.2933062016963959,-0.15930455923080444,0.004962447099387646,0.26034146547317505,0.10357451438903809,0.035376276820898056,-0.09918925911188126,0.004464913625270128,0.21706120669841766,-0.37358686327934265,-0.20548689365386963,-0.02777091972529888,0.07161877304315567,0.03696921095252037,0.27431121468544006,0.19888147711753845,0.1616099327802658,0.04848409444093704,0.18065597116947174,-0.010198849253356457,-0.04770992696285248,0.12062820792198181,-0.13622230291366577,-0.25804832577705383,0.29714661836624146},{0.11955547332763672,0.010929826647043228,-0.35004693269729614,0.20971378684043884,0.09071163833141327,-0.0008414358017034829,0.27646327018737793,0.038269542157649994,0.1274210810661316,-0.17597119510173798,0.2210959643125534,-0.2354063093662262,-0.4105890691280365,0.26946336030960083,0.10114801675081253,-0.019945219159126282,0.05384168028831482,-0.10502932965755463,-0.16441237926483154,-0.0218796543776989,-0.029275087639689445,0.19969281554222107,0.06402134150266647,-0.21535295248031616,-0.12574437260627747,-0.15595130622386932,0.03522372990846634,0.36432433128356934,0.26705363392829895,-0.142380952835083,0.20922137796878815,0.23678728938102722},{-0.08572609722614288,-0.037471216171979904,-0.07973678410053253,-0.07516594976186752,-0.2109687626361847,-0.016183219850063324,0.24314233660697937,0.15695959329605103,0.16565097868442535,-0.014644809998571873,0.19088976085186005,-0.0312989242374897,0.23234926164150238,0.23368240892887115,0.15578299760818481,-0.09817620366811752,0.15499724447727203,0.21002325415611267,0.200375497341156,0.022744540125131607,0.1560787409543991,0.2818933129310608,0.05501711368560791,0.15503650903701782,-0.031131654977798462,-0.05058648809790611,-0.16470111906528473,-0.22323274612426758,0.14018985629081726,-0.2722266912460327,0.06299153715372086,-0.06841055303812027},{-0.36288726329803467,0.05057103559374809,-0.3847510814666748,-0.3121332824230194,0.01119079440832138,-0.006735129281878471,0.12925900518894196,-0.19604016840457916,0.04541533440351486,0.3818044066429138,0.04231712967157364,-0.24981193244457245,0.02272498980164528,-0.20215599238872528,-0.2994706332683563,-0.013784647919237614,-0.20118644833564758,0.0924592912197113,-0.09141106903553009,-0.03395165875554085,-0.2757052481174469,0.15383093059062958,0.13267782330513,0.03705863654613495,-0.10216464847326279,0.3703506290912628,0.0674593523144722,-0.20627263188362122,-0.17306862771511078,0.001914909458719194,-0.22119970619678497,-0.23816150426864624},{0.008149782195687294,-0.250837117433548,-0.27401143312454224,-0.05043254792690277,-0.31216639280319214,-0.15040811896324158,0.1800566464662552,-0.2717511057853699,-0.22737504541873932,0.17511509358882904,0.1742580533027649,0.0949353277683258,0.11974520981311798,-0.13425981998443604,0.2727556824684143,-0.24072013795375824,0.10509813576936722,0.2686728835105896,0.042731303721666336,0.2952890694141388,0.012507367879152298,-0.1057523712515831,-0.2968272268772125,0.2420063614845276,-0.10167036950588226,-0.16750933229923248,0.11685343086719513,0.04588690772652626,-0.13863128423690796,-0.32394808530807495,-0.04081683233380318,-0.20066867768764496},{0.2122359275817871,0.14438846707344055,-0.08788739144802094,0.22013969719409943,-0.28234049677848816,0.09338878095149994,-0.09830959886312485,-0.2153560370206833,-0.11312264204025269,0.2443452775478363,-0.32134056091308594,-0.14015953242778778,0.002807025332003832,-0.22652004659175873,-0.35901448130607605,-0.22083500027656555,-0.13698036968708038,-0.3416880667209625,-0.2628953456878662,0.24668097496032715,0.17765918374061584,0.07371523976325989,-0.3469240665435791,0.3210790753364563,0.12202814221382141,0.3024665415287018,-0.2980709373950958,-0.12134207040071487,0.11886864900588989,-0.22519877552986145,0.08880293369293213,0.17349757254123688},{-0.04698517546057701,-0.3073430061340332,-0.03761468827724457,-0.3168325424194336,-0.03658163174986839,0.29211923480033875,0.2176222950220108,0.0295438002794981,-0.09406808763742447,0.010565814562141895,-0.19484242796897888,0.09036072343587875,0.11675138026475906,0.09193304181098938,0.09586869925260544,0.0676802396774292,-0.05612245947122574,0.16630615293979645,-0.13457544147968292,0.17092114686965942,0.17683270573616028,0.2749408483505249,-0.0680951252579689,-0.22282125055789948,0.17534422874450684,0.15676073729991913,0.2573191523551941,0.17315573990345,-0.001757972058840096,0.10105741769075394,0.009761945344507694,-0.12966251373291016},{0.03747499734163284,-0.2234233021736145,0.29098644852638245,0.020534059032797813,0.2889629900455475,-0.07830318808555603,-0.1297185719013214,-0.16505376994609833,0.1617361605167389,-0.03974541649222374,0.03456937521696091,0.03277689218521118,-0.23761537671089172,0.05248882248997688,-0.1286925971508026,-0.2537120580673218,-0.07541632652282715,-0.05524881184101105,0.19467945396900177,0.26010993123054504,0.0463210754096508,0.010011043399572372,0.14633342623710632,0.3565964698791504,-0.13524194061756134,-0.1009146049618721,0.15316973626613617,-0.1284400224685669,-0.1891389936208725,-0.2470720112323761,0.27268606424331665,-0.003357993671670556},{0.222444087266922,-0.09815420210361481,0.06258056312799454,0.09735032171010971,-0.017599845305085182,0.0428815595805645,-0.2343493402004242,0.3300979733467102,-0.09912548214197159,-0.03821434825658798,0.09355958551168442,-0.2914375960826874,0.04824414104223251,-0.05046117678284645,-0.13797307014465332,0.37562456727027893,-0.06888578087091446,-0.1765364557504654,0.030495014041662216,0.04050220921635628,-0.18968725204467773,0.18617691099643707,0.19174955785274506,0.2700352668762207,-0.23628917336463928,0.09684088081121445,-0.07374944537878036,0.07853256165981293,-0.3154113292694092,0.26494377851486206,-0.06070511043071747,0.018753165379166603}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.29883843660354614,-0.13941602408885956,0.1655537337064743,-0.19826075434684753},{0.2313874512910843,-0.2784123718738556,0.29602810740470886,0.2712136209011078},{-0.41280725598335266,0.03185734897851944,0.20267508924007416,-0.04344663396477699},{0.3020678162574768,0.5553414225578308,0.349467933177948,0.01119023747742176},{-0.3604317009449005,0.23578481376171112,-0.2986892759799957,0.10941057652235031},{0.0026733125559985638,-0.16336533427238464,0.0539696179330349,0.4786713719367981},{-0.09726465493440628,-0.21814006567001343,-0.4862481355667114,0.08591131120920181},{-0.13452742993831635,-0.37985602021217346,0.20074671506881714,-0.056060079485177994},{-0.1560232788324356,0.23745621740818024,-0.07651824504137039,-0.14674219489097595},{0.38825082778930664,-0.034294724464416504,-0.2070617824792862,-0.2761535048484802},{0.2523617148399353,-0.235411137342453,0.35577815771102905,0.3262900114059448},{-0.13517029583454132,0.007702150382101536,0.5475396513938904,-0.12148245424032211},{-0.3965420126914978,0.28896892070770264,-0.06553339213132858,-0.11539870500564575},{-0.209649920463562,0.024236656725406647,-0.2994976341724396,0.13299643993377686},{0.1965576559305191,-0.07881982624530792,0.24991686642169952,0.16735462844371796},{-0.1547345370054245,-0.30351847410202026,-0.1483464390039444,-0.12035970389842987},{-0.44063711166381836,0.0649082362651825,-0.08283441513776779,0.39979273080825806},{-0.37672290205955505,-0.16530752182006836,-0.26129069924354553,0.28270769119262695},{-0.1031859815120697,-0.20213642716407776,0.4880980849266052,0.0745275691151619},{-0.19399939477443695,-0.2135474979877472,-0.018522560596466064,-0.20352332293987274},{0.2033361792564392,0.17686788737773895,0.16582824289798737,-0.23596733808517456},{-0.014320199377834797,-0.37445691227912903,-0.25211843848228455,0.416088342666626},{0.3181378245353699,-0.22034485638141632,0.2478843629360199,0.0659443587064743},{-0.3669418394565582,-0.08500076830387115,-0.28883132338523865,-0.4166088402271271},{-0.3327348232269287,-0.22312550246715546,0.06371916830539703,-0.09546758234500885},{0.31313493847846985,0.27575671672821045,-0.1446153223514557,0.09734874218702316},{0.16978943347930908,-0.22322078049182892,0.29492607712745667,0.09908337891101837},{-0.07958673685789108,-0.20214056968688965,-0.010007353499531746,0.3968566358089447},{0.18888314068317413,0.09993864595890045,0.04755218327045441,0.042463839054107666},{-0.2286931574344635,0.12355773150920868,0.3570762276649475,-0.00823177956044674},{-0.20856794714927673,-0.16423651576042175,0.05891117826104164,0.3018500506877899},{0.24411620199680328,0.2655910551548004,0.3562544882297516,-0.0649409368634224}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.010735585354268551,-0.013815510086715221,0.0007448573596775532,0.05920770764350891,0.021112870424985886,-0.07509858906269073,-0.024733055382966995,0.07021763920783997,-0.08545318990945816,-0.04567846283316612,-0.001866286271251738,-0.024350481107831,-0.042948611080646515,0.05739760398864746,-0.018615713343024254,-0.03982369229197502};
static const float actor_encoder_self_encoder_2_bias[16] = {0.001465052948333323,-0.012753309682011604,-0.018567539751529694,0.004577575717121363,-0.03991103172302246,0.036142218858003616,-0.03516731411218643,-0.02067895047366619,0.030725305899977684,-0.05202023684978485,0.008730655536055565,-0.020775770768523216,-0.010226531885564327,-0.04331492260098457,0.021252872422337532,-0.04702639952301979};
static const float actor_encoder_feed_forward_0_bias[32] = {0.013062583282589912,0.026720263063907623,-0.0022478897590190172,0.003914607688784599,-0.013432430103421211,0.01973414607346058,-0.03458503633737564,-0.009472226724028587,0.007491595111787319,-0.036118995398283005,4.491535946726799e-05,0.03320232033729553,0.02979242615401745,0.005864419043064117,0.03209191933274269,-0.06036059558391571,0.012417597696185112,-0.008082505315542221,0.02463505230844021,-0.031504929065704346,-0.010366251692175865,0.005104479845613241,-0.008493411354720592,-0.03670632094144821,-0.03924093022942543,0.006746841128915548,0.011723840609192848,0.018041634932160378,-0.01759439706802368,0.03785579279065132,0.04030180722475052,0.004275104496628046};
static const float action_parameterization_distribution_linear_bias[4] = {-0.009460804052650928,0.026163488626480103,0.017900574952363968,0.02602202259004116};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.35820272564888,-0.32879409193992615,-0.1855340152978897,0.1626058667898178,-0.2895127236843109,0.08363772183656693,-0.29189515113830566,0.012701991014182568},{0.20682212710380554,0.16853083670139313,0.37971508502960205,0.3581307828426361,-0.17355263233184814,-0.39064425230026245,0.35484379529953003,0.42033645510673523},{0.0778091624379158,0.22399789094924927,0.11454948782920837,-0.056210365146398544,0.31944629549980164,0.1848774552345276,0.03727120906114578,0.2891778349876404},{0.10105312615633011,-0.31560710072517395,0.33837881684303284,-0.19421638548374176,-0.23511101305484772,0.08803877979516983,0.35533764958381653,0.28543394804000854},{-0.2855032682418823,-0.05733548104763031,-0.0514424666762352,-0.3291175663471222,0.14577186107635498,0.12708266079425812,0.37671446800231934,0.29883307218551636},{-0.08948937058448792,0.2347155660390854,-0.01977340318262577,-0.2752026617527008,0.3437044322490692,0.12213841080665588,0.1333497315645218,-0.15183129906654358},{-0.00980902649462223,0.22381913661956787,0.12191779911518097,-0.2249700278043747,0.4324795603752136,-0.123602494597435,0.19879740476608276,0.12010572105646133},{0.08452705293893814,-0.3342083692550659,-0.08698509633541107,-0.3096860349178314,0.2552887499332428,-0.021156540140509605,-0.13368432223796844,-0.30301743745803833},{-0.2580772936344147,0.2285371869802475,-0.09430994093418121,-0.1646004617214203,-0.09750521928071976,0.4093762934207916,0.40642234683036804,0.25579994916915894},{0.0005230301758274436,-0.09629198163747787,-0.3390725553035736,0.21528813242912292,0.22000540792942047,0.30111971497535706,0.37593021988868713,-0.34200769662857056},{-0.16058039665222168,-0.34923651814460754,0.3197198808193207,0.1373893767595291,-0.0313689224421978,-0.27091896533966064,0.09363995492458344,-0.34481126070022583},{0.23345054686069489,0.06551860272884369,0.3630431890487671,0.3683773875236511,-0.15710274875164032,0.3175841271877289,0.28712931275367737,-0.3439262807369232},{-0.39361289143562317,0.16374008357524872,-0.3891981244087219,0.4016273319721222,-0.05720461159944534,0.41239094734191895,0.11007177084684372,0.2661992013454437},{-0.045887190848588943,0.21361660957336426,-0.15470778942108154,-0.128734290599823,-0.0014567988691851497,0.09953149408102036,0.4126635789871216,0.039251700043678284},{0.14905846118927002,-0.29157891869544983,-0.34166690707206726,-0.15694023668766022,0.14580193161964417,-0.22980014979839325,0.2537613809108734,-0.03081952966749668},{-0.42823508381843567,-0.3029518127441406,-0.2174874097108841,0.03512314334511757,0.022268755361437798,0.15857753157615662,0.3561650812625885,0.010958993807435036},{-0.13870754837989807,-0.2764453887939453,0.2681387662887573,-0.319967657327652,0.04758777096867561,-0.023198137059807777,-0.3168911933898926,-0.18721449375152588},{0.06834792345762253,0.2201419621706009,0.1780920922756195,0.20417076349258423,-0.07647904008626938,0.31644392013549805,0.38416340947151184,-0.14513501524925232},{0.06133391335606575,-0.3405604064464569,-0.050410643219947815,-0.06486141681671143,-0.13325272500514984,-0.35085585713386536,0.15218991041183472,-0.2664225399494171},{-0.039161067456007004,-0.00639301585033536,0.14653420448303223,-0.3150631785392761,0.058522727340459824,0.11184318363666534,0.19240175187587738,-0.09208229929208755},{0.08442710340023041,-0.11432898789644241,0.10097091645002365,-0.27394962310791016,0.002604702254757285,-0.003759656334295869,0.09391511231660843,-0.22160831093788147},{-0.3337545394897461,0.17383325099945068,0.19242745637893677,-0.24622845649719238,-0.4590524733066559,0.021130600944161415,0.2744634449481964,0.03174504265189171},{0.2683931291103363,0.09032266587018967,-0.3405969440937042,0.12670323252677917,-0.028897881507873535,0.2485869973897934,0.38836905360221863,0.3292292654514313},{-0.03407929465174675,-0.17268070578575134,0.0808182880282402,0.3134728968143463,-0.264739990234375,-0.01972578652203083,-0.007825012318789959,-0.2918179929256439},{0.20779654383659363,0.07407588511705399,-0.3986217677593231,0.3344895541667938,-0.27104508876800537,-0.3319665193557739,-0.25708895921707153,0.21361006796360016},{0.04378163069486618,0.3587799072265625,-0.27583420276641846,-0.06717823445796967,0.09145165979862213,-0.2446637898683548,0.40737220644950867,-0.25858771800994873},{-0.07448646426200867,0.06719497591257095,-0.15549424290657043,-0.1682489812374115,0.024487534537911415,-0.1813947707414627,-0.015157063491642475,-0.11992992460727692},{0.14410622417926788,-0.1897435039281845,-0.04426969587802887,-0.11071079969406128,0.011697354726493359,0.01099704671651125,-0.12206820398569107,0.11730612069368362},{0.35822778940200806,0.024736501276493073,-0.37642332911491394,-0.20174109935760498,-0.2339865267276764,0.11060109734535217,0.3056682050228119,0.11335764080286026},{0.3939777612686157,-0.3398665189743042,-0.0072536831721663475,-0.04871199280023575,0.1361270695924759,-0.11822720617055893,0.2830037474632263,0.372986376285553},{-0.29078149795532227,-0.22127002477645874,0.051696114242076874,-0.29293134808540344,0.33145636320114136,-0.21992476284503937,0.13355323672294617,0.0732821598649025},{0.08920738846063614,-0.049585118889808655,-0.15810652077198029,0.25740328431129456,0.042377520352602005,0.08038759976625443,0.04757317528128624,-0.05070161074399948}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23839476704597473,0.43273818492889404,-0.6069269180297852,-0.49359130859375,-0.3150457441806793,0.04270576313138008,-0.4542762339115143,0.5214866995811462},{-0.018239866942167282,0.5439015626907349,-0.20393316447734833,0.5859967470169067,-0.007766798138618469,0.09621655195951462,-0.2459663599729538,0.07891638576984406},{-0.4669378995895386,-0.19448314607143402,-0.1522291898727417,-0.16198432445526123,0.5488966107368469,0.2427976280450821,0.04096214473247528,0.5066149830818176},{-0.4689796566963196,-0.4878515899181366,0.37831512093544006,0.349044531583786,-0.5242819786071777,-0.18232528865337372,0.5057588815689087,0.27958789467811584},{-0.289298415184021,-0.28421416878700256,-0.3470132052898407,-0.2685985863208771,0.31919074058532715,-0.2648666799068451,0.5026519894599915,-0.45858272910118103},{-0.02604992687702179,0.2111712098121643,0.3371586203575134,-0.6349273324012756,0.5125735402107239,-0.32498714327812195,-0.4741849899291992,-0.3524666726589203},{-0.42667022347450256,0.18876822292804718,0.07988794893026352,-0.42598649859428406,-0.040878236293792725,-0.5748574137687683,0.5052059888839722,0.0047550564631819725},{-0.4489085078239441,-0.2676995098590851,-0.22645670175552368,-0.32686319947242737,-0.33457767963409424,0.16422973573207855,0.6172324419021606,-0.36305877566337585}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0392928421497345,-0.03284766897559166,-0.002633154159411788,0.004825857933610678,-0.031077153980731964,-0.0059052929282188416,0.014036780223250389,0.04472516104578972};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.003652166575193405,-0.0171420406550169,-0.005948470905423164,-0.002656414872035384,-0.0419686958193779,0.001428913208656013,-0.03470155969262123,-0.0207973662763834};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

