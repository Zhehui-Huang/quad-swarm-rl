#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.32536089420318604,0.06493409723043442,0.020366763696074486,0.24478702247142792,0.3513191342353821,-0.23760299384593964,-0.2919738292694092,0.1208789274096489,0.35507169365882874,-0.2859228253364563,0.45511314272880554,0.0631161630153656,0.27027764916419983,0.12410787492990494,-0.3084646463394165,0.022160455584526062},{-0.303852379322052,-0.19168049097061157,-0.30006536841392517,-0.10445661097764969,0.20108063519001007,0.3686158359050751,0.15573690831661224,0.005023805424571037,0.14756838977336884,0.22496365010738373,-0.12589672207832336,0.004173737019300461,-0.09278196096420288,0.11828294396400452,0.2730567455291748,-0.23571240901947021},{0.013826976530253887,0.26076048612594604,0.2135351449251175,0.2700737714767456,0.05829773470759392,-0.2453446239233017,0.7646068334579468,-0.2326393574476242,-0.15844567120075226,0.018847210332751274,-0.013134310953319073,-0.2364524006843567,0.2818496823310852,0.5857586860656738,-0.4794800877571106,0.12398931384086609},{0.18357452750205994,-0.14976070821285248,-0.1461278647184372,-0.03998306021094322,-0.20864909887313843,0.08140474557876587,-0.0631169006228447,-0.22064578533172607,-0.008361082524061203,-0.12952890992164612,0.6100802421569824,-0.23093281686306,-0.349604070186615,-0.20117837190628052,0.22638152539730072,-0.07057928293943405},{-0.2389208823442459,0.011017177253961563,0.2208462655544281,-0.47979024052619934,0.5068284869194031,0.23225879669189453,0.2309226244688034,-0.19886626303195953,-0.20000708103179932,0.2731311023235321,-0.0695083811879158,-0.44861066341400146,0.012781895697116852,-0.20635934174060822,0.4792223572731018,-0.020162072032690048},{-0.041377823799848557,-0.11286674439907074,-0.06482979655265808,-0.07120019197463989,0.09637277573347092,-0.24409042298793793,0.5968210697174072,-0.31166353821754456,-0.21097956597805023,-0.20097748935222626,0.18619392812252045,0.06783479452133179,0.3410552144050598,0.042625777423381805,0.3184584081172943,0.25591516494750977},{-0.20221006870269775,0.2707313299179077,-0.044884178787469864,0.10342135280370712,-0.3120119273662567,-0.10969928652048111,-0.09451866149902344,-0.015112430788576603,0.3255603015422821,0.3384535312652588,-0.2699353098869324,-0.13483795523643494,0.28865060210227966,-0.006966044660657644,-0.13529108464717865,0.2784813344478607},{-0.33100247383117676,0.163183331489563,0.04518866539001465,-0.2869371473789215,0.3946409821510315,-0.2529970705509186,-0.30873903632164,-0.46504077315330505,-0.07417873293161392,-0.2256496399641037,0.5664049386978149,0.14201705157756805,0.0412411242723465,0.438371866941452,0.0403885617852211,0.6089103817939758},{0.243533656001091,0.1345023512840271,-0.1628529131412506,0.05679633468389511,-0.5958524346351624,-0.5801208019256592,0.17846105992794037,-0.596925675868988,-0.057182859629392624,-0.12493805587291718,0.30825918912887573,-0.574898362159729,-0.5217248797416687,0.15596862137317657,0.05927327647805214,-0.2437232881784439},{0.629317581653595,-0.802700400352478,-0.35932454466819763,0.11347682774066925,0.1836932748556137,-0.31648755073547363,-0.05626877769827843,-0.2054499238729477,-0.35681650042533875,-0.004496237263083458,-0.3217185437679291,-0.3235018253326416,0.6188635230064392,-0.2915436327457428,-0.7070212364196777,-0.26686933636665344},{0.24612168967723846,0.36700066924095154,-0.13817983865737915,0.0917976051568985,0.04656428471207619,-0.21459756791591644,-0.15951086580753326,0.11706357449293137,-0.05990779027342796,0.24338656663894653,0.2212805151939392,0.24260079860687256,-0.12163969874382019,0.22886179387569427,0.008994465693831444,-0.2801920771598816},{-0.40779030323028564,0.24525801837444305,0.5393615365028381,-0.7820602655410767,0.04066135361790657,0.10054518282413483,0.15421633422374725,0.2961876392364502,0.33220282196998596,0.4206370413303375,0.43352922797203064,-0.3374059796333313,0.3065904676914215,-0.2135094702243805,0.046605367213487625,-0.20205722749233246},{0.18296343088150024,-0.2799072861671448,-0.26778149604797363,0.3410765826702118,-0.21991808712482452,-0.2925546169281006,-0.06854090094566345,0.34118887782096863,0.20783962309360504,-0.12004079669713974,-0.321732759475708,0.3096560835838318,0.4135478734970093,0.2966262996196747,-0.1837412565946579,0.6145602464675903},{0.24435019493103027,0.2681097090244293,-0.34288695454597473,0.09398910403251648,-0.07601843029260635,-0.15182988345623016,-0.2447158247232437,0.14907434582710266,-0.3341220021247864,-0.38153979182243347,-0.08284264802932739,0.08301037549972534,-0.592362642288208,-0.06210694834589958,-0.28528329730033875,-0.14428040385246277},{0.10847647488117218,0.5948057770729065,0.458915650844574,-0.44732776284217834,-0.31266385316848755,0.25675442814826965,-0.04348886013031006,0.034596845507621765,0.5144996643066406,0.35413700342178345,-0.17967113852500916,0.11216780543327332,-0.1483801305294037,-0.32197991013526917,0.15926937758922577,-0.33140212297439575},{-0.3508669435977936,-0.07205253839492798,-0.026152588427066803,0.23954758048057556,-0.033742647618055344,0.038396332412958145,-0.15263867378234863,-0.06909739226102829,-0.3878973424434662,-0.09449638426303864,0.2781868278980255,0.109143927693367,-0.19514930248260498,-0.21933485567569733,-0.3904421627521515,-0.12224312871694565},{-0.31568965315818787,0.14414428174495697,-0.257113516330719,0.008301536552608013,-0.11842070519924164,0.3294680118560791,0.3518837094306946,0.1361035704612732,0.24864956736564636,-0.2261146605014801,-0.06674665957689285,-0.11118235439062119,-0.006887010298669338,0.0614544115960598,-0.014567472040653229,-0.14738185703754425},{0.14861851930618286,-0.47279077768325806,0.1523953229188919,0.20637290179729462,0.004277427215129137,0.28928840160369873,0.3151661157608032,0.16023236513137817,-0.13741175830364227,-0.2771294414997101,-0.11683087795972824,-0.08143012225627899,-0.11366991698741913,-0.37599894404411316,0.06482038646936417,0.017543843016028404}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15735891461372375,0.31202641129493713,0.3575034439563751,-0.08827853947877884,-0.2140120565891266,0.07881657779216766,0.07103463262319565,0.2563823461532593,-0.03941374644637108,0.2762208878993988,0.49653831124305725,-0.3610467314720154,-0.12292115390300751,0.0813724622130394,0.030233507975935936,-0.04398579150438309},{-0.5711979866027832,0.19611871242523193,-0.32000625133514404,0.2500818073749542,0.35060781240463257,-0.15809927880764008,-0.36313068866729736,-0.2746860682964325,0.3241042494773865,0.2985406517982483,-0.08497485518455505,0.2686055600643158,-0.3548186123371124,0.15452156960964203,-0.24596025049686432,0.4609481692314148},{-0.40991348028182983,0.19781090319156647,-0.3816218376159668,0.017176764085888863,-0.4084804356098175,-0.31049492955207825,-0.12499503046274185,0.009898276999592781,-0.2288365215063095,0.353882372379303,0.2134060263633728,-0.07562611997127533,0.2523295283317566,-0.35169535875320435,-0.05369183421134949,-0.004882740788161755},{0.26878753304481506,-0.22245150804519653,0.09238617867231369,0.44525283575057983,-0.44889816641807556,-0.367037832736969,0.28084197640419006,0.10932315140962601,0.3021755516529083,-0.10126522928476334,0.32784563302993774,0.10783372074365616,-0.2690439820289612,-0.01477001141756773,-0.02096603438258171,-0.36046433448791504},{-0.3907856345176697,0.03388087451457977,0.2518380284309387,-0.3852896988391876,0.1699940413236618,0.33101779222488403,-0.33357810974121094,0.21929751336574554,-0.21613094210624695,0.1974511742591858,-0.12731219828128815,-0.002946362365037203,-0.1276109665632248,-0.02016519196331501,-0.19407393038272858,-0.18317811191082},{0.018289605155587196,-0.2225702404975891,-0.017007434740662575,-0.34919413924217224,0.2971018850803375,0.09488995373249054,-0.017934119328856468,-0.07931504398584366,-0.22110715508460999,0.37566739320755005,0.2977532148361206,-0.08926313370466232,-0.16646957397460938,0.22846534848213196,-0.07711692899465561,-0.35008329153060913},{0.23316967487335205,-0.1371869444847107,0.32861894369125366,-0.3056873679161072,-0.3733471930027008,-0.03520790860056877,-0.37363919615745544,0.35451585054397583,-0.11122459918260574,-0.23462074995040894,-0.26325374841690063,-0.04464343190193176,-0.02441014163196087,-0.10555503517389297,0.4669755697250366,-0.3728257715702057},{-0.27536889910697937,0.39295145869255066,-0.05837829411029816,0.2816925346851349,0.019515138119459152,-0.2404795140028,-0.08421599119901657,0.1182599887251854,-0.0453878790140152,0.4937669634819031,0.17672045528888702,-0.2183532416820526,0.009487224742770195,-0.08109129965305328,0.04602457582950592,0.1553390473127365},{0.1267317533493042,0.28790172934532166,-0.16027423739433289,-0.3421578109264374,0.3830481171607971,-0.19881175458431244,0.23501421511173248,-0.364097535610199,0.11473099142313004,0.03336004540324211,0.14070512354373932,0.12016576528549194,-0.030639158561825752,-0.2883516848087311,-0.08340929448604584,0.21907392144203186},{-0.2267916202545166,-0.008198273368179798,-0.30200889706611633,-0.33183905482292175,0.2354436069726944,-0.4507085978984833,-0.20694252848625183,0.27229151129722595,-0.13865594565868378,0.2027743011713028,-0.035039059817790985,-0.07819513231515884,-0.3563583493232727,-0.007455711718648672,-0.23909170925617218,-0.33421483635902405},{-0.25930356979370117,-0.11959945410490036,-0.0969092920422554,-0.3576924204826355,-0.3406420052051544,-0.012064334936439991,0.11322580277919769,-0.4989910423755646,0.021819742396473885,-0.07008046656847,0.16724132001399994,0.019058708101511,0.4147144854068756,0.04739129915833473,0.23684313893318176,0.24405454099178314},{-0.19921919703483582,-0.0461253747344017,-0.4269193410873413,0.36202919483184814,0.1283094584941864,-0.023271480575203896,0.16779190301895142,0.08844023197889328,-0.4061782956123352,0.21114523708820343,-0.3272593319416046,-0.156503364443779,-0.38932034373283386,0.4251837432384491,-0.3520764708518982,0.08813867717981339},{-0.15799736976623535,-0.44495877623558044,-0.10943164676427841,0.17009501159191132,-0.17703117430210114,-0.10542497783899307,-0.08336993306875229,0.39554348587989807,0.4394730031490326,0.09270394593477249,-0.08156775683164597,-0.2652113735675812,0.16310738027095795,-0.3728848695755005,0.14752718806266785,-0.24023298919200897},{-0.26901769638061523,-0.4638619124889374,-0.17896582186222076,-0.10126751661300659,-0.45841124653816223,0.3892761170864105,-0.06888556480407715,0.19352632761001587,-0.18510495126247406,-0.3313484191894531,-0.3094193637371063,0.41536226868629456,-0.21924830973148346,0.07015424221754074,-0.2750002443790436,0.377609521150589},{-0.3378736972808838,0.34768977761268616,-0.16304567456245422,0.1216152161359787,-0.3685216009616852,0.2532707452774048,0.05885262042284012,-0.37972989678382874,0.109640933573246,0.18393291532993317,-0.16684626042842865,0.070549875497818,0.2881338596343994,-0.2442302256822586,-0.34842732548713684,-0.16419227421283722},{-0.15232136845588684,-0.3558322787284851,-0.5315737128257751,0.3127056956291199,0.043673835694789886,0.15624119341373444,-0.2485438585281372,0.18674694001674652,-0.430260568857193,-0.3258061110973358,-0.3929373621940613,0.23727917671203613,-0.23959441483020782,0.20719186961650848,0.09119004756212234,0.3033364713191986}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.044864438474178314,-0.1297333985567093,0.11270290613174438,-0.1254027932882309,-0.07608087360858917,0.1264423429965973,0.16666099429130554,-0.23574844002723694,-0.12234505265951157,0.32520610094070435,0.05382126197218895,0.13474760949611664,0.10466629266738892,0.12987510859966278,-0.1825541853904724,0.14922942221164703,0.10912179946899414,-0.30495402216911316,-0.27115482091903687,-0.08673147857189178,-0.20084236562252045,0.146168053150177,-0.2088591456413269,0.37312912940979004,-0.19742600619792938,-0.033184655010700226,0.11929783225059509,0.17835506796836853,-0.25272315740585327,-0.19896936416625977,0.26339221000671387,0.2937042713165283},{0.15963834524154663,-0.049400050193071365,0.15354909002780914,-0.07895782589912415,-0.10683141648769379,0.2193981260061264,0.004558053333312273,-0.07682429254055023,-0.022739708423614502,-0.05431545153260231,-0.10136017948389053,0.020836900919675827,0.3872727155685425,0.22137752175331116,0.1145462691783905,0.040327735245227814,-0.24463282525539398,-0.2832903563976288,0.10227443277835846,0.04282113537192345,0.08173993229866028,0.2902430295944214,0.2675012946128845,-0.16473904252052307,0.05863675847649574,0.29803988337516785,-0.34863412380218506,0.20562484860420227,0.10378281027078629,-0.2531462609767914,-0.07029439508914948,-0.02492731250822544},{-0.08349389582872391,-0.05445033684372902,0.15860171616077423,-0.1540440171957016,-0.18265953660011292,0.016209807246923447,-0.25950145721435547,0.1726609468460083,0.253400057554245,-0.009230000898241997,-0.20828452706336975,0.0914703980088234,0.35457664728164673,-0.22958046197891235,0.08049143105745316,-0.04479688033461571,-0.3901612460613251,0.2241189181804657,-0.3821713626384735,-0.05973841995000839,-0.04855062812566757,-0.08854614943265915,-0.07156623154878616,-0.07099945843219757,-0.008317152969539165,0.4044947326183319,-0.04881344363093376,0.10369179397821426,0.2834114134311676,-0.3966995179653168,-0.08773089945316315,0.016132496297359467},{0.18525481224060059,-0.2491958886384964,0.026387140154838562,-0.3956829011440277,0.10937381535768509,-0.0850936770439148,-0.0530824288725853,0.218908429145813,0.0500837042927742,0.2557850778102875,0.01891285553574562,-0.15090857446193695,-0.2056570202112198,-0.0728057250380516,0.26274019479751587,-0.2161334753036499,0.04773061349987984,-0.06699099391698837,-0.1492169350385666,0.12198865413665771,-0.18229083716869354,0.17158572375774384,-0.2394130527973175,0.3164808452129364,-0.29394230246543884,0.019184965640306473,-0.07740465551614761,-0.23840579390525818,0.013386637903749943,0.051120296120643616,0.219405397772789,-0.14217448234558105},{0.2736678421497345,-0.03587731346487999,0.03304685279726982,0.2630152702331543,-0.2758128046989441,-0.07662344723939896,0.1829495131969452,-0.012686206959187984,0.10239911824464798,-0.1774068921804428,0.004341605119407177,-0.08246301114559174,-0.20360544323921204,-0.14539320766925812,0.3058216869831085,0.25971487164497375,-0.045444291085004807,-0.3283439874649048,0.14230632781982422,-0.1258382350206375,-0.12835508584976196,0.22666458785533905,0.273583322763443,0.02178371138870716,-0.10894212871789932,-0.10979507118463516,0.017906444147229195,0.2555164098739624,0.2458747774362564,0.1010577529668808,0.12491012364625931,-0.22400787472724915},{0.3038926422595978,-0.15889868140220642,0.03164895996451378,0.09117574244737625,-0.126831516623497,-0.3126175105571747,-0.22378909587860107,-0.3160903751850128,-0.1886165887117386,0.03215891867876053,-0.041475050151348114,-0.00480594951659441,-0.07120883464813232,-0.055947110056877136,-0.19435353577136993,-0.2721899151802063,0.16097591817378998,0.02623848430812359,-0.31747856736183167,0.23083390295505524,-0.09520235657691956,-0.1831381767988205,0.21109384298324585,-0.13156619668006897,-0.1632251739501953,-0.2435261458158493,-0.13083195686340332,0.0723242461681366,0.09378490597009659,0.24689556658267975,-0.2758524417877197,0.16661158204078674},{0.18593503534793854,0.06466037034988403,0.22236961126327515,-0.1553696095943451,0.2418781816959381,-0.19689679145812988,-0.31904464960098267,-0.02358204312622547,0.29856982827186584,0.14298148453235626,-0.18106938898563385,0.13202863931655884,0.08964142948389053,0.30815547704696655,0.10662206262350082,-0.0457979291677475,-0.22479379177093506,0.12055576592683792,-0.02347015030682087,-0.03410236909985542,-0.10400164127349854,0.23785682022571564,0.17549777030944824,0.1475701630115509,-0.2903660833835602,-0.21734923124313354,-0.27226415276527405,-0.3407195508480072,0.057881224900484085,-0.1308402419090271,0.31071093678474426,0.15234817564487457},{0.3368211090564728,-0.3839941620826721,0.07131794840097427,-0.4312521815299988,-0.3015592098236084,0.3202768564224243,0.4128859341144562,0.21217849850654602,-0.0599408783018589,0.12150393426418304,0.15869632363319397,-0.14792658388614655,0.06653385609388351,0.27164724469184875,-0.03460213541984558,0.19636967778205872,0.4110903739929199,-0.2662913203239441,-0.08774789422750473,-0.3886428475379944,0.18506886065006256,0.24730344116687775,0.19915473461151123,0.14077481627464294,0.12503619492053986,0.11234277486801147,0.16822591423988342,0.2810908555984497,-0.12031685560941696,-0.26453298330307007,0.2563945949077606,0.0820799320936203},{0.04125430807471275,-0.08379057794809341,0.196260005235672,0.27140355110168457,-0.23463188111782074,-0.3388054668903351,-0.09022408723831177,0.228479266166687,-0.1765625774860382,-0.21550287306308746,0.035515788942575455,0.1367010921239853,0.14022277295589447,-0.3016210198402405,0.13958291709423065,-0.17400702834129333,-0.2175571322441101,0.15464824438095093,-0.2903803586959839,0.2681981325149536,-0.3400784730911255,-0.30332106351852417,-0.32861244678497314,0.2322009652853012,0.10310530662536621,0.10745701193809509,0.33924174308776855,0.2079196572303772,-0.16255226731300354,-0.3495342433452606,-0.13758251070976257,0.1760246753692627},{0.3352833390235901,0.05787638574838638,0.030890552327036858,0.24261777102947235,0.04990089312195778,0.2532457709312439,-0.06318852305412292,0.2371140867471695,-0.07123220711946487,0.03310200199484825,0.16116660833358765,0.11702563613653183,-0.09036537259817123,-0.34190306067466736,0.19998890161514282,0.20920035243034363,0.0006457041017711163,-0.16547268629074097,0.004244830925017595,0.009269713424146175,0.08968168497085571,-0.3225977122783661,0.3865761458873749,0.03276018053293228,-0.05010504648089409,0.11683227866888046,-0.38342365622520447,-0.15783576667308807,0.03693979233503342,0.016609182581305504,0.10059298574924469,0.21915538609027863},{-0.09446535259485245,0.0840083658695221,-0.08681689202785492,0.19905628263950348,-0.09575643390417099,0.29483762383461,0.06577766686677933,-0.10312023758888245,0.28813937306404114,-0.30908626317977905,-0.17243222892284393,0.17528101801872253,-0.07553060352802277,0.07515989243984222,-0.308621883392334,0.035819459706544876,0.052682094275951385,0.15873859822750092,0.06867183744907379,-0.11915268748998642,-0.27042704820632935,0.18646962940692902,0.2363274097442627,0.23383693397045135,-0.32522478699684143,0.3525156080722809,-0.15118394792079926,-0.0014258506707847118,-0.1274379938840866,0.12236563861370087,0.20646364986896515,0.2452923059463501},{-0.21579371392726898,0.2790631949901581,-0.07156949490308762,-0.02091333642601967,-0.24607357382774353,-0.17374403774738312,0.17884883284568787,-0.292955607175827,-0.033105265349149704,-0.24920539557933807,-0.20227305591106415,-0.08862710744142532,0.16826848685741425,-0.2512602210044861,-0.11890055984258652,-0.38832592964172363,-0.14623741805553436,0.00881828460842371,0.3037633001804352,-0.26478317379951477,0.07239089161157608,-0.15477269887924194,0.010392309166491032,0.29379260540008545,-0.1280106157064438,0.13100822269916534,0.28377842903137207,-0.1489514261484146,-0.09011556953191757,0.30679553747177124,-0.20563355088233948,-0.3230709731578827},{-0.048355016857385635,0.25567737221717834,0.24912205338478088,-0.3240736424922943,0.3186039924621582,0.02061559073626995,-0.11650190502405167,0.0011316038435325027,0.12081728130578995,-0.302437961101532,-0.040415868163108826,0.03665262833237648,0.19622299075126648,0.022496512159705162,0.009900717996060848,-0.01438362430781126,0.22758366167545319,-0.309793621301651,0.3352244794368744,0.051870282739400864,-0.16022051870822906,0.17003706097602844,-0.09354249387979507,-0.24334363639354706,0.24131733179092407,-0.07415328174829483,-0.009354908019304276,-0.1009506806731224,0.06485182046890259,-0.12612515687942505,0.3164045810699463,0.2848140299320221},{0.07859551161527634,-0.22529642283916473,-0.19073785841464996,0.06924602389335632,0.061415113508701324,0.28660938143730164,-0.1080145314335823,-0.26694026589393616,0.3167194128036499,0.05206325650215149,0.040034130215644836,0.03190211206674576,-0.20590530335903168,0.10898182541131973,-0.20862814784049988,-0.30603671073913574,0.07204359024763107,0.003385884454473853,0.19522778689861298,0.36961397528648376,-0.22670584917068481,0.12437545508146286,-0.15329207479953766,0.06313367187976837,0.07937449961900711,-0.2965784966945648,-0.15151195228099823,-0.28653815388679504,-0.09165266156196594,-0.13982068002223969,0.2084183692932129,-0.34426429867744446},{-0.05454057827591896,0.3274008333683014,0.14481353759765625,-0.18281638622283936,-0.1265355348587036,-0.2115098387002945,0.14726926386356354,-0.08542503416538239,0.23371462523937225,-0.04042617604136467,0.23102223873138428,0.18452876806259155,-1.154721849161433e-05,0.06520866602659225,-0.15200355648994446,0.20400895178318024,-0.21067126095294952,-0.39439520239830017,-0.2832343876361847,0.11869992315769196,0.12260062247514725,-0.26228347420692444,-0.3352208137512207,-0.22890648245811462,-0.21233472228050232,0.08079995214939117,0.37648001313209534,0.010345852933824062,-0.11310136318206787,0.07730811089277267,-0.13540257513523102,0.1104658991098404},{-0.20559798181056976,-0.17964337766170502,-0.23712433874607086,0.068455271422863,-0.2954852283000946,-0.13668043911457062,-0.10724174976348877,-0.1367577761411667,-0.29544907808303833,-0.1932704895734787,0.11776219308376312,0.17593155801296234,-0.2666625678539276,0.2720554769039154,-0.02837209217250347,0.19110295176506042,0.03366207703948021,0.012726988643407822,0.04140356928110123,0.12358322739601135,0.15014834702014923,0.3144485652446747,0.09148852527141571,0.22646404802799225,0.1068352535367012,-0.2431173473596573,-0.12559296190738678,0.25666192173957825,-0.037643544375896454,-0.2108699232339859,-0.17372629046440125,-0.19038864970207214},{-0.33977919816970825,-0.20710887014865875,-0.39311617612838745,0.08507304638624191,-0.16621336340904236,-0.12038132548332214,-0.1531623899936676,0.035091131925582886,-0.02028350718319416,0.06372281163930893,-0.2328311949968338,0.022808747366070747,0.16235332190990448,-0.013999097049236298,0.007297382690012455,0.15544211864471436,-0.1461161971092224,-0.08324182778596878,0.1435202807188034,0.1225372850894928,0.22094272077083588,0.004308568779379129,-0.2956197261810303,0.06752780079841614,0.2618705630302429,-0.2890593707561493,0.18423308432102203,-0.01881556399166584,0.04217762500047684,-0.16839955747127533,0.18827740848064423,-0.11711037904024124},{0.2748014032840729,-0.05529281497001648,0.055110592395067215,0.11082164198160172,-0.2857423722743988,-0.0014132700162008405,0.16309703886508942,0.2271566241979599,-0.08203263580799103,-0.10137266665697098,0.3047109842300415,-0.18843473494052887,-0.025762559846043587,-0.06902100145816803,-0.1490732729434967,0.2200600653886795,0.020003804937005043,-0.06766773015260696,0.12998200953006744,-0.2856334149837494,0.03651140257716179,-0.30894166231155396,-0.23843863606452942,0.25799888372421265,-0.13998273015022278,-0.13447760045528412,0.1704995483160019,-0.00916298758238554,-0.1542728692293167,-0.0031866563949733973,-0.0917418897151947,-0.02808534912765026},{0.2901906371116638,-0.053885478526353836,0.07670359313488007,0.07176358252763748,-0.016110358759760857,-0.1094849705696106,0.1553557962179184,-0.2535088062286377,0.21710284054279327,0.274480402469635,0.011670580133795738,0.16428379714488983,0.26752549409866333,0.3500922620296478,-0.29540547728538513,-0.31204357743263245,-0.30161651968955994,0.06102907285094261,-0.14315979182720184,-0.277108371257782,-0.19221268594264984,0.29295530915260315,0.06986881047487259,0.14469407498836517,-0.13031895458698273,-0.09369725733995438,-0.1589122712612152,-0.21107131242752075,0.2386200726032257,0.16678066551685333,-0.2880958914756775,-0.16856922209262848},{-0.11617715656757355,0.14450345933437347,0.2925070822238922,-0.05779219791293144,-0.03209305554628372,0.053836941719055176,-0.021698100492358208,-0.3454735279083252,0.2037891149520874,0.25358322262763977,0.1566619873046875,0.20232956111431122,-0.22968938946723938,0.21722127497196198,-0.27353835105895996,0.2737606167793274,0.1439281851053238,-0.2097138911485672,0.25692033767700195,0.17041513323783875,-0.31859272718429565,0.3172008693218231,-0.31656932830810547,0.14979739487171173,0.19088593125343323,0.20408369600772858,0.08386507630348206,0.07063329964876175,-0.21442116796970367,0.2450203150510788,-0.09787479788064957,0.07671864330768585},{-0.15852487087249756,-0.05586474388837814,-0.006399647332727909,0.2508508563041687,-0.04046265035867691,0.1596895009279251,-0.37597617506980896,-0.21396924555301666,-0.15013398230075836,-0.12109516561031342,-0.19009241461753845,-0.10354238748550415,0.09923874586820602,-0.09606553614139557,0.10584624856710434,-0.18916773796081543,0.1380656212568283,-0.025409994646906853,-0.3407819867134094,-0.2180187702178955,0.08908431977033615,0.2179711014032364,-0.19854500889778137,0.3190791606903076,-0.24537716805934906,0.10553181916475296,0.11196820437908173,-0.08785931766033173,0.10765788704156876,-0.26873525977134705,0.3426329791545868,0.06412823498249054},{0.3500955402851105,-0.06253712624311447,0.07251429557800293,0.15056690573692322,-0.15500931441783905,0.2445836216211319,-0.00989303644746542,0.2510942220687866,0.15049056708812714,0.1157410517334938,0.03913292661309242,-0.41544491052627563,-0.2822529375553131,-0.061861712485551834,0.07604215294122696,-0.13676193356513977,0.322688490152359,0.2233041524887085,-0.20116335153579712,-0.20569127798080444,0.2852095067501068,0.2724868059158325,0.2641212046146393,0.15004312992095947,-0.06929636001586914,-0.04128480702638626,-0.08484522998332977,-0.23580358922481537,0.21284732222557068,0.09286072850227356,-0.20484083890914917,0.11557294428348541},{-0.015597338788211346,0.023371854797005653,-0.06517574936151505,-0.24909430742263794,-0.10658691078424454,-0.24718739092350006,-0.23021568357944489,-0.1715264916419983,0.0220875795930624,-0.012784963473677635,-0.2663951516151428,0.02273552305996418,-0.25048962235450745,-0.16225573420524597,0.0017160711577162147,0.08556143939495087,0.27200496196746826,-0.1748417168855667,-0.35003507137298584,0.2728150486946106,-0.15492285788059235,0.25869080424308777,-0.024292588233947754,-0.051469236612319946,0.04536228999495506,0.1254386305809021,-0.05122731253504753,-0.28025883436203003,0.23690298199653625,0.24936726689338684,-0.14518320560455322,0.19858886301517487},{-0.2705625295639038,-0.0002786059631034732,0.042263925075531006,-0.01875661127269268,0.04394415393471718,0.09404895454645157,-0.16209661960601807,0.1325353980064392,-0.21131978929042816,-0.2130776196718216,0.1475847214460373,-0.1214132010936737,-0.2081143707036972,0.23865485191345215,0.004476106725633144,0.011627527885138988,0.21561309695243835,-0.28334906697273254,-0.15840093791484833,0.22548341751098633,0.06196988746523857,0.1827394962310791,-0.012909134849905968,-0.01040117908269167,-0.2595081925392151,-0.11854086071252823,0.03736697509884834,0.3400712013244629,0.02589382976293564,-0.01452368963509798,0.2864490747451782,0.3241874873638153}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.08394534885883331,0.19920025765895844,0.4061734080314636,-0.052868615835905075},{0.06325666606426239,-0.13395924866199493,0.025431571528315544,0.2610931098461151},{-0.1067437008023262,0.13518324494361877,0.1302831768989563,0.11808949708938599},{0.3397667407989502,0.04497462138533592,0.04628501087427139,0.4872525930404663},{-0.055461470037698746,0.08385421335697174,0.32731249928474426,0.015632592141628265},{-0.13880863785743713,0.24446949362754822,0.24200743436813354,-0.06319618970155716},{-0.357442170381546,-0.013009211048483849,0.07665923237800598,-0.12241284549236298},{-0.36813321709632874,-0.16399607062339783,0.4230620563030243,-0.3015885651111603},{0.3161691427230835,-0.13386854529380798,-0.2970214784145355,-0.39990293979644775},{0.08841782063245773,0.36512574553489685,0.33306875824928284,-0.4333254396915436},{-0.21819499135017395,-0.20304962992668152,-0.08964155614376068,0.12864017486572266},{0.4262559711933136,-0.16897590458393097,-0.07010063529014587,0.22086575627326965},{0.28381460905075073,0.2758581042289734,-0.08183830976486206,0.13605676591396332},{-0.0006824953015893698,0.035705383867025375,-0.3019082248210907,0.05300338193774223},{0.10573067516088486,0.25769034028053284,0.40475183725357056,0.2977856993675232},{0.16024629771709442,-0.008236631751060486,0.28337791562080383,0.28193217515945435},{-0.28155985474586487,-0.10406659543514252,-0.06699281930923462,-0.2759881615638733},{-0.14498640596866608,0.17016538977622986,-0.15215998888015747,-0.10351721942424774},{-0.3694336414337158,0.18293653428554535,0.16237424314022064,0.38872358202934265},{-0.032695282250642776,0.32339274883270264,-0.1760028600692749,0.17493879795074463},{-0.28940001130104065,-0.39411383867263794,-0.11977066844701767,0.015743108466267586},{0.35655856132507324,0.4475018084049225,0.013488693162798882,-0.30445075035095215},{-0.011567290872335434,0.19118604063987732,0.22878791391849518,0.19957466423511505},{-0.06077057123184204,0.43485987186431885,-0.06810001283884048,-0.2043732851743698},{-0.01611391268670559,-0.07923545688390732,-0.11686919629573822,0.005830712150782347},{0.3401992917060852,-0.40409091114997864,-0.0553167350590229,0.016748327761888504},{-0.03612573444843292,-0.378776878118515,-0.18428756296634674,-0.2907372713088989},{0.144972026348114,-0.21626803278923035,0.23962131142616272,0.13898499310016632},{0.019226953387260437,-0.062283702194690704,0.034742601215839386,0.01731906831264496},{-0.4476454555988312,0.4121479094028473,0.2190759778022766,0.0005714280996471643},{0.37251612544059753,-0.16776904463768005,0.21059316396713257,-0.061338525265455246},{0.16047529876232147,-0.41556277871131897,0.40824228525161743,-0.2705051302909851}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.06419547647237778,-0.03402760252356529,0.01010696217417717,0.040290944278240204,-0.07859605550765991,-0.10588785260915756,0.01976328156888485,0.04310552030801773,0.06115205958485603,-0.01397452037781477,-0.05979439616203308,-0.008413637056946754,0.054919805377721786,0.0030835226643830538,-0.07012252509593964,-0.018550071865320206};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02000819891691208,0.005485912784934044,0.00957080814987421,0.007719424553215504,0.0010095202596858144,-0.013171091675758362,0.025327080860733986,0.02056693099439144,0.011549892835319042,0.02287842333316803,0.030727680772542953,-0.0010176209034398198,0.04782804101705551,-0.03553848713636398,-0.03878309950232506,0.00045915896771475673};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.002484050579369068,0.009997259825468063,0.00966239906847477,-0.00029852037550881505,0.012719876132905483,0.0032525646965950727,0.008429200388491154,0.012424266897141933,-0.040202103555202484,-0.017762809991836548,0.007688963785767555,0.006539930589497089,0.010631660930812359,0.006479079835116863,-0.002584319794550538,0.03473086655139923,0.0002819230721797794,-0.019345730543136597,0.016851110383868217,-0.01252641063183546,-0.017270835116505623,-0.0073988172225654125,0.046215079724788666,0.009957750327885151,0.008668914437294006,0.025068484246730804,-0.027608651667833328,0.03802059590816498,-0.009707107208669186,0.002415785798802972,0.011791081167757511,0.006464088335633278};
static const float action_parameterization_distribution_linear_bias[4] = {-0.007125436794012785,-0.015996089205145836,-0.004309180658310652,0.009335195645689964};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.026645809412002563,0.2652060091495514,-0.17255014181137085,0.19457115232944489,0.10217753797769547,0.05738826096057892,0.4254535138607025,-0.08126302063465118},{-0.2073603868484497,-0.030778422951698303,-0.29994142055511475,-0.20926138758659363,-0.3953140377998352,-0.25120747089385986,0.0015504283364862204,-0.2565988004207611},{-0.2384878396987915,0.02527269907295704,0.23493531346321106,0.2631967067718506,0.23162385821342468,-0.038220182061195374,0.38787367939949036,-0.17208077013492584},{0.04020262509584427,0.09765974432229996,-0.16633367538452148,0.03409313037991524,-0.00030869583133608103,-0.06742414832115173,0.3442090153694153,-0.250994473695755},{-0.267585813999176,-0.12724612653255463,-0.21560214459896088,-0.10332168638706207,-0.045696746557950974,0.17058919370174408,0.1995922178030014,-0.06921590119600296},{-0.29520735144615173,-0.03137456253170967,0.41555678844451904,0.26430511474609375,0.16135400533676147,-0.11479517817497253,-0.11992204934358597,-0.16202853620052338},{-0.2602335214614868,0.004827373661100864,0.4578399956226349,-0.16994038224220276,-0.14037786424160004,-0.4203525483608246,-0.11464930325746536,-0.11108701676130295},{-0.262666791677475,-0.3603740930557251,0.5539846420288086,-0.05623713508248329,-0.19369369745254517,0.24179813265800476,0.1686841994524002,-0.23958899080753326},{-0.39068618416786194,0.293263703584671,-0.12457308918237686,0.3830145597457886,0.12710507214069366,-0.3012034296989441,0.009696033783257008,0.12973953783512115},{-0.4402933418750763,-0.31708505749702454,-0.11979652941226959,-0.19949504733085632,-0.5158060193061829,0.14194053411483765,-0.0460413359105587,0.1755114048719406},{0.04307086020708084,0.3316911458969116,0.22887495160102844,-0.016119517385959625,0.21049457788467407,0.16294051706790924,-0.215417742729187,0.24106287956237793},{0.10490841418504715,0.025563402101397514,0.25875768065452576,0.24790401756763458,-0.30931055545806885,0.31788918375968933,-0.008711554110050201,-0.21504192054271698},{0.04607817903161049,-0.3316464424133301,0.2526022493839264,-0.06108644977211952,-0.366155207157135,-0.06749436259269714,-0.17589379847049713,-0.10952040553092957},{-0.2559146583080292,-0.2603744566440582,0.3198285400867462,0.33978888392448425,-0.25374019145965576,-0.05670089274644852,-0.3008773624897003,0.23627831041812897},{0.04247770830988884,-0.18595430254936218,0.13832370936870575,-0.22808007895946503,-0.2815447151660919,-0.11638063192367554,0.2358420193195343,0.01771342195570469},{0.1680908501148224,-0.05013422295451164,0.0348760224878788,-0.22654031217098236,0.05891398712992668,0.07128823548555374,0.10767200589179993,0.38984954357147217},{-0.061427365988492966,-0.32560867071151733,-0.17185160517692566,0.13859398663043976,-0.21696844696998596,-0.1471986621618271,-0.1296723634004593,0.13809379935264587},{-0.22218656539916992,-0.33765164017677307,0.02459469996392727,0.057375650852918625,0.11294399201869965,-0.19433890283107758,0.3329472839832306,0.18659918010234833},{-0.034264035522937775,0.07997363805770874,-0.27307814359664917,0.13409601151943207,0.10574319213628769,0.19345812499523163,-0.24490061402320862,0.3793862760066986},{0.1005224883556366,-0.042969219386577606,-0.37689676880836487,0.11096979677677155,-0.06287110596895218,-0.027333246544003487,-0.3164556324481964,0.010108872316777706},{0.019019687548279762,-0.14054808020591736,0.058797284960746765,-0.07234184443950653,0.3381531834602356,0.053284335881471634,-0.007697648834437132,0.40983304381370544},{-0.03502336144447327,0.10558377951383591,-0.26719343662261963,0.3173433840274811,0.3727971017360687,0.356509804725647,0.2340533286333084,-0.31898748874664307},{-0.5023779273033142,-0.1503852754831314,0.15437249839305878,-0.04264483228325844,0.22417224943637848,-0.26362574100494385,0.2961093485355377,-0.2893235683441162},{-0.274166077375412,0.0067932927049696445,-0.08961745351552963,-0.38637101650238037,0.23893769085407257,0.023241369053721428,-0.2602553367614746,0.16072186827659607},{-0.3243895471096039,-0.1906156688928604,-0.017838137224316597,0.019712526351213455,-0.07150685787200928,0.1767721027135849,0.3727487325668335,-0.13834618031978607},{-0.29015347361564636,0.055489856749773026,-0.3946484923362732,-0.3416229486465454,0.174734964966774,0.059634074568748474,-0.032465413212776184,0.06259015202522278},{0.27488061785697937,0.3862033784389496,-0.3117198646068573,0.15317225456237793,0.22620317339897156,0.4103672206401825,-0.23496480286121368,-0.15016435086727142},{0.30922454595565796,0.2533070743083954,0.03694180026650429,0.05043913424015045,0.2984062135219574,0.222694531083107,0.31656602025032043,0.363607257604599},{-0.21137969195842743,0.38569802045822144,0.14039653539657593,-0.009683104231953621,0.23364244401454926,0.06668581813573837,-0.2793176770210266,-0.3072112798690796},{-0.29815730452537537,-0.20883813500404358,0.06971743702888489,-0.27250930666923523,-0.30443060398101807,-0.1617853343486786,0.39726606011390686,-0.08546990901231766},{0.29083138704299927,-0.2349548488855362,0.3431100845336914,-0.3342796564102173,0.013936675153672695,0.22745324671268463,0.2871517539024353,-0.2896636724472046},{0.10427720844745636,0.40134280920028687,0.4020324647426605,-0.26578667759895325,-0.29516518115997314,0.03272082284092903,0.3069091737270355,0.02481069602072239}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.012242218479514122,0.4663820266723633,-0.17559921741485596,0.1932409107685089,-0.4117676615715027,0.31599146127700806,0.3178556561470032,0.09251027554273605},{-0.5103538632392883,-0.4052334129810333,-0.3723932206630707,-0.4466380476951599,-0.4624612033367157,0.4814819097518921,0.35174381732940674,-0.368014931678772},{0.11990159004926682,-0.17718249559402466,0.16010235249996185,0.18778586387634277,-0.031737636774778366,0.45951852202415466,-0.2986338436603546,-0.5024387240409851},{0.4520924985408783,-0.05272173509001732,0.18091589212417603,0.011396432295441628,0.5006438493728638,0.423267126083374,0.5342817902565002,0.3811779022216797},{0.09516645222902298,0.21213652193546295,-0.17680878937244415,-0.2829289734363556,0.08659934252500534,-0.46638956665992737,-0.5209634304046631,0.620962917804718},{0.44240063428878784,0.10266179591417313,-0.003976833075284958,-0.357239305973053,-0.48207947611808777,-0.4943355917930603,-0.1364549696445465,0.4278978705406189},{-0.47119131684303284,-0.33942994475364685,-0.11049734055995941,-0.24148871004581451,-0.02247687429189682,0.5252934098243713,-0.5275354385375977,0.518811047077179},{0.22276370227336884,0.0473179928958416,0.0010872668353840709,0.08231467753648758,0.41683831810951233,-0.5290523171424866,0.3972366452217102,-0.3740725517272949}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0685509666800499,0.022433249279856682,0.03763601928949356,-0.020331675186753273,-0.04462157189846039,0.02812121994793415,0.014395218342542648,-0.00305157620459795};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.0189374852925539,-0.009429221041500568,-0.04102532938122749,0.04859213903546333,-0.018392235040664673,-0.005196413956582546,0.032643482089042664,-0.07146396487951279};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

