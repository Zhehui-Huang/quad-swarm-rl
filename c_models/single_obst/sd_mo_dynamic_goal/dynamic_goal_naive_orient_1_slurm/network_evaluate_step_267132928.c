#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.33550217747688293,0.07488681375980377,0.024518800899386406,0.2364763766527176,0.35776594281196594,-0.24138224124908447,-0.301500141620636,0.14299045503139496,0.350551038980484,-0.2760317027568817,0.4624837040901184,0.05196341499686241,0.2717336118221283,0.10927531868219376,-0.2934246063232422,0.021281147375702858},{-0.31223177909851074,-0.19498074054718018,-0.29842767119407654,-0.11395887285470963,0.20211659371852875,0.35654956102371216,0.14838075637817383,0.021258121356368065,0.15584561228752136,0.2115173488855362,-0.1318051815032959,0.013108910992741585,-0.06860218942165375,0.12574402987957,0.2862043082714081,-0.23085853457450867},{0.02820025384426117,0.26468199491500854,0.17795096337795258,0.2494206428527832,0.016579046845436096,-0.24703413248062134,0.7102863192558289,-0.21847902238368988,-0.12120813876390457,-0.02876770682632923,-0.021736839786171913,-0.21220198273658752,0.22231557965278625,0.5684929490089417,-0.4405202567577362,0.09944067150354385},{0.16391760110855103,-0.14467383921146393,-0.14994344115257263,-0.049960870295763016,-0.21937169134616852,0.05364827439188957,-0.05875112861394882,-0.24879804253578186,-0.03406311199069023,-0.1468297392129898,0.6041958332061768,-0.24518926441669464,-0.3594362437725067,-0.17249390482902527,0.22870385646820068,-0.05225295573472977},{-0.2741954028606415,0.010574999265372753,0.23149651288986206,-0.47287413477897644,0.4899178147315979,0.1851101964712143,0.242987722158432,-0.20608747005462646,-0.18118101358413696,0.24565094709396362,-0.04609714448451996,-0.44108954071998596,-0.0003120262117590755,-0.20176494121551514,0.443833589553833,-0.005436591804027557},{-0.029738804325461388,-0.121425561606884,-0.09212565422058105,-0.09368287026882172,0.08177436888217926,-0.2859262526035309,0.582738995552063,-0.3087688982486725,-0.21667146682739258,-0.2418013960123062,0.20396897196769714,0.06719338148832321,0.32147809863090515,0.03221628814935684,0.3354811668395996,0.2659633457660675},{-0.24433881044387817,0.30590516328811646,-0.06277307868003845,0.0916951522231102,-0.3208228051662445,-0.134592667222023,-0.11280207335948944,-0.03584093973040581,0.28050634264945984,0.31583136320114136,-0.282437264919281,-0.11500600725412369,0.26898130774497986,0.016082916408777237,-0.12060374021530151,0.31320545077323914},{-0.3261145055294037,0.14810393750667572,0.034391842782497406,-0.26863133907318115,0.3387759327888489,-0.2416018545627594,-0.2888046205043793,-0.43709516525268555,-0.08174732327461243,-0.24079187214374542,0.5385113954544067,0.15068639814853668,0.01909981295466423,0.41014567017555237,0.057432062923908234,0.5974990725517273},{0.2590174973011017,0.12431309372186661,-0.1370445191860199,0.030043909326195717,-0.584138035774231,-0.5681255459785461,0.17816026508808136,-0.5732874274253845,-0.058580849319696426,-0.0975920632481575,0.30232036113739014,-0.5726579427719116,-0.5117495656013489,0.13412083685398102,0.08524329215288162,-0.28036341071128845},{0.6107736229896545,-0.7958112955093384,-0.31473299860954285,0.11711761355400085,0.21095789968967438,-0.30031338334083557,-0.10584850609302521,-0.20329299569129944,-0.3662422299385071,0.016162872314453125,-0.33765316009521484,-0.28343769907951355,0.6327708959579468,-0.27360889315605164,-0.7285975217819214,-0.21388806402683258},{0.23582632839679718,0.35769712924957275,-0.15859355032444,0.10154519230127335,0.023122256621718407,-0.23852789402008057,-0.18258093297481537,0.11801334470510483,-0.06668052822351456,0.2131001502275467,0.19529201090335846,0.27552884817123413,-0.13913975656032562,0.23505766689777374,0.04240803420543671,-0.2726224660873413},{-0.3712645471096039,0.21160109341144562,0.5222703814506531,-0.7379477024078369,0.007783211302012205,0.07983790338039398,0.1178351491689682,0.29468396306037903,0.28280866146087646,0.436842143535614,0.3764469027519226,-0.2790639102458954,0.286971777677536,-0.19054901599884033,0.03388044983148575,-0.2090921401977539},{0.1647002398967743,-0.2920384109020233,-0.26548460125923157,0.3579709529876709,-0.19715265929698944,-0.31781166791915894,-0.038820780813694,0.3235395848751068,0.15601840615272522,-0.10967651754617691,-0.34910252690315247,0.3001099228858948,0.4680757224559784,0.33420321345329285,-0.19904810190200806,0.6581111550331116},{0.23346127569675446,0.25498417019844055,-0.40307527780532837,0.1342105120420456,-0.10525916516780853,-0.19790835678577423,-0.25034552812576294,0.11293528228998184,-0.34175676107406616,-0.4119304120540619,-0.10322897881269455,0.09546344727277756,-0.5951358675956726,-0.060430217534303665,-0.3369913697242737,-0.12254194170236588},{0.09505220502614975,0.5832500457763672,0.47556355595588684,-0.472768098115921,-0.31224995851516724,0.26181674003601074,-0.047087013721466064,0.05181943252682686,0.5010866522789001,0.34238356351852417,-0.15923389792442322,0.10832065343856812,-0.14788956940174103,-0.35363394021987915,0.17835485935211182,-0.3232450485229492},{-0.3508751094341278,-0.0745679959654808,-0.025655176490545273,0.25649669766426086,-0.05092403665184975,0.030168604105710983,-0.1599920392036438,-0.060725707560777664,-0.3786465525627136,-0.10450700670480728,0.28980469703674316,0.1379663348197937,-0.21728044748306274,-0.23473626375198364,-0.4084535539150238,-0.12466414272785187},{-0.3370944857597351,0.15334820747375488,-0.2756156921386719,0.017945433035492897,-0.1162119209766388,0.3364260792732239,0.3500337302684784,0.14469602704048157,0.26811420917510986,-0.23769865930080414,-0.06114979088306427,-0.10609454661607742,0.004198586102575064,0.0529729388654232,-0.012998885475099087,-0.15639933943748474},{0.1223335713148117,-0.452886700630188,0.15891492366790771,0.19852805137634277,-0.011751457117497921,0.30491766333580017,0.3380298316478729,0.1599951535463333,-0.16348057985305786,-0.26191452145576477,-0.12145479768514633,-0.09550412744283676,-0.13923002779483795,-0.3745538592338562,0.08690901100635529,0.028820743784308434}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.16989250481128693,0.31862762570381165,0.3579410910606384,-0.0834108293056488,-0.23138317465782166,0.09033060818910599,0.07030779123306274,0.26966196298599243,-0.044264476746320724,0.2751750946044922,0.49096739292144775,-0.36068716645240784,-0.11439400911331177,0.08652160316705704,0.027758415788412094,-0.03903307765722275},{-0.560971200466156,0.2279878407716751,-0.2915271520614624,0.2476460486650467,0.3579029440879822,-0.17487682402133942,-0.35112473368644714,-0.2929191589355469,0.36030590534210205,0.2829141318798065,-0.05763303488492966,0.2751311957836151,-0.36452266573905945,0.1683688908815384,-0.23871678113937378,0.4710359275341034},{-0.3953609764575958,0.20309187471866608,-0.3753156065940857,0.016638247296214104,-0.41870927810668945,-0.31568917632102966,-0.1249813660979271,0.020340528339147568,-0.23855657875537872,0.3645041584968567,0.21936722099781036,-0.08190272748470306,0.26083654165267944,-0.35185685753822327,-0.05693691968917847,-0.009130551479756832},{0.27142244577407837,-0.2306889146566391,0.09161257743835449,0.44864875078201294,-0.43474316596984863,-0.39625388383865356,0.28807923197746277,0.11207029968500137,0.2918553650379181,-0.0930589810013771,0.3364327847957611,0.09817361831665039,-0.26120659708976746,-0.025634286925196648,-0.022920036688447,-0.3668651580810547},{-0.39975664019584656,0.04050808772444725,0.24829033017158508,-0.3854168653488159,0.17739439010620117,0.3371785581111908,-0.3290005624294281,0.2100985199213028,-0.21630343794822693,0.20940276980400085,-0.12187441438436508,-0.012509018182754517,-0.11081945151090622,-0.02840479090809822,-0.1910294145345688,-0.16948562860488892},{0.004619897808879614,-0.24248334765434265,-0.023871110752224922,-0.35412073135375977,0.3000214099884033,0.07997193932533264,-0.03570905327796936,-0.08158570528030396,-0.21835485100746155,0.37755826115608215,0.287436306476593,-0.08666633814573288,-0.17146733403205872,0.21385978162288666,-0.06528612971305847,-0.3571801483631134},{0.23419713973999023,-0.13017091155052185,0.3398760259151459,-0.3165301978588104,-0.3649313151836395,-0.03777359798550606,-0.3794515132904053,0.34632664918899536,-0.09329390525817871,-0.23670418560504913,-0.2564334571361542,-0.042201414704322815,-0.019140854477882385,-0.1125263050198555,0.4844905734062195,-0.3737635016441345},{-0.29227015376091003,0.36576247215270996,-0.08122656494379044,0.2844911813735962,0.027899200096726418,-0.2645500600337982,-0.10270874202251434,0.13269110023975372,-0.057209789752960205,0.49105072021484375,0.1473441869020462,-0.2094963788986206,0.0041418825276196,-0.08896872401237488,0.047509338706731796,0.1428862363100052},{0.1092350110411644,0.28585076332092285,-0.17726607620716095,-0.3426496982574463,0.3955232799053192,-0.2032940685749054,0.22222299873828888,-0.35844454169273376,0.11278083175420761,0.04152262210845947,0.11457206308841705,0.12664726376533508,-0.031032228842377663,-0.29740774631500244,-0.08323567360639572,0.22012992203235626},{-0.23036757111549377,-0.011911408975720406,-0.31121695041656494,-0.3367030918598175,0.23153118789196014,-0.4444997310638428,-0.21362195909023285,0.2828613519668579,-0.1414652019739151,0.2213197499513626,-0.04900182783603668,-0.0871928259730339,-0.35558634996414185,-0.015763338655233383,-0.24356144666671753,-0.33658742904663086},{-0.2616093158721924,-0.11338024586439133,-0.08469114452600479,-0.3580707013607025,-0.34727850556373596,-0.025132833048701286,0.1195804700255394,-0.5076650381088257,0.020916949957609177,-0.06166226416826248,0.1821517050266266,0.015595939010381699,0.4337840676307678,0.04215649887919426,0.23576325178146362,0.25242090225219727},{-0.19274649024009705,-0.05054953694343567,-0.4293292760848999,0.35672590136528015,0.13096420466899872,-0.043184615671634674,0.17952638864517212,0.09752859175205231,-0.41789454221725464,0.21610300242900848,-0.3074358105659485,-0.16366909444332123,-0.392113596200943,0.42236173152923584,-0.36097005009651184,0.09244940429925919},{-0.17371858656406403,-0.4528859853744507,-0.1318051666021347,0.17510105669498444,-0.17051345109939575,-0.12035788595676422,-0.09408556669950485,0.41912761330604553,0.4236032962799072,0.10058999061584473,-0.10132350772619247,-0.2696138918399811,0.18279007077217102,-0.3828335106372833,0.14539924263954163,-0.2520422041416168},{-0.275721937417984,-0.44858700037002563,-0.18880611658096313,-0.09463530033826828,-0.44177040457725525,0.40614426136016846,-0.05566347390413284,0.1934712827205658,-0.17995747923851013,-0.3284538686275482,-0.3193291127681732,0.4090028703212738,-0.22785386443138123,0.07464124262332916,-0.28855860233306885,0.3825269043445587},{-0.3542112112045288,0.3573741614818573,-0.17401443421840668,0.11704917252063751,-0.3784293830394745,0.28763797879219055,0.045483559370040894,-0.38711175322532654,0.10991767793893814,0.18669049441814423,-0.19310465455055237,0.08571513742208481,0.27824169397354126,-0.24229678511619568,-0.3499198257923126,-0.1472267210483551},{-0.15534761548042297,-0.3725306987762451,-0.5435215830802917,0.31925398111343384,0.012772154062986374,0.16827358305454254,-0.2685994505882263,0.19351640343666077,-0.44515448808670044,-0.3417941927909851,-0.4090842306613922,0.2578916549682617,-0.24323002994060516,0.2200421541929245,0.09694869071245193,0.30818143486976624}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.04045548290014267,-0.14050406217575073,0.10883227735757828,-0.14230291545391083,-0.08204606175422668,0.12777423858642578,0.17901292443275452,-0.2229873090982437,-0.1098107323050499,0.3370257019996643,0.0506402924656868,0.12612713873386383,0.09958723932504654,0.1299913376569748,-0.19341033697128296,0.1399707794189453,0.12040732800960541,-0.3001028597354889,-0.28335583209991455,-0.09817925840616226,-0.20130811631679535,0.15077102184295654,-0.21493177115917206,0.3763818144798279,-0.20187826454639435,-0.03176983445882797,0.1293049156665802,0.18187105655670166,-0.2648440897464752,-0.2018890529870987,0.2676510214805603,0.30904513597488403},{0.16454292833805084,-0.04662364348769188,0.15754590928554535,-0.062236443161964417,-0.11831727623939514,0.21206134557724,-0.017669761553406715,-0.0967932865023613,-0.02808654122054577,-0.056187648326158524,-0.11644518375396729,0.03602248802781105,0.4100898206233978,0.22888943552970886,0.12854380905628204,0.055743664503097534,-0.26395925879478455,-0.2951349914073944,0.09898649156093597,0.05579666048288345,0.06397321820259094,0.2929316461086273,0.26396605372428894,-0.15885435044765472,0.052382003515958786,0.2991691827774048,-0.35112395882606506,0.20325516164302826,0.11481156945228577,-0.2533474266529083,-0.07156074047088623,-0.03781815618276596},{-0.08050887286663055,-0.0439956858754158,0.15300801396369934,-0.1451699435710907,-0.19522476196289062,-0.004159044940024614,-0.2792857587337494,0.1643054485321045,0.2664623260498047,-0.007728337775915861,-0.21885663270950317,0.11468489468097687,0.36428940296173096,-0.22903160750865936,0.07932445406913757,-0.03142601251602173,-0.4094874858856201,0.2060278207063675,-0.39726337790489197,-0.06814369559288025,-0.0579385943710804,-0.08286935836076736,-0.07656867057085037,-0.0867900550365448,-0.007361174561083317,0.42322826385498047,-0.03707738220691681,0.12671519815921783,0.29994329810142517,-0.41764533519744873,-0.062069620937108994,0.03424294665455818},{0.18727412819862366,-0.2674610912799835,0.01793486997485161,-0.4087551534175873,0.11260420083999634,-0.07748264074325562,-0.045669473707675934,0.22256974875926971,0.06215982884168625,0.2690379321575165,0.012379624880850315,-0.1618557572364807,-0.20067991316318512,-0.07324641942977905,0.2564665675163269,-0.23357082903385162,0.05785175785422325,-0.05233975127339363,-0.1617458611726761,0.12031878530979156,-0.18417206406593323,0.18400856852531433,-0.24209465086460114,0.33206504583358765,-0.30075326561927795,0.011601059697568417,-0.07808838039636612,-0.2606244683265686,-0.017267171293497086,0.05345503240823746,0.22996264696121216,-0.1500592678785324},{0.26996156573295593,-0.026874495670199394,0.046991799026727676,0.2652035355567932,-0.2712104320526123,-0.07737179845571518,0.18726347386837006,-0.007848139852285385,0.09542366117238998,-0.18438531458377838,0.01143632922321558,-0.08756795525550842,-0.20106995105743408,-0.14891889691352844,0.31052932143211365,0.2662239968776703,-0.05161475017666817,-0.3253116011619568,0.1506636142730713,-0.11764758080244064,-0.12817493081092834,0.22401200234889984,0.27955397963523865,0.016439571976661682,-0.10780218988656998,-0.1181512400507927,0.01236460916697979,0.25295042991638184,0.24900315701961517,0.1159273162484169,0.11291761696338654,-0.2348940521478653},{0.2931823134422302,-0.16766229271888733,0.031507041305303574,0.10075074434280396,-0.14383095502853394,-0.31601494550704956,-0.246446430683136,-0.34343236684799194,-0.18939346075057983,0.023794861510396004,-0.049234259873628616,-0.0013794376282021403,-0.053754523396492004,-0.028209583833813667,-0.19789361953735352,-0.28017187118530273,0.15364354848861694,0.04067442938685417,-0.3081567883491516,0.26040783524513245,-0.10723170638084412,-0.17240549623966217,0.21125881373882294,-0.11031994968652725,-0.15437504649162292,-0.25436922907829285,-0.1407133936882019,0.06005960330367088,0.08634401112794876,0.2456658035516739,-0.30436331033706665,0.14488862454891205},{0.2085874378681183,0.05655838921666145,0.24466663599014282,-0.16153323650360107,0.2551926374435425,-0.17614516615867615,-0.30464959144592285,-0.01622316986322403,0.286467581987381,0.1614058017730713,-0.19086265563964844,0.11596458405256271,0.09064896404743195,0.30769553780555725,0.12575635313987732,-0.04248380661010742,-0.22615614533424377,0.13899073004722595,-0.014436978846788406,-0.023334061726927757,-0.11486337333917618,0.24748030304908752,0.1927071213722229,0.16323548555374146,-0.3241748809814453,-0.2414531111717224,-0.28992342948913574,-0.3488842248916626,0.0333644263446331,-0.11004405468702316,0.31084680557250977,0.144896000623703},{0.35077741742134094,-0.4013518989086151,0.0704377070069313,-0.4544236660003662,-0.2761421501636505,0.342306911945343,0.4408661425113678,0.2491389662027359,-0.055374447256326675,0.1363583654165268,0.16591981053352356,-0.16784054040908813,0.03789489343762398,0.23913924396038055,-0.042832471430301666,0.1887621134519577,0.44455209374427795,-0.2680838406085968,-0.08643560856580734,-0.41746068000793457,0.1981266289949417,0.24582672119140625,0.19517642259597778,0.13492704927921295,0.12165484577417374,0.10970986634492874,0.18017931282520294,0.2917254865169525,-0.11267585307359695,-0.25534477829933167,0.2673778235912323,0.10605969280004501},{0.03704778850078583,-0.06910618394613266,0.18474669754505157,0.28141555190086365,-0.23724396526813507,-0.35139229893684387,-0.10351572185754776,0.2230713665485382,-0.17188702523708344,-0.22473500669002533,0.03847761079668999,0.15335699915885925,0.14606676995754242,-0.30150511860847473,0.1328955739736557,-0.16899116337299347,-0.23224762082099915,0.14092136919498444,-0.30638858675956726,0.26007944345474243,-0.33490878343582153,-0.30287623405456543,-0.3250773847103119,0.21251890063285828,0.10752484202384949,0.12551170587539673,0.33818861842155457,0.21660080552101135,-0.15494860708713531,-0.3643963634967804,-0.11949075758457184,0.17641587555408478},{0.3458879590034485,0.06778071075677872,0.05117210000753403,0.22859728336334229,0.07680152356624603,0.26169756054878235,-0.033243559300899506,0.2762632668018341,-0.0932764783501625,0.03323358669877052,0.1811145544052124,0.10448559373617172,-0.11975984275341034,-0.37630271911621094,0.2122139185667038,0.22922936081886292,0.013651047833263874,-0.1862434595823288,0.022402433678507805,-0.012530741281807423,0.10949591547250748,-0.3489116430282593,0.3911777436733246,0.011351543478667736,-0.05720949172973633,0.11077793687582016,-0.3747377395629883,-0.14644475281238556,0.06765781342983246,0.03668878972530365,0.10922098904848099,0.23327842354774475},{-0.08617645502090454,0.0889803096652031,-0.0837387666106224,0.19649437069892883,-0.09714838117361069,0.291071355342865,0.0749216079711914,-0.09538210183382034,0.2884272634983063,-0.3030455410480499,-0.17190112173557281,0.1785801649093628,-0.08404497057199478,0.06568822264671326,-0.3028835952281952,0.0410538986325264,0.05245141685009003,0.15115749835968018,0.06308701634407043,-0.12947295606136322,-0.2680279314517975,0.17960169911384583,0.23398856818675995,0.22248224914073944,-0.3354854881763458,0.3563556969165802,-0.1399158388376236,0.004175691865384579,-0.12669575214385986,0.1208902895450592,0.23195809125900269,0.2565896809101105},{-0.23638762533664703,0.2911957800388336,-0.08324965834617615,0.007656342349946499,-0.26597484946250916,-0.19783461093902588,0.1478496491909027,-0.3276011347770691,-0.031243136152625084,-0.2690657675266266,-0.2019377052783966,-0.0716238021850586,0.18952016532421112,-0.2192140519618988,-0.1254255175590515,-0.391219824552536,-0.17073532938957214,0.012593644671142101,0.2985307276248932,-0.24273982644081116,0.0675860345363617,-0.14809904992580414,0.011490720324218273,0.2973547577857971,-0.11367200314998627,0.1383657306432724,0.26940566301345825,-0.15427424013614655,-0.09567765146493912,0.28842735290527344,-0.22164274752140045,-0.3499128520488739},{-0.04492701590061188,0.2621903717517853,0.25367000699043274,-0.3244156241416931,0.31028681993484497,0.017238488420844078,-0.11581236124038696,-0.0011762140784412622,0.11438450217247009,-0.30772706866264343,-0.03526514023542404,0.04398639500141144,0.19379816949367523,0.02636965550482273,0.011958597227931023,-0.011753636412322521,0.22785751521587372,-0.32160478830337524,0.3401104509830475,0.045994099229574203,-0.15379922091960907,0.15297536551952362,-0.09376972168684006,-0.2523871660232544,0.2452012300491333,-0.06600408256053925,-0.001246043131686747,-0.0955406054854393,0.07420312613248825,-0.1256178617477417,0.3190856873989105,0.29717540740966797},{0.07425082474946976,-0.23612764477729797,-0.19922097027301788,0.06983310729265213,0.04865216463804245,0.2796209156513214,-0.11877518147230148,-0.28341758251190186,0.3366226553916931,0.0630129873752594,0.019750667735934258,0.03311995789408684,-0.186580091714859,0.12122209370136261,-0.20929406583309174,-0.3155567944049835,0.064016193151474,0.02164766751229763,0.17753171920776367,0.38386085629463196,-0.244691401720047,0.1481557935476303,-0.162762850522995,0.08234437555074692,0.07307767122983932,-0.301465779542923,-0.1509183943271637,-0.30373820662498474,-0.11704257130622864,-0.14535440504550934,0.21347208321094513,-0.35279929637908936},{-0.07423533499240875,0.3328504264354706,0.11897734552621841,-0.19616849720478058,-0.14665363729000092,-0.23198913037776947,0.15230832993984222,-0.08265042304992676,0.25447189807891846,-0.05255478248000145,0.2480705976486206,0.19357916712760925,-0.013348598033189774,0.06865764409303665,-0.18065278232097626,0.18681937456130981,-0.1977773904800415,-0.4050401747226715,-0.3027251958847046,0.0971943661570549,0.14267468452453613,-0.27860820293426514,-0.35237759351730347,-0.2476162314414978,-0.18752536177635193,0.10660343617200851,0.4031919538974762,0.015514209866523743,-0.11489639431238174,0.052482884377241135,-0.11546754837036133,0.13096202909946442},{-0.20976762473583221,-0.18403147161006927,-0.24629725515842438,0.08500923961400986,-0.30319514870643616,-0.13944852352142334,-0.13032203912734985,-0.16705605387687683,-0.29117175936698914,-0.1949029564857483,0.10506600141525269,0.18375825881958008,-0.24422085285186768,0.2874183654785156,-0.026420515030622482,0.18025977909564972,0.019771577790379524,0.027687443420290947,0.031795814633369446,0.14612840116024017,0.13737252354621887,0.330127477645874,0.0944654643535614,0.23993730545043945,0.10200278460979462,-0.2460915595293045,-0.14174886047840118,0.23392602801322937,-0.060837939381599426,-0.21662038564682007,-0.16831597685813904,-0.22249959409236908},{-0.32802584767341614,-0.21024958789348602,-0.3978525698184967,0.09225695580244064,-0.15736043453216553,-0.11314374208450317,-0.16507788002490997,0.03538404405117035,-0.00937094260007143,0.06990795582532883,-0.2484959214925766,0.03600939363241196,0.1759692132472992,-0.025266410782933235,0.016544746235013008,0.1656395047903061,-0.15632924437522888,-0.099327452480793,0.13738489151000977,0.11810384690761566,0.20277708768844604,0.01431257463991642,-0.2883688509464264,0.06602812558412552,0.25699788331985474,-0.27871668338775635,0.17412519454956055,-0.012242448516190052,0.05325119569897652,-0.1740933656692505,0.1978614330291748,-0.11097549647092819},{0.2738373875617981,-0.06027785316109657,0.05051561817526817,0.10086473077535629,-0.27959144115448,0.0063657574355602264,0.16909420490264893,0.23335206508636475,-0.08045973628759384,-0.09605258703231812,0.2996465861797333,-0.19649097323417664,-0.02925720624625683,-0.07832526415586472,-0.1480831652879715,0.21816600859165192,0.027145493775606155,-0.06906171888113022,0.13029557466506958,-0.2892362177371979,0.03226500004529953,-0.305148184299469,-0.23573341965675354,0.26218903064727783,-0.14086003601551056,-0.13596177101135254,0.1684945523738861,-0.011544309556484222,-0.1588168740272522,-0.0025969722773879766,-0.09742022305727005,-0.020532239228487015},{0.30343300104141235,-0.06472588330507278,0.07885540276765823,0.0696575716137886,-0.012810897082090378,-0.10494338721036911,0.15188464522361755,-0.24741238355636597,0.2240932732820511,0.2856232523918152,0.003869664389640093,0.16754186153411865,0.2699449062347412,0.3464939296245575,-0.2964922785758972,-0.31081894040107727,-0.3024401366710663,0.05923809856176376,-0.15132743120193481,-0.28301724791526794,-0.19879788160324097,0.3002493977546692,0.06635911762714386,0.14767564833164215,-0.1375768780708313,-0.09283790737390518,-0.1555292010307312,-0.21008019149303436,0.24627235531806946,0.17012959718704224,-0.27877625823020935,-0.16468609869480133},{-0.11842318624258041,0.12420495599508286,0.2705715000629425,-0.08813698589801788,-0.03154490143060684,0.056254006922245026,-0.008659133687615395,-0.3214690089225769,0.22676712274551392,0.2673962414264679,0.15350547432899475,0.19376802444458008,-0.2504832446575165,0.20258989930152893,-0.2958325445652008,0.25819435715675354,0.17087866365909576,-0.21560676395893097,0.23754510283470154,0.14463846385478973,-0.31319865584373474,0.3189252018928528,-0.33733296394348145,0.15020886063575745,0.2010776400566101,0.21439224481582642,0.1087179183959961,0.06869415193796158,-0.20355427265167236,0.238141730427742,-0.09868069738149643,0.10411401093006134},{-0.17743515968322754,-0.0516657792031765,-0.011964891105890274,0.2527969181537628,-0.05173875764012337,0.15079690515995026,-0.3736487030982971,-0.21960608661174774,-0.1450672149658203,-0.14232243597507477,-0.17330056428909302,-0.10195755958557129,0.0968276783823967,-0.08299833536148071,0.09302555024623871,-0.19967107474803925,0.14589692652225494,-0.018138986080884933,-0.33056071400642395,-0.2072116583585739,0.10062051564455032,0.20190393924713135,-0.20472970604896545,0.3132610321044922,-0.22521889209747314,0.1048283576965332,0.11261679977178574,-0.10028250515460968,0.11315355449914932,-0.270001083612442,0.3247528672218323,0.050221603363752365},{0.367352157831192,-0.08218681067228317,0.08482832461595535,0.14841893315315247,-0.14773719012737274,0.2566428482532501,-0.01787155121564865,0.24578161537647247,0.14910340309143066,0.14092859625816345,0.017511820420622826,-0.42144572734832764,-0.2668777406215668,-0.05954734608530998,0.0815667137503624,-0.13847434520721436,0.31742405891418457,0.23946240544319153,-0.20228487253189087,-0.1937359720468521,0.26285937428474426,0.29662612080574036,0.2760762572288513,0.1749579757452011,-0.08895132690668106,-0.05852910876274109,-0.09789849072694778,-0.24648211896419525,0.20613493025302887,0.10715291649103165,-0.201193168759346,0.11024795472621918},{-0.01774904690682888,0.016980336979031563,-0.06977252662181854,-0.25877147912979126,-0.10297336429357529,-0.24100534617900848,-0.22535960376262665,-0.16838590800762177,0.024868082255125046,-0.006521475967019796,-0.2728998064994812,0.015062353573739529,-0.2512998580932617,-0.16778689622879028,0.00142904301173985,0.08181620389223099,0.2789026200771332,-0.17326262593269348,-0.3498851954936981,0.27244624495506287,-0.16105706989765167,0.26448458433151245,-0.021914679557085037,-0.044500961899757385,0.0458967424929142,0.12265556305646896,-0.05329352617263794,-0.2848113477230072,0.23103919625282288,0.2505335807800293,-0.1532592475414276,0.2037028968334198},{-0.26003608107566833,0.003138494910672307,0.06934574246406555,0.00626969151198864,0.05443510785698891,0.10886729508638382,-0.17207437753677368,0.11076794564723969,-0.23302683234214783,-0.21526889503002167,0.14019620418548584,-0.12631583213806152,-0.18052397668361664,0.2511693835258484,0.030478836968541145,0.020278118550777435,0.19456510245800018,-0.2624403238296509,-0.1318637728691101,0.26282110810279846,0.04238979518413544,0.19218163192272186,0.015345686115324497,0.0067179021425545216,-0.28477510809898376,-0.1467721313238144,-0.0021273884922266006,0.32397353649139404,0.004009560216218233,0.008164960891008377,0.2732227146625519,0.2871870696544647}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.07174646109342575,0.21297712624073029,0.44963860511779785,-0.08886723220348358},{0.057211264967918396,-0.16656289994716644,0.023530755192041397,0.295978844165802},{-0.12769989669322968,0.12846654653549194,0.1594727635383606,0.11251503974199295},{0.35515689849853516,0.05191604048013687,0.03543432056903839,0.5292606353759766},{-0.06877155601978302,0.08973628282546997,0.3396192491054535,0.027131039649248123},{-0.15320946276187897,0.2501938045024872,0.2657437026500702,-0.07114870846271515},{-0.3961174190044403,-0.06309356540441513,0.10449967533349991,-0.16939915716648102},{-0.3911181688308716,-0.17122429609298706,0.46651944518089294,-0.3060203790664673},{0.32873862981796265,-0.1474284678697586,-0.29491502046585083,-0.4260614514350891},{0.08466175943613052,0.36962372064590454,0.36683085560798645,-0.5103071928024292},{-0.26466894149780273,-0.2419489175081253,-0.09195229411125183,0.11552762240171432},{0.45729973912239075,-0.21679946780204773,-0.07146037369966507,0.22541381418704987},{0.3017108738422394,0.26546376943588257,-0.07382946461439133,0.149183452129364},{0.0011231002863496542,0.05101817473769188,-0.30976974964141846,0.053535934537649155},{0.09725788980722427,0.2788493037223816,0.4251681864261627,0.3361455500125885},{0.14977812767028809,-0.02837548591196537,0.31061047315597534,0.2771208584308624},{-0.31056955456733704,-0.0974234789609909,-0.06965840607881546,-0.30011945962905884},{-0.1345795840024948,0.1913551539182663,-0.16058306396007538,-0.10046985745429993},{-0.3815130591392517,0.18409743905067444,0.1757637858390808,0.4085489809513092},{-0.02182111330330372,0.35555803775787354,-0.20835095643997192,0.19179992377758026},{-0.2988632619380951,-0.39826908707618713,-0.1251448541879654,0.034602075815200806},{0.3689936399459839,0.4957980215549469,0.0162186399102211,-0.3327156901359558},{-0.01803753711283207,0.21016769111156464,0.24244314432144165,0.22015514969825745},{-0.05833691358566284,0.46018892526626587,-0.06947825849056244,-0.23257751762866974},{-0.007597637362778187,-0.10411356389522552,-0.12296579778194427,0.0025542827788740396},{0.35245585441589355,-0.4709450602531433,-0.03864118829369545,0.0054639484733343124},{-0.039188072085380554,-0.41122448444366455,-0.19397428631782532,-0.30454424023628235},{0.15249134600162506,-0.22910356521606445,0.24257878959178925,0.15968239307403564},{0.035733699798583984,-0.05386076495051384,0.04884779825806618,0.042174771428108215},{-0.470076322555542,0.42450109124183655,0.22088885307312012,-0.0052198488265275955},{0.3692692220211029,-0.1723242551088333,0.2232327163219452,-0.05640528351068497},{0.13678254187107086,-0.43973013758659363,0.44533583521842957,-0.28315621614456177}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.062454380095005035,-0.022320665419101715,0.011100438423454762,0.038739606738090515,-0.08134811371564865,-0.08695616573095322,0.010177732445299625,0.041351351886987686,0.07627341896295547,-0.007400308270007372,-0.05356892570853233,-0.014988018199801445,0.05198720470070839,0.0012981686741113663,-0.06323490291833878,-0.018571967259049416};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0213309396058321,0.0007355418638326228,0.004233264364302158,0.002333082491531968,0.0076067796908319,-0.014165141619741917,0.024334445595741272,0.018896490335464478,0.015643281862139702,0.02016415446996689,0.03309991955757141,0.0032785367220640182,0.049731701612472534,-0.039343252778053284,-0.03303183615207672,0.0006473955581896007};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0026853110175579786,0.012943089939653873,0.014164994470775127,0.004128701984882355,0.007382676936686039,-0.0025284080766141415,0.008797536604106426,0.011723251082003117,-0.04172604903578758,-0.023660968989133835,0.016972126439213753,0.009744903072714806,0.008744824677705765,0.014085428789258003,-0.006432640366256237,0.03287375345826149,-0.00038909827708266675,-0.016476454213261604,0.017744136974215508,-0.011094688437879086,-0.008351203054189682,-0.014567168429493904,0.04104883223772049,0.004954828415066004,0.011161448433995247,0.025363139808177948,-0.022676527500152588,0.03823346644639969,-0.006841907277703285,0.0037516593001782894,0.014081607572734356,-0.00033138063736259937};
static const float action_parameterization_distribution_linear_bias[4] = {-0.011332370340824127,-0.018688973039388657,-0.0077808392234146595,0.012869467958807945};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.0582677461206913,0.25242555141448975,-0.16939693689346313,0.20997647941112518,0.09147961437702179,0.052220217883586884,0.39555492997169495,-0.06733783334493637},{-0.24147890508174896,-0.03614519163966179,-0.29902830719947815,-0.19880826771259308,-0.40271860361099243,-0.25603482127189636,-0.003575000213459134,-0.25530123710632324},{-0.262290358543396,0.024160435423254967,0.23403321206569672,0.26853933930397034,0.2264748066663742,-0.04131307452917099,0.3824191093444824,-0.17334385216236115},{0.03284642845392227,0.10340824723243713,-0.17394211888313293,0.0321747288107872,-8.721059566596523e-05,-0.06607460230588913,0.35032930970191956,-0.25755876302719116},{-0.27582255005836487,-0.12186837941408157,-0.22613970935344696,-0.10586313903331757,-0.042099375277757645,0.17147211730480194,0.20613247156143188,-0.07259473204612732},{-0.30889445543289185,-0.03132127225399017,0.4044276475906372,0.2679751515388489,0.16391873359680176,-0.1189599484205246,-0.11932799220085144,-0.16044774651527405},{-0.26175352931022644,0.009946244768798351,0.43080011010169983,-0.176419198513031,-0.12632118165493011,-0.41617628931999207,-0.10679049044847488,-0.11273942142724991},{-0.2720780074596405,-0.35277339816093445,0.5175355672836304,-0.06940370798110962,-0.17252415418624878,0.25352951884269714,0.17530865967273712,-0.2412567138671875},{-0.36777299642562866,0.30451521277427673,-0.15244203805923462,0.3648160398006439,0.14956524968147278,-0.2846203148365021,0.009638474322855473,0.1284264177083969},{-0.4086926579475403,-0.3085973262786865,-0.13838808238506317,-0.20563846826553345,-0.5026945471763611,0.14866173267364502,-0.04440061002969742,0.1746106594800949},{0.07537824660539627,0.3419578969478607,0.217927485704422,-0.018493253737688065,0.215639129281044,0.16148321330547333,-0.21159018576145172,0.23700420558452606},{0.12727388739585876,0.028458762913942337,0.2620800733566284,0.2595309019088745,-0.3177652359008789,0.3042413890361786,-0.007470011245459318,-0.21539413928985596},{0.058756936341524124,-0.33362215757369995,0.2624027132987976,-0.046873997896909714,-0.37799352407455444,-0.08181021362543106,-0.17782269418239594,-0.10618013143539429},{-0.24654287099838257,-0.26477399468421936,0.32465389370918274,0.35309773683547974,-0.26079729199409485,-0.06672033667564392,-0.3011142909526825,0.24266007542610168},{0.05947328731417656,-0.17622685432434082,0.13816994428634644,-0.22321194410324097,-0.2822766900062561,-0.12203013896942139,0.24801188707351685,0.013079643249511719},{0.18300652503967285,-0.0341053232550621,0.030366942286491394,-0.2238169014453888,0.060189440846443176,0.06303726136684418,0.12983931601047516,0.37846875190734863},{-0.027576515451073647,-0.3080974817276001,-0.16949495673179626,0.1344708949327469,-0.21611784398555756,-0.1466129571199417,-0.1277799755334854,0.1281011700630188},{-0.18419602513313293,-0.3305617570877075,0.022861860692501068,0.06015486270189285,0.11516018956899643,-0.19535215198993683,0.32887405157089233,0.18595317006111145},{-0.004725171718746424,0.08260500431060791,-0.27326279878616333,0.1373836100101471,0.10857756435871124,0.19192233681678772,-0.25537407398223877,0.38214269280433655},{0.1159115880727768,-0.04083860293030739,-0.382832795381546,0.11067517846822739,-0.05593729391694069,-0.025506721809506416,-0.3339974582195282,0.014364100992679596},{0.047385819256305695,-0.13096444308757782,0.05186111479997635,-0.0772509053349495,0.3461085557937622,0.05522996932268143,-0.02390654757618904,0.4100463092327118},{-0.006814479827880859,0.12130870670080185,-0.27228859066963196,0.31325048208236694,0.3759954869747162,0.3551570475101471,0.22119778394699097,-0.32355326414108276},{-0.47146549820899963,-0.14039936661720276,0.15081191062927246,-0.039802175015211105,0.22479429841041565,-0.27020353078842163,0.2822568416595459,-0.2911843955516815},{-0.26084721088409424,0.010218854993581772,-0.08647308498620987,-0.36974313855171204,0.2300846427679062,0.00440826965495944,-0.27799853682518005,0.16801024973392487},{-0.3232409954071045,-0.1979544311761856,-0.003209666581824422,0.05269237235188484,-0.09287896007299423,0.1339660882949829,0.35667967796325684,-0.1317654848098755},{-0.2883889675140381,0.05538148060441017,-0.3912898004055023,-0.32361456751823425,0.1692114621400833,0.035473696887493134,-0.040849700570106506,0.06752291321754456},{0.26885077357292175,0.3872483968734741,-0.31528425216674805,0.16183310747146606,0.22733889520168304,0.3996911346912384,-0.2525135576725006,-0.14452578127384186},{0.3017125725746155,0.25342124700546265,0.034184955060482025,0.05746789649128914,0.2977175712585449,0.21420399844646454,0.3027065098285675,0.37038475275039673},{-0.21535533666610718,0.3881070613861084,0.1446830779314041,-0.0014433800242841244,0.229560986161232,0.0589081346988678,-0.2951515316963196,-0.30519750714302063},{-0.29961517453193665,-0.21205630898475647,0.06894577294588089,-0.2628898620605469,-0.3052307665348053,-0.16493090987205505,0.3801317811012268,-0.08115287870168686},{0.2939082980155945,-0.23830874264240265,0.33496859669685364,-0.3255363702774048,0.018347306177020073,0.22865305840969086,0.2677304148674011,-0.2846626043319702},{0.11016485840082169,0.39398059248924255,0.3911740183830261,-0.25955381989479065,-0.28394028544425964,0.04135151579976082,0.2747447192668915,0.03730211406946182}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.011708536185324192,0.4658264219760895,-0.17866924405097961,0.2053259313106537,-0.4162399470806122,0.3170309066772461,0.3345264494419098,0.07809963822364807},{-0.5117083787918091,-0.4092213809490204,-0.37549522519111633,-0.43746834993362427,-0.47933539748191833,0.47617799043655396,0.3691111207008362,-0.38721612095832825},{0.11106827110052109,-0.179557204246521,0.15266837179660797,0.17467431724071503,-0.023214958608150482,0.46011579036712646,-0.3141513168811798,-0.47800910472869873},{0.46608254313468933,-0.059060219675302505,0.2040916383266449,0.03171468526124954,0.4975539445877075,0.4231288731098175,0.5209738612174988,0.3367747366428375},{0.09449217468500137,0.2085815817117691,-0.19353578984737396,-0.3149983286857605,0.06544521450996399,-0.5036397576332092,-0.5203953385353088,0.6189910769462585},{0.43918994069099426,0.0866050124168396,0.004033911973237991,-0.3643987476825714,-0.47460347414016724,-0.5012118816375732,-0.13320644199848175,0.4424343407154083},{-0.4721345901489258,-0.345217227935791,-0.10561506450176239,-0.25210097432136536,-0.01829531230032444,0.5257411599159241,-0.5446401834487915,0.5315147042274475},{0.23861925303936005,0.0781533345580101,-0.021906299516558647,0.07423977553844452,0.42264360189437866,-0.5517992377281189,0.4040016233921051,-0.36738649010658264}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07969601452350616,0.019323501735925674,0.03193965181708336,-0.016594035550951958,-0.040818892419338226,0.0294049009680748,0.010640140622854233,0.00012851017527282238};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.018505878746509552,-0.008431929163634777,-0.038126926869153976,0.03632824495434761,-0.013390916399657726,-0.006144771818071604,0.016970759257674217,-0.056361593306064606};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

