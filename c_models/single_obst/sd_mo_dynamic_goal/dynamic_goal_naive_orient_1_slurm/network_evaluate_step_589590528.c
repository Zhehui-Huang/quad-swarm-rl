#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3511659801006317,-0.2367553859949112,0.347234308719635,0.17384079098701477,-0.3977717459201813,0.11690743267536163,0.007570915389806032,-0.21248584985733032,0.07600608468055725,0.48069411516189575,0.11116648465394974,0.004822784103453159,0.1523093730211258,-0.14334283769130707,0.37941890954971313,-0.13854672014713287},{-0.3460147976875305,-0.23382949829101562,0.29778966307640076,0.14222857356071472,-0.23974250257015228,-0.02567286789417267,-0.3656732738018036,0.06521207094192505,-0.21599774062633514,-0.11382952332496643,0.13968901336193085,-0.14627547562122345,0.19095757603645325,-0.36744943261146545,-0.23782263696193695,0.07999751716852188},{0.15429550409317017,-0.2592606842517853,-0.2495545893907547,0.050966259092092514,0.12145103514194489,0.15631312131881714,-0.09335684776306152,0.00853748433291912,-0.09940306097269058,-0.17616760730743408,-0.20078633725643158,0.4062459170818329,-0.002951123518869281,-0.16039997339248657,-0.3720119297504425,0.2184201180934906},{0.17912739515304565,0.18322736024856567,0.3189854621887207,-0.10026815533638,-0.327005535364151,-0.011686784215271473,0.13676531612873077,0.11553598940372467,0.5024317502975464,-0.36979764699935913,0.0033580430317670107,0.13563314080238342,-0.29440075159072876,-0.062450941652059555,0.3210170269012451,-0.37456220388412476},{-0.04454547539353371,0.11410599201917648,0.231460303068161,-0.10939288884401321,0.23216944932937622,0.2613774240016937,0.2196718007326126,-0.06122034415602684,-0.039674997329711914,0.21307076513767242,0.3031983971595764,-0.13084182143211365,-0.11673688143491745,-0.3619401752948761,0.37672027945518494,0.11222720146179199},{-0.04354935139417648,-0.18903544545173645,-0.15277418494224548,-0.2597704231739044,0.11253989487886429,0.04985453933477402,-0.04484837129712105,-0.15858669579029083,0.21625542640686035,-0.22170698642730713,-0.3069821894168854,0.1786762923002243,0.3941693902015686,-0.026601072400808334,-0.059086769819259644,0.15846408903598785},{-0.06152249500155449,0.02764558605849743,0.08475232124328613,-0.24768544733524323,0.20316922664642334,0.022705426439642906,0.06143908202648163,0.392024427652359,0.27835577726364136,-0.00019134800822939724,-0.36372458934783936,0.2593497633934021,-0.06744923442602158,0.204970121383667,-0.17100487649440765,-0.15816722810268402},{-0.021393993869423866,-0.029024839401245117,0.263367623090744,0.20151305198669434,-0.36327797174453735,0.020192021504044533,0.2829492390155792,0.3253158926963806,-0.05207426846027374,0.19221293926239014,-0.4875738322734833,-0.30253100395202637,0.25843557715415955,0.2534793019294739,0.21393154561519623,0.16113312542438507},{0.3436643183231354,-0.2076832503080368,0.34620201587677,-0.021587738767266273,0.11568869650363922,0.10571704804897308,-0.18149308860301971,-0.23541992902755737,0.16360768675804138,-0.28910622000694275,0.018846476450562477,-0.2956274449825287,-0.16776330769062042,0.3045801818370819,0.14489395916461945,-0.09460017830133438},{0.0781397819519043,-0.23322589695453644,-0.45730969309806824,-0.0479927659034729,-0.32852599024772644,0.20543208718299866,0.4044444262981415,0.1500130444765091,0.466669499874115,0.38598552346229553,0.003362399060279131,-0.28491953015327454,0.11291803419589996,0.31118035316467285,-0.12872232496738434,-0.39364326000213623},{0.04542173072695732,0.265330970287323,0.37194493412971497,-0.28554701805114746,-0.30831214785575867,0.24108274281024933,0.18579885363578796,0.35409900546073914,-0.27917414903640747,-0.04667098820209503,-0.044461384415626526,0.1579671949148178,-0.274060994386673,-0.1995278000831604,0.32605522871017456,-0.3704490661621094},{0.06748172640800476,-0.1398780345916748,0.0030272402800619602,0.17022091150283813,0.3497464954853058,0.3130526840686798,0.43911218643188477,-0.012472768314182758,0.023374851793050766,-0.04092498496174812,0.26983070373535156,-0.16433604061603546,-0.002005885122343898,-0.26161500811576843,0.2802926003932953,0.2906189262866974},{-0.09833251684904099,0.2906724512577057,0.12782779335975647,-0.3131512403488159,0.10632123053073883,0.1118399053812027,0.3524508476257324,-0.03794723004102707,0.09323650598526001,-0.0026279957965016365,-0.09955543279647827,0.13641110062599182,0.16478699445724487,0.2835369110107422,0.1331438273191452,-0.2869085669517517},{-0.2541238069534302,-0.2634681165218353,-0.22983482480049133,-0.000864664267282933,-0.18518294394016266,0.08543991297483444,-0.32272469997406006,0.07069388777017593,-0.03314698860049248,-0.06485411524772644,-0.2584467828273773,-0.050402551889419556,-0.3328535854816437,0.07583527266979218,0.24105685949325562,0.1067236140370369},{-0.1921347975730896,-0.3363680839538574,-0.2586931586265564,0.33385100960731506,0.06935269385576248,-0.3451606333255768,0.29608675837516785,-0.10591188073158264,0.044108692556619644,0.2894754409790039,0.08463652431964874,0.1772002875804901,0.19878171384334564,-0.003995151724666357,-0.2181781381368637,0.21032020449638367},{0.45546701550483704,-0.07714161276817322,-0.21893304586410522,-0.42081552743911743,-0.5892706513404846,0.28048157691955566,0.4606744050979614,-0.2674004137516022,0.12673744559288025,0.07556308805942535,-0.26066988706588745,0.06345945596694946,-0.5249713659286499,0.5331469178199768,-0.2687514126300812,-0.036892570555210114},{-0.41703787446022034,-0.35976117849349976,0.4144226312637329,0.33829590678215027,-0.2748839855194092,0.312510222196579,-0.08285004645586014,-0.29504498839378357,0.2554217278957367,-0.45102548599243164,-0.28762638568878174,-0.6750349998474121,-0.28000643849372864,-0.4158366024494171,0.02108743041753769,-0.18081039190292358},{-0.371639221906662,0.2660006582736969,-0.5519258379936218,-0.05095120146870613,0.017783211544156075,0.3865523636341095,-0.3833037316799164,-0.39860010147094727,0.23730584979057312,0.23024135828018188,0.40039145946502686,-0.039079003036022186,-0.23592373728752136,0.2557053864002228,0.17737457156181335,-0.5027348399162292}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.09802930802106857,-0.10295405238866806,-0.1878705620765686,-0.4101545214653015,0.37116411328315735,0.26801225543022156,0.06978216767311096,0.07994304597377777,-0.2337615191936493,-0.10419607162475586,-0.08065773546695709,0.032291851937770844,0.2261435091495514,0.46885213255882263,0.11458542197942734,0.10196094214916229},{-0.18082444369792938,-0.24108268320560455,-0.03055945225059986,0.14093941450119019,0.3101302981376648,-0.22207748889923096,0.1577145904302597,0.04444028064608574,-0.060820017009973526,0.2569434940814972,-0.13226641714572906,0.345844566822052,-0.353936105966568,0.20888087153434753,-0.34558001160621643,-0.25434765219688416},{0.15821222960948944,0.20593209564685822,-0.3623132109642029,-0.6143338680267334,0.17797550559043884,0.44770342111587524,-0.09835754334926605,0.10814429074525833,-0.2702362835407257,-0.24462342262268066,-0.02905995026230812,0.2679860293865204,-0.29547664523124695,-0.23794396221637726,0.12730394303798676,-0.038430627435445786},{0.2146577388048172,-0.04755808413028717,0.0668443888425827,0.14788249135017395,-0.498917818069458,0.012429322116076946,0.031099505722522736,-0.2720813751220703,0.3247182071208954,0.3507651090621948,-0.13884231448173523,-0.19067226350307465,-0.414986252784729,-0.3450234830379486,0.21349070966243744,0.2293495237827301},{-0.16031788289546967,0.07259302586317062,0.05380118265748024,0.31676170229911804,-0.2565544545650482,0.001653037965297699,-0.018030906096100807,0.2193046361207962,0.22862569987773895,-0.27045464515686035,0.03176723048090935,0.38815969228744507,0.11607261002063751,-0.42063406109809875,-0.08971895277500153,-0.14003214240074158},{0.20648838579654694,0.16844013333320618,-0.019385509192943573,0.17190735042095184,-0.3477799892425537,-0.41366124153137207,0.2177930325269699,0.2763230800628662,0.12417741864919662,0.43429920077323914,0.2386530488729477,-0.26561883091926575,0.022950200363993645,-0.15170985460281372,-0.07378733158111572,0.31412529945373535},{-0.053001221269369125,0.1524248570203781,0.3781300187110901,-0.3481670022010803,-0.14845238626003265,0.0564459003508091,-0.2863498628139496,-0.051369305700063705,0.1107252761721611,0.10217165946960449,-0.11822918802499771,-0.2988092601299286,-0.2388564646244049,0.04321092367172241,0.15522035956382751,0.08400644361972809},{-0.15980590879917145,-0.1481223702430725,-0.38574662804603577,0.2782910466194153,-0.2505234181880951,-0.31323572993278503,-0.18545103073120117,-0.33004438877105713,0.03233867138624191,-0.16757850348949432,-0.12894518673419952,0.16859251260757446,-0.23199674487113953,0.4191362261772156,-0.0989641547203064,-0.3866788446903229},{-0.21927514672279358,0.2962578237056732,-0.009231969714164734,-0.032523263245821,0.32055819034576416,-0.22167231142520905,0.387414813041687,0.12375623732805252,0.23486845195293427,0.3801327049732208,0.24632254242897034,0.3006516098976135,0.2491949200630188,-0.02508220635354519,0.28422465920448303,0.12655267119407654},{0.12140024453401566,-0.28330835700035095,-0.027758806943893433,-0.12406040728092194,0.3174407184123993,-0.050155993551015854,-0.30745112895965576,-0.24550417065620422,0.06948849558830261,-0.4606749415397644,-0.16059601306915283,0.20242656767368317,0.1456824392080307,0.15769170224666595,-0.3191443979740143,0.2974260747432709},{-0.12249267101287842,-0.3501057028770447,0.45014652609825134,0.2298991084098816,0.22122445702552795,0.1477953940629959,0.09766364097595215,-0.1503397524356842,0.12569482624530792,-0.20770835876464844,-0.0013510638382285833,0.40404000878334045,0.30009326338768005,0.12797673046588898,-0.22135914862155914,-0.006678502541035414},{0.016071226447820663,-0.13822345435619354,0.26360172033309937,0.014161930419504642,-0.14824120700359344,-0.22015869617462158,0.4664706885814667,0.297710657119751,-0.28026556968688965,-0.38046717643737793,-0.10865393280982971,-0.33560386300086975,0.018596086651086807,-0.340599000453949,-0.3465290367603302,-0.00522216223180294},{-0.04230431094765663,-0.32208317518234253,0.3030465543270111,-0.21971246600151062,0.30553293228149414,-0.31258976459503174,-0.3600698411464691,0.16769130527973175,0.07974597811698914,-0.03507022559642792,-0.29271388053894043,0.06627210229635239,0.07477938383817673,-0.2704508602619171,-0.36501309275627136,0.0006179875344969332},{0.3062135577201843,-0.2868014872074127,0.4612131714820862,0.15607023239135742,0.03574030473828316,0.29796335101127625,-0.06175853684544563,-0.20635753870010376,-0.5203263759613037,0.11904482543468475,0.01296821516007185,-0.3663496971130371,-0.00950867310166359,0.21714556217193604,0.33548927307128906,0.038898590952157974},{-0.24286434054374695,0.14783169329166412,0.12815333902835846,-0.3115214407444,-0.20943430066108704,0.03050699643790722,0.23338493704795837,-0.12619616091251373,0.17141610383987427,-0.371769517660141,-0.009310542605817318,0.057778626680374146,-0.024441799148917198,0.05807700380682945,-0.13275301456451416,0.009163838811218739},{-0.21273763477802277,0.30168306827545166,-0.30431699752807617,0.3459508419036865,0.14171604812145233,-0.37292125821113586,-0.11266832798719406,-0.09627194702625275,-0.37079915404319763,0.28095710277557373,-0.34520450234413147,0.3127538561820984,-0.07789163291454315,-0.17229604721069336,-0.2838056981563568,-0.5207253694534302}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.153189554810524,0.0013090395368635654,-0.05554768815636635,-0.04000471532344818,-0.11073029786348343,0.03298095613718033,0.2894671559333801,0.04737004265189171,-0.12788358330726624,-0.20705175399780273,0.11305437982082367,-0.29755985736846924,-0.19694988429546356,0.2287185788154602,0.2087833434343338,0.2977224588394165,-0.23782037198543549,-0.30524420738220215,-0.19823548197746277,0.04505828768014908,-0.04087156802415848,-0.3414974808692932,-0.2410622537136078,-0.267884761095047,-0.30775129795074463,0.22441819310188293,-0.23223796486854553,-0.026701077818870544,-0.013534213416278362,0.004999801516532898,0.2259172648191452,-0.1705034226179123},{0.27684834599494934,0.2261418104171753,0.14223115146160126,-0.06466859579086304,0.09502103179693222,-0.10030923783779144,0.27185145020484924,0.13730020821094513,-0.18951258063316345,-0.15569095313549042,-0.04999753460288048,-0.2525573670864105,-0.1598055213689804,0.18155503273010254,-0.20748138427734375,-0.3197617828845978,-0.05698147043585777,0.1422112137079239,-0.30350983142852783,-0.2778302729129791,0.017991291359066963,0.23636582493782043,0.11400270462036133,-0.11071044206619263,0.16059893369674683,-0.2840935289859772,0.030409138649702072,0.07945714145898819,0.21820728480815887,-0.11608708649873734,-0.0309625081717968,0.25756460428237915},{0.24357393383979797,0.07295165210962296,-0.03866105154156685,0.1138734370470047,-0.1616913229227066,-0.17669391632080078,-0.23652631044387817,0.14138475060462952,-0.11113385856151581,0.3680281937122345,-0.30122068524360657,-0.1974821835756302,0.16245019435882568,-0.3568381667137146,-0.16354265809059143,0.1256498098373413,-0.11801997572183609,-0.12507092952728271,0.2443176954984665,-0.020043976604938507,0.21043501794338226,0.25798097252845764,-0.2656884491443634,0.04448291286826134,-0.17235183715820312,-0.10665522515773773,0.128037691116333,-0.07525424659252167,-0.08628901839256287,-0.163486048579216,-0.0653524249792099,-0.1334843784570694},{0.3236859440803528,0.07207085937261581,0.08881030231714249,-0.14191938936710358,-0.26288771629333496,-0.08483515679836273,-0.1364017128944397,0.2249995619058609,0.24510805308818817,-0.20365893840789795,-0.10846279561519623,0.27222996950149536,0.120721235871315,-0.1108257994055748,-0.23180338740348816,0.3193846046924591,-0.3138648271560669,0.25159698724746704,-0.02638336643576622,0.04172525927424431,-0.0644141361117363,-0.0989670380949974,0.2836451530456543,0.16777265071868896,0.15887054800987244,-0.3065938949584961,0.30970314145088196,-0.2050258368253708,-0.024205053225159645,0.015628667548298836,-0.31124722957611084,0.15539433062076569},{-0.02954784594476223,-0.03923283517360687,-0.07915885001420975,0.048426803201436996,0.20227693021297455,-0.16386109590530396,-0.3722146451473236,-0.001960089895874262,-0.13783776760101318,-0.19315364956855774,0.15527811646461487,0.22951816022396088,-0.09056788682937622,-0.08528736978769302,-0.07484425604343414,0.2092641144990921,-0.045367367565631866,-0.0017465626588091254,-0.33221134543418884,-0.04921151325106621,-0.18099857866764069,-0.3487825095653534,0.16440407931804657,0.2308180034160614,-0.06447383761405945,0.27284273505210876,-0.1686880737543106,0.23996485769748688,0.28363358974456787,0.3575475215911865,-0.004539312329143286,0.2985338270664215},{-0.22116893529891968,-0.12093941867351532,-0.1373780369758606,-0.057182326912879944,-0.11709451675415039,0.21121720969676971,0.22347722947597504,0.033369895070791245,0.3297247588634491,0.13990524411201477,0.26772189140319824,-0.2233247607946396,-0.15971454977989197,0.23497295379638672,0.24882304668426514,-0.345334529876709,-0.10654155164957047,-0.24330031871795654,0.2196625918149948,0.14183442294597626,0.08669668436050415,0.11681849509477615,-0.011565095745027065,-0.0137089304625988,-0.3584561347961426,0.3161257803440094,-0.21181537210941315,0.14100231230258942,0.3236570656299591,0.22201786935329437,0.07417937368154526,0.05037862807512283},{0.17388369143009186,-0.13805824518203735,-0.1330576241016388,-0.33101439476013184,0.010803432203829288,0.2301778793334961,0.2729608714580536,0.12365870177745819,0.107371985912323,0.3013871908187866,0.00036379339871928096,-0.0001833875139709562,-0.4189179241657257,-0.12187524139881134,-0.14641691744327545,0.03215424716472626,-0.2772466540336609,-0.21395760774612427,0.1699729710817337,-0.09332780539989471,-0.11695467680692673,-0.14940813183784485,-0.23342108726501465,-0.26040399074554443,0.18693777918815613,-0.2764075696468353,-0.12794096767902374,-0.2111702412366867,0.33113929629325867,0.12340027093887329,-0.17631959915161133,-0.2827688455581665},{0.07129783928394318,0.1733989119529724,0.056011829525232315,-0.12764286994934082,0.1543034315109253,-0.2944393455982208,-0.05753915756940842,-0.15991196036338806,0.014396739192306995,-0.28320547938346863,-0.304425448179245,-0.09699349105358124,-0.11295977234840393,0.07170114666223526,-0.12456509470939636,0.3860577344894409,0.00970193836838007,-0.14221124351024628,0.12490256875753403,0.3293103277683258,-0.1848451942205429,-0.20069384574890137,0.2730783224105835,0.077932208776474,0.006032775621861219,-0.3444891571998596,-0.3327922821044922,-0.22374676167964935,-0.37399065494537354,-0.26239362359046936,0.10536452382802963,-0.3771921992301941},{0.044180721044540405,0.4073329567909241,-0.36809268593788147,-0.3640822768211365,-0.28261247277259827,0.10123924165964127,0.0708717405796051,0.12531909346580505,0.09099673479795456,-0.23999843001365662,-0.19477927684783936,0.2909954786300659,-0.3534655272960663,-0.19044367969036102,0.19339294731616974,-0.22830262780189514,0.23185193538665771,0.12103798985481262,0.30967602133750916,0.06969186663627625,0.206620991230011,0.13602109253406525,0.33145010471343994,-0.13798487186431885,0.46404242515563965,-0.19566769897937775,0.20946456491947174,0.343975305557251,-0.18732617795467377,0.11885828524827957,0.02868654765188694,0.0917094349861145},{-0.21858318150043488,0.10830482840538025,-0.3493678569793701,-0.16436943411827087,0.10746634006500244,-0.2179788053035736,0.10186133533716202,-0.009855487383902073,0.1788388341665268,0.057691384106874466,-0.2538488507270813,-0.33753350377082825,-0.41713178157806396,-0.11225442588329315,-0.23998813331127167,0.09113335609436035,-0.03234551474452019,-0.2609690725803375,0.21240130066871643,0.06200307980179787,0.08901979774236679,-0.024335522204637527,0.388719379901886,-0.21453359723091125,0.31654617190361023,0.16912494599819183,-0.2255178987979889,0.05069045349955559,0.025881148874759674,0.05125872790813446,-0.19733701646327972,0.14529286324977875},{0.08672843128442764,-0.02729603834450245,0.1727394461631775,-0.2726781368255615,-0.23552750051021576,-0.22671428322792053,-0.25536397099494934,-0.07806526869535446,-0.16433599591255188,0.3249616026878357,0.12490694969892502,-0.2818724811077118,-0.34006914496421814,-0.014064892195165157,-0.22299998998641968,-0.18440786004066467,0.247048020362854,-0.1482030302286148,0.26389002799987793,-0.2132597416639328,-0.19028931856155396,0.01441636960953474,0.17305074632167816,0.1724262684583664,0.17947880923748016,-0.14769898355007172,-0.06481436640024185,-0.06725301593542099,-0.05648769065737724,0.01809612289071083,-0.06792532652616501,0.16198381781578064},{-0.21739086508750916,-0.03002779930830002,0.23554794490337372,0.3266489803791046,0.2575180232524872,-0.004883690737187862,0.05770089104771614,-0.2134881317615509,-0.10060395300388336,-0.19359652698040009,0.2907133996486664,-0.23581919074058533,-0.2127796709537506,-0.20479819178581238,0.29451149702072144,-0.003377581015229225,-0.016057193279266357,0.01701856590807438,0.33616653084754944,0.07761570066213608,-0.17984434962272644,0.22786949574947357,0.10966277122497559,-0.10476424545049667,0.19764795899391174,-0.10518612712621689,-0.1333499699831009,0.22409139573574066,0.2053132951259613,-0.011185117065906525,-0.2692647874355316,-0.250550240278244},{0.2291100025177002,-0.2422589659690857,-0.005764218047261238,-0.35568901896476746,0.13826052844524384,-0.06439856439828873,0.1597583144903183,0.07491485029459,0.2490682154893875,0.07370356470346451,0.13400571048259735,0.19288823008537292,-0.36187127232551575,-0.2335815280675888,-0.07205315679311752,-0.2157421112060547,-0.12884292006492615,-0.20238365232944489,0.2512924075126648,-0.23548097908496857,0.2633885443210602,0.011010825634002686,-0.02067592740058899,0.17361631989479065,0.13891251385211945,-0.07862917333841324,0.12249709665775299,0.15993724763393402,0.13040229678153992,-0.07913214713335037,-0.21208132803440094,-0.09725509583950043},{0.2395574003458023,-0.0406983457505703,-0.0494157075881958,0.4250563085079193,-0.09745275974273682,-0.19908680021762848,-0.06938447803258896,0.11058405786752701,0.16952361166477203,0.29932910203933716,0.13294121623039246,-0.14343763887882233,0.027476685121655464,0.1915740817785263,-0.09553267806768417,0.06531719863414764,0.19598670303821564,-0.23837396502494812,0.0619862861931324,-0.3287205100059509,0.32640334963798523,0.1457398235797882,-0.06112528219819069,0.1837134063243866,0.1847895085811615,0.0769663155078888,0.09798897057771683,0.062099628150463104,0.06922018527984619,-0.14503903687000275,-0.04074607789516449,0.4101124405860901},{0.028285371139645576,-0.2790747582912445,-0.0818035826086998,0.12706570327281952,-0.23643867671489716,-0.01760517805814743,0.05869686231017113,-0.27659299969673157,-0.14207743108272552,-0.052084460854530334,0.1736210733652115,0.13705837726593018,0.09400001168251038,0.2636794149875641,-0.06871642172336578,-0.10071243345737457,-0.23320327699184418,0.2683880627155304,-0.10510329902172089,-0.2796967029571533,-0.17964084446430206,-0.08642273396253586,0.1781788170337677,-0.005578140262514353,-0.04724220559000969,-0.07315712422132492,-0.21796387434005737,0.21728143095970154,0.06548888981342316,-0.17906653881072998,0.21947415173053741,0.19592773914337158},{0.13420194387435913,-0.23615127801895142,-0.08741508424282074,-0.18231895565986633,-0.09240851551294327,0.15879444777965546,0.03211221471428871,0.23609448969364166,-0.09030450135469437,0.013008488342165947,0.25202372670173645,0.10969388484954834,-0.051914118230342865,-0.12522338330745697,0.036889445036649704,0.14965873956680298,-0.4086272418498993,-0.2787846624851227,-0.06388847529888153,0.04911156743764877,0.12215069681406021,0.23522208631038666,0.272683322429657,0.1414751559495926,0.05379411578178406,0.2293597012758255,0.012062008492648602,-0.07134124636650085,0.19333218038082123,-0.12307867407798767,-0.25528469681739807,0.3697485327720642},{0.19701844453811646,-0.020258614793419838,-0.24068327248096466,0.15920604765415192,0.08755190670490265,-0.042836397886276245,0.26835864782333374,0.11868411302566528,0.10810204595327377,-0.21904294192790985,0.21223804354667664,-0.17535708844661713,-0.35572561621665955,0.24839521944522858,0.06669360399246216,0.06378749758005142,0.06689132004976273,-0.046928487718105316,-0.1271275132894516,0.06617128103971481,-0.07404717803001404,0.20131169259548187,0.052790317684412,-0.14128442108631134,0.041173771023750305,-0.29862818121910095,0.035753291100263596,0.41946491599082947,0.22063131630420685,-0.13481658697128296,0.21803565323352814,0.1866215020418167},{-0.06428338587284088,-0.038699571043252945,-0.09680040180683136,-0.030776247382164,-0.2536862790584564,-0.03874992951750755,0.18770644068717957,0.17787624895572662,0.13814550638198853,-0.005788134876638651,0.2379245012998581,0.009718680754303932,0.20979483425617218,0.16741730272769928,0.17401280999183655,-0.09188215434551239,0.1180187463760376,0.16025590896606445,0.24587701261043549,0.07146809995174408,0.18881773948669434,0.2392583191394806,0.0590209998190403,0.13207320868968964,-0.011028369888663292,-0.09648354351520538,-0.09290517866611481,-0.25112494826316833,0.16865335404872894,-0.23214974999427795,0.014474730007350445,-0.02055126056075096},{-0.3144107758998871,0.10766945034265518,-0.290704607963562,-0.35993772745132446,-0.018558036535978317,0.05916918069124222,0.12614870071411133,-0.1097007691860199,-0.0029363606590777636,0.31135043501853943,0.06170900538563728,-0.21095095574855804,0.06624187529087067,-0.19026082754135132,-0.30813363194465637,-0.016607996076345444,-0.1827940046787262,0.15089744329452515,-0.02260534092783928,-0.055017177015542984,-0.3195072412490845,0.18591636419296265,0.13409297168254852,0.027237186208367348,-0.01081763207912445,0.279340535402298,0.02757667750120163,-0.1318981945514679,-0.1803593635559082,0.012017191387712955,-0.14513704180717468,-0.25067904591560364},{-0.003950109239667654,-0.21511970460414886,-0.22190965712070465,-0.026697451248764992,-0.3613254129886627,-0.15707485377788544,0.15987499058246613,-0.2977994382381439,-0.2020399421453476,0.19648626446723938,0.14610616862773895,0.12360967695713043,0.13690462708473206,-0.11195234209299088,0.3123621344566345,-0.3222986161708832,0.06999001652002335,0.22325429320335388,0.05606485903263092,0.2401428371667862,0.04941525682806969,-0.11530493944883347,-0.28431421518325806,0.19413194060325623,-0.18005363643169403,-0.16222159564495087,0.10482653975486755,0.036906611174345016,-0.11562781035900116,-0.29684796929359436,-0.036707159131765366,-0.13534079492092133},{0.22357816994190216,0.18930760025978088,-0.08366371691226959,0.16958795487880707,-0.2826661169528961,0.16958072781562805,-0.06497632712125778,-0.13792426884174347,-0.18422336876392365,0.20611338317394257,-0.2643876075744629,-0.16498231887817383,-0.052531711757183075,-0.19139254093170166,-0.36939167976379395,-0.12678465247154236,-0.08757498115301132,-0.27397868037223816,-0.23936624825000763,0.2815219461917877,0.09889354556798935,0.12133009731769562,-0.3330698609352112,0.33467400074005127,0.19272875785827637,0.2632465958595276,-0.2863588333129883,-0.03490516543388367,0.06692206859588623,-0.2632231116294861,0.12216750532388687,0.09418542683124542},{0.007397792302072048,-0.3288257420063019,0.02796795964241028,-0.2619219124317169,-0.0778859406709671,0.2646973133087158,0.15264520049095154,0.018552348017692566,-0.04055270552635193,-0.00698016956448555,-0.20757511258125305,0.18086324632167816,0.16836217045783997,0.11132105439901352,0.16527877748012543,-0.013433045707643032,-0.07881084084510803,0.10579031705856323,-0.08311747014522552,0.16522370278835297,0.2362130731344223,0.22026154398918152,-0.08005416393280029,-0.25716477632522583,0.08460728824138641,0.09574906527996063,0.26762655377388,0.12823127210140228,-0.023860065266489983,0.21162666380405426,0.037335094064474106,-0.09748279303312302},{0.03399936854839325,-0.1805925816297531,0.24744713306427002,0.001130252843722701,0.30903902649879456,-0.024457398802042007,-0.1055666133761406,-0.15437281131744385,0.1422453075647354,-0.07869227230548859,0.07110851258039474,0.0019814877305179834,-0.28275391459465027,0.02138451300561428,-0.10698986798524857,-0.24298343062400818,-0.03471645712852478,-0.03775331750512123,0.2136317640542984,0.25294390320777893,0.02548331767320633,0.03900203853845596,0.16643330454826355,0.3498750925064087,-0.15719923377037048,-0.07436183094978333,0.19879409670829773,-0.11341921240091324,-0.2074090540409088,-0.2367660254240036,0.3158111274242401,-0.012039379216730595},{0.20233555138111115,-0.07397674024105072,0.038280460983514786,0.13164770603179932,-0.029499443247914314,0.04967464879155159,-0.27088192105293274,0.2728756368160248,-0.07019883394241333,-0.03745459020137787,0.10349494963884354,-0.27008843421936035,-0.0023264901246875525,-0.01317079458385706,-0.1011785939335823,0.2732630670070648,-0.09213753044605255,-0.19792665541172028,0.038902029395103455,-0.009964069351553917,-0.16655200719833374,0.2012810856103897,0.23287981748580933,0.21225720643997192,-0.28162670135498047,0.11220686882734299,-0.06312581896781921,0.08411815017461777,-0.28221383690834045,0.27971795201301575,-0.03142353147268295,0.05098326876759529}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.20812445878982544,-0.09067607671022415,0.09190341085195541,-0.1524306833744049},{0.19480781257152557,-0.31972354650497437,0.2596505284309387,0.22989816963672638},{-0.24637725949287415,0.10686144977807999,0.051448095589876175,-0.00833662785589695},{0.2802630364894867,0.4588792622089386,0.3528028726577759,0.03633738309144974},{-0.2572075128555298,0.12280365824699402,-0.28928786516189575,0.09321966767311096},{-0.05120192468166351,-0.04464992135763168,0.06010770425200462,0.36924004554748535},{-0.10729911178350449,-0.08843985944986343,-0.3252250552177429,0.002058860380202532},{-0.15632863342761993,-0.2493228167295456,0.16710542142391205,-0.06889443844556808},{-0.054305292665958405,0.08546756953001022,-0.0805436298251152,-0.08774644881486893},{0.22188660502433777,0.014424149878323078,-0.09789900481700897,-0.1775413453578949},{0.15275554358959198,-0.11544260382652283,0.29213327169418335,0.2545314431190491},{-0.021288933232426643,0.0117225656285882,0.3355156183242798,-0.06713022291660309},{-0.3336122930049896,0.20152173936367035,-0.014529627747833729,-0.1346837729215622},{-0.16891543567180634,0.09501715749502182,-0.2096291184425354,0.09008384495973587},{0.16555120050907135,0.03700355067849159,0.2625542879104614,0.10340722650289536},{-0.14191769063472748,-0.34467941522598267,-0.13130557537078857,-0.09962648153305054},{-0.2768620550632477,0.030831048265099525,-0.07971524447202682,0.2864517867565155},{-0.2483888566493988,-0.12722143530845642,-0.20235571265220642,0.18927036225795746},{-0.07479500025510788,-0.08036968111991882,0.34400874376296997,0.0732397809624672},{-0.18723143637180328,-0.12932179868221283,0.018654590472579002,-0.18064896762371063},{0.14804264903068542,0.10623254626989365,0.14932534098625183,-0.16193655133247375},{-0.05049900710582733,-0.2648649215698242,-0.09060726314783096,0.2520413398742676},{0.3846145272254944,-0.20132800936698914,0.14286991953849792,0.046699408441782},{-0.3219088017940521,-0.1102512925863266,-0.3139619529247284,-0.330341637134552},{-0.14570072293281555,-0.1812886893749237,-0.07417786121368408,-0.09101320058107376},{0.14770051836967468,0.11283881962299347,-0.04513457417488098,0.0917072519659996},{0.13138142228126526,-0.19463446736335754,0.2650778293609619,0.07903212308883667},{-0.0842747837305069,-0.14764317870140076,-0.011542163789272308,0.27366939187049866},{0.10403643548488617,0.03239745274186134,0.06561507284641266,0.04747912660241127},{-0.1437075436115265,0.11005856841802597,0.23610813915729523,0.009255459532141685},{-0.23800435662269592,-0.10200691968202591,0.07574224472045898,0.20901839435100555},{0.2496107965707779,0.1944320648908615,0.2681827247142792,-0.03396373987197876}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.12100329995155334,-0.10090073198080063,0.04377957805991173,0.0936928242444992,0.10438940674066544,-0.11332914233207703,0.088384710252285,-0.0034606263507157564,-0.06562013179063797,-0.09724590927362442,-0.001340710325166583,0.061345987021923065,-0.0157295111566782,0.05738246440887451,0.10391858965158463,-0.029567580670118332};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.01801140047609806,0.05438415706157684,0.06647606939077377,-0.02081025205552578,-0.04423272982239723,0.05188781023025513,-0.05426477640867233,-0.07672236114740372,0.05438441038131714,-0.003242131322622299,-0.024134811013936996,-0.028887266293168068,-0.00273165968246758,-0.08229130506515503,0.017488054931163788,-0.07270146161317825};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04778050258755684,0.0019986440893262625,-0.06566749513149261,0.03750535845756531,-0.003539726138114929,0.016813598573207855,-0.05325663462281227,-0.041873615235090256,-0.022371608763933182,-0.01493553165346384,0.011390749365091324,0.036856189370155334,0.032311998307704926,-0.0483369417488575,0.03085092455148697,-0.0744176134467125,-0.007771703414618969,-0.03654635697603226,0.022120971232652664,-0.0582076832652092,0.021801622584462166,-0.004852656275033951,0.032404035329818726,-0.06902824342250824,-0.057002682238817215,0.058708369731903076,0.04708710312843323,-0.02681361697614193,0.0705970972776413,0.018603544682264328,-0.01029901672154665,0.05285016819834709};
static const float action_parameterization_distribution_linear_bias[4] = {0.03697913885116577,0.051288310438394547,0.007246846333146095,0.0364716611802578};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3331473767757416,-0.20123831927776337,-0.0010763659374788404,0.17593920230865479,-0.02035960927605629,0.020876532420516014,-0.17314937710762024,0.01152282115072012},{0.04301400110125542,0.0942525714635849,0.35982680320739746,0.33856257796287537,-0.09717576205730438,-0.2476596087217331,0.34733057022094727,0.11294501274824142},{-0.0017110095359385014,0.21158930659294128,0.04523737356066704,-0.053335271775722504,0.31432002782821655,0.2381521463394165,-0.054509107023477554,0.07333816587924957},{0.0801510363817215,-0.23443439602851868,0.27060481905937195,-0.24412879347801208,-0.2960797846317291,0.03205041214823723,0.21246252954006195,0.16466103494167328},{-0.22515636682510376,-0.0005945077864453197,-0.020656868815422058,-0.2883254289627075,0.052991025149822235,0.05144723877310753,0.2645357549190521,0.23831167817115784},{-0.0796247199177742,0.3005129396915436,-0.07276110351085663,-0.2609584927558899,0.12558041512966156,0.020717423409223557,0.01971348747611046,-0.2127031683921814},{-0.01378573663532734,0.3306240737438202,0.14306364953517914,-0.14921577274799347,0.18938827514648438,-0.2579416036605835,0.2382301539182663,0.07886119931936264},{0.00963255949318409,-0.18284469842910767,0.052145618945360184,-0.0792788490653038,0.2673811614513397,-0.13284459710121155,0.0008427490247413516,-0.2707304060459137},{-0.15750418603420258,0.31424665451049805,0.1717994660139084,-0.013797547668218613,0.018318189308047295,0.19801536202430725,0.45945483446121216,0.3744494318962097},{0.049405694007873535,-0.048430610448122025,-0.25821539759635925,0.3662284016609192,0.24223366379737854,0.14674600958824158,0.200219064950943,-0.2697334587574005},{-0.12281234562397003,-0.30177751183509827,0.3484354317188263,0.21998950839042664,-0.042979080229997635,-0.40240514278411865,-0.11258082836866379,-0.319537878036499},{0.3099841773509979,0.07659415900707245,0.37509167194366455,0.479394793510437,-0.1611338108778,0.17913401126861572,0.13436371088027954,-0.3750867247581482},{-0.29712361097335815,0.18322056531906128,-0.32820695638656616,0.4112071096897125,-0.04295038804411888,0.23657168447971344,0.022371765226125717,0.24375708401203156},{-0.019526947289705276,0.21203480660915375,-0.06629413366317749,-0.18562017381191254,0.04357545077800751,0.04780299589037895,0.3163899779319763,-0.029094042256474495},{0.14738315343856812,-0.30068883299827576,-0.27669405937194824,-0.1806490421295166,0.21817362308502197,-0.19631408154964447,0.24234677851200104,-0.13905560970306396},{-0.36631685495376587,-0.3455195128917694,-0.27017927169799805,-0.013981073163449764,0.02894681505858898,0.08942337334156036,0.24399609863758087,-0.008020536974072456},{-0.22125446796417236,-0.22184178233146667,0.1434677541255951,-0.28770187497138977,0.07052190601825714,0.06568124145269394,-0.3958039879798889,-0.26240822672843933},{0.034788645803928375,0.2853788733482361,0.04745246097445488,0.16195881366729736,-0.10143596678972244,0.31920355558395386,0.26657697558403015,-0.17536324262619019},{-0.010659866966307163,-0.27505698800086975,-0.13330726325511932,-0.05175961181521416,-0.06051328778266907,-0.3448003828525543,0.09967243671417236,-0.23047791421413422},{-0.11670422554016113,0.02474179118871689,0.07693152129650116,-0.2648073136806488,0.12774904072284698,0.07090886682271957,0.10578987002372742,-0.004712834022939205},{0.027272040024399757,-0.046403005719184875,0.07694460451602936,-0.17597520351409912,0.04157451540231705,-0.050661396235227585,0.09630260616540909,-0.15977567434310913},{-0.3061629831790924,0.20868070423603058,0.18908698856830597,-0.27682602405548096,-0.3901517689228058,-0.040418319404125214,0.20345917344093323,0.0420529842376709},{0.2753828465938568,0.0574193149805069,-0.3740968704223633,0.006867981515824795,-0.07014653086662292,0.2337520271539688,0.23849911987781525,0.3030974268913269},{0.004722431302070618,-0.20735760033130646,-0.043687596917152405,0.12008433789014816,-0.3237239420413971,-0.08280105143785477,-0.24722518026828766,-0.28704237937927246},{0.1208992525935173,-0.08566779643297195,-0.40324652194976807,0.34101516008377075,-0.34194743633270264,-0.11880193650722504,-0.45603683590888977,0.09993328899145126},{0.0003046756028197706,0.32342493534088135,-0.20574453473091125,-0.10241219401359558,0.08059734106063843,-0.1532885581254959,0.2657262086868286,-0.2733885645866394},{-0.1092844307422638,0.09443295747041702,-0.1109977588057518,-0.24021507799625397,0.011592765338718891,-0.12603534758090973,-0.1438034325838089,-0.09634692221879959},{0.07925914973020554,-0.1680750995874405,0.02143125981092453,-0.13783670961856842,0.06299211829900742,0.08233406394720078,-0.25166237354278564,0.10815984010696411},{0.18966053426265717,0.008156278170645237,-0.3228354752063751,-0.2119639813899994,-0.18274623155593872,0.1802566796541214,0.20370414853096008,0.03871531039476395},{0.30236896872520447,-0.3610621690750122,0.004812542349100113,-0.06203519180417061,0.11643504351377487,-0.07797189801931381,0.14300402998924255,0.23596318066120148},{-0.27852872014045715,-0.21395279467105865,0.04067355766892433,-0.3723583519458771,0.2886021137237549,-0.33115410804748535,-0.0529961995780468,0.09289125353097916},{0.2595679759979248,0.20535099506378174,0.005254313815385103,0.22416828572750092,0.11120510846376419,-0.16633102297782898,-0.06189810112118721,0.1636335849761963}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2197781503200531,0.426814466714859,-0.4653773903846741,-0.5276841521263123,-0.17345039546489716,-0.09726469963788986,-0.3734388053417206,0.5091760158538818},{-0.02800530008971691,0.4209038317203522,-0.25118887424468994,0.5487115383148193,-0.02095286175608635,-0.04821879416704178,-0.3385973870754242,-0.009194549173116684},{-0.3416936695575714,-0.2070152908563614,-0.14571598172187805,-0.10102816671133041,0.42529919743537903,0.20125247538089752,-0.06611525267362595,0.40537574887275696},{-0.4945823848247528,-0.4882415235042572,0.32749953866004944,0.2641579210758209,-0.4843739867210388,-0.20639044046401978,0.4323994219303131,0.21216356754302979},{-0.26722490787506104,-0.26414456963539124,-0.2978734076023102,-0.1763146072626114,0.3443177044391632,-0.22942055761814117,0.47933173179626465,-0.37682008743286133},{-0.039063334465026855,0.2556779980659485,0.1362053006887436,-0.5541089773178101,0.5326505303382874,-0.24435557425022125,-0.5079424977302551,-0.3535003066062927},{-0.2925013303756714,0.1211681142449379,0.06472408026456833,-0.4466732144355774,0.03856572136282921,-0.4992775022983551,0.4567543864250183,0.06557658314704895},{-0.32338789105415344,-0.14561623334884644,-0.14448755979537964,-0.36055615544319153,-0.37257257103919983,0.10020912438631058,0.5535892248153687,-0.2992418110370636}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04097693786025047,-0.0862383097410202,-0.10193975269794464,0.021066637709736824,0.17490503191947937,0.033527664840221405,0.14952456951141357,0.04063156619668007};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.010755139403045177,-0.0012192069552838802,-0.02636810578405857,-0.08376479893922806,-0.05112956091761589,-0.06402868032455444,0.015147294849157333,-0.15976008772850037};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

