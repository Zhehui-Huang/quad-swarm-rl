#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2694966197013855,-0.1610366851091385,0.29246875643730164,0.23175813257694244,-0.38330042362213135,0.2521641254425049,-0.03957001864910126,-0.25887957215309143,0.11702483147382736,0.3548625111579895,0.11758794635534286,0.08925226330757141,0.15629863739013672,-0.189723938703537,0.27196604013442993,-0.08098635077476501},{-0.221383735537529,-0.3237530291080475,0.30221864581108093,0.15723435580730438,-0.2962900400161743,0.046178802847862244,-0.34466975927352905,-0.034213386476039886,-0.17897546291351318,-0.14162397384643555,0.10298382490873337,-0.2241014838218689,0.20028027892112732,-0.32917216420173645,-0.2134930044412613,0.0723041296005249},{0.12872184813022614,-0.23458537459373474,-0.2954508662223816,0.10195932537317276,0.11532625555992126,0.14366388320922852,-0.03521522134542465,0.055206190794706345,-0.15397192537784576,-0.1953379362821579,-0.189062237739563,0.4220431447029114,0.002726664301007986,-0.15490715205669403,-0.40833672881126404,0.2125929594039917},{0.12418919801712036,0.2124553620815277,0.29851827025413513,-0.05147353187203407,-0.30640479922294617,-0.058018505573272705,0.17246921360492706,0.12710162997245789,0.4711671769618988,-0.40143609046936035,0.06005483865737915,0.21055617928504944,-0.3454228341579437,0.0032982199918478727,0.3206517696380615,-0.4073418974876404},{0.006465832702815533,0.04041765630245209,0.21496927738189697,-0.12778979539871216,0.20434588193893433,0.2920647859573364,0.3130861222743988,-0.11504396051168442,0.010145071893930435,0.26795831322669983,0.3495158553123474,-0.21742881834506989,-0.18064233660697937,-0.26616528630256653,0.39893683791160583,0.11982835829257965},{0.045395150780677795,-0.24382421374320984,-0.15116140246391296,-0.20402327179908752,0.1050206869840622,-0.006602815818041563,0.09163851290941238,-0.18370841443538666,0.23882944881916046,-0.314405620098114,-0.32116299867630005,0.1924585998058319,0.40877848863601685,0.06547846645116806,0.0007540190708823502,0.01796765998005867},{-0.04544714093208313,-0.022236322984099388,0.08213191479444504,-0.21137426793575287,0.19821672141551971,0.06933651864528656,0.12719130516052246,0.3374314606189728,0.33639124035835266,-0.08974108099937439,-0.36183077096939087,0.1616341918706894,-0.14429917931556702,0.23318995535373688,-0.1797541230916977,-0.2593625485897064},{-0.01687675528228283,-0.024823958054184914,0.17404945194721222,0.30532705783843994,-0.36935096979141235,0.0170099176466465,0.3174484968185425,0.28876128792762756,-0.035599302500486374,0.26640766859054565,-0.4171249568462372,-0.28443071246147156,0.21728955209255219,0.3286643922328949,0.2769719362258911,0.026057887822389603},{0.25634968280792236,-0.20924589037895203,0.3148055970668793,-0.08937815576791763,0.30348441004753113,0.046140678226947784,-0.15183939039707184,-0.1612413376569748,0.07328949123620987,-0.316488116979599,0.06184184178709984,-0.28061407804489136,-0.18895310163497925,0.36946576833724976,0.18541939556598663,-0.08027233183383942},{0.04579079523682594,-0.33940762281417847,-0.38522568345069885,-0.08391318470239639,-0.34838879108428955,0.1255265176296234,0.38428419828414917,0.3176197409629822,0.3715488016605377,0.35938069224357605,-0.094831682741642,-0.3508056402206421,0.09111126512289047,0.2840456962585449,-0.08286148309707642,-0.23999649286270142},{0.1070467010140419,0.26160410046577454,0.445732980966568,-0.3474330008029938,-0.33817973732948303,0.24609822034835815,0.20243993401527405,0.4118536710739136,-0.3223523199558258,-0.09390441328287125,-0.08526217192411423,0.16231542825698853,-0.3243293762207031,-0.14890187978744507,0.32433807849884033,-0.3588259816169739},{0.1059614047408104,-0.07044205069541931,-0.056354593485593796,0.10571382194757462,0.32590293884277344,0.27889689803123474,0.3579411804676056,-0.0015030518407002091,-0.009509241208434105,0.06628420948982239,0.28058332204818726,-0.031048107892274857,-0.09806312620639801,-0.2007938027381897,0.22350957989692688,0.3651779294013977},{-0.14920033514499664,0.4548104703426361,0.14533700048923492,-0.35244128108024597,0.04542336240410805,0.08999446779489517,0.2726602256298065,-0.0005038604722358286,0.05351269990205765,0.054138872772455215,-0.04791180044412613,0.19248893857002258,0.3359490633010864,0.33128273487091064,0.09832025319337845,-0.24823208153247833},{-0.14446552097797394,-0.29794496297836304,-0.2677174210548401,-0.027039697393774986,-0.21476824581623077,0.09110637754201889,-0.3304516673088074,0.06926888227462769,-0.08260147273540497,-0.006893526762723923,-0.26423266530036926,-0.11774437874555588,-0.37808287143707275,0.18451747298240662,0.23958143591880798,0.04326390102505684},{-0.084958516061306,-0.38406306505203247,-0.264640748500824,0.3293512463569641,0.019242651760578156,-0.2977909743785858,0.3132190704345703,-0.0694606751203537,-0.01923176273703575,0.19817529618740082,0.0385623425245285,0.1951734721660614,0.1740873008966446,-0.005182076711207628,-0.23534011840820312,0.2039499580860138},{0.5238643288612366,-0.08393726497888565,-0.24733377993106842,-0.40876343846321106,-0.6031498908996582,0.3550293445587158,0.4182017147541046,-0.32274413108825684,0.1875549852848053,0.13919973373413086,-0.3286617696285248,0.08168043196201324,-0.5312614440917969,0.50174880027771,-0.2599215805530548,0.05548279359936714},{-0.3667214512825012,-0.3791312873363495,0.4465261399745941,0.3238773047924042,-0.30335533618927,0.29290661215782166,-0.1303262859582901,-0.23056577146053314,0.1590867042541504,-0.4300176501274109,-0.3818301856517792,-0.6183199286460876,-0.1309036910533905,-0.5303439497947693,0.0017487405566498637,-0.1674315333366394},{-0.35246941447257996,0.2843397557735443,-0.3904677629470825,-0.031276050955057144,0.04781598597764969,0.28440263867378235,-0.13068702816963196,-0.3334643244743347,0.14353656768798828,0.26429471373558044,0.370663046836853,-0.10289879888296127,-0.24913270771503448,0.3161769211292267,0.1899976134300232,-0.5120452046394348}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.10602794587612152,-0.07401405274868011,-0.16034291684627533,-0.34370601177215576,0.44373708963394165,0.2546996772289276,0.12980172038078308,0.1297166794538498,-0.26901838183403015,-0.08847863972187042,-0.06378854066133499,-0.00757876830175519,0.2644762694835663,0.5139607787132263,0.09932287782430649,0.09455109387636185},{-0.21698305010795593,-0.297882080078125,-0.05607049912214279,0.1495482325553894,0.27137643098831177,-0.3326910436153412,0.1640390008687973,0.08761269599199295,-0.07961152493953705,0.24329017102718353,-0.1837412565946579,0.3640684187412262,-0.36670395731925964,0.19620679318904877,-0.4018090069293976,-0.27998414635658264},{0.09475168585777283,0.22623726725578308,-0.40472909808158875,-0.48236316442489624,0.16720987856388092,0.4354252219200134,-0.06318800896406174,0.14153403043746948,-0.245782271027565,-0.23821932077407837,-0.015128402970731258,0.29006069898605347,-0.28254666924476624,-0.28891247510910034,0.1496543288230896,-0.051358360797166824},{0.18624775111675262,-0.022814013063907623,0.07115428894758224,0.20749999582767487,-0.5109055638313293,0.025104891508817673,0.023995457217097282,-0.2403390109539032,0.3875264823436737,0.391691118478775,-0.09651489555835724,-0.15027520060539246,-0.38778719305992126,-0.3954063355922699,0.1818685531616211,0.22717493772506714},{-0.204549178481102,0.03750612214207649,0.06324237585067749,0.2705465853214264,-0.21275702118873596,0.02783280983567238,-0.043774139136075974,0.15383465588092804,0.2567342519760132,-0.36622360348701477,0.05604618042707443,0.40955737233161926,0.13386587798595428,-0.43422070145606995,-0.07636529952287674,-0.12060216814279556},{0.2700388431549072,0.22538545727729797,-0.045853931456804276,0.14027221500873566,-0.36707040667533875,-0.449613094329834,0.24769653379917145,0.307637482881546,0.07605554163455963,0.4865817129611969,0.1995784491300583,-0.29814639687538147,-0.011382117867469788,-0.1327320784330368,-0.08438129723072052,0.2839408218860626},{-0.02393176034092903,0.20472320914268494,0.32255786657333374,-0.3691585958003998,-0.1966637223958969,0.05210334435105324,-0.29326125979423523,-0.041330691426992416,0.09029366821050644,0.12144269049167633,-0.14333131909370422,-0.2518960237503052,-0.3242229223251343,0.04711843654513359,0.19837388396263123,0.04721544310450554},{-0.1915338784456253,-0.19772948324680328,-0.41543999314308167,0.3167589604854584,-0.31039348244667053,-0.2975235879421234,-0.18752993643283844,-0.35567671060562134,0.03127899393439293,-0.24702775478363037,-0.09154408425092697,0.19206254184246063,-0.2011343240737915,0.40654754638671875,-0.12988269329071045,-0.3841198682785034},{-0.25855714082717896,0.30343952775001526,-0.025701003149151802,-0.0352281890809536,0.30194973945617676,-0.21377165615558624,0.3505996763706207,0.1256069839000702,0.28245940804481506,0.37846672534942627,0.2826731503009796,0.30440452694892883,0.19507388770580292,-0.06442917138338089,0.32256054878234863,0.09821467101573944},{0.14563816785812378,-0.2291087955236435,-0.08468364924192429,-0.15864409506320953,0.291067898273468,-0.08705922961235046,-0.2538546025753021,-0.18452301621437073,0.06855849176645279,-0.4219663739204407,-0.22447386384010315,0.2525644898414612,0.11672044545412064,0.17550723254680634,-0.33782216906547546,0.25757816433906555},{-0.23890556395053864,-0.3978002369403839,0.46257954835891724,0.2840617001056671,0.24317196011543274,0.08118559420108795,0.154868021607399,-0.12267456948757172,0.15299741923809052,-0.27676036953926086,-0.008487572893500328,0.39934730529785156,0.3837708532810211,0.12506058812141418,-0.2749502956867218,-0.027192678302526474},{0.06019803136587143,-0.18310971558094025,0.3436698019504547,0.08854351937770844,-0.1302998661994934,-0.1879081428050995,0.4568013846874237,0.2569501996040344,-0.2553425431251526,-0.37393105030059814,-0.11518649756908417,-0.3051232695579529,-0.008983592502772808,-0.3000814616680145,-0.38972023129463196,0.008066144771873951},{-0.06951779127120972,-0.35312125086784363,0.3511621356010437,-0.17471076548099518,0.3157418966293335,-0.3417333662509918,-0.36747685074806213,0.1480035036802292,0.12924787402153015,-0.038004033267498016,-0.3184221088886261,0.07745242118835449,0.084534652531147,-0.325886994600296,-0.41704708337783813,0.0011445856653153896},{0.24662914872169495,-0.3842580020427704,0.491532564163208,0.13895441591739655,0.051905564963817596,0.30530479550361633,-0.12864969670772552,-0.2590924799442291,-0.49910035729408264,0.03329050913453102,-0.0026148941833525896,-0.4144916236400604,0.005531697534024715,0.23899787664413452,0.31401410698890686,0.05173952877521515},{-0.2107488363981247,0.1285773366689682,0.13202744722366333,-0.2977359890937805,-0.13071449100971222,0.1400156468153,0.27718785405158997,-0.21351775527000427,0.19253835082054138,-0.36550894379615784,0.007841941900551319,0.041927602142095566,-0.009234045632183552,0.1395830363035202,-0.02555282600224018,0.056374114006757736},{-0.19460493326187134,0.3719548285007477,-0.32037508487701416,0.3411747217178345,0.20283053815364838,-0.4065321981906891,-0.041116297245025635,-0.04912684112787247,-0.40274107456207275,0.3303470313549042,-0.35137540102005005,0.3171493411064148,-0.018812304362654686,-0.15470770001411438,-0.31158646941185,-0.47974100708961487}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1907380223274231,0.03764268010854721,-0.07506553083658218,-0.010215586051344872,-0.10469429194927216,0.0034726266749203205,0.29236143827438354,0.016079982742667198,-0.1108163595199585,-0.1562856286764145,0.10218992084264755,-0.34734538197517395,-0.20822001993656158,0.249640554189682,0.20119938254356384,0.2621948719024658,-0.2728422284126282,-0.31094372272491455,-0.25926071405410767,0.030014196410775185,-0.032299645245075226,-0.35886791348457336,-0.23594671487808228,-0.2988056540489197,-0.3208500146865845,0.25856301188468933,-0.27800998091697693,-0.033033229410648346,-0.008901134133338928,-0.03045187145471573,0.1805383861064911,-0.1597166359424591},{0.1833716332912445,0.24435393512248993,0.060668278485536575,-0.07002022862434387,0.10679051280021667,-0.0807257741689682,0.3338658809661865,0.06651711463928223,-0.21992850303649902,-0.10382471978664398,-0.05549579858779907,-0.34334972500801086,-0.23947134613990784,0.20305809378623962,-0.19465909898281097,-0.3180060088634491,-0.06249001994729042,0.1683659553527832,-0.3915078341960907,-0.34976786375045776,-0.004145005252212286,0.2809847295284271,0.174804225564003,-0.10785136371850967,0.12441783398389816,-0.2149473875761032,-0.0015481258742511272,0.12439233809709549,0.2464870661497116,-0.19899968802928925,-0.07574447244405746,0.2434554249048233},{0.2601432800292969,0.0979236513376236,-0.02074006386101246,0.23139028251171112,-0.24015939235687256,-0.13762320578098297,-0.35900750756263733,0.17780862748622894,-0.14635586738586426,0.3211546540260315,-0.21865490078926086,-0.1145864948630333,0.17285004258155823,-0.4144742786884308,-0.09247180074453354,0.03444863483309746,-0.11469009518623352,-0.17499451339244843,0.3486936688423157,-0.044825803488492966,0.2717776894569397,0.2069483995437622,-0.27338144183158875,-0.048511918634176254,-0.2863715589046478,-0.10729663819074631,0.1875942349433899,-0.10742416232824326,-0.027586940675973892,-0.0751861035823822,-0.05130239948630333,-0.046373408287763596},{0.34406331181526184,0.09485424309968948,0.08588151633739471,-0.1310623586177826,-0.2848760485649109,-0.05371243879199028,-0.1794605851173401,0.2522689700126648,0.24394643306732178,-0.25698819756507874,-0.07178010046482086,0.3216756582260132,0.06702558696269989,-0.15491445362567902,-0.2008797824382782,0.28146544098854065,-0.30109626054763794,0.23197239637374878,0.0019412332912907004,0.08065139502286911,-0.05381949618458748,-0.09416995942592621,0.2983981966972351,0.139804869890213,0.17160311341285706,-0.3472454249858856,0.3513554334640503,-0.21841152012348175,-0.02269640378654003,0.07598056644201279,-0.24207478761672974,0.18408630788326263},{-0.0237788837403059,-0.0920577272772789,-0.08782274276018143,0.0219588503241539,0.2078680843114853,-0.21978454291820526,-0.3443720042705536,-0.017717014998197556,-0.11921155452728271,-0.17354796826839447,0.10339577496051788,0.22791463136672974,-0.02764437347650528,-0.07194468379020691,-0.12735824286937714,0.23067118227481842,-0.0760519802570343,-0.029216160997748375,-0.345867395401001,-0.05901734530925751,-0.1650104969739914,-0.37966009974479675,0.15470734238624573,0.25907522439956665,-0.026959840208292007,0.2822805643081665,-0.19251814484596252,0.17803244292736053,0.27824175357818604,0.33219894766807556,-0.054408397525548935,0.27716755867004395},{-0.25910499691963196,-0.047102563083171844,-0.20259225368499756,-0.042371947318315506,-0.20406441390514374,0.24406695365905762,0.19650711119174957,0.03773984685540199,0.28758999705314636,0.17655424773693085,0.3554742932319641,-0.22714440524578094,-0.2136971652507782,0.1937779039144516,0.3216647803783417,-0.36470845341682434,-0.1322491466999054,-0.23816391825675964,0.22559447586536407,0.0910494402050972,0.10314545780420303,0.1473386585712433,0.05176660045981407,-0.0419074110686779,-0.3594770133495331,0.35522231459617615,-0.187037855386734,0.19226641952991486,0.377750039100647,0.21489790081977844,0.05694987252354622,0.08434344083070755},{0.1687016785144806,-0.12802506983280182,-0.12480401992797852,-0.30182310938835144,-0.023631718009710312,0.2129366099834442,0.2648334801197052,0.13879899680614471,0.11087474226951599,0.353226900100708,-0.028510866686701775,0.014525032602250576,-0.3910467028617859,-0.14594295620918274,-0.1498255729675293,0.05704951286315918,-0.2963115870952606,-0.24051839113235474,0.17307694256305695,-0.09929301589727402,-0.09163068234920502,-0.17418944835662842,-0.22277064621448517,-0.25695598125457764,0.15742893517017365,-0.22986964881420135,-0.11704282462596893,-0.23452870547771454,0.3414660692214966,0.112943135201931,-0.19609223306179047,-0.2812193036079407},{0.060089100152254105,0.16423197090625763,0.07947145402431488,-0.1303628832101822,0.168610081076622,-0.3006768822669983,-0.037565410137176514,-0.15917877852916718,0.0022384398616850376,-0.27675434947013855,-0.3665039539337158,-0.1244688406586647,-0.09106674790382385,0.09176930785179138,-0.1704314649105072,0.42611801624298096,0.020182764157652855,-0.1325346678495407,0.09955350309610367,0.34749850630760193,-0.19655609130859375,-0.2015223354101181,0.26893672347068787,0.09611081331968307,-0.006752002518624067,-0.33611491322517395,-0.35908567905426025,-0.2377772480249405,-0.3899955749511719,-0.29251083731651306,0.09231093525886536,-0.4093509018421173},{-0.010357084684073925,0.49152886867523193,-0.42285433411598206,-0.3754121661186218,-0.2794535160064697,0.2054063230752945,0.0753418579697609,0.10081004351377487,-0.02394232340157032,-0.30773085355758667,-0.09584882855415344,0.28072109818458557,-0.42894628643989563,-0.21330635249614716,0.2461441457271576,-0.24360354244709015,0.2668890058994293,0.19156333804130554,0.37502604722976685,-0.007197042927145958,0.13384175300598145,0.2496565580368042,0.3807414174079895,-0.19297754764556885,0.40933385491371155,-0.18594177067279816,0.25590139627456665,0.45476940274238586,-0.15165162086486816,0.11215762794017792,0.05898511782288551,0.11002613604068756},{-0.303818017244339,0.10038142651319504,-0.4202328026294708,-0.23493337631225586,0.1523122489452362,-0.23279227316379547,0.18914763629436493,-0.06588783115148544,0.192757710814476,0.10188329964876175,-0.3254897892475128,-0.4388964772224426,-0.45250341296195984,-0.07764372229576111,-0.30362793803215027,0.12175774574279785,-0.028775032609701157,-0.23100508749485016,0.10299582779407501,0.07240956276655197,0.034654587507247925,0.025986600667238235,0.40272021293640137,-0.1537415087223053,0.3553386926651001,0.21574801206588745,-0.27750036120414734,0.03946789726614952,-0.020205629989504814,-0.06041007488965988,-0.24067017436027527,0.07408173382282257},{0.07420480251312256,0.017138076946139336,0.1626671403646469,-0.260652095079422,-0.26519864797592163,-0.2101249396800995,-0.2564610540866852,-0.06392385810613632,-0.17284628748893738,0.3676709830760956,0.1368427872657776,-0.2880144715309143,-0.3470902144908905,-0.029998907819390297,-0.2168952375650406,-0.1667555272579193,0.24296119809150696,-0.12467914819717407,0.24227501451969147,-0.2237938493490219,-0.19672413170337677,0.03241930902004242,0.185503289103508,0.18927791714668274,0.15874101221561432,-0.11399529874324799,-0.06122017651796341,-0.05320550501346588,-0.04967844486236572,0.0069557009264826775,-0.04911796748638153,0.15948081016540527},{-0.1867133229970932,-0.052639901638031006,0.21554026007652283,0.2395479679107666,0.2737598717212677,-0.004796321038156748,0.10361622273921967,-0.19119417667388916,-0.11987825483083725,-0.23013021051883698,0.28411656618118286,-0.21944770216941833,-0.21736975014209747,-0.199080690741539,0.2750220000743866,0.06391273438930511,-0.0005367638077586889,0.051174309104681015,0.36618679761886597,0.11016672104597092,-0.22279389202594757,0.28250113129615784,0.11882961541414261,-0.043843965977430344,0.28445199131965637,-0.15927547216415405,-0.11697109788656235,0.2409428060054779,0.16261108219623566,-0.01844213530421257,-0.2548280656337738,-0.3046175241470337},{0.2694917619228363,-0.2780035138130188,-0.027336791157722473,-0.29797953367233276,0.07541803270578384,-0.16009077429771423,0.12041150778532028,0.07729200273752213,0.2982199788093567,0.10276089608669281,0.11689729243516922,0.22674156725406647,-0.3378728926181793,-0.30592435598373413,-0.0891227200627327,-0.2641335427761078,-0.1949790120124817,-0.27231138944625854,0.2617416977882385,-0.24231255054473877,0.3496675491333008,-0.0858740508556366,-0.03806272894144058,0.1823706179857254,0.13040606677532196,-0.09840287268161774,0.08925606310367584,0.041773632168769836,0.14511901140213013,-0.04106784239411354,-0.2829316258430481,-0.054398778825998306},{0.235037162899971,-0.12883810698986053,-0.036357294768095016,0.40172281861305237,-0.06401722133159637,-0.2739523947238922,-0.018426965922117233,0.07596335560083389,0.26608383655548096,0.3756462037563324,0.0543699637055397,-0.16513533890247345,0.11260317265987396,0.240220308303833,-0.15778478980064392,0.07753385603427887,0.1845521777868271,-0.25029265880584717,0.005056039430201054,-0.33602309226989746,0.3353450298309326,0.09479064494371414,-0.1242879256606102,0.24780867993831635,0.21356143057346344,0.14084793627262115,0.044806111603975296,-0.005001163575798273,0.04522891342639923,-0.18463651835918427,-0.07765395194292068,0.36961472034454346},{-0.0217815563082695,-0.2434784471988678,-0.10403961688280106,0.12868735194206238,-0.25359171628952026,0.016359534114599228,0.06046146899461746,-0.2923499643802643,-0.1405826210975647,-0.03330063074827194,0.1957796961069107,0.09760869294404984,0.06770197302103043,0.26180756092071533,-0.05253277346491814,-0.11788173019886017,-0.21448750793933868,0.2997590899467468,-0.1507178544998169,-0.313291996717453,-0.1958155632019043,-0.06038426607847214,0.19158603250980377,0.006217478308826685,-0.0626458078622818,-0.01972728595137596,-0.2381812334060669,0.2529905438423157,0.08454165607690811,-0.21069777011871338,0.22197666764259338,0.19051431119441986},{0.10093402862548828,-0.2072111964225769,-0.11788216978311539,-0.17391768097877502,-0.06651633977890015,0.13446757197380066,0.06548650562763214,0.21751396358013153,-0.10359112918376923,0.048915546387434006,0.23150067031383514,0.0571407675743103,-0.020689520984888077,-0.10277131199836731,0.0001539063232485205,0.15961463749408722,-0.4300161898136139,-0.2523078918457031,-0.08780330419540405,0.016176916658878326,0.09601276367902756,0.2521836459636688,0.2616877555847168,0.13562634587287903,0.02867177687585354,0.26483097672462463,-0.029184965416789055,-0.060910262167453766,0.18545952439308167,-0.17530766129493713,-0.3162367045879364,0.34523025155067444},{0.17865847051143646,-0.02367471531033516,-0.2587348222732544,0.22217513620853424,0.08979576081037521,-0.040838874876499176,0.2381478101015091,0.09815368056297302,0.14078348875045776,-0.21172544360160828,0.23436130583286285,-0.17448608577251434,-0.38270872831344604,0.2555379271507263,0.07094644755125046,0.003659599693492055,0.053162623196840286,-0.08896871656179428,-0.14285054802894592,0.03529370203614235,-0.03528553992509842,0.1537262499332428,0.05178581178188324,-0.15165643393993378,-0.031583815813064575,-0.22413627803325653,0.022583775222301483,0.3554414212703705,0.28326475620269775,-0.10876188427209854,0.20384204387664795,0.23397915065288544},{-0.06541432440280914,-0.06891126930713654,-0.06152651086449623,-0.052608709782361984,-0.20267850160598755,-0.013232543133199215,0.24131377041339874,0.17055314779281616,0.16456688940525055,-0.029146261513233185,0.20273232460021973,-0.018220625817775726,0.23005972802639008,0.21819478273391724,0.1371016502380371,-0.08136003464460373,0.16219760477542877,0.20435242354869843,0.220498725771904,0.06252092123031616,0.16174475848674774,0.25273755192756653,0.037247154861688614,0.16072340309619904,-0.021480165421962738,-0.07221342623233795,-0.16993331909179688,-0.22892630100250244,0.1572471410036087,-0.25436294078826904,0.06005572900176048,-0.060640741139650345},{-0.31628134846687317,0.07558917999267578,-0.2913372814655304,-0.2996571958065033,-0.010375353507697582,0.05871229246258736,0.09317098557949066,-0.14819402992725372,0.01841788925230503,0.29346519708633423,0.08625704795122147,-0.17714232206344604,0.05231698602437973,-0.16849768161773682,-0.27474069595336914,-0.06721782684326172,-0.16786421835422516,0.10832684487104416,-0.014682506211102009,-0.07374795526266098,-0.3042251169681549,0.14612425863742828,0.10821837186813354,0.00816088542342186,-0.07480655610561371,0.29012563824653625,0.03951220586895943,-0.17427992820739746,-0.1664092242717743,0.08151717483997345,-0.13098718225955963,-0.22504572570323944},{0.027218887582421303,-0.24576017260551453,-0.23548781871795654,-0.028142670169472694,-0.32405075430870056,-0.1788049191236496,0.1598009616136551,-0.2883983552455902,-0.1844453066587448,0.17944788932800293,0.12874071300029755,0.1224185973405838,0.1536659598350525,-0.12344293296337128,0.2841978669166565,-0.2934175729751587,0.08187135308980942,0.2311272770166397,0.03929189592599869,0.2634483873844147,0.042294397950172424,-0.14192548394203186,-0.31206050515174866,0.2364119589328766,-0.12967224419116974,-0.18451736867427826,0.0872957706451416,0.002532070269808173,-0.14565667510032654,-0.28369396924972534,-0.042169176042079926,-0.17130513489246368},{0.20893354713916779,0.2053438425064087,-0.05662250891327858,0.18272081017494202,-0.302287757396698,0.20294936001300812,-0.08780252188444138,-0.15202511847019196,-0.22887638211250305,0.19537606835365295,-0.2209896296262741,-0.13448388874530792,-0.04883340001106262,-0.1926504224538803,-0.3159695267677307,-0.18502749502658844,-0.08301974833011627,-0.28005728125572205,-0.1907709687948227,0.26609498262405396,0.10577979683876038,0.13046064972877502,-0.309808611869812,0.28220075368881226,0.15164196491241455,0.2645638883113861,-0.26597535610198975,-0.024614445865154266,0.10445045679807663,-0.22181159257888794,0.17090311646461487,0.12912483513355255},{-0.030037058517336845,-0.30697017908096313,-0.028916995972394943,-0.3105473518371582,-0.04228466376662254,0.2479977011680603,0.20171301066875458,0.015186901204288006,-0.04914936423301697,0.024566860869526863,-0.24241991341114044,0.11159279942512512,0.13793130218982697,0.10229874402284622,0.10698597878217697,0.02556000091135502,-0.07968490570783615,0.1356387883424759,-0.141971617937088,0.1574355810880661,0.19883589446544647,0.25371864438056946,-0.07373622059822083,-0.21671491861343384,0.14489451050758362,0.14703910052776337,0.24767695367336273,0.13852645456790924,-0.024845240637660027,0.12813811004161835,-0.0011292052222415805,-0.13082283735275269},{0.038453370332717896,-0.19057323038578033,0.2527235150337219,-0.04353855550289154,0.2909359037876129,-0.05361742526292801,-0.09827426075935364,-0.14587879180908203,0.15511953830718994,-0.035464897751808167,0.050637561827898026,0.001216036849655211,-0.24957147240638733,0.02480040304362774,-0.12136814743280411,-0.21294455230236053,-0.06807483732700348,-0.03229067102074623,0.21549750864505768,0.2892422676086426,0.024822283536195755,0.055653166025877,0.18863075971603394,0.3476469814777374,-0.11715273559093475,-0.11706606298685074,0.21391305327415466,-0.09531416743993759,-0.2409180998802185,-0.27371975779533386,0.27932852506637573,-0.01961093209683895},{0.19752220809459686,-0.05131601542234421,0.02962876483798027,0.1253756880760193,-0.028299380093812943,0.04966692999005318,-0.2655637562274933,0.2938368320465088,-0.09653741866350174,-0.0493880957365036,0.08953544497489929,-0.27448686957359314,0.009971887804567814,-0.05912318825721741,-0.10677473247051239,0.2998044192790985,-0.07356460392475128,-0.19959378242492676,0.03154642507433891,-0.027503173798322678,-0.1670849770307541,0.2061121165752411,0.22134441137313843,0.22981485724449158,-0.2720888555049896,0.13874226808547974,-0.05953555554151535,0.07893852889537811,-0.2831394374370575,0.2713315188884735,-0.04619337245821953,0.03920133039355278}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.25830894708633423,-0.08119181543588638,0.1717035174369812,-0.19943173229694366},{0.21596479415893555,-0.3298724293708801,0.3349871039390564,0.3371470272541046},{-0.33363762497901917,0.06020370125770569,0.08825203031301498,-0.05634750425815582},{0.2670480012893677,0.5201102495193481,0.41484931111335754,0.005019545555114746},{-0.2945749759674072,0.10100699216127396,-0.36468932032585144,0.06176352500915527},{-0.03594677522778511,-0.09590764343738556,0.13590116798877716,0.5357341766357422},{-0.07961016893386841,-0.08898137509822845,-0.4708333909511566,0.03114692121744156},{-0.15453888475894928,-0.28216466307640076,0.2284681349992752,-0.05873526632785797},{-0.09481776505708694,0.13460393249988556,-0.13070403039455414,-0.19714918732643127},{0.28179025650024414,0.08152282238006592,-0.08114099502563477,-0.2593078017234802},{0.18938928842544556,-0.12439122796058655,0.3300738036632538,0.2682842016220093},{-0.10086570680141449,-0.021362783387303352,0.5067782998085022,-0.11959878355264664},{-0.4434599280357361,0.25626739859580994,-0.0007974204490892589,-0.16682128608226776},{-0.18694904446601868,0.10217741876840591,-0.32720568776130676,0.1069352999329567},{0.16857166588306427,-0.001178090344183147,0.29877427220344543,0.12171154469251633},{-0.18841183185577393,-0.3675837516784668,-0.17508289217948914,-0.15656057000160217},{-0.4098554849624634,0.013034095056355,-0.13522259891033173,0.3504164218902588},{-0.33371859788894653,-0.17199483513832092,-0.24524395167827606,0.26626983284950256},{-0.11408571153879166,-0.17793725430965424,0.4764331877231598,0.08436764031648636},{-0.2548927962779999,-0.23762951791286469,0.037405144423246384,-0.21897611021995544},{0.21345831453800201,0.16964304447174072,0.1908113956451416,-0.22986842691898346},{-0.022026527673006058,-0.33765894174575806,-0.14312465488910675,0.42944252490997314},{0.47762662172317505,-0.28900817036628723,0.09659465402364731,0.12265622615814209},{-0.389702171087265,-0.11627760529518127,-0.3413030207157135,-0.42428097128868103},{-0.15577462315559387,-0.3038807511329651,-0.15025797486305237,-0.07958187907934189},{0.21662349998950958,0.18561983108520508,-0.09268805384635925,0.08686991780996323},{0.14372305572032928,-0.2422848641872406,0.3692761957645416,0.08361170440912247},{-0.046900201588869095,-0.21129153668880463,-0.07806240022182465,0.3684208393096924},{0.20244835317134857,0.07862933725118637,0.07395443320274353,0.055450040847063065},{-0.15885944664478302,0.10252910852432251,0.31035754084587097,0.018232114613056183},{-0.2630518674850464,-0.09589531272649765,0.09056198596954346,0.3182269334793091},{0.3566659092903137,0.24916157126426697,0.27872270345687866,-0.01889660209417343}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09690700471401215,-0.1564052402973175,0.0784602239727974,0.0992400050163269,0.09836681187152863,-0.21414436399936676,0.1319337636232376,0.04995908960700035,-0.09956922382116318,-0.03741508722305298,-0.013814611360430717,-0.08014451712369919,-0.025063198059797287,0.10690746456384659,0.14443211257457733,-0.06769368797540665};
static const float actor_encoder_self_encoder_2_bias[16] = {0.018370606005191803,0.046415776014328,0.06936666369438171,-0.040674466639757156,-0.04401231184601784,0.11480758339166641,-0.08002208173274994,-0.12992653250694275,0.05244456231594086,-0.061589762568473816,-0.005613307002931833,0.010004485957324505,-0.02324739098548889,-0.08752309530973434,0.05888393521308899,-0.08845553547143936};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04151271656155586,0.026953034102916718,-0.05373690277338028,0.09441985189914703,-0.02874644473195076,0.04124930128455162,-0.09963622689247131,-0.04707619175314903,-0.026586303487420082,-0.031130852177739143,0.06008883938193321,0.04560895636677742,-0.02247603051364422,-0.04232395812869072,0.07401957362890244,-0.11539062857627869,-0.007410496007651091,-0.04433855786919594,0.0410168394446373,-0.08635098487138748,0.03701448813080788,-0.020248550921678543,0.0342382974922657,-0.10429161787033081,-0.11304417997598648,0.0633140429854393,0.05149506404995918,-0.009183047339320183,0.08292707800865173,0.04314437881112099,0.004967572167515755,0.09187042713165283};
static const float action_parameterization_distribution_linear_bias[4] = {0.03947201743721962,0.0741671770811081,0.048858433961868286,0.056908268481492996};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.34348922967910767,-0.2851100564002991,-0.23316366970539093,0.182316392660141,-0.23097069561481476,0.07662561535835266,-0.3102758228778839,-0.03825831413269043},{0.19457831978797913,0.1930185854434967,0.30439916253089905,0.36632251739501953,-0.13402381539344788,-0.39216020703315735,0.3288990557193756,0.3461879789829254},{0.09527946263551712,0.2461186796426773,0.0706978589296341,-0.03822169825434685,0.34767481684684753,0.17732448875904083,-0.00708755711093545,0.23870663344860077},{0.12617328763008118,-0.2776489853858948,0.2910561263561249,-0.18779195845127106,-0.23958733677864075,0.07379364222288132,0.3060465157032013,0.236463725566864},{-0.2486434429883957,-0.02537362277507782,-0.07965368032455444,-0.3271593451499939,0.13178028166294098,0.10576804727315903,0.327781081199646,0.26368433237075806},{-0.053110525012016296,0.26178213953971863,-0.035347942262887955,-0.2591330111026764,0.31741777062416077,0.08894988894462585,0.08896418660879135,-0.18375085294246674},{0.02891516126692295,0.2547658085823059,0.13407829403877258,-0.19856473803520203,0.41786786913871765,-0.15428170561790466,0.1625310480594635,0.09711181372404099},{0.11985261738300323,-0.2819683253765106,-0.059424687176942825,-0.254584938287735,0.27747634053230286,-0.07002312690019608,-0.17021484673023224,-0.31017497181892395},{-0.1934739202260971,0.2909679412841797,-0.06504753977060318,-0.12306710332632065,-0.028934257104992867,0.3147379457950592,0.3354933559894562,0.3243958055973053},{0.05478915199637413,-0.03238724544644356,-0.33224937319755554,0.23023265600204468,0.27229660749435425,0.23752082884311676,0.25750216841697693,-0.2885003387928009},{-0.11941974610090256,-0.29511621594429016,0.31937533617019653,0.1321987509727478,0.01704343967139721,-0.3036729395389557,-0.0529063455760479,-0.3252534568309784},{0.2865959405899048,0.11236046254634857,0.3785627782344818,0.3409639894962311,-0.09988948702812195,0.2940724790096283,0.13670867681503296,-0.37265545129776},{-0.3299359679222107,0.20664413273334503,-0.361361563205719,0.3718861937522888,0.013254982419312,0.3839985728263855,-0.024647502228617668,0.23152121901512146},{0.025534747168421745,0.2475358098745346,-0.13168106973171234,-0.14553025364875793,0.07877267152070999,0.07958892732858658,0.27458855509757996,0.012392041273415089},{0.21659523248672485,-0.25252050161361694,-0.30436593294143677,-0.16878722608089447,0.23716992139816284,-0.2475927621126175,0.12111584097146988,-0.028307344764471054},{-0.3723853528499603,-0.30115094780921936,-0.16431820392608643,0.05316389724612236,0.14391972124576569,0.14228084683418274,0.24672061204910278,0.025859437882900238},{-0.1524963229894638,-0.2892867922782898,0.20078560709953308,-0.33743909001350403,0.0920114740729332,0.0035309195518493652,-0.3915747106075287,-0.17747794091701508},{0.04587552696466446,0.19746868312358856,0.11258795857429504,0.1699390411376953,-0.037736278027296066,0.3393882215023041,0.3266225755214691,-0.13963715732097626},{0.01386525109410286,-0.3743983805179596,-0.1140570417046547,-0.076114721596241,-0.09075883775949478,-0.3431497812271118,0.1197250559926033,-0.24109072983264923},{-0.07637041062116623,-0.03620098903775215,0.07534237951040268,-0.332302451133728,0.09085682034492493,0.13150343298912048,0.18101729452610016,-0.05560113862156868},{0.06494475156068802,-0.11381128430366516,0.040657978504896164,-0.283467173576355,0.02571018971502781,-0.017385995015501976,0.07927148044109344,-0.19410505890846252},{-0.3200024664402008,0.1497989147901535,0.1396411955356598,-0.27658748626708984,-0.4230995178222656,0.017836924642324448,0.25483250617980957,0.033271078020334244},{0.2875615358352661,0.05165351927280426,-0.39505359530448914,0.06670904159545898,-0.01874244026839733,0.2712779939174652,0.30969464778900146,0.3204183578491211},{-0.0090547576546669,-0.2158023715019226,0.03908732905983925,0.2539351284503937,-0.25939545035362244,0.014282453805208206,-0.08545863628387451,-0.3122009038925171},{0.22812363505363464,0.02319253794848919,-0.4288652837276459,0.33006995916366577,-0.21707941591739655,-0.26480698585510254,-0.32763150334358215,0.19627560675144196},{0.04325536638498306,0.3408166766166687,-0.31307253241539,-0.07045135647058487,0.15015819668769836,-0.19122400879859924,0.3621240258216858,-0.2804914712905884},{-0.09035854786634445,0.07200705260038376,-0.21624046564102173,-0.1950775682926178,0.06865891069173813,-0.15524180233478546,-0.08104821294546127,-0.14599934220314026},{0.10095353424549103,-0.1829819679260254,-0.09430070966482162,-0.1372256726026535,0.05057063698768616,0.021225856617093086,-0.194546639919281,0.08236521482467651},{0.317603200674057,0.03989217430353165,-0.4033331274986267,-0.24425950646400452,-0.21521733701229095,0.10161090642213821,0.2207123041152954,0.08527687937021255},{0.36675402522087097,-0.32694801688194275,0.007596075069159269,-0.06907167285680771,0.1408451944589615,-0.1698148101568222,0.17885522544384003,0.3474216163158417},{-0.3038329482078552,-0.24175462126731873,0.061164967715740204,-0.33478906750679016,0.32434511184692383,-0.26340436935424805,0.004935116972774267,0.04869803041219711},{0.11245577037334442,-0.011196660809218884,-0.13095444440841675,0.2301836907863617,0.02504466287791729,0.012909132055938244,-0.05138566717505455,-0.07904250919818878}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.21104605495929718,0.4276745021343231,-0.5459267497062683,-0.5383256673812866,-0.21902596950531006,0.021059967577457428,-0.4213227331638336,0.5433877110481262},{-0.05250779911875725,0.5195159316062927,-0.27185380458831787,0.5994235277175903,-0.04568612203001976,0.054821476340293884,-0.31594228744506836,0.03894387185573578},{-0.40856149792671204,-0.21731378138065338,-0.1203196570277214,-0.12156070023775101,0.4759684205055237,0.24845755100250244,-0.04659107327461243,0.4433978497982025},{-0.504387617111206,-0.5119146108627319,0.3427039086818695,0.34700778126716614,-0.5005232691764832,-0.2038644254207611,0.4464469850063324,0.25843891501426697},{-0.3058934509754181,-0.2222176343202591,-0.32903745770454407,-0.27055591344833374,0.31570544838905334,-0.2169184684753418,0.5300472378730774,-0.43145015835762024},{0.02393418177962303,0.23791372776031494,0.2606678009033203,-0.5797640681266785,0.49347883462905884,-0.29058852791786194,-0.489805668592453,-0.36195093393325806},{-0.3803715109825134,0.19867731630802155,0.06883810460567474,-0.4756368398666382,-0.03320516273379326,-0.5541998744010925,0.5237993001937866,0.0012937396531924605},{-0.39297544956207275,-0.21256855130195618,-0.17652198672294617,-0.31363436579704285,-0.3795605003833771,0.18528881669044495,0.5587201118469238,-0.3495689630508423}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.00027914211386814713,-0.09640667587518692,-0.10067308694124222,-0.008157290518283844,0.07383966445922852,0.007718109525740147,0.053816311061382294,0.07211077958345413};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.06869713217020035,-0.08243196457624435,-0.048613473773002625,-0.11551778018474579,-0.09905853867530823,-0.08522233366966248,-0.04292214661836624,-0.09134149551391602};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

