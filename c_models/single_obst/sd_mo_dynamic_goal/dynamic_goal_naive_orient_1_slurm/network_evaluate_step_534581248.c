#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3194572627544403,-0.08443491905927658,0.2964091897010803,0.14719630777835846,-0.2798401713371277,0.27946263551712036,-0.047294508665800095,-0.14386025071144104,0.12971854209899902,0.33547401428222656,0.11135104298591614,0.04489042982459068,0.24888096749782562,-0.24960143864154816,0.2706669270992279,-0.05220194160938263},{-0.17186589539051056,-0.4065172076225281,0.32921287417411804,0.0944991260766983,-0.23384428024291992,0.16946637630462646,-0.40217727422714233,-0.049716245383024216,-0.09526462852954865,-0.1946556121110916,0.042511701583862305,-0.20731058716773987,0.008690807037055492,-0.33543387055397034,-0.24975483119487762,0.11478625237941742},{-0.08357398211956024,-0.2250416874885559,-0.44984471797943115,0.15309496223926544,0.24260233342647552,0.5579044818878174,0.032147448509931564,-0.05033653974533081,0.07788445055484772,-0.4922018349170685,-0.40293464064598083,0.788221538066864,-0.2088177651166916,-0.2929482161998749,-0.39331310987472534,0.2718169093132019},{0.1548045575618744,0.2580616772174835,0.38767144083976746,-0.019891690462827682,-0.38591468334198,-0.013349555432796478,0.26664313673973083,0.06807038187980652,0.31363245844841003,-0.34284508228302,0.008863257244229317,0.41202786564826965,-0.22858424484729767,-0.002671546069905162,0.5000295639038086,-0.46583443880081177},{-0.07514495402574539,-0.007567585911601782,0.3368527293205261,-0.06750602275133133,0.3126858174800873,0.43711715936660767,0.18603061139583588,-0.025240782648324966,0.14294201135635376,0.20193859934806824,0.2566874921321869,-0.3531961143016815,-0.2045450061559677,-0.41273579001426697,0.4107709527015686,0.09934134781360626},{-0.2353571653366089,-0.19160161912441254,-0.1713506132364273,-0.059026386588811874,0.21140050888061523,0.1947297304868698,0.03906090557575226,-0.11034110188484192,0.3618714511394501,-0.30463916063308716,-0.4489962160587311,0.22103746235370636,0.10678984969854355,-0.1359739899635315,-0.017512843012809753,0.07132451981306076},{0.07146601378917694,0.0810948833823204,0.03200357407331467,-0.45605769753456116,0.2293333262205124,-0.055832017213106155,0.05422019585967064,0.39401671290397644,0.3309210240840912,0.07717358320951462,-0.46115273237228394,-0.0382603257894516,-0.010704822838306427,0.1428970992565155,-0.21516746282577515,-0.24550944566726685},{-0.2573463022708893,0.43742629885673523,0.3823625445365906,0.39841917157173157,-0.48392805457115173,-0.06651701033115387,0.5845247507095337,0.5311504602432251,-0.23938336968421936,0.37294262647628784,-0.7102517485618591,-0.41363856196403503,0.4544846713542938,0.12744532525539398,0.26881855726242065,0.45247578620910645},{0.3604435920715332,-0.26434922218322754,0.6486439108848572,0.09885071218013763,0.0016615028725937009,0.07577760517597198,0.17065294086933136,-0.6241287589073181,-0.245597243309021,-0.45087993144989014,-0.18332846462726593,-0.019654618576169014,-0.08004093915224075,0.7014622688293457,0.47158411145210266,-0.30008789896965027},{0.20232929289340973,-0.5707483291625977,-0.6450974345207214,-0.35265326499938965,-0.24509884417057037,0.237919420003891,0.16256172955036163,0.17298509180545807,0.62823486328125,0.26687532663345337,0.19105352461338043,-0.2679021954536438,-0.12354835867881775,0.41395303606987,-0.20601722598075867,-0.5464610457420349},{0.19914992153644562,0.37542587518692017,0.37161019444465637,-0.656191885471344,-0.3040117025375366,0.11734471470117569,0.12418685853481293,0.4193430244922638,-0.34676477313041687,0.04652420058846474,-0.12576325237751007,0.00996554084122181,-0.16480682790279388,-0.20261798799037933,0.22882068157196045,-0.36728575825691223},{-0.04708131030201912,-0.42223599553108215,0.17366477847099304,0.6101376414299011,0.7627741098403931,0.4295702874660492,0.34331071376800537,0.41275814175605774,0.04979583993554115,-0.0024181099142879248,0.27375897765159607,-0.4437326490879059,-0.5701724290847778,-0.42624515295028687,0.7274144291877747,-0.05005206912755966},{-0.2712641656398773,0.43548285961151123,-0.050794318318367004,-0.6250708699226379,0.1654459685087204,0.051492057740688324,0.19597692787647247,0.19596973061561584,0.07891393452882767,0.07461115717887878,0.0442872978746891,0.20521214604377747,0.4318619668483734,0.3606279492378235,-0.09157317131757736,-0.10746064782142639},{0.06157737597823143,-0.3847062289714813,-0.2519536316394806,-0.18286381661891937,-0.4530599117279053,0.014160998165607452,-0.25104382634162903,-0.24123403429985046,-0.21124762296676636,-0.041262540966272354,-0.43672508001327515,-0.04452509433031082,-0.1956908106803894,0.4180874526500702,0.1676274836063385,-0.015334529802203178},{0.07789385318756104,-0.27924180030822754,-0.22635065019130707,0.1696251928806305,-0.09702065587043762,-0.4558117687702179,0.2789308428764343,-0.06583207100629807,-0.024850763380527496,0.3775024116039276,0.06761089712381363,0.046869028359651566,0.29510965943336487,0.00571298785507679,-0.31042417883872986,0.218789204955101},{0.40044739842414856,-0.002822941867634654,-0.21521709859371185,-0.18609581887722015,-0.33747532963752747,0.15921980142593384,0.3168957233428955,-0.0736086294054985,0.21978728473186493,0.3698652982711792,-0.15135546028614044,0.07820017635822296,-0.20283545553684235,0.24494247138500214,-0.09528322517871857,-0.020069193094968796},{-0.20851200819015503,-0.1716507375240326,0.219207763671875,0.12421072274446487,-0.2174336463212967,0.08140496909618378,-0.1752958446741104,-0.09627795219421387,-0.20860989391803741,-0.24863989651203156,-0.05109569430351257,-0.26271161437034607,0.10260672122240067,-0.20074795186519623,0.05037962272763252,-0.22594371438026428},{-0.24518002569675446,0.2593410909175873,-0.34645435214042664,-0.21497687697410583,0.062212951481342316,0.33526697754859924,-0.2068806290626526,-0.22267234325408936,0.15086039900779724,0.15765829384326935,0.3143739700317383,-0.11912888288497925,-0.32521939277648926,0.3116212785243988,0.010606552474200726,-0.4136059880256653}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04515553638339043,-0.04229499399662018,-0.10545433312654495,-0.34983786940574646,0.3141869008541107,0.2995757460594177,0.07969025522470474,0.044197775423526764,-0.08964125066995621,-0.16464810073375702,-0.018316250294446945,0.08380671590566635,0.20096838474273682,0.35767030715942383,0.10290852189064026,0.07272621989250183},{-0.17336446046829224,-0.306535929441452,-0.06453187763690948,0.061105020344257355,0.22345879673957825,-0.30027636885643005,0.03230509161949158,0.049785107374191284,-0.0551794096827507,0.2616320550441742,-0.2562600374221802,0.3190498650074005,-0.3898327052593231,0.18990813195705414,-0.36320510506629944,-0.35761579871177673},{0.04613732546567917,0.208983913064003,-0.368656724691391,-0.5220412611961365,0.1975543349981308,0.452820360660553,-0.087273009121418,0.06297890841960907,-0.2699466049671173,-0.30250945687294006,-0.0033746545668691397,0.32801806926727295,-0.28312093019485474,-0.1702895164489746,0.11038488149642944,-0.06577567011117935},{0.17131727933883667,-0.061611611396074295,0.08943258225917816,0.2083774358034134,-0.48033252358436584,-0.006339090410619974,0.08872845768928528,-0.19476039707660675,0.29724329710006714,0.3617632985115051,-0.1613021343946457,-0.14288048446178436,-0.41961348056793213,-0.4054551124572754,0.19594143331050873,0.17577685415744781},{-0.0869612917304039,0.14184631407260895,0.00460086390376091,0.25035837292671204,-0.22049149870872498,0.07970546185970306,-0.01866724155843258,0.16522687673568726,0.24150726199150085,-0.24746209383010864,0.17031453549861908,0.2533804476261139,0.17969223856925964,-0.43663138151168823,0.021981993690133095,-0.008857574313879013},{0.2189139872789383,0.2629704177379608,-0.02482418343424797,0.17317426204681396,-0.4946460425853729,-0.42487823963165283,0.26914864778518677,0.3023287355899811,0.1100994199514389,0.36897388100624084,0.2459208220243454,-0.21513015031814575,-0.007203697692602873,-0.14155364036560059,-0.08799480646848679,0.2981524169445038},{-0.11176353693008423,0.26041966676712036,0.28440260887145996,-0.36880993843078613,-0.25181081891059875,0.009171958081424236,-0.35439151525497437,-0.04535502567887306,0.18642503023147583,0.0732392817735672,-0.14658276736736298,-0.21586070954799652,-0.3192731440067291,-0.026032671332359314,0.1854831576347351,0.0279600378125906},{-0.15007048845291138,-0.15859925746917725,-0.4731909930706024,0.30791616439819336,-0.31624752283096313,-0.23603162169456482,-0.24654807150363922,-0.39362800121307373,0.148027703166008,-0.24948851764202118,0.044118478894233704,0.07479087263345718,-0.15054026246070862,0.4534970223903656,-0.07642050832509995,-0.32519322633743286},{-0.3346034288406372,0.2644038200378418,-0.014790215529501438,-0.040736835449934006,0.27374038100242615,-0.27673643827438354,0.29871878027915955,0.14628459513187408,0.3481284976005554,0.2909901440143585,0.25052914023399353,0.31811609864234924,0.17725878953933716,-0.05609963834285736,0.26196718215942383,0.09916850924491882},{0.058808278292417526,-0.27128201723098755,-0.17143279314041138,-0.12818694114685059,0.25836408138275146,-0.1708073616027832,-0.2987309694290161,-0.15578623116016388,0.07524912059307098,-0.36948251724243164,-0.2762387990951538,0.3522455096244812,0.12396010011434555,0.1530754417181015,-0.3868298828601837,0.23128774762153625},{-0.05346304550766945,-0.4492339491844177,0.3204144239425659,0.2858078181743622,0.24555015563964844,0.1527128517627716,0.17812487483024597,-0.13216303288936615,0.2209310382604599,-0.2568596601486206,0.1945519745349884,0.34103575348854065,0.50058513879776,0.11343736946582794,-0.11256787925958633,0.09451699256896973},{0.05753530561923981,-0.010295656509697437,0.41079965233802795,-0.01212942786514759,-0.24529676139354706,-0.17373532056808472,0.4296119809150696,0.2967681288719177,-0.24837014079093933,-0.20254312455654144,-0.07636465132236481,-0.35080164670944214,-0.019294479861855507,-0.2809903025627136,-0.3811566233634949,0.07008226215839386},{-0.10976505279541016,-0.3090848922729492,0.42478442192077637,-0.22370576858520508,0.3643159866333008,-0.3063828945159912,-0.4523578882217407,0.07724173367023468,0.07566822320222855,0.06649632751941681,-0.3277464210987091,0.12204336374998093,0.10086416453123093,-0.30483242869377136,-0.3362782895565033,0.0009845624445006251},{0.366001695394516,-0.33782264590263367,0.44527652859687805,0.08887827396392822,-0.09648462384939194,0.3330889344215393,-0.11532925814390182,-0.23021455109119415,-0.408509224653244,0.11715974658727646,0.0049577634781599045,-0.3566555678844452,-0.12058178335428238,0.11869915574789047,0.2977583408355713,0.033438391983509064},{-0.1012003943324089,0.2175624668598175,0.11564955860376358,-0.4808849096298218,-0.20607265830039978,0.19708536565303802,0.24925586581230164,-0.26376909017562866,0.2195882946252823,-0.3239234387874603,0.024546435102820396,0.10959617048501968,-0.0700390413403511,0.192337766289711,0.04384607449173927,0.06715337187051773},{-0.15450824797153473,0.41949379444122314,-0.4508025646209717,0.3689310848712921,0.10219588130712509,-0.39181679487228394,-0.028301924467086792,-0.077403724193573,-0.3096770942211151,0.4051612615585327,-0.3253137469291687,0.30441439151763916,-0.09098217636346817,-0.3288857638835907,-0.2106749564409256,-0.4830225110054016}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.15982046723365784,0.11458126455545425,-0.01816621422767639,-0.04548521339893341,-0.11929689347743988,0.030462829396128654,0.2695859372615814,0.09004823863506317,-0.18722347915172577,-0.16068965196609497,0.14085009694099426,-0.28325098752975464,-0.2348840832710266,0.24054348468780518,0.21445606648921967,0.3199097812175751,-0.26489734649658203,-0.2880847156047821,-0.1980060338973999,0.11865909397602081,-0.07271119207143784,-0.31353050470352173,-0.23344628512859344,-0.28544485569000244,-0.24637025594711304,0.15498453378677368,-0.20408520102500916,-0.028989095240831375,-0.043712325394153595,-0.0203146543353796,0.22980479896068573,-0.2200080305337906},{0.2985677421092987,0.1587875932455063,0.1693790853023529,-0.09662392735481262,0.1441742479801178,-0.1324394941329956,0.3810679018497467,0.13782283663749695,-0.13940377533435822,-0.08422767370939255,-0.12190655618906021,-0.27469098567962646,-0.1775864213705063,0.24323073029518127,-0.2544974088668823,-0.20941539108753204,-0.03745220974087715,0.2007192224264145,-0.3743852972984314,-0.23335102200508118,-0.030966952443122864,0.22668009996414185,0.04088020324707031,0.02458900585770607,0.22334717214107513,-0.35156407952308655,-0.05191689729690552,0.07488298416137695,0.18167492747306824,-0.12061864882707596,-0.06009063869714737,0.2043428272008896},{0.1533394306898117,0.039102789014577866,-0.1575048565864563,0.1417330801486969,-0.16591031849384308,-0.16794879734516144,-0.20921222865581512,0.0454673208296299,-0.15850168466567993,0.3748238980770111,-0.3120896816253662,-0.29457518458366394,0.14630480110645294,-0.3947496712207794,-0.15977901220321655,0.09627605229616165,-0.1087949350476265,-0.128875732421875,0.1634461134672165,-0.10714306682348251,0.24408140778541565,0.28452855348587036,-0.24022792279720306,0.0205981507897377,-0.2759789526462555,-0.003866766346618533,0.12711279094219208,-0.08179093152284622,-0.03331098333001137,-0.2420027256011963,-0.13615728914737701,-0.08602570742368698},{0.42075443267822266,0.04311645030975342,0.15723147988319397,-0.17735129594802856,-0.2616714835166931,-0.05738542228937149,-0.15646487474441528,0.2936067581176758,0.2515909671783447,-0.3055260181427002,-0.08354371786117554,0.30036064982414246,0.10977907478809357,-0.043757807463407516,-0.24218465387821198,0.2973417043685913,-0.30176547169685364,0.25540199875831604,0.04161382466554642,0.13257639110088348,-0.08747225254774094,-0.11995407938957214,0.2837819755077362,0.16691099107265472,0.19079510867595673,-0.3900541067123413,0.2645561397075653,-0.22429095208644867,-0.06659264117479324,0.09766974300146103,-0.19878658652305603,0.1404571682214737},{-0.06427666544914246,-0.08093535900115967,-0.10972289741039276,0.12481188774108887,0.21587315201759338,-0.15800665318965912,-0.4081598222255707,-0.08442768454551697,-0.1012958437204361,-0.3048054277896881,0.13160094618797302,0.23830297589302063,-0.03329863026738167,-0.10943129658699036,-0.11037235707044601,0.13438478112220764,-0.023827942088246346,-0.04581834748387337,-0.314405620098114,-0.18539762496948242,-0.16973936557769775,-0.364818274974823,0.1339312046766281,0.15386953949928284,-0.1026860848069191,0.3540157377719879,-0.1856960654258728,0.19960136711597443,0.3196660876274109,0.37999555468559265,-0.03763171657919884,0.38131818175315857},{-0.3071335256099701,0.014078754000365734,-0.23237036168575287,-0.05393318831920624,-0.2096179574728012,0.2519080638885498,0.20035704970359802,0.016348620876669884,0.25355854630470276,0.23602145910263062,0.34228020906448364,-0.2301599681377411,-0.26466575264930725,0.19004660844802856,0.3417965769767761,-0.33077114820480347,-0.12888720631599426,-0.2612098753452301,0.22104881703853607,0.08877449482679367,0.09384080767631531,0.18317432701587677,0.07677384465932846,-0.08415263146162033,-0.3656272888183594,0.3802541494369507,-0.14319898188114166,0.21683207154273987,0.3572922945022583,0.18717646598815918,0.05966334044933319,0.02221997082233429},{0.2123810052871704,-0.14824143052101135,-0.12383362650871277,-0.3367658257484436,-0.04357998073101044,0.23887349665164948,0.3146290183067322,0.18801523745059967,0.08388374745845795,0.35679808259010315,-0.009500321000814438,-0.02848878875374794,-0.4393218457698822,-0.17057238519191742,-0.1610180139541626,0.162145733833313,-0.2727779150009155,-0.218740314245224,0.20982161164283752,-0.07689720392227173,-0.13376100361347198,-0.1458703577518463,-0.2322683185338974,-0.2115175575017929,0.15301105380058289,-0.2489715963602066,-0.08393032848834991,-0.19984351098537445,0.29298654198646545,0.1185467541217804,-0.16191163659095764,-0.3065001368522644},{0.014739361591637135,0.15089870989322662,0.04977136105298996,-0.016312776133418083,0.11881241202354431,-0.3383970558643341,-0.11391273885965347,-0.17962829768657684,-0.01631353236734867,-0.21504613757133484,-0.3205782175064087,-0.059656254947185516,-0.1281474083662033,-0.019935641437768936,-0.13107167184352875,0.37227410078048706,-0.031232206150889397,-0.1742061972618103,0.09143068641424179,0.3343183994293213,-0.10163678973913193,-0.24393890798091888,0.2653316259384155,0.1015775054693222,-0.03862947225570679,-0.32051122188568115,-0.30853623151779175,-0.32173991203308105,-0.34008029103279114,-0.26476332545280457,0.023614466190338135,-0.30711686611175537},{0.0995425432920456,0.32415276765823364,-0.2591823935508728,-0.3257518708705902,-0.22566896677017212,0.07936428487300873,0.0568053312599659,0.07977258414030075,0.13685913383960724,-0.29137712717056274,-0.19808565080165863,0.33557283878326416,-0.24408608675003052,-0.19033554196357727,0.19977083802223206,-0.2840556204319,0.27184903621673584,0.16241632401943207,0.3523002564907074,0.024456683546304703,0.21265900135040283,0.062242183834314346,0.2653706669807434,-0.0984542965888977,0.3764807879924774,-0.23123791813850403,0.12801940739154816,0.3334566652774811,-0.28621241450309753,0.22886934876441956,0.0007937385817058384,0.15553128719329834},{-0.1796509176492691,0.12658914923667908,-0.2464575320482254,-0.18068334460258484,0.19588974118232727,-0.1443047672510147,0.11763354390859604,0.005657595116645098,0.14440347254276276,-0.045656174421310425,-0.27915236353874207,-0.31380170583724976,-0.33854126930236816,-0.037956301122903824,-0.2600529193878174,0.11493963748216629,0.08111090958118439,-0.1804812252521515,0.2511160373687744,0.11561008542776108,-0.02412630431354046,0.01395941898226738,0.28204572200775146,-0.19004108011722565,0.32621851563453674,0.09132330119609833,-0.2612469494342804,0.03192191198468208,-0.045646052807569504,0.1162770539522171,-0.1034645289182663,0.06732173264026642},{0.09540700912475586,0.023008428514003754,0.20070494711399078,-0.2834070324897766,-0.32823920249938965,-0.2466670721769333,-0.27544596791267395,0.008421669714152813,-0.22455154359340668,0.45557263493537903,0.1501876711845398,-0.23834601044654846,-0.38768985867500305,-0.06010805442929268,-0.2034890204668045,-0.09683779627084732,0.19710995256900787,-0.1718277782201767,0.2704397737979889,-0.15245819091796875,-0.17407414317131042,-0.0035202554427087307,0.18267878890037537,0.23252254724502563,0.17359675467014313,-0.1366688460111618,0.0030722999945282936,-0.0903000757098198,-0.057092826813459396,0.020091157406568527,-0.03844422474503517,0.1267661154270172},{-0.16791290044784546,-0.13037122786045074,0.21896158158779144,0.2905593514442444,0.2732720673084259,-0.04227082431316376,0.06763500720262527,-0.22349368035793304,-0.020117681473493576,-0.27484163641929626,0.26193174719810486,-0.22202999889850616,-0.1864672601222992,-0.19935068488121033,0.24165783822536469,-0.004561054985970259,-0.0031750001944601536,0.023913877084851265,0.3635876774787903,0.04391784593462944,-0.1775357574224472,0.2130456268787384,0.0973091721534729,-0.06319331377744675,0.23201695084571838,-0.10013869404792786,-0.17698131501674652,0.20960015058517456,0.1571846306324005,0.021255645900964737,-0.2964845895767212,-0.22690260410308838},{0.30962517857551575,-0.28457072377204895,0.006370617542415857,-0.3067122995853424,-0.02571350894868374,-0.18171142041683197,0.09870409220457077,0.15332743525505066,0.23552186787128448,0.07850367575883865,0.17348751425743103,0.26205259561538696,-0.42305850982666016,-0.37409013509750366,-0.044364526867866516,-0.2247285544872284,-0.2709776759147644,-0.3320682942867279,0.3183850646018982,-0.17625275254249573,0.3532600402832031,-0.1286490261554718,0.006906543858349323,0.20166073739528656,0.13066670298576355,-0.11697734892368317,0.11933768540620804,0.01241953857243061,0.10702650994062424,-0.00642174668610096,-0.2952044904232025,0.017585061490535736},{0.26981258392333984,-0.037402160465717316,-0.009397052228450775,0.3570075035095215,-0.08699138462543488,-0.17244607210159302,-0.03346256911754608,0.1668027639389038,0.19332584738731384,0.24654677510261536,0.1222241148352623,-0.11866869777441025,0.06666486710309982,0.21077847480773926,-0.11518675833940506,0.11791615188121796,0.24175870418548584,-0.23470306396484375,0.11599960923194885,-0.3420107960700989,0.25398486852645874,0.15277671813964844,-0.10275761038064957,0.20598150789737701,0.24937115609645844,0.0816439539194107,0.1422971487045288,0.09183412790298462,0.07922924309968948,-0.13940156996250153,0.02407645434141159,0.3661252558231354},{0.07236026972532272,-0.2031552791595459,0.005890230648219585,0.09816331416368484,-0.2702726125717163,0.009766947478055954,0.04427564516663551,-0.20929399132728577,-0.16593511402606964,-0.031903691589832306,0.18478846549987793,0.20811086893081665,0.09440974146127701,0.24869024753570557,-0.03075348772108555,-0.03392426669597626,-0.2092294991016388,0.26995712518692017,-0.06866531074047089,-0.2225932627916336,-0.2157268226146698,-0.09625206142663956,0.14601027965545654,0.04365468770265579,0.0030898882541805506,-0.13812530040740967,-0.1796845644712448,0.23050451278686523,0.05725526809692383,-0.13768334686756134,0.276458740234375,0.15988239645957947},{0.17454272508621216,-0.23354321718215942,0.017384180799126625,-0.19421157240867615,-0.013305895030498505,0.15404847264289856,0.07137463241815567,0.27066725492477417,-0.09630563855171204,-0.018745454028248787,0.22395090758800507,0.11444150656461716,0.05407053604722023,-0.09901877492666245,-0.01806645840406418,0.2048092633485794,-0.34322911500930786,-0.19598601758480072,-0.042817842215299606,0.0786142572760582,0.03565898537635803,0.2498532384634018,0.1559217870235443,0.18884125351905823,0.062031134963035583,0.17430424690246582,-0.02162347175180912,-0.0581088550388813,0.09302505105733871,-0.10673066228628159,-0.25307637453079224,0.3132876455783844},{0.1419827938079834,0.023584071546792984,-0.38455730676651,0.10630062222480774,0.05014991760253906,-0.031137842684984207,0.3497801125049591,0.10020745545625687,0.08953825384378433,-0.10491449385881424,0.21002541482448578,-0.2739461660385132,-0.4335976243019104,0.26302140951156616,0.08152075856924057,0.06023265793919563,-0.01137690618634224,-0.08806274086236954,-0.17196054756641388,0.05780433118343353,-0.05120931938290596,0.24250343441963196,0.09538493305444717,-0.1683327555656433,-0.08643577247858047,-0.21257677674293518,0.06276301294565201,0.3422488570213318,0.22692511975765228,-0.22364477813243866,0.1856723129749298,0.16364628076553345},{-0.07966763526201248,0.002229192992672324,-0.0859941691160202,-0.07630349695682526,-0.2408009022474289,-0.0340208001434803,0.22257693111896515,0.17215552926063538,0.13785354793071747,0.01654711551964283,0.18522672355175018,-0.013579319231212139,0.22827287018299103,0.20901231467723846,0.1729574352502823,-0.10419169068336487,0.12084058672189713,0.19036921858787537,0.2110922932624817,0.04542344808578491,0.1890309602022171,0.2833457291126251,0.0800156518816948,0.1650407910346985,-0.031157098710536957,-0.06257282197475433,-0.13605937361717224,-0.24469192326068878,0.13863974809646606,-0.2792414724826813,0.03021690435707569,-0.06556917726993561},{-0.3429892659187317,0.029848337173461914,-0.33942219614982605,-0.3379908502101898,0.04809638485312462,-0.01121874712407589,0.13937652111053467,-0.1714058518409729,0.07344318181276321,0.35303840041160583,0.008320681750774384,-0.241685152053833,0.06449458748102188,-0.18071602284908295,-0.3266175091266632,0.024116437882184982,-0.16923214495182037,0.12655124068260193,-0.08527986705303192,0.00797724537551403,-0.30182361602783203,0.15873436629772186,0.09206796437501907,0.058108557015657425,-0.08416888117790222,0.34921252727508545,0.034365858882665634,-0.20785865187644958,-0.20710405707359314,0.007963256910443306,-0.21168848872184753,-0.2717541754245758},{-0.00678230170160532,-0.2592630088329315,-0.28474512696266174,-0.04996241256594658,-0.32436275482177734,-0.1471904218196869,0.18470127880573273,-0.28196680545806885,-0.22472356259822845,0.17713750898838043,0.1949143409729004,0.0874621644616127,0.11695262044668198,-0.14916792511940002,0.2770925462245941,-0.26817211508750916,0.09432480484247208,0.2644402086734772,0.0457974411547184,0.2782333791255951,0.011159072630107403,-0.11844997107982635,-0.28152450919151306,0.22435030341148376,-0.11469234526157379,-0.1597774773836136,0.116800956428051,0.040859755128622055,-0.11826498806476593,-0.3308719992637634,-0.03404117003083229,-0.1903591752052307},{0.22716599702835083,0.0995105654001236,-0.07082835584878922,0.22605720162391663,-0.25042957067489624,0.08843913674354553,-0.08944497257471085,-0.20435276627540588,-0.0878211110830307,0.22987724840641022,-0.3464709222316742,-0.14380154013633728,0.028120167553424835,-0.21100851893424988,-0.38650041818618774,-0.168928325176239,-0.12646916508674622,-0.3351944088935852,-0.2702978551387787,0.22000251710414886,0.16766323149204254,0.07151038944721222,-0.37710806727409363,0.325421005487442,0.13740964233875275,0.30826085805892944,-0.31613510847091675,-0.12848663330078125,0.09427451342344284,-0.21562619507312775,0.0948939397931099,0.1774596869945526},{-0.05108042433857918,-0.2994086444377899,-0.04896043241024017,-0.308181494474411,-0.07240435481071472,0.2963176965713501,0.20804426074028015,0.0315011665225029,-0.10832974314689636,0.014054219238460064,-0.15563316643238068,0.09793359786272049,0.09878553450107574,0.06101513281464577,0.11805547773838043,0.036500878632068634,-0.0816359743475914,0.14722657203674316,-0.11660116165876389,0.151154026389122,0.18965455889701843,0.25684845447540283,-0.03191559016704559,-0.248143270611763,0.16896572709083557,0.155442014336586,0.2811570167541504,0.16846026480197906,0.026095690205693245,0.10450327396392822,0.016364559531211853,-0.10435251891613007},{-0.022117482498288155,-0.20441965758800507,0.23530802130699158,0.055193085223436356,0.2903304398059845,-0.016622478142380714,-0.12782861292362213,-0.19413642585277557,0.1326286792755127,-0.05038971081376076,0.08474719524383545,0.006613938603550196,-0.3111037611961365,0.05840298533439636,-0.09236379712820053,-0.25780943036079407,-0.04042937979102135,-0.057226233184337616,0.18005479872226715,0.19449110329151154,0.021171465516090393,0.05580485984683037,0.1650504171848297,0.29763850569725037,-0.18612203001976013,-0.04195523262023926,0.17064829170703888,-0.06181150674819946,-0.14605356752872467,-0.25670939683914185,0.3031842112541199,0.014658796600997448},{0.19708514213562012,-0.07711069285869598,0.0476934053003788,0.11690223217010498,-0.037460148334503174,0.05205439776182175,-0.24997597932815552,0.30943527817726135,-0.11784746497869492,-0.03278753533959389,0.12843194603919983,-0.2938570976257324,0.058283764868974686,-0.06743473559617996,-0.11420099437236786,0.3104971647262573,-0.08257836103439331,-0.17874251306056976,0.03756200149655342,0.01342288963496685,-0.1760856807231903,0.169925719499588,0.22317864000797272,0.23904581367969513,-0.26089006662368774,0.1117156594991684,-0.06894928961992264,0.07091836631298065,-0.2655225992202759,0.25895288586616516,-0.054263800382614136,0.04172936826944351}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.2331085056066513,-0.12708501517772675,0.09831131994724274,-0.18283329904079437},{0.20716145634651184,-0.25120246410369873,0.2748751640319824,0.2315705418586731},{-0.29066556692123413,0.04845542088150978,0.13503552973270416,-0.044121064245700836},{0.2989808917045593,0.45519790053367615,0.32324960827827454,0.03730517253279686},{-0.2913333773612976,0.15405191481113434,-0.2806835174560547,0.13682349026203156},{0.012943262234330177,-0.10531392693519592,0.10202885419130325,0.34122365713119507},{-0.10556577146053314,-0.19301468133926392,-0.39089125394821167,-0.01724058948457241},{-0.11461745202541351,-0.36379915475845337,0.16628561913967133,-0.06551431119441986},{-0.12650169432163239,0.16947361826896667,-0.08597239851951599,-0.10847587883472443},{0.2642644941806793,-0.0070176194421947,-0.12227041274309158,-0.20008541643619537},{0.22422802448272705,-0.20096224546432495,0.3145362436771393,0.2507852613925934},{-0.05769738182425499,0.00855687540024519,0.4196402430534363,-0.10699203610420227},{-0.31960099935531616,0.24589340388774872,-0.033633649349212646,-0.08807257562875748},{-0.17991526424884796,-0.0018731668824329972,-0.22740080952644348,0.07406308501958847},{0.20129968225955963,-0.04605373740196228,0.23808036744594574,0.09284870326519012},{-0.1415882557630539,-0.2971782386302948,-0.1282874345779419,-0.08823413401842117},{-0.28622424602508545,0.05218896269798279,-0.056265659630298615,0.3212963342666626},{-0.2915630042552948,-0.14319097995758057,-0.23161324858665466,0.20847362279891968},{-0.08076727390289307,-0.11709625273942947,0.39940088987350464,0.07709920406341553},{-0.14496752619743347,-0.1762310117483139,-0.020066317170858383,-0.1793469786643982},{0.1715637892484665,0.13405129313468933,0.12860378623008728,-0.16931185126304626},{0.003991884179413319,-0.27275869250297546,-0.16862733662128448,0.29193994402885437},{0.2893270254135132,-0.16372168064117432,0.1873122751712799,0.03851677477359772},{-0.2944028675556183,-0.05647673085331917,-0.28766828775405884,-0.271576464176178},{-0.2634524703025818,-0.17792370915412903,0.0055649615824222565,-0.13411948084831238},{0.202248215675354,0.2086845189332962,-0.08146122843027115,0.1625531017780304},{0.18473289906978607,-0.20676501095294952,0.24253231287002563,0.08407960832118988},{-0.04904158413410187,-0.16465625166893005,0.015381664037704468,0.3230649530887604},{0.07512331753969193,0.042342979460954666,0.02606712467968464,0.025971824303269386},{-0.18882881104946136,0.10373903810977936,0.2813902497291565,0.01728636957705021},{-0.15294837951660156,-0.15321414172649384,0.09341296553611755,0.22330895066261292},{0.20335771143436432,0.22321586310863495,0.2709043323993683,-0.03218942508101463}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0489618293941021,-0.00753743015229702,-0.015034889802336693,0.04910922795534134,0.0438385047018528,-0.05453682690858841,-0.022252092137932777,0.06648559868335724,-0.07402871549129486,-0.05764642357826233,0.003348645521327853,0.02807888202369213,-0.027926800772547722,0.05687793716788292,-0.01797885075211525,-0.030667146667838097};
static const float actor_encoder_self_encoder_2_bias[16] = {0.009127994999289513,-0.01340635959059,-0.015347426757216454,-0.00015521551540587097,-0.050604257732629776,0.023149466142058372,-0.02964271605014801,-0.00969802774488926,0.024299073964357376,-0.03451380878686905,0.007366831414401531,-0.02142038755118847,-0.013940684497356415,-0.027403678745031357,-0.014411257579922676,-0.0273353960365057};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0003376206732355058,0.05649283528327942,-0.01498408429324627,0.011447444558143616,-0.01476757600903511,0.02856510691344738,-0.04118294268846512,-0.008151823654770851,-0.014360862784087658,-0.024688510224223137,-0.003927061799913645,0.031158296391367912,0.013588319532573223,0.011288887821137905,0.04763916879892349,-0.04543503001332283,0.015088304877281189,-0.010635835118591785,0.020484190434217453,-0.03353565186262131,-0.007947453297674656,0.029445722699165344,-0.0019796211272478104,-0.04151025414466858,-0.05280286446213722,0.018766265362501144,0.023597337305545807,0.029942838475108147,-0.0128150824457407,0.02785363793373108,0.03031582199037075,0.00037507532397285104};
static const float action_parameterization_distribution_linear_bias[4] = {0.0037824008613824844,0.013738138601183891,0.010850472375750542,0.033506862819194794};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.4004440903663635,-0.38956135511398315,-0.14135296642780304,0.22785957157611847,-0.20913925766944885,0.09983759373426437,-0.3363545536994934,0.04770106077194214},{0.20437608659267426,0.10426711291074753,0.39951077103614807,0.38637515902519226,-0.1284070461988449,-0.34538504481315613,0.30666205286979675,0.401990681886673},{0.07143698632717133,0.16694104671478271,0.11154471337795258,-0.04084765911102295,0.33138346672058105,0.22195985913276672,-0.017903974279761314,0.24673885107040405},{0.11550358682870865,-0.37278085947036743,0.3394653797149658,-0.1538720726966858,-0.22797201573848724,0.10625439137220383,0.31269410252571106,0.25784939527511597},{-0.25126802921295166,-0.08959238231182098,-0.0440874882042408,-0.26985716819763184,0.1448025107383728,0.12851472198963165,0.3458701968193054,0.2864149808883667},{-0.057835400104522705,0.18732468783855438,-0.003602896584197879,-0.19981494545936584,0.34681931138038635,0.12464769184589386,0.1072952076792717,-0.15931670367717743},{0.008685877546668053,0.15932884812355042,0.14512944221496582,-0.144074946641922,0.43871134519577026,-0.11002788692712784,0.15165401995182037,0.10912187397480011},{0.05848223343491554,-0.4468686282634735,-0.03574429452419281,-0.22535881400108337,0.28813880681991577,0.03731056675314903,-0.15818357467651367,-0.3292243480682373},{-0.2610127031803131,0.15316590666770935,-0.0034960354678332806,-0.07740619778633118,0.009910274296998978,0.4514451026916504,0.39097028970718384,0.29596850275993347},{-0.0022445437498390675,-0.1515161395072937,-0.2695244252681732,0.2845226228237152,0.2951231300830841,0.324241578578949,0.37144047021865845,-0.3148359954357147},{-0.16383296251296997,-0.3924933075904846,0.36339011788368225,0.18500906229019165,0.01959717459976673,-0.2589641511440277,0.052862025797367096,-0.3299444019794464},{0.23791541159152985,0.02413046360015869,0.40924006700515747,0.4097256362438202,-0.11084786802530289,0.3299921751022339,0.23158703744411469,-0.3299477696418762},{-0.38833239674568176,0.1266217678785324,-0.353281706571579,0.4424542188644409,-0.022966250777244568,0.4295583665370941,0.02255638688802719,0.2618045508861542},{-0.0681951493024826,0.1504489630460739,-0.13395972549915314,-0.11170312762260437,0.012902059592306614,0.15541450679302216,0.29501307010650635,0.0004607488226611167},{0.10956321656703949,-0.3581089377403259,-0.3520796597003937,-0.17067597806453705,0.12578903138637543,-0.14851674437522888,0.11542558670043945,-0.10777725279331207},{-0.47257354855537415,-0.35417643189430237,-0.2793041467666626,-0.007921178825199604,-0.05004419758915901,0.22566352784633636,0.19447387754917145,-0.10160215944051743},{-0.18157227337360382,-0.328875333070755,0.22927060723304749,-0.360058069229126,-0.002356355544179678,0.03926481306552887,-0.43936628103256226,-0.2897513806819916},{0.05934552475810051,0.2006503790616989,0.1363086998462677,0.19177669286727905,-0.11662702262401581,0.33927610516548157,0.2661294639110565,-0.21078701317310333},{0.06243753433227539,-0.35292157530784607,-0.07921010255813599,-0.05902678892016411,-0.1520007699728012,-0.33890289068222046,0.02973322942852974,-0.30786365270614624},{-0.029143331572413445,-0.007196154911071062,0.10648497194051743,-0.30142509937286377,0.042256154119968414,0.11896955966949463,0.06754142045974731,-0.13223080337047577},{0.10342689603567123,-0.11521849036216736,0.06544675678014755,-0.25284913182258606,-0.006542359944432974,-0.004263344220817089,-0.03189460560679436,-0.2476983219385147},{-0.31187379360198975,0.1747698336839676,0.13718542456626892,-0.23460546135902405,-0.47447165846824646,0.012354837730526924,0.1300697773694992,-0.002051822142675519},{0.2957483232021332,0.10673762857913971,-0.4245334565639496,0.12782853841781616,-0.06749020516872406,0.22619414329528809,0.23075522482395172,0.2855012118816376},{0.019711479544639587,-0.12461140006780624,-0.02004202827811241,0.31848862767219543,-0.31854820251464844,-0.0634722039103508,-0.1560739278793335,-0.32139068841934204},{0.2242162972688675,0.06847627460956573,-0.45655983686447144,0.3433667719364166,-0.3008251488208771,-0.3474162817001343,-0.34249910712242126,0.17075921595096588},{0.05783284083008766,0.34348079562187195,-0.3214241564273834,-0.04866494983434677,0.0790151059627533,-0.2550264596939087,0.3162001967430115,-0.28607386350631714},{-0.06338508427143097,0.05158586800098419,-0.16906142234802246,-0.1388670653104782,0.03004804626107216,-0.1871872991323471,-0.09906875342130661,-0.13523444533348083},{0.15156589448451996,-0.19105924665927887,-0.06863746792078018,-0.09636440873146057,0.0015274622710421681,0.003657612483948469,-0.2040826827287674,0.09037934988737106},{0.3662570118904114,0.038198500871658325,-0.40884649753570557,-0.18825729191303253,-0.257738322019577,0.10237190127372742,0.22585958242416382,0.07866402715444565},{0.4107024371623993,-0.31619539856910706,-0.03689905256032944,-0.030688470229506493,0.11183346062898636,-0.12671659886837006,0.2060200273990631,0.3449861705303192},{-0.23076166212558746,-0.1744213104248047,0.029488790780305862,-0.24085019528865814,0.32736966013908386,-0.25534626841545105,0.04752805829048157,0.09237834811210632},{0.20408597588539124,0.011904304847121239,-0.1470068097114563,0.3532666265964508,0.08824656903743744,0.012774795293807983,-0.03273751586675644,0.03516694903373718}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24367302656173706,0.4058833718299866,-0.6119864583015442,-0.5700969099998474,-0.26975759863853455,0.05196789652109146,-0.411701500415802,0.5532220005989075},{-0.03408557176589966,0.5359175205230713,-0.2178286761045456,0.5261595845222473,-0.013816078193485737,0.042639605700969696,-0.2502422034740448,-0.003981888294219971},{-0.46344631910324097,-0.20681777596473694,-0.16770799458026886,-0.2276553213596344,0.5269040465354919,0.18046575784683228,-0.0039122095331549644,0.43175292015075684},{-0.4952775239944458,-0.4694380462169647,0.28879910707473755,0.3338238000869751,-0.5356889367103577,-0.19116269052028656,0.5389085412025452,0.19460441172122955},{-0.29601430892944336,-0.3210640847682953,-0.3054950535297394,-0.29438862204551697,0.32496437430381775,-0.285335898399353,0.4984075725078583,-0.4383804500102997},{-0.08136560767889023,0.16662220656871796,0.30554842948913574,-0.5707744359970093,0.5382584929466248,-0.32000789046287537,-0.4085640013217926,-0.30475980043411255},{-0.41494429111480713,0.16521967947483063,0.07520399242639542,-0.368318110704422,-0.028149733319878578,-0.5418899655342102,0.5077536106109619,0.07547298818826675},{-0.3909318745136261,-0.31415581703186035,-0.2172439992427826,-0.4168337285518646,-0.3041047751903534,0.10720955580472946,0.4791794419288635,-0.3113107681274414}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.02886786311864853,-0.049638185650110245,-0.01791195757687092,0.014941748231649399,-0.036120008677244186,-0.013883606530725956,-0.09862014651298523,0.0184505395591259};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.010890915989875793,-0.042305491864681244,-0.011423597112298012,0.0537179633975029,-0.030967121943831444,0.03209765627980232,-0.03456192836165428,0.05072769522666931};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

