#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.32752665877342224,0.07401195168495178,0.01595952920615673,0.2499152421951294,0.36949920654296875,-0.27859893441200256,-0.30000850558280945,0.16422773897647858,0.35416579246520996,-0.28512609004974365,0.432931125164032,0.0416264608502388,0.27852296829223633,0.10603982210159302,-0.279695063829422,0.03042973391711712},{-0.32619819045066833,-0.21419325470924377,-0.31529542803764343,-0.12636767327785492,0.1886545717716217,0.34873491525650024,0.13757337629795074,0.014061175286769867,0.1534857153892517,0.2075219750404358,-0.13441739976406097,0.00984574481844902,-0.07310449331998825,0.14434808492660522,0.27983933687210083,-0.23587992787361145},{0.05872466415166855,0.2798023521900177,0.1391594558954239,0.23835872113704681,-0.014233068563044071,-0.24100615084171295,0.6282474994659424,-0.1882466971874237,-0.0749075710773468,-0.07690891623497009,-0.04259529709815979,-0.1649579107761383,0.1501046121120453,0.5288000106811523,-0.40915653109550476,0.048800304532051086},{0.13758167624473572,-0.14935742318630219,-0.1348874717950821,-0.04566406086087227,-0.20983701944351196,0.022300656884908676,-0.019857745617628098,-0.27351486682891846,-0.04503536969423294,-0.12280376255512238,0.5833074450492859,-0.27128174901008606,-0.33308857679367065,-0.1405714601278305,0.21830280125141144,-0.0267201978713274},{-0.23854131996631622,-0.029045475646853447,0.23154114186763763,-0.4579160809516907,0.4715571999549866,0.1689818948507309,0.23823927342891693,-0.19770482182502747,-0.16909678280353546,0.24339716136455536,-0.05124305188655853,-0.4257553815841675,0.007814658805727959,-0.22697514295578003,0.4299051761627197,-0.019535180181264877},{-0.039911869913339615,-0.1118333637714386,-0.10923293977975845,-0.1336488425731659,0.10259871929883957,-0.30063676834106445,0.5343524813652039,-0.2954070270061493,-0.19069673120975494,-0.2252177596092224,0.21638721227645874,0.0798865556716919,0.33104586601257324,0.024741319939494133,0.3358595371246338,0.2817399501800537},{-0.2600771486759186,0.31955140829086304,-0.01435939036309719,0.04886070638895035,-0.2986850142478943,-0.11457418650388718,-0.14691300690174103,-0.019996706396341324,0.2798636257648468,0.3531053364276886,-0.2721949815750122,-0.09950533509254456,0.29019486904144287,0.011674756184220314,-0.12414024025201797,0.3227534294128418},{-0.23678794503211975,0.11038239300251007,0.017154989764094353,-0.24236245453357697,0.332022100687027,-0.26579907536506653,-0.2654319703578949,-0.44792452454566956,-0.09749087691307068,-0.2844719886779785,0.5271611213684082,0.12151102721691132,0.05576760694384575,0.3284454345703125,0.03165930137038231,0.5676855444908142},{0.2298170030117035,0.15722869336605072,-0.08004030585289001,0.016297096386551857,-0.531107485294342,-0.522743821144104,0.14080822467803955,-0.5688971281051636,-0.061022091656923294,-0.07989765703678131,0.28850433230400085,-0.543501615524292,-0.4781342148780823,0.13546136021614075,0.11813423782587051,-0.2569122314453125},{0.5282576084136963,-0.740778386592865,-0.28419244289398193,0.07680345326662064,0.23550739884376526,-0.28645840287208557,-0.17010827362537384,-0.2088572233915329,-0.3211727440357208,0.033057358115911484,-0.3006976544857025,-0.2786451280117035,0.6166207790374756,-0.19003510475158691,-0.6924725770950317,-0.1717066466808319},{0.2452910989522934,0.3477960526943207,-0.16680209338665009,0.11987166851758957,-0.03163349628448486,-0.2331208437681198,-0.21464090049266815,0.11808662861585617,-0.07623867690563202,0.2151576280593872,0.18347661197185516,0.2982182800769806,-0.13491041958332062,0.20743106305599213,0.01179211214184761,-0.256377637386322},{-0.3678310811519623,0.22128556668758392,0.4495895504951477,-0.7045311331748962,-0.06360773742198944,0.07611427456140518,0.03290204703807831,0.25387102365493774,0.31258565187454224,0.374848872423172,0.38876405358314514,-0.17967958748340607,0.161000594496727,-0.17972157895565033,0.09490339457988739,-0.20438632369041443},{0.18201951682567596,-0.34337589144706726,-0.2712599039077759,0.3889247179031372,-0.20724420249462128,-0.32339704036712646,-0.00505828345194459,0.355068176984787,0.11572235822677612,-0.10250398516654968,-0.40155676007270813,0.27759280800819397,0.5062361359596252,0.3449002206325531,-0.2320706844329834,0.6433507204055786},{0.25427430868148804,0.2144698202610016,-0.39893898367881775,0.12894953787326813,-0.08002790063619614,-0.20086932182312012,-0.23215307295322418,0.1271800696849823,-0.3757516145706177,-0.4059509038925171,-0.10878590494394302,0.07220466434955597,-0.5727453231811523,-0.05166571959853172,-0.3984379172325134,-0.10664214193820953},{0.1175355389714241,0.594732403755188,0.5042935609817505,-0.5188542008399963,-0.27251386642456055,0.3015521168708801,-0.06673154979944229,0.06863671541213989,0.5234792828559875,0.3728494346141815,-0.12325067818164825,0.08686409890651703,-0.11931493133306503,-0.40353891253471375,0.19363568723201752,-0.3451695442199707},{-0.3385915458202362,-0.08356330543756485,-0.03814823552966118,0.2588791847229004,-0.08340039849281311,0.026815494522452354,-0.18945205211639404,-0.05997483432292938,-0.36731478571891785,-0.11783032864332199,0.3204752504825592,0.16944926977157593,-0.24867217242717743,-0.24183112382888794,-0.42018306255340576,-0.13467635214328766},{-0.3652699887752533,0.1502549648284912,-0.2858991324901581,0.008932811208069324,-0.1445150375366211,0.32330119609832764,0.38091713190078735,0.1746716946363449,0.25537362694740295,-0.22681371867656708,-0.06124955415725708,-0.11397877335548401,0.015811385586857796,0.05441579595208168,-0.032477471977472305,-0.15068504214286804},{0.14091046154499054,-0.4382634460926056,0.18979613482952118,0.2024049013853073,-0.01315394602715969,0.32809627056121826,0.33155685663223267,0.1551821082830429,-0.18381349742412567,-0.2668120265007019,-0.14822180569171906,-0.08694115281105042,-0.1381383091211319,-0.40781959891319275,0.10449544340372086,0.028865737840533257}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15215328335762024,0.3107510507106781,0.3475205600261688,-0.09592239558696747,-0.24073906242847443,0.09549117833375931,0.03008361905813217,0.27967146039009094,-0.03515864908695221,0.2905130982398987,0.4783916771411896,-0.3649129867553711,-0.09335962682962418,0.05419740080833435,0.03588848561048508,-0.049833182245492935},{-0.5483351349830627,0.24752704799175262,-0.3045777380466461,0.2626326084136963,0.3695177137851715,-0.18830068409442902,-0.3424111604690552,-0.2861045002937317,0.34305480122566223,0.2958216369152069,-0.04992513731122017,0.260036438703537,-0.3745524287223816,0.1621738225221634,-0.2713598608970642,0.4703240394592285},{-0.3938170075416565,0.21514198184013367,-0.3768397271633148,0.020848330110311508,-0.4061904847621918,-0.29442301392555237,-0.10717297345399857,0.0029025606345385313,-0.24624766409397125,0.3804666996002197,0.23327328264713287,-0.09160051494836807,0.27359017729759216,-0.3419030010700226,-0.08398085832595825,-0.008157632313668728},{0.29295721650123596,-0.23932300508022308,0.09667984396219254,0.4474961757659912,-0.4390000104904175,-0.4347057342529297,0.278698593378067,0.11144570261240005,0.2808339595794678,-0.10268416255712509,0.34675687551498413,0.09795811027288437,-0.25938576459884644,-0.028840631246566772,-0.010447831824421883,-0.3804521858692169},{-0.40827032923698425,0.049118246883153915,0.24426895380020142,-0.3790304958820343,0.17728470265865326,0.36879563331604004,-0.3111433684825897,0.20983120799064636,-0.2171850949525833,0.21226291358470917,-0.09191375225782394,-0.013118893839418888,-0.1186012402176857,-0.031802818179130554,-0.20044934749603271,-0.15822233259677887},{0.011042370460927486,-0.2509380578994751,-0.012943661771714687,-0.35309919714927673,0.2940393090248108,0.06820884346961975,-0.036886002868413925,-0.07434408366680145,-0.21693772077560425,0.37112146615982056,0.28384220600128174,-0.08162221312522888,-0.18832889199256897,0.21107201278209686,-0.04968230053782463,-0.35575562715530396},{0.2525900602340698,-0.13121996819972992,0.3474501967430115,-0.2959277927875519,-0.35825660824775696,-0.029669558629393578,-0.3692716658115387,0.36398521065711975,-0.09524370729923248,-0.24194985628128052,-0.25699734687805176,-0.04759393259882927,-0.039099209010601044,-0.1066172793507576,0.4736895263195038,-0.36851951479911804},{-0.2804625332355499,0.366901695728302,-0.08998962491750717,0.3095482587814331,0.025356870144605637,-0.2782246768474579,-0.09971114248037338,0.14744988083839417,-0.08335702866315842,0.486518919467926,0.15488559007644653,-0.21286717057228088,-0.02514517866075039,-0.08829975128173828,0.02926258184015751,0.13203153014183044},{0.09158886224031448,0.2877660095691681,-0.17483633756637573,-0.355912446975708,0.3864562213420868,-0.21391402184963226,0.18179017305374146,-0.34992799162864685,0.13315065205097198,0.03599519655108452,0.11729362607002258,0.14451700448989868,-0.023541515693068504,-0.32801154255867004,-0.0665007010102272,0.2233094871044159},{-0.2475125640630722,-0.0046211127191782,-0.31794601678848267,-0.3381839990615845,0.2335246503353119,-0.42601799964904785,-0.19308653473854065,0.2815706431865692,-0.13617698848247528,0.23547610640525818,-0.05399059131741524,-0.10111410915851593,-0.3478699028491974,-0.002944961888715625,-0.25160709023475647,-0.3421430289745331},{-0.25392624735832214,-0.10574471950531006,-0.0764179602265358,-0.3506697416305542,-0.3484633266925812,-0.02750120311975479,0.1436484456062317,-0.5286843776702881,0.013920258730649948,-0.06428531557321548,0.20198075473308563,0.01083473488688469,0.43694600462913513,0.06005864962935448,0.2211638242006302,0.25225844979286194},{-0.18581557273864746,-0.04823818430304527,-0.4262601435184479,0.3331211507320404,0.11801180243492126,-0.06988265365362167,0.18420910835266113,0.09208960831165314,-0.42180728912353516,0.21158085763454437,-0.29860416054725647,-0.15945403277873993,-0.3900740444660187,0.4357398450374603,-0.3577682673931122,0.09375820308923721},{-0.19851841032505035,-0.4369623363018036,-0.14574818313121796,0.17323242127895355,-0.1568162739276886,-0.11095210909843445,-0.11494378745555878,0.41634601354599,0.42373162508010864,0.10284440219402313,-0.09433545917272568,-0.2607278525829315,0.18090204894542694,-0.3925173580646515,0.12123313546180725,-0.23876911401748657},{-0.2796207070350647,-0.43723979592323303,-0.18550042808055878,-0.09002555161714554,-0.4420892000198364,0.43118003010749817,-0.055846188217401505,0.20194076001644135,-0.17053718864917755,-0.33968663215637207,-0.30852895975112915,0.41703835129737854,-0.24173575639724731,0.07491284608840942,-0.29463231563568115,0.39172056317329407},{-0.36319398880004883,0.3557400703430176,-0.17241495847702026,0.12077313661575317,-0.3859480023384094,0.31858736276626587,0.03248085454106331,-0.3684292733669281,0.12283261120319366,0.1952878087759018,-0.21160657703876495,0.08322250843048096,0.27440184354782104,-0.2628959119319916,-0.350597083568573,-0.1503790020942688},{-0.15054570138454437,-0.3906616270542145,-0.5471930503845215,0.31816717982292175,-0.0035242449957877398,0.16998477280139923,-0.30807653069496155,0.21848136186599731,-0.44039544463157654,-0.32724037766456604,-0.42413339018821716,0.2542991638183594,-0.219673752784729,0.18631210923194885,0.100346140563488,0.2843739092350006}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.07696525752544403,-0.13133420050144196,0.08097469806671143,-0.1630123406648636,-0.10847891867160797,0.09413142502307892,0.18860286474227905,-0.21304364502429962,-0.0743975043296814,0.3178425431251526,0.07684051990509033,0.1403602510690689,0.07493634521961212,0.14446592330932617,-0.2229073941707611,0.13144947588443756,0.1320623755455017,-0.3093684911727905,-0.29958227276802063,-0.12579190731048584,-0.1632046103477478,0.13132807612419128,-0.260808527469635,0.35884591937065125,-0.1627064049243927,-0.006125710438936949,0.16010166704654694,0.17924076318740845,-0.26661115884780884,-0.23229137063026428,0.2530938982963562,0.3211095929145813},{0.1787518411874771,-0.027876801788806915,0.173397034406662,-0.047931473702192307,-0.11766012012958527,0.2145722210407257,-0.019012656062841415,-0.0951281189918518,-0.05023796483874321,-0.06409609317779541,-0.10740344226360321,0.045774295926094055,0.4005836248397827,0.21352294087409973,0.14487572014331818,0.07494613528251648,-0.27008435130119324,-0.31995269656181335,0.10732366144657135,0.05114058032631874,0.06124788150191307,0.27693986892700195,0.271394819021225,-0.179979145526886,0.04609503597021103,0.3112565279006958,-0.3478718400001526,0.21893729269504547,0.14250139892101288,-0.24411511421203613,-0.05954979360103607,-0.02505328692495823},{-0.09386985749006271,-0.04710809886455536,0.13508272171020508,-0.15089151263237,-0.21788565814495087,-0.02168409526348114,-0.2853316366672516,0.16084159910678864,0.2973985970020294,-0.008329134434461594,-0.2220493108034134,0.12847310304641724,0.3613613247871399,-0.21626541018486023,0.06782206147909164,-0.029651593416929245,-0.4125255048274994,0.2073429524898529,-0.4115999937057495,-0.07332565635442734,-0.05195353180170059,-0.077180415391922,-0.10285831987857819,-0.08675751090049744,0.005763535387814045,0.43631789088249207,-0.022979816421866417,0.1267484575510025,0.2932566702365875,-0.4350837767124176,-0.07426190376281738,0.034812331199645996},{0.19848677515983582,-0.26788172125816345,0.028899142518639565,-0.42170581221580505,0.13904447853565216,-0.06202773004770279,-0.02307978831231594,0.24760669469833374,0.04826442897319794,0.2755585312843323,0.026298686861991882,-0.18231575191020966,-0.21610453724861145,-0.0953378677368164,0.25987565517425537,-0.23438012599945068,0.07232639193534851,-0.056083157658576965,-0.15358395874500275,0.1003347709774971,-0.16682066023349762,0.17769362032413483,-0.231848806142807,0.33254745602607727,-0.31112778186798096,0.002821207046508789,-0.07759422808885574,-0.26523497700691223,-0.01804533042013645,0.06855999678373337,0.2233913093805313,-0.13926619291305542},{0.26144877076148987,-0.017879284918308258,0.052105359733104706,0.26493802666664124,-0.2530873715877533,-0.07755887508392334,0.18783362209796906,-0.001528036198578775,0.10075618326663971,-0.19181862473487854,0.012348257005214691,-0.0797155424952507,-0.20501001179218292,-0.15958762168884277,0.3105015456676483,0.28128960728645325,-0.05700210481882095,-0.3365102708339691,0.16246014833450317,-0.12484879046678543,-0.11928364634513855,0.20806637406349182,0.26294249296188354,0.006470305845141411,-0.10590521991252899,-0.11495960503816605,0.009911889210343361,0.2670477628707886,0.26402807235717773,0.11619248241186142,0.11821556836366653,-0.23183155059814453},{0.2789396345615387,-0.18027256429195404,0.017059700563549995,0.0954991802573204,-0.1769348531961441,-0.3282972276210785,-0.2506234049797058,-0.3619011342525482,-0.17617124319076538,0.01735944300889969,-0.046481676399707794,0.0006210810388438404,-0.05566060543060303,-0.0014475710922852159,-0.2154800295829773,-0.2974807620048523,0.1685514599084854,0.051416292786598206,-0.3247433602809906,0.2731710970401764,-0.10465800017118454,-0.1756414920091629,0.19640403985977173,-0.10510775446891785,-0.1405603289604187,-0.24823571741580963,-0.12797687947750092,0.052459217607975006,0.07247400283813477,0.2363864928483963,-0.31301605701446533,0.13605396449565887},{0.19009962677955627,0.07482854276895523,0.23525568842887878,-0.16090838611125946,0.23949319124221802,-0.200394406914711,-0.30561912059783936,-0.017592797055840492,0.2979927957057953,0.14475230872631073,-0.17196524143218994,0.12859302759170532,0.0834667831659317,0.3173232078552246,0.115505151450634,-0.043392427265644073,-0.23599176108837128,0.13554246723651886,-0.013017642311751842,-0.03577515855431557,-0.09248083084821701,0.2370501309633255,0.17036467790603638,0.14634433388710022,-0.3037245571613312,-0.22788450121879578,-0.2745855152606964,-0.3539246916770935,0.03669881448149681,-0.12409782409667969,0.2984461188316345,0.14091093838214874},{0.3568649888038635,-0.42068806290626526,0.06964127719402313,-0.46538910269737244,-0.27152296900749207,0.3580496907234192,0.4650317430496216,0.2682393789291382,-0.06425047665834427,0.14285261929035187,0.1769600212574005,-0.19138111174106598,0.017634840682148933,0.2304641455411911,-0.052446991205215454,0.17509391903877258,0.4810279607772827,-0.2634666860103607,-0.08615665137767792,-0.42666226625442505,0.20614050328731537,0.24117833375930786,0.21028828620910645,0.13651947677135468,0.12461322546005249,0.1024722009897232,0.18773667514324188,0.2850072979927063,-0.11578472703695297,-0.24080725014209747,0.26724523305892944,0.11883401870727539},{0.03749486804008484,-0.06093733757734299,0.1860172301530838,0.28524914383888245,-0.22942282259464264,-0.35452303290367126,-0.11005232483148575,0.2239210456609726,-0.16513866186141968,-0.22858788073062897,0.03630615770816803,0.1636863648891449,0.14778248965740204,-0.30820611119270325,0.13264204561710358,-0.1571889966726303,-0.23827150464057922,0.13019497692584991,-0.30034103989601135,0.2606240212917328,-0.32886695861816406,-0.307624876499176,-0.32370519638061523,0.2073778510093689,0.11428699642419815,0.1318708062171936,0.32734277844429016,0.23486392199993134,-0.13881078362464905,-0.36497849225997925,-0.10910254716873169,0.1765892654657364},{0.38708871603012085,0.0743928775191307,0.08541302382946014,0.24919702112674713,0.11515810340642929,0.2942826449871063,-0.033272635191679,0.28410208225250244,-0.1390915811061859,0.04746922105550766,0.16571255028247833,0.09683658927679062,-0.10967925190925598,-0.4088834226131439,0.24992987513542175,0.2562665045261383,0.002823012415319681,-0.19504646956920624,0.0488668829202652,-0.0036482152063399553,0.08508095890283585,-0.3466157913208008,0.4368462860584259,0.009132026694715023,-0.09173638373613358,0.0969386175274849,-0.4025130569934845,-0.12664443254470825,0.09345576912164688,0.06832954287528992,0.13206830620765686,0.2419242262840271},{-0.0927942618727684,0.10889932513237,-0.09099730104207993,0.20554207265377045,-0.10697448998689651,0.2723885178565979,0.07056885957717896,-0.09655386209487915,0.29148629307746887,-0.31532347202301025,-0.15991291403770447,0.19254133105278015,-0.08771142363548279,0.06306080520153046,-0.3041893243789673,0.04636796936392784,0.04159785062074661,0.14216338098049164,0.06491737812757492,-0.14087913930416107,-0.254159152507782,0.17554354667663574,0.2261962741613388,0.20194919407367706,-0.32325074076652527,0.36984384059906006,-0.12837012112140656,0.004629610106348991,-0.1164192333817482,0.11122895032167435,0.23187749087810516,0.25985637307167053},{-0.2529909014701843,0.2854871451854706,-0.09369024634361267,-0.0059477402828633785,-0.27823910117149353,-0.21153564751148224,0.14097227156162262,-0.34056881070137024,-0.010425540618598461,-0.2755740284919739,-0.20311830937862396,-0.06743962317705154,0.19598311185836792,-0.19968964159488678,-0.14160779118537903,-0.3993159830570221,-0.16458643972873688,0.0201437845826149,0.29052168130874634,-0.23357269167900085,0.07145106792449951,-0.15329110622406006,-0.007354371249675751,0.3092586100101471,-0.10515628755092621,0.139235258102417,0.2688601016998291,-0.15480728447437286,-0.10418464988470078,0.28087806701660156,-0.2276848703622818,-0.36384204030036926},{-0.03963592275977135,0.27714529633522034,0.262676864862442,-0.30413660407066345,0.29619669914245605,0.012315796688199043,-0.13017696142196655,-0.01680973544716835,0.10351484268903732,-0.3131142854690552,-0.03739083185791969,0.05252453312277794,0.20914404094219208,0.03492635115981102,0.029585100710392,-0.004683894570916891,0.20212556421756744,-0.3192606270313263,0.34487301111221313,0.06563183665275574,-0.16556522250175476,0.16084884107112885,-0.07597710937261581,-0.2544059157371521,0.2400100827217102,-0.06927438080310822,-0.010073182173073292,-0.10157198458909988,0.07167521864175797,-0.12570928037166595,0.3078712522983551,0.27959707379341125},{0.06933941692113876,-0.24790462851524353,-0.20512525737285614,0.05641871690750122,0.05284666270017624,0.28175193071365356,-0.11594900488853455,-0.27903005480766296,0.3515574336051941,0.07401690632104874,0.012302491813898087,0.02622116729617119,-0.18526916205883026,0.12240076810121536,-0.2144967019557953,-0.3246893286705017,0.06432702392339706,0.03317301347851753,0.16968408226966858,0.3763791024684906,-0.24234682321548462,0.162528857588768,-0.18596559762954712,0.09408149123191833,0.06786675751209259,-0.3088199496269226,-0.1427377313375473,-0.3203456997871399,-0.13824136555194855,-0.14699026942253113,0.19857792556285858,-0.35716474056243896},{-0.08814247697591782,0.3296460509300232,0.10748115926980972,-0.20924299955368042,-0.1541520208120346,-0.23967765271663666,0.15695461630821228,-0.07758534699678421,0.27059680223464966,-0.05223947763442993,0.2519450783729553,0.19213373959064484,-0.019659388810396194,0.07412806153297424,-0.19071002304553986,0.17719566822052002,-0.19424104690551758,-0.3974508047103882,-0.3097423315048218,0.09523110836744308,0.1553153693675995,-0.2746787369251251,-0.36082133650779724,-0.24239738285541534,-0.17529796063899994,0.10802344977855682,0.406206339597702,0.01028069294989109,-0.13071805238723755,0.040559206157922745,-0.12683849036693573,0.13117851316928864},{-0.20811685919761658,-0.18184417486190796,-0.24797584116458893,0.08971726149320602,-0.298155814409256,-0.1406036615371704,-0.14185141026973724,-0.1820821613073349,-0.2881045341491699,-0.19825659692287445,0.102350614964962,0.18595486879348755,-0.2360106259584427,0.285346120595932,-0.029860297217965126,0.17445573210716248,0.018892060965299606,0.029072312638163567,0.031115004792809486,0.15333126485347748,0.1399182230234146,0.3354279398918152,0.10010077804327011,0.2408624291419983,0.10192269831895828,-0.24610620737075806,-0.14840184152126312,0.23090000450611115,-0.05850333720445633,-0.2117731273174286,-0.15790672600269318,-0.23099160194396973},{-0.31326404213905334,-0.1916458010673523,-0.38673853874206543,0.12011069059371948,-0.13761481642723083,-0.1038576140999794,-0.16952936351299286,0.03982343524694443,-0.035374511033296585,0.070743128657341,-0.2559393346309662,0.043944958597421646,0.1821698397397995,-0.051702387630939484,0.04374178126454353,0.19148705899715424,-0.17363053560256958,-0.12397127598524094,0.15106327831745148,0.11078725755214691,0.19468115270137787,0.006926705129444599,-0.2631578743457794,0.045629195868968964,0.24639661610126495,-0.2744850814342499,0.15679463744163513,0.017717167735099792,0.0793895274400711,-0.17192627489566803,0.21326032280921936,-0.09505732357501984},{0.2657009959220886,-0.061727773398160934,0.044567544013261795,0.09966254979372025,-0.2753927707672119,0.0062978994101285934,0.16969819366931915,0.23454716801643372,-0.08830107748508453,-0.09999494254589081,0.30257391929626465,-0.1992233246564865,-0.029210804030299187,-0.08205695450305939,-0.14858698844909668,0.215112566947937,0.031194614246487617,-0.0736008808016777,0.13065659999847412,-0.29263386130332947,0.03668506070971489,-0.30967554450035095,-0.23141495883464813,0.2556116282939911,-0.13274554908275604,-0.13215488195419312,0.16356034576892853,-0.0076282029040157795,-0.1622723639011383,-0.006826930679380894,-0.10083702951669693,-0.013561754487454891},{0.32982510328292847,-0.05882401391863823,0.09377750754356384,0.08131013065576553,-0.003809805493801832,-0.09275731444358826,0.1512308418750763,-0.23956650495529175,0.22005915641784668,0.29864126443862915,-0.008318697102367878,0.1718221753835678,0.2725474238395691,0.32956168055534363,-0.27845045924186707,-0.29068878293037415,-0.31214600801467896,0.05013427883386612,-0.14553457498550415,-0.28816449642181396,-0.21246203780174255,0.305419385433197,0.08110200613737106,0.1512017697095871,-0.15670254826545715,-0.09412787109613419,-0.1586526334285736,-0.19391211867332458,0.26427340507507324,0.17877385020256042,-0.26435333490371704,-0.15567883849143982},{-0.11890484392642975,0.12213702499866486,0.2561277449131012,-0.09014598280191422,-0.03577388450503349,0.05356281250715256,-0.007174194790422916,-0.3135513663291931,0.22965805232524872,0.2713579833507538,0.14889726042747498,0.19678883254528046,-0.25253602862358093,0.18775498867034912,-0.2999672293663025,0.2550179958343506,0.18184100091457367,-0.2288823127746582,0.22668877243995667,0.1279163956642151,-0.31178465485572815,0.31407010555267334,-0.33607321977615356,0.14362718164920807,0.21488958597183228,0.23200872540473938,0.11819253861904144,0.08531256020069122,-0.19896391034126282,0.2260977029800415,-0.08756652474403381,0.1288585364818573},{-0.1592637598514557,-0.05361613258719444,-0.012299652211368084,0.25858402252197266,-0.03906276077032089,0.16230081021785736,-0.36935311555862427,-0.20935072004795074,-0.14098624885082245,-0.12682673335075378,-0.18515193462371826,-0.10296016186475754,0.09606458991765976,-0.10461268573999405,0.10049253702163696,-0.19651038944721222,0.14959828555583954,-0.021508121863007545,-0.33314868807792664,-0.2173399180173874,0.0893392264842987,0.20526938140392303,-0.20145809650421143,0.3159782290458679,-0.23803772032260895,0.10630244761705399,0.11541199684143066,-0.08935686200857162,0.1249493882060051,-0.26711490750312805,0.3420180678367615,0.06371535360813141},{0.3592411279678345,-0.0797247588634491,0.08059316128492355,0.1380685567855835,-0.16883638501167297,0.24675917625427246,-0.010747716762125492,0.25099441409111023,0.15934796631336212,0.13492964208126068,0.03081599250435829,-0.41882020235061646,-0.28174397349357605,-0.052096519619226456,0.06652768701314926,-0.14404675364494324,0.332276850938797,0.2367064505815506,-0.20665886998176575,-0.20492801070213318,0.27894556522369385,0.2846856415271759,0.26300811767578125,0.17454327642917633,-0.0718563124537468,-0.04554138332605362,-0.07632412761449814,-0.24104805290699005,0.20738700032234192,0.10313370823860168,-0.21015110611915588,0.12024731934070587},{-0.03498906269669533,0.01181396096944809,-0.08144351840019226,-0.26845186948776245,-0.10717836767435074,-0.24510179460048676,-0.21863701939582825,-0.16645118594169617,0.023096881806850433,-0.01357157900929451,-0.2641419768333435,0.007873478345572948,-0.25850817561149597,-0.16445563733577728,-0.01012597605586052,0.06613088399171829,0.2939745783805847,-0.17134426534175873,-0.3527597188949585,0.2689965069293976,-0.14906397461891174,0.25625449419021606,-0.028506893664598465,-0.05013533681631088,0.0644843801856041,0.1258421540260315,-0.049037687480449677,-0.28831538558006287,0.2195601761341095,0.2460106462240219,-0.16386371850967407,0.20866431295871735},{-0.2448093593120575,0.008636916987597942,0.08019586652517319,0.021559560671448708,0.07670127600431442,0.11756967753171921,-0.1864360272884369,0.10549537092447281,-0.2366301268339157,-0.20802944898605347,0.13081741333007812,-0.11634355038404465,-0.17176122963428497,0.24406477808952332,0.04675158113241196,0.03974927216768265,0.1756955087184906,-0.2656077742576599,-0.12699124217033386,0.26446712017059326,0.029053794220089912,0.20334337651729584,0.021592311561107635,0.00887126661837101,-0.3109720051288605,-0.1503228396177292,-0.01751239225268364,0.333132266998291,0.020271606743335724,0.009513567201793194,0.2907741069793701,0.2815134525299072}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.05085969716310501,0.2078821063041687,0.4764648377895355,-0.09802402555942535},{0.07565998286008835,-0.16167156398296356,0.008281962014734745,0.3267814815044403},{-0.13394425809383392,0.12309912592172623,0.16884692013263702,0.12405019253492355},{0.38553205132484436,0.058485548943281174,0.04651819169521332,0.5567049384117126},{-0.073419950902462,0.10387903451919556,0.35308414697647095,0.03970586881041527},{-0.15911135077476501,0.252871036529541,0.297611802816391,-0.07647613435983658},{-0.4413427412509918,-0.07248526811599731,0.12113819271326065,-0.18797041475772858},{-0.4138507843017578,-0.16410838067531586,0.5112027525901794,-0.2979377508163452},{0.3298678398132324,-0.15793830156326294,-0.3129684627056122,-0.43955913186073303},{0.06589987874031067,0.3502676486968994,0.38157400488853455,-0.5506864190101624},{-0.29412180185317993,-0.24425199627876282,-0.07913986593484879,0.11800725758075714},{0.49544355273246765,-0.22697268426418304,-0.08154521882534027,0.2439364641904831},{0.3209221661090851,0.2744966447353363,-0.06588888168334961,0.16342486441135406},{0.0016950326971709728,0.04762934148311615,-0.32042765617370605,0.055211178958415985},{0.0944671481847763,0.2997732162475586,0.4646380841732025,0.3640754222869873},{0.15066757798194885,-0.03748667240142822,0.3258470296859741,0.29085248708724976},{-0.3387526869773865,-0.10769008845090866,-0.08115404844284058,-0.32583117485046387},{-0.13331454992294312,0.21575437486171722,-0.17675690352916718,-0.10862021148204803},{-0.38252055644989014,0.21627944707870483,0.20118112862110138,0.4460855722427368},{-0.018967710435390472,0.37809762358665466,-0.23042896389961243,0.20181742310523987},{-0.30795374512672424,-0.39056596159935,-0.11917533725500107,0.04132280871272087},{0.36455175280570984,0.4789598286151886,0.025278998538851738,-0.34773996472358704},{-0.01732010953128338,0.21785502135753632,0.2495795488357544,0.23915903270244598},{-0.0629618763923645,0.4423883259296417,-0.06005864217877388,-0.2489193230867386},{-0.004615968093276024,-0.09374170750379562,-0.13103830814361572,-0.0011517194798216224},{0.3665381968021393,-0.5024182796478271,-0.03421802446246147,-0.00569794699549675},{-0.03895370289683342,-0.41883406043052673,-0.20435357093811035,-0.3228284418582916},{0.16965605318546295,-0.23992614448070526,0.25155752897262573,0.17084813117980957},{0.04880558326840401,-0.05340482294559479,0.06978334486484528,0.057844243943691254},{-0.4857328534126282,0.43445703387260437,0.21973036229610443,-0.009549287147819996},{0.3711271584033966,-0.18237996101379395,0.23784929513931274,-0.04887425899505615},{0.13693571090698242,-0.47405585646629333,0.4441520571708679,-0.28912827372550964}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.03811175003647804,-0.014389045536518097,0.020851651206612587,0.03940577805042267,-0.0840129479765892,-0.07684154063463211,0.013328732922673225,0.05051349103450775,0.08809425681829453,-0.012643798254430294,-0.04632658511400223,-0.021247413009405136,0.04120879992842674,-0.009877913631498814,-0.04808865115046501,-0.03487691655755043};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.027618717402219772,0.004376699682325125,-0.00019082799553871155,0.019003896042704582,0.021556861698627472,-0.015622240491211414,0.033316440880298615,0.010671754367649555,0.010518399998545647,0.02170645259320736,0.03757472708821297,0.0008544127340428531,0.048280276358127594,-0.037078745663166046,-0.03405926749110222,-0.004824198316782713};
static const float actor_encoder_feed_forward_0_bias[32] = {0.011872532777488232,0.009173319675028324,0.025898637250065804,0.0009961238829419017,0.012070233933627605,0.006363671738654375,0.015018349513411522,0.017383117228746414,-0.038543764501810074,-0.013677806593477726,0.013180794194340706,0.0035894212778657675,0.00633217953145504,0.01154822576791048,-0.002904272871091962,0.03491734340786934,-0.0006746556027792394,-0.00807551946491003,0.022204585373401642,-0.00737420842051506,-0.014764264225959778,-0.008364124223589897,0.04045385122299194,0.01603570394217968,-0.004737749230116606,0.013751721940934658,-0.021048998460173607,0.031691886484622955,-0.0064162565395236015,0.01657332107424736,0.016056163236498833,-0.007187429815530777};
static const float action_parameterization_distribution_linear_bias[4] = {-0.01604536361992359,-0.0087350532412529,-0.0006633016746491194,0.00941078457981348};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.06607115268707275,0.2397289127111435,-0.17239722609519958,0.22286517918109894,0.08721470087766647,0.043501488864421844,0.3568659722805023,-0.04675871878862381},{-0.2572718858718872,-0.03451322391629219,-0.3061094284057617,-0.19397738575935364,-0.40503737330436707,-0.26671102643013,-0.02484826184809208,-0.2505388855934143},{-0.2673110067844391,0.0328182652592659,0.22155511379241943,0.26541340351104736,0.23252521455287933,-0.04977203533053398,0.3842657804489136,-0.17632590234279633},{0.026102058589458466,0.1067732572555542,-0.1938677430152893,0.026711465790867805,0.012060676701366901,-0.07128722220659256,0.3445518910884857,-0.25515714287757874},{-0.3128952085971832,-0.12755221128463745,-0.24979844689369202,-0.1099226176738739,-0.027801135554909706,0.17122076451778412,0.18124550580978394,-0.059225957840681076},{-0.3282051682472229,-0.03178839385509491,0.37172338366508484,0.25509148836135864,0.18547050654888153,-0.113043874502182,-0.1354483962059021,-0.15082252025604248},{-0.26044464111328125,0.017411747947335243,0.4020153880119324,-0.19249191880226135,-0.10725066810846329,-0.41237854957580566,-0.11290715634822845,-0.11058804392814636},{-0.2718771994113922,-0.3381778299808502,0.4721401631832123,-0.10110298544168472,-0.13932833075523376,0.2714928984642029,0.17272403836250305,-0.24193480610847473},{-0.35980287194252014,0.3228032886981964,-0.18381255865097046,0.3339437246322632,0.17537833750247955,-0.263649582862854,0.01246922928839922,0.12926574051380157},{-0.40194451808929443,-0.29100286960601807,-0.15333570539951324,-0.22344283759593964,-0.4926470220088959,0.1559365838766098,-0.04100866988301277,0.1714656502008438},{0.08262589573860168,0.3575454354286194,0.2134982794523239,-0.02541528083384037,0.21240486204624176,0.15938657522201538,-0.21270017325878143,0.23454731702804565},{0.1328226625919342,0.034401532262563705,0.26138749718666077,0.26299163699150085,-0.3252066969871521,0.2936399281024933,-0.010405709967017174,-0.21282199025154114},{0.06553807109594345,-0.33629268407821655,0.26143863797187805,-0.03891821205615997,-0.3856957256793976,-0.09366344660520554,-0.18747761845588684,-0.09424407035112381},{-0.23805546760559082,-0.26292240619659424,0.3253685235977173,0.35758063197135925,-0.26791301369667053,-0.07479984313249588,-0.30612969398498535,0.25202929973602295},{0.06138433516025543,-0.17478394508361816,0.1353115737438202,-0.22185376286506653,-0.28662756085395813,-0.12974292039871216,0.25255486369132996,0.02079218253493309},{0.19390691816806793,-0.017574680969119072,0.017430733889341354,-0.23437683284282684,0.06407776474952698,0.061714500188827515,0.1459580808877945,0.3760035037994385},{-0.013007717207074165,-0.2972113788127899,-0.17057180404663086,0.12920334935188293,-0.21321247518062592,-0.1483602672815323,-0.12502220273017883,0.13054707646369934},{-0.17092177271842957,-0.32822927832603455,0.024548619985580444,0.06059553474187851,0.11847132444381714,-0.1995607316493988,0.3338901698589325,0.19388577342033386},{0.004678104072809219,0.08447784930467606,-0.2742250859737396,0.13611865043640137,0.11435004323720932,0.19017218053340912,-0.2570136487483978,0.39234840869903564},{0.11683591455221176,-0.044522132724523544,-0.39003026485443115,0.11229731142520905,-0.04630063474178314,-0.02806432917714119,-0.3394738435745239,0.02842356450855732},{0.048881612718105316,-0.1314215362071991,0.04304913803935051,-0.07744496315717697,0.35526522994041443,0.052571944892406464,-0.03312113508582115,0.4220466613769531},{-0.001328000333160162,0.1266903132200241,-0.27286577224731445,0.32080814242362976,0.3755221664905548,0.34015604853630066,0.21678225696086884,-0.3185710310935974},{-0.4557637870311737,-0.13264429569244385,0.16109547019004822,-0.02148112654685974,0.21311606466770172,-0.29538673162460327,0.2814421057701111,-0.29126256704330444},{-0.24770057201385498,0.012567178346216679,-0.07026219367980957,-0.33945444226264954,0.21092446148395538,-0.02906322292983532,-0.28596359491348267,0.1736885905265808},{-0.32103410363197327,-0.19655358791351318,0.013188507407903671,0.07331794500350952,-0.11264456063508987,0.10946110635995865,0.33849307894706726,-0.12660358846187592},{-0.29935771226882935,0.053286921232938766,-0.38645121455192566,-0.3117736577987671,0.16164731979370117,0.022504368796944618,-0.06274300813674927,0.07789142429828644},{0.25064003467559814,0.383714884519577,-0.31596240401268005,0.16651949286460876,0.22723105549812317,0.3954235911369324,-0.27369436621665955,-0.13358767330646515},{0.28724905848503113,0.25327110290527344,0.038089558482170105,0.06471208482980728,0.2922321557998657,0.20491820573806763,0.28093287348747253,0.3781174123287201},{-0.22550618648529053,0.3956579864025116,0.1540961116552353,0.0013657475356012583,0.2191939353942871,0.04667159542441368,-0.30642199516296387,-0.30677828192710876},{-0.31469428539276123,-0.21170790493488312,0.07993746548891068,-0.25559571385383606,-0.31683602929115295,-0.17426680028438568,0.35305196046829224,-0.07427597790956497},{0.2760312259197235,-0.24145182967185974,0.33766791224479675,-0.3195417523384094,0.01382429338991642,0.22331103682518005,0.24026232957839966,-0.27291959524154663},{0.09228749573230743,0.38564932346343994,0.3850889503955841,-0.2527296245098114,-0.2807154953479767,0.03804083913564682,0.23976221680641174,0.058202631771564484}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.005123763810843229,0.4665854871273041,-0.1917254626750946,0.21155419945716858,-0.41740337014198303,0.32022562623023987,0.3359987437725067,0.07634355872869492},{-0.5102782845497131,-0.4073454439640045,-0.3829714059829712,-0.43037450313568115,-0.5003044009208679,0.49165427684783936,0.3910306990146637,-0.4027290344238281},{0.09813671559095383,-0.1934516280889511,0.14801812171936035,0.16442184150218964,-0.024196390062570572,0.452419638633728,-0.3342573344707489,-0.4624632000923157},{0.4826418161392212,-0.00780579773709178,0.17162710428237915,0.026653947308659554,0.5044913291931152,0.4209093153476715,0.48382553458213806,0.3431713283061981},{0.09239930659532547,0.2129419595003128,-0.1978399008512497,-0.32880082726478577,0.06587638705968857,-0.5149094462394714,-0.5160303711891174,0.646051824092865},{0.43950971961021423,0.06056233122944832,0.019524700939655304,-0.381762832403183,-0.4758950471878052,-0.5201770663261414,-0.1253650039434433,0.4551110565662384},{-0.47609901428222656,-0.3599381446838379,-0.09451734274625778,-0.2558732032775879,-0.012934444472193718,0.5189344882965088,-0.5489456057548523,0.53706955909729},{0.26257649064064026,0.09758411347866058,-0.024001915007829666,0.05581166595220566,0.4346494972705841,-0.584906280040741,0.42146164178848267,-0.36994805932044983}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09326642006635666,0.018932929262518883,0.029342075809836388,-0.015483617782592773,-0.040620677173137665,0.02266462706029415,0.0021977147553116083,0.008124364539980888};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012613857164978981,-0.009674904868006706,-0.02420000173151493,0.030956797301769257,-0.011221062391996384,-0.009169205091893673,0.016687577590346336,-0.055470965802669525};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

