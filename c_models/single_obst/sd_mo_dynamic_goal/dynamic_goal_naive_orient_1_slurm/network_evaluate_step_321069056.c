#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2919456660747528,0.03188470005989075,-0.10999229550361633,0.3177618682384491,0.28329646587371826,-0.18290409445762634,-0.22862735390663147,0.11281546950340271,0.2855052947998047,-0.322855144739151,0.5621688961982727,-0.0467303991317749,0.30129334330558777,0.12460619956254959,-0.42202356457710266,0.04329902306199074},{-0.24272862076759338,-0.2705680727958679,-0.287397563457489,-0.20280735194683075,0.0736178383231163,0.29556888341903687,0.07668332755565643,0.09068137407302856,0.23549683392047882,0.17737379670143127,-0.1476811021566391,-0.06523974239826202,-0.15945346653461456,0.08585797995328903,0.32204195857048035,-0.2835689187049866},{0.1422528624534607,0.21185235679149628,0.2107774019241333,0.3238794207572937,-0.09979595243930817,-0.2145048975944519,0.43277880549430847,-0.03147393465042114,0.0035700721200555563,-0.08306606113910675,-0.07804730534553528,0.00011129242193419486,0.061630573123693466,0.4318446218967438,-0.25255823135375977,-0.08512328565120697},{0.1529330164194107,-0.1644635945558548,-0.12079710513353348,-0.15135891735553741,0.05419451743364334,0.08479959517717361,0.0700661689043045,-0.19888335466384888,-0.13731543719768524,0.15469582378864288,0.5406174063682556,-0.23088859021663666,-0.19129519164562225,-0.16277408599853516,0.19818080961704254,0.10223610699176788},{-0.31402719020843506,0.011772003024816513,0.1212477758526802,-0.21508529782295227,0.27854591608047485,0.32348138093948364,0.14080266654491425,-0.192076176404953,-0.13964729011058807,0.13116420805454254,-0.13469842076301575,-0.39572158455848694,-0.037106920033693314,-0.1657065451145172,0.2948276996612549,-0.035079244524240494},{0.0168919675052166,-0.032926592975854874,0.0008242285111919045,-0.036951638758182526,0.11177334934473038,-0.1465512067079544,0.42614755034446716,-0.32179751992225647,-0.12895984947681427,-0.14795364439487457,0.2793337106704712,0.0536249615252018,0.24830500781536102,0.04715043306350708,0.28882700204849243,0.2650832235813141},{-0.23083390295505524,0.20324403047561646,-0.10550945997238159,0.0288091991096735,-0.22572539746761322,-0.08838147670030594,-0.13932926952838898,-0.028965387493371964,0.15578243136405945,0.36369985342025757,-0.2604176104068756,-0.12220253795385361,0.23495040833950043,0.08546219766139984,-0.1939651370048523,0.34007319808006287},{-0.11634036153554916,0.031035983934998512,-0.14712020754814148,-0.17137537896633148,0.37139758467674255,-0.28728267550468445,-0.28536975383758545,-0.4235590696334839,-0.08113107085227966,-0.2356039583683014,0.38335785269737244,-0.02727493830025196,0.18778520822525024,0.18195323646068573,-0.20569828152656555,0.39966702461242676},{0.22668273746967316,0.0755879208445549,0.017550986260175705,0.07773939520120621,-0.398163378238678,-0.45956987142562866,0.326526015996933,-0.3120429813861847,-0.17519357800483704,0.20030425488948822,0.16773726046085358,-0.295293927192688,-0.1524847149848938,0.03070460818707943,0.16818346083164215,-0.030636778101325035},{0.43507444858551025,-0.5460298657417297,-0.12425675243139267,-0.02378620207309723,0.1959736943244934,-0.15820518136024475,-0.2653113603591919,-0.19084866344928741,-0.14558391273021698,-0.040391866117715836,-0.01177825778722763,-0.2241833359003067,0.3607512414455414,-0.1152927428483963,-0.48957863450050354,-0.15812820196151733},{0.1964372843503952,0.20961008965969086,-0.36105185747146606,0.08944777399301529,-0.019153745844960213,-0.2487441897392273,-0.11704114079475403,0.11377733200788498,-0.14825548231601715,0.17014655470848083,0.16698363423347473,0.2288493663072586,-0.13008026778697968,0.2559069097042084,-0.08401472121477127,-0.20498886704444885},{-0.40373438596725464,0.25674158334732056,0.26206356287002563,-0.27552875876426697,-0.30600982904434204,0.29719579219818115,0.038858406245708466,0.3298252820968628,0.19088990986347198,0.15539909899234772,0.2542056739330292,-0.10264918208122253,0.1532723754644394,-0.05075902119278908,-0.09131699055433273,-0.14036469161510468},{0.10967645794153214,-0.26107749342918396,-0.18665581941604614,0.2155417948961258,-0.19122859835624695,-0.2705270051956177,-0.12300100922584534,0.266340434551239,0.3281988203525543,-0.14554864168167114,-0.11415091156959534,0.056877411901950836,0.2863529324531555,0.13685809075832367,-0.18547318875789642,0.3174084424972534},{0.2834470272064209,0.19081002473831177,-0.15965934097766876,-0.09527070075273514,0.09064210951328278,-0.05260331183671951,-0.11203556507825851,0.3281758725643158,-0.23875297605991364,-0.18385624885559082,-0.17116189002990723,0.02412855252623558,-0.20268601179122925,-0.12347394973039627,-0.2226337492465973,-0.04193032532930374},{0.16340371966362,0.3728781044483185,0.41066232323646545,-0.3922160863876343,-0.37496861815452576,0.09076645970344543,0.06333162635564804,-0.11667593568563461,0.36918336153030396,0.39646801352500916,-0.1953030377626419,0.0877578854560852,-0.04614652320742607,-0.33668845891952515,0.037342626601457596,-0.12186264991760254},{-0.18167825043201447,-0.22085519134998322,-0.13098515570163727,0.40861403942108154,-0.238101989030838,-0.155592679977417,-0.24546360969543457,-0.26667341589927673,-0.5623114705085754,-0.24372726678848267,0.3374439775943756,0.27137845754623413,-0.6113873720169067,-0.33150729537010193,-0.6215199828147888,-0.13963429629802704},{-0.5190110206604004,0.1784532368183136,-0.41193440556526184,-0.12559711933135986,-0.4588319957256317,0.20861001312732697,0.4665045440196991,0.07676219940185547,0.43536555767059326,-0.45944464206695557,0.16349230706691742,-0.3710689842700958,-0.17372547090053558,0.03347340598702431,-0.153196319937706,-0.20833668112754822},{0.31842678785324097,-0.5888281464576721,0.3020476698875427,0.27511727809906006,-0.1073741465806961,0.45768648386001587,0.30306240916252136,0.29461026191711426,-0.050370559096336365,-0.2705758810043335,-0.13848115503787994,-0.17452985048294067,-0.03642840310931206,-0.5149512887001038,0.21902674436569214,-0.11165612936019897}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05780108645558357,0.3220139741897583,0.24737492203712463,-0.17170333862304688,-0.18774156272411346,0.04159647226333618,-0.03656637296080589,0.25268614292144775,-0.06840839982032776,0.3191066384315491,0.485102117061615,-0.3812291622161865,0.0361006073653698,0.041696202009916306,0.035348884761333466,-0.12903310358524323},{-0.4517062306404114,0.18840332329273224,-0.22329390048980713,0.3101682662963867,0.2842487692832947,-0.17042170464992523,-0.32890769839286804,-0.1759514957666397,0.36979275941848755,0.24951711297035217,-0.06905908137559891,0.2581872344017029,-0.4145743250846863,0.18219293653964996,-0.22793707251548767,0.45760661363601685},{-0.27835336327552795,0.10037326067686081,-0.36260512471199036,0.20840752124786377,-0.48650047183036804,-0.2552158832550049,0.08129624277353287,0.17244186997413635,-0.24667271971702576,0.4125610589981079,0.24786697328090668,-0.18787792325019836,0.18139389157295227,-0.292439728975296,-0.15429861843585968,-0.09671161323785782},{0.3381611704826355,-0.235530287027359,0.1026032492518425,0.4058344066143036,-0.40875282883644104,-0.2905382812023163,0.2987273633480072,0.045936182141304016,0.2880575358867645,-0.08166835457086563,0.334916353225708,0.09157000482082367,-0.22295038402080536,0.0018954894039779902,0.002697607036679983,-0.44249534606933594},{-0.40339717268943787,-0.0538095161318779,0.16687647998332977,-0.2779906690120697,0.16895145177841187,0.41787368059158325,-0.2853103280067444,0.28248998522758484,-0.2367381602525711,0.2251662164926529,-0.009054009802639484,0.006378164980560541,-0.2500685155391693,-0.015184146352112293,-0.29418739676475525,-0.13825346529483795},{0.05331193655729294,-0.3260016143321991,0.009314370341598988,-0.3212820887565613,0.21007922291755676,0.05458808317780495,-0.15081754326820374,-0.045755598694086075,-0.15196625888347626,0.40220925211906433,0.2182283252477646,-0.007921810261905193,-0.3054793179035187,0.07145252078771591,0.010718419216573238,-0.29093971848487854},{0.2883388102054596,-0.1639845073223114,0.34364449977874756,-0.23914176225662231,-0.4200413227081299,-0.045904215425252914,-0.3454723060131073,0.3550325930118561,-0.0962463766336441,-0.25593358278274536,-0.2543718218803406,-0.029930559918284416,-0.03718303516507149,-0.09115726500749588,0.49042749404907227,-0.36281561851501465},{-0.33857080340385437,0.3555855453014374,-0.07527218014001846,0.17914527654647827,-0.044480353593826294,-0.2116742730140686,-0.233938530087471,0.068992018699646,0.004814743995666504,0.5239934921264648,0.12111265957355499,-0.10736006498336792,0.0414552241563797,-0.2577053904533386,0.10870185494422913,0.15544313192367554},{0.07950329035520554,0.2820006012916565,-0.17279388010501862,-0.34892386198043823,0.36235228180885315,-0.18730586767196655,0.1430782675743103,-0.3317800760269165,0.13207808136940002,0.06907831132411957,0.08641074597835541,0.14145618677139282,0.021941866725683212,-0.41604912281036377,-0.04077870771288872,0.21737796068191528},{-0.23018120229244232,0.07011938840150833,-0.29557138681411743,-0.3491746783256531,0.2252090573310852,-0.42014938592910767,-0.1379983127117157,0.31586992740631104,-0.17494875192642212,0.13858331739902496,-0.026122476905584335,-0.1118343397974968,-0.35924601554870605,0.11846651881933212,-0.24472886323928833,-0.29357901215553284},{-0.14311301708221436,-0.15011170506477356,0.005992966704070568,-0.2456943690776825,-0.3246316611766815,-0.02365102432668209,0.15523885190486908,-0.4168734848499298,0.04200311377644539,-0.09804773330688477,0.2818847894668579,-0.055004920810461044,0.2937181293964386,0.15917915105819702,0.22991891205310822,0.23141063749790192},{-0.09132618457078934,-0.030582131817936897,-0.40538421273231506,0.3120192289352417,0.1011677011847496,0.152623251080513,0.2386283427476883,0.16551272571086884,-0.4382668733596802,0.18784813582897186,-0.32739371061325073,-0.21172307431697845,-0.36048394441604614,0.3781421482563019,-0.3534918427467346,0.08453920483589172},{-0.23567885160446167,-0.49843379855155945,-0.13490688800811768,0.1684366762638092,-0.23516693711280823,-0.018144801259040833,-0.10000704973936081,0.37635594606399536,0.47702279686927795,0.15391185879707336,-0.01889331266283989,-0.18228018283843994,0.15405535697937012,-0.414880633354187,0.10013736039400101,-0.21198327839374542},{-0.2811170816421509,-0.45068472623825073,-0.17250686883926392,-0.16150109469890594,-0.47218582034111023,0.5228471755981445,-0.16297803819179535,0.20234441757202148,-0.10825011134147644,-0.2617734670639038,-0.34390127658843994,0.45403021574020386,-0.180878683924675,-0.03597130998969078,-0.2446277141571045,0.37799233198165894},{-0.3649792969226837,0.3559921979904175,-0.22374491393566132,0.1317053735256195,-0.3969220519065857,0.17792975902557373,-0.06429005414247513,-0.2792849838733673,0.11684486269950867,0.23279336094856262,-0.2739957571029663,0.06195772439241409,0.2392009198665619,-0.3406405448913574,-0.34082961082458496,-0.13525596261024475},{-0.14061236381530762,-0.2975311279296875,-0.45540493726730347,0.2177896648645401,0.1284293681383133,0.058758001774549484,-0.2519722580909729,0.18475459516048431,-0.35039523243904114,-0.2437543272972107,-0.3015405237674713,0.21170438826084137,-0.17173831164836884,0.12623287737369537,0.06350230425596237,0.27246737480163574}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10146448016166687,-0.0708128958940506,0.12921097874641418,-0.14860907196998596,-0.10759779810905457,0.10584717988967896,0.19495229423046112,-0.2136286199092865,-0.1642468273639679,0.2908647358417511,0.11594222486019135,0.13102766871452332,0.10351543128490448,0.17503675818443298,-0.1684495508670807,0.1429336667060852,0.12253232300281525,-0.338811993598938,-0.22540158033370972,-0.07843786478042603,-0.14794182777404785,0.11719244718551636,-0.22611203789710999,0.28509026765823364,-0.0901172086596489,-0.03312249854207039,0.1394755244255066,0.1929924637079239,-0.2506273686885834,-0.17609214782714844,0.21383477747440338,0.28505510091781616},{0.23751956224441528,-0.04820603132247925,0.14103829860687256,-0.09768456220626831,-0.1318712681531906,0.25460806488990784,-0.02320256642997265,-0.06751512736082077,-0.03522627055644989,0.00155045953579247,-0.14049184322357178,0.026975465938448906,0.41417327523231506,0.16348011791706085,0.14293314516544342,0.09506773948669434,-0.26707538962364197,-0.3729735016822815,0.09047918766736984,0.030868826434016228,0.05077459290623665,0.30721861124038696,0.22479645907878876,-0.24490949511528015,0.05566732957959175,0.28750091791152954,-0.29938027262687683,0.19207584857940674,0.13851593434810638,-0.23810483515262604,-0.027590855956077576,0.006670891772955656},{-0.10518016666173935,-0.050836410373449326,0.23271672427654266,-0.21071162819862366,-0.2159746140241623,0.024307698011398315,-0.17104175686836243,0.22567078471183777,0.1584605723619461,-0.01735207438468933,-0.15582025051116943,0.027197666466236115,0.267813116312027,-0.21060141921043396,0.08063727617263794,-0.03524104878306389,-0.33351054787635803,0.2497996836900711,-0.28946036100387573,-0.054993871599435806,0.008203992620110512,-0.13467451930046082,-0.0799139067530632,-0.12032800167798996,0.005246370565146208,0.34421148896217346,-0.039076484739780426,0.08797980099916458,0.26477158069610596,-0.3018442690372467,-0.17443563044071198,-0.01740304008126259},{0.15668269991874695,-0.16001717746257782,0.07458458095788956,-0.3677753210067749,0.16218265891075134,-0.10636315494775772,-0.036495599895715714,0.2841266989707947,0.014973403885960579,0.18740826845169067,0.1185312420129776,-0.1386748105287552,-0.22055160999298096,-0.1018248200416565,0.30081403255462646,-0.24428625404834747,0.05895882472395897,-0.10789927840232849,-0.1248958483338356,0.08693978935480118,-0.11438677459955215,0.060636717826128006,-0.21013998985290527,0.25946807861328125,-0.30804604291915894,0.06561177968978882,-0.0806398019194603,-0.20611873269081116,0.050661664456129074,0.047835588455200195,0.23086655139923096,-0.10359304398298264},{0.22005921602249146,0.022860398516058922,0.04426468163728714,0.269759863615036,-0.265708327293396,-0.07227940112352371,0.18530654907226562,-0.06426739692687988,0.09674153476953506,-0.19877314567565918,0.003698933171108365,-0.0688490942120552,-0.13719391822814941,-0.14691899716854095,0.296715646982193,0.32463765144348145,-0.0999131053686142,-0.34338897466659546,0.18416155874729156,-0.11327549070119858,-0.12741748988628387,0.209762305021286,0.28697100281715393,0.0358242429792881,-0.052504923194646835,-0.10145177692174911,-0.0357220433652401,0.269161194562912,0.2620972692966461,0.12060832977294922,0.07803834229707718,-0.27666759490966797},{0.3084889352321625,-0.17082935571670532,0.05081205815076828,0.09444680064916611,-0.1645415872335434,-0.30371972918510437,-0.2035197913646698,-0.30999666452407837,-0.23647122085094452,0.004472773987799883,-0.016299888491630554,-0.029178468510508537,-0.15732130408287048,-0.02446398325264454,-0.2267337590456009,-0.23610658943653107,0.1828596293926239,0.021598931401968002,-0.2865343689918518,0.20682097971439362,-0.045807916671037674,-0.22290943562984467,0.18957428634166718,-0.1600748598575592,-0.13014255464076996,-0.24892501533031464,-0.09920807927846909,0.1119341105222702,0.09317290782928467,0.2640637457370758,-0.27940693497657776,0.15394631028175354},{0.18568643927574158,0.05610476806759834,0.25229522585868835,-0.1873178333044052,0.23520949482917786,-0.17800304293632507,-0.25185656547546387,0.03093007765710354,0.2823067903518677,0.16885657608509064,-0.13385611772537231,0.07667841762304306,0.0726047083735466,0.348152756690979,0.13130374252796173,-0.12391510605812073,-0.19357861578464508,0.15871478617191315,-0.002694297581911087,0.017942257225513458,-0.08864349126815796,0.24138110876083374,0.16182443499565125,0.19740481674671173,-0.2531547546386719,-0.2719406485557556,-0.26139843463897705,-0.3837759792804718,-0.0014115172671154141,-0.08618547767400742,0.236061692237854,0.15441375970840454},{0.33527177572250366,-0.32751527428627014,0.14122645556926727,-0.3770119249820709,-0.2715160548686981,0.33010241389274597,0.3829028904438019,0.17341843247413635,-0.1142285019159317,0.05371341481804848,0.1751984804868698,-0.14968547224998474,0.13504736125469208,0.29666876792907715,-0.009123625233769417,0.2143445909023285,0.38490942120552063,-0.20532435178756714,-0.032154228538274765,-0.29807111620903015,0.13661733269691467,0.23427605628967285,0.27438661456108093,0.1458236277103424,0.0696989893913269,0.09480345994234085,0.10213426500558853,0.2715200185775757,-0.18969807028770447,-0.21510054171085358,0.26435694098472595,-0.0011748280376195908},{-0.04541761055588722,-0.03721000999212265,0.2452542930841446,0.23499956727027893,-0.2020822912454605,-0.3619469106197357,-0.053494520485401154,0.2345539927482605,-0.2044646292924881,-0.3297575116157532,0.14560885727405548,0.12600871920585632,0.10192978382110596,-0.26575133204460144,0.11082562059164047,-0.1862078458070755,-0.1606065034866333,0.16779378056526184,-0.2235952466726303,0.3200409710407257,-0.24670906364917755,-0.4101635813713074,-0.30791938304901123,0.23812487721443176,0.1306246519088745,0.1326957643032074,0.26748383045196533,0.18367081880569458,-0.16018928587436676,-0.30461177229881287,-0.18891474604606628,0.13153494894504547},{0.330594003200531,-0.008979556150734425,-0.027473662048578262,0.1342821568250656,0.07592269778251648,0.263528048992157,0.025604184716939926,0.3568058907985687,-0.0450204499065876,0.09835491329431534,0.15863651037216187,0.0400044210255146,-0.24498777091503143,-0.434934139251709,0.114279605448246,0.15741033852100372,0.12322970479726791,-0.15047894418239594,-0.04540221020579338,-0.1289922147989273,0.16952583193778992,-0.35706987977027893,0.28308624029159546,0.027814628556370735,-0.08034717291593552,0.14037631452083588,-0.2873770296573639,-0.17288531363010406,0.05333540216088295,0.030875567346811295,0.15850944817066193,0.3011918067932129},{-0.12344082444906235,0.09042524546384811,-0.14258617162704468,0.16557550430297852,-0.1309458166360855,0.258181631565094,0.11480335146188736,-0.028158556669950485,0.3144712448120117,-0.28766751289367676,-0.14419735968112946,0.16466496884822845,-0.18776270747184753,0.03415511175990105,-0.31475138664245605,-0.04430817812681198,0.11097339540719986,0.156715527176857,0.039641547948122025,-0.1887664943933487,-0.21473374962806702,0.18079811334609985,0.17234572768211365,0.1902703046798706,-0.27500325441360474,0.382455050945282,-0.07206928730010986,-0.020998366177082062,-0.1180628314614296,0.12098632752895355,0.22895300388336182,0.3012758493423462},{-0.24982047080993652,0.3190068006515503,-0.03620818257331848,0.0013430742546916008,-0.22508583962917328,-0.2151450663805008,0.15053622424602509,-0.33732545375823975,-0.07440516352653503,-0.32937031984329224,-0.15366551280021667,-0.03932245820760727,0.19115959107875824,-0.21618890762329102,-0.1441318243741989,-0.29958009719848633,-0.18342043459415436,-0.03144816681742668,0.33810022473335266,-0.23857326805591583,0.11970642954111099,-0.2226797491312027,0.052781254053115845,0.2831045389175415,-0.12347555160522461,0.16945865750312805,0.22680315375328064,-0.10575982928276062,-0.03756357356905937,0.29366153478622437,-0.20002073049545288,-0.33018720149993896},{-0.02025759220123291,0.21184368431568146,0.18824730813503265,-0.2603069543838501,0.2714805603027344,0.0045506819151341915,-0.15437982976436615,-0.022647857666015625,0.17031799256801605,-0.2672426104545593,-0.0878840908408165,0.04839322343468666,0.15330538153648376,0.00461613480001688,0.05886510759592056,-0.07010314613580704,0.20363393425941467,-0.2906284034252167,0.30418524146080017,0.03634649142622948,-0.1852993220090866,0.22753466665744781,-0.13385142385959625,-0.23327133059501648,0.24288563430309296,-0.07830411195755005,0.03913556784391403,-0.11504943668842316,0.08097030222415924,-0.15373021364212036,0.3133137822151184,0.28121742606163025},{0.040971789509058,-0.2247079312801361,-0.20200985670089722,0.06454554200172424,-0.04345356300473213,0.27778133749961853,-0.12572748959064484,-0.3480553925037384,0.35386374592781067,0.046403657644987106,0.044596705585718155,0.06055906414985657,-0.09196412563323975,0.1941959112882614,-0.23471449315547943,-0.34343206882476807,0.020698312669992447,0.02707788161933422,0.14787861704826355,0.4421839714050293,-0.26126062870025635,0.17948487401008606,-0.1727784126996994,0.097805917263031,0.17210452258586884,-0.3397473096847534,-0.1476493924856186,-0.32620710134506226,-0.1758965700864792,-0.1843952089548111,0.13952171802520752,-0.4055219292640686},{-0.12106414139270782,0.3639554977416992,0.05709345266222954,-0.16326752305030823,-0.15049341320991516,-0.26723262667655945,0.11222518980503082,-0.1040424183011055,0.2833769619464874,-0.05949407443404198,0.21781806647777557,0.2367427796125412,-0.0227702297270298,0.063199482858181,-0.13623923063278198,0.16438913345336914,-0.20749643445014954,-0.4088786542415619,-0.3134823441505432,0.07800980657339096,0.14348295331001282,-0.23118428885936737,-0.37262290716171265,-0.27961528301239014,-0.13278736174106598,0.15348637104034424,0.38797280192375183,0.022967776283621788,-0.08681990951299667,0.02613399177789688,-0.08415118604898453,0.11102272570133209},{-0.25171032547950745,-0.16301961243152618,-0.19978080689907074,0.04847303405404091,-0.26260653138160706,-0.1477443277835846,-0.07188522070646286,-0.10500998795032501,-0.301788866519928,-0.26800718903541565,0.22100339829921722,0.16310974955558777,-0.2906382381916046,0.2683192193508148,-0.06653836369514465,0.15623287856578827,0.08891361206769943,0.032368917018175125,0.047217559069395065,0.14818179607391357,0.2299419343471527,0.23196642100811005,0.1209239587187767,0.2502191364765167,0.11491859704256058,-0.21111425757408142,-0.16757448017597198,0.23168745636940002,-0.047260016202926636,-0.19811736047267914,-0.1855228692293167,-0.19272984564304352},{-0.2796514630317688,-0.19278545677661896,-0.3480362594127655,0.08665145188570023,-0.10044023394584656,-0.07063133269548416,-0.10758526623249054,0.1292344033718109,-0.08500286191701889,0.0662425085902214,-0.22019551694393158,0.022761916741728783,0.15372547507286072,-0.10514183342456818,0.045672886073589325,0.2086067944765091,-0.11848871409893036,-0.14085085690021515,0.1811884343624115,0.05914648622274399,0.20126166939735413,-0.028353318572044373,-0.2116515189409256,0.04177083447575569,0.20718170702457428,-0.2539229989051819,0.14980073273181915,0.06621760874986649,0.08859463781118393,-0.15588785707950592,0.245345339179039,-0.05817924812436104},{0.25938209891319275,-0.00018547323998063803,0.02762162871658802,0.1880715787410736,-0.3290213644504547,-0.02569570206105709,0.08107461035251617,0.17965948581695557,-0.08074160665273666,-0.1429370939731598,0.2897214889526367,-0.10230737179517746,0.05461540073156357,-0.05089373514056206,-0.12448842078447342,0.274117112159729,-0.05342927947640419,-0.1332804411649704,0.11127140372991562,-0.297894150018692,-0.04040592163801193,-0.2570115029811859,-0.19301848113536835,0.22616708278656006,-0.06583235412836075,-0.05023471266031265,0.13499759137630463,0.05405541881918907,-0.15750223398208618,-0.07317271083593369,-0.024586254730820656,-0.06527119874954224},{0.2944153845310211,-0.06904441118240356,0.0790891945362091,0.04857543855905533,-0.03890903294086456,-0.1031864583492279,0.1913740485906601,-0.2499629110097885,0.26470839977264404,0.28177693486213684,0.03609999269247055,0.13867120444774628,0.24399948120117188,0.35759237408638,-0.2949378490447998,-0.3599250018596649,-0.24230286478996277,0.08489236235618591,-0.1617840677499771,-0.2785256803035736,-0.171431303024292,0.2561671733856201,0.06612583249807358,0.15677639842033386,-0.13749857246875763,-0.13287335634231567,-0.13930782675743103,-0.2492314875125885,0.23450417816638947,0.18415102362632751,-0.3340309262275696,-0.1527746021747589},{-0.10625511407852173,0.1548125147819519,0.2718256711959839,-0.03378938511013985,-0.037165574729442596,0.0661388486623764,-0.028860554099082947,-0.33125394582748413,0.20404750108718872,0.24672283232212067,0.15352067351341248,0.2317771315574646,-0.21828877925872803,0.20466992259025574,-0.2648715376853943,0.2992616593837738,0.16425755620002747,-0.26613649725914,0.237845316529274,0.09100721776485443,-0.36108341813087463,0.32965388894081116,-0.25340619683265686,0.15410096943378448,0.2261701375246048,0.2660652995109558,0.0614105761051178,0.13528317213058472,-0.17860795557498932,0.2246866673231125,-0.040477633476257324,0.10077959299087524},{-0.1189660057425499,-0.10709138959646225,-0.0013236288214102387,0.18190345168113708,0.02783026359975338,0.2132878601551056,-0.2736223638057709,-0.10321822762489319,-0.12712208926677704,-0.07313117384910583,-0.15327247977256775,-0.17788861691951752,0.014930649660527706,-0.20037589967250824,0.0892040953040123,-0.20698483288288116,0.24762016534805298,-0.03556488826870918,-0.3220932185649872,-0.2930038869380951,0.12545007467269897,0.1679355353116989,-0.17230579257011414,0.30419668555259705,-0.255803644657135,0.060881003737449646,0.1110236644744873,-0.08935888111591339,0.16268454492092133,-0.21809566020965576,0.3119116723537445,0.14779530465602875},{0.31613022089004517,0.04329519718885422,0.08186651766300201,0.2091280221939087,-0.22581861913204193,0.1745510697364807,-0.0824170634150505,0.16073130071163177,0.10918715596199036,0.041466258466243744,0.09117601066827774,-0.32826167345046997,-0.2519727051258087,0.035927604883909225,0.08899091184139252,-0.07309427112340927,0.26761874556541443,0.14885026216506958,-0.18338775634765625,-0.2175145298242569,0.32440218329429626,0.19494399428367615,0.25023189187049866,0.09637296199798584,-0.024992741644382477,0.04742076247930527,-0.06177543103694916,-0.16653689742088318,0.2733544409275055,0.03739190846681595,-0.18667741119861603,0.11535521596670151},{-0.016470802947878838,0.018248921260237694,-0.043027862906455994,-0.2568430006504059,-0.0888105034828186,-0.2203642874956131,-0.2175854593515396,-0.13617515563964844,-0.02478557825088501,-0.01718389056622982,-0.2668817937374115,0.016165031120181084,-0.23404400050640106,-0.16690896451473236,0.005199034698307514,0.09652652591466904,0.27003222703933716,-0.17375491559505463,-0.32326769828796387,0.2656845450401306,-0.18338944017887115,0.27365320920944214,0.02489531598985195,-0.03402229771018028,0.02372288890182972,0.1588728129863739,-0.07931013405323029,-0.26459404826164246,0.22491911053657532,0.25371047854423523,-0.11717584729194641,0.18415413796901703},{-0.23702555894851685,-0.03442857041954994,0.044830333441495895,-0.028366439044475555,0.10411662608385086,0.13970258831977844,-0.1904708594083786,0.11838414520025253,-0.16663885116577148,-0.14518581330776215,0.08245877921581268,-0.1380356252193451,-0.19048146903514862,0.24553833901882172,0.020142657682299614,0.037918444722890854,0.18949422240257263,-0.24890008568763733,-0.16325843334197998,0.2877080738544464,0.02842881716787815,0.25208142399787903,-0.053570400923490524,0.022359412163496017,-0.2734520435333252,-0.18777264654636383,0.004588281735777855,0.29054486751556396,-0.006554517894983292,0.015525845810770988,0.28248992562294006,0.30805256962776184}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.090895876288414,0.1971370428800583,0.4023471176624298,-0.04065274819731712},{0.10890024155378342,-0.10641267150640488,0.0616237074136734,0.2157510221004486},{-0.15838688611984253,0.2034451961517334,0.13653166592121124,0.1343483179807663},{0.3248772621154785,0.011778216809034348,0.047964517027139664,0.4442119896411896},{-0.12933409214019775,0.09373351186513901,0.3438633382320404,-0.054551053792238235},{-0.10910838097333908,0.23667803406715393,0.2587311863899231,-0.13184958696365356},{-0.29352298378944397,-0.006962748244404793,0.01664838381111622,-0.1119709312915802},{-0.40557751059532166,-0.16109119355678558,0.4157155156135559,-0.3034154176712036},{0.35593169927597046,-0.1631740778684616,-0.29724568128585815,-0.4095117449760437},{0.05904369056224823,0.31817376613616943,0.35950547456741333,-0.4715224802494049},{-0.17421816289424896,-0.17179609835147858,-0.21059484779834747,0.2006448656320572},{0.3581305146217346,-0.21238307654857635,-0.02347201481461525,0.22097072005271912},{0.32051876187324524,0.2895961403846741,-0.07170917838811874,0.12045171856880188},{0.032782696187496185,0.11554233729839325,-0.3243984580039978,0.007839092053472996},{0.09990930557250977,0.2905680537223816,0.4142422080039978,0.3399549126625061},{0.1742955893278122,0.02889828570187092,0.3260023593902588,0.26247334480285645},{-0.245797261595726,-0.09508240967988968,-0.10602173954248428,-0.2728405296802521},{-0.22329790890216827,0.13758666813373566,-0.18554924428462982,-0.1211966797709465},{-0.20250457525253296,0.2123854011297226,0.17344050109386444,0.33759528398513794},{-0.040443193167448044,0.35207879543304443,-0.20714281499385834,0.08327875286340714},{-0.28089216351509094,-0.3941238522529602,-0.11486551910638809,0.030382229015231133},{0.3735765218734741,0.4851883053779602,0.04054697975516319,-0.31968337297439575},{-0.046226900070905685,0.19220057129859924,0.22654375433921814,0.17209433019161224},{-0.11188755929470062,0.38858407735824585,-0.0770576149225235,-0.15854883193969727},{0.05269012972712517,-0.037513479590415955,-0.10443330556154251,0.024633711203932762},{0.29136133193969727,-0.4628605246543884,-0.007125206757336855,0.03914761170744896},{0.004732918925583363,-0.360810786485672,-0.21062038838863373,-0.2220873236656189},{0.12864412367343903,-0.14157287776470184,0.23210108280181885,0.19325388967990875},{0.006989349145442247,-0.06081916391849518,0.1030634269118309,0.036270417273044586},{-0.37708228826522827,0.3739319443702698,0.23903793096542358,-0.07934534549713135},{0.3439050316810608,-0.1562291979789734,0.22555942833423615,-0.07901681214570999},{0.06335801631212234,-0.40768903493881226,0.43531563878059387,-0.3336617350578308}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.059812162071466446,-0.034025199711322784,0.027851905673742294,-0.0331372432410717,-0.036352504044771194,-0.13985534012317657,-0.048844415694475174,0.05939497426152229,0.03271466866135597,-0.052635908126831055,0.10149938613176346,0.062287621200084686,-0.045865245163440704,-0.09099171310663223,0.08516344428062439,-0.05190695449709892};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0640621930360794,0.051381733268499374,0.031597498804330826,0.023182649165391922,0.06433723866939545,0.0025403262116014957,0.06782447546720505,-0.01736040785908699,-0.0057687899097800255,0.012103432789444923,-0.02706794999539852,-0.036795780062675476,0.07100915163755417,-0.03130769357085228,-0.031374525278806686,-0.03210604935884476};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07159683853387833,0.06657104194164276,0.018978679552674294,0.06714854389429092,0.04714512079954147,-0.01782921515405178,-0.03892522677779198,-0.016983304172754288,-0.03020039200782776,0.003193488111719489,-0.04555130377411842,0.04974590986967087,0.05738336220383644,-0.0688631683588028,0.0762549340724945,0.07228647917509079,-0.06766021251678467,-0.06279785931110382,0.017353631556034088,0.011763659305870533,-0.03400133177638054,0.0034694932401180267,0.061884138733148575,0.00044768862426280975,-0.025335580110549927,0.010916202329099178,-0.0424908846616745,0.054611969739198685,0.04225686192512512,0.005838089156895876,0.03311457484960556,0.044067852199077606};
static const float action_parameterization_distribution_linear_bias[4] = {0.03913658857345581,0.003789370646700263,0.053271956741809845,0.04961324855685234};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.025668583810329437,0.2722090780735016,-0.11071112751960754,0.15939074754714966,0.24724701046943665,0.15264606475830078,0.29340460896492004,0.014165385626256466},{-0.17743352055549622,-0.06542377173900604,-0.2495465874671936,-0.2776636779308319,-0.2846093475818634,-0.1506510078907013,-0.14314569532871246,-0.16157232224941254},{-0.23612046241760254,0.025835070759058,0.2603418827056885,0.20620876550674438,0.251527339220047,-0.0013518299674615264,0.2244100719690323,-0.08185334503650665},{0.04180693253874779,0.09836924821138382,-0.15087828040122986,-0.04338851571083069,-0.01814533770084381,-0.03424243628978729,0.234793558716774,-0.1707073599100113},{-0.2379501909017563,-0.1276904195547104,-0.22061540186405182,-0.15274564921855927,-0.0447736531496048,0.1708122342824936,0.141214057803154,-0.020831124857068062},{-0.2489050328731537,0.025190336629748344,0.3873780071735382,0.23715323209762573,0.19259227812290192,-0.11387508362531662,-0.13260243833065033,-0.12787723541259766},{-0.186733677983284,0.07902882993221283,0.375771701335907,-0.23047664761543274,-0.09427592158317566,-0.41038602590560913,-0.1025787964463234,-0.14197055995464325},{-0.4009723961353302,-0.365316241979599,0.5133384466171265,-0.07485547661781311,-0.23441597819328308,0.15337146818637848,0.1343294084072113,-0.185044527053833},{-0.32218998670578003,0.23133964836597443,-0.18898682296276093,0.41579607129096985,0.058110009878873825,-0.3985707759857178,0.06812841445207596,0.11853347718715668},{-0.3064645230770111,-0.33465439081192017,-0.15475331246852875,-0.1612386256456375,-0.5443412065505981,0.04777903109788895,-0.021527379751205444,0.1344313770532608},{0.16714510321617126,0.3311441242694855,0.19717669486999512,0.007625563070178032,0.15327253937721252,0.04984225705265999,-0.24160829186439514,0.20569971203804016},{0.22419549524784088,0.0062133255414664745,0.261829674243927,0.25400152802467346,-0.26121068000793457,0.27486878633499146,-0.014751594513654709,-0.23799821734428406},{0.14225982129573822,-0.267132043838501,0.24620430171489716,-0.04488470405340195,-0.2530214190483093,-0.05495724454522133,-0.15552185475826263,-0.15702541172504425},{-0.18169830739498138,-0.12600256502628326,0.31956779956817627,0.37931209802627563,-0.13486497104167938,-0.0469987727701664,-0.26741695404052734,0.16158714890480042},{0.03603433445096016,-0.13226336240768433,0.0866878405213356,-0.19427157938480377,-0.33778947591781616,-0.1264551877975464,0.24668355286121368,-0.01272999681532383},{0.12656579911708832,-0.05133118852972984,-0.03682764247059822,-0.29557788372039795,-0.10465226322412491,0.06497436761856079,-0.023737134411931038,0.4090656042098999},{-0.04784156382083893,-0.20752158761024475,-0.1834859699010849,0.04403304308652878,-0.14814475178718567,-0.1450508087873459,-0.114143967628479,0.07757002860307693},{-0.2211986929178238,-0.265979528427124,0.07695303112268448,0.017743369564414024,0.15956845879554749,-0.23727728426456451,0.37108099460601807,0.136227086186409},{0.006484854035079479,0.13097327947616577,-0.21537843346595764,0.07247354835271835,0.14414286613464355,0.1347448229789734,-0.18482866883277893,0.28983399271965027},{0.14657646417617798,-0.07090012729167938,-0.3545415997505188,0.057020802050828934,-0.06153484806418419,-0.10095442086458206,-0.2985837459564209,0.0030221552588045597},{0.03539208322763443,-0.16675646603107452,0.04299308359622955,-0.12671548128128052,0.24908021092414856,-0.058379076421260834,-0.0641048476099968,0.4486607611179352},{-0.0017695041606202722,0.10467851907014847,-0.30238133668899536,0.21082040667533875,0.2572075426578522,0.2734742760658264,0.12747931480407715,-0.2668185532093048},{-0.4032009243965149,-0.1155766174197197,0.11226996034383774,-0.09691574424505234,0.1625564694404602,-0.3487766981124878,0.15485230088233948,-0.2309657633304596},{-0.1230277270078659,0.09701211750507355,-0.0762476846575737,-0.4411690831184387,0.2354755848646164,0.005132373888045549,-0.3556322157382965,0.19323544204235077},{-0.17775858938694,-0.16645945608615875,-0.06166795641183853,0.04409681260585785,0.0566268227994442,0.24968476593494415,0.27742692828178406,-0.055783119052648544},{-0.19538061320781708,0.0765860378742218,-0.31755030155181885,-0.27557528018951416,0.13509255647659302,-0.0017443799879401922,-0.08500301092863083,0.08277773857116699},{0.3019025921821594,0.38125330209732056,-0.21382339298725128,0.22224348783493042,0.10774984955787659,0.282921701669693,-0.28787022829055786,-0.15410785377025604},{0.38340914249420166,0.23821285367012024,0.13488425314426422,0.09591783583164215,0.1978238970041275,0.05874329060316086,0.23646841943264008,0.36846014857292175},{-0.1230277270078659,0.3795138895511627,0.20252031087875366,0.060228269547224045,0.21693971753120422,-0.010959884151816368,-0.39003586769104004,-0.2833690643310547},{-0.13974077999591827,-0.23001262545585632,0.06730039417743683,-0.15772931277751923,-0.28110718727111816,-0.20902720093727112,0.24238842725753784,-0.014880144037306309},{0.4511881172657013,-0.28231680393218994,0.29651740193367004,-0.24600693583488464,0.10396556556224823,0.25670722126960754,0.10493509471416473,-0.15630671381950378},{0.2705053687095642,0.3959278464317322,0.3905501365661621,-0.21942675113677979,-0.16317477822303772,0.11985895782709122,0.22459889948368073,0.07691988348960876}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.003976481966674328,0.3904828727245331,-0.1726813167333603,0.2514386773109436,-0.38946688175201416,0.2552485466003418,0.4559265375137329,0.07282710820436478},{-0.43028512597084045,-0.4794100522994995,-0.3698281943798065,-0.4293976128101349,-0.4246189594268799,0.40421050786972046,0.45854324102401733,-0.4007660746574402},{-0.02421416901051998,-0.15513207018375397,0.11025819927453995,0.02534112147986889,-0.08730629086494446,0.4298635721206665,-0.3233579099178314,-0.33997368812561035},{0.46205365657806396,0.020704809576272964,0.07455983757972717,-0.013951108790934086,0.5466550588607788,0.3649829924106598,0.3661687672138214,0.42562630772590637},{0.09800995141267776,0.23815485835075378,-0.15628638863563538,-0.08366866409778595,0.12283289432525635,-0.334588885307312,-0.37426644563674927,0.47022929787635803},{0.39555448293685913,0.09148797392845154,0.03711440786719322,-0.36498787999153137,-0.4241432845592499,-0.47674888372421265,-0.10342288017272949,0.5022608041763306},{-0.4257368743419647,-0.33815908432006836,-0.024288680404424667,-0.21915610134601593,0.03446972742676735,0.3872739374637604,-0.5138986110687256,0.5971838235855103},{0.20873712003231049,0.07227180898189545,0.009498806670308113,-0.03743908554315567,0.37852713465690613,-0.5210797786712646,0.4195097088813782,-0.4284118115901947}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07228930294513702,0.040236715227365494,0.07859551906585693,-0.023473700508475304,-0.03913408890366554,-0.02244436740875244,0.0725901871919632,-0.02742171660065651};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.033209748566150665,-0.03743743523955345,0.026891911402344704,-0.10867608338594437,-0.0002527016040403396,-0.0011895018396899104,-0.008930148556828499,-0.06274372339248657};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

