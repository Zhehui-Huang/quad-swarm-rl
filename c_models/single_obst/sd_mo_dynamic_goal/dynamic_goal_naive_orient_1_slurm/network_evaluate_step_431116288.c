#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3165440261363983,0.059130895882844925,0.024823255836963654,0.24937264621257782,0.3567984104156494,-0.23794108629226685,-0.28792181611061096,0.12839938700199127,0.3691377639770508,-0.2884575426578522,0.4595726430416107,0.07063773274421692,0.25959452986717224,0.1138283908367157,-0.3045895993709564,0.01587233878672123},{-0.31586727499961853,-0.19623935222625732,-0.2937188148498535,-0.09634212404489517,0.18855366110801697,0.37594670057296753,0.1700008511543274,0.0019125582184642553,0.14702638983726501,0.23177072405815125,-0.11627764254808426,0.00026070550666190684,-0.08633912354707718,0.11469846963882446,0.27391496300697327,-0.22957554459571838},{0.0007568526198156178,0.253152072429657,0.22421705722808838,0.2853392958641052,0.059604108333587646,-0.2514289617538452,0.7796545028686523,-0.22685576975345612,-0.17769776284694672,0.0382600799202919,-0.027751078829169273,-0.2188229113817215,0.30027443170547485,0.6033487319946289,-0.4831831753253937,0.15131323039531708},{0.16965237259864807,-0.1491384506225586,-0.14826644957065582,-0.03514756262302399,-0.20095674693584442,0.07712008059024811,-0.04918153956532478,-0.21249651908874512,-0.0011393566383048892,-0.14362986385822296,0.6036546230316162,-0.22117529809474945,-0.3514331579208374,-0.20503322780132294,0.22906355559825897,-0.06694290041923523},{-0.21713820099830627,-0.004834439139813185,0.2066197544336319,-0.4580453336238861,0.5006202459335327,0.23038408160209656,0.239939883351326,-0.1955333948135376,-0.20290744304656982,0.27174636721611023,-0.06656868010759354,-0.4530390501022339,0.016869619488716125,-0.22172267735004425,0.47218337655067444,-0.03558707982301712},{-0.01685909554362297,-0.12750820815563202,-0.06519565731287003,-0.0686132088303566,0.09292314946651459,-0.2439698874950409,0.5895169973373413,-0.28654593229293823,-0.2202351987361908,-0.20441749691963196,0.17692092061042786,0.07068558782339096,0.3348442614078522,0.037974897772073746,0.312360018491745,0.2450881004333496},{-0.18189123272895813,0.2540821433067322,-0.03489953279495239,0.08823960274457932,-0.29363012313842773,-0.11672237515449524,-0.10119002312421799,0.0092881815508008,0.33976998925209045,0.3341405689716339,-0.273038387298584,-0.1399255245923996,0.2771841287612915,-0.024883104488253593,-0.11696188896894455,0.26715943217277527},{-0.3405236303806305,0.16996490955352783,0.027726933360099792,-0.30009201169013977,0.405030757188797,-0.2631417214870453,-0.2973254323005676,-0.48800382018089294,-0.08076264709234238,-0.21740487217903137,0.564172625541687,0.1307404786348343,0.03950467333197594,0.4495246708393097,0.04127541556954384,0.6086942553520203},{0.2762780785560608,0.12402350455522537,-0.19043922424316406,0.04437960684299469,-0.5910106301307678,-0.5826127529144287,0.17776666581630707,-0.6040313839912415,-0.054004915058612823,-0.15557360649108887,0.31319111585617065,-0.5817267894744873,-0.5352944135665894,0.13368991017341614,0.05890735611319542,-0.2829033434391022},{0.6425385475158691,-0.7989919781684875,-0.3652157783508301,0.13208645582199097,0.17116856575012207,-0.3341074585914612,-0.04516761749982834,-0.2189132273197174,-0.3696439266204834,-0.021804088726639748,-0.303462952375412,-0.33138158917427063,0.6081856489181519,-0.3029596209526062,-0.7393884658813477,-0.2595211863517761},{0.2860957384109497,0.33034658432006836,-0.14688989520072937,0.09190859645605087,0.05190004035830498,-0.20880374312400818,-0.15598280727863312,0.13347755372524261,-0.047123983502388,0.23489688336849213,0.22204804420471191,0.22117963433265686,-0.12200106680393219,0.20948106050491333,0.012028902769088745,-0.3230893611907959},{-0.41572242975234985,0.25773555040359497,0.5546075701713562,-0.8129469752311707,0.06969452649354935,0.11212073266506195,0.15813784301280975,0.3108102083206177,0.35538968443870544,0.4289793074131012,0.4478965401649475,-0.3493691384792328,0.3127567172050476,-0.23018237948417664,0.04769518971443176,-0.21745912730693817},{0.1705283373594284,-0.28121158480644226,-0.24995526671409607,0.3543001711368561,-0.2242584228515625,-0.27801942825317383,-0.06683487445116043,0.3668424189090729,0.2195778489112854,-0.11118218302726746,-0.3115149438381195,0.29742494225502014,0.4267864525318146,0.28307533264160156,-0.1765686720609665,0.6053547263145447},{0.2729133367538452,0.2609153389930725,-0.3321162462234497,0.10006126761436462,-0.0646248310804367,-0.1292354315519333,-0.24012255668640137,0.16250351071357727,-0.3124324381351471,-0.3667546510696411,-0.07808176428079605,0.06799616664648056,-0.5779434442520142,-0.08354530483484268,-0.27582070231437683,-0.17202529311180115},{0.14974389970302582,0.5815187096595764,0.45922744274139404,-0.4395972788333893,-0.30790284276008606,0.2737412750720978,-0.07011418044567108,0.0687650516629219,0.5023438930511475,0.35740604996681213,-0.2131265550851822,0.13223031163215637,-0.15251709520816803,-0.3308689296245575,0.17601284384727478,-0.3426367938518524},{-0.33948272466659546,-0.06472644954919815,-0.03341459855437279,0.23149444162845612,-0.02693989686667919,0.04510306939482689,-0.15703803300857544,-0.0633513554930687,-0.36998507380485535,-0.07862522453069687,0.2732835114002228,0.10516734421253204,-0.19361628592014313,-0.22247831523418427,-0.395061731338501,-0.11105857789516449},{-0.2926284074783325,0.14547744393348694,-0.23460343480110168,0.0007144581177271903,-0.1273556798696518,0.3356204330921173,0.3406546711921692,0.15111228823661804,0.2406052052974701,-0.21846792101860046,-0.06572620570659637,-0.12448860704898834,-0.015337066724896431,0.050210580229759216,-0.006187697406858206,-0.15068379044532776},{0.14364612102508545,-0.4923098385334015,0.1394575983285904,0.20269806683063507,0.002299890387803316,0.2809087038040161,0.3199959993362427,0.16649115085601807,-0.15052899718284607,-0.27645790576934814,-0.12806916236877441,-0.09019865840673447,-0.11419440805912018,-0.3811008930206299,0.06389018893241882,0.00595582090318203}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.15322719514369965,0.3096953332424164,0.36165910959243774,-0.09235422313213348,-0.21039371192455292,0.07298272848129272,0.07068096101284027,0.25671136379241943,-0.04143492132425308,0.27803468704223633,0.496675044298172,-0.35923126339912415,-0.11787796765565872,0.07314793020486832,0.03364080563187599,-0.03604918345808983},{-0.5607454776763916,0.21070823073387146,-0.3149329721927643,0.2445259690284729,0.3555311858654022,-0.15178406238555908,-0.35747405886650085,-0.27070152759552,0.3102070689201355,0.3079850673675537,-0.0919659435749054,0.24699895083904266,-0.33862748742103577,0.1534963697195053,-0.26104864478111267,0.45470598340034485},{-0.4081076979637146,0.19598554074764252,-0.3815402090549469,0.029193783178925514,-0.4051811695098877,-0.29814425110816956,-0.11023169755935669,0.012946635484695435,-0.23654994368553162,0.3525390923023224,0.21679608523845673,-0.07316156476736069,0.2397536039352417,-0.34664085507392883,-0.06161891669034958,0.0014179132413119078},{0.2530043423175812,-0.22930274903774261,0.08213464915752411,0.44903475046157837,-0.4454170763492584,-0.36123448610305786,0.2741529643535614,0.11572541296482086,0.2922274172306061,-0.09894432872533798,0.3204866945743561,0.11217152327299118,-0.27037861943244934,-0.018248507753014565,-0.020890923216938972,-0.35795843601226807},{-0.38503649830818176,0.020206313580274582,0.24889354407787323,-0.37185871601104736,0.1645575314760208,0.3226890563964844,-0.334970086812973,0.22894342243671417,-0.2147097885608673,0.1970219761133194,-0.13178586959838867,-0.0036982656456530094,-0.14071862399578094,-0.022087521851062775,-0.19341152906417847,-0.19422496855258942},{0.017768369987607002,-0.21983948349952698,-0.022135572507977486,-0.35038867592811584,0.29402807354927063,0.08992569893598557,-0.024056660011410713,-0.07901319116353989,-0.217657670378685,0.37397652864456177,0.2909832000732422,-0.09470738470554352,-0.15754906833171844,0.2316615879535675,-0.07431042939424515,-0.3601032495498657},{0.23860785365104675,-0.13328607380390167,0.32277268171310425,-0.30021098256111145,-0.3754188120365143,-0.04003987833857536,-0.3707022964954376,0.35546526312828064,-0.11354120075702667,-0.23427166044712067,-0.26639503240585327,-0.05044938251376152,-0.022739319130778313,-0.09243430942296982,0.46175479888916016,-0.37984681129455566},{-0.2789742648601532,0.3964734673500061,-0.05922500044107437,0.27284201979637146,0.01564207300543785,-0.2389104962348938,-0.08644437044858932,0.12052209675312042,-0.04159510135650635,0.4888363778591156,0.17056071758270264,-0.2236015647649765,0.025780584663152695,-0.08060537278652191,0.047777749598026276,0.16179654002189636},{0.12913872301578522,0.29343488812446594,-0.1632644236087799,-0.33744582533836365,0.38064828515052795,-0.19902248680591583,0.23442886769771576,-0.35496363043785095,0.10543831437826157,0.03555211424827576,0.1317666471004486,0.10851513594388962,-0.024311648681759834,-0.2857515513896942,-0.09105947613716125,0.22035247087478638},{-0.22120200097560883,-0.006971744820475578,-0.29413318634033203,-0.33386945724487305,0.23562321066856384,-0.46139341592788696,-0.2036064714193344,0.2593080699443817,-0.13333645462989807,0.20065277814865112,-0.028039440512657166,-0.07645683735609055,-0.3614441752433777,-0.004583147354424,-0.23436380922794342,-0.34257951378822327},{-0.2656887471675873,-0.11756446212530136,-0.09945736825466156,-0.35560011863708496,-0.3298664391040802,-0.00896220002323389,0.11267931759357452,-0.49498000741004944,0.01879078522324562,-0.056505341082811356,0.16472351551055908,0.014336676336824894,0.4165095090866089,0.03133818507194519,0.23248176276683807,0.23560567200183868},{-0.20378659665584564,-0.06024068966507912,-0.4426218569278717,0.3668951392173767,0.13611704111099243,-0.016860483214259148,0.16717247664928436,0.09645462781190872,-0.4160619080066681,0.21888130903244019,-0.3439359664916992,-0.1566164791584015,-0.390210896730423,0.4117473065853119,-0.3562670350074768,0.07567994296550751},{-0.1589466631412506,-0.44452691078186035,-0.1097625344991684,0.16647206246852875,-0.18435083329677582,-0.10511274635791779,-0.087575264275074,0.40024101734161377,0.4309355914592743,0.09636826068162918,-0.08945439010858536,-0.26753783226013184,0.1650020182132721,-0.3750224709510803,0.14550194144248962,-0.22630760073661804},{-0.2724372148513794,-0.46736717224121094,-0.17879439890384674,-0.11076492071151733,-0.46522635221481323,0.37743696570396423,-0.08342060446739197,0.19995485246181488,-0.18380869925022125,-0.33005720376968384,-0.3175643980503082,0.4128238558769226,-0.21008838713169098,0.06643681973218918,-0.2718331217765808,0.3845939338207245},{-0.33161911368370056,0.350150465965271,-0.15828152000904083,0.11343269050121307,-0.36891064047813416,0.23141339421272278,0.05424034222960472,-0.37801462411880493,0.11939390748739243,0.18624824285507202,-0.16396871209144592,0.06446859240531921,0.29689639806747437,-0.24771058559417725,-0.3420419991016388,-0.16857942938804626},{-0.15213742852210999,-0.36094629764556885,-0.5253239274024963,0.30598366260528564,0.03770028054714203,0.14559556543827057,-0.2530115246772766,0.1981755644083023,-0.42170941829681396,-0.3221578001976013,-0.39099419116973877,0.24201887845993042,-0.23856528103351593,0.1963978260755539,0.09880325943231583,0.31939786672592163}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.058673642575740814,-0.12706506252288818,0.11321291327476501,-0.12767811119556427,-0.09091340005397797,0.11920124292373657,0.16961278021335602,-0.24427728354930878,-0.1254461109638214,0.31685346364974976,0.0644083097577095,0.13188914954662323,0.10545585304498672,0.1437395066022873,-0.19072486460208893,0.13670960068702698,0.12012287229299545,-0.2961673140525818,-0.2605020999908447,-0.07898438721895218,-0.19543878734111786,0.14143912494182587,-0.21628303825855255,0.3713504672050476,-0.18394826352596283,-0.03496920317411423,0.12248338013887405,0.16772401332855225,-0.25728926062583923,-0.1980041116476059,0.25393596291542053,0.27714279294013977},{0.16488827764987946,-0.05254758894443512,0.15846823155879974,-0.07683303207159042,-0.10276976227760315,0.2207350730895996,-0.0059117903001606464,-0.08304031193256378,-0.02180403284728527,-0.047637343406677246,-0.1152660921216011,0.02472641132771969,0.4020051062107086,0.21812015771865845,0.1227739006280899,0.0468510240316391,-0.25637415051460266,-0.2827777564525604,0.09921952337026596,0.0471753254532814,0.064564049243927,0.3009158670902252,0.27017614245414734,-0.16101817786693573,0.04888579621911049,0.2944889962673187,-0.35600578784942627,0.20299018919467926,0.09600593149662018,-0.25147441029548645,-0.06655830889940262,-0.026217715814709663},{-0.0856689065694809,-0.05657656863331795,0.16492846608161926,-0.1582344025373459,-0.1876927614212036,0.018939299508929253,-0.2577851116657257,0.1696976274251938,0.2499363273382187,-0.006539918016642332,-0.2060752958059311,0.08700046688318253,0.35706162452697754,-0.2290998101234436,0.08157046139240265,-0.04931577667593956,-0.3850424885749817,0.23157177865505219,-0.3733871579170227,-0.05232633650302887,-0.05292171239852905,-0.08482766151428223,-0.07806719094514847,-0.06661000102758408,-0.009389519691467285,0.3992818593978882,-0.05018188804388046,0.09616795182228088,0.2750006318092346,-0.38842299580574036,-0.0934036374092102,0.006511779502034187},{0.17237208783626556,-0.2389332801103592,0.017436165362596512,-0.3843464255332947,0.09744838625192642,-0.09945202618837357,-0.061031702905893326,0.2020755410194397,0.053254641592502594,0.2419913411140442,0.02323087677359581,-0.13996024429798126,-0.2042972594499588,-0.05274012312293053,0.25550442934036255,-0.21809262037277222,0.04569041356444359,-0.06717579066753387,-0.14953558146953583,0.12216435372829437,-0.17926831543445587,0.16654148697853088,-0.24044843018054962,0.31042057275772095,-0.2790612578392029,0.02829436957836151,-0.07603693753480911,-0.23698130249977112,0.023839104920625687,0.03722483292222023,0.2245636284351349,-0.14882737398147583},{0.27381372451782227,-0.04382101073861122,0.027849525213241577,0.26002389192581177,-0.2770436406135559,-0.08129748702049255,0.1754292994737625,-0.01538032665848732,0.10985126346349716,-0.17175430059432983,-0.001418244675733149,-0.08251260221004486,-0.19641150534152985,-0.1451977640390396,0.30120018124580383,0.25573331117630005,-0.043420933187007904,-0.32841238379478455,0.13021907210350037,-0.1245395839214325,-0.1349036544561386,0.23128977417945862,0.2630247175693512,0.023326268419623375,-0.11022290587425232,-0.10495264828205109,0.02241780050098896,0.2503928244113922,0.24191322922706604,0.09673434495925903,0.1343882977962494,-0.22592315077781677},{0.30279725790023804,-0.14827217161655426,0.022593390196561813,0.09194128215312958,-0.13088512420654297,-0.31607145071029663,-0.23160965740680695,-0.31072330474853516,-0.18733759224414825,0.028745897114276886,-0.036939796060323715,0.00847162026911974,-0.07814681529998779,-0.07109477370977402,-0.1952228546142578,-0.26648086309432983,0.1585032343864441,0.012754346244037151,-0.3224865198135376,0.21645885705947876,-0.08810579031705856,-0.18837831914424896,0.2017497420310974,-0.1458050161600113,-0.16280746459960938,-0.2302732765674591,-0.12242766469717026,0.08831626176834106,0.10525669902563095,0.23965226113796234,-0.27233758568763733,0.18018780648708344},{0.17939643561840057,0.07275208830833435,0.22374983131885529,-0.15369871258735657,0.23672392964363098,-0.20311473309993744,-0.3072313666343689,-0.019474761560559273,0.29495003819465637,0.13275843858718872,-0.1672930270433426,0.12920551002025604,0.07433678954839706,0.31073835492134094,0.10167443752288818,-0.050871338695287704,-0.21543864905834198,0.11761296540498734,-0.016823533922433853,-0.04496946185827255,-0.08902154862880707,0.22421614825725555,0.17560172080993652,0.13526776432991028,-0.28073346614837646,-0.21524132788181305,-0.2646538317203522,-0.33639925718307495,0.07046359032392502,-0.12977609038352966,0.31495359539985657,0.15581099689006805},{0.3245534598827362,-0.3847227394580841,0.06642267107963562,-0.43547046184539795,-0.31247827410697937,0.3096902668476105,0.41412484645843506,0.2029104232788086,-0.056471411138772964,0.1135462075471878,0.16434185206890106,-0.1485450565814972,0.06393991410732269,0.2860633432865143,-0.044297147542238235,0.1935034692287445,0.4130747318267822,-0.2555010914802551,-0.08102435618638992,-0.3800228238105774,0.19263404607772827,0.24145449697971344,0.18967702984809875,0.14654675126075745,0.13341578841209412,0.11181219667196274,0.16868384182453156,0.27118369936943054,-0.12858347594738007,-0.26972928643226624,0.24382531642913818,0.070189468562603},{0.048337168991565704,-0.08659777045249939,0.20242176949977875,0.27096614241600037,-0.22067862749099731,-0.32663777470588684,-0.0912603959441185,0.2268349826335907,-0.1843741536140442,-0.20812693238258362,0.029601911082863808,0.13320815563201904,0.1431105136871338,-0.3060217499732971,0.14605963230133057,-0.17066244781017303,-0.21524758636951447,0.15330778062343597,-0.285773903131485,0.2663218677043915,-0.34652984142303467,-0.2965155839920044,-0.3209245502948761,0.2358844131231308,0.09895503520965576,0.10218063741922379,0.32669350504875183,0.21046309173107147,-0.16012856364250183,-0.34625473618507385,-0.13455353677272797,0.1740594059228897},{0.3417612612247467,0.0505899041891098,0.033222489058971405,0.23789168894290924,0.05662626400589943,0.25149092078208923,-0.06394004076719284,0.23690469563007355,-0.06727544963359833,0.04039998725056648,0.15108869969844818,0.11498032510280609,-0.08726626634597778,-0.3410586714744568,0.20145544409751892,0.21188752353191376,-0.005630004219710827,-0.1641043871641159,-0.0023072578478604555,0.011272341944277287,0.07883026450872421,-0.3144696354866028,0.3831309378147125,0.03635403513908386,-0.06251354515552521,0.11449158191680908,-0.3875674605369568,-0.16323760151863098,0.028085948899388313,0.018580362200737,0.10646338015794754,0.22084294259548187},{-0.09300203621387482,0.08513372391462326,-0.07959090173244476,0.19869635999202728,-0.09067532420158386,0.29589152336120605,0.07655065506696701,-0.10108824074268341,0.28259626030921936,-0.3102116286754608,-0.1697520613670349,0.16861048340797424,-0.08450324833393097,0.07866625487804413,-0.30510351061820984,0.033988457173109055,0.056676801294088364,0.1599094718694687,0.07658688724040985,-0.12115494161844254,-0.2694067358970642,0.18457983434200287,0.24312885105609894,0.2308531105518341,-0.32771965861320496,0.34860748052597046,-0.15551504492759705,-0.000849243369884789,-0.12336733192205429,0.12877485156059265,0.20878128707408905,0.24701213836669922},{-0.21019858121871948,0.27872082591056824,-0.07663511484861374,-0.018681183457374573,-0.2363300323486328,-0.16514837741851807,0.16832469403743744,-0.2886601686477661,-0.031867865473032,-0.24375462532043457,-0.2078462839126587,-0.08258942514657974,0.1714305877685547,-0.26686662435531616,-0.1145053580403328,-0.3828856348991394,-0.14542962610721588,-0.0012302752584218979,0.29517295956611633,-0.2750152051448822,0.06896592676639557,-0.1512203812599182,0.015250836499035358,0.29114189743995667,-0.12978819012641907,0.13584506511688232,0.2813399136066437,-0.13391093909740448,-0.07969173789024353,0.30142006278038025,-0.19774968922138214,-0.31355151534080505},{-0.0453985258936882,0.2541888952255249,0.2506874203681946,-0.3215148150920868,0.3128913938999176,0.024431481957435608,-0.11900381743907928,-0.000775923312176019,0.12518815696239471,-0.2993367910385132,-0.0458596907556057,0.040064238011837006,0.20525595545768738,0.02085622027516365,0.014644338749349117,-0.01810947246849537,0.2199012190103531,-0.30952131748199463,0.32963624596595764,0.058616623282432556,-0.16734568774700165,0.1792074739933014,-0.09020807594060898,-0.23883156478405,0.24099957942962646,-0.07595111429691315,-0.010115671902894974,-0.10051534324884415,0.06075861677527428,-0.12389743328094482,0.31434571743011475,0.2865275740623474},{0.08062838762998581,-0.21109245717525482,-0.18663008511066437,0.07976899296045303,0.06346140801906586,0.2810432016849518,-0.10469849407672882,-0.2618623971939087,0.3070358335971832,0.04414546489715576,0.04985754191875458,0.034582365304231644,-0.21279022097587585,0.10879687964916229,-0.20427574217319489,-0.29895099997520447,0.07237406820058823,-0.0064451610669493675,0.2021908015012741,0.36309853196144104,-0.21919341385364532,0.11019045859575272,-0.1469976156949997,0.04893629625439644,0.07863568514585495,-0.2891315817832947,-0.14578452706336975,-0.2758767604827881,-0.07524065673351288,-0.1406095027923584,0.2207389771938324,-0.33900216221809387},{-0.05133137106895447,0.3248937129974365,0.14987163245677948,-0.1832178384065628,-0.12615926563739777,-0.20486338436603546,0.15126614272594452,-0.089051753282547,0.22684256732463837,-0.03521713241934776,0.22726258635520935,0.18026992678642273,0.006048738956451416,0.07455388456583023,-0.14737316966056824,0.19786590337753296,-0.2080848664045334,-0.3876316249370575,-0.27471989393234253,0.12977170944213867,0.11538120359182358,-0.2523992657661438,-0.32905343174934387,-0.2216002196073532,-0.21336404979228973,0.07385633885860443,0.3681009113788605,0.004094120115041733,-0.11796161532402039,0.08254899084568024,-0.14214597642421722,0.10321390628814697},{-0.20805440843105316,-0.17597797513008118,-0.24358324706554413,0.07328051328659058,-0.2911774218082428,-0.13877928256988525,-0.10981464385986328,-0.1390300691127777,-0.29568663239479065,-0.19722886383533478,0.11774744838476181,0.18001016974449158,-0.26999276876449585,0.2747652530670166,-0.030016394332051277,0.19135086238384247,0.03516364097595215,0.008575175888836384,0.03807758167386055,0.11396259069442749,0.15404561161994934,0.31191858649253845,0.09535598754882812,0.22063077986240387,0.11165042221546173,-0.24009814858436584,-0.12806358933448792,0.26442751288414,-0.026369323953986168,-0.21684834361076355,-0.17179690301418304,-0.18425653874874115},{-0.3351335823535919,-0.2072785347700119,-0.3861987590789795,0.08325570821762085,-0.16181714832782745,-0.1150972917675972,-0.1521693617105484,0.039184801280498505,-0.02452946826815605,0.06397610157728195,-0.23208703100681305,0.020542608574032784,0.16560807824134827,-0.017234791070222855,0.011770922690629959,0.16212333738803864,-0.15274514257907867,-0.08258767426013947,0.1497066617012024,0.12852710485458374,0.21939849853515625,4.5857796067139134e-05,-0.28923171758651733,0.06925499439239502,0.2550967335700989,-0.2922743260860443,0.17935119569301605,-0.01783774048089981,0.03849438577890396,-0.16217678785324097,0.1852787435054779,-0.12041313201189041},{0.27444130182266235,-0.05615898594260216,0.05549118295311928,0.11479409039020538,-0.2855195999145508,-0.0008244673954322934,0.1616809070110321,0.2236219048500061,-0.08401916176080704,-0.10263724625110626,0.305268794298172,-0.18728595972061157,-0.025604449212551117,-0.06380508840084076,-0.15014439821243286,0.22119656205177307,0.017231235280632973,-0.06503201276063919,0.12817880511283875,-0.2831920087337494,0.03570123761892319,-0.306363582611084,-0.23747916519641876,0.2580898106098175,-0.14137442409992218,-0.1348244994878769,0.16765859723091125,-0.01384266559034586,-0.1575070023536682,-0.0010326275369152427,-0.09541255235671997,-0.03294051066040993},{0.28849947452545166,-0.049414679408073425,0.07279454916715622,0.07100887596607208,-0.020537560805678368,-0.11564858257770538,0.1486983448266983,-0.253831148147583,0.22445981204509735,0.27160966396331787,0.012229027226567268,0.17113156616687775,0.27263572812080383,0.3476015329360962,-0.2960883378982544,-0.3092954754829407,-0.3067547380924225,0.05350533872842789,-0.1450059413909912,-0.27895113825798035,-0.1914224624633789,0.28923460841178894,0.06615255028009415,0.14065606892108917,-0.1267360895872116,-0.08715520799160004,-0.1545887589454651,-0.20285290479660034,0.2429783046245575,0.15938271582126617,-0.28404730558395386,-0.16517265141010284},{-0.11486209183931351,0.14731979370117188,0.2892894148826599,-0.05814798176288605,-0.03113965317606926,0.05149669200181961,-0.02779320627450943,-0.34236621856689453,0.20988476276397705,0.2513091564178467,0.1586686372756958,0.20968618988990784,-0.2303183525800705,0.21354307234287262,-0.2764582633972168,0.28048864006996155,0.13747604191303253,-0.2194857895374298,0.2497146725654602,0.1644669622182846,-0.3159021735191345,0.31676188111305237,-0.32083824276924133,0.14266721904277802,0.19039395451545715,0.2119324654340744,0.08643093705177307,0.07785654813051224,-0.21149425208568573,0.24017147719860077,-0.09581508487462997,0.08052126318216324},{-0.14736248552799225,-0.05879301577806473,0.005291428882628679,0.2467881739139557,-0.029609695076942444,0.17266149818897247,-0.37430164217948914,-0.20667299628257751,-0.15530681610107422,-0.11384416371583939,-0.19550655782222748,-0.10793987661600113,0.10021071135997772,-0.10484235733747482,0.11289208382368088,-0.17927521467208862,0.1317141205072403,-0.026880037039518356,-0.33625131845474243,-0.21400471031665802,0.08464972674846649,0.22117629647254944,-0.18910522758960724,0.32326948642730713,-0.25574246048927307,0.0987880676984787,0.10318152606487274,-0.08467498421669006,0.10195694863796234,-0.26115965843200684,0.345243364572525,0.0648549273610115},{0.358419269323349,-0.05710682272911072,0.06723266839981079,0.15675699710845947,-0.1538558006286621,0.24323520064353943,-0.029428550973534584,0.24605219066143036,0.1612042635679245,0.12176840007305145,0.02596413530409336,-0.40052035450935364,-0.26809945702552795,-0.0733712688088417,0.08379940688610077,-0.12673062086105347,0.3092251420021057,0.20674920082092285,-0.2130567729473114,-0.21078531444072723,0.2725059688091278,0.2866846024990082,0.2629850506782532,0.14609426259994507,-0.0726553276181221,-0.030553949996829033,-0.08816653490066528,-0.22262106835842133,0.2193058282136917,0.0803896114230156,-0.18879282474517822,0.12413983792066574},{-0.01444054115563631,0.021484581753611565,-0.0634525790810585,-0.24792589247226715,-0.10413999110460281,-0.24406778812408447,-0.22926002740859985,-0.1717100441455841,0.018773047253489494,-0.012500823475420475,-0.26579415798187256,0.02150447480380535,-0.2521574795246124,-0.16033002734184265,0.0010489949490875006,0.0864778384566307,0.2710345387458801,-0.1725231260061264,-0.3513199985027313,0.2739143967628479,-0.15513908863067627,0.2614544630050659,-0.023324808105826378,-0.05098417401313782,0.042619165033102036,0.12365151196718216,-0.05427081137895584,-0.28448188304901123,0.23327487707138062,0.25329169631004333,-0.14890527725219727,0.19552814960479736},{-0.2650700807571411,-0.002976425923407078,0.04252266138792038,-0.013053806498646736,0.04362819716334343,0.09547899663448334,-0.1707032024860382,0.12384519726037979,-0.20965784788131714,-0.20568691194057465,0.13346129655838013,-0.11940555274486542,-0.19697155058383942,0.2405373901128769,0.012524855323135853,0.01319045852869749,0.2113221287727356,-0.2802867293357849,-0.15985065698623657,0.23174333572387695,0.04895136505365372,0.19333142042160034,-0.005507328547537327,-0.00490788696333766,-0.26378312706947327,-0.11917378753423691,0.03187008574604988,0.33878228068351746,0.025139087811112404,-0.0168593842536211,0.29685696959495544,0.32395175099372864}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.09883859008550644,0.18552178144454956,0.38838493824005127,-0.052212417125701904},{0.059552088379859924,-0.12198182195425034,0.0360076017677784,0.24523039162158966},{-0.09847216308116913,0.13386590778827667,0.11797478049993515,0.11381333321332932},{0.3431701362133026,0.04486915469169617,0.06370921432971954,0.4726036489009857},{-0.05892816558480263,0.07708881795406342,0.32274067401885986,0.012407543137669563},{-0.13576455414295197,0.24159221351146698,0.2358587235212326,-0.06049693375825882},{-0.34916436672210693,-0.010908100754022598,0.05827516317367554,-0.12093861401081085},{-0.3597460091114044,-0.14797353744506836,0.4057227671146393,-0.29837653040885925},{0.3114365339279175,-0.13698704540729523,-0.2927418649196625,-0.3908369541168213},{0.08209466934204102,0.3428313732147217,0.31255999207496643,-0.41897696256637573},{-0.1966729313135147,-0.19274847209453583,-0.10006499290466309,0.12448383122682571},{0.3919529616832733,-0.16871701180934906,-0.0653003677725792,0.2188321352005005},{0.27585935592651367,0.2784222662448883,-0.08072059601545334,0.13465049862861633},{-0.0024999782908707857,0.03007575310766697,-0.30218711495399475,0.05642781779170036},{0.11466016620397568,0.26340627670288086,0.39196082949638367,0.28474390506744385},{0.15321114659309387,0.0017773752333596349,0.2717321217060089,0.2737642228603363},{-0.26985964179039,-0.10322757810354233,-0.07053613662719727,-0.2717941701412201},{-0.14469707012176514,0.15208305418491364,-0.13765083253383636,-0.09801752120256424},{-0.3645069897174835,0.16953007876873016,0.16578419506549835,0.3765990138053894},{-0.030686460435390472,0.31565484404563904,-0.16488520801067352,0.1754571795463562},{-0.2777007818222046,-0.37891829013824463,-0.11466172337532043,0.007846609689295292},{0.3645913898944855,0.4323557913303375,0.01051701046526432,-0.2970028519630432},{-0.005337496753782034,0.18507397174835205,0.22944143414497375,0.18703821301460266},{-0.05692185088992119,0.42039239406585693,-0.07163163274526596,-0.1918090432882309},{-0.015957999974489212,-0.0733710303902626,-0.1082596480846405,0.0007328453357331455},{0.3287249803543091,-0.38028958439826965,-0.0579984076321125,0.014798459596931934},{-0.03940369561314583,-0.3639157712459564,-0.1848638653755188,-0.2871294319629669},{0.14700005948543549,-0.2058865875005722,0.23320718109607697,0.13048093020915985},{0.030686628073453903,-0.051744528114795685,0.0361768938601017,0.010286543518304825},{-0.4364239573478699,0.4005570709705353,0.22020955383777618,-0.0033419227693229914},{0.36529698967933655,-0.16203530132770538,0.20387347042560577,-0.057679399847984314},{0.15501949191093445,-0.39932018518447876,0.4022986888885498,-0.26583072543144226}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.07235309481620789,-0.03573253005743027,0.017471224069595337,0.040682435035705566,-0.0810433104634285,-0.10732119530439377,0.024266965687274933,0.04407244175672531,0.042891617864370346,-0.01721138507127762,-0.05745331197977066,-0.007279820740222931,0.05934721231460571,0.005778866820037365,-0.07693757116794586,-0.018204372376203537};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.020139876753091812,0.004254941828548908,0.007996231317520142,0.008500061929225922,-0.0010750818764790893,-0.016473354771733284,0.027576657012104988,0.025848453864455223,0.0160751361399889,0.024128513410687447,0.031088028103113174,-0.002283478621393442,0.05240698903799057,-0.03542061895132065,-0.03934497758746147,0.0036927759647369385};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0016027437523007393,0.01189644355326891,0.00960784126073122,-0.0017082191770896316,0.012559453956782818,0.0019677176605910063,0.007731929421424866,0.013905624859035015,-0.03822692111134529,-0.017077872529625893,0.00629472965374589,0.007326156832277775,0.012054897844791412,0.0023087465669959784,-0.0002646376087795943,0.0355442613363266,0.0003648361307568848,-0.02258315123617649,0.018936486914753914,-0.013585478067398071,-0.017559034749865532,-0.010100921615958214,0.04669961333274841,0.009748613461852074,0.009530660696327686,0.026081612333655357,-0.025990869849920273,0.04314226657152176,-0.00612044520676136,-0.00039608185761608183,0.016444379463791847,0.010414007119834423};
static const float action_parameterization_distribution_linear_bias[4] = {-0.005739488173276186,-0.018610132858157158,-0.0008129303460009396,0.010131742805242538};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.03147759661078453,0.2677455544471741,-0.16444820165634155,0.1940283179283142,0.10093659162521362,0.05220365151762962,0.43819907307624817,-0.08793842792510986},{-0.22642500698566437,-0.03502306714653969,-0.2885380685329437,-0.2029900848865509,-0.4000122845172882,-0.2590266466140747,0.0017154088709503412,-0.25453469157218933},{-0.2694622576236725,0.018392840400338173,0.24893800914287567,0.27094367146492004,0.22618794441223145,-0.045658402144908905,0.38532671332359314,-0.16718129813671112},{0.02818695642054081,0.09401293843984604,-0.14920417964458466,0.04347090795636177,-0.009998609311878681,-0.07934118807315826,0.35277241468429565,-0.25027668476104736},{-0.2785760760307312,-0.12866465747356415,-0.20110288262367249,-0.09627656638622284,-0.05153317376971245,0.16113519668579102,0.21270130574703217,-0.07115405052900314},{-0.31792715191841125,-0.0337129570543766,0.4288679361343384,0.271468847990036,0.15904933214187622,-0.12150727212429047,-0.10554145276546478,-0.16294355690479279},{-0.27549219131469727,0.005547740496695042,0.4745808243751526,-0.16385972499847412,-0.14621540904045105,-0.42775440216064453,-0.09509314596652985,-0.11638063937425613},{-0.2827128469944,-0.36448749899864197,0.5737740397453308,-0.04777434468269348,-0.20158550143241882,0.2323003113269806,0.18478716909885406,-0.24163353443145752},{-0.3957337439060211,0.2946479618549347,-0.1100597232580185,0.38105031847953796,0.12010719627141953,-0.30553045868873596,0.008515889756381512,0.12622152268886566},{-0.4477134644985199,-0.3206389844417572,-0.10873961448669434,-0.20201152563095093,-0.5190111994743347,0.14157019555568695,-0.04768714681267738,0.17768904566764832},{0.03899119049310684,0.32601144909858704,0.2389506697654724,-0.016712503507733345,0.21021194756031036,0.16114716231822968,-0.21853648126125336,0.24544093012809753},{0.0953730046749115,0.021570462733507156,0.2616097629070282,0.2437068074941635,-0.305753231048584,0.32104960083961487,-0.010919810272753239,-0.2102404236793518},{0.029836243018507957,-0.3377932906150818,0.25644490122795105,-0.06561307609081268,-0.36338886618614197,-0.06457306444644928,-0.1811617910861969,-0.10428104549646378},{-0.27420079708099365,-0.2664303779602051,0.3225906789302826,0.33578386902809143,-0.2508668899536133,-0.054573751986026764,-0.3040855824947357,0.23984909057617188},{0.02193750999867916,-0.19386184215545654,0.1430450826883316,-0.23079776763916016,-0.2821188271045685,-0.11658407747745514,0.23294652998447418,0.021362179890275},{0.1479484587907791,-0.06491466611623764,0.04331842064857483,-0.22768087685108185,0.05808115750551224,0.0717782974243164,0.10139253735542297,0.3985000252723694},{-0.0674981027841568,-0.3246799111366272,-0.16689828038215637,0.13528472185134888,-0.2186010479927063,-0.14799091219902039,-0.11719877272844315,0.1305408626794815},{-0.21928618848323822,-0.3340071737766266,0.0302578192204237,0.055023983120918274,0.11076699942350388,-0.19567134976387024,0.3460425138473511,0.1783977895975113},{-0.039953894913196564,0.08145518600940704,-0.26639166474342346,0.13492731750011444,0.10244464129209518,0.18791647255420685,-0.23289787769317627,0.3735777735710144},{0.09887026995420456,-0.041567184031009674,-0.3723479211330414,0.10951916873455048,-0.06354311853647232,-0.03110961616039276,-0.3079971969127655,0.006186360027641058},{0.01727820560336113,-0.14233434200286865,0.06456690281629562,-0.07245226949453354,0.3383544087409973,0.048678573220968246,-0.004978680517524481,0.40919169783592224},{-0.04157767444849014,0.10152885317802429,-0.26259422302246094,0.3116031885147095,0.3751938045024872,0.35704827308654785,0.23204267024993896,-0.316811203956604},{-0.5120876431465149,-0.15661954879760742,0.15900661051273346,-0.048274315893650055,0.22606602311134338,-0.26577192544937134,0.28995296359062195,-0.28454747796058655},{-0.27922576665878296,0.004287725780159235,-0.08865509927272797,-0.39754927158355713,0.244553804397583,0.027498306706547737,-0.2638716995716095,0.16247551143169403},{-0.32786962389945984,-0.19069091975688934,-0.019039373844861984,0.01379266194999218,-0.06278998404741287,0.18841299414634705,0.3698367178440094,-0.13457410037517548},{-0.2978370487689972,0.056171685457229614,-0.3935474157333374,-0.3471198081970215,0.17916081845760345,0.06645583361387253,-0.027074255049228668,0.06245905160903931},{0.26023340225219727,0.38758790493011475,-0.3077031970024109,0.14537763595581055,0.22660842537879944,0.4137445390224457,-0.23105961084365845,-0.15047624707221985},{0.29569676518440247,0.25878700613975525,0.038724951446056366,0.03997093811631203,0.29933321475982666,0.226913183927536,0.32104888558387756,0.36019933223724365},{-0.22192631661891937,0.38841739296913147,0.13526035845279694,-0.021233564242720604,0.2391473650932312,0.07602199912071228,-0.2784333825111389,-0.3077045977115631},{-0.3085363805294037,-0.20597103238105774,0.06415572762489319,-0.2849750518798828,-0.29856276512145996,-0.153960719704628,0.40270692110061646,-0.08647056668996811},{0.272745281457901,-0.23362118005752563,0.3337346017360687,-0.34222257137298584,0.020619601011276245,0.2323281317949295,0.28746265172958374,-0.28975367546081543},{0.08878958970308304,0.4073582589626312,0.3963851034641266,-0.2747599184513092,-0.29304271936416626,0.034680332988500595,0.3085896968841553,0.017659004777669907}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.01544372458010912,0.46252888441085815,-0.1711447536945343,0.18877121806144714,-0.4098973870277405,0.3166739046573639,0.31768378615379333,0.09379660338163376},{-0.5190057158470154,-0.40159666538238525,-0.37117695808410645,-0.4514389634132385,-0.46451470255851746,0.4846396744251251,0.34931680560112,-0.3676767647266388},{0.12564046680927277,-0.17498449981212616,0.1565699577331543,0.18962207436561584,-0.03124389983713627,0.4541093409061432,-0.3060639798641205,-0.5030093789100647},{0.43778184056282043,-0.07165879011154175,0.18953761458396912,0.007928330451250076,0.5025984048843384,0.4353395402431488,0.5504098534584045,0.3888441026210785},{0.08407790958881378,0.20649412274360657,-0.17386801540851593,-0.27968424558639526,0.08428265154361725,-0.45699048042297363,-0.51848304271698,0.6155423521995544},{0.44841495156288147,0.11464748531579971,-0.011137397028505802,-0.35391515493392944,-0.48740246891975403,-0.49694058299064636,-0.1463933289051056,0.42277997732162476},{-0.467465877532959,-0.3348289728164673,-0.11443886905908585,-0.2356829196214676,-0.02347203530371189,0.5241402983665466,-0.5274734497070312,0.5173003673553467},{0.20694534480571747,0.06688261032104492,-0.005392235703766346,0.06431638449430466,0.3917880952358246,-0.5145562887191772,0.37433359026908875,-0.3701387643814087}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07621237635612488,0.021941304206848145,0.04341021180152893,-0.021749144420027733,-0.043646153062582016,0.025057535618543625,0.017009537667036057,-0.0034376750700175762};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.021916456520557404,-0.005297197960317135,-0.04573577642440796,0.05291937664151192,-0.020386923104524612,-0.006059212610125542,0.03167741000652313,-0.07260365039110184};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

