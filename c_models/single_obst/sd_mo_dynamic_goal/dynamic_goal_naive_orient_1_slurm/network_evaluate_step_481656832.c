#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.34247925877571106,-0.2243160605430603,0.34410932660102844,0.15873418748378754,-0.3988398015499115,0.11826430261135101,0.0061976248398423195,-0.2151365578174591,0.07379192113876343,0.4830562174320221,0.1092953309416771,0.014619044959545135,0.14738619327545166,-0.1442342847585678,0.3540964722633362,-0.12485005706548691},{-0.3559949994087219,-0.27013593912124634,0.2817190885543823,0.1570349633693695,-0.22646550834178925,-0.025105107575654984,-0.34952566027641296,0.06825806200504303,-0.21981921792030334,-0.09651914238929749,0.15369877219200134,-0.15013426542282104,0.20810076594352722,-0.38555070757865906,-0.2232140749692917,0.0845169946551323},{0.14472433924674988,-0.24986645579338074,-0.2561507821083069,0.042592182755470276,0.117060586810112,0.15119516849517822,-0.08374817669391632,0.008017818443477154,-0.10667736828327179,-0.18374964594841003,-0.19470623135566711,0.41892674565315247,-0.01584748923778534,-0.15355347096920013,-0.38389092683792114,0.21834124624729156},{0.14350315928459167,0.15085725486278534,0.33534449338912964,-0.07604782283306122,-0.3368317782878876,-0.02918734773993492,0.14758101105690002,0.1293925791978836,0.48468217253685,-0.38043898344039917,0.007841212674975395,0.14086103439331055,-0.2824806272983551,-0.0628151223063469,0.34121012687683105,-0.39727556705474854},{-0.024969082325696945,0.11178111284971237,0.23220159113407135,-0.11265962570905685,0.23987717926502228,0.25427690148353577,0.25337737798690796,-0.07033752650022507,-0.03836231306195259,0.21783365309238434,0.3065612316131592,-0.15283484756946564,-0.12527936697006226,-0.342315673828125,0.3799842894077301,0.13254430890083313},{-0.04094308987259865,-0.19809244573116302,-0.14010022580623627,-0.2395591288805008,0.10086182504892349,0.05527292937040329,-0.015452783554792404,-0.16012543439865112,0.20268657803535461,-0.22133003175258636,-0.30779239535331726,0.17951354384422302,0.38803938031196594,-0.02311272919178009,-0.0611424520611763,0.14622588455677032},{-0.08403316140174866,0.023997843265533447,0.0708286240696907,-0.2523871660232544,0.19236306846141815,0.024724120274186134,0.07301267236471176,0.3676953911781311,0.2828761041164398,0.021767936646938324,-0.3269299566745758,0.23997551202774048,-0.08329518139362335,0.19976593554019928,-0.17669102549552917,-0.17392556369304657},{-0.01670808531343937,0.013629361055791378,0.24995391070842743,0.20916274189949036,-0.37519732117652893,0.018656142055988312,0.32450151443481445,0.2908840477466583,-0.0488860122859478,0.18600770831108093,-0.48152944445610046,-0.31044435501098633,0.2383064329624176,0.2579142451286316,0.2207239419221878,0.1773543357849121},{0.33830952644348145,-0.2776898443698883,0.346065491437912,-0.014462326653301716,0.14465533196926117,0.10609186440706253,-0.16657353937625885,-0.22254678606987,0.1513395756483078,-0.28890249133110046,0.025309797376394272,-0.30789411067962646,-0.19287127256393433,0.2948625683784485,0.13127093017101288,-0.10190729796886444},{0.058679770678281784,-0.3014962077140808,-0.46528369188308716,-0.04401582479476929,-0.3262737989425659,0.22041334211826324,0.386142760515213,0.16523674130439758,0.4600166976451874,0.37879040837287903,0.0182610135525465,-0.2885963022708893,0.08921607583761215,0.3113451898097992,-0.1085202768445015,-0.394368052482605},{0.002727098762989044,0.23532038927078247,0.38150739669799805,-0.30184105038642883,-0.299056738615036,0.24424995481967926,0.17540620267391205,0.3430154025554657,-0.2744639813899994,-0.046339236199855804,-0.028161946684122086,0.1628524363040924,-0.2927802801132202,-0.2158118039369583,0.3444783091545105,-0.35539963841438293},{0.07246752828359604,-0.1232227087020874,-0.015626627951860428,0.19382430613040924,0.34365907311439514,0.3076353073120117,0.43770796060562134,-0.010754421353340149,0.03748297318816185,-0.04414970055222511,0.2737593650817871,-0.1589624136686325,-0.03250956907868385,-0.2489582896232605,0.2786213159561157,0.2715142071247101},{-0.1205911859869957,0.2778658866882324,0.1346900761127472,-0.29938963055610657,0.10036418586969376,0.1203766018152237,0.3425980508327484,-0.05313126742839813,0.11695562303066254,-0.018381481990218163,-0.1038232371211052,0.13190308213233948,0.16980430483818054,0.28053194284439087,0.1326029747724533,-0.28253301978111267},{-0.24346236884593964,-0.2720417082309723,-0.2157980054616928,-0.02196263149380684,-0.161736860871315,0.09499679505825043,-0.31460756063461304,0.07739311456680298,-0.036072712391614914,-0.0627954825758934,-0.275159627199173,-0.05085418000817299,-0.3758642077445984,0.08530107140541077,0.23368917405605316,0.12234538793563843},{-0.2072436660528183,-0.3814009726047516,-0.24468663334846497,0.3602381944656372,0.08045408129692078,-0.3380555808544159,0.31710636615753174,-0.0989283099770546,0.03342617675662041,0.2871634066104889,0.09970023483037949,0.16551287472248077,0.16440774500370026,-0.023268945515155792,-0.1962718367576599,0.20020465552806854},{0.4784702956676483,-0.036464206874370575,-0.24878369271755219,-0.3924679458141327,-0.5642027258872986,0.27684828639030457,0.4549373686313629,-0.282917320728302,0.1471351683139801,0.08839289098978043,-0.2713465094566345,0.07512623071670532,-0.5287474393844604,0.5349721908569336,-0.2756800651550293,-0.02728714607656002},{-0.4053300619125366,-0.32422444224357605,0.41473397612571716,0.3386079668998718,-0.3082430958747864,0.3296159505844116,-0.08958133310079575,-0.3053811490535736,0.26526492834091187,-0.4381260275840759,-0.3150923550128937,-0.6642934083938599,-0.25934863090515137,-0.43670353293418884,0.005009060259908438,-0.16049601137638092},{-0.41623207926750183,0.2688939869403839,-0.547336995601654,-0.03365444391965866,0.005082450807094574,0.3661828637123108,-0.3558306396007538,-0.4092860221862793,0.23757866024971008,0.24572257697582245,0.41746529936790466,-0.059998925775289536,-0.21616899967193604,0.2801797091960907,0.14220096170902252,-0.5056847929954529}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.10201393067836761,-0.1027413085103035,-0.18530210852622986,-0.40926873683929443,0.3826296627521515,0.2623327076435089,0.06689362972974777,0.09395238012075424,-0.25227922201156616,-0.11734664440155029,-0.09651058912277222,0.014101812615990639,0.23476487398147583,0.47069379687309265,0.12213540077209473,0.08097943663597107},{-0.1833791881799698,-0.2552627921104431,-0.01973327249288559,0.14218077063560486,0.3076012134552002,-0.2405451536178589,0.15362288057804108,0.041642893105745316,-0.07191256433725357,0.25868237018585205,-0.1367444097995758,0.3566187620162964,-0.3580087125301361,0.2097272276878357,-0.3506193459033966,-0.2556077539920807},{0.1626695692539215,0.23333729803562164,-0.384665310382843,-0.6057776212692261,0.1756339967250824,0.4524868428707123,-0.08581230789422989,0.11350993812084198,-0.265462189912796,-0.23370657861232758,-0.01912611722946167,0.2789747714996338,-0.30622196197509766,-0.2686806321144104,0.14229093492031097,-0.03102957457304001},{0.2122049480676651,-0.04130847007036209,0.06371855735778809,0.1487332284450531,-0.49864181876182556,0.024915646761655807,0.028908254578709602,-0.27300235629081726,0.32885774970054626,0.3529723286628723,-0.1430068165063858,-0.19202347099781036,-0.4217536151409149,-0.3512367308139801,0.21044492721557617,0.224077507853508},{-0.17403028905391693,0.06740507483482361,0.052331726998090744,0.30934667587280273,-0.2633861303329468,0.0007568689761683345,-0.03186293691396713,0.21302258968353271,0.2258695662021637,-0.2787717580795288,0.032711517065763474,0.3870985805988312,0.13581633567810059,-0.40988889336586,-0.07220809161663055,-0.13870243728160858},{0.22641049325466156,0.2060624212026596,-0.01887686736881733,0.1692856103181839,-0.35343602299690247,-0.403564989566803,0.23546507954597473,0.2764838933944702,0.11128715425729752,0.4685717225074768,0.259420782327652,-0.2501521110534668,0.029457896947860718,-0.14989517629146576,-0.05087921395897865,0.32980242371559143},{-0.05624688044190407,0.15501530468463898,0.3726828694343567,-0.34847548604011536,-0.16151700913906097,0.0568101704120636,-0.29776906967163086,-0.05603412166237831,0.1097746416926384,0.09897853434085846,-0.11709792166948318,-0.2924445569515228,-0.2573758661746979,0.04674026370048523,0.16872814297676086,0.07073364406824112},{-0.16233164072036743,-0.15302695333957672,-0.3895954489707947,0.2816639244556427,-0.27307409048080444,-0.32090163230895996,-0.1671547144651413,-0.3237689435482025,0.02520153298974037,-0.17100206017494202,-0.10593653470277786,0.1511189043521881,-0.2077646106481552,0.4100560247898102,-0.12058279663324356,-0.38441458344459534},{-0.23004329204559326,0.2854473888874054,0.005484498105943203,-0.022132931277155876,0.3172549605369568,-0.22806650400161743,0.3960604965686798,0.1259572058916092,0.25236400961875916,0.3792085349559784,0.2721852958202362,0.27936702966690063,0.2607896029949188,-0.03625127673149109,0.28254348039627075,0.13505959510803223},{0.11850605905056,-0.29264286160469055,-0.015212515369057655,-0.13029906153678894,0.32041990756988525,-0.05028790235519409,-0.2999510169029236,-0.23695623874664307,0.05910555645823479,-0.4633953273296356,-0.17171040177345276,0.21742960810661316,0.13969312608242035,0.17312376201152802,-0.31992289423942566,0.283569872379303},{-0.1439228653907776,-0.3467954695224762,0.461286336183548,0.22184619307518005,0.21447239816188812,0.1619505137205124,0.09174343198537827,-0.16343402862548828,0.13683192431926727,-0.21155188977718353,0.01054504793137312,0.44386225938796997,0.3206963539123535,0.12995174527168274,-0.20344434678554535,-0.00336983404122293},{0.02025884948670864,-0.14604251086711884,0.27444520592689514,0.015350280329585075,-0.13335251808166504,-0.22877129912376404,0.4618370532989502,0.29939281940460205,-0.2764193117618561,-0.39291656017303467,-0.1135026291012764,-0.32078829407691956,0.00441290158778429,-0.3384215533733368,-0.3646933138370514,-0.011812340468168259},{-0.02896452695131302,-0.3117782473564148,0.30179160833358765,-0.21745511889457703,0.3029734194278717,-0.3058617413043976,-0.37082603573799133,0.17113067209720612,0.08908194303512573,-0.02892330288887024,-0.2912262976169586,0.08352094888687134,0.06200030818581581,-0.28085172176361084,-0.3747207224369049,-0.004430411383509636},{0.32417041063308716,-0.2914581894874573,0.4539355933666229,0.15967904031276703,0.02763933688402176,0.29307305812835693,-0.06668633967638016,-0.20722974836826324,-0.5191852450370789,0.12767314910888672,0.007172336336225271,-0.3795554041862488,0.0024857025127857924,0.22356124222278595,0.3486463725566864,0.04149092361330986},{-0.22819870710372925,0.16769294440746307,0.11270478367805481,-0.3212200999259949,-0.22232328355312347,0.04389475658535957,0.24641643464565277,-0.1294931024312973,0.16364912688732147,-0.3580278754234314,0.00010889112309087068,0.07039135694503784,-0.019275793805718422,0.050075531005859375,-0.0911090150475502,0.00912395864725113},{-0.2131219506263733,0.3156014680862427,-0.3258172571659088,0.3389100432395935,0.1411876082420349,-0.3649793267250061,-0.127045139670372,-0.08697028458118439,-0.38495388627052307,0.28321024775505066,-0.37532785534858704,0.31716546416282654,-0.07057052850723267,-0.16059982776641846,-0.27651333808898926,-0.5385581254959106}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.15975333750247955,0.021181628108024597,-0.06296639144420624,-0.02895134873688221,-0.1126272901892662,0.02721250057220459,0.2856549620628357,0.041811734437942505,-0.12952305376529694,-0.19978205859661102,0.11655429750680923,-0.2990790009498596,-0.20856331288814545,0.23070837557315826,0.21766792237758636,0.29038941860198975,-0.251541405916214,-0.3109285831451416,-0.2040991634130478,0.03779911249876022,-0.03850620239973068,-0.34822702407836914,-0.23500235378742218,-0.2810465395450592,-0.3158164918422699,0.22162802517414093,-0.23383183777332306,-0.03657837584614754,-0.01230651792138815,0.006428456865251064,0.21705543994903564,-0.16702859103679657},{0.2671250104904175,0.2301594763994217,0.13680797815322876,-0.0771106481552124,0.09633847326040268,-0.08798330277204514,0.28471383452415466,0.1278281807899475,-0.19461886584758759,-0.1560312807559967,-0.05315598100423813,-0.2604154646396637,-0.16597701609134674,0.18814043700695038,-0.2104504108428955,-0.31891512870788574,-0.047937266528606415,0.1494799554347992,-0.32079043984413147,-0.2870100736618042,0.007611656095832586,0.253317654132843,0.12188325077295303,-0.10793666541576385,0.15611113607883453,-0.279732882976532,0.03106057457625866,0.09216765314340591,0.21458566188812256,-0.12508779764175415,-0.025897588580846786,0.2532738149166107},{0.23420675098896027,0.07492409646511078,-0.05235738307237625,0.1270865947008133,-0.17039000988006592,-0.16637293994426727,-0.24705155193805695,0.1397634595632553,-0.12168809771537781,0.3671979606151581,-0.289294958114624,-0.19538526237010956,0.14938844740390778,-0.3758563995361328,-0.15007808804512024,0.11999723315238953,-0.12094113975763321,-0.12102431803941727,0.2551622986793518,-0.04009594768285751,0.21001340448856354,0.25555479526519775,-0.2566088140010834,0.03295625373721123,-0.18475030362606049,-0.0964866429567337,0.13758745789527893,-0.07013827562332153,-0.07352610677480698,-0.1721477210521698,-0.06390354782342911,-0.12587200105190277},{0.3301977813243866,0.07738791406154633,0.09063486754894257,-0.13526961207389832,-0.2642371356487274,-0.07635264098644257,-0.1467486172914505,0.24505898356437683,0.2392711043357849,-0.21269378066062927,-0.09493982046842575,0.2859954535961151,0.11292599141597748,-0.12188723683357239,-0.23110993206501007,0.3118571639060974,-0.3145778775215149,0.24284234642982483,-0.009288516826927662,0.04862458258867264,-0.05662781745195389,-0.10297569632530212,0.2814502418041229,0.15736404061317444,0.16576756536960602,-0.3215145468711853,0.32698652148246765,-0.2002151608467102,-0.01784912496805191,0.026339078322052956,-0.3014678657054901,0.1587446928024292},{-0.01845761574804783,-0.05003786087036133,-0.07423412799835205,0.05542206019163132,0.19564171135425568,-0.17732082307338715,-0.3754696547985077,-0.004582196474075317,-0.13119520246982574,-0.19557058811187744,0.1464982032775879,0.23357228934764862,-0.07293879240751266,-0.08475812524557114,-0.07087791711091995,0.21174867451190948,-0.04915568232536316,-0.0068901036866009235,-0.3279745578765869,-0.04390518739819527,-0.17418912053108215,-0.35857468843460083,0.16305145621299744,0.23577505350112915,-0.06339346617460251,0.27105098962783813,-0.1728314906358719,0.2267238199710846,0.2865227460861206,0.3685748875141144,-0.0051063611172139645,0.298465758562088},{-0.22222158312797546,-0.10890527814626694,-0.1431877613067627,-0.05075772851705551,-0.13685089349746704,0.22678256034851074,0.2218431532382965,0.029733099043369293,0.3231920003890991,0.13461509346961975,0.2763439118862152,-0.21746312081813812,-0.16684561967849731,0.2433864325284958,0.266006737947464,-0.3556201159954071,-0.10246746987104416,-0.24368920922279358,0.2197502702474594,0.12812621891498566,0.09113091975450516,0.12190371751785278,-0.0007594061898998916,-0.025603847578167915,-0.366148978471756,0.31836608052253723,-0.2070709466934204,0.14697618782520294,0.3387789726257324,0.22962632775306702,0.07847081124782562,0.061667852103710175},{0.1767798811197281,-0.14168836176395416,-0.12778747081756592,-0.33806082606315613,0.009523461572825909,0.2220625877380371,0.28044578433036804,0.12440666556358337,0.11380015313625336,0.3108275234699249,-0.00870036706328392,-0.000848259893245995,-0.40510350465774536,-0.12519733607769012,-0.15129350125789642,0.04376867413520813,-0.28029388189315796,-0.21372856199741364,0.16485455632209778,-0.08567801862955093,-0.12284853309392929,-0.14938543736934662,-0.2380160540342331,-0.24724751710891724,0.19450658559799194,-0.2734163999557495,-0.1305152326822281,-0.21792057156562805,0.32677823305130005,0.12042886018753052,-0.17687995731830597,-0.28362658619880676},{0.06870518624782562,0.17322859168052673,0.05654854699969292,-0.1335257887840271,0.15739542245864868,-0.2957206964492798,-0.05049046128988266,-0.16581369936466217,0.01527541782706976,-0.2815292477607727,-0.31234630942344666,-0.10653043538331985,-0.1111060306429863,0.06890819221735,-0.1327243596315384,0.4016381502151489,0.009884444065392017,-0.1370486468076706,0.11240753531455994,0.3321599066257477,-0.2008526623249054,-0.18842759728431702,0.2756188213825226,0.08922833204269409,0.011843651533126831,-0.33667463064193726,-0.3399161398410797,-0.21946083009243011,-0.383543998003006,-0.2718419134616852,0.10796760022640228,-0.38559842109680176},{0.04280314967036247,0.42791053652763367,-0.3848426043987274,-0.36515358090400696,-0.29952579736709595,0.11905568838119507,0.05935690179467201,0.1345907598733902,0.06392478942871094,-0.24097487330436707,-0.16646070778369904,0.30260252952575684,-0.3681892156600952,-0.21448677778244019,0.2061348855495453,-0.23167911171913147,0.2309412956237793,0.12201337516307831,0.3327518403530121,0.0734521746635437,0.20567893981933594,0.15402548015117645,0.34587743878364563,-0.14716756343841553,0.464113712310791,-0.19719545543193817,0.22696608304977417,0.36692312359809875,-0.17974700033664703,0.11628630757331848,0.035259976983070374,0.10658306628465652},{-0.23224154114723206,0.11054056137800217,-0.37550246715545654,-0.177537202835083,0.10736168920993805,-0.22826839983463287,0.11582198739051819,-0.017491525039076805,0.18307119607925415,0.07179614901542664,-0.26107531785964966,-0.3497631251811981,-0.43120643496513367,-0.11649240553379059,-0.2518673837184906,0.10128016024827957,-0.042249251157045364,-0.26654940843582153,0.18929041922092438,0.06175624951720238,0.08547456562519073,-0.0177348330616951,0.38838279247283936,-0.206456258893013,0.33216604590415955,0.17345750331878662,-0.22259043157100677,0.04537168890237808,0.02275778166949749,0.02897663041949272,-0.2084636092185974,0.1370503157377243},{0.0866188108921051,-0.0117410346865654,0.15984570980072021,-0.2772292494773865,-0.25990548729896545,-0.23040708899497986,-0.2551407516002655,-0.0653834193944931,-0.17500175535678864,0.34026819467544556,0.13091370463371277,-0.27519166469573975,-0.35233160853385925,-0.03376687318086624,-0.21957522630691528,-0.1680161952972412,0.2300315499305725,-0.15846280753612518,0.2682153582572937,-0.2081991285085678,-0.19044789671897888,0.02142157591879368,0.18578052520751953,0.17016984522342682,0.19196578860282898,-0.14872121810913086,-0.04986490309238434,-0.0691777840256691,-0.051906391978263855,0.011242201551795006,-0.06991978734731674,0.16974636912345886},{-0.2177180051803589,-0.04410529509186745,0.2276267260313034,0.31893083453178406,0.25967100262641907,-0.0007835282012820244,0.06559944152832031,-0.21845710277557373,-0.10002698749303818,-0.19367188215255737,0.28713682293891907,-0.23966383934020996,-0.2133660763502121,-0.19551628828048706,0.28725698590278625,-0.0031759690027683973,-0.007022543344646692,0.02180136926472187,0.3358519971370697,0.08255359530448914,-0.18204258382320404,0.24180592596530914,0.11422012746334076,-0.09797004610300064,0.2085718959569931,-0.10574902594089508,-0.13383282721042633,0.23713697493076324,0.20962436497211456,-0.016617096960544586,-0.2706603407859802,-0.2544248104095459},{0.23715363442897797,-0.24808895587921143,-0.0057647028006613255,-0.34673410654067993,0.1324988603591919,-0.08510668575763702,0.1630546748638153,0.07371746003627777,0.2632056176662445,0.08389949053525925,0.12490906566381454,0.19652166962623596,-0.3555426299571991,-0.24177610874176025,-0.08056705445051193,-0.21155093610286713,-0.14105702936649323,-0.2082676887512207,0.2552925944328308,-0.23271803557872772,0.26901790499687195,-0.006639183033257723,-0.018740149214863777,0.1883333921432495,0.13647803664207458,-0.09173493832349777,0.12279034405946732,0.14341910183429718,0.12912887334823608,-0.07610622048377991,-0.21988502144813538,-0.09743168950080872},{0.24170996248722076,-0.06285671889781952,-0.03972504287958145,0.42385977506637573,-0.1026795282959938,-0.21384604275226593,-0.06483698636293411,0.10931561887264252,0.18304309248924255,0.30553749203681946,0.11752220243215561,-0.14192155003547668,0.046980343759059906,0.19601686298847198,-0.09892746061086655,0.06670883297920227,0.19404038786888123,-0.23780551552772522,0.06071903556585312,-0.32785964012145996,0.33335769176483154,0.13063690066337585,-0.07414380460977554,0.19124218821525574,0.18146270513534546,0.08244969695806503,0.09470629692077637,0.04687567800283432,0.07250857353210449,-0.13944382965564728,-0.04702560603618622,0.41311055421829224},{0.028413226827979088,-0.2659445106983185,-0.08431246876716614,0.12026041746139526,-0.25129830837249756,-0.009408545680344105,0.06089947372674942,-0.27142080664634705,-0.14630316197872162,-0.05757100135087967,0.17636814713478088,0.14359049499034882,0.09061256051063538,0.25803142786026,-0.06785965710878372,-0.09978853166103363,-0.23009657859802246,0.26690658926963806,-0.10712144523859024,-0.2835453450679779,-0.18022090196609497,-0.08369080722332001,0.1776832640171051,-0.006897539831697941,-0.04605609178543091,-0.07056205719709396,-0.21258743107318878,0.2168034464120865,0.06739353388547897,-0.17748793959617615,0.22697103023529053,0.19985045492649078},{0.12973318994045258,-0.21558630466461182,-0.1005750223994255,-0.17665699124336243,-0.1058414876461029,0.15448054671287537,0.027482902631163597,0.23363125324249268,-0.10070212930440903,0.025126509368419647,0.25694575905799866,0.11224474757909775,-0.058055926114320755,-0.13786838948726654,0.04848982393741608,0.15234006941318512,-0.4229428172111511,-0.2807130515575409,-0.05963733792304993,0.04522588849067688,0.12124776840209961,0.2369176596403122,0.28655579686164856,0.13498705625534058,0.04701277241110802,0.22783790528774261,0.017536994069814682,-0.07494885474443436,0.19649848341941833,-0.1277174949645996,-0.2614266276359558,0.3776366710662842},{0.18040810525417328,-0.013250550255179405,-0.25592055916786194,0.16500422358512878,0.09358987212181091,-0.039026226848363876,0.2734832465648651,0.10895667225122452,0.10785584151744843,-0.21602974832057953,0.21224363148212433,-0.18656252324581146,-0.36853334307670593,0.24753540754318237,0.06479915976524353,0.06596194952726364,0.06756245344877243,-0.036982715129852295,-0.1335105299949646,0.04543202742934227,-0.07951994240283966,0.20798014104366302,0.05791451036930084,-0.1477363556623459,0.032139502465724945,-0.27406400442123413,0.031281933188438416,0.420674204826355,0.23330427706241608,-0.14810922741889954,0.2154977023601532,0.18576742708683014},{-0.0549827516078949,-0.022733479738235474,-0.102134108543396,-0.025481397286057472,-0.25973692536354065,-0.035472407937049866,0.18030115962028503,0.18844401836395264,0.1267886757850647,-0.0037818707060068846,0.24470674991607666,0.02066200226545334,0.20180414617061615,0.15462146699428558,0.18260429799556732,-0.08367837220430374,0.11451160907745361,0.1594134271144867,0.2607860267162323,0.06636019796133041,0.19495458900928497,0.23941180109977722,0.07174050807952881,0.12320470809936523,-0.01936836913228035,-0.09328948706388474,-0.08106593787670135,-0.2525247037410736,0.18494661152362823,-0.231582909822464,0.020615149289369583,-0.01339106447994709},{-0.32587265968322754,0.1008002907037735,-0.29789116978645325,-0.35848379135131836,-0.013866773806512356,0.06440515071153641,0.13227514922618866,-0.11419028043746948,-0.0019289663759991527,0.30756181478500366,0.06106721982359886,-0.22103404998779297,0.05144253000617027,-0.17201462388038635,-0.3131428062915802,-0.021220890805125237,-0.17946743965148926,0.15598158538341522,-0.029205581173300743,-0.06648658961057663,-0.32568639516830444,0.1946464478969574,0.13659387826919556,0.02550239861011505,-0.012357900850474834,0.28460243344306946,0.019534341990947723,-0.12089656293392181,-0.18738147616386414,0.004353031981736422,-0.1491255760192871,-0.26275891065597534},{-0.005954822525382042,-0.22177687287330627,-0.23085513710975647,-0.024705104529857635,-0.36102616786956787,-0.16659905016422272,0.16364222764968872,-0.3028351962566376,-0.19934797286987305,0.20488828420639038,0.14511549472808838,0.11576367914676666,0.13606809079647064,-0.11697068065404892,0.31002524495124817,-0.31673529744148254,0.05930816009640694,0.22125467658042908,0.052689895033836365,0.24191021919250488,0.05216243863105774,-0.11772866547107697,-0.2842594087123871,0.20142525434494019,-0.17642337083816528,-0.15516473352909088,0.09755128622055054,0.0294700488448143,-0.1210106760263443,-0.30440929532051086,-0.046562157571315765,-0.13578514754772186},{0.2240780144929886,0.1824358105659485,-0.07729961723089218,0.15940620005130768,-0.27886006236076355,0.17656353116035461,-0.06340982764959335,-0.13728004693984985,-0.18707801401615143,0.2022685408592224,-0.2605312168598175,-0.16695049405097961,-0.04061311110854149,-0.17850008606910706,-0.3742736577987671,-0.13052824139595032,-0.08220386505126953,-0.26822429895401,-0.23472915589809418,0.2923862040042877,0.09165991842746735,0.12698757648468018,-0.33832359313964844,0.33406150341033936,0.200542151927948,0.25991031527519226,-0.28817036747932434,-0.025930305942893028,0.06590444594621658,-0.2656511664390564,0.12594527006149292,0.09162142127752304},{0.007991439662873745,-0.33763375878334045,0.02607961744070053,-0.2781897783279419,-0.070794977247715,0.25533583760261536,0.17125891149044037,0.015688806772232056,-0.030151793733239174,0.0006360356346704066,-0.2220352739095688,0.16594929993152618,0.16732753813266754,0.1092536449432373,0.14915461838245392,0.00945485569536686,-0.07515352964401245,0.11813972890377045,-0.0964951142668724,0.17510655522346497,0.22184956073760986,0.22646667063236237,-0.09168131649494171,-0.237393319606781,0.10036130249500275,0.10156747698783875,0.2603856027126312,0.12601922452449799,-0.03205219283699989,0.20029042661190033,0.036553945392370224,-0.10798189043998718},{0.029731905087828636,-0.18731428682804108,0.24331988394260406,-0.004956993740051985,0.3135945498943329,-0.03768055513501167,-0.10289216786623001,-0.1638002097606659,0.15296946465969086,-0.06838527321815491,0.06218578293919563,-0.002091062255203724,-0.26988834142684937,0.02806324139237404,-0.1142759919166565,-0.24554596841335297,-0.039786722511053085,-0.04202410206198692,0.20158502459526062,0.2572695016860962,0.02521413192152977,0.03538241982460022,0.16833877563476562,0.35425272583961487,-0.1536054164171219,-0.08160043507814407,0.19290806353092194,-0.1200316846370697,-0.21566198766231537,-0.24362114071846008,0.3035658895969391,-0.013909674249589443},{0.20654700696468353,-0.0639701634645462,0.043686892837285995,0.1408788114786148,-0.04449477419257164,0.057585690170526505,-0.28150781989097595,0.2803330719470978,-0.08236110210418701,-0.04368031024932861,0.11147689819335938,-0.26074954867362976,-0.002558870008215308,-0.0313655287027359,-0.0867745503783226,0.2693345844745636,-0.09188532084226608,-0.20582479238510132,0.05201340466737747,-0.010498430579900742,-0.15551389753818512,0.20252098143100739,0.23643562197685242,0.2098960429430008,-0.286811500787735,0.11250780522823334,-0.05599139258265495,0.0863010510802269,-0.2788635194301605,0.29533952474594116,-0.02489328756928444,0.06170409917831421}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.22356632351875305,-0.09860586374998093,0.1075199693441391,-0.1560608446598053},{0.20168477296829224,-0.32693052291870117,0.2753171920776367,0.249816432595253},{-0.27431538701057434,0.11205178499221802,0.05608612298965454,-0.019682573154568672},{0.27939966320991516,0.48414286971092224,0.3642212450504303,0.03849836438894272},{-0.2698957622051239,0.14252938330173492,-0.31304842233657837,0.08398712426424026},{-0.05941011756658554,-0.04987136274576187,0.06741561740636826,0.39991825819015503},{-0.1018960103392601,-0.09995070099830627,-0.3594357967376709,0.013250313699245453},{-0.16177082061767578,-0.2598016560077667,0.19786512851715088,-0.06300124526023865},{-0.06572742015123367,0.09818817675113678,-0.0883132740855217,-0.10965918004512787},{0.23733806610107422,0.022203676402568817,-0.1065494492650032,-0.19271832704544067},{0.16337816417217255,-0.10950544476509094,0.3045091927051544,0.25683924555778503},{-0.04181623458862305,0.015081989578902721,0.3771653473377228,-0.09704303741455078},{-0.3511296510696411,0.21197442710399628,-0.009232557378709316,-0.13486197590827942},{-0.17517034709453583,0.10161448270082474,-0.22236064076423645,0.09390021860599518},{0.17543481290340424,0.039122868329286575,0.275704026222229,0.10710874199867249},{-0.15041667222976685,-0.35129958391189575,-0.13030648231506348,-0.10167890787124634},{-0.2959974408149719,0.031093968078494072,-0.0884469673037529,0.29564204812049866},{-0.2580428123474121,-0.1366904377937317,-0.20879998803138733,0.20136766135692596},{-0.0645388513803482,-0.10252102464437485,0.3640044033527374,0.0672452449798584},{-0.19377215206623077,-0.14900095760822296,0.00979438703507185,-0.1878129094839096},{0.1601380556821823,0.11992587149143219,0.16170772910118103,-0.17838560044765472},{-0.03996451199054718,-0.29464370012283325,-0.10819803178310394,0.29563286900520325},{0.40675708651542664,-0.22764940559864044,0.15198904275894165,0.0607040598988533},{-0.3312022089958191,-0.10807202756404877,-0.3140222430229187,-0.3461211919784546},{-0.15562912821769714,-0.21814598143100739,-0.08862008899450302,-0.09063176810741425},{0.1509997844696045,0.13214002549648285,-0.047566018998622894,0.09077038615942001},{0.13412268459796906,-0.20322692394256592,0.27890744805336,0.07558771222829819},{-0.08157733082771301,-0.15273283421993256,-0.023212434723973274,0.2970549464225769},{0.11774963140487671,0.04558631777763367,0.07277172803878784,0.05070211738348007},{-0.16599300503730774,0.12169136852025986,0.2627052962779999,0.007166603580117226},{-0.24809610843658447,-0.09218769520521164,0.07423397898674011,0.22339051961898804},{0.2653246223926544,0.20692084729671478,0.2940094769001007,-0.03590751439332962}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.1064140796661377,-0.10746996849775314,0.05549627169966698,0.08207438886165619,0.10833916813135147,-0.13547681272029877,0.08715982735157013,0.006399132311344147,-0.06546445935964584,-0.0966428741812706,0.0010106428526341915,0.05542171746492386,-0.00894431583583355,0.07105695456266403,0.10176790505647659,-0.029130084440112114};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.010777324438095093,0.062057893723249435,0.053872063755989075,-0.023840056732296944,-0.03720368072390556,0.0551331453025341,-0.05916295945644379,-0.07697705924510956,0.046229973435401917,-0.007815106771886349,-0.02910309098660946,-0.02913626842200756,-0.007514800876379013,-0.07598619163036346,0.03393828123807907,-0.08277551084756851};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04835464432835579,-0.002491418272256851,-0.0637500137090683,0.042598921805620193,2.3142671125242487e-05,0.014506853185594082,-0.055918022990226746,-0.04536817967891693,-0.019907036796212196,-0.013413884676992893,0.013824129477143288,0.038586996495723724,0.0228714756667614,-0.045648880302906036,0.034403130412101746,-0.07667228579521179,-0.008888304233551025,-0.03544719144701958,0.02077818103134632,-0.06523662805557251,0.02491847053170204,-0.013653634116053581,0.032004084438085556,-0.06865040957927704,-0.06379179656505585,0.0658564642071724,0.044515594840049744,-0.03342261165380478,0.0699496939778328,0.01795119419693947,-0.014331419952213764,0.05690669268369675};
static const float action_parameterization_distribution_linear_bias[4] = {0.038651544600725174,0.0586228109896183,0.009537707082927227,0.03312263637781143};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.331035315990448,-0.20647400617599487,-0.03335858881473541,0.16686487197875977,-0.032872918993234634,0.061799950897693634,-0.2001848667860031,0.0013756387634202838},{0.04203956201672554,0.09672078490257263,0.3273603022098541,0.3536047041416168,-0.0910046175122261,-0.23601718246936798,0.3578833043575287,0.13127222657203674},{-0.001585167832672596,0.20992782711982727,0.019536014646291733,-0.04211068153381348,0.31552624702453613,0.2550821304321289,-0.04872029647231102,0.07632634043693542},{0.08448655903339386,-0.24280023574829102,0.27326664328575134,-0.2316228598356247,-0.28690868616104126,0.042498208582401276,0.200698584318161,0.15746550261974335},{-0.2263302505016327,-0.006459265016019344,-0.03490141034126282,-0.29736408591270447,0.04634014889597893,0.040190208703279495,0.22344934940338135,0.22732868790626526},{-0.07168187946081161,0.29472121596336365,-0.08109822124242783,-0.23676224052906036,0.14173416793346405,0.0030207280069589615,0.0036867547314614058,-0.21076743304729462},{-0.0028256112709641457,0.31968075037002563,0.13760727643966675,-0.1295085996389389,0.23728230595588684,-0.2614014446735382,0.22138462960720062,0.07547294348478317},{0.02586221694946289,-0.1802065521478653,0.05815552920103073,-0.08330783993005753,0.329571396112442,-0.13726477324962616,-0.006285502575337887,-0.2755138874053955},{-0.1579294353723526,0.31166669726371765,0.15697960555553436,-0.019901622086763382,0.013465043157339096,0.20538540184497833,0.4604557156562805,0.39413636922836304},{0.058894459158182144,-0.05767088755965233,-0.27798163890838623,0.35871562361717224,0.2358882874250412,0.15359285473823547,0.2107720822095871,-0.26471027731895447},{-0.1235206350684166,-0.3335422873497009,0.3630901873111725,0.2180730104446411,-0.032840583473443985,-0.37833377718925476,-0.11860454082489014,-0.3346315920352936},{0.3095442056655884,0.07091197371482849,0.40506234765052795,0.4629751145839691,-0.17085036635398865,0.20102107524871826,0.13923783600330353,-0.39382484555244446},{-0.30365440249443054,0.18281103670597076,-0.3038724958896637,0.4351269006729126,-0.052543871104717255,0.26333221793174744,-0.0027677039615809917,0.2348056584596634},{-0.01535474881529808,0.211852565407753,-0.06376345455646515,-0.15558673441410065,0.03409283235669136,0.05509663745760918,0.29951590299606323,-0.02457820065319538},{0.15566511452198029,-0.2854096293449402,-0.2491692751646042,-0.16135422885417938,0.21552692353725433,-0.18937979638576508,0.2350567877292633,-0.12234126031398773},{-0.3764982521533966,-0.3500273525714874,-0.24179325997829437,0.02313626930117607,0.048621345311403275,0.11145471781492233,0.2787455916404724,0.0011069278698414564},{-0.20808660984039307,-0.20813287794589996,0.1510785073041916,-0.2875429391860962,0.11166734248399734,0.07147421687841415,-0.4173067808151245,-0.24929991364479065},{0.03788123279809952,0.28309935331344604,0.04497605562210083,0.18252518773078918,-0.05490385368466377,0.3257910907268524,0.2778758704662323,-0.1700972020626068},{-0.0023313609417527914,-0.2871265709400177,-0.15824495255947113,-0.02539484202861786,-0.04346781224012375,-0.34761321544647217,0.1089896708726883,-0.22606047987937927},{-0.11372802406549454,-0.005639060866087675,0.029814187437295914,-0.27809450030326843,0.1268363893032074,0.08487752079963684,0.11975313723087311,-0.01323579903692007},{0.01542169414460659,-0.08278633654117584,0.026978733018040657,-0.19304867088794708,0.04677285626530647,-0.031183773651719093,0.10432817041873932,-0.15773817896842957},{-0.3326675593852997,0.1825200617313385,0.14977964758872986,-0.28000858426094055,-0.38340088725090027,-0.030226895585656166,0.2138284146785736,0.052878689020872116},{0.2720896005630493,0.0584234781563282,-0.403118371963501,-0.004785723518580198,-0.05629902333021164,0.2136228382587433,0.24868035316467285,0.3268527090549469},{-0.007352256681770086,-0.20770969986915588,-0.053397417068481445,0.13039498031139374,-0.29869332909584045,-0.08548998087644577,-0.22128863632678986,-0.26002538204193115},{0.10919658094644547,-0.08584494143724442,-0.40094685554504395,0.3587670922279358,-0.34557315707206726,-0.10314450412988663,-0.4534692168235779,0.10203110426664352},{-0.012493464164435863,0.31732577085494995,-0.21068532764911652,-0.07866592705249786,0.09040670841932297,-0.13397406041622162,0.286702960729599,-0.27093708515167236},{-0.09500576555728912,0.10446770489215851,-0.08512482047080994,-0.24949049949645996,0.024620210751891136,-0.12552620470523834,-0.14256349205970764,-0.07747412472963333},{0.08355898410081863,-0.15799617767333984,0.04345512017607689,-0.13490159809589386,0.06552258133888245,0.08831411600112915,-0.21006789803504944,0.11146839708089828},{0.21564525365829468,0.023837970569729805,-0.3099701404571533,-0.22076642513275146,-0.19423627853393555,0.18306109309196472,0.2243814766407013,0.0541996993124485},{0.31731003522872925,-0.35708409547805786,0.0043304492719471455,-0.04717135429382324,0.1021467074751854,-0.07807847857475281,0.18329869210720062,0.24969545006752014},{-0.27014556527137756,-0.20501205325126648,0.04005352407693863,-0.3601304292678833,0.27161529660224915,-0.32754549384117126,-0.0222086850553751,0.08225488662719727},{0.24748487770557404,0.19138923287391663,-0.031854450702667236,0.23464833199977875,0.09228288382291794,-0.14242061972618103,-0.025005387142300606,0.13929632306098938}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.22434869408607483,0.41006073355674744,-0.4845731854438782,-0.540761411190033,-0.17425332963466644,-0.09313662350177765,-0.38452526926994324,0.520748496055603},{-0.03231989964842796,0.45550596714019775,-0.2590412199497223,0.5695284008979797,-0.027285536751151085,-0.04444599151611328,-0.33654773235321045,0.02385910227894783},{-0.35089170932769775,-0.18444202840328217,-0.1401534378528595,-0.07979675382375717,0.4487506151199341,0.22275641560554504,-0.042139407247304916,0.4345756769180298},{-0.49276700615882874,-0.5127632021903992,0.3329501450061798,0.2866705358028412,-0.4726375341415405,-0.20586922764778137,0.42949071526527405,0.23144087195396423},{-0.29632240533828735,-0.27675193548202515,-0.3069503903388977,-0.18460725247859955,0.34872967004776,-0.23269282281398773,0.49724921584129333,-0.40679052472114563},{-0.03511965274810791,0.26793405413627625,0.13268223404884338,-0.5492554306983948,0.5363520383834839,-0.23647718131542206,-0.4986323416233063,-0.3547358214855194},{-0.30152300000190735,0.1345081776380539,0.06639346480369568,-0.47188490629196167,0.016367489472031593,-0.5072383880615234,0.46274033188819885,0.06624417752027512},{-0.32846516370773315,-0.15451930463314056,-0.13691437244415283,-0.36613351106643677,-0.37575334310531616,0.12184354662895203,0.5636695623397827,-0.29394295811653137}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.02157309465110302,-0.11454767733812332,-0.11241751164197922,0.023331666365265846,0.1825876533985138,0.05284597724676132,0.1366870403289795,0.05285126715898514};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.0008497096132487059,-0.019394194707274437,-0.01588371768593788,-0.0944877415895462,-0.054001644253730774,-0.07325934618711472,0.013034915551543236,-0.17203739285469055};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

