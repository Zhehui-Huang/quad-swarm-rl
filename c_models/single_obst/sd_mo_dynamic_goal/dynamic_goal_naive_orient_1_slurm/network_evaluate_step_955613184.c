#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.34284836053848267,0.04124976694583893,0.08033953607082367,0.26308783888816833,0.2502076327800751,-0.2230978012084961,-0.3259325623512268,0.12007564306259155,0.39318880438804626,-0.3193327784538269,0.4512457847595215,0.08947357535362244,0.22405418753623962,0.07743395864963531,-0.3115575313568115,0.025616355240345},{-0.3149431347846985,-0.22586697340011597,-0.2445226013660431,-0.08945092558860779,0.17972919344902039,0.4212505519390106,0.1848732978105545,-0.014085505157709122,0.19442994892597198,0.2564736306667328,-0.06622342020273209,0.008132119663059711,-0.10689777135848999,0.09644165635108948,0.28562498092651367,-0.22526390850543976},{0.00029137017554603517,0.1375436931848526,0.2589380443096161,0.3779013454914093,0.08506184816360474,-0.3228873014450073,0.9189780950546265,-0.3173825144767761,-0.30487650632858276,0.0047826869413256645,-0.05024087429046631,-0.2698195278644562,0.4169793128967285,0.6570962071418762,-0.6004188060760498,0.20853589475154877},{0.1412125825881958,-0.15921415388584137,-0.14282219111919403,0.0025843388866633177,-0.09527508914470673,0.12620161473751068,-0.07584156095981598,-0.2061711698770523,-0.02772987261414528,-0.009367184713482857,0.5636817812919617,-0.18111151456832886,-0.33596503734588623,-0.17814306914806366,0.23745639622211456,-0.030815977603197098},{-0.18342168629169464,-0.03345833718776703,0.1781758815050125,-0.40339186787605286,0.4525067210197449,0.2475193440914154,0.21103285253047943,-0.1961366981267929,-0.1966463029384613,0.3108937740325928,-0.12447992712259293,-0.41624578833580017,-0.009333861991763115,-0.2132890522480011,0.4577200412750244,-0.003696982515975833},{-0.0398155115544796,-0.10430192947387695,-0.1000581830739975,-0.05521712452173233,0.07879871875047684,-0.23672164976596832,0.5974380373954773,-0.3187582492828369,-0.24783684313297272,-0.19633881747722626,0.11963117867708206,0.05874164402484894,0.3285655975341797,0.02633589133620262,0.29496148228645325,0.2520793378353119},{-0.10486965626478195,0.3129661977291107,-0.08223725855350494,0.12015088647603989,-0.26038992404937744,-0.06843272596597672,-0.10836658626794815,0.021850531920790672,0.33999454975128174,0.250835657119751,-0.33536025881767273,-0.12147919833660126,0.24273619055747986,-0.09433240443468094,-0.09440165758132935,0.19977793097496033},{-0.3520891070365906,0.2547668218612671,-0.06760507822036743,-0.3355598747730255,0.2857888638973236,-0.320237934589386,-0.36156630516052246,-0.5697343945503235,-0.10636606067419052,-0.2670821249485016,0.5878744721412659,0.1344994306564331,-0.0379401370882988,0.5325431823730469,0.019681960344314575,0.7037570476531982},{0.28197577595710754,0.15080003440380096,-0.2893766462802887,-0.0003246049745939672,-0.677266001701355,-0.6062621474266052,0.17290467023849487,-0.5941503047943115,-0.01650163345038891,-0.18359597027301788,0.3914276361465454,-0.6275099515914917,-0.5250862836837769,0.11841122061014175,0.04850530996918678,-0.3273635804653168},{0.6646391153335571,-0.9148364663124084,-0.41445744037628174,0.14271439611911774,0.18736733496189117,-0.3644765019416809,0.02949720434844494,-0.18415768444538116,-0.3837870657444,-0.08835740387439728,-0.2882571220397949,-0.37817564606666565,0.5636882185935974,-0.3796043395996094,-0.7370486259460449,-0.32681387662887573},{0.3529055714607239,0.30439621210098267,-0.18085162341594696,0.06579189747571945,0.11243275552988052,-0.13436035811901093,-0.12635405361652374,0.17727142572402954,-0.007961967960000038,0.17508606612682343,0.14909681677818298,0.19844985008239746,-0.13263195753097534,0.1202925369143486,0.019896691665053368,-0.4029926657676697},{-0.40420711040496826,0.2838274836540222,0.6253248453140259,-0.9750213027000427,0.18913301825523376,0.22525639832019806,0.16780300438404083,0.3711143732070923,0.3360000252723694,0.4658525288105011,0.49959227442741394,-0.4659755229949951,0.340973824262619,-0.2395605742931366,0.08793149888515472,-0.26857179403305054},{0.15337753295898438,-0.3370610773563385,-0.2810661494731903,0.36036601662635803,-0.18713553249835968,-0.30773457884788513,-0.04531051963567734,0.30572399497032166,0.22905108332633972,-0.1451602727174759,-0.3253780007362366,0.2788483202457428,0.3844722509384155,0.34779566526412964,-0.23570626974105835,0.6200747489929199},{0.26527026295661926,0.2939873933792114,-0.30234581232070923,0.07114008069038391,-0.1147330179810524,-0.14312699437141418,-0.2798687219619751,0.21649092435836792,-0.2190430611371994,-0.3417242765426636,-0.06511753797531128,0.0809120461344719,-0.5456209778785706,-0.13482023775577545,-0.26933392882347107,-0.19995802640914917},{0.12970663607120514,0.5681009292602539,0.3080700933933258,-0.37572839856147766,-0.3955373167991638,0.24413157999515533,-0.1156248077750206,0.01879062131047249,0.516412615776062,0.23713000118732452,-0.23082701861858368,0.15131248533725739,-0.1942598968744278,-0.3594048023223877,0.13834501802921295,-0.34081923961639404},{-0.33205723762512207,-0.05133943259716034,-0.03377119451761246,0.2296794354915619,-0.028283342719078064,-0.007505323737859726,-0.16823925077915192,-0.01736094430088997,-0.38253605365753174,-0.1297040581703186,0.22944138944149017,0.06422621756792068,-0.15955109894275665,-0.2115200012922287,-0.3741264045238495,-0.0951845571398735},{-0.27531200647354126,0.1540094017982483,-0.14315219223499298,0.013506288640201092,-0.11296994984149933,0.30304133892059326,0.3379910886287689,0.11231256276369095,0.17588602006435394,-0.2489067167043686,-0.032434552907943726,-0.09957925975322723,-0.028533345088362694,0.02970864810049534,-0.01039109192788601,-0.13659115135669708},{0.17135575413703918,-0.42275992035865784,0.1138383150100708,0.13136416673660278,-0.0025318635161966085,0.28795325756073,0.297900527715683,0.12407056987285614,-0.1379515528678894,-0.22235052287578583,-0.10384135693311691,-0.16407519578933716,-0.10464765876531601,-0.3640366196632385,0.03451512008905411,0.019579490646719933}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14866693317890167,0.31666651368141174,0.3429643213748932,-0.06225305423140526,-0.16495759785175323,0.021654415875673294,0.08081801235675812,0.24229663610458374,-0.09207718074321747,0.30911001563072205,0.4577348530292511,-0.3505460023880005,-0.09930085390806198,0.09846799075603485,0.006581800524145365,-0.030554821714758873},{-0.49826058745384216,0.23996347188949585,-0.2629198729991913,0.2696535587310791,0.34767958521842957,-0.09022411704063416,-0.30591821670532227,-0.28035593032836914,0.26208797097206116,0.30549728870391846,-0.07497136294841766,0.2032662332057953,-0.2667882442474365,0.16778992116451263,-0.26328274607658386,0.4118841886520386},{-0.37016668915748596,0.1802464723587036,-0.30952563881874084,0.062117595225572586,-0.41342809796333313,-0.26455196738243103,-0.10452796518802643,0.04120873659849167,-0.2118668258190155,0.33109593391418457,0.2044118344783783,-0.05615469813346863,0.21814408898353577,-0.3325381875038147,-0.0365549735724926,0.03956061229109764},{0.23131510615348816,-0.21950435638427734,0.0842459499835968,0.4333268702030182,-0.4622657299041748,-0.31256842613220215,0.24056801199913025,0.14178970456123352,0.2837812900543213,-0.07949211448431015,0.24518302083015442,0.10415416210889816,-0.24696023762226105,-0.07465863227844238,-0.026587020605802536,-0.35669460892677307},{-0.30910035967826843,0.02268015779554844,0.2378825843334198,-0.3428601324558258,0.1272372156381607,0.2466425597667694,-0.30265718698501587,0.26226264238357544,-0.22124548256397247,0.18055273592472076,-0.12271926552057266,-0.006177528295665979,-0.14090608060359955,0.01769559271633625,-0.2154519259929657,-0.1886032670736313},{-0.0210750550031662,-0.2110511213541031,-0.05914871394634247,-0.38439783453941345,0.3041321039199829,0.04291472211480141,-0.010061213746666908,-0.10331785678863525,-0.20647548139095306,0.35294559597969055,0.3131903409957886,-0.08735643327236176,-0.14711230993270874,0.2402532994747162,-0.08210412412881851,-0.36308035254478455},{0.20462541282176971,-0.17965133488178253,0.28415319323539734,-0.3191891312599182,-0.37091371417045593,-0.10090327262878418,-0.37421199679374695,0.34858396649360657,-0.13814851641654968,-0.2650796175003052,-0.2405376434326172,-0.027853544801473618,-0.07182557135820389,-0.06546278297901154,0.4688306450843811,-0.3868426978588104},{-0.3120642602443695,0.3877503275871277,-0.05062931403517723,0.21433351933956146,0.002704746788367629,-0.20371100306510925,-0.13266955316066742,0.08959655463695526,-0.06067890673875809,0.48729708790779114,0.11066009104251862,-0.21399761736392975,0.11659333109855652,-0.1000254824757576,0.0730501189827919,0.16460008919239044},{0.16297763586044312,0.273534893989563,-0.16833429038524628,-0.3439253866672516,0.36759743094444275,-0.2238805890083313,0.24537278711795807,-0.3594684600830078,0.043256353586912155,0.01273362711071968,0.11544421315193176,0.10792644321918488,0.014975840225815773,-0.2295227199792862,-0.10015951842069626,0.20343351364135742},{-0.17997977137565613,-0.02849384769797325,-0.2685699164867401,-0.31486281752586365,0.230327770113945,-0.44255077838897705,-0.1956138014793396,0.25434374809265137,-0.06040778011083603,0.1736324429512024,0.029006803408265114,-0.06158842518925667,-0.3798524737358093,0.005270130932331085,-0.20052459836006165,-0.35562390089035034},{-0.22656705975532532,-0.07351917028427124,-0.10023520886898041,-0.3238668441772461,-0.3188486397266388,0.006105180364102125,0.13899295032024384,-0.4636017978191376,-0.003958497662097216,-0.029650483280420303,0.13563834130764008,-0.015302974730730057,0.3356982469558716,0.030180204659700394,0.17693494260311127,0.2252551168203354},{-0.20763029158115387,-0.060066938400268555,-0.40095627307891846,0.3597671389579773,0.09835658967494965,0.08118658512830734,0.13285566866397858,0.08139513432979584,-0.3506772816181183,0.2062070369720459,-0.4020070731639862,-0.1252175271511078,-0.3390754759311676,0.3585575819015503,-0.3187822997570038,0.06967566907405853},{-0.10473226755857468,-0.43717917799949646,-0.07287422567605972,0.14030222594738007,-0.19689029455184937,-0.07584626972675323,-0.07552769035100937,0.3428167700767517,0.39960023760795593,0.08686120063066483,-0.12096063047647476,-0.24023683369159698,0.19271017611026764,-0.30536481738090515,0.1593022346496582,-0.2068667858839035},{-0.2581563889980316,-0.4741542637348175,-0.17957867681980133,-0.137945294380188,-0.4775366187095642,0.32932576537132263,-0.08244702965021133,0.1985919028520584,-0.22294563055038452,-0.32532867789268494,-0.2911204993724823,0.39114996790885925,-0.12581969797611237,0.09863638877868652,-0.25179994106292725,0.3585420250892639},{-0.34653133153915405,0.3152310848236084,-0.1877087950706482,0.10175764560699463,-0.3515162467956543,0.10728131979703903,0.06009476259350777,-0.38694438338279724,0.11699230968952179,0.15543179214000702,-0.1136164516210556,0.08902962505817413,0.25002479553222656,-0.19711773097515106,-0.3262900412082672,-0.14514297246932983},{-0.15909500420093536,-0.3657313883304596,-0.5108153223991394,0.305731862783432,0.061351921409368515,0.10300999134778976,-0.2456110566854477,0.19071908295154572,-0.41910478472709656,-0.30090463161468506,-0.3924168646335602,0.2543812096118927,-0.2506920099258423,0.2233995646238327,0.08335097134113312,0.34693917632102966}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.071866974234581,-0.09043113887310028,0.15845517814159393,-0.10312163829803467,-0.09324654936790466,0.11957313120365143,0.21031200885772705,-0.23045121133327484,-0.1961938738822937,0.26990872621536255,0.11527533084154129,0.10746615380048752,0.05234250798821449,0.13007594645023346,-0.1814916431903839,0.14671577513217926,0.13891001045703888,-0.30243799090385437,-0.1904921978712082,-0.09090960770845413,-0.15087920427322388,0.07211533188819885,-0.19105760753154755,0.3418906033039093,-0.161836639046669,-0.06003856658935547,0.11224937438964844,0.1959775686264038,-0.12254077941179276,-0.15645810961723328,0.20107559859752655,0.2416446954011917},{0.143522247672081,-0.06450430303812027,0.1624234914779663,-0.12772691249847412,-0.07708551734685898,0.2332746833562851,0.05062105506658554,-0.041618820279836655,-0.027275128290057182,-0.04572569206357002,-0.09730134904384613,0.0024371508043259382,0.35794323682785034,0.21018566191196442,0.09288488328456879,0.02193409577012062,-0.22341415286064148,-0.26147428154945374,0.10533083975315094,0.02589496038854122,0.10010142624378204,0.28752124309539795,0.2662954330444336,-0.159254789352417,0.049327779561281204,0.2766350507736206,-0.337544322013855,0.1977844089269638,-0.0005474740173667669,-0.2426304966211319,-0.08657671511173248,-0.010068312287330627},{-0.057019464671611786,-0.07976606488227844,0.22470620274543762,-0.17693939805030823,-0.13627736270427704,0.08732860535383224,-0.18702518939971924,0.21507686376571655,0.1809186339378357,0.0261097215116024,-0.19192935526371002,0.010706398636102676,0.3162889778614044,-0.28628742694854736,0.11471424996852875,-0.052923642098903656,-0.3537726104259491,0.2517527639865875,-0.2907276451587677,-0.053589772433042526,-0.050839491188526154,-0.10505016893148422,-0.020190851762890816,-0.029278798028826714,-0.03234755992889404,0.3209961950778961,-0.103999562561512,0.0958535298705101,0.21104703843593597,-0.29742470383644104,-0.14559519290924072,-0.023164130747318268},{0.14884406328201294,-0.1722830981016159,0.012208713218569756,-0.3536957800388336,0.06674642860889435,-0.1431577205657959,-0.09223444759845734,0.18159987032413483,0.046220216900110245,0.19340722262859344,0.051109153777360916,-0.09766223281621933,-0.20147719979286194,-0.014285166747868061,0.2473425269126892,-0.1975965052843094,0.03792594000697136,-0.1012282446026802,-0.14500318467617035,0.11902924627065659,-0.14928850531578064,0.12468143552541733,-0.26911410689353943,0.2476939857006073,-0.22932912409305573,0.07869727909564972,-0.05350791662931442,-0.20534107089042664,0.13053876161575317,-0.013413157314062119,0.2333308309316635,-0.1400105506181717},{0.25460633635520935,-0.05838339030742645,0.010673962533473969,0.24341613054275513,-0.30882760882377625,-0.09176389127969742,0.17573830485343933,-0.019832784309983253,0.14075089991092682,-0.16124768555164337,-0.004719470627605915,-0.08321858197450638,-0.18523459136486053,-0.13425573706626892,0.2758607864379883,0.22720269858837128,-0.035772617906332016,-0.3037801682949066,0.09580256044864655,-0.12855476140975952,-0.13848698139190674,0.23402346670627594,0.22012336552143097,0.025306737050414085,-0.09845787286758423,-0.10658220201730728,0.06968500465154648,0.23902927339076996,0.11712837964296341,0.09756838530302048,0.12156427651643753,-0.21430610120296478},{0.3173529803752899,-0.15066955983638763,0.015681864693760872,0.08400888741016388,-0.09711331129074097,-0.3019876480102539,-0.2057935744524002,-0.2842802405357361,-0.2035924345254898,0.028547098860144615,-0.022860504686832428,0.005600455682724714,-0.10863194614648819,-0.08919263631105423,-0.1953742653131485,-0.2516497075557709,0.1646784394979477,0.002022302243858576,-0.2997997999191284,0.1914985030889511,-0.07382787019014359,-0.20284204185009003,0.2223968654870987,-0.14154665172100067,-0.18129247426986694,-0.20741315186023712,-0.12684813141822815,0.09144847840070724,-0.016891784965991974,0.24659501016139984,-0.25154340267181396,0.2122318595647812},{0.166115403175354,0.10349459201097488,0.23624774813652039,-0.17046496272087097,0.24610798060894012,-0.20391705632209778,-0.2731117010116577,0.019016703590750694,0.25543636083602905,0.10933620482683182,-0.13817134499549866,0.10329902172088623,0.0405622236430645,0.30211424827575684,0.09057249873876572,-0.05627327412366867,-0.1710044890642166,0.10386079549789429,0.008774226531386375,-0.06043415144085884,-0.041609179228544235,0.1700582206249237,0.16861863434314728,0.09925849735736847,-0.23662884533405304,-0.2000606507062912,-0.25413715839385986,-0.2951013147830963,0.1180521696805954,-0.13525724411010742,0.2937513589859009,0.18846701085567474},{0.30527204275131226,-0.3477141857147217,0.08218733966350555,-0.4057943820953369,-0.345380038022995,0.28000664710998535,0.3964444696903229,0.16435422003269196,-0.06375592201948166,0.07345999032258987,0.17888373136520386,-0.1298247128725052,0.05938798561692238,0.3150128126144409,-0.0485227145254612,0.20369938015937805,0.3893571197986603,-0.27178817987442017,-0.06420459598302841,-0.36356791853904724,0.19824883341789246,0.22548207640647888,0.19573859870433807,0.13888868689537048,0.1297851800918579,0.11421322077512741,0.15619689226150513,0.2550152540206909,-0.00017116432718466967,-0.2820519506931305,0.230327770113945,0.02816302701830864},{0.07134640961885452,-0.11053107678890228,0.24304388463497162,0.25035351514816284,-0.195133775472641,-0.25850170850753784,-0.06649307161569595,0.24685008823871613,-0.21249771118164062,-0.1435788869857788,0.00011295730655547231,0.07688267529010773,0.16381710767745972,-0.3275018334388733,0.17361943423748016,-0.18597078323364258,-0.19341431558132172,0.17456935346126556,-0.2562531530857086,0.2826562821865082,-0.3784272372722626,-0.2815857231616974,-0.3063170611858368,0.2672467827796936,0.07283564656972885,0.04414767026901245,0.2979089617729187,0.1953110545873642,-0.1384899765253067,-0.3075893223285675,-0.16035445034503937,0.16807471215724945},{0.2815569341182709,0.038810085505247116,0.02143244817852974,0.22146499156951904,0.012597891502082348,0.2312435507774353,-0.08004143089056015,0.18892952799797058,-0.02035185694694519,0.033466044813394547,0.15611669421195984,0.11586707085371017,-0.03810274228453636,-0.27896738052368164,0.169664204120636,0.1680082529783249,-0.014329914003610611,-0.11534953862428665,-0.035758815705776215,0.056555263698101044,0.07046325504779816,-0.28894245624542236,0.3239133954048157,0.06307610124349594,-0.013785859569907188,0.09433136880397797,-0.36994218826293945,-0.20723207294940948,-0.10741081088781357,0.0047441949136555195,0.06881269812583923,0.1696789413690567},{-0.08307454735040665,0.10452206432819366,-0.04119732230901718,0.1935044229030609,-0.05083142966032028,0.3228733241558075,0.10552255064249039,-0.07304448634386063,0.24224022030830383,-0.3060138523578644,-0.15496961772441864,0.14219486713409424,-0.09076943248510361,0.0505138523876667,-0.2801845371723175,0.046943966299295425,0.06840531527996063,0.1496962010860443,0.12091376632452011,-0.11999807506799698,-0.25814586877822876,0.16658391058444977,0.27045366168022156,0.22111515700817108,-0.3138715326786041,0.31752708554267883,-0.19423462450504303,0.039032936096191406,-0.11370936781167984,0.14926868677139282,0.19666600227355957,0.2484893649816513},{-0.1463399976491928,0.23727530241012573,-0.11251191049814224,-0.021119100973010063,-0.20530641078948975,-0.1309548169374466,0.16129308938980103,-0.2455548197031021,-0.00778307905420661,-0.18859635293483734,-0.2597039043903351,-0.07282660901546478,0.15887367725372314,-0.31370434165000916,-0.09967046976089478,-0.36606675386428833,-0.15152712166309357,-0.019399534910917282,0.24465583264827728,-0.325819730758667,0.044233135879039764,-0.11813049018383026,0.025086896494030952,0.28553104400634766,-0.17553207278251648,0.17213791608810425,0.29748398065567017,-0.11692024767398834,-0.061385102570056915,0.29753053188323975,-0.11880698055028915,-0.22002092003822327},{-0.06465648859739304,0.2194531410932541,0.24553053081035614,-0.3431946337223053,0.30911606550216675,0.03619047626852989,-0.12053437530994415,-0.016970720142126083,0.13016095757484436,-0.3014601171016693,-0.04234277456998825,0.009639301337301731,0.23380126059055328,0.03718585893511772,0.01001494936645031,-0.035598933696746826,0.23922963440418243,-0.2723715901374817,0.35050249099731445,0.10884016752243042,-0.18273305892944336,0.21414431929588318,-0.07738681882619858,-0.1933886706829071,0.25101232528686523,-0.11048394441604614,-0.042093876749277115,-0.14628377556800842,-0.017784761264920235,-0.11677087843418121,0.2677338421344757,0.22503462433815002},{0.1383865773677826,-0.1617662012577057,-0.15027765929698944,0.1125975251197815,0.1175525039434433,0.2907908260822296,-0.08894934505224228,-0.20119012892246246,0.25249338150024414,0.050065964460372925,0.046568188816308975,0.05380687117576599,-0.23439256846904755,0.04918525740504265,-0.1561857908964157,-0.23417598009109497,0.053054455667734146,-0.059337954968214035,0.23881201446056366,0.30966538190841675,-0.20648525655269623,0.05962374061346054,-0.11453986912965775,-0.0031593262683600187,0.05354262515902519,-0.2539258897304535,-0.14552193880081177,-0.17662563920021057,-0.11741174012422562,-0.11703681200742722,0.262932151556015,-0.2616159915924072},{0.009107343852519989,0.2960587441921234,0.19673866033554077,-0.15940168499946594,-0.07064133137464523,-0.14607186615467072,0.15835781395435333,-0.06949711591005325,0.18311306834220886,0.02439918741583824,0.17814981937408447,0.1382235884666443,0.035003017634153366,0.02499925158917904,-0.07857560366392136,0.2263241857290268,-0.22859446704387665,-0.37550604343414307,-0.2217763364315033,0.15209724009037018,0.05505484342575073,-0.20819860696792603,-0.27778077125549316,-0.1850185990333557,-0.24568001925945282,0.007382625713944435,0.3053261637687683,0.0065398067235946655,-0.017385434359312057,0.14575666189193726,-0.1425236612558365,0.0626206025481224},{-0.18733128905296326,-0.18085958063602448,-0.23998086154460907,0.05746808648109436,-0.2663854658603668,-0.10728317499160767,-0.1009548082947731,-0.11035457253456116,-0.29712197184562683,-0.16510845720767975,0.08748535811901093,0.1651175171136856,-0.2562907934188843,0.26963382959365845,-0.025654641911387444,0.19219452142715454,0.04741855338215828,0.008641374297440052,0.03246207907795906,0.11595216393470764,0.14513270556926727,0.3257361054420471,0.09132517874240875,0.21800783276557922,0.10845334082841873,-0.2309575229883194,-0.13203448057174683,0.2691223621368408,0.00887040514498949,-0.23333360254764557,-0.1499779373407364,-0.1356627345085144},{-0.28569743037223816,-0.20512282848358154,-0.3350279629230499,0.07507923990488052,-0.1097358912229538,-0.07982373237609863,-0.12539851665496826,0.0829441174864769,-0.054129619151353836,0.0908464565873146,-0.25641024112701416,0.006587174721062183,0.13186529278755188,-0.06288377195596695,0.040831658989191055,0.20311252772808075,-0.1684509962797165,-0.09675347805023193,0.17078207433223724,0.10655701905488968,0.2104615420103073,-0.007115961983799934,-0.25716251134872437,0.06094611436128616,0.17490814626216888,-0.310918927192688,0.1728874295949936,-0.006054161582142115,0.059508223086595535,-0.12019145488739014,0.18872292339801788,-0.08872037380933762},{0.2533695101737976,-0.05556938424706459,0.05814451351761818,0.12971431016921997,-0.3049646317958832,-0.010190533474087715,0.15803846716880798,0.19606885313987732,-0.07418040931224823,-0.1143365427851677,0.323002427816391,-0.1657535433769226,-0.0027580412570387125,-0.032138582319021225,-0.1559358686208725,0.20805729925632477,0.005847020074725151,-0.05106721445918083,0.11500711739063263,-0.2722839117050171,0.04000633955001831,-0.3110594153404236,-0.24820247292518616,0.2574165165424347,-0.11855505406856537,-0.13491979241371155,0.1695186197757721,-0.019684869796037674,-0.1712954044342041,-0.006768318824470043,-0.08991579711437225,-0.05545932054519653},{0.3019449710845947,-0.029840709641575813,0.054686468094587326,0.06899502873420715,-0.007517172489315271,-0.1299995332956314,0.1371842473745346,-0.23404361307621002,0.2283879816532135,0.2651137411594391,0.01094895601272583,0.17706353962421417,0.23687049746513367,0.31937888264656067,-0.29794690012931824,-0.28174588084220886,-0.3071647584438324,0.014095938764512539,-0.14746218919754028,-0.3101709187030792,-0.18268536031246185,0.2796100080013275,0.0681050568819046,0.11411260068416595,-0.1533777117729187,-0.060949768871068954,-0.14151665568351746,-0.1821148842573166,0.27208271622657776,0.14539025723934174,-0.273190438747406,-0.1298752725124359},{-0.12176454812288284,0.17291656136512756,0.301230251789093,-0.06171150878071785,-0.0036525228060781956,0.050933096557855606,0.0034953877329826355,-0.3159235715866089,0.1830034852027893,0.22493375837802887,0.2031833529472351,0.20419350266456604,-0.2734641134738922,0.1939493864774704,-0.2729725241661072,0.3074769675731659,0.13984987139701843,-0.24776135385036469,0.2752830386161804,0.14115160703659058,-0.28625887632369995,0.2737007439136505,-0.3070986568927765,0.114710234105587,0.14042828977108002,0.21292732656002045,0.0867299884557724,0.09552519768476486,-0.2257383167743683,0.2614644169807434,-0.10717156529426575,0.09139109402894974},{-0.11342759430408478,-0.06184633448719978,0.07814542949199677,0.22589902579784393,0.028044939041137695,0.22768665850162506,-0.2983277440071106,-0.14780555665493011,-0.21695466339588165,-0.09473609179258347,-0.18337108194828033,-0.14608284831047058,0.050710324198007584,-0.14742489159107208,0.14586737751960754,-0.14795279502868652,0.1236937940120697,-0.013981934636831284,-0.2770707309246063,-0.228917196393013,0.09225987643003464,0.19902822375297546,-0.1360241174697876,0.3340085446834564,-0.33194538950920105,0.047394152730703354,0.07915510982275009,-0.08730995655059814,-0.0026320526376366615,-0.17881181836128235,0.3164025545120239,0.06860930472612381},{0.35174503922462463,0.00028078281320631504,0.04298633337020874,0.20036503672599792,-0.14391791820526123,0.22510400414466858,-0.060851190239191055,0.22098752856254578,0.1480877846479416,0.0877234935760498,0.0683954730629921,-0.35529816150665283,-0.26843053102493286,-0.08493304252624512,0.09486787766218185,-0.09107153117656708,0.2766093611717224,0.14729954302310944,-0.1851053386926651,-0.219924658536911,0.2783573269844055,0.2559283971786499,0.2794581651687622,0.11288636177778244,-0.08821885287761688,-0.004226580262184143,-0.10965438932180405,-0.18373966217041016,0.0651431754231453,0.05516603961586952,-0.16937203705310822,0.1276659071445465},{-0.026120217517018318,0.027571387588977814,-0.04904869198799133,-0.23921918869018555,-0.10283573716878891,-0.23925746977329254,-0.2123630791902542,-0.17690682411193848,0.010732833296060562,-0.021950699388980865,-0.24000319838523865,0.03418212756514549,-0.2478502243757248,-0.14881540834903717,0.001492828130722046,0.08093494176864624,0.26526570320129395,-0.16717888414859772,-0.3438684344291687,0.27188724279403687,-0.14304059743881226,0.24179649353027344,-0.023394817486405373,-0.05802393704652786,0.04711650311946869,0.11812618374824524,-0.056986432522535324,-0.2772757112979889,0.19689123332500458,0.2603086233139038,-0.1430753618478775,0.18572579324245453},{-0.2728000283241272,-0.035309500992298126,0.036956146359443665,-0.013275089673697948,0.0018319692462682724,0.09089231491088867,-0.19999349117279053,0.0767902061343193,-0.1848086416721344,-0.1854589432477951,0.08991149067878723,-0.1290617287158966,-0.1501367688179016,0.288582980632782,0.007318704854696989,-0.009540917351841927,0.20170274376869202,-0.23068447411060333,-0.18480348587036133,0.2823770046234131,0.014462855644524097,0.24038688838481903,-0.01581350900232792,0.03950970247387886,-0.2048943191766739,-0.13831351697444916,0.03079729713499546,0.2838026285171509,0.0029112270567566156,-0.02286474034190178,0.25284674763679504,0.2809463143348694}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.10381797701120377,0.06904710829257965,0.22766554355621338,0.022308947518467903},{0.054490938782691956,-0.05025938153266907,0.012212248519062996,0.1465686559677124},{-0.1261390596628189,0.09916046261787415,0.04933629184961319,0.10319473594427109},{0.3172701299190521,0.051497649401426315,0.08930324018001556,0.371507853269577},{-0.04861706867814064,0.0645635724067688,0.27039268612861633,0.007347829174250364},{-0.12541769444942474,0.1932448446750641,0.17357198894023895,-0.01802016608417034},{-0.2234506458044052,-0.010192200541496277,0.01708453707396984,-0.09575779736042023},{-0.2689826786518097,-0.0903342217206955,0.26873528957366943,-0.25256115198135376},{0.26410090923309326,-0.1415489912033081,-0.22168320417404175,-0.30055081844329834},{0.06403438746929169,0.22251176834106445,0.2787528336048126,-0.3079828917980194},{-0.0773327648639679,-0.11246112734079361,-0.12348379194736481,0.10407447814941406},{0.24470534920692444,-0.10969658195972443,0.004977524280548096,0.12975424528121948},{0.21934950351715088,0.25889745354652405,-0.05820509418845177,0.10017289221286774},{-0.001664995332248509,0.004693947266787291,-0.26679182052612305,0.05122795328497887},{0.10469036549329758,0.22440208494663239,0.26479193568229675,0.21954384446144104},{0.130123570561409,0.029061568900942802,0.19309982657432556,0.23210887610912323},{-0.22372275590896606,-0.09591837227344513,-0.09945175796747208,-0.19174610078334808},{-0.10680906474590302,0.09624797105789185,-0.08647755533456802,-0.0806671604514122},{-0.26547229290008545,0.1299925148487091,0.12895499169826508,0.2920624911785126},{-0.029060741886496544,0.2903880774974823,-0.1337226778268814,0.1494213342666626},{-0.1755562424659729,-0.2783570885658264,-0.12231139093637466,-0.014277664013206959},{0.2660575211048126,0.2923508584499359,0.042020998895168304,-0.19625647366046906},{0.0033741481602191925,0.14655223488807678,0.1620246171951294,0.13864150643348694},{-0.08129490911960602,0.2989714741706848,-0.02328602969646454,-0.11412107199430466},{0.00791237037628889,-0.009162717498838902,-0.055032260715961456,-0.013991836458444595},{0.23188145458698273,-0.282039076089859,-0.05415869131684303,0.025974802672863007},{-0.013310311362147331,-0.27886638045310974,-0.14374971389770508,-0.2565380036830902},{0.12655848264694214,-0.13489171862602234,0.1903011053800583,0.07678382098674774},{-0.0021090111695230007,-0.0015826019225642085,0.00020974049402866513,0.010192008689045906},{-0.3650459349155426,0.3453060984611511,0.18292734026908875,0.003026439808309078},{0.2997874617576599,-0.1331346333026886,0.1689966768026352,-0.035892684012651443},{0.08717891573905945,-0.3136197030544281,0.311431884765625,-0.19916480779647827}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09845349192619324,-0.04188496246933937,0.011083468794822693,0.037288229912519455,-0.06399509310722351,-0.11293341219425201,0.05329718813300133,0.033744532614946365,0.001350611331872642,-0.01745717227458954,-0.045088499784469604,-0.0011646015336737037,0.06085936725139618,0.040908608585596085,-0.10328062623739243,-0.009273192845284939};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.019824206829071045,0.013093926943838596,0.01639130339026451,-0.004018072504550219,0.003721343819051981,0.02034670300781727,0.02561989426612854,0.027764180675148964,0.009201133623719215,0.036999281495809555,0.03725994750857353,-0.021845223382115364,0.018942926079034805,-0.024435415863990784,-0.05129237100481987,0.014882377348840237};
static const float actor_encoder_feed_forward_0_bias[32] = {0.019288599491119385,0.010926857590675354,0.0019069407135248184,-0.0043871221132576466,0.020866718143224716,0.00402821833267808,-0.009904591366648674,0.022781088948249817,-0.037634678184986115,-0.004357818979769945,-0.022352805361151695,-0.0024395985528826714,0.007709593512117863,-0.018563909456133842,0.00867501925677061,0.051736727356910706,-0.0029729355592280626,-0.034442584961652756,0.018962731584906578,-0.013761497102677822,-0.03445020318031311,0.01033930853009224,0.05684716999530792,0.016071535646915436,-0.007070793304592371,0.029729723930358887,-0.030384430661797523,0.043640054762363434,0.023329610005021095,-0.0020996546372771263,0.01601414382457733,0.02340157888829708};
static const float action_parameterization_distribution_linear_bias[4] = {0.007439560256898403,-0.010723515413701534,0.014663318172097206,0.005051989573985338};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.045901209115982056,0.2947463095188141,-0.11290272325277328,0.1834334433078766,0.07675012946128845,0.03736580163240433,0.6221542358398438,-0.1483628898859024},{-0.1184256300330162,-0.02876628004014492,-0.25156936049461365,-0.21600741147994995,-0.4199471175670624,-0.2668144702911377,0.10859508067369461,-0.27737560868263245},{-0.1879812330007553,0.013407433405518532,0.2749081552028656,0.2521213889122009,0.21173395216464996,-0.04459843784570694,0.4340183734893799,-0.16967496275901794},{0.022109484300017357,0.08176767081022263,-0.10997609794139862,0.034575074911117554,-0.027324354276061058,-0.07876184582710266,0.3864343464374542,-0.2525927722454071},{-0.23040218651294708,-0.11755771934986115,-0.17343907058238983,-0.11568093299865723,-0.06785374134778976,0.16284097731113434,0.2620561122894287,-0.08620448410511017},{-0.2989382743835449,-0.03151633217930794,0.4891393482685089,0.2635325789451599,0.13410323858261108,-0.12426397949457169,-0.07949481904506683,-0.17508456110954285},{-0.2316357046365738,0.012315238825976849,0.5340166091918945,-0.16887903213500977,-0.17644177377223969,-0.43072471022605896,-0.0611572265625,-0.13732165098190308},{-0.26698070764541626,-0.36816397309303284,0.6397993564605713,-0.0361262783408165,-0.25062865018844604,0.21943947672843933,0.2142847627401352,-0.2611895203590393},{-0.3823719620704651,0.2813052833080292,-0.06743091344833374,0.4029363989830017,0.05481727048754692,-0.3378424644470215,0.046370893716812134,0.09441791474819183},{-0.4385499954223633,-0.3493320345878601,-0.11880937963724136,-0.20849189162254333,-0.5420886874198914,0.14493964612483978,-0.019611701369285583,0.17019902169704437},{0.07222740352153778,0.29404565691947937,0.22638972103595734,-0.03478477895259857,0.2101084142923355,0.1836022287607193,-0.1950298398733139,0.2484632283449173},{0.1153937354683876,-0.014028124511241913,0.2419803887605667,0.219784677028656,-0.2928484082221985,0.35257604718208313,0.010372866876423359,-0.20311257243156433},{0.049793343991041183,-0.36451253294944763,0.24638427793979645,-0.08477224409580231,-0.35662856698036194,-0.03770194202661514,-0.155983105301857,-0.11054830253124237},{-0.2765648365020752,-0.2902531921863556,0.3467376232147217,0.3295609951019287,-0.26460468769073486,-0.04300079867243767,-0.27787667512893677,0.22872978448867798},{0.016308797523379326,-0.2267960011959076,0.1715307980775833,-0.23912492394447327,-0.2943265736103058,-0.10104073584079742,0.23456121981143951,0.017574764788150787},{0.14284445345401764,-0.1289677917957306,0.06810874491930008,-0.24360473453998566,0.05224936455488205,0.10308532416820526,0.07907203584909439,0.4166060984134674},{-0.10071839392185211,-0.36903712153434753,-0.13249994814395905,0.12336059659719467,-0.22024433314800262,-0.12987522780895233,-0.11482822149991989,0.13407370448112488},{-0.23326033353805542,-0.3371177017688751,0.05696634575724602,0.030849013477563858,0.10034961998462677,-0.1827518194913864,0.3695889413356781,0.15268082916736603},{-0.042410191148519516,0.09633322060108185,-0.23742739856243134,0.10379951447248459,0.08312439173460007,0.2049158662557602,-0.19623726606369019,0.3366614580154419},{0.06587449461221695,-0.05814240500330925,-0.3412303924560547,0.09129508584737778,-0.0874251127243042,-0.014071118086576462,-0.27847880125045776,-0.011082973331212997},{0.002904299646615982,-0.1737896054983139,0.09298165142536163,-0.09327426552772522,0.3072075843811035,0.0694466084241867,0.03966159000992775,0.3975282609462738},{-0.07491394877433777,0.04104015603661537,-0.23517300188541412,0.2851698100566864,0.352008581161499,0.3933061361312866,0.24037383496761322,-0.30470576882362366},{-0.5293641090393066,-0.22316411137580872,0.1772206574678421,-0.1003679409623146,0.219373419880867,-0.20797549188137054,0.29959288239479065,-0.26798397302627563},{-0.2748842239379883,-0.03620951250195503,-0.08053837716579437,-0.48641732335090637,0.25386059284210205,0.09797411412000656,-0.21890735626220703,0.16228994727134705},{-0.3267340064048767,-0.19984124600887299,-0.043332718312740326,-0.04339220002293587,-0.031094511970877647,0.2503871023654938,0.3551451861858368,-0.14145077764987946},{-0.3137655556201935,0.05099707841873169,-0.39307335019111633,-0.36757367849349976,0.1739690899848938,0.09003384411334991,-0.05012461543083191,0.046238403767347336},{0.2819238007068634,0.3800622522830963,-0.3046472668647766,0.13798509538173676,0.213920459151268,0.429455429315567,-0.2154158651828766,-0.16868937015533447},{0.3335082232952118,0.24761991202831268,0.04127143695950508,0.036861907690763474,0.28502702713012695,0.2350500077009201,0.356082022190094,0.3447011709213257},{-0.17807549238204956,0.3718300759792328,0.13978208601474762,-0.027683252468705177,0.23492249846458435,0.0995151549577713,-0.2624865472316742,-0.30998465418815613},{-0.2719692885875702,-0.22079738974571228,0.067143015563488,-0.2988858222961426,-0.29960528016090393,-0.1180826798081398,0.41540592908859253,-0.08916236460208893},{0.30571281909942627,-0.2322729378938675,0.3595973551273346,-0.3464242219924927,0.0006593830185011029,0.24793440103530884,0.34304672479629517,-0.3178858458995819},{0.12284885346889496,0.422798752784729,0.43601882457733154,-0.2855461835861206,-0.3320106565952301,0.03956788033246994,0.3903851807117462,-0.03832019120454788}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.004879430402070284,0.4368778467178345,-0.1510341614484787,0.17803657054901123,-0.4361361861228943,0.3161734640598297,0.28957706689834595,0.10996627062559128},{-0.5019804239273071,-0.42671999335289,-0.36079010367393494,-0.45121657848358154,-0.47593846917152405,0.49444255232810974,0.3125797212123871,-0.35005685687065125},{0.11123703420162201,-0.1413937211036682,0.13901571929454803,0.19192197918891907,-0.009873208589851856,0.45088961720466614,-0.2690020799636841,-0.5170961618423462},{0.3932274878025055,-0.0999031662940979,0.20415258407592773,-0.027567116543650627,0.4582039415836334,0.4463726580142975,0.4982578754425049,0.3874628245830536},{0.1015302985906601,0.16765917837619781,-0.12647227942943573,-0.2148750126361847,0.06749626249074936,-0.3906668722629547,-0.526317298412323,0.5387797355651855},{0.45818576216697693,0.1364288628101349,-0.02799738012254238,-0.31980422139167786,-0.44658032059669495,-0.49069836735725403,-0.09084811061620712,0.4101099669933319},{-0.4744527041912079,-0.30440178513526917,-0.13409200310707092,-0.22521336376667023,-0.0005967094912193716,0.5243285894393921,-0.4863046705722809,0.500114917755127},{0.11786895990371704,0.054955195635557175,0.002515770262107253,0.01609559915959835,0.3137611150741577,-0.43913987278938293,0.29054462909698486,-0.3493887484073639}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.07093893736600876,0.02194920741021633,0.05927271023392677,-0.03247426822781563,-0.05929294973611832,0.021050911396741867,0.04458668828010559,-0.024375373497605324};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.01159725897014141,0.020126687362790108,-0.0663139596581459,0.06412447243928909,0.006024940870702267,-0.00619360851123929,0.05914979800581932,-0.08773037791252136};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

