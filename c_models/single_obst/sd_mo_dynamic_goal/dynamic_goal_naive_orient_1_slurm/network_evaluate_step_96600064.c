#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.31896984577178955,0.04310290142893791,-0.0015394650399684906,0.28776979446411133,0.34709736704826355,-0.2857511043548584,-0.32584184408187866,0.15585081279277802,0.31801337003707886,-0.28727585077285767,0.41624435782432556,0.0444890595972538,0.3130701184272766,0.11521073430776596,-0.30402058362960815,0.05706770345568657},{-0.3347484767436981,-0.20671537518501282,-0.2915710508823395,-0.12742634117603302,0.1861899197101593,0.33267220854759216,0.15358951687812805,0.05075996741652489,0.14711545407772064,0.20500202476978302,-0.18803419172763824,0.024971263483166695,-0.04600244387984276,0.17300233244895935,0.2801155149936676,-0.20668649673461914},{0.08648691326379776,0.31247031688690186,0.11386734992265701,0.2849849760532379,-0.12035336345434189,-0.2415025234222412,0.5235767364501953,-0.16698496043682098,-0.08904870599508286,-0.077088363468647,-0.0811237096786499,-0.04977820813655853,0.02748425118625164,0.513537585735321,-0.4291543662548065,0.017625119537115097},{0.13481126725673676,-0.12993799149990082,-0.04497912898659706,-0.12978003919124603,-0.07002011686563492,0.06471651047468185,0.0012382251443341374,-0.21268461644649506,-0.039432261139154434,-0.02825138345360756,0.5363761782646179,-0.2922317385673523,-0.23580433428287506,-0.11498772352933884,0.2724701464176178,0.0027690324932336807},{-0.23470842838287354,-0.05645613372325897,0.18711097538471222,-0.37600329518318176,0.3755490481853485,0.18124599754810333,0.1720556914806366,-0.21718713641166687,-0.20230010151863098,0.23813188076019287,-0.06980551779270172,-0.3695034980773926,-0.048501670360565186,-0.24396726489067078,0.39645761251449585,-0.037830889225006104},{-0.04678640142083168,-0.07122305780649185,-0.08016699552536011,-0.1637585312128067,0.1427740454673767,-0.2867462933063507,0.5015071034431458,-0.32278233766555786,-0.16971270740032196,-0.17519265413284302,0.2591560482978821,0.11251469701528549,0.35147014260292053,0.041066620498895645,0.3738076388835907,0.30259016156196594},{-0.26233774423599243,0.355042427778244,-0.00764881307259202,0.023133642971515656,-0.2950361371040344,-0.08218193054199219,-0.2083391398191452,-0.00913304090499878,0.27243614196777344,0.4207156300544739,-0.28101587295532227,-0.025485651567578316,0.2681877315044403,0.02908124215900898,-0.09424862265586853,0.350969523191452},{-0.11407365649938583,0.004480872768908739,-0.030465083196759224,-0.15952858328819275,0.2706495225429535,-0.23076803982257843,-0.22205305099487305,-0.4339846968650818,-0.09875878691673279,-0.3168288469314575,0.5048457980155945,0.05472007766366005,0.09000809490680695,0.21035633981227875,-0.042117878794670105,0.4645509123802185},{0.23295187950134277,0.2630077004432678,0.09180983155965805,-0.09177273511886597,-0.31936779618263245,-0.45600655674934387,0.12055672705173492,-0.4516870677471161,-0.027317794039845467,0.07126395404338837,0.24875280261039734,-0.4764675199985504,-0.3955589234828949,0.11670161783695221,0.2529418170452118,-0.24039506912231445},{0.4082478880882263,-0.6443226933479309,-0.23983797430992126,-0.005431506782770157,0.2968316376209259,-0.32632824778556824,-0.22284939885139465,-0.21794462203979492,-0.2944882810115814,0.06528402119874954,-0.26584625244140625,-0.2363804429769516,0.5824168920516968,-0.09297357499599457,-0.596998929977417,-0.09715919196605682},{0.2398402988910675,0.3668600916862488,-0.1534336358308792,0.10798086225986481,-0.03517427295446396,-0.2082783579826355,-0.26834675669670105,0.14428545534610748,-0.1046033427119255,0.28884193301200867,0.15734337270259857,0.3904590308666229,-0.13474255800247192,0.22489820420742035,0.03721321001648903,-0.2015189826488495},{-0.38236433267593384,0.23168815672397614,0.31751692295074463,-0.5454723834991455,-0.2861134707927704,0.08453596383333206,-0.11775919049978256,0.2083943486213684,0.2436831295490265,0.30196550488471985,0.3837668299674988,-0.02326531708240509,-0.044040508568286896,-0.1657559722661972,0.041145920753479004,-0.20234785974025726},{0.17889916896820068,-0.40590885281562805,-0.2772018611431122,0.4155721962451935,-0.222556933760643,-0.3357486128807068,0.04876934736967087,0.35190990567207336,0.10124824196100235,-0.12122763693332672,-0.4369943141937256,0.2241990715265274,0.5807243585586548,0.3687087297439575,-0.2851391136646271,0.6508139967918396},{0.2507210075855255,0.23759931325912476,-0.23107272386550903,0.02403959445655346,0.13627859950065613,-0.1444750726222992,-0.16125130653381348,0.2356201708316803,-0.3516809344291687,-0.25561028718948364,-0.18930640816688538,0.056874945759773254,-0.403230756521225,-0.08111000806093216,-0.3085430860519409,-0.08904226124286652},{0.08626206964254379,0.6078850030899048,0.5117178559303284,-0.5323015451431274,-0.254840612411499,0.27927157282829285,-0.052585721015930176,0.053209420293569565,0.5110341906547546,0.3959667384624481,-0.10885173827409744,0.08593118190765381,-0.07550036907196045,-0.3656725287437439,0.2154439091682434,-0.3002767860889435},{-0.3802306354045868,-0.09178728610277176,-0.08537837117910385,0.3143523931503296,-0.156706765294075,0.040448080748319626,-0.24309927225112915,-0.08760719001293182,-0.3924722373485565,-0.13393454253673553,0.3327957093715668,0.2155907154083252,-0.33299487829208374,-0.25236397981643677,-0.4399265646934509,-0.14526434242725372},{-0.35968995094299316,0.13819697499275208,-0.34730619192123413,0.02649752050638199,-0.17860159277915955,0.33685651421546936,0.3931972086429596,0.17431581020355225,0.26909339427948,-0.2648244798183441,-0.07098657637834549,-0.11884725093841553,-0.005805664230138063,0.05156546086072922,-0.05537578463554382,-0.15749292075634003},{0.16455677151679993,-0.42402559518814087,0.16294218599796295,0.21621304750442505,-0.028834929689764977,0.31858786940574646,0.318038672208786,0.14021047949790955,-0.17878201603889465,-0.2594150900840759,-0.14448434114456177,-0.06473090499639511,-0.15805253386497498,-0.40758320689201355,0.09686287492513657,0.039632100611925125}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.08558987081050873,0.2932718098163605,0.29353630542755127,-0.12916499376296997,-0.25187820196151733,0.0772269144654274,-0.06766491383314133,0.326079785823822,-0.02871687524020672,0.34028902649879456,0.4042716920375824,-0.3743526339530945,-0.05558694154024124,-0.04285143315792084,0.061615653336048126,-0.08208806812763214},{-0.530479371547699,0.2548571527004242,-0.2941969037055969,0.28194326162338257,0.3792564868927002,-0.22960807383060455,-0.3074236512184143,-0.27531418204307556,0.3236152231693268,0.30721601843833923,-0.023059776052832603,0.23514240980148315,-0.40086981654167175,0.1722615510225296,-0.30691763758659363,0.46631547808647156},{-0.3690860867500305,0.23888595402240753,-0.35098138451576233,0.04854206740856171,-0.41953355073928833,-0.2884272038936615,-0.030569666996598244,-0.009596363641321659,-0.25539326667785645,0.3536001741886139,0.28799358010292053,-0.10460536181926727,0.258630633354187,-0.2771427631378174,-0.12506814301013947,0.007109272293746471},{0.31614670157432556,-0.24369312822818756,0.10470262914896011,0.44016656279563904,-0.4260309934616089,-0.44772666692733765,0.2837071120738983,0.1152641549706459,0.28761881589889526,-0.1032775491476059,0.3411555588245392,0.09391172975301743,-0.26072773337364197,-0.018305957317352295,0.00502316327765584,-0.38924965262413025},{-0.35702046751976013,0.03621537610888481,0.26513156294822693,-0.3337276577949524,0.13124719262123108,0.3726651668548584,-0.27300965785980225,0.2509019076824188,-0.22822147607803345,0.19502344727516174,-0.0458427257835865,-0.035406578332185745,-0.13961158692836761,-0.008016444742679596,-0.2042580395936966,-0.1788417398929596},{0.055812347680330276,-0.24659593403339386,0.02438228949904442,-0.3403101861476898,0.2943434417247772,0.08631767332553864,-0.006628421600908041,-0.09496191889047623,-0.21510884165763855,0.3444496691226959,0.31969165802001953,-0.077446348965168,-0.20813365280628204,0.2427385300397873,-0.0493900328874588,-0.34401756525039673},{0.2557523548603058,-0.12484027445316315,0.3531375825405121,-0.2892291247844696,-0.35380786657333374,-0.008430899120867252,-0.35775065422058105,0.3493395745754242,-0.10384025424718857,-0.2562851011753082,-0.25090980529785156,-0.029450861737132072,-0.059703562408685684,-0.09232740849256516,0.45797020196914673,-0.35348960757255554},{-0.24234576523303986,0.34329962730407715,-0.06573449820280075,0.3116372525691986,-0.01476286444813013,-0.266131728887558,-0.11024527251720428,0.15961317718029022,-0.06997326761484146,0.4453105032444,0.1751466542482376,-0.1941678375005722,-0.06387845426797867,-0.07144791632890701,0.04756525903940201,0.15919148921966553},{0.08315429091453552,0.2709287106990814,-0.17111019790172577,-0.37575235962867737,0.36214473843574524,-0.20967790484428406,0.12233772873878479,-0.3318173289299011,0.15269647538661957,0.03037424199283123,0.10202550143003464,0.16525688767433167,-0.036497704684734344,-0.36145442724227905,-0.038457173854112625,0.24157758057117462},{-0.27917417883872986,0.00689111091196537,-0.34649455547332764,-0.31484419107437134,0.23878462612628937,-0.4201660752296448,-0.16566139459609985,0.2682797908782959,-0.1572086364030838,0.24449701607227325,-0.05506376549601555,-0.10586045682430267,-0.3586170971393585,0.009989534504711628,-0.29390326142311096,-0.3329879939556122},{-0.22805987298488617,-0.07960903644561768,-0.06665504723787308,-0.3178526759147644,-0.3162660002708435,-0.056069888174533844,0.2213488072156906,-0.5265358686447144,-0.011065196245908737,-0.043487798422575,0.23250563442707062,-0.033450160175561905,0.43958866596221924,0.1017240434885025,0.18616871535778046,0.22268785536289215},{-0.13423945009708405,-0.06775981187820435,-0.39554327726364136,0.33029705286026,0.08843643963336945,-0.08336563408374786,0.19122314453125,0.09565690159797668,-0.39809104800224304,0.17434866726398468,-0.25740885734558105,-0.1600334495306015,-0.39231860637664795,0.46344193816185,-0.31981855630874634,0.09881479293107986},{-0.18548503518104553,-0.4607938528060913,-0.13181070983409882,0.16775134205818176,-0.21380610764026642,-0.09636363387107849,-0.12777496874332428,0.4323742687702179,0.44053158164024353,0.05397781729698181,-0.06644106656312943,-0.23112724721431732,0.14425542950630188,-0.36794763803482056,0.1340135931968689,-0.20101894438266754},{-0.2977088987827301,-0.4466230869293213,-0.19722220301628113,-0.10111990571022034,-0.44825494289398193,0.42141643166542053,-0.11016868054866791,0.2297980785369873,-0.156265988945961,-0.32254067063331604,-0.33528071641921997,0.41845428943634033,-0.24554646015167236,0.01789480447769165,-0.27788040041923523,0.39051756262779236},{-0.40544435381889343,0.34505054354667664,-0.19960638880729675,0.09890475124120712,-0.40446555614471436,0.33280596137046814,-0.05446518957614899,-0.3532169461250305,0.13177016377449036,0.2157340943813324,-0.26378607749938965,0.0981726199388504,0.29243654012680054,-0.3404254913330078,-0.32892072200775146,-0.16005894541740417},{-0.13645589351654053,-0.39833787083625793,-0.5181823372840881,0.2857080399990082,-0.03722679242491722,0.13708901405334473,-0.3491285443305969,0.25486433506011963,-0.39493227005004883,-0.3256154954433441,-0.4087773561477661,0.23859786987304688,-0.18717963993549347,0.13169024884700775,0.14229904115200043,0.2699052095413208}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11694912612438202,-0.08745575696229935,0.11810532212257385,-0.14822329580783844,-0.1153726801276207,0.07536057382822037,0.2093094438314438,-0.21281643211841583,-0.11118746548891068,0.2630770802497864,0.14536356925964355,0.1287928968667984,0.04794630780816078,0.16718463599681854,-0.2151428461074829,0.13826994597911835,0.14299672842025757,-0.3192298412322998,-0.2517490088939667,-0.12007647007703781,-0.10738055408000946,0.06938829272985458,-0.24817880988121033,0.32282376289367676,-0.1338549554347992,-0.006965795997530222,0.15680326521396637,0.1865406483411789,-0.2563445270061493,-0.2194223254919052,0.20220741629600525,0.30550190806388855},{0.19986480474472046,-0.012377060018479824,0.2196773737668991,-0.06741180270910263,-0.08523152023553848,0.24393783509731293,0.020121542736887932,-0.05417335405945778,-0.12449587136507034,-0.0754862055182457,-0.07621974498033524,0.011341278441250324,0.37524285912513733,0.19221098721027374,0.16150371730327606,0.09583614021539688,-0.25409039855003357,-0.3201816976070404,0.15862631797790527,0.05252819135785103,0.09100809693336487,0.2292446494102478,0.2939439117908478,-0.20121923089027405,0.015221669338643551,0.28733107447624207,-0.35806912183761597,0.21515534818172455,0.1523948311805725,-0.20296987891197205,-0.0879514068365097,-0.024054566398262978},{-0.09596817940473557,-0.020348194986581802,0.18944604694843292,-0.1553412824869156,-0.20333744585514069,-0.011197168380022049,-0.24680574238300323,0.18618087470531464,0.24265988171100616,-0.033145032823085785,-0.17212550342082977,0.09444838017225266,0.32948651909828186,-0.21511885523796082,0.09372659027576447,-0.01073059719055891,-0.39299890398979187,0.20240001380443573,-0.34362274408340454,-0.0682561993598938,-0.014249603264033794,-0.1298324018716812,-0.0712680071592331,-0.10665879398584366,0.002128399908542633,0.4124828279018402,-0.047606460750103,0.13286584615707397,0.29994961619377136,-0.39258331060409546,-0.1342523992061615,0.027321267873048782},{0.15810441970825195,-0.24549651145935059,0.02241676114499569,-0.4053727388381958,0.140776589512825,-0.08878277242183685,-0.017867764458060265,0.25711360573768616,0.056340962648391724,0.23631301522254944,0.07822888344526291,-0.16943910717964172,-0.24555733799934387,-0.09802941232919693,0.24075864255428314,-0.24232766032218933,0.09021546691656113,-0.08584968745708466,-0.16267052292823792,0.06426644325256348,-0.11872739344835281,0.12587085366249084,-0.24999289214611053,0.2860325872898102,-0.2689356505870819,0.03612513467669487,-0.041370052844285965,-0.236921489238739,0.010175450704991817,0.03601738065481186,0.2376081496477127,-0.11627782136201859},{0.2696855366230011,-0.03524712473154068,0.0349857360124588,0.2569580674171448,-0.2662752866744995,-0.08108636736869812,0.17002876102924347,-0.025344770401716232,0.13444846868515015,-0.1728438138961792,-0.02430640533566475,-0.07010091096162796,-0.18905462324619293,-0.1579166203737259,0.30662840604782104,0.28099939227104187,-0.07130078971385956,-0.32544925808906555,0.14391760528087616,-0.11256574839353561,-0.1495199203491211,0.24670732021331787,0.2507215440273285,0.04535112902522087,-0.10878053307533264,-0.11380260437726974,0.0016674979124218225,0.2520807683467865,0.2455369234085083,0.11486835032701492,0.12323841452598572,-0.24354709684848785},{0.2663251459598541,-0.15604442358016968,0.029918810352683067,0.06443757563829422,-0.18048594892024994,-0.3407689034938812,-0.20295090973377228,-0.31973889470100403,-0.22041557729244232,-0.0176362507045269,0.018986761569976807,-0.014409760944545269,-0.11707129329442978,-0.01148504763841629,-0.23439888656139374,-0.2877063751220703,0.19658903777599335,0.017985908314585686,-0.30176034569740295,0.23635253310203552,-0.023284494876861572,-0.25927475094795227,0.18527930974960327,-0.16950437426567078,-0.12167177349328995,-0.23492516577243805,-0.10130570083856583,0.08301610499620438,0.09239567071199417,0.23510922491550446,-0.3213943839073181,0.17121858894824982},{0.1799616664648056,0.09100084751844406,0.26080116629600525,-0.14492252469062805,0.2533547580242157,-0.20070695877075195,-0.29372698068618774,-0.007545289117842913,0.27872949838638306,0.13048715889453888,-0.13930919766426086,0.11876187473535538,0.0727534070611,0.315922349691391,0.1311459094285965,-0.04279429093003273,-0.22582663595676422,0.130081444978714,0.014008891768753529,-0.0391000434756279,-0.07351406663656235,0.20784121751785278,0.1862896829843521,0.13259531557559967,-0.29329511523246765,-0.23367691040039062,-0.2749156355857849,-0.3491131663322449,0.05073855072259903,-0.11237946897745132,0.26363009214401245,0.1392240971326828},{0.3268781900405884,-0.4372340142726898,0.045631758868694305,-0.48852336406707764,-0.3014061450958252,0.3387067914009094,0.48124393820762634,0.2699567377567291,-0.05468219518661499,0.13048332929611206,0.19878384470939636,-0.19749639928340912,-0.0033381604589521885,0.252906858921051,-0.09527169167995453,0.14153149724006653,0.5068261623382568,-0.2537330985069275,-0.10416702926158905,-0.43276363611221313,0.23783737421035767,0.2261665165424347,0.17561806738376617,0.12933237850666046,0.161474347114563,0.11169223487377167,0.22190679609775543,0.2741048038005829,-0.1384546011686325,-0.2636837661266327,0.2722938358783722,0.1269948035478592},{0.027265695855021477,-0.05076952651143074,0.20804233849048615,0.28258341550827026,-0.22082224488258362,-0.34784626960754395,-0.09669899195432663,0.2242787480354309,-0.18257923424243927,-0.2540861666202545,0.05702030286192894,0.14977578818798065,0.13704456388950348,-0.29700198769569397,0.136651411652565,-0.15084347128868103,-0.2295740395784378,0.14245092868804932,-0.2744571566581726,0.27377083897590637,-0.3097657561302185,-0.32756465673446655,-0.31432613730430603,0.21511496603488922,0.11889537423849106,0.1168081983923912,0.3037315905094147,0.23448722064495087,-0.13981151580810547,-0.34202840924263,-0.14275208115577698,0.15385976433753967},{0.40979382395744324,0.006574984174221754,0.026935169473290443,0.20977357029914856,0.09347064048051834,0.30249902606010437,-0.05673999339342117,0.2610437273979187,-0.08835906535387039,0.1116374135017395,0.08670976012945175,0.09822215884923935,-0.07338965684175491,-0.3993934094905853,0.2135409414768219,0.21539752185344696,0.012009618803858757,-0.14787127077579498,-0.01629635877907276,0.01484222523868084,0.01825498230755329,-0.26267537474632263,0.39166128635406494,0.07873566448688507,-0.10497068613767624,0.09127716720104218,-0.391244500875473,-0.17330756783485413,0.035815976560115814,0.05797828733921051,0.14733119308948517,0.23370064795017242},{-0.0777830109000206,0.1092567890882492,-0.06941457837820053,0.22397635877132416,-0.07909964770078659,0.29214558005332947,0.06829514354467392,-0.09062216430902481,0.278626412153244,-0.3002728521823883,-0.16769278049468994,0.18285998702049255,-0.07240016013383865,0.05462868884205818,-0.27608686685562134,0.05052660033106804,0.04379303380846977,0.1504075527191162,0.08494295924901962,-0.13210369646549225,-0.2775525450706482,0.18937590718269348,0.2506691813468933,0.21436245739459991,-0.3402808606624603,0.35505616664886475,-0.14964476227760315,-0.002398743061348796,-0.10906734317541122,0.13217872381210327,0.20736250281333923,0.2547958195209503},{-0.24383214116096497,0.30181488394737244,-0.08468523621559143,-0.004223472438752651,-0.2677452266216278,-0.21375791728496552,0.13818378746509552,-0.3356119394302368,-0.016329944133758545,-0.2882068157196045,-0.19985847175121307,-0.055386483669281006,0.1849653273820877,-0.2161330282688141,-0.13292239606380463,-0.3692529499530792,-0.1830458790063858,-0.006114969030022621,0.29322612285614014,-0.2504192590713501,0.08550073951482773,-0.167112335562706,-0.003732156241312623,0.2972058653831482,-0.11386869847774506,0.1517684906721115,0.2655792236328125,-0.12249164283275604,-0.07869930565357208,0.27495384216308594,-0.20262277126312256,-0.3545532524585724},{-0.032787106931209564,0.2970225512981415,0.2734188139438629,-0.2735169529914856,0.30471858382225037,0.020342202857136726,-0.15112122893333435,-0.03621552139520645,0.09384650737047195,-0.3158555328845978,-0.05155535042285919,0.05921788513660431,0.24659687280654907,0.046322938054800034,0.056922797113657,-0.00011458894732641056,0.18520236015319824,-0.3062492609024048,0.3612779974937439,0.09424915909767151,-0.1907208263874054,0.16800470650196075,-0.04905924201011658,-0.26065704226493835,0.2209261953830719,-0.08030141890048981,-0.04700600728392601,-0.11031097173690796,0.07781325280666351,-0.11308595538139343,0.29462364315986633,0.2582685649394989},{0.08320284634828568,-0.24473266303539276,-0.1959385722875595,0.07512223720550537,0.07088298350572586,0.2899463176727295,-0.12706604599952698,-0.2770504355430603,0.3622409701347351,0.08875470608472824,0.0029426878318190575,0.034649088978767395,-0.1801949143409729,0.10036058723926544,-0.19269073009490967,-0.3120996057987213,0.05336040258407593,0.01477928925305605,0.1725824922323227,0.36553508043289185,-0.26008719205856323,0.17653237283229828,-0.1678532063961029,0.094170480966568,0.056240472942590714,-0.3066529631614685,-0.1440262496471405,-0.307964026927948,-0.12191449850797653,-0.14854635298252106,0.2103884220123291,-0.34638822078704834},{-0.10001714527606964,0.3381288945674896,0.1066727489233017,-0.1898103952407837,-0.15513312816619873,-0.23881250619888306,0.14099393784999847,-0.10224278271198273,0.29021885991096497,-0.0568973608314991,0.24278315901756287,0.19584347307682037,0.003478534519672394,0.09453636407852173,-0.17882730066776276,0.17427779734134674,-0.19936470687389374,-0.38328438997268677,-0.31029435992240906,0.11610132455825806,0.13876119256019592,-0.25816473364830017,-0.34854820370674133,-0.232418954372406,-0.1717204749584198,0.10369275510311127,0.3757851719856262,0.0018313286127522588,-0.1402912735939026,0.04640395566821098,-0.14417961239814758,0.10580050945281982},{-0.20180794596672058,-0.16307981312274933,-0.24242053925991058,0.09983696788549423,-0.2666628658771515,-0.13898035883903503,-0.14183162152767181,-0.15712875127792358,-0.2959578335285187,-0.21327291429042816,0.11801225692033768,0.2017628252506256,-0.25724586844444275,0.2525220513343811,-0.026195485144853592,0.1984044313430786,0.01980336382985115,-0.009361579082906246,0.026993438601493835,0.11396904289722443,0.16282247006893158,0.3153313994407654,0.10195962339639664,0.20959484577178955,0.10154996067285538,-0.2224157750606537,-0.13532716035842896,0.26952168345451355,-0.012371775694191456,-0.22877034544944763,-0.12342194467782974,-0.1983368992805481},{-0.2996422052383423,-0.22517819702625275,-0.39645323157310486,0.07478208839893341,-0.12099103629589081,-0.08362669497728348,-0.12689737975597382,0.09083200246095657,-0.025225309655070305,0.10017228126525879,-0.24875418841838837,0.025914449244737625,0.1271328628063202,-0.09991328418254852,0.01984427496790886,0.18684691190719604,-0.12996181845664978,-0.14731848239898682,0.13287658989429474,0.05981510877609253,0.21006907522678375,0.013720247894525528,-0.28351977467536926,0.051270462572574615,0.2521628439426422,-0.26662585139274597,0.1936308592557907,0.03159177303314209,0.07660042494535446,-0.17603997886180878,0.2513601779937744,-0.04970118775963783},{0.2678782045841217,-0.06672889739274979,0.054969023913145065,0.09099163860082626,-0.2719882130622864,0.016080819070339203,0.1814015954732895,0.24698205292224884,-0.10161634534597397,-0.10023416578769684,0.3093368709087372,-0.2048945128917694,-0.04557831957936287,-0.08735062181949615,-0.15078574419021606,0.22127127647399902,0.03592190891504288,-0.07812405377626419,0.13349097967147827,-0.2987430989742279,0.03797462582588196,-0.3071259558200836,-0.22390465438365936,0.2636794149875641,-0.13261911273002625,-0.14160136878490448,0.16706734895706177,-0.010813544504344463,-0.1680920571088791,-0.0005823972169309855,-0.10012742131948471,-0.011098798364400864},{0.3302876353263855,-0.06686356663703918,0.07429350912570953,0.07052091509103775,-0.007914599031209946,-0.09522857517004013,0.15399211645126343,-0.23880472779273987,0.24062389135360718,0.3129482865333557,-0.015064379200339317,0.17165791988372803,0.2694607377052307,0.3227604329586029,-0.28694072365760803,-0.30649447441101074,-0.3004470467567444,0.05220770090818405,-0.15838618576526642,-0.29672059416770935,-0.20943322777748108,0.3093647062778473,0.0631260946393013,0.14909765124320984,-0.15145085752010345,-0.08019432425498962,-0.14788608253002167,-0.18721415102481842,0.26429787278175354,0.16845475137233734,-0.251371294260025,-0.14507798850536346},{-0.1256137639284134,0.12377486377954483,0.24058029055595398,-0.09755067527294159,-0.04864642024040222,0.0476604588329792,-0.005949180107563734,-0.30971407890319824,0.23110806941986084,0.27066275477409363,0.15142983198165894,0.21024557948112488,-0.2703593075275421,0.1800588071346283,-0.3121059238910675,0.2547082304954529,0.18517939746379852,-0.24470089375972748,0.20897150039672852,0.11282671988010406,-0.3093597888946533,0.32024097442626953,-0.3445470929145813,0.14287228882312775,0.2292427122592926,0.24905741214752197,0.13812758028507233,0.09814073145389557,-0.1992974430322647,0.2070564180612564,-0.059981659054756165,0.14297421276569366},{-0.1589287370443344,-0.058983370661735535,-0.04675673320889473,0.24322088062763214,-0.03593120723962784,0.15089716017246246,-0.36963459849357605,-0.19641681015491486,-0.11199232190847397,-0.10974223911762238,-0.19092585146427155,-0.08553414046764374,0.07470816373825073,-0.13558386266231537,0.08179070800542831,-0.1988815814256668,0.1638534963130951,-0.05265282094478607,-0.3652637302875519,-0.25759273767471313,0.09817726165056229,0.2122911661863327,-0.23241937160491943,0.2999593913555145,-0.2236497551202774,0.14599139988422394,0.14918707311153412,-0.06243652105331421,0.1424461454153061,-0.3026042580604553,0.3974168598651886,0.1052490696310997},{0.30647748708724976,-0.020051436498761177,0.055553045123815536,0.17068250477313995,-0.22153714299201965,0.18612751364707947,-0.039020683616399765,0.21163204312324524,0.1625501960515976,0.07142794877290726,0.07449104636907578,-0.3788851201534271,-0.27726104855537415,-0.005508428905159235,0.05351780354976654,-0.14951364696025848,0.31539714336395264,0.21375501155853271,-0.2140762358903885,-0.20033493638038635,0.32321447134017944,0.22567860782146454,0.24402497708797455,0.11634743958711624,-0.0224123727530241,0.0038035353645682335,-0.05799918994307518,-0.21359871327877045,0.23337601125240326,0.060114484280347824,-0.2303398996591568,0.11545786261558533},{-0.033849213272333145,0.01334486436098814,-0.07145848870277405,-0.271018385887146,-0.10383046418428421,-0.2387077510356903,-0.2117098569869995,-0.15624073147773743,0.009193986654281616,-0.01849120855331421,-0.2565222978591919,0.008787689730525017,-0.2726184129714966,-0.1716478019952774,-0.00987175665795803,0.07786181569099426,0.2934723496437073,-0.18168871104717255,-0.3496306240558624,0.2611052393913269,-0.14596611261367798,0.25453466176986694,-0.01876378431916237,-0.04793423041701317,0.0661110132932663,0.12192551046609879,-0.04710221290588379,-0.2843174934387207,0.2197224497795105,0.24779564142227173,-0.15804454684257507,0.21321424841880798},{-0.2659975290298462,0.011645236983895302,0.07363065332174301,0.01822596974670887,0.06831098347902298,0.09692142903804779,-0.1854347139596939,0.10000023245811462,-0.22149214148521423,-0.22370967268943787,0.1483033299446106,-0.11929883807897568,-0.17540130019187927,0.25870975852012634,0.028217952698469162,0.031040972098708153,0.18915955722332,-0.26778551936149597,-0.13166935741901398,0.26151177287101746,0.04986409842967987,0.18689990043640137,-0.005725271999835968,-0.0033711979631334543,-0.2904857099056244,-0.142267107963562,-0.00022715872910339385,0.32703784108161926,0.020787913352251053,-3.4837634302675724e-05,0.27479100227355957,0.28219878673553467}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.05157528072595596,0.21498623490333557,0.44248732924461365,-0.11505769193172455},{0.11713951826095581,-0.09444821625947952,0.011280247941613197,0.34591466188430786},{-0.17852656543254852,0.13867971301078796,0.14430896937847137,0.18142355978488922},{0.42775991559028625,0.08356539160013199,0.058213915675878525,0.5241300463676453},{-0.060312796384096146,0.12671762704849243,0.3546062409877777,0.03499186784029007},{-0.1413315087556839,0.2729019522666931,0.28260537981987,-0.09880968928337097},{-0.4154198467731476,-0.026893582195043564,0.07045669108629227,-0.21975907683372498},{-0.4078110456466675,-0.12779171764850616,0.4595491886138916,-0.32820752263069153},{0.3396962285041809,-0.13628554344177246,-0.3189127445220947,-0.4332350790500641},{0.04319433867931366,0.3034830689430237,0.35557737946510315,-0.553663432598114},{-0.27291935682296753,-0.25190362334251404,-0.1511543095111847,0.10450361669063568},{0.48077118396759033,-0.19036506116390228,-0.05337007716298103,0.2590788006782532},{0.291251003742218,0.2974473237991333,-0.052906546741724014,0.18730683624744415},{-0.02864166349172592,0.01531490869820118,-0.32137438654899597,0.08047986030578613},{0.12238523364067078,0.326664537191391,0.4507744610309601,0.3477485179901123},{0.16821306943893433,0.0008402732782997191,0.3184628188610077,0.26426494121551514},{-0.3222641050815582,-0.14620505273342133,-0.10056671500205994,-0.3390544652938843},{-0.14624062180519104,0.2129344642162323,-0.16116021573543549,-0.08904991298913956},{-0.3118938207626343,0.282379686832428,0.22204914689064026,0.39855968952178955},{-0.037211496382951736,0.37770316004753113,-0.2054862380027771,0.22568757832050323},{-0.2973955273628235,-0.41535887122154236,-0.12937474250793457,0.021081484854221344},{0.3689274489879608,0.44207513332366943,0.03181909769773483,-0.3396536409854889},{-0.002871375298127532,0.23488473892211914,0.24209143221378326,0.2281646877527237},{-0.07850515097379684,0.39735284447669983,-0.05520707741379738,-0.24513958394527435},{0.01526973769068718,-0.08335806429386139,-0.12524937093257904,-0.017174234613776207},{0.3495796322822571,-0.47631460428237915,-0.041951924562454224,0.01735970564186573},{-0.03579256683588028,-0.42301514744758606,-0.21552278101444244,-0.3285449147224426},{0.14899058640003204,-0.24008475244045258,0.24135233461856842,0.17630328238010406},{0.05854927375912666,-0.05809451639652252,0.08621987700462341,0.049127597361803055},{-0.42985451221466064,0.4503125250339508,0.21182239055633545,-0.044701747596263885},{0.38195013999938965,-0.18171492218971252,0.23262356221675873,-0.06043536961078644},{0.08552008122205734,-0.4805946350097656,0.4157930314540863,-0.26230743527412415}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.04414888471364975,-0.013155856169760227,0.016694268211722374,0.04016578942537308,-0.08761180192232132,-0.09041628241539001,0.029247095808386803,0.034951694309711456,0.09369738399982452,-0.03172111138701439,-0.03778347745537758,-0.037417564541101456,0.0417497344315052,-0.0012575245928019285,-0.04515020176768303,-0.026887807995080948};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.02888476476073265,0.006015770137310028,0.0034626617562025785,0.020888011902570724,0.016145262867212296,-0.006405436433851719,0.014953011646866798,0.007106537465006113,0.020507721230387688,0.01809738203883171,0.029798874631524086,-0.003161853179335594,0.056163493543863297,-0.0355059914290905,-0.028613030910491943,-0.0015413915971294045};
static const float actor_encoder_feed_forward_0_bias[32] = {0.01903636008501053,0.005610209424048662,0.018795592710375786,0.0024444526061415672,0.019496411085128784,0.006275794003158808,0.009984790347516537,0.015136740170419216,-0.02568773739039898,-0.0022064370568841696,0.0014678945299237967,0.0025727935135364532,0.01808466948568821,0.0055113076232373714,0.001389494282193482,0.030024511739611626,-2.9547696613008156e-05,-0.00344563159160316,0.01998227648437023,-0.00585736520588398,-0.020710013806819916,-0.004665994551032782,0.03429501876235008,0.01377307903021574,-0.013083751313388348,0.01854449138045311,-0.025486119091510773,0.033815644681453705,-0.0019238058011978865,0.01593426801264286,0.0207547415047884,-0.003923506010323763};
static const float action_parameterization_distribution_linear_bias[4] = {-0.006567721720784903,0.0002692963171284646,0.006478267256170511,0.005427101626992226};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.1033172756433487,0.22972159087657928,-0.2013024091720581,0.22213806211948395,0.10366024076938629,0.062202032655477524,0.34582310914993286,-0.025698350742459297},{-0.31280258297920227,-0.04352700710296631,-0.33421289920806885,-0.19512957334518433,-0.3891690671443939,-0.25097236037254333,-0.03353484347462654,-0.23194853961467743},{-0.3218776285648346,0.030076343566179276,0.1969221979379654,0.2645263373851776,0.24358627200126648,-0.03985261172056198,0.3885571360588074,-0.16630567610263824},{-0.01952965557575226,0.11021856218576431,-0.22050048410892487,0.019679786637425423,0.027258021757006645,-0.057974886149168015,0.3593778610229492,-0.24988611042499542},{-0.3453406095504761,-0.12128062546253204,-0.2792447805404663,-0.12515278160572052,-0.01095604244619608,0.18727025389671326,0.20524731278419495,-0.057128600776195526},{-0.36653321981430054,-0.028451545163989067,0.33736711740493774,0.23920978605747223,0.20451410114765167,-0.09513317793607712,-0.1150675117969513,-0.14557629823684692},{-0.2883952260017395,0.026144327595829964,0.35970833897590637,-0.22070065140724182,-0.08066640049219131,-0.38489800691604614,-0.09291623532772064,-0.10698065161705017},{-0.29435020685195923,-0.3304283022880554,0.42193102836608887,-0.13120391964912415,-0.1069420725107193,0.3029206395149231,0.19213685393333435,-0.23647992312908173},{-0.3437959551811218,0.3325508236885071,-0.2464827299118042,0.30075356364250183,0.22205638885498047,-0.21270018815994263,0.04700372740626335,0.14170673489570618},{-0.3788742125034332,-0.27392449975013733,-0.19822460412979126,-0.24986276030540466,-0.461863249540329,0.19304031133651733,-0.000882575404830277,0.1742880940437317},{0.1081327497959137,0.37846478819847107,0.19153741002082825,-0.03614460304379463,0.22066771984100342,0.1745564490556717,-0.17137698829174042,0.22914958000183105},{0.15339134633541107,0.05578264221549034,0.2568909823894501,0.2621373236179352,-0.3351197838783264,0.2922426760196686,0.03362876921892166,-0.2222568690776825},{0.08078628778457642,-0.323468416929245,0.2725200057029724,-0.025584017857909203,-0.40972816944122314,-0.11056972295045853,-0.1437811255455017,-0.10087782889604568},{-0.22296306490898132,-0.2520063519477844,0.3380795121192932,0.36982646584510803,-0.291068971157074,-0.08917704969644547,-0.26254498958587646,0.2478564977645874},{0.0738447904586792,-0.1595047414302826,0.14386975765228271,-0.21975922584533691,-0.30564966797828674,-0.1369648575782776,0.3034784197807312,0.01450631208717823},{0.2085229903459549,0.008580324240028858,0.022384081035852432,-0.240580216050148,0.04779776185750961,0.05883569270372391,0.20518751442432404,0.36131012439727783},{-0.01352455373853445,-0.29506051540374756,-0.17041970789432526,0.1374998837709427,-0.2228042632341385,-0.1540648341178894,-0.09424007683992386,0.13756519556045532},{-0.18097177147865295,-0.33506661653518677,0.024507194757461548,0.07622860372066498,0.10817987471818924,-0.20862530171871185,0.35499992966651917,0.2092428058385849},{-0.00923632737249136,0.0747302994132042,-0.2752741277217865,0.1539655327796936,0.10406116396188736,0.18104717135429382,-0.23912955820560455,0.41130387783050537},{0.11340930312871933,-0.05147333815693855,-0.39217323064804077,0.1290808618068695,-0.05548033118247986,-0.038248464465141296,-0.31428682804107666,0.04364830255508423},{0.051887933164834976,-0.13023149967193604,0.04101785644888878,-0.06376546621322632,0.3467192053794861,0.042898692190647125,-0.0010930912103503942,0.43036940693855286},{0.011403433047235012,0.13665425777435303,-0.2726558744907379,0.3316182494163513,0.3649666905403137,0.3291592299938202,0.2582693099975586,-0.316937655210495},{-0.43393635749816895,-0.1183362528681755,0.17119799554347992,-0.003014722838997841,0.19254328310489655,-0.31680551171302795,0.33136382699012756,-0.29697558283805847},{-0.21909795701503754,0.02827247977256775,-0.05547024682164192,-0.3173372149467468,0.18539762496948242,-0.05568956211209297,-0.23739874362945557,0.16509279608726501},{-0.311721533536911,-0.18052025139331818,0.04477917030453682,0.09911996126174927,-0.16075967252254486,0.06897955387830734,0.37376466393470764,-0.13962805271148682},{-0.2931118905544281,0.06875064969062805,-0.36824676394462585,-0.2984224259853363,0.1277044117450714,-0.003879869356751442,-0.026782657951116562,0.06736765056848526},{0.2472432255744934,0.4007450342178345,-0.30707359313964844,0.16916386783123016,0.20515894889831543,0.3813535273075104,-0.24042150378227234,-0.14344929158687592},{0.28542178869247437,0.2693496346473694,0.04815584048628807,0.06647654622793198,0.2728109359741211,0.19472621381282806,0.3194805681705475,0.37032294273376465},{-0.22950361669063568,0.40651223063468933,0.17196127772331238,0.013459150679409504,0.19149133563041687,0.0293052326887846,-0.278717041015625,-0.3097441792488098},{-0.314897745847702,-0.2056913673877716,0.09565863013267517,-0.2417534440755844,-0.3436008095741272,-0.18736538290977478,0.37067466974258423,-0.06960157305002213},{0.26939231157302856,-0.24732600152492523,0.3425936698913574,-0.3029397130012512,-0.005756656639277935,0.21673402190208435,0.2394159436225891,-0.2530773878097534},{0.08747805655002594,0.37361037731170654,0.38512709736824036,-0.22813577950000763,-0.2999557852745056,0.03100421279668808,0.2210935652256012,0.08567515015602112}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.00473215663805604,0.4756166338920593,-0.20124146342277527,0.21142660081386566,-0.41968581080436707,0.3210560381412506,0.34450843930244446,0.08193057030439377},{-0.5332385897636414,-0.3984774351119995,-0.4079437553882599,-0.47938233613967896,-0.5380196571350098,0.48559442162513733,0.3956772983074188,-0.3979203999042511},{0.09859810769557953,-0.19995924830436707,0.15466471016407013,0.17671935260295868,-0.029144207015633583,0.46101659536361694,-0.3291643261909485,-0.4779832661151886},{0.5206269025802612,0.043995171785354614,0.08932087570428848,0.03570912405848503,0.5455931425094604,0.3939379155635834,0.43450528383255005,0.42475640773773193},{0.0768386721611023,0.22724932432174683,-0.19682565331459045,-0.3291197717189789,0.061542559415102005,-0.5144551396369934,-0.5080243945121765,0.6548771858215332},{0.42085760831832886,0.06184836104512215,0.036873556673526764,-0.38438817858695984,-0.4962429702281952,-0.5044094324111938,-0.116294726729393,0.42435795068740845},{-0.4707077145576477,-0.375083327293396,-0.0852779820561409,-0.25452402234077454,-0.00923878699541092,0.5145763754844666,-0.5588067173957825,0.5258684754371643},{0.26020339131355286,0.11455032974481583,-0.011572794057428837,0.07559686154127121,0.44834139943122864,-0.5744791626930237,0.4497777819633484,-0.3567048907279968}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.09991345554590225,0.024041512981057167,0.024281999096274376,-0.011307988315820694,-0.04745190590620041,0.025034919381141663,0.038061149418354034,0.011143370531499386};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012278208509087563,-0.019851036369800568,-0.012881387025117874,0.0316242054104805,-0.008851682767271996,-0.009615857154130936,0.009703250601887703,-0.06261782348155975};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

