#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.34949129819869995,-0.10919521003961563,0.3103902041912079,0.12695060670375824,-0.2746807932853699,0.28637075424194336,0.007516923360526562,-0.12172020971775055,0.12050383538007736,0.3127461075782776,0.1039842814207077,0.01287293154746294,0.21953174471855164,-0.22486157715320587,0.26691123843193054,-0.03222592920064926},{-0.19169270992279053,-0.4141196012496948,0.318450003862381,0.06019929051399231,-0.20986926555633545,0.1649368405342102,-0.4113702178001404,-0.051053956151008606,-0.09888001531362534,-0.18192751705646515,0.028113627806305885,-0.1811501830816269,-0.014861231669783592,-0.32237708568573,-0.30584752559661865,0.12485363334417343},{-0.12530475854873657,-0.25674742460250854,-0.4862666130065918,0.19780302047729492,0.2656254768371582,0.6017751097679138,0.027811892330646515,-0.04205340892076492,0.14258550107479095,-0.5741987228393555,-0.4057558476924896,0.8320751786231995,-0.2573162615299225,-0.3167476952075958,-0.4057413637638092,0.30010348558425903},{0.17394226789474487,0.27058500051498413,0.37420183420181274,-0.03012419119477272,-0.38786402344703674,-0.02007651887834072,0.25726163387298584,0.08976253867149353,0.3298479914665222,-0.30468985438346863,0.011063612997531891,0.42485687136650085,-0.2414649873971939,-0.027011746540665627,0.4673405587673187,-0.4652307629585266},{-0.0863705649971962,0.03564269840717316,0.31721070408821106,-0.0660017728805542,0.31314098834991455,0.44514045119285583,0.17314551770687103,-0.03367236629128456,0.11269091069698334,0.2150510996580124,0.26038309931755066,-0.3193075656890869,-0.1831645965576172,-0.42438018321990967,0.35467830300331116,0.09492411464452744},{-0.26239585876464844,-0.18069472908973694,-0.21785496175289154,-0.03905697911977768,0.18876145780086517,0.23376096785068512,0.026451949030160904,-0.10684674978256226,0.3328167796134949,-0.32600289583206177,-0.4507344663143158,0.2544494867324829,0.08085368573665619,-0.14896900951862335,-0.02863282524049282,0.0789375826716423},{0.03841254115104675,0.16244344413280487,0.032344356179237366,-0.4253723919391632,0.1623120903968811,-0.023544808849692345,0.07229755073785782,0.38712772727012634,0.3342290222644806,0.03806547820568085,-0.4308718740940094,-0.03591610863804817,-0.013960320502519608,0.1342165470123291,-0.2388344258069992,-0.222035750746727},{-0.3085896372795105,0.46231621503829956,0.40850746631622314,0.33644211292266846,-0.4979085922241211,-0.08400727808475494,0.558542013168335,0.5224193930625916,-0.2357737421989441,0.3232131600379944,-0.710419237613678,-0.43822696805000305,0.4796335995197296,0.0834883600473404,0.27328619360923767,0.4623795747756958},{0.40212780237197876,-0.3012941777706146,0.6305137276649475,0.08419403433799744,0.009196490049362183,0.0706564411520958,0.11635498702526093,-0.676550567150116,-0.2627843916416168,-0.41777974367141724,-0.17091873288154602,0.013470678590238094,-0.05932401120662689,0.7522658109664917,0.44674167037010193,-0.32186076045036316},{0.2318895012140274,-0.5841430425643921,-0.6603235006332397,-0.41135233640670776,-0.2508390247821808,0.24454134702682495,0.12329532206058502,0.11169999837875366,0.6019291281700134,0.2621227502822876,0.21534481644630432,-0.2828884422779083,-0.11293920129537582,0.4655701816082001,-0.20973330736160278,-0.6208366751670837},{0.21553759276866913,0.4332785904407501,0.37769269943237305,-0.6181713938713074,-0.34493643045425415,0.15765976905822754,0.18260705471038818,0.4130992293357849,-0.38702815771102905,0.019973287358880043,-0.06878907978534698,-0.0173611082136631,-0.14093562960624695,-0.19018664956092834,0.23655450344085693,-0.4224794805049896},{-0.04288603365421295,-0.46060001850128174,0.1868961602449417,0.6474630236625671,0.8318703770637512,0.4591926038265228,0.4556870758533478,0.438198059797287,0.03945060819387436,-0.03688051179051399,0.2777935862541199,-0.460606187582016,-0.6226815581321716,-0.41487160325050354,0.8047900199890137,-0.06504251062870026},{-0.2323695868253708,0.364382803440094,-0.07138840109109879,-0.6024496555328369,0.17230382561683655,0.07217871397733688,0.18710371851921082,0.17595593631267548,0.058349788188934326,0.0413239561021328,0.07439342886209488,0.19917188584804535,0.35850173234939575,0.3381299078464508,-0.1026737168431282,-0.12921713292598724},{0.05909523367881775,-0.3925940692424774,-0.24268577992916107,-0.20935824513435364,-0.45083820819854736,0.027633976191282272,-0.3166353404521942,-0.31589338183403015,-0.24342544376850128,-0.004740852862596512,-0.44657355546951294,-0.013775410130620003,-0.1900765299797058,0.41544675827026367,0.1322348564863205,-0.008316650055348873},{0.07032976299524307,-0.24848119914531708,-0.2258508801460266,0.18675778806209564,-0.15043020248413086,-0.4492071270942688,0.3172462284564972,-0.0918036550283432,-0.05281933769583702,0.36944064497947693,0.06211256980895996,0.049345917999744415,0.31324806809425354,0.017890585586428642,-0.2658967077732086,0.20159707963466644},{0.3598925769329071,0.0005470829200930893,-0.232824444770813,-0.1581178456544876,-0.3005025386810303,0.1498846560716629,0.3056562840938568,-0.07636426389217377,0.1833459436893463,0.353039413690567,-0.15110298991203308,0.06932823359966278,-0.17756138741970062,0.231158047914505,-0.057073261588811874,-0.01899968646466732},{-0.2472999393939972,-0.1977238804101944,0.230632945895195,0.12153849750757217,-0.231379896402359,0.06784971803426743,-0.1577513962984085,-0.08954630047082901,-0.20189397037029266,-0.26885777711868286,-0.03139211982488632,-0.28403881192207336,0.07163231819868088,-0.19982458651065826,0.08408361673355103,-0.21216584742069244},{-0.24121877551078796,0.25002744793891907,-0.30217376351356506,-0.20256108045578003,0.056034933775663376,0.3039136826992035,-0.18117743730545044,-0.1884451061487198,0.1168791651725769,0.13501304388046265,0.3329365849494934,-0.11595673114061356,-0.3183775246143341,0.30368688702583313,0.013287149369716644,-0.3823460042476654}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.035238154232501984,-0.05783388763666153,-0.0886538028717041,-0.34631478786468506,0.31150132417678833,0.29748255014419556,0.07861480116844177,0.046286504715681076,-0.07309061288833618,-0.17433494329452515,0.0013059636112302542,0.07655395567417145,0.19461238384246826,0.3118431866168976,0.14360681176185608,0.04916941747069359},{-0.14803773164749146,-0.29525622725486755,-0.0552668422460556,0.04304705932736397,0.234669491648674,-0.29326584935188293,0.024586526677012444,0.05420509725809097,-0.049960725009441376,0.264411598443985,-0.23611347377300262,0.31905773282051086,-0.3897445797920227,0.16602034866809845,-0.28544336557388306,-0.3541315793991089},{0.032753463834524155,0.21091362833976746,-0.39134588837623596,-0.5128194093704224,0.20097622275352478,0.4374774396419525,-0.08786706626415253,0.06764102727174759,-0.2751545310020447,-0.25333669781684875,-0.012761058285832405,0.326007217168808,-0.27960675954818726,-0.1334911733865738,0.09741134196519852,-0.0724765807390213},{0.14075888693332672,-0.06974845379590988,0.09222493320703506,0.18210379779338837,-0.4484541714191437,-0.00804280024021864,0.06883453577756882,-0.18779073655605316,0.27306848764419556,0.36730602383613586,-0.17395827174186707,-0.1548982560634613,-0.4117867052555084,-0.34424659609794617,0.20741872489452362,0.15325920283794403},{-0.04185769706964493,0.16218215227127075,0.014637380838394165,0.26161688566207886,-0.2451595664024353,0.09767899662256241,-0.008832070976495743,0.16681548953056335,0.2541216313838959,-0.2238219976425171,0.19414040446281433,0.2383776754140854,0.17600807547569275,-0.4554305970668793,0.03138625994324684,0.02837359346449375},{0.19732666015625,0.25654685497283936,-0.01898840069770813,0.19145958125591278,-0.49288949370384216,-0.4375948905944824,0.26718106865882874,0.3258109390735626,0.07001421600580215,0.377047061920166,0.23125571012496948,-0.23859770596027374,-0.0019491574494168162,-0.16254977881908417,-0.14328286051750183,0.2893775999546051},{-0.11369054764509201,0.26375508308410645,0.2979015111923218,-0.3618808388710022,-0.2540878653526306,-0.0004942098166793585,-0.3487932085990906,-0.03569873049855232,0.1916918009519577,0.0604800209403038,-0.13258439302444458,-0.21418273448944092,-0.31867045164108276,-0.0827726498246193,0.19530919194221497,0.018289316445589066},{-0.10621637105941772,-0.1362038105726242,-0.4420512020587921,0.2839900255203247,-0.30323880910873413,-0.2433372586965561,-0.23732419312000275,-0.38199225068092346,0.14283408224582672,-0.2182396501302719,0.05573409050703049,0.05530982092022896,-0.14644725620746613,0.4393550753593445,-0.01739896647632122,-0.29524534940719604},{-0.3153267800807953,0.2517889440059662,-0.01025912631303072,-0.051785971969366074,0.2751695215702057,-0.27828431129455566,0.29428043961524963,0.14597675204277039,0.3383913040161133,0.3019115924835205,0.25198012590408325,0.3056815564632416,0.16736049950122833,-0.09830471873283386,0.2575998306274414,0.09509322792291641},{0.07902918010950089,-0.27112698554992676,-0.1372666358947754,-0.13046377897262573,0.24371618032455444,-0.15891757607460022,-0.2943789064884186,-0.15121938288211823,0.05661957710981369,-0.3661075830459595,-0.2641446888446808,0.3309610188007355,0.10826224088668823,0.09339918941259384,-0.34393078088760376,0.2212563306093216},{-0.042922958731651306,-0.44606491923332214,0.28272953629493713,0.28072136640548706,0.26045912504196167,0.15553611516952515,0.1504802405834198,-0.126691535115242,0.23119860887527466,-0.2206621617078781,0.18278373777866364,0.3268420994281769,0.4933536648750305,0.11556407809257507,-0.04464221000671387,0.06875686347484589},{0.054027434438467026,-0.009660552255809307,0.41815507411956787,-0.017400037497282028,-0.2492072582244873,-0.18836627900600433,0.43537676334381104,0.30674904584884644,-0.23930348455905914,-0.19144849479198456,-0.05082453414797783,-0.36388370394706726,-0.011994602158665657,-0.2955230176448822,-0.30183812975883484,0.08314961194992065},{-0.1533880978822708,-0.32175344228744507,0.4176751971244812,-0.2260134220123291,0.37791645526885986,-0.3068740963935852,-0.45821329951286316,0.06495031714439392,0.09216643869876862,0.061721064150333405,-0.3196200728416443,0.11671953648328781,0.119959257543087,-0.25854575634002686,-0.23814640939235687,0.008876330219209194},{0.3766213655471802,-0.3380507528781891,0.4556160271167755,0.0797555148601532,-0.09176386147737503,0.3375876545906067,-0.11787497252225876,-0.22667935490608215,-0.3968384563922882,0.09019733965396881,0.015315288677811623,-0.34858065843582153,-0.1303596943616867,0.0890846699476242,0.3072281777858734,0.02745666727423668},{-0.09851522743701935,0.1922832727432251,0.12674064934253693,-0.48604410886764526,-0.18752647936344147,0.21320120990276337,0.24070867896080017,-0.25714874267578125,0.24214021861553192,-0.28666314482688904,0.07078120112419128,0.10748119652271271,-0.03850709646940231,0.19708152115345,0.048421960324048996,0.0785214751958847},{-0.13015352189540863,0.4029900133609772,-0.42915698885917664,0.38443657755851746,0.08778461813926697,-0.380598783493042,-0.012146652676165104,-0.07140032202005386,-0.30570298433303833,0.38106971979141235,-0.28832849860191345,0.2636558413505554,-0.09229735285043716,-0.3092169463634491,-0.13836196064949036,-0.464203417301178}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.13943389058113098,0.10322310775518417,0.0006137090967968106,-0.043957483023405075,-0.08354271203279495,0.014013951644301414,0.2550336420536041,0.06600188463926315,-0.16623911261558533,-0.17699211835861206,0.12066255509853363,-0.26806920766830444,-0.19319386780261993,0.2440142184495926,0.21663643419742584,0.30258649587631226,-0.2539689838886261,-0.27704674005508423,-0.1871507167816162,0.12400560826063156,-0.05479087308049202,-0.34413936734199524,-0.2592148184776306,-0.27963364124298096,-0.23481465876102448,0.1296156346797943,-0.22124627232551575,-0.05580901727080345,-0.06532686948776245,0.0014341825153678656,0.21755248308181763,-0.2045532912015915},{0.30654048919677734,0.1571989357471466,0.1828864961862564,-0.08827299624681473,0.12660396099090576,-0.15031558275222778,0.35689353942871094,0.15894117951393127,-0.1308419108390808,-0.07068784534931183,-0.12404993921518326,-0.24941229820251465,-0.19010686874389648,0.2363738715648651,-0.26176995038986206,-0.1905960589647293,-0.05039249360561371,0.18744291365146637,-0.35287201404571533,-0.2070949524641037,-0.022102344781160355,0.21010614931583405,0.023447679355740547,0.0332549512386322,0.2248149812221527,-0.3466464579105377,-0.05129202827811241,0.06444694846868515,0.16038015484809875,-0.10196511447429657,-0.06903515011072159,0.2029443234205246},{0.1747245043516159,0.039145443588495255,-0.12471234053373337,0.14275477826595306,-0.14717651903629303,-0.14626982808113098,-0.21907277405261993,0.05720643326640129,-0.16366972029209137,0.334536075592041,-0.3186255097389221,-0.2719818651676178,0.18439020216464996,-0.3960748314857483,-0.15116679668426514,0.09629698842763901,-0.07835114002227783,-0.11700756847858429,0.19518588483333588,-0.10045748203992844,0.23345817625522614,0.2742094099521637,-0.23472678661346436,0.023626092821359634,-0.2623800039291382,-0.02492666430771351,0.130848228931427,-0.06723038107156754,-0.01048352476209402,-0.20253820717334747,-0.10610781610012054,-0.07823451608419418},{0.3949783742427826,0.05219876766204834,0.13818351924419403,-0.18038159608840942,-0.24793946743011475,-0.039820630103349686,-0.13684841990470886,0.27016890048980713,0.23698675632476807,-0.3034188151359558,-0.06745188683271408,0.26166996359825134,0.1208074614405632,-0.014950907789170742,-0.2408236265182495,0.2911969721317291,-0.29180875420570374,0.26609015464782715,0.006941645406186581,0.10625987499952316,-0.0950658768415451,-0.09537224471569061,0.28994685411453247,0.15595375001430511,0.1616763323545456,-0.35959067940711975,0.2652360498905182,-0.21064487099647522,-0.041213177144527435,0.06640373915433884,-0.1989334225654602,0.14024026691913605},{-0.06638991087675095,-0.056933607906103134,-0.1135406643152237,0.12249093502759933,0.21264007687568665,-0.1433960348367691,-0.4099009335041046,-0.0790521502494812,-0.1035425141453743,-0.31326737999916077,0.1483772248029709,0.24565564095973969,-0.05187675356864929,-0.11609932035207748,-0.10134602338075638,0.12442872673273087,-0.020368168130517006,-0.03746022656559944,-0.3057948350906372,-0.199845090508461,-0.1764928549528122,-0.35011541843414307,0.1372993141412735,0.1404569447040558,-0.1030178964138031,0.34812667965888977,-0.18432794511318207,0.21751004457473755,0.29586511850357056,0.3826022744178772,-0.021386578679084778,0.37927427887916565},{-0.28327175974845886,0.03148803487420082,-0.23658408224582672,-0.05798482149839401,-0.20764310657978058,0.24305059015750885,0.20556485652923584,0.019837144762277603,0.2497214376926422,0.21995137631893158,0.34284940361976624,-0.22859348356723785,-0.27697524428367615,0.19396470487117767,0.34507718682289124,-0.33348721265792847,-0.11979971826076508,-0.2526712715625763,0.23574897646903992,0.10263559967279434,0.08737915009260178,0.19007988274097443,0.07502393424510956,-0.08497846871614456,-0.3406740427017212,0.34900978207588196,-0.12822353839874268,0.2194359302520752,0.3254760205745697,0.18240731954574585,0.06451916694641113,0.020707285031676292},{0.19873350858688354,-0.13637866079807281,-0.1335778832435608,-0.3014450967311859,-0.04527701064944267,0.23661452531814575,0.2909989356994629,0.18091633915901184,0.08552903681993484,0.3549559414386749,-0.0030891727656126022,-0.02343914285302162,-0.47295087575912476,-0.1688455194234848,-0.1566731184720993,0.16149473190307617,-0.25882425904273987,-0.2205013930797577,0.218033567070961,-0.08283070474863052,-0.12753041088581085,-0.15035521984100342,-0.2295488715171814,-0.21374808251857758,0.13196992874145508,-0.21695436537265778,-0.08343096822500229,-0.200543612241745,0.2961843013763428,0.12778739631175995,-0.163045734167099,-0.2941908836364746},{0.019971033558249474,0.16800551116466522,0.06574222445487976,-0.008607137948274612,0.1333926022052765,-0.3112759292125702,-0.134446918964386,-0.1471354067325592,-0.027235770598053932,-0.23739701509475708,-0.30255013704299927,-0.030250823125243187,-0.14195780456066132,-0.021652638912200928,-0.12384384125471115,0.3895088732242584,-0.007591248024255037,-0.14805950224399567,0.13196536898612976,0.34081870317459106,-0.11245407909154892,-0.23450545966625214,0.25274357199668884,0.10118698328733444,-0.045979615300893784,-0.30371740460395813,-0.30452507734298706,-0.3057010769844055,-0.3435475528240204,-0.23201806843280792,0.050713345408439636,-0.3044716715812683},{0.09185291081666946,0.2989369332790375,-0.2540383040904999,-0.3215777575969696,-0.21375837922096252,0.05215314403176308,0.07106803357601166,0.06378237158060074,0.15719634294509888,-0.2718952000141144,-0.23654897511005402,0.3342895805835724,-0.22968898713588715,-0.19390033185482025,0.1834176927804947,-0.27544623613357544,0.26601096987724304,0.14766785502433777,0.3270116448402405,0.04321911558508873,0.2196188122034073,0.03849752992391586,0.2530749440193176,-0.07876083999872208,0.3726711869239807,-0.21448670327663422,0.10450448095798492,0.31537890434265137,-0.28665703535079956,0.21861988306045532,-0.028473224490880966,0.15056483447551727},{-0.17487767338752747,0.11546928435564041,-0.21528559923171997,-0.15086685121059418,0.20375367999076843,-0.14488305151462555,0.06894401460886002,-0.011866829358041286,0.16595955193042755,-0.05127112567424774,-0.27206951379776,-0.2757798433303833,-0.29437002539634705,-0.05445650592446327,-0.24618037045001984,0.09094614535570145,0.07739599049091339,-0.20377060770988464,0.27497684955596924,0.09603942185640335,0.0032643298618495464,-0.03242675960063934,0.2660030126571655,-0.19923219084739685,0.31047481298446655,0.09923148155212402,-0.26854076981544495,0.007907846011221409,-0.018316958099603653,0.15690964460372925,-0.11442242562770844,0.10737740248441696},{0.0830787941813469,0.0186755508184433,0.21120215952396393,-0.27652499079704285,-0.2905277609825134,-0.24532578885555267,-0.2660270929336548,-0.0023280037567019463,-0.205715149641037,0.43120718002319336,0.1384546160697937,-0.2587941586971283,-0.3827187120914459,-0.023508436977863312,-0.23227787017822266,-0.08769339323043823,0.2271295189857483,-0.14603972434997559,0.25783032178878784,-0.13753721117973328,-0.1943075805902481,0.0036418079398572445,0.15076015889644623,0.23982450366020203,0.1599501520395279,-0.11248239874839783,-0.014483939856290817,-0.09018174558877945,-0.07149624824523926,0.02241564728319645,-0.04065113887190819,0.11699283868074417},{-0.17255330085754395,-0.1236005425453186,0.20682497322559357,0.29733312129974365,0.24829928576946259,-0.06589283049106598,0.07270126044750214,-0.22194921970367432,-0.013946487568318844,-0.2494901418685913,0.26046761870384216,-0.22052201628684998,-0.21903444826602936,-0.20903536677360535,0.23899324238300323,-0.0043981135822832584,-0.02530321665108204,0.005338576622307301,0.34747228026390076,0.04621355980634689,-0.16677701473236084,0.21180598437786102,0.10420207679271698,-0.061934422701597214,0.22828581929206848,-0.08970291167497635,-0.18160657584667206,0.20326396822929382,0.12904877960681915,0.0035099522210657597,-0.3137693703174591,-0.23038676381111145},{0.2917559742927551,-0.2440471649169922,0.0016939628403633833,-0.32026606798171997,-0.0049590058624744415,-0.15097899734973907,0.11253117024898529,0.1586305797100067,0.21728692948818207,0.056642450392246246,0.1907011866569519,0.255096971988678,-0.436035692691803,-0.3540590703487396,-0.03848832845687866,-0.21353670954704285,-0.2445269674062729,-0.2956155240535736,0.3154178857803345,-0.17356938123703003,0.3302648961544037,-0.09160467982292175,0.0031977910548448563,0.19189298152923584,0.11342988908290863,-0.10237894207239151,0.12007492035627365,0.04935838654637337,0.0766601711511612,-0.015578396618366241,-0.2697111666202545,-0.0016331213992089033},{0.25736647844314575,-0.036740001291036606,-0.017318090423941612,0.34644290804862976,-0.09350039809942245,-0.15931963920593262,-0.02327633462846279,0.17279157042503357,0.1884465515613556,0.24126432836055756,0.12546557188034058,-0.14044402539730072,0.05941103398799896,0.21427452564239502,-0.1278078854084015,0.12478601932525635,0.23928189277648926,-0.23092584311962128,0.11292220652103424,-0.33435922861099243,0.23841169476509094,0.1661728322505951,-0.08664432913064957,0.1994546353816986,0.250394344329834,0.0732952281832695,0.15531010925769806,0.10134410113096237,0.08067090064287186,-0.14229704439640045,0.03325013443827629,0.3489447236061096},{0.08698922395706177,-0.20996975898742676,0.006936206482350826,0.08827967196702957,-0.26767539978027344,-0.015565228648483753,0.05335837975144386,-0.21061468124389648,-0.15077076852321625,-0.025606593117117882,0.1662660837173462,0.20089533925056458,0.10857076942920685,0.2555510699748993,-0.042844343930482864,-0.024218201637268066,-0.22318732738494873,0.2569030225276947,-0.07494940608739853,-0.1904277205467224,-0.21009603142738342,-0.11210356652736664,0.13428957760334015,0.05737989395856857,0.013622799888253212,-0.15983344614505768,-0.1751508265733719,0.2088409960269928,0.0406067818403244,-0.1482221484184265,0.2495952546596527,0.1577734500169754},{0.17107780277729034,-0.23371779918670654,0.029029380530118942,-0.18839895725250244,0.017300743609666824,0.1551613062620163,0.06011035665869713,0.258724570274353,-0.08392152935266495,-0.031796518713235855,0.20804013311862946,0.12909142673015594,0.06306985765695572,-0.10197129845619202,-0.01777566410601139,0.20102490484714508,-0.32590681314468384,-0.18322190642356873,-0.030763432383537292,0.08432555943727493,0.03392995521426201,0.23911023139953613,0.13594168424606323,0.19238221645355225,0.05663224682211876,0.180214986205101,-0.03635317459702492,-0.05699415132403374,0.07249688357114792,-0.08884289860725403,-0.2533969283103943,0.3149583339691162},{0.166847825050354,0.008708608336746693,-0.33252158761024475,0.12093708664178848,0.05479740351438522,-0.042478617280721664,0.32538434863090515,0.11263565719127655,0.11110973358154297,-0.1271696537733078,0.19865259528160095,-0.2315520942211151,-0.38020744919776917,0.23563538491725922,0.08271832019090652,0.04772176966071129,-0.019428525120019913,-0.09889049082994461,-0.1534605622291565,0.06500817835330963,-0.032740116119384766,0.2062203288078308,0.08761206269264221,-0.16404017806053162,-0.07415124773979187,-0.23496367037296295,0.057056181132793427,0.320581316947937,0.2125139832496643,-0.1770295947790146,0.183584064245224,0.18143455684185028},{-0.0789688304066658,0.01006679330021143,-0.08818656951189041,-0.07170656323432922,-0.23959961533546448,-0.03451364114880562,0.21979814767837524,0.17330805957317352,0.12551215291023254,0.02364956960082054,0.17999592423439026,-0.005034992005676031,0.23805558681488037,0.19690251350402832,0.186738982796669,-0.10711237788200378,0.11055489629507065,0.1886332482099533,0.2052823305130005,0.04938223958015442,0.20596210658550262,0.27351489663124084,0.08703777939081192,0.16526301205158234,-0.03249121457338333,-0.07207656651735306,-0.1285574734210968,-0.2550787627696991,0.1400509476661682,-0.2834496796131134,0.023221004754304886,-0.05880239978432655},{-0.322805792093277,0.051025114953517914,-0.319720596075058,-0.32493337988853455,0.021779002621769905,-0.0040922341868281364,0.11131042242050171,-0.1531471610069275,0.052782051265239716,0.34579595923423767,0.024604711681604385,-0.1945718377828598,0.07284314185380936,-0.205354243516922,-0.2972552180290222,0.011846381239593029,-0.17492491006851196,0.10737476497888565,-0.04775654524564743,0.018633117899298668,-0.2796812057495117,0.13738448917865753,0.10126591473817825,0.038737453520298004,-0.07544218748807907,0.3271652162075043,0.05406578630208969,-0.20654179155826569,-0.1819542944431305,0.03892272710800171,-0.20472775399684906,-0.24824735522270203},{-0.005936907138675451,-0.263213574886322,-0.2756814658641815,-0.05133391544222832,-0.3284115791320801,-0.1495504379272461,0.18264660239219666,-0.27258870005607605,-0.21450793743133545,0.1713668256998062,0.20257358253002167,0.09359388798475266,0.11989273130893707,-0.15602126717567444,0.2717769742012024,-0.2685941755771637,0.0889868289232254,0.25747647881507874,0.05041538178920746,0.27579444646835327,0.006865770556032658,-0.11704454571008682,-0.27513954043388367,0.22226367890834808,-0.11706946790218353,-0.1539163440465927,0.11979560554027557,0.041445281356573105,-0.12231642007827759,-0.3214355409145355,-0.03010243922472,-0.18932032585144043},{0.23111645877361298,0.12982596457004547,-0.046610407531261444,0.2046927958726883,-0.23574265837669373,0.1327294260263443,-0.08846467733383179,-0.18413718044757843,-0.11532561480998993,0.18440578877925873,-0.3179156184196472,-0.13978135585784912,0.013989018276333809,-0.19925051927566528,-0.38363245129585266,-0.159530371427536,-0.082489013671875,-0.3020155131816864,-0.23721203207969666,0.2093428373336792,0.12075173854827881,0.11196620017290115,-0.38515666127204895,0.30917003750801086,0.14957138895988464,0.3025066554546356,-0.29231664538383484,-0.07237429916858673,0.06839394569396973,-0.19370301067829132,0.14764930307865143,0.15291360020637512},{-0.0537138432264328,-0.3056950271129608,-0.0428621806204319,-0.30570080876350403,-0.07423773407936096,0.28961747884750366,0.20436221361160278,0.03493775427341461,-0.09452265501022339,0.011261501349508762,-0.15133266150951385,0.10145136713981628,0.10190330445766449,0.05366343632340431,0.11205483227968216,0.033904753625392914,-0.08905187249183655,0.13793912529945374,-0.11514965444803238,0.14616237580776215,0.1892378330230713,0.254230260848999,-0.026083366945385933,-0.24904438853263855,0.16402854025363922,0.16405610740184784,0.2818823754787445,0.16363674402236938,0.02012716978788376,0.11215400695800781,0.015705056488513947,-0.10074482858181},{-0.023427290841937065,-0.20995205640792847,0.22003649175167084,0.06743478029966354,0.2746060788631439,-0.02656974457204342,-0.13794195652008057,-0.2031763195991516,0.14208291471004486,-0.04077671095728874,0.08546897768974304,0.0018033990636467934,-0.33434271812438965,0.05789078399538994,-0.09629631042480469,-0.2606809437274933,-0.043542712926864624,-0.06503002345561981,0.18544507026672363,0.19390611350536346,0.02449365146458149,0.05152495577931404,0.16298136115074158,0.29478177428245544,-0.18814077973365784,-0.035181570798158646,0.16194766759872437,-0.06953385472297668,-0.13564150035381317,-0.2588895559310913,0.2931272089481354,0.02271079830825329},{0.1927063763141632,-0.0950135812163353,0.04373579099774361,0.1017017811536789,-0.01892550103366375,0.03012729436159134,-0.2203398048877716,0.30218812823295593,-0.10322294384241104,-0.01498726848512888,0.0967966765165329,-0.3124034106731415,0.09207110106945038,-0.048738930374383926,-0.12804481387138367,0.3229193091392517,-0.09530167281627655,-0.17804676294326782,-0.0017486629076302052,0.026969578117132187,-0.17057932913303375,0.16139204800128937,0.2148619443178177,0.26524272561073303,-0.25706449151039124,0.1113140732049942,-0.0867682546377182,0.0502820685505867,-0.268982470035553,0.23409448564052582,-0.07292788475751877,0.028214668855071068}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.20560288429260254,-0.11443044990301132,0.05083836615085602,-0.11623697727918625},{0.1997971385717392,-0.24421487748622894,0.27145329117774963,0.22523720562458038},{-0.22408992052078247,0.03085188753902912,0.05940422788262367,-0.02821183018386364},{0.2802658975124359,0.39731037616729736,0.2971785068511963,0.04500246047973633},{-0.2517697811126709,0.14535002410411835,-0.26131129264831543,0.10936024785041809},{0.028018083423376083,-0.07394713163375854,0.06963344663381577,0.25626039505004883},{-0.09957051277160645,-0.1718871146440506,-0.3291403651237488,-0.05791856721043587},{-0.09967396408319473,-0.32528868317604065,0.13146694004535675,-0.05494542047381401},{-0.0895601212978363,0.14937111735343933,-0.08562126010656357,-0.08350139856338501},{0.20480434596538544,-0.02086927369236946,-0.07311490178108215,-0.1537315845489502},{0.2229861468076706,-0.19426168501377106,0.27859172224998474,0.20872154831886292},{-0.02381443791091442,0.001430337317287922,0.3396548628807068,-0.07808554917573929},{-0.2925591766834259,0.22850726544857025,-0.040091387927532196,-0.07873652130365372},{-0.14370794594287872,0.004280222579836845,-0.2175174355506897,0.0385366715490818},{0.19649405777454376,-0.03370504826307297,0.20711073279380798,0.05984289571642876},{-0.12929284572601318,-0.2561921179294586,-0.11857911199331284,-0.07100861519575119},{-0.23998652398586273,0.03993714600801468,-0.06367190927267075,0.26024144887924194},{-0.24684745073318481,-0.13198541104793549,-0.21859900653362274,0.1645156741142273},{-0.061798375099897385,-0.0903044268488884,0.33181262016296387,0.06743693351745605},{-0.1341172456741333,-0.15734758973121643,-0.012747358530759811,-0.15804381668567657},{0.13961778581142426,0.1083151251077652,0.1123165488243103,-0.13054734468460083},{-0.010958515107631683,-0.2438940852880478,-0.12161606550216675,0.2254241406917572},{0.27526676654815674,-0.1315671056509018,0.15140081942081451,0.011942184530198574},{-0.25723502039909363,-0.09425299614667892,-0.269681841135025,-0.17615029215812683},{-0.23011459410190582,-0.1613401621580124,-0.014860239811241627,-0.11705510318279266},{0.1555161327123642,0.16242310404777527,-0.0423198863863945,0.14843979477882385},{0.18092195689678192,-0.19290468096733093,0.21515238285064697,0.07720952481031418},{-0.04587115719914436,-0.15254198014736176,0.007388594560325146,0.2789861261844635},{0.04077679663896561,0.010765321552753448,0.02401137538254261,0.017529984936118126},{-0.1269308477640152,0.10353770107030869,0.2026103138923645,0.009759374894201756},{-0.13322702050209045,-0.12918414175510406,0.07882110029459,0.17827977240085602},{0.17092865705490112,0.19666266441345215,0.20746582746505737,-0.01168326660990715}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.055941659957170486,0.0017465403070673347,-0.0015129140811040998,0.046167828142642975,0.04447522759437561,-0.038889024406671524,-0.0031654012855142355,0.048448868095874786,-0.06617707759141922,-0.08398376405239105,-0.02150353603065014,0.06792188435792923,-0.028995346277952194,0.044701896607875824,-0.026102226227521896,-0.022634299471974373};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0030955562833696604,-0.0027288615237921476,-0.007227790541946888,-0.01433352567255497,-0.051662627607584,0.017981737852096558,-0.021482223644852638,-0.0033885433804243803,0.017028994858264923,-0.037708308547735214,-0.0014446349814534187,-0.014586945995688438,-0.009570152498781681,-0.023749591782689095,-0.018388697877526283,-0.04276779294013977};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.0027235711459070444,0.063136026263237,-0.02275368943810463,0.01736373081803322,-0.014530482701957226,0.034498147666454315,-0.044023700058460236,-0.01694052666425705,-0.027054479345679283,-0.020380094647407532,-0.007440936751663685,0.02989666908979416,0.011264277622103691,0.012705877423286438,0.05840715393424034,-0.04894820600748062,0.01968996226787567,-0.007060613948851824,0.01950003392994404,-0.03417179733514786,-0.001575034810230136,0.026927150785923004,-0.0050485082902014256,-0.044632941484451294,-0.05322811007499695,0.01515871286392212,0.023827532306313515,0.030791286379098892,-0.001804766827262938,0.022040896117687225,0.027299147099256516,0.004394192714244127};
static const float action_parameterization_distribution_linear_bias[4] = {0.008536653593182564,0.018723923712968826,0.015123873017728329,0.04057970643043518};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.42350155115127563,-0.38060495257377625,-0.13620904088020325,0.24092446267604828,-0.1768609583377838,0.10224670171737671,-0.3058532774448395,0.05685701221227646},{0.20396214723587036,0.10263843089342117,0.40066206455230713,0.38316330313682556,-0.1088205873966217,-0.3381257653236389,0.3110959529876709,0.39301010966300964},{0.06838804483413696,0.17011047899723053,0.10866902768611908,-0.05206011235713959,0.33188217878341675,0.22082653641700745,-0.026593530550599098,0.229384183883667},{0.11674003303050995,-0.38355737924575806,0.3407004773616791,-0.15125983953475952,-0.22771230340003967,0.10250473767518997,0.32242080569267273,0.248970165848732},{-0.24164053797721863,-0.09906303882598877,-0.03436354920268059,-0.2633763551712036,0.14724701642990112,0.1288275122642517,0.36250683665275574,0.27550193667411804},{-0.04403850436210632,0.1697845160961151,0.006227677688002586,-0.19383111596107483,0.3405270576477051,0.12322308123111725,0.12121324241161346,-0.17208993434906006},{0.01016964577138424,0.12842601537704468,0.15436048805713654,-0.1435278207063675,0.432649701833725,-0.10114312916994095,0.15352214872837067,0.0854930579662323},{0.06026533618569374,-0.4797190725803375,-0.01537145022302866,-0.2205152064561844,0.29463306069374084,0.05659325793385506,-0.15858417749404907,-0.3461393713951111},{-0.2524241805076599,0.15242236852645874,0.016639364883303642,-0.06761295348405838,0.03794143721461296,0.4756183922290802,0.41731253266334534,0.2850050926208496},{0.004108793567866087,-0.1545351892709732,-0.268419086933136,0.2805125117301941,0.3024906516075134,0.3312964141368866,0.3730621635913849,-0.33374258875846863},{-0.1548405885696411,-0.39426034688949585,0.3609286844730377,0.18267199397087097,0.02508299984037876,-0.26086464524269104,0.04924527928233147,-0.3435746431350708},{0.2485874891281128,0.02151794731616974,0.41302019357681274,0.40696507692337036,-0.09989670664072037,0.33557015657424927,0.22131630778312683,-0.3406221568584442},{-0.3710106611251831,0.14170683920383453,-0.3500185012817383,0.44231224060058594,-0.01405327394604683,0.4165904223918915,-0.006936532445251942,0.2515944540500641},{-0.05169062688946724,0.17437715828418732,-0.12602706253528595,-0.1086721271276474,0.03070765733718872,0.16488224267959595,0.2863849997520447,-0.00826970674097538},{0.11635255068540573,-0.3750471770763397,-0.36026638746261597,-0.15974943339824677,0.13857190310955048,-0.13579434156417847,0.11672282218933105,-0.12545958161354065},{-0.47829124331474304,-0.37514814734458923,-0.30149930715560913,-0.005294318310916424,-0.05260411649942398,0.23758727312088013,0.16916823387145996,-0.137613907456398},{-0.17973566055297852,-0.3568667471408844,0.20727954804897308,-0.35022443532943726,-0.010109876282513142,0.03516160696744919,-0.441529244184494,-0.3168291747570038},{0.07260692864656448,0.1933121681213379,0.11907052248716354,0.21132321655750275,-0.12166909873485565,0.32383787631988525,0.2614559829235077,-0.22276949882507324},{0.07568180561065674,-0.3578987419605255,-0.09775959700345993,-0.038826167583465576,-0.152439683675766,-0.3525061011314392,0.017832446843385696,-0.3201439380645752},{-0.019225426018238068,-0.017784858122467995,0.08901136368513107,-0.287679523229599,0.038301121443510056,0.11522062867879868,0.053651608526706696,-0.16023299098014832},{0.1133340522646904,-0.11949288100004196,0.05053454637527466,-0.24161915481090546,-0.010417615994811058,-0.007446671836078167,-0.0560738667845726,-0.2774670422077179},{-0.2953560948371887,0.16355928778648376,0.1200588122010231,-0.22743485867977142,-0.47579044103622437,0.008604982867836952,0.10547292232513428,-0.026472626253962517},{0.3068116009235382,0.10459854453802109,-0.45272311568260193,0.13013026118278503,-0.07945794612169266,0.21704554557800293,0.2082844227552414,0.2508060336112976},{0.039327193051576614,-0.10951276868581772,-0.05584297329187393,0.31652143597602844,-0.3380042612552643,-0.07869844883680344,-0.18571676313877106,-0.3558579385280609},{0.23153431713581085,0.07235774397850037,-0.4949052333831787,0.3250826299190521,-0.31836453080177307,-0.35416433215141296,-0.3479800224304199,0.1341903656721115},{0.07758376747369766,0.3457077741622925,-0.33645161986351013,-0.052063167095184326,0.07410652190446854,-0.25234296917915344,0.3206988275051117,-0.3114766478538513},{-0.04299646615982056,0.0566142201423645,-0.17452514171600342,-0.13451237976551056,0.03394196555018425,-0.18463753163814545,-0.09126615524291992,-0.15347814559936523},{0.17486485838890076,-0.19695574045181274,-0.07676722854375839,-0.07990887761116028,0.006837543565779924,0.000730247120372951,-0.19490553438663483,0.08450793474912643},{0.3756386935710907,0.03059965930879116,-0.4100761115550995,-0.1725483238697052,-0.2498338222503662,0.10574332624673843,0.2478046715259552,0.07176407426595688},{0.428107887506485,-0.3167600929737091,-0.05519382655620575,-0.016705136746168137,0.11116375029087067,-0.13189329206943512,0.22418612241744995,0.3403370678424835},{-0.20137855410575867,-0.16712680459022522,0.014488494023680687,-0.21991725265979767,0.33063846826553345,-0.2657466530799866,0.059645842760801315,0.09722674638032913},{0.24969792366027832,0.02499493397772312,-0.15427526831626892,0.3818187117576599,0.10178713500499725,0.0016784195322543383,-0.012716187164187431,0.05150062218308449}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23465295135974884,0.39526647329330444,-0.5997609496116638,-0.5055866837501526,-0.255967915058136,0.07161965221166611,-0.3940109610557556,0.5304819941520691},{-0.03668823465704918,0.5619426965713501,-0.2114057093858719,0.4820626378059387,-0.016222981736063957,0.025455160066485405,-0.25935521721839905,0.012263300828635693},{-0.4629649221897125,-0.17865614593029022,-0.16511669754981995,-0.27106377482414246,0.5171753764152527,0.17133423686027527,-0.01608794741332531,0.44298750162124634},{-0.46524301171302795,-0.41760843992233276,0.2687043249607086,0.38626033067703247,-0.5080218315124512,-0.1690106838941574,0.38141003251075745,0.20083776116371155},{-0.2635641396045685,-0.31193336844444275,-0.27345478534698486,-0.2640426754951477,0.3206382989883423,-0.248709037899971,0.44894537329673767,-0.39480137825012207},{-0.0786038488149643,0.14436179399490356,0.2918085753917694,-0.5334979891777039,0.5325329303741455,-0.29525262117385864,-0.4128096401691437,-0.31101176142692566},{-0.41142401099205017,0.13925810158252716,0.06990168243646622,-0.323827862739563,-0.024573950096964836,-0.5245842337608337,0.5151296854019165,0.05976969003677368},{-0.3895137906074524,-0.3070157766342163,-0.220727801322937,-0.4553578794002533,-0.29878854751586914,0.06582746654748917,0.4597051441669464,-0.30051180720329285}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.015018295496702194,-0.05440976470708847,-0.0186617411673069,0.028157811611890793,-0.028045088052749634,-0.01937294565141201,-0.09261539578437805,0.013843498192727566};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.012962942011654377,-0.07043857872486115,-0.0189655888825655,0.096248097717762,-0.027665352448821068,0.046549711376428604,-0.02523568831384182,0.03327111899852753};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

