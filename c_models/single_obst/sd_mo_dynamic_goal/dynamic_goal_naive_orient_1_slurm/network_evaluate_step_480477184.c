#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.31476354598999023,-0.07882125675678253,0.2846587300300598,0.1400776505470276,-0.2823222875595093,0.27049151062965393,-0.05261904001235962,-0.14620010554790497,0.13402120769023895,0.34131693840026855,0.1229408010840416,0.05005917325615883,0.2538257837295532,-0.257766991853714,0.28185370564460754,-0.06507595628499985},{-0.16170410811901093,-0.39094457030296326,0.3274118900299072,0.10572609305381775,-0.24571558833122253,0.17437303066253662,-0.4039295017719269,-0.04613330960273743,-0.09754576534032822,-0.18560923635959625,0.04563264176249504,-0.2136208564043045,0.013782434165477753,-0.3482525646686554,-0.2500937283039093,0.10476727783679962},{-0.07529595494270325,-0.22290058434009552,-0.44525858759880066,0.1389199048280716,0.25280746817588806,0.5422686338424683,0.028754446655511856,-0.040603652596473694,0.07950358837842941,-0.47633275389671326,-0.38131511211395264,0.7689211368560791,-0.19298213720321655,-0.3031386137008667,-0.38338813185691833,0.25652655959129333},{0.15436962246894836,0.25719064474105835,0.3850632607936859,-0.025879427790641785,-0.39529749751091003,-0.01773206703364849,0.25786784291267395,0.07380089908838272,0.31865546107292175,-0.3520624041557312,0.02232995070517063,0.4143325686454773,-0.21404039859771729,0.006504074204713106,0.4787863492965698,-0.4670235812664032},{-0.07748857140541077,-0.02115562930703163,0.3346155881881714,-0.04857327789068222,0.3205052614212036,0.45012444257736206,0.21002058684825897,-0.013869951479136944,0.13210906088352203,0.19435004889965057,0.25900059938430786,-0.3439798057079315,-0.23959718644618988,-0.41186878085136414,0.4194270670413971,0.10126005113124847},{-0.21771125495433807,-0.2050117552280426,-0.16371743381023407,-0.07722485810518265,0.19112235307693481,0.18563613295555115,0.04394768923521042,-0.12427186220884323,0.377616822719574,-0.3067634105682373,-0.45546936988830566,0.220714271068573,0.1321580857038498,-0.15299704670906067,-0.02947562001645565,0.0665232464671135},{0.08151920139789581,0.06174958124756813,0.03663066029548645,-0.450889527797699,0.22677026689052582,-0.04743793606758118,0.05775752663612366,0.38021576404571533,0.3457367420196533,0.04839223250746727,-0.4551701545715332,-0.02705271728336811,-0.018695304170250893,0.14428003132343292,-0.18497444689273834,-0.2582402229309082},{-0.2594998776912689,0.4452992081642151,0.36254188418388367,0.3853079080581665,-0.49842098355293274,-0.07652503997087479,0.5410624742507935,0.5340336561203003,-0.22524814307689667,0.3783424496650696,-0.6933884024620056,-0.39973366260528564,0.4626474380493164,0.11818857491016388,0.2652067244052887,0.451633095741272},{0.3630185127258301,-0.28258076310157776,0.6305964589118958,0.11562984436750412,0.0009838228579610586,0.09795443713665009,0.17157721519470215,-0.6257932782173157,-0.21757392585277557,-0.4623398184776306,-0.1702859103679657,0.004728997126221657,-0.09147751331329346,0.6830955147743225,0.45319515466690063,-0.3088183104991913},{0.20514772832393646,-0.5970678329467773,-0.6483376622200012,-0.35394287109375,-0.23268242180347443,0.2423175573348999,0.16851478815078735,0.1641959697008133,0.6188663840293884,0.26185646653175354,0.19839155673980713,-0.26649385690689087,-0.12223383784294128,0.4118568003177643,-0.2191336303949356,-0.5452132821083069},{0.21099381148815155,0.36513081192970276,0.38410621881484985,-0.6477364897727966,-0.30621275305747986,0.12238916754722595,0.1255541890859604,0.424451619386673,-0.3374694585800171,0.04572237282991409,-0.12373602390289307,0.010673931799829006,-0.161685511469841,-0.21412336826324463,0.24325251579284668,-0.36841103434562683},{-0.016360625624656677,-0.3991779088973999,0.16815614700317383,0.5831798315048218,0.7440715432167053,0.4346120357513428,0.36187228560447693,0.41395366191864014,0.033075522631406784,-0.0008154819952324033,0.27390235662460327,-0.45012810826301575,-0.54832524061203,-0.4178425967693329,0.7070319056510925,-0.04446554183959961},{-0.28485676646232605,0.4344290494918823,-0.03803000971674919,-0.6221233606338501,0.17213016748428345,0.026193438097834587,0.20544902980327606,0.20430822670459747,0.0704222023487091,0.10804980248212814,0.042345620691776276,0.1968858242034912,0.4421660602092743,0.3501582741737366,-0.07634372264146805,-0.1131979301571846},{0.0529651902616024,-0.3734881281852722,-0.2503361403942108,-0.18647532165050507,-0.461637407541275,0.004047923255711794,-0.24996131658554077,-0.2445012778043747,-0.19884279370307922,-0.027868779376149178,-0.4304860830307007,-0.028582675382494926,-0.20935675501823425,0.42243102192878723,0.1901356726884842,-0.01642683893442154},{0.07562902569770813,-0.2826174795627594,-0.22154049575328827,0.18000343441963196,-0.1081615537405014,-0.46203646063804626,0.27863338589668274,-0.08187253773212433,-0.0018507521599531174,0.3744547963142395,0.07512804865837097,0.05376005917787552,0.30279844999313354,-0.024324946105480194,-0.3237811028957367,0.21942199766635895},{0.4004393517971039,0.007678324356675148,-0.22114835679531097,-0.19190800189971924,-0.3264106214046478,0.16959041357040405,0.319943368434906,-0.07445093989372253,0.19788041710853577,0.36528149247169495,-0.14451465010643005,0.07468767464160919,-0.20361174643039703,0.25836506485939026,-0.1049574464559555,-0.02068357728421688},{-0.21861541271209717,-0.1826668381690979,0.23065878450870514,0.1295109987258911,-0.21606063842773438,0.09519243240356445,-0.1928955763578415,-0.11141330003738403,-0.2112354189157486,-0.24670979380607605,-0.060870345681905746,-0.271945059299469,0.10544383525848389,-0.19652938842773438,0.054885733872652054,-0.21981596946716309},{-0.23801255226135254,0.2507364749908447,-0.34879621863365173,-0.22606687247753143,0.039419014006853104,0.3262600600719452,-0.22994621098041534,-0.21256455779075623,0.15803442895412445,0.17411425709724426,0.3106967508792877,-0.12915512919425964,-0.31291526556015015,0.31261804699897766,0.032207563519477844,-0.4107547402381897}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.050839249044656754,-0.03968724235892296,-0.09738229215145111,-0.3468061089515686,0.32011285424232483,0.29912179708480835,0.0808476135134697,0.04804718494415283,-0.10337554663419724,-0.1585000455379486,-0.01811765879392624,0.07386824488639832,0.20281563699245453,0.36366763710975647,0.09126830846071243,0.07724681496620178},{-0.16276989877223969,-0.3075258731842041,-0.05813846364617348,0.0623219832777977,0.22344647347927094,-0.30040243268013,0.0377153642475605,0.04351856932044029,-0.05417348071932793,0.26252520084381104,-0.2507813572883606,0.3255078196525574,-0.3907996416091919,0.20103833079338074,-0.3558500409126282,-0.36289089918136597},{0.05060679838061333,0.2124670445919037,-0.36696386337280273,-0.5220341682434082,0.19161055982112885,0.45751094818115234,-0.08663386106491089,0.0689823180437088,-0.26862630248069763,-0.2944548428058624,-0.007186327129602432,0.32794350385665894,-0.2893195152282715,-0.17791832983493805,0.0971127450466156,-0.06679762899875641},{0.16445404291152954,-0.06175806373357773,0.09074622392654419,0.2039029896259308,-0.4791117012500763,-0.009629955515265465,0.09044453501701355,-0.18420541286468506,0.2897222340106964,0.36611437797546387,-0.16929467022418976,-0.139748677611351,-0.4195402264595032,-0.4008898437023163,0.18077413737773895,0.17037159204483032},{-0.08847504109144211,0.14766629040241241,0.003319711657240987,0.24210911989212036,-0.23297074437141418,0.07880165427923203,-0.01163169089704752,0.15650033950805664,0.2506358027458191,-0.2484707534313202,0.1762097179889679,0.27292922139167786,0.18009266257286072,-0.43913155794143677,0.035446926951408386,-0.017727088183164597},{0.22513525187969208,0.2612026631832123,-0.031382374465465546,0.1772199273109436,-0.4886132478713989,-0.4150243103504181,0.26209163665771484,0.2933076024055481,0.11604031175374985,0.3584303557872772,0.2439398169517517,-0.21685631573200226,-0.010219995863735676,-0.1497909277677536,-0.08225322514772415,0.3074083924293518},{-0.10214339196681976,0.2629563510417938,0.293550580739975,-0.3717169761657715,-0.2508610486984253,0.012936479412019253,-0.35232847929000854,-0.04854658246040344,0.17558924853801727,0.07991716265678406,-0.14281974732875824,-0.21859228610992432,-0.3225531578063965,-0.022473501041531563,0.1891961395740509,0.029637165367603302},{-0.1695774793624878,-0.15691931545734406,-0.48307374119758606,0.31384482979774475,-0.3207229673862457,-0.2529982328414917,-0.24704773724079132,-0.39350900053977966,0.15127716958522797,-0.2570008337497711,0.04480639472603798,0.07792982459068298,-0.15144005417823792,0.45306482911109924,-0.07454695552587509,-0.3404669463634491},{-0.3323948383331299,0.26629748940467834,-0.007897432893514633,-0.03609193116426468,0.27606436610221863,-0.276434987783432,0.300029993057251,0.14270995557308197,0.3412696421146393,0.2892822027206421,0.25532034039497375,0.31281858682632446,0.18211287260055542,-0.0461537130177021,0.26340383291244507,0.10198531299829483},{0.06156578287482262,-0.27214333415031433,-0.1731274425983429,-0.1206461563706398,0.26408636569976807,-0.17161591351032257,-0.30481430888175964,-0.16253671050071716,0.0729469507932663,-0.37662211060523987,-0.2807062566280365,0.3521197438240051,0.1177125796675682,0.15137584507465363,-0.38317811489105225,0.2313748449087143},{-0.058686546981334686,-0.4432837665081024,0.3295774459838867,0.2927001416683197,0.23783442378044128,0.14787589013576508,0.1844276785850525,-0.13310466706752777,0.21454322338104248,-0.26709863543510437,0.19023001194000244,0.34686142206192017,0.503386914730072,0.10941286385059357,-0.11082574725151062,0.09324298053979874},{0.05628310143947601,-0.0072549935430288315,0.39997631311416626,-0.006433425936847925,-0.2453807294368744,-0.18286842107772827,0.4297778308391571,0.2973720133304596,-0.2468261569738388,-0.2000594586133957,-0.08009056001901627,-0.34338465332984924,-0.02325551025569439,-0.2784624397754669,-0.38811713457107544,0.054962996393442154},{-0.11347098648548126,-0.31032273173332214,0.4088633954524994,-0.22243912518024445,0.3621053099632263,-0.31107258796691895,-0.45776280760765076,0.0819334015250206,0.08525542169809341,0.07113129645586014,-0.3316608965396881,0.13077937066555023,0.09673862159252167,-0.30598869919776917,-0.3508937656879425,-0.009091981686651707},{0.37119853496551514,-0.34039992094039917,0.45889902114868164,0.08633542060852051,-0.09150849282741547,0.3298930823802948,-0.11171648651361465,-0.23396554589271545,-0.41726237535476685,0.11664796620607376,0.009372214786708355,-0.36235442757606506,-0.11850571632385254,0.1307075321674347,0.30759483575820923,0.035662516951560974},{-0.0985761508345604,0.23578287661075592,0.10837297886610031,-0.46363139152526855,-0.2189926952123642,0.19232182204723358,0.2651733160018921,-0.2595978081226349,0.22105719149112701,-0.31966596841812134,0.02692161314189434,0.11376872658729553,-0.0738900825381279,0.19259683787822723,0.04248569905757904,0.06706304848194122},{-0.16830362379550934,0.42090561985969543,-0.44114306569099426,0.37367239594459534,0.09727126359939575,-0.40442314743995667,-0.02441023662686348,-0.07382585853338242,-0.3106643259525299,0.4036485552787781,-0.3275755047798157,0.30160343647003174,-0.0862637460231781,-0.3454001545906067,-0.2258593887090683,-0.4841140806674957}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.16382552683353424,0.11718370765447617,-0.02330894209444523,-0.04275166988372803,-0.1230289489030838,0.03134594112634659,0.26921311020851135,0.09598062932491302,-0.19255460798740387,-0.15809117257595062,0.14585082232952118,-0.28617629408836365,-0.23289111256599426,0.23393549025058746,0.21616975963115692,0.32338809967041016,-0.26844581961631775,-0.28612908720970154,-0.20074079930782318,0.1238204687833786,-0.06760171800851822,-0.31325703859329224,-0.22892867028713226,-0.2883661389350891,-0.2510777413845062,0.1639336198568344,-0.2031484991312027,-0.02944793924689293,-0.03652223199605942,-0.02287314087152481,0.22663795948028564,-0.2209215611219406},{0.2937251627445221,0.1640191525220871,0.17131629586219788,-0.11318360269069672,0.14876969158649445,-0.12832799553871155,0.39218467473983765,0.14275629818439484,-0.1480095535516739,-0.0873430073261261,-0.12248188257217407,-0.2783128023147583,-0.1773475557565689,0.2454129159450531,-0.25474676489830017,-0.2046736478805542,-0.03444737195968628,0.2090342789888382,-0.3705905079841614,-0.22205974161624908,-0.035354133695364,0.23683354258537292,0.041842132806777954,0.02586543932557106,0.22445055842399597,-0.3580752909183502,-0.05248081311583519,0.08011718839406967,0.1728987842798233,-0.12730750441551208,-0.05750667676329613,0.19450637698173523},{0.14753739535808563,0.04120660573244095,-0.16681520640850067,0.14421966671943665,-0.16791492700576782,-0.16890838742256165,-0.20734500885009766,0.03633052110671997,-0.15820764005184174,0.3857230842113495,-0.3094736635684967,-0.30319586396217346,0.13512587547302246,-0.38675975799560547,-0.16242878139019012,0.09630764275789261,-0.11393571645021439,-0.13272641599178314,0.15629403293132782,-0.11727387458086014,0.23727096617221832,0.286529004573822,-0.24212023615837097,0.01808512769639492,-0.27754324674606323,0.0012997929006814957,0.12729187309741974,-0.08275521546602249,-0.029263189062476158,-0.2544141709804535,-0.13876105844974518,-0.0847935602068901},{0.4280069172382355,0.0347503162920475,0.16342969238758087,-0.1656043380498886,-0.2682724893093109,-0.061502907425165176,-0.16463784873485565,0.29504603147506714,0.2604829967021942,-0.30869239568710327,-0.08414122462272644,0.3117382228374481,0.11356709897518158,-0.05632671341300011,-0.2409287691116333,0.2905849516391754,-0.30476734042167664,0.24659277498722076,0.04321408271789551,0.130180224776268,-0.07566715031862259,-0.13244785368442535,0.2845955193042755,0.16794265806674957,0.19241942465305328,-0.39206960797309875,0.265139639377594,-0.22836364805698395,-0.06773021817207336,0.10968170315027237,-0.20278409123420715,0.1476208120584488},{-0.06547568738460541,-0.0856621190905571,-0.11677467823028564,0.1299186497926712,0.21390429139137268,-0.16666188836097717,-0.41058897972106934,-0.089088574051857,-0.10412640124559402,-0.2960890233516693,0.12332657724618912,0.23459085822105408,-0.031103895977139473,-0.11149108409881592,-0.10543446987867355,0.1307295560836792,-0.03343687579035759,-0.05433794483542442,-0.32276996970176697,-0.1891660988330841,-0.15952737629413605,-0.3711273670196533,0.14070221781730652,0.15572141110897064,-0.10624336451292038,0.3600975275039673,-0.18500691652297974,0.190167635679245,0.33104491233825684,0.3746928572654724,-0.049328312277793884,0.38510024547576904},{-0.3145619034767151,0.013872752897441387,-0.2459089756011963,-0.055499523878097534,-0.20739255845546722,0.24959644675254822,0.20942112803459167,0.01736144721508026,0.25336840748786926,0.2530674934387207,0.3434271812438965,-0.24408842623233795,-0.2727416753768921,0.18960629403591156,0.3405657112598419,-0.32238492369651794,-0.13542583584785461,-0.2548336684703827,0.20671036839485168,0.09494086354970932,0.09335401654243469,0.19168266654014587,0.08069644868373871,-0.07989988476037979,-0.36827901005744934,0.3850027024745941,-0.14432275295257568,0.21503040194511414,0.363055020570755,0.17407691478729248,0.052698299288749695,0.015975505113601685},{0.21191348135471344,-0.141331285238266,-0.12569861114025116,-0.3402690887451172,-0.045024290680885315,0.23277543485164642,0.3169932961463928,0.18734607100486755,0.07954344153404236,0.3679559528827667,-0.010914602316915989,-0.027620282024145126,-0.44060221314430237,-0.16875620186328888,-0.15967833995819092,0.163986936211586,-0.28459081053733826,-0.22297020256519318,0.2047833949327469,-0.07143211364746094,-0.1322251260280609,-0.1455933004617691,-0.22847656905651093,-0.20918671786785126,0.15659266710281372,-0.25486472249031067,-0.08286029100418091,-0.20704114437103271,0.2928534746170044,0.10983089357614517,-0.16842040419578552,-0.3087126612663269},{0.005713008344173431,0.1630190759897232,0.04140502214431763,-0.017142126336693764,0.11549705266952515,-0.3315890431404114,-0.11832357197999954,-0.18204377591609955,-0.028871145099401474,-0.2191983014345169,-0.3135903775691986,-0.05995677784085274,-0.13256344199180603,-0.022791722789406776,-0.12270163744688034,0.36508792638778687,-0.031070778146386147,-0.18095488846302032,0.0994877740740776,0.33237218856811523,-0.10232014954090118,-0.2378109097480774,0.2742922604084015,0.09001138061285019,-0.0460624136030674,-0.3166818618774414,-0.2999694347381592,-0.3142145872116089,-0.3342517018318176,-0.27142342925071716,0.02508620359003544,-0.30288684368133545},{0.09761492908000946,0.32742753624916077,-0.2621787190437317,-0.32524141669273376,-0.22723565995693207,0.08756367862224579,0.055345434695482254,0.07727460563182831,0.13403350114822388,-0.2923344075679779,-0.18918658792972565,0.3377220332622528,-0.24897687137126923,-0.185638889670372,0.19909828901290894,-0.28960058093070984,0.27146029472351074,0.16179071366786957,0.3548946678638458,0.021518997848033905,0.20370151102542877,0.06939442455768585,0.26709622144699097,-0.10289205610752106,0.3763945698738098,-0.22877228260040283,0.13124977052211761,0.3350614607334137,-0.28581151366233826,0.22806057333946228,0.006616087630391121,0.1565212607383728},{-0.1821700930595398,0.12812979519367218,-0.2515033781528473,-0.17353664338588715,0.17910195887088776,-0.15189166367053986,0.1080019623041153,0.007343792822211981,0.13735170662403107,-0.04092492535710335,-0.276050865650177,-0.3060087263584137,-0.34358644485473633,-0.058060236275196075,-0.25272735953330994,0.1087820827960968,0.06625261157751083,-0.19937193393707275,0.25662705302238464,0.11838681995868683,-0.0032251577358692884,0.00025734302471391857,0.2938258945941925,-0.19675853848457336,0.31885358691215515,0.09328574687242508,-0.25595319271087646,0.022321680560708046,-0.03720689192414284,0.11390838027000427,-0.11524534970521927,0.07864931225776672},{0.09516678005456924,0.03553841635584831,0.19685639441013336,-0.2804983854293823,-0.34111422300338745,-0.24244414269924164,-0.2805479168891907,0.016539566218852997,-0.23564660549163818,0.46401330828666687,0.1624133288860321,-0.2297622710466385,-0.39241546392440796,-0.07664696127176285,-0.1931830495595932,-0.09576139599084854,0.1864730566740036,-0.17427702248096466,0.2734997570514679,-0.14786426723003387,-0.16490228474140167,-0.002582687884569168,0.1949000358581543,0.22676201164722443,0.17309243977069855,-0.14171937108039856,0.014010081067681313,-0.09156368672847748,-0.05436013638973236,0.021954718977212906,-0.0413973294198513,0.12980931997299194},{-0.16922922432422638,-0.12795253098011017,0.21641892194747925,0.288224458694458,0.2768268585205078,-0.03473692759871483,0.07167573273181915,-0.22365105152130127,-0.02729417383670807,-0.27860504388809204,0.2628415524959564,-0.22582334280014038,-0.1895194947719574,-0.194837287068367,0.24721281230449677,-0.007337681017816067,-0.0002853935002349317,0.027235932648181915,0.360702782869339,0.039236534386873245,-0.18490582704544067,0.22461043298244476,0.10442724823951721,-0.06423739343881607,0.23290301859378815,-0.09903086721897125,-0.1714935600757599,0.21614281833171844,0.1602538824081421,0.01831802725791931,-0.2893334925174713,-0.23116010427474976},{0.3231765031814575,-0.2861112058162689,0.014831162989139557,-0.30430495738983154,-0.034855544567108154,-0.18289783596992493,0.0930180549621582,0.1667628437280655,0.22838734090328217,0.07576195895671844,0.17412450909614563,0.2766778767108917,-0.41518864035606384,-0.38078776001930237,-0.03905520215630531,-0.226387619972229,-0.2799605131149292,-0.33938899636268616,0.32346221804618835,-0.17169106006622314,0.36023256182670593,-0.13612812757492065,0.015304473228752613,0.20374639332294464,0.1422135978937149,-0.1235443726181984,0.12714184820652008,0.007339274976402521,0.10477617383003235,0.0032425152603536844,-0.2964569628238678,0.017372196540236473},{0.26726534962654114,-0.02971675992012024,-0.01116066426038742,0.36498287320137024,-0.09817498922348022,-0.17652210593223572,-0.038124486804008484,0.16459335386753082,0.18534225225448608,0.25791704654693604,0.12610509991645813,-0.11330537497997284,0.06261695921421051,0.20386293530464172,-0.10810151696205139,0.11868871003389359,0.23243920505046844,-0.241042360663414,0.11373335123062134,-0.34948301315307617,0.26488110423088074,0.1451893448829651,-0.09859681874513626,0.20111073553562164,0.2445531040430069,0.08489008992910385,0.14744779467582703,0.08368710428476334,0.08670162409543991,-0.14064614474773407,0.016390971839427948,0.3732099235057831},{0.06383100152015686,-0.20266665518283844,-0.0030884251464158297,0.10205932706594467,-0.2776710093021393,0.0061872792430222034,0.04344256967306137,-0.2113778442144394,-0.16841945052146912,-0.015042032115161419,0.18915389478206635,0.20415012538433075,0.08711940050125122,0.23747500777244568,-0.029695376753807068,-0.033103927969932556,-0.22019806504249573,0.26714763045310974,-0.07713767886161804,-0.22044260799884796,-0.20369981229305267,-0.09858185052871704,0.15034270286560059,0.041837044060230255,-0.0044137900695204735,-0.132860466837883,-0.18065199255943298,0.22222790122032166,0.06422021985054016,-0.14402738213539124,0.2627467215061188,0.16246648132801056},{0.1708308607339859,-0.22997723519802094,0.013310395181179047,-0.19516445696353912,-0.016499826684594154,0.1546838879585266,0.07023253291845322,0.27059686183929443,-0.10415495187044144,-0.015090967528522015,0.22690895199775696,0.11322441697120667,0.05688631534576416,-0.09696255624294281,-0.01834619604051113,0.20354487001895905,-0.3493359684944153,-0.19755719602108002,-0.04453599825501442,0.0814746543765068,0.03578367829322815,0.2511066794395447,0.15899613499641418,0.1859995573759079,0.05988460034132004,0.1808745265007019,-0.0214085690677166,-0.06279139965772629,0.09769134968519211,-0.111721932888031,-0.2573321759700775,0.3126791715621948},{0.1420629918575287,0.02900824137032032,-0.38193219900131226,0.10624818503856659,0.045497503131628036,-0.01965334266424179,0.3527382016181946,0.10552822798490524,0.07985460758209229,-0.11740352213382721,0.22074958682060242,-0.27463117241859436,-0.4466608464717865,0.26794520020484924,0.08802491426467896,0.06623309850692749,-0.0034235878847539425,-0.08540390431880951,-0.16270709037780762,0.051173239946365356,-0.061355240643024445,0.2514936029911041,0.09783243387937546,-0.17286880314350128,-0.08921895921230316,-0.21068401634693146,0.0693560317158699,0.35839536786079407,0.22758923470973969,-0.22036521136760712,0.20103105902671814,0.15925802290439606},{-0.07940404117107391,-0.0026466078124940395,-0.08398879319429398,-0.07743823528289795,-0.23539383709430695,-0.03014053963124752,0.23037008941173553,0.17191942036151886,0.13817857205867767,0.010784829035401344,0.18546772003173828,-0.019825294613838196,0.22868481278419495,0.2203032672405243,0.167508065700531,-0.09506887197494507,0.12960340082645416,0.20001550018787384,0.21000558137893677,0.0398588664829731,0.1772773414850235,0.2878325283527374,0.07461845874786377,0.16831888258457184,-0.029569240286946297,-0.060410864651203156,-0.14041997492313385,-0.23465974628925323,0.1347489207983017,-0.2791524827480316,0.03860720992088318,-0.07459580898284912},{-0.33864670991897583,0.022449661046266556,-0.33901670575141907,-0.33736085891723633,0.04431331157684326,-0.014669209718704224,0.14295034110546112,-0.1696593463420868,0.07719095796346664,0.3585999011993408,0.006360754836350679,-0.24061386287212372,0.06638304889202118,-0.18298007547855377,-0.32895427942276,0.027154458686709404,-0.1746973693370819,0.12573710083961487,-0.08775221556425095,0.007632284425199032,-0.29749879240989685,0.15478910505771637,0.09366053342819214,0.06216870993375778,-0.08091647922992706,0.34338313341140747,0.033471908420324326,-0.21150490641593933,-0.21125833690166473,0.009666184894740582,-0.21504637598991394,-0.2724928855895996},{-0.007728250231593847,-0.25729385018348694,-0.2846449613571167,-0.052553799003362656,-0.32446369528770447,-0.14634647965431213,0.1843727082014084,-0.28308263421058655,-0.2269703894853592,0.17325277626514435,0.19449420273303986,0.08679969608783722,0.1123766303062439,-0.14886146783828735,0.27887141704559326,-0.2708240747451782,0.09534849226474762,0.261504590511322,0.04628340154886246,0.2790096402168274,0.01102092582732439,-0.11563392728567123,-0.2818460464477539,0.22397463023662567,-0.11468673497438431,-0.15893423557281494,0.11796648055315018,0.04213886335492134,-0.11828605830669403,-0.33282890915870667,-0.033569589257240295,-0.18860842287540436},{0.2138245850801468,0.08533308655023575,-0.08072318881750107,0.23488272726535797,-0.2493244707584381,0.07856763899326324,-0.09172040969133377,-0.22685883939266205,-0.07250847667455673,0.24655161798000336,-0.3535427153110504,-0.15180377662181854,0.03242728114128113,-0.2129042148590088,-0.39137721061706543,-0.19024375081062317,-0.13445709645748138,-0.34975942969322205,-0.288887619972229,0.211441308259964,0.18053202331066132,0.06264045089483261,-0.3833571672439575,0.32690873742103577,0.12168355286121368,0.32395800948143005,-0.32803937792778015,-0.14276662468910217,0.10706926137208939,-0.22311563789844513,0.0780697837471962,0.18587364256381989},{-0.053980764001607895,-0.29470396041870117,-0.049628760665655136,-0.3104926645755768,-0.07206954807043076,0.29893872141838074,0.2068379521369934,0.029767831787467003,-0.11245357245206833,0.009565796703100204,-0.15444545447826385,0.0966796800494194,0.09354734420776367,0.061872828751802444,0.12106811255216599,0.033478572964668274,-0.07917871326208115,0.14524757862091064,-0.11523541063070297,0.1509820520877838,0.18789248168468475,0.2610238790512085,-0.03189675137400627,-0.2504951059818268,0.16719292104244232,0.15856599807739258,0.2831580638885498,0.17147578299045563,0.02771044708788395,0.10223431140184402,0.018315264955163002,-0.10311292111873627},{-0.01768956333398819,-0.19790233671665192,0.23756510019302368,0.053968362510204315,0.29077988862991333,-0.01702398806810379,-0.13484062254428864,-0.18772076070308685,0.1329515427350998,-0.048411089926958084,0.08452533185482025,0.013712378218770027,-0.30321627855300903,0.05124199762940407,-0.08962699770927429,-0.2610407769680023,-0.04340682178735733,-0.0558466836810112,0.18411971628665924,0.20371578633785248,0.027462568134069443,0.05257325991988182,0.16908423602581024,0.2949260473251343,-0.18260931968688965,-0.049469612538814545,0.17464452981948853,-0.06902950257062912,-0.14653773605823517,-0.2526819109916687,0.30028554797172546,0.01785598136484623},{0.20122116804122925,-0.07091876864433289,0.04871218651533127,0.11292903870344162,-0.04316956177353859,0.05581813305616379,-0.2476874440908432,0.3139055073261261,-0.12568393349647522,-0.04178368300199509,0.13131624460220337,-0.29109081625938416,0.04707099869847298,-0.06449215114116669,-0.11115878075361252,0.31907254457473755,-0.07995965331792831,-0.18075476586818695,0.04457719251513481,0.014683199115097523,-0.18138740956783295,0.17391550540924072,0.22464020550251007,0.23849964141845703,-0.2545660138130188,0.10854147374629974,-0.0622282437980175,0.08039942383766174,-0.27118244767189026,0.25991764664649963,-0.04710286483168602,0.039588745683431625}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.23793190717697144,-0.1236596331000328,0.11129835247993469,-0.19246193766593933},{0.20605923235416412,-0.25067657232284546,0.2750040292739868,0.23322713375091553},{-0.3045317530632019,0.052504219114780426,0.1479092240333557,-0.04467158019542694},{0.30535662174224854,0.4726192057132721,0.31770646572113037,0.03826689347624779},{-0.3008835017681122,0.15520133078098297,-0.2788059413433075,0.13774003088474274},{0.007810954004526138,-0.10889124870300293,0.08977045118808746,0.357437402009964},{-0.11063176393508911,-0.2094927579164505,-0.4032045304775238,-0.008756506256759167},{-0.12472741305828094,-0.3727106750011444,0.17543703317642212,-0.06914852559566498},{-0.1330927163362503,0.17372135818004608,-0.0837317630648613,-0.11457044631242752},{0.2810514569282532,-0.009147761389613152,-0.1351505070924759,-0.21610940992832184},{0.22790686786174774,-0.2188466191291809,0.3174744248390198,0.2554866671562195},{-0.06767454743385315,0.019880538806319237,0.4373367130756378,-0.11419869214296341},{-0.33008578419685364,0.2585362195968628,-0.0380442850291729,-0.08709142357110977},{-0.18393473327159882,-0.0063981665298342705,-0.2335326224565506,0.07922854274511337},{0.2008701115846634,-0.055941130965948105,0.2362954318523407,0.10500599443912506},{-0.14349403977394104,-0.300203800201416,-0.1226394847035408,-0.09224946051836014},{-0.29894495010375977,0.04919523745775223,-0.05514851212501526,0.340422660112381},{-0.30770406126976013,-0.14527738094329834,-0.23154722154140472,0.2200547456741333},{-0.08132114261388779,-0.1300988346338272,0.41440093517303467,0.07882131636142731},{-0.1479196697473526,-0.17686058580875397,-0.02000051736831665,-0.17812198400497437},{0.17513753473758698,0.1401847004890442,0.12855876982212067,-0.16992013156414032},{0.0005540102138184011,-0.2904511094093323,-0.18250784277915955,0.31259578466415405},{0.293378621339798,-0.17165380716323853,0.20290160179138184,0.039643000811338425},{-0.2955911457538605,-0.046631019562482834,-0.2893621623516083,-0.2914881408214569},{-0.2645820081233978,-0.1780194342136383,0.015556443482637405,-0.13827931880950928},{0.22198916971683502,0.22116273641586304,-0.09717310220003128,0.15733003616333008},{0.1792399138212204,-0.21242567896842957,0.254390150308609,0.08710014820098877},{-0.04446844011545181,-0.17360162734985352,0.012328590266406536,0.3321763873100281},{0.0921761617064476,0.04078564792871475,0.014103938825428486,0.024283135309815407},{-0.19553597271442413,0.10488374531269073,0.2918011546134949,0.00914401188492775},{-0.15611448884010315,-0.152642622590065,0.0901264175772667,0.23523443937301636},{0.21627017855644226,0.23286829888820648,0.281620055437088,-0.040882211178541183}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.033273566514253616,-0.007992119528353214,-0.01122212689369917,0.04560781270265579,0.045880433171987534,-0.06715304404497147,-0.023120775818824768,0.06992174685001373,-0.08359023183584213,-0.03437209129333496,0.0042113508097827435,0.010893207043409348,-0.02315368503332138,0.06301812827587128,-0.019796455278992653,-0.03699801117181778};
static const float actor_encoder_self_encoder_2_bias[16] = {0.007684845943003893,-0.014980582520365715,-0.014995272271335125,0.0009663821547292173,-0.04921865090727806,0.02432161383330822,-0.02908700704574585,-0.010712211951613426,0.02631995640695095,-0.042160823941230774,0.006011429708451033,-0.023476403206586838,-0.013618724420666695,-0.02596987597644329,-0.005434402730315924,-0.02854149416089058};
static const float actor_encoder_feed_forward_0_bias[32] = {0.003889856394380331,0.05445084720849991,-0.013757229782640934,0.011929964646697044,-0.01563187502324581,0.027668559923768044,-0.039081674069166183,-0.0036859081592410803,-0.01231651846319437,-0.022255342453718185,-0.003703043330460787,0.03279196098446846,0.017418069764971733,0.011387706734240055,0.045167092233896255,-0.03928123041987419,0.013779258355498314,-0.006865203380584717,0.02120056189596653,-0.03160621225833893,-0.008472325280308723,0.026975197717547417,-0.0016664721770212054,-0.039364028722047806,-0.050000835210084915,0.014388063922524452,0.02327732928097248,0.02946210280060768,-0.015923328697681427,0.030580634251236916,0.03120126575231552,-0.0029391206335276365};
static const float action_parameterization_distribution_linear_bias[4] = {0.000995120732113719,0.011361373588442802,0.010962833650410175,0.031143974512815475};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.39788779616355896,-0.37860605120658875,-0.1425134688615799,0.22430472075939178,-0.214015394449234,0.0932728573679924,-0.34982219338417053,0.04743810370564461},{0.19896291196346283,0.11085065454244614,0.40204620361328125,0.38335126638412476,-0.13122078776359558,-0.3487139642238617,0.29801174998283386,0.4019303321838379},{0.06765275448560715,0.17680229246616364,0.1141158938407898,-0.04031604528427124,0.3303130865097046,0.2202313393354416,-0.021318459883332253,0.24993886053562164},{0.11245477944612503,-0.3579936921596527,0.3404988944530487,-0.1558934897184372,-0.23096296191215515,0.1016509011387825,0.3069387972354889,0.26004838943481445},{-0.2540096342563629,-0.0787452757358551,-0.04394173622131348,-0.27265891432762146,0.14343084394931793,0.1241963729262352,0.3426835536956787,0.2904157340526581},{-0.06242664158344269,0.19636960327625275,-0.0040228101424872875,-0.20544414222240448,0.3460521399974823,0.12333609163761139,0.10520879924297333,-0.15750978887081146},{0.00297668413259089,0.16781529784202576,0.1464119404554367,-0.14960171282291412,0.4417923390865326,-0.10759452730417252,0.1581798642873764,0.11124087125062943},{0.054459068924188614,-0.4333621561527252,-0.038657378405332565,-0.2302521914243698,0.28698620200157166,0.03607768937945366,-0.1597461700439453,-0.328433632850647},{-0.26566076278686523,0.17154106497764587,-0.010851345956325531,-0.08212067931890488,-0.004285070113837719,0.452242374420166,0.36703401803970337,0.2867523729801178},{-0.0056030103005468845,-0.14099103212356567,-0.27247488498687744,0.2814565896987915,0.2875775992870331,0.3279646337032318,0.35294607281684875,-0.32011520862579346},{-0.16378723084926605,-0.37921616435050964,0.36245232820510864,0.1845434308052063,0.015020083636045456,-0.2581285238265991,0.03637202829122543,-0.33094313740730286},{0.23668359220027924,0.03539576381444931,0.4086710512638092,0.4065091013908386,-0.11392510682344437,0.33334556221961975,0.22295299172401428,-0.33306756615638733},{-0.38605207204818726,0.14108000695705414,-0.3522816002368927,0.44301435351371765,-0.023703860118985176,0.42795222997665405,0.019810087978839874,0.26401808857917786},{-0.06297603994607925,0.17393390834331512,-0.13191735744476318,-0.10865665227174759,0.013280276209115982,0.14736279845237732,0.30240920186042786,0.008794394321739674},{0.11671075969934464,-0.33203208446502686,-0.3525591790676117,-0.16642548143863678,0.1237223744392395,-0.1614164412021637,0.10962794721126556,-0.09758873283863068},{-0.4654393494129181,-0.3373848497867584,-0.26973602175712585,-0.0004415347066242248,-0.04463786631822586,0.21850194036960602,0.20199760794639587,-0.08732878416776657},{-0.1763192117214203,-0.3163657486438751,0.23192982375621796,-0.3537238836288452,-0.0014585016760975122,0.0338045097887516,-0.4382394850254059,-0.2801084518432617},{0.06184445694088936,0.20582230389118195,0.14043812453746796,0.19449925422668457,-0.11390743404626846,0.3370983600616455,0.266918808221817,-0.20260320603847504},{0.06486059725284576,-0.35541343688964844,-0.07751413434743881,-0.05834159627556801,-0.15089231729507446,-0.3389671742916107,0.025112342089414597,-0.30351948738098145},{-0.026601973921060562,-0.007022101432085037,0.10865538567304611,-0.3021571934223175,0.04140341281890869,0.11566450446844101,0.06201688200235367,-0.1282743662595749},{0.1032998338341713,-0.10800311714410782,0.06679151952266693,-0.2571828067302704,-0.008836563676595688,-0.0074239084497094154,-0.042955171316862106,-0.24713291227817535},{-0.3116537034511566,0.18473432958126068,0.1409139782190323,-0.23677657544612885,-0.47605085372924805,0.010126087814569473,0.11991769820451736,-0.0002588346251286566},{0.2960215210914612,0.11749662458896637,-0.4188975691795349,0.12812185287475586,-0.06758591532707214,0.22310832142829895,0.22065560519695282,0.28920799493789673},{0.01629597693681717,-0.11156763136386871,-0.01895388774573803,0.315133273601532,-0.3198046386241913,-0.06624451279640198,-0.1683104783296585,-0.3212610185146332},{0.22533807158470154,0.08538854122161865,-0.4495057463645935,0.3436639904975891,-0.30297189950942993,-0.3513644337654114,-0.34952282905578613,0.17359846830368042},{0.056563522666692734,0.35903170704841614,-0.31348738074302673,-0.05118059366941452,0.07691334187984467,-0.2564655840396881,0.3126637637615204,-0.2864585220813751},{-0.06838975101709366,0.06496524810791016,-0.16379965841770172,-0.14559879899024963,0.02667400985956192,-0.18657377362251282,-0.10562661290168762,-0.13971057534217834},{0.14779730141162872,-0.17966145277023315,-0.06726840138435364,-0.09981922060251236,-0.0028079471085220575,0.003639965085312724,-0.2113056778907776,0.08675750344991684},{0.36476534605026245,0.052001938223838806,-0.409482479095459,-0.1906757354736328,-0.26111894845962524,0.10102193802595139,0.21697968244552612,0.07675309479236603},{0.41239792108535767,-0.3017010986804962,-0.040258534252643585,-0.032287999987602234,0.10811864584684372,-0.13171975314617157,0.19384904205799103,0.345148503780365},{-0.2333257794380188,-0.16462615132331848,0.025355065241456032,-0.2461155503988266,0.322304368019104,-0.2587970197200775,0.035355910658836365,0.08779449015855789},{0.19829028844833374,0.017850862815976143,-0.1541714072227478,0.34392496943473816,0.07989075779914856,0.009454896673560143,-0.046083591878414154,0.02744409441947937}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24352598190307617,0.4128996729850769,-0.6084353923797607,-0.576258659362793,-0.2713916301727295,0.05432832986116409,-0.43118974566459656,0.5520175695419312},{-0.032243888825178146,0.5319657921791077,-0.2191988080739975,0.5332777500152588,-0.01303219236433506,0.04481891915202141,-0.23167474567890167,-0.002894182223826647},{-0.4624147117137909,-0.21447335183620453,-0.16806216537952423,-0.2199789434671402,0.5287657380104065,0.1806226223707199,0.01641017757356167,0.42966654896736145},{-0.5037693381309509,-0.4701356589794159,0.29144179821014404,0.33981165289878845,-0.531784176826477,-0.19205047190189362,0.5492221117019653,0.19437240064144135},{-0.302555114030838,-0.32349586486816406,-0.3017602562904358,-0.29015955328941345,0.3402191400527954,-0.29536837339401245,0.5107887387275696,-0.4679930806159973},{-0.08569709211587906,0.17032559216022491,0.3125549554824829,-0.5696265697479248,0.5429812669754028,-0.32506227493286133,-0.4183407723903656,-0.312123566865921},{-0.4172113537788391,0.1700655072927475,0.0773567408323288,-0.3743799924850464,-0.02827812172472477,-0.5443058609962463,0.490230530500412,0.07405229657888412},{-0.38965749740600586,-0.3147118091583252,-0.22203665971755981,-0.413152813911438,-0.30942296981811523,0.11573401093482971,0.4994065463542938,-0.3064233064651489}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.028312288224697113,-0.03341414034366608,-0.016801603138446808,0.012817096896469593,-0.04052245244383812,-0.016730234026908875,-0.1064116433262825,0.017933277413249016};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.00912765134125948,-0.03634290024638176,-0.008624750189483166,0.048922158777713776,-0.03112959675490856,0.031180474907159805,-0.05384238436818123,0.05013684928417206};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

