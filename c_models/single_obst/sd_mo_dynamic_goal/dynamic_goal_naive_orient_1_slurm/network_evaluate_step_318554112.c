#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2768280506134033,-0.0960361510515213,0.2687075138092041,0.14773479104042053,-0.31245994567871094,0.26762083172798157,-0.06809777021408081,-0.1504640430212021,0.14353501796722412,0.2945159077644348,0.12749317288398743,0.041196245700120926,0.25446391105651855,-0.26046645641326904,0.27213865518569946,-0.07097788900136948},{-0.1679910123348236,-0.35664722323417664,0.3364405333995819,0.13973882794380188,-0.26859188079833984,0.16681264340877533,-0.412284255027771,-0.02973419427871704,-0.0913277417421341,-0.19461840391159058,0.037295613437891006,-0.21713685989379883,0.009972436353564262,-0.33043697476387024,-0.2677919566631317,0.09691667556762695},{-0.07363593578338623,-0.25900235772132874,-0.4059198796749115,0.1580069214105606,0.2355521321296692,0.5246979594230652,0.04298358038067818,-0.0488136000931263,0.06316697597503662,-0.48996850848197937,-0.38964399695396423,0.730012059211731,-0.19340716302394867,-0.3000015616416931,-0.35532569885253906,0.24748004972934723},{0.14623485505580902,0.24960683286190033,0.38143861293792725,-0.020432157441973686,-0.4309045970439911,-0.00924766343086958,0.2641218602657318,0.06054917350411415,0.3077774941921234,-0.37917444109916687,0.007132126018404961,0.4137754738330841,-0.26122137904167175,0.06325910985469818,0.47753044962882996,-0.46899542212486267},{-0.08830727636814117,-0.03232700377702713,0.3170849084854126,-0.018216323107481003,0.34098556637763977,0.4509772062301636,0.24111777544021606,-0.002995644696056843,0.12881092727184296,0.21444430947303772,0.2887917459011078,-0.3305049538612366,-0.273666113615036,-0.4294043481349945,0.43144914507865906,0.08647628873586655},{-0.18737006187438965,-0.1973520666360855,-0.188602015376091,-0.10647793114185333,0.15120840072631836,0.1557449996471405,0.048791661858558655,-0.13254794478416443,0.35002976655960083,-0.2973448634147644,-0.4231864809989929,0.21993952989578247,0.17949163913726807,-0.12168397754430771,-0.07036833465099335,0.05916476622223854},{0.03476400673389435,0.02911107800900936,0.05576437711715698,-0.4763789772987366,0.21996568143367767,-0.02804921567440033,0.06805003434419632,0.3956853747367859,0.33274877071380615,0.09094090014696121,-0.4284135401248932,-0.008603734895586967,-0.02613350935280323,0.13657286763191223,-0.1859019547700882,-0.23406104743480682},{-0.29872414469718933,0.3538258373737335,0.32319650053977966,0.4250757694244385,-0.4729870557785034,-0.05395251885056496,0.505498468875885,0.5021597743034363,-0.1989852637052536,0.3718870282173157,-0.6796512007713318,-0.34566736221313477,0.38298919796943665,0.15828679502010345,0.30147919058799744,0.39623960852622986},{0.3469131886959076,-0.28279948234558105,0.6253179907798767,0.13002312183380127,0.0219313632696867,0.07507019490003586,0.17803311347961426,-0.5630711317062378,-0.15671220421791077,-0.4539027512073517,-0.16680081188678741,-0.017780616879463196,-0.13767968118190765,0.6626065969467163,0.46194693446159363,-0.29911497235298157},{0.2463490217924118,-0.6179895997047424,-0.5992979407310486,-0.2539341151714325,-0.21867743134498596,0.2533412575721741,0.19021238386631012,0.20962975919246674,0.5958402156829834,0.24631035327911377,0.15522590279579163,-0.3105625808238983,-0.09742165356874466,0.3784169852733612,-0.1649312525987625,-0.5220046639442444},{0.19381503760814667,0.3338436484336853,0.4169144034385681,-0.6633639335632324,-0.3351200222969055,0.12741556763648987,0.15325678884983063,0.4487704038619995,-0.3584829568862915,0.06912188231945038,-0.12258509546518326,0.007385294418781996,-0.178610697388649,-0.2104777693748474,0.2675589919090271,-0.3596072196960449},{-0.015168953686952591,-0.3967956006526947,0.16889065504074097,0.536362886428833,0.7251023054122925,0.43560847640037537,0.3549620509147644,0.3934212625026703,0.026127923280000687,0.03173275664448738,0.24944642186164856,-0.43010616302490234,-0.5281528830528259,-0.4302355945110321,0.6711356043815613,-0.021598096936941147},{-0.2946226894855499,0.42849451303482056,-0.02793746441602707,-0.6061062216758728,0.15019144117832184,0.036885835230350494,0.1985914707183838,0.17796042561531067,0.06842812895774841,0.07791538536548615,-0.001824190840125084,0.19616301357746124,0.4380762577056885,0.35249271988868713,-0.05103040486574173,-0.10352975875139236},{0.029456965625286102,-0.3933551609516144,-0.2593451142311096,-0.12407395988702774,-0.4415549337863922,0.03836938366293907,-0.23414403200149536,-0.22037391364574432,-0.18762503564357758,-0.0847097709774971,-0.42995452880859375,-0.006755772512406111,-0.25940343737602234,0.45557376742362976,0.22392268478870392,-0.026298347860574722},{0.06701362878084183,-0.33532312512397766,-0.23536930978298187,0.19848932325839996,-0.09876585751771927,-0.4653603434562683,0.2632412910461426,-0.05753787234425545,-0.0008123982115648687,0.37144699692726135,0.1102081760764122,0.04172253608703613,0.298056960105896,-0.03461851552128792,-0.3220946192741394,0.22419756650924683},{0.3794655203819275,0.018901357427239418,-0.22288402915000916,-0.21001145243644714,-0.3286531865596771,0.1976306289434433,0.3370005786418915,-0.08288175612688065,0.20574353635311127,0.36154019832611084,-0.15108463168144226,0.07889735698699951,-0.21563182771205902,0.2468009740114212,-0.09434880316257477,-0.01669505052268505},{-0.20434191823005676,-0.19665975868701935,0.23055151104927063,0.1284995675086975,-0.20953316986560822,0.10306321084499359,-0.21956023573875427,-0.1203254759311676,-0.22460129857063293,-0.256203293800354,-0.07164795696735382,-0.25997260212898254,0.11486267298460007,-0.22911891341209412,0.034715503454208374,-0.20497694611549377},{-0.28585588932037354,0.2346111536026001,-0.3514975309371948,-0.23193827271461487,0.03712505102157593,0.3391208052635193,-0.247637540102005,-0.2499074786901474,0.17506033182144165,0.1938708871603012,0.34707289934158325,-0.09386631101369858,-0.3592320680618286,0.3403967022895813,0.02776409313082695,-0.42578360438346863}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.05823087319731712,-0.029461955651640892,-0.1055031344294548,-0.3407570421695709,0.3213037848472595,0.2957784831523895,0.10195566713809967,0.047056641429662704,-0.11078119277954102,-0.13788193464279175,-0.0236371960490942,0.07466939836740494,0.2004060000181198,0.37944281101226807,0.08281272649765015,0.08174478262662888},{-0.19200921058654785,-0.3005954921245575,-0.04580242559313774,0.07459601014852524,0.22867245972156525,-0.328896164894104,0.05279324948787689,0.05114087462425232,-0.0787319764494896,0.25070419907569885,-0.24370715022087097,0.31177186965942383,-0.3706749379634857,0.20197400450706482,-0.3905844986438751,-0.34613728523254395},{0.08032014966011047,0.2142687290906906,-0.35352930426597595,-0.5231935977935791,0.17771516740322113,0.48731598258018494,-0.08598768711090088,0.0722174271941185,-0.26936665177345276,-0.2900669276714325,-0.005111795850098133,0.32882922887802124,-0.3057155907154083,-0.19173212349414825,0.1032264232635498,-0.07498787343502045},{0.1778949797153473,-0.0563553050160408,0.07659769058227539,0.1953347623348236,-0.5059888958930969,-0.0015455210814252496,0.08891808986663818,-0.18538479506969452,0.30410242080688477,0.3674802780151367,-0.18066629767417908,-0.12397889792919159,-0.44110485911369324,-0.4302327036857605,0.15960076451301575,0.17009347677230835},{-0.12434526532888412,0.12240514904260635,0.006128404755145311,0.25586411356925964,-0.22795835137367249,0.06754346191883087,-0.006927164737135172,0.1419605165719986,0.2692412734031677,-0.286627858877182,0.19267822802066803,0.289233535528183,0.20051605999469757,-0.45427000522613525,0.021561767905950546,-0.010568777099251747},{0.23703965544700623,0.2665959596633911,-0.047928910702466965,0.19047079980373383,-0.48434069752693176,-0.41897106170654297,0.2610631585121155,0.2902890741825104,0.12597957253456116,0.3623514175415039,0.24669770896434784,-0.22032591700553894,-0.01703733764588833,-0.14538471400737762,-0.04564977437257767,0.30763235688209534},{-0.09514722973108292,0.2682795524597168,0.2876526713371277,-0.3764771521091461,-0.25346890091896057,0.017837440595030785,-0.3394239544868469,-0.06635578721761703,0.1688350886106491,0.08855748921632767,-0.14294351637363434,-0.20731396973133087,-0.3271227478981018,-0.009981761686503887,0.2085024118423462,0.041811686009168625},{-0.1767989844083786,-0.14587388932704926,-0.4896542727947235,0.31090161204338074,-0.3442094922065735,-0.257164865732193,-0.24560783803462982,-0.4141574501991272,0.1456809788942337,-0.26692286133766174,0.04129251465201378,0.10348988324403763,-0.1717934012413025,0.43727296590805054,-0.07648865878582001,-0.34623587131500244},{-0.33129432797431946,0.2716216742992401,0.0010793847031891346,-0.014404340647161007,0.26635611057281494,-0.28134265542030334,0.3286147713661194,0.14808912575244904,0.33692845702171326,0.3040277659893036,0.26744794845581055,0.3105909824371338,0.18830308318138123,-0.0365048423409462,0.2706046402454376,0.11600125581026077},{0.05194367840886116,-0.2654121220111847,-0.18874670565128326,-0.11106228083372116,0.26844292879104614,-0.1868235468864441,-0.29637688398361206,-0.16866563260555267,0.08063456416130066,-0.3726602792739868,-0.2871604561805725,0.355273574590683,0.12053178995847702,0.1652752310037613,-0.3901732861995697,0.23788675665855408},{-0.07752859592437744,-0.46117812395095825,0.33552300930023193,0.3055589199066162,0.23467253148555756,0.15867730975151062,0.19180019199848175,-0.1505378782749176,0.2526494264602661,-0.2965717613697052,0.2080976516008377,0.3903493881225586,0.5070129632949829,0.10211508721113205,-0.1272624135017395,0.10026368498802185},{0.058128472417593,-0.009429174475371838,0.3893992304801941,-0.0023375710006803274,-0.255361407995224,-0.1785900890827179,0.4349566102027893,0.27913644909858704,-0.246242955327034,-0.214130699634552,-0.08419716358184814,-0.3169279396533966,-0.028146175667643547,-0.2868690490722656,-0.3889186680316925,0.05009222775697708},{-0.0993804857134819,-0.3212369382381439,0.41080373525619507,-0.2311313897371292,0.36131930351257324,-0.301257848739624,-0.47799915075302124,0.08084564656019211,0.07679417729377747,0.06398259848356247,-0.3462548851966858,0.13474060595035553,0.08769793808460236,-0.2925604283809662,-0.3936519920825958,-0.018007729202508926},{0.357020765542984,-0.3349582254886627,0.457204669713974,0.08304592221975327,-0.08700243383646011,0.3178439140319824,-0.10312844812870026,-0.24082285165786743,-0.4224318861961365,0.11716881394386292,0.008423810824751854,-0.3593987226486206,-0.10286615788936615,0.13029207289218903,0.3195580244064331,0.04333982989192009},{-0.10234896093606949,0.2401447892189026,0.11472486704587936,-0.4391169846057892,-0.22751480340957642,0.19106633961200714,0.28880414366722107,-0.252532035112381,0.2037978172302246,-0.336074560880661,0.04018967226147652,0.10504559427499771,-0.062129564583301544,0.17942219972610474,0.029176810756325722,0.09175911545753479},{-0.1941690742969513,0.39650699496269226,-0.43118202686309814,0.37131866812705994,0.1301373392343521,-0.41432449221611023,-0.03771485388278961,-0.08566753566265106,-0.3096792697906494,0.3797546625137329,-0.34737107157707214,0.31189823150634766,-0.07318346947431564,-0.32532286643981934,-0.2552240788936615,-0.5027408599853516}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.17021416127681732,0.13034503161907196,-0.03391494229435921,-0.059921156615018845,-0.11947451531887054,0.05008314922451973,0.28835517168045044,0.10850205272436142,-0.21217606961727142,-0.17404016852378845,0.16356174647808075,-0.30377697944641113,-0.24091346561908722,0.2366822212934494,0.22764262557029724,0.3441160321235657,-0.25802385807037354,-0.2753523290157318,-0.19770945608615875,0.12591370940208435,-0.08798091113567352,-0.29214707016944885,-0.22057397663593292,-0.29535120725631714,-0.25953173637390137,0.1728450506925583,-0.19742456078529358,0.0001450125128030777,-0.03445031866431236,-0.03310506418347359,0.24423031508922577,-0.23469313979148865},{0.2825383245944977,0.1625349223613739,0.1563127189874649,-0.12036123126745224,0.15063896775245667,-0.1343473494052887,0.3986411988735199,0.13447284698486328,-0.1551324427127838,-0.07381202280521393,-0.12526266276836395,-0.2894461452960968,-0.16718120872974396,0.2591674029827118,-0.2544451057910919,-0.20938311517238617,-0.044940508902072906,0.20937694609165192,-0.3821111023426056,-0.22765637934207916,-0.0332043431699276,0.23841163516044617,0.04721708223223686,0.02690613642334938,0.21801431477069855,-0.34782418608665466,-0.05187104642391205,0.0739046111702919,0.18568256497383118,-0.14221282303333282,-0.05558446794748306,0.18314771354198456},{0.1382167637348175,0.04609246179461479,-0.17181162536144257,0.14825308322906494,-0.18301115930080414,-0.16254514455795288,-0.20972321927547455,0.040792904794216156,-0.16835372149944305,0.3924175202846527,-0.2838059067726135,-0.2983228862285614,0.0975337028503418,-0.39904215931892395,-0.14796748757362366,0.10021471232175827,-0.123650461435318,-0.14511443674564362,0.16196079552173615,-0.1434580534696579,0.2390861213207245,0.30001407861709595,-0.22482025623321533,-0.00017779697373043746,-0.28713536262512207,0.005194227676838636,0.14768660068511963,-0.07827527821063995,-0.01934010349214077,-0.26610493659973145,-0.13935652375221252,-0.07365605980157852},{0.4436759948730469,0.0556376576423645,0.18023228645324707,-0.1481119990348816,-0.2940012216567993,-0.05529981479048729,-0.19451461732387543,0.3154512345790863,0.2517586350440979,-0.325670063495636,-0.0730927363038063,0.34584951400756836,0.10159401595592499,-0.08942276239395142,-0.22532498836517334,0.28288400173187256,-0.30497387051582336,0.24144470691680908,0.07765744626522064,0.14559097588062286,-0.06169029697775841,-0.15003393590450287,0.2994595170021057,0.15800459682941437,0.20356766879558563,-0.409731924533844,0.2866635322570801,-0.22618122398853302,-0.07449387013912201,0.1459926962852478,-0.2010904997587204,0.16343921422958374},{-0.07146155834197998,-0.09648403525352478,-0.12405232340097427,0.1563480794429779,0.21159330010414124,-0.1955217570066452,-0.42531126737594604,-0.10659852623939514,-0.08539527654647827,-0.26646384596824646,0.10204757004976273,0.23883303999900818,-0.01549536269158125,-0.13352498412132263,-0.10431087017059326,0.11916989088058472,-0.05977105721831322,-0.08678559213876724,-0.3322257995605469,-0.19514834880828857,-0.12271970510482788,-0.4074058532714844,0.14216014742851257,0.16086053848266602,-0.12302026152610779,0.37509816884994507,-0.19883468747138977,0.15641383826732635,0.3569389283657074,0.37642955780029297,-0.08560983091592789,0.40935570001602173},{-0.33243441581726074,0.03156725689768791,-0.2740202248096466,-0.07255010306835175,-0.22704952955245972,0.2624748945236206,0.22439758479595184,0.029981493949890137,0.22338542342185974,0.2681315541267395,0.3586448132991791,-0.261981725692749,-0.3016587197780609,0.18430092930793762,0.35669296979904175,-0.3162992596626282,-0.14736919105052948,-0.2569665312767029,0.2071869969367981,0.1102580726146698,0.08948424458503723,0.21065346896648407,0.10794442147016525,-0.09008393436670303,-0.3923313617706299,0.39925581216812134,-0.13042552769184113,0.22790201008319855,0.3785248100757599,0.1476326584815979,0.053464341908693314,0.00898975133895874},{0.2253427356481552,-0.1379590779542923,-0.12505608797073364,-0.3626415729522705,-0.06483358889818192,0.2233898788690567,0.32893165946006775,0.20155934989452362,0.06550543755292892,0.3866756558418274,-0.004729824606329203,-0.01997448317706585,-0.44681665301322937,-0.17157608270645142,-0.14864416420459747,0.17535774409770966,-0.3070855140686035,-0.23518502712249756,0.2139177769422531,-0.0713498517870903,-0.13506600260734558,-0.1402677297592163,-0.2116808444261551,-0.20524322986602783,0.17229923605918884,-0.28271931409835815,-0.0725955069065094,-0.22241367399692535,0.289908230304718,0.091855987906456,-0.17023038864135742,-0.3121376037597656},{0.013088734820485115,0.16295373439788818,0.0476568304002285,-0.019864074885845184,0.11724260449409485,-0.3459046483039856,-0.11795563995838165,-0.18445411324501038,-0.028955794870853424,-0.21064402163028717,-0.3177807629108429,-0.06289029866456985,-0.11493044346570969,-0.014724652282893658,-0.12321112304925919,0.3745100796222687,-0.047169774770736694,-0.19179895520210266,0.10090243071317673,0.33401086926460266,-0.10100945830345154,-0.24991999566555023,0.2739139795303345,0.09257093071937561,-0.04320957139134407,-0.32024985551834106,-0.30989691615104675,-0.32739031314849854,-0.3324693441390991,-0.27636727690696716,0.017711257562041283,-0.30422407388687134},{0.10588119924068451,0.3502141237258911,-0.27523788809776306,-0.34208381175994873,-0.24137717485427856,0.09651830047369003,0.05306854471564293,0.0919598713517189,0.10264498740434647,-0.29139792919158936,-0.16929177939891815,0.33916980028152466,-0.2687004506587982,-0.1848345696926117,0.20632915198802948,-0.2846565842628479,0.268636018037796,0.16640694439411163,0.3725358247756958,0.02675800584256649,0.19382043182849884,0.0942901074886322,0.2844509184360504,-0.11123885214328766,0.39023420214653015,-0.2485916018486023,0.1490803360939026,0.3398608863353729,-0.28898710012435913,0.21843507885932922,0.017580751329660416,0.14783890545368195},{-0.18056245148181915,0.11373753845691681,-0.2570723593235016,-0.16971716284751892,0.18609833717346191,-0.17659707367420197,0.116877980530262,0.0009379171533510089,0.15271472930908203,-0.03216727077960968,-0.2883731722831726,-0.3185536861419678,-0.3385586440563202,-0.05270194262266159,-0.26222944259643555,0.11919339746236801,0.05541348457336426,-0.20330725610256195,0.23931962251663208,0.1295730173587799,0.00638228515163064,-0.018065016716718674,0.28457263112068176,-0.18116964399814606,0.32151395082473755,0.09949512034654617,-0.27219703793525696,0.011482156813144684,-0.038024626672267914,0.10452891141176224,-0.13560789823532104,0.07091926038265228},{0.11852564662694931,0.06584613770246506,0.190329447388649,-0.2962566316127777,-0.39006781578063965,-0.24275663495063782,-0.2896248698234558,0.050936173647642136,-0.2797669470310211,0.47241663932800293,0.1919788271188736,-0.2077084332704544,-0.4226129353046417,-0.10555029660463333,-0.1653021275997162,-0.08715227246284485,0.15987065434455872,-0.18418516218662262,0.3185524642467499,-0.1207197830080986,-0.15904177725315094,0.003407122101634741,0.24050875008106232,0.21792645752429962,0.18744833767414093,-0.17945799231529236,0.04842214286327362,-0.09998051077127457,-0.04997945949435234,0.025075523182749748,-0.02966005727648735,0.13516280055046082},{-0.16676835715770721,-0.11508235335350037,0.2124425768852234,0.29752466082572937,0.2686421871185303,-0.030138889327645302,0.05584855005145073,-0.22444115579128265,-0.035809729248285294,-0.2718995213508606,0.25747230648994446,-0.21450798213481903,-0.1831512749195099,-0.20469839870929718,0.2555525302886963,-0.020502954721450806,-0.0039482275024056435,0.023068102076649666,0.3692677319049835,0.04570164158940315,-0.1748085618019104,0.21919435262680054,0.11001966893672943,-0.06925524026155472,0.235320582985878,-0.10547416657209396,-0.16508427262306213,0.20979124307632446,0.1659873127937317,0.02686462737619877,-0.2937204837799072,-0.224049910902977},{0.343148797750473,-0.2539844810962677,0.022611504420638084,-0.2726723253726959,-0.07793305069208145,-0.18887759745121002,0.03592947497963905,0.18655861914157867,0.20427273213863373,0.0768679529428482,0.19790156185626984,0.3326413631439209,-0.42172613739967346,-0.4534759223461151,0.00013212274643592536,-0.24252445995807648,-0.30846765637397766,-0.37928617000579834,0.3838769793510437,-0.1827055811882019,0.4023290276527405,-0.17008426785469055,0.06021798774600029,0.17687678337097168,0.14571958780288696,-0.14737318456172943,0.1614866554737091,-0.014277273789048195,0.12994982302188873,0.04718286544084549,-0.30425307154655457,0.06230152025818825},{0.2706473469734192,-0.04429056867957115,-0.008427165448665619,0.369964063167572,-0.10230948030948639,-0.19154633581638336,-0.04103664681315422,0.1628759354352951,0.1978342980146408,0.2645571529865265,0.12263552844524384,-0.10289870202541351,0.06242959946393967,0.1949983537197113,-0.11026786267757416,0.11663630604743958,0.22333694994449615,-0.2538313865661621,0.11067532002925873,-0.3614681661128998,0.2778142988681793,0.1393027901649475,-0.09990254789590836,0.20896874368190765,0.252022922039032,0.07853471487760544,0.1492152363061905,0.06670384109020233,0.09243312478065491,-0.13889344036579132,0.013040591031312943,0.3862036466598511},{0.05349287390708923,-0.19429132342338562,-0.02178221009671688,0.0761929452419281,-0.2834152579307556,0.0192171148955822,0.06378712505102158,-0.19496284425258636,-0.19503264129161835,-0.016751807183027267,0.20692528784275055,0.18558456003665924,0.06187602877616882,0.24896948039531708,-0.027233915403485298,-0.019711939617991447,-0.21543072164058685,0.28996923565864563,-0.07182976603507996,-0.20688100159168243,-0.2230549305677414,-0.06780288368463516,0.16749338805675507,0.04101864993572235,-0.008240058086812496,-0.12981447577476501,-0.16871368885040283,0.24211502075195312,0.06702028214931488,-0.16444388031959534,0.28616052865982056,0.13620899617671967},{0.17674143612384796,-0.2200026661157608,0.005395879503339529,-0.21360434591770172,-0.019501110538840294,0.1591877043247223,0.07874403148889542,0.2841868996620178,-0.12686306238174438,-0.014571648091077805,0.24583108723163605,0.10742400586605072,0.05241755023598671,-0.09708670526742935,-0.007508295122534037,0.2206130027770996,-0.3547249138355255,-0.20008334517478943,-0.033640433102846146,0.0754932090640068,0.024907870218157768,0.269223690032959,0.17280593514442444,0.18141773343086243,0.06466575711965561,0.17273499071598053,-0.011059483513236046,-0.05504877120256424,0.10250972956418991,-0.12371432781219482,-0.24457229673862457,0.30698293447494507},{0.14395862817764282,0.028671156615018845,-0.38633233308792114,0.10240088403224945,0.05161773040890694,-0.020391792058944702,0.3695856034755707,0.10621485114097595,0.07852386683225632,-0.11273663491010666,0.2118094265460968,-0.2853284776210785,-0.45304104685783386,0.268856018781662,0.07779280096292496,0.08886118233203888,-0.00195085140876472,-0.07898545265197754,-0.17260155081748962,0.0686277449131012,-0.06924904882907867,0.26101750135421753,0.08813387900590897,-0.16348619759082794,-0.07884382456541061,-0.22023138403892517,0.05904702842235565,0.364583820104599,0.22264502942562103,-0.22936521470546722,0.1948501616716385,0.1416940689086914},{-0.06801886111497879,0.0009036235278472304,-0.07746979594230652,-0.09141424298286438,-0.23839983344078064,-0.0216663870960474,0.24403166770935059,0.18589864671230316,0.13681627810001373,-0.0026507670991122723,0.19490502774715424,-0.015140807256102562,0.2191367745399475,0.21323244273662567,0.16579897701740265,-0.0698375552892685,0.1342128962278366,0.19566144049167633,0.21807719767093658,0.05208693817257881,0.15918534994125366,0.297713965177536,0.07907027751207352,0.1687006950378418,-0.017775967717170715,-0.08483169227838516,-0.13329751789569855,-0.22202599048614502,0.12165550887584686,-0.2765161395072937,0.049158304929733276,-0.08608560264110565},{-0.3528040945529938,0.015156799927353859,-0.37560728192329407,-0.33683276176452637,0.024788381531834602,-0.03378593176603317,0.15768344700336456,-0.18177786469459534,0.0777486190199852,0.39481252431869507,0.0015103932237252593,-0.257500559091568,0.04648963361978531,-0.19395793974399567,-0.3367123603820801,0.026822272688150406,-0.20598256587982178,0.10920434445142746,-0.11552774161100388,0.004618530161678791,-0.2830245792865753,0.15075795352458954,0.10732165724039078,0.07154159992933273,-0.08860529959201813,0.3511117696762085,0.035780180245637894,-0.23219645023345947,-0.19772060215473175,-0.020096180960536003,-0.24789465963840485,-0.27731063961982727},{-0.008063146844506264,-0.2618197500705719,-0.28750699758529663,-0.052136268466711044,-0.3190457224845886,-0.15438780188560486,0.18698416650295258,-0.28517189621925354,-0.22637423872947693,0.1844072937965393,0.18193532526493073,0.07820231467485428,0.11445596814155579,-0.1367267519235611,0.27434366941452026,-0.26508429646492004,0.0929587259888649,0.2721112370491028,0.03821662440896034,0.28652098774909973,0.015571392141282558,-0.11590172350406647,-0.2925506830215454,0.23217493295669556,-0.11185301840305328,-0.15346333384513855,0.10848506540060043,0.03701624646782875,-0.11893395334482193,-0.3400523066520691,-0.04019923880696297,-0.19282206892967224},{0.2225779891014099,0.0872451588511467,-0.0651560053229332,0.22941972315311432,-0.23588545620441437,0.08133909851312637,-0.09082995355129242,-0.22552406787872314,-0.06559900939464569,0.23265239596366882,-0.3689580261707306,-0.1487707793712616,0.05800427868962288,-0.1958046704530716,-0.40830832719802856,-0.19768019020557404,-0.11431335657835007,-0.3259902894496918,-0.2873174846172333,0.24361521005630493,0.17262396216392517,0.062457021325826645,-0.4024505317211151,0.34123507142066956,0.1340196579694748,0.31654953956604004,-0.3473779857158661,-0.13952860236167908,0.0961475595831871,-0.2121209353208542,0.08979972451925278,0.1668345183134079},{-0.05636517331004143,-0.29333263635635376,-0.04413754865527153,-0.307895302772522,-0.060987841337919235,0.3032364249229431,0.20387862622737885,0.0286833755671978,-0.11385592818260193,0.006275717169046402,-0.16108477115631104,0.09226933866739273,0.0985620990395546,0.07562031596899033,0.12191212922334671,0.03410540148615837,-0.06865225732326508,0.16022056341171265,-0.11411885917186737,0.1533440351486206,0.1858597844839096,0.26513028144836426,-0.043521519750356674,-0.2513437569141388,0.16653881967067719,0.16549742221832275,0.2756198048591614,0.17748816311359406,0.026518164202570915,0.10407557338476181,0.024658365175127983,-0.10451207309961319},{-0.004024204332381487,-0.23400527238845825,0.25965142250061035,0.05143273249268532,0.31818047165870667,-0.04706599935889244,-0.13852541148662567,-0.2034909874200821,0.16606846451759338,-0.04728865623474121,0.04962621629238129,0.014026700519025326,-0.2546704113483429,0.07277844846248627,-0.11802465468645096,-0.2786937654018402,-0.04048648476600647,-0.04686225205659866,0.16710738837718964,0.20177574455738068,0.03749828785657883,0.025234956294298172,0.13972866535186768,0.32382532954216003,-0.17153221368789673,-0.043740760535001755,0.14171461760997772,-0.0989348366856575,-0.1603555977344513,-0.24457179009914398,0.2867201566696167,0.019656851887702942},{0.19660092890262604,-0.06480121612548828,0.05088130012154579,0.11673280596733093,-0.045548707246780396,0.07002872228622437,-0.25114819407463074,0.3184020221233368,-0.1300542950630188,-0.04907264560461044,0.13768428564071655,-0.29210299253463745,0.029132969677448273,-0.06109141930937767,-0.09868891537189484,0.3273015022277832,-0.0735405683517456,-0.17971831560134888,0.05325741693377495,0.006858999375253916,-0.18610204756259918,0.18507876992225647,0.2247292697429657,0.2258131355047226,-0.25974714756011963,0.11148375272750854,-0.05109507218003273,0.09355609863996506,-0.27530884742736816,0.26411738991737366,-0.037386827170848846,0.04306303709745407}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.27784469723701477,-0.13970720767974854,0.16455143690109253,-0.19972024857997894},{0.21013741195201874,-0.25945356488227844,0.2780989706516266,0.24137847125530243},{-0.35708820819854736,0.07969547808170319,0.20422039926052094,-0.03298221528530121},{0.2953365445137024,0.5249181985855103,0.3260330259799957,0.04940061271190643},{-0.3143235445022583,0.21156419813632965,-0.3060608208179474,0.13361290097236633},{-0.008535405620932579,-0.14191508293151855,0.07451371103525162,0.43313953280448914},{-0.10816935449838638,-0.2504046559333801,-0.4639083743095398,-0.0018922406015917659},{-0.1286500096321106,-0.4145626127719879,0.22059166431427002,-0.05888218432664871},{-0.14290998876094818,0.1885979175567627,-0.07619678229093552,-0.13176672160625458},{0.32321712374687195,-0.0442587174475193,-0.16156089305877686,-0.24718119204044342},{0.2617047131061554,-0.2586148679256439,0.3372243344783783,0.25731515884399414},{-0.09922736138105392,0.04041542485356331,0.5073604583740234,-0.11902975291013718},{-0.3585933446884155,0.286350280046463,-0.049147509038448334,-0.06702538579702377},{-0.20438894629478455,-0.01269883569329977,-0.2765596807003021,0.10504704713821411},{0.21258042752742767,-0.06707919389009476,0.23897181451320648,0.13281302154064178},{-0.1486079841852188,-0.3235464096069336,-0.11955699324607849,-0.09218776971101761},{-0.3431965410709381,0.07951081544160843,-0.07891251146793365,0.3573779761791229},{-0.3319225609302521,-0.14612272381782532,-0.2577667534351349,0.23731185495853424},{-0.07664863765239716,-0.1685512512922287,0.4813019633293152,0.07034379243850708},{-0.1720816045999527,-0.18016014993190765,-0.03226646035909653,-0.18685203790664673},{0.17249298095703125,0.1546202450990677,0.16094960272312164,-0.1786668300628662},{0.004993041977286339,-0.33929717540740967,-0.21005910634994507,0.3525717258453369},{0.3243301212787628,-0.19232870638370514,0.2290092557668686,0.04107764735817909},{-0.32430288195610046,-0.034896522760391235,-0.278637170791626,-0.3521609604358673},{-0.2991947829723358,-0.1831664741039276,0.047631990164518356,-0.14632390439510345},{0.26039159297943115,0.25230172276496887,-0.13268816471099854,0.16799093782901764},{0.18342794477939606,-0.2168104499578476,0.2832894027233124,0.09170938283205032},{-0.04038676619529724,-0.180611714720726,0.001022264244966209,0.36000803112983704},{0.12926076352596283,0.04226713627576828,0.026514243334531784,0.019753534346818924},{-0.19306890666484833,0.12246567010879517,0.34167051315307617,0.017484469339251518},{-0.202722430229187,-0.16035906970500946,0.058956392109394073,0.27733853459358215},{0.22410590946674347,0.24483615159988403,0.3230653703212738,-0.05082700401544571}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.011159952729940414,-0.015707658603787422,-0.0038617649115622044,0.04511668533086777,0.05139832943677902,-0.06628834456205368,-0.024310333654284477,0.06732001155614853,-0.09737933427095413,-0.017274316400289536,0.009834150783717632,-0.010287534445524216,-0.028901807963848114,0.07362522929906845,-0.0009177383617497981,-0.052225030958652496};
static const float actor_encoder_self_encoder_2_bias[16] = {0.006876680534332991,-0.010607772506773472,-0.009549219161272049,0.0024972246028482914,-0.05215401574969292,0.025537103414535522,-0.027402745559811592,-0.006380927748978138,0.03296159207820892,-0.044982004910707474,0.010193752124905586,-0.024851853027939796,-0.009501341730356216,-0.0262116901576519,0.0035479520447552204,-0.02009439840912819};
static const float actor_encoder_feed_forward_0_bias[32] = {0.015099706128239632,0.04448423907160759,-0.006360935978591442,-0.00028742392896674573,-0.012220475822687149,0.025834452360868454,-0.02896135486662388,0.0005067860474810004,-0.00255026388913393,-0.03164876997470856,-0.005008410662412643,0.035910993814468384,0.023273173719644547,0.009697959758341312,0.032840777188539505,-0.031075062230229378,0.017226843163371086,-0.010224992409348488,0.020022837445139885,-0.026421748101711273,-0.018232284113764763,0.02648855186998844,-0.004534325562417507,-0.029532166197896004,-0.03795499727129936,-0.0012418170226737857,0.020716767758131027,0.029102018103003502,-0.02993902564048767,0.03432214632630348,0.03414631262421608,-0.011958306655287743};
static const float action_parameterization_distribution_linear_bias[4] = {-0.011435631662607193,0.006558578927069902,0.008113081566989422,0.02689703367650509};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3903827667236328,-0.35733455419540405,-0.15731772780418396,0.20910994708538055,-0.24014049768447876,0.09045695513486862,-0.34378498792648315,0.04198472201824188},{0.20336180925369263,0.12842898070812225,0.3979997932910919,0.38481757044792175,-0.14415064454078674,-0.357862263917923,0.31032490730285645,0.41313838958740234},{0.07312300056219101,0.19687654078006744,0.11782581359148026,-0.03293130546808243,0.3273211419582367,0.2123495489358902,-0.01351100578904152,0.2674403786659241},{0.11196085810661316,-0.33594295382499695,0.3432590663433075,-0.1512121707201004,-0.22989243268966675,0.10049863159656525,0.3167947828769684,0.27611029148101807},{-0.2601476311683655,-0.059985026717185974,-0.04601132869720459,-0.27441030740737915,0.14508742094039917,0.12547682225704193,0.3314779996871948,0.2995426058769226},{-0.07310914993286133,0.2206723988056183,-0.006918497383594513,-0.21552976965904236,0.34672287106513977,0.12577970325946808,0.09912778437137604,-0.15201418101787567},{1.9117964257020503e-05,0.19860024750232697,0.1434488296508789,-0.16028326749801636,0.44226372241973877,-0.11250851303339005,0.15564276278018951,0.12291821092367172},{0.0679391473531723,-0.3884885907173157,-0.04828436300158501,-0.23831160366535187,0.28235307335853577,0.013135891407728195,-0.17410625517368317,-0.3074832558631897},{-0.2652265131473541,0.20901817083358765,-0.03408360108733177,-0.10014912486076355,-0.03177103400230408,0.43489202857017517,0.36316728591918945,0.28350141644477844},{-0.008653673343360424,-0.11565950512886047,-0.28677281737327576,0.2686915397644043,0.2728542387485504,0.32594069838523865,0.34161001443862915,-0.3210195302963257},{-0.17192207276821136,-0.3613622486591339,0.35713380575180054,0.17335858941078186,0.006399432197213173,-0.2460440993309021,0.030297406017780304,-0.33286795020103455},{0.2277694195508957,0.054664626717567444,0.3995327949523926,0.3984919488430023,-0.12242404371500015,0.3417000472545624,0.23036567866802216,-0.33406808972358704},{-0.399217814207077,0.15539950132369995,-0.3551197350025177,0.43625888228416443,-0.028325656428933144,0.4436934292316437,0.045490849763154984,0.26684585213661194},{-0.06607440859079361,0.20196038484573364,-0.13816499710083008,-0.11298919469118118,0.004915417172014713,0.1456695795059204,0.31654635071754456,0.01657060533761978},{0.11814463138580322,-0.30332815647125244,-0.35428476333618164,-0.1638088971376419,0.12254717200994492,-0.17140084505081177,0.12382916361093521,-0.08024381101131439},{-0.4621824026107788,-0.3032342195510864,-0.25903889536857605,0.010844395495951176,-0.034756168723106384,0.2149927318096161,0.21995286643505096,-0.06155500188469887},{-0.16564233601093292,-0.2736303210258484,0.24042068421840668,-0.3395271599292755,0.00555285532027483,0.020666806027293205,-0.421455055475235,-0.24423852562904358},{0.06341055035591125,0.23846852779388428,0.1526239812374115,0.2003895342350006,-0.10605438798666,0.33597999811172485,0.28657516837120056,-0.17567074298858643},{0.05822095274925232,-0.32589197158813477,-0.0695570632815361,-0.06296611577272415,-0.1497126966714859,-0.3324911892414093,0.045176465064287186,-0.28833773732185364},{-0.032958582043647766,0.018292171880602837,0.11859852820634842,-0.3095989227294922,0.04219232127070427,0.12069812417030334,0.07864085584878922,-0.11096885800361633},{0.09298918396234512,-0.08492893725633621,0.0739617720246315,-0.26672738790512085,-0.00968509167432785,0.0016751688672229648,-0.025670424103736877,-0.23506873846054077},{-0.3169519901275635,0.21367119252681732,0.15013357996940613,-0.2438560128211975,-0.47647082805633545,0.015311489813029766,0.13608552515506744,0.014798637479543686},{0.2854216992855072,0.138567715883255,-0.39839091897010803,0.12749457359313965,-0.059024877846241,0.23551718890666962,0.2398097813129425,0.3079705238342285},{-0.0016371089732274413,-0.09507990628480911,0.005515779368579388,0.31526100635528564,-0.30819639563560486,-0.052826300263404846,-0.15326887369155884,-0.305824339389801},{0.20463483035564423,0.10455946624279022,-0.42059099674224854,0.3483949601650238,-0.29039350152015686,-0.33555668592453003,-0.32981011271476746,0.1857101321220398},{0.03890938684344292,0.38475024700164795,-0.29473161697387695,-0.05165642127394676,0.08054424822330475,-0.2464461773633957,0.32737189531326294,-0.2788049876689911},{-0.07602366805076599,0.08981289714574814,-0.15703678131103516,-0.1452968716621399,0.0246143601834774,-0.18330299854278564,-0.09219831973314285,-0.12991075217723846},{0.14295823872089386,-0.15543171763420105,-0.06075995787978172,-0.09797386080026627,-0.002792757237330079,0.006649869028478861,-0.20151713490486145,0.10034070909023285},{0.3598860502243042,0.06314756721258163,-0.3987872898578644,-0.18442580103874207,-0.256641685962677,0.10591386258602142,0.22879305481910706,0.09330658614635468},{0.40388014912605286,-0.2958860397338867,-0.02918453887104988,-0.027147123590111732,0.11372369527816772,-0.12526263296604156,0.20809519290924072,0.3598232567310333},{-0.2535880208015442,-0.16537213325500488,0.03401133418083191,-0.251986026763916,0.32393184304237366,-0.2448359578847885,0.055416177958250046,0.0892365500330925},{0.16365353763103485,0.013158301822841167,-0.16169407963752747,0.32334408164024353,0.06707698106765747,0.028489569202065468,-0.03364453464746475,0.010058705694973469}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2379731684923172,0.4067963659763336,-0.6221266984939575,-0.5919750332832336,-0.29922935366630554,0.048673588782548904,-0.4393573999404907,0.5655975937843323},{-0.031574249267578125,0.5310271978378296,-0.2131287157535553,0.533930778503418,-0.0060137114487588406,0.04954609274864197,-0.22671008110046387,0.005515956319868565},{-0.4617643654346466,-0.21099787950515747,-0.16828720271587372,-0.23965756595134735,0.5311700701713562,0.19329585134983063,0.030106278136372566,0.43795332312583923},{-0.49675124883651733,-0.49977821111679077,0.3443603515625,0.3465113639831543,-0.5069461464881897,-0.2197493314743042,0.5388718843460083,0.18279384076595306},{-0.3282725214958191,-0.3363138437271118,-0.3213949501514435,-0.3228719234466553,0.35104233026504517,-0.3008843660354614,0.5407724976539612,-0.4874713122844696},{-0.07437121123075485,0.17805767059326172,0.3175210952758789,-0.5563256740570068,0.5380480885505676,-0.3290186822414398,-0.437504380941391,-0.32229378819465637},{-0.4197748899459839,0.17905069887638092,0.07734276354312897,-0.36616918444633484,-0.03330747410655022,-0.5461023449897766,0.4905715882778168,0.06201711297035217},{-0.40384677052497864,-0.31676897406578064,-0.2325962781906128,-0.44203871488571167,-0.33066120743751526,0.13007406890392303,0.552462637424469,-0.31060248613357544}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03554706647992134,-0.008337832055985928,-0.014288553036749363,0.014231647364795208,-0.04191415756940842,-0.010397122241556644,-0.09202234447002411,0.02887229435145855};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.005526386667042971,-0.025443490594625473,-0.007695149164646864,0.058221083134412766,-0.03586359694600105,0.03240463137626648,-0.05164886638522148,0.03817855566740036};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

