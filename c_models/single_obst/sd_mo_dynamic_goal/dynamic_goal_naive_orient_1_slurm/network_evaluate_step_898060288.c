#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.26704245805740356,0.022158307954669,-0.16405747830867767,0.2786117494106293,0.29860326647758484,-0.18970638513565063,-0.21687397360801697,0.11795724928379059,0.25240248441696167,-0.3156483471393585,0.6335398554801941,1.840224831539672e-05,0.30421963334083557,0.09382271021604538,-0.4490812420845032,0.04773999750614166},{-0.22614537179470062,-0.2757110595703125,-0.3128674626350403,-0.18471769988536835,0.07001115381717682,0.2539180517196655,0.06684283912181854,0.06213948503136635,0.23042400181293488,0.19642584025859833,-0.18814899027347565,-0.09336768090724945,-0.1858881115913391,0.07699602097272873,0.347314715385437,-0.31264016032218933},{0.12812663614749908,0.20001310110092163,0.20195625722408295,0.34422004222869873,-0.08509363234043121,-0.23673126101493835,0.5192285776138306,-0.03686937689781189,-0.024616194888949394,-0.13426358997821808,0.009562388062477112,-0.02446996606886387,0.06614348292350769,0.4715009033679962,-0.2806456685066223,-0.03514329716563225},{0.11403506994247437,-0.15212379395961761,-0.1564301997423172,-0.10286935418844223,0.024251244962215424,0.11821846663951874,0.09426983445882797,-0.19690246880054474,-0.1545715034008026,0.15230877697467804,0.5157942771911621,-0.20287837088108063,-0.16656644642353058,-0.15188340842723846,0.16150209307670593,0.1428406536579132},{-0.30409005284309387,0.06709025055170059,0.1422666609287262,-0.22016476094722748,0.30015861988067627,0.3040456473827362,0.15012536942958832,-0.19806917011737823,-0.1098380982875824,0.1481013149023056,-0.14346502721309662,-0.3878243863582611,-0.014625156298279762,-0.14511904120445251,0.3068929612636566,-0.032518789172172546},{-0.043030284345149994,0.012056642211973667,-0.019142434000968933,0.007570140529423952,0.10961633920669556,-0.06465814262628555,0.38313233852386475,-0.35220393538475037,-0.14092645049095154,-0.17905999720096588,0.30544084310531616,0.020097997039556503,0.19017408788204193,0.0903288945555687,0.25085413455963135,0.2748677134513855},{-0.18475335836410522,0.14037176966667175,-0.00980895385146141,0.11108420789241791,-0.20094066858291626,-0.054407861083745956,-0.1544448733329773,-0.04017608240246773,0.12079048901796341,0.3443991243839264,-0.17070648074150085,-0.0755700096487999,0.2150709629058838,0.07573407888412476,-0.20198547840118408,0.2696905732154846},{-0.10231250524520874,-0.031562041491270065,-0.22681261599063873,-0.21869170665740967,0.3715117275714874,-0.34059035778045654,-0.30921775102615356,-0.40547627210617065,-0.06574520468711853,-0.23245492577552795,0.3717639446258545,-0.03577249497175217,0.23315873742103577,0.13802406191825867,-0.25009027123451233,0.4492167830467224},{0.22640042006969452,0.07053998857736588,-0.04018784314393997,0.11228879541158676,-0.39030003547668457,-0.403546005487442,0.36091485619544983,-0.3358035981655121,-0.15534690022468567,0.2194843590259552,0.18982774019241333,-0.31120815873146057,-0.1317955106496811,0.024669978767633438,0.19347034394741058,0.003033322049304843},{0.41309595108032227,-0.5024666786193848,-0.028055062517523766,0.021646330133080482,0.26425379514694214,-0.10320800542831421,-0.23507234454154968,-0.132478728890419,-0.17233693599700928,0.041066963225603104,-0.0060575115494430065,-0.19747887551784515,0.33788877725601196,-0.09483743458986282,-0.5318654179573059,-0.16536372900009155},{0.26418665051460266,0.1418227255344391,-0.29857003688812256,0.10023130476474762,0.026034822687506676,-0.1494368016719818,-0.11438107490539551,0.14754332602024078,-0.15779685974121094,0.10868268460035324,0.2079688012599945,0.21712373197078705,-0.11033518612384796,0.24620835483074188,-0.028837164863944054,-0.28814443945884705},{-0.45336323976516724,0.2823437452316284,0.22169706225395203,-0.2808927595615387,-0.26035720109939575,0.31581392884254456,0.052539367228746414,0.29180824756622314,0.22936761379241943,0.15753833949565887,0.19332437217235565,-0.13136720657348633,0.1614987999200821,-0.07882767915725708,-0.07245984673500061,-0.1597990095615387},{0.07994542270898819,-0.25875404477119446,-0.20980143547058105,0.16769523918628693,-0.23378951847553253,-0.2203090786933899,-0.11667797714471817,0.24242255091667175,0.33208218216896057,-0.146897092461586,-0.04156535491347313,0.05925251543521881,0.24304470419883728,0.14133760333061218,-0.19967345893383026,0.27140161395072937},{0.2847120761871338,0.1739695519208908,-0.1147979274392128,-0.10183321684598923,0.05829359218478203,-0.06638345867395401,-0.12354949116706848,0.2845780551433563,-0.20874963700771332,-0.19299784302711487,-0.15423676371574402,0.04125877097249031,-0.20996636152267456,-0.10614105314016342,-0.23810741305351257,-0.02754075452685356},{0.15900035202503204,0.414742648601532,0.41418570280075073,-0.336566686630249,-0.3565579950809479,0.19984912872314453,0.0016465882072225213,-0.15211445093154907,0.4109816253185272,0.3879966139793396,-0.1187283992767334,0.11528217792510986,-0.10315252095460892,-0.3242602050304413,0.07122642546892166,-0.16484636068344116},{-0.20615221560001373,-0.148612380027771,-0.09673038870096207,0.42652666568756104,-0.21597500145435333,-0.21838119626045227,-0.23502616584300995,-0.2924787104129791,-0.49086588621139526,-0.2391502559185028,0.3260865807533264,0.2785714268684387,-0.5601131916046143,-0.33558499813079834,-0.553845226764679,-0.18370385468006134},{-0.46250277757644653,0.18087302148342133,-0.29076704382896423,-0.1635998785495758,-0.4474554657936096,0.20312878489494324,0.5050830841064453,0.08890660107135773,0.4122055172920227,-0.47908422350883484,0.2350800782442093,-0.34683361649513245,-0.22323808073997498,0.02698288857936859,-0.1693025827407837,-0.21161222457885742},{0.38221538066864014,-0.5941452980041504,0.27255991101264954,0.22291381657123566,-0.12703952193260193,0.4401557445526123,0.22296090424060822,0.30344754457473755,-0.05465381592512131,-0.25572848320007324,-0.15367873013019562,-0.13924142718315125,-0.1235823854804039,-0.5208832025527954,0.2512720823287964,-0.11222164332866669}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.021946337074041367,0.2929234504699707,0.20489521324634552,-0.15384292602539062,-0.18395276367664337,0.029725167900323868,-0.013748357072472572,0.22497424483299255,-0.0904540941119194,0.3105548620223999,0.481515496969223,-0.38175925612449646,0.05189841613173485,0.06326070427894592,0.004305121023207903,-0.08828606456518173},{-0.33907824754714966,0.19105733931064606,-0.14224983751773834,0.3173699378967285,0.2715336084365845,-0.07919488102197647,-0.30814123153686523,-0.1443008929491043,0.33903202414512634,0.2609478235244751,-0.0604838952422142,0.21259449422359467,-0.3745211362838745,0.1699555665254593,-0.21037589013576508,0.42850297689437866},{-0.24166564643383026,0.13358043134212494,-0.24068114161491394,0.14682702720165253,-0.43111103773117065,-0.168192520737648,0.026960646733641624,0.128800168633461,-0.16944517195224762,0.3642770051956177,0.21802392601966858,-0.1088441014289856,0.15399637818336487,-0.2708803117275238,-0.09912867844104767,-0.025227824226021767},{0.19895297288894653,-0.2300860434770584,0.07708277553319931,0.3866233825683594,-0.4213685691356659,-0.30926772952079773,0.2487533837556839,0.027869021520018578,0.27654775977134705,-0.08699778467416763,0.308149516582489,0.10151966661214828,-0.18980850279331207,0.01686619222164154,-0.013682812452316284,-0.37609657645225525},{-0.3932330906391144,-0.08441082388162613,0.12119868397712708,-0.2621380090713501,0.14078693091869354,0.3081521987915039,-0.30436649918556213,0.28265491127967834,-0.20362921059131622,0.2001580446958542,0.0017519087996333838,0.0462380088865757,-0.2646399140357971,-0.0035196440294384956,-0.2611262798309326,-0.09226885437965393},{0.07802088558673859,-0.29093965888023376,0.004653231706470251,-0.3236418068408966,0.21565252542495728,0.03175671026110649,-0.12555447220802307,-0.04997384548187256,-0.12922033667564392,0.36264753341674805,0.17443940043449402,0.01292355265468359,-0.29255250096321106,0.07985542714595795,0.016515418887138367,-0.3086320459842682},{0.24541392922401428,-0.2288309782743454,0.3171497583389282,-0.19374410808086395,-0.42664793133735657,0.05221864581108093,-0.3559854328632355,0.3499507009983063,-0.09851344674825668,-0.26591044664382935,-0.24929241836071014,-0.020006971433758736,-0.07882480323314667,-0.06982646137475967,0.4965042769908905,-0.36708205938339233},{-0.35509127378463745,0.33429792523384094,-0.09654785692691803,0.1888868808746338,-0.10928457230329514,-0.2246500849723816,-0.21054455637931824,0.08384431898593903,-0.05565011128783226,0.4538121521472931,0.07537999749183655,-0.12679938971996307,0.05630692467093468,-0.2197507917881012,0.05712147802114487,0.148471400141716},{0.12422950565814972,0.2670839726924896,-0.16424371302127838,-0.3015379011631012,0.31082233786582947,-0.19216524064540863,0.1947818249464035,-0.2511937618255615,0.0050607044249773026,0.012298992834985256,0.10299544036388397,0.0809541866183281,0.01644360087811947,-0.35486656427383423,-0.07619871944189072,0.19742313027381897},{-0.1670076847076416,0.03321686014533043,-0.26252976059913635,-0.30217164754867554,0.21886251866817474,-0.3803262412548065,-0.09981264919042587,0.2996610105037689,-0.16772857308387756,0.1349252313375473,-0.050419118255376816,-0.1032290980219841,-0.35660481452941895,0.10929582267999649,-0.21776489913463593,-0.3560781180858612},{-0.11797240376472473,-0.15931928157806396,0.023910077288746834,-0.2388060986995697,-0.31249839067459106,0.02444763109087944,0.1374504268169403,-0.30415427684783936,0.018421277403831482,-0.08486942201852798,0.25881245732307434,-0.0635465607047081,0.21428638696670532,0.15362130105495453,0.22006195783615112,0.2537633180618286},{-0.13869914412498474,-0.02616634964942932,-0.3194774389266968,0.31697046756744385,0.08965151011943817,0.16223075985908508,0.19464130699634552,0.14863620698451996,-0.414909690618515,0.1933385133743286,-0.35767099261283875,-0.2250927835702896,-0.3409818112850189,0.3362376093864441,-0.33512747287750244,0.09791834652423859},{-0.16598884761333466,-0.44045379757881165,-0.04235187545418739,0.1410195380449295,-0.22625330090522766,-0.060176949948072433,-0.08127035200595856,0.3901859521865845,0.436492383480072,0.122115857899189,0.0039623756892979145,-0.17686207592487335,0.15965324640274048,-0.36766132712364197,0.09799276292324066,-0.1567785143852234},{-0.27030202746391296,-0.45897236466407776,-0.11373021453619003,-0.12636420130729675,-0.5011299252510071,0.47771355509757996,-0.15478648245334625,0.19235225021839142,-0.14462219178676605,-0.2305058240890503,-0.2997324764728546,0.3776584565639496,-0.13258399069309235,-0.032797593623399734,-0.19979971647262573,0.3289995491504669},{-0.3096652030944824,0.35664770007133484,-0.2363044023513794,0.14685724675655365,-0.35186436772346497,0.1478765308856964,-0.001406668801791966,-0.3317354619503021,0.1428726315498352,0.1934308111667633,-0.2316449135541916,0.06419768184423447,0.2401309758424759,-0.2975813150405884,-0.32971450686454773,-0.16476745903491974},{-0.13206647336483002,-0.281609445810318,-0.39483439922332764,0.2272883504629135,0.13155251741409302,0.052613288164138794,-0.23211345076560974,0.16960415244102478,-0.3503228425979614,-0.2401932179927826,-0.27789822220802307,0.18585102260112762,-0.2162436842918396,0.1465883105993271,0.047576501965522766,0.30637770891189575}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.12205252051353455,-0.04555085301399231,0.20773333311080933,-0.1322159320116043,-0.0805235430598259,0.09222149103879929,0.21994388103485107,-0.18986622989177704,-0.22962184250354767,0.2539997100830078,0.15312781929969788,0.11175563931465149,0.059316977858543396,0.17602239549160004,-0.15532764792442322,0.1630764752626419,0.14623963832855225,-0.34185853600502014,-0.14616672694683075,-0.08880087733268738,-0.10972580313682556,0.03613581508398056,-0.18127506971359253,0.2579175531864166,-0.07731805741786957,-0.06333817541599274,0.11108961701393127,0.20355212688446045,-0.19938057661056519,-0.12850606441497803,0.1675289422273636,0.2478325515985489},{0.2132555991411209,-0.07569043338298798,0.1378554254770279,-0.12262245267629623,-0.1291378289461136,0.2348933070898056,-0.005753671750426292,-0.07612594217061996,-0.045155178755521774,0.01923324353992939,-0.1489802449941635,0.0033928719349205494,0.4010428190231323,0.17488707602024078,0.11556421965360641,0.058629266917705536,-0.21665708720684052,-0.3535914421081543,0.06537611037492752,0.03895297646522522,0.06405112892389297,0.2913956344127655,0.1953512728214264,-0.22849303483963013,0.026744063943624496,0.25022202730178833,-0.2652679681777954,0.1769401878118515,0.09037090092897415,-0.22568431496620178,-0.05967532843351364,-0.02405726909637451},{-0.10096047073602676,-0.06521523743867874,0.31397560238838196,-0.23161666095256805,-0.14882266521453857,0.060478538274765015,-0.12345946580171585,0.2634418308734894,0.09958283603191376,4.142419857089408e-05,-0.17573370039463043,-0.030482593923807144,0.23398500680923462,-0.2201620489358902,0.10591515153646469,-0.031580135226249695,-0.2981089651584625,0.27159860730171204,-0.2168685793876648,-0.040650829672813416,0.00450188759714365,-0.14848841726779938,-0.035927001386880875,-0.0763949453830719,-0.014958158135414124,0.2584102749824524,-0.07888255268335342,0.09503583610057831,0.24814216792583466,-0.2242136299610138,-0.21555738151073456,-0.059052273631095886},{0.13892178237438202,-0.09980856627225876,0.06296362727880478,-0.3188507854938507,0.10579824447631836,-0.15518039464950562,-0.07778522372245789,0.26622262597084045,0.019627371802926064,0.11944840103387833,0.1600688248872757,-0.08767784386873245,-0.19328194856643677,-0.08966867625713348,0.29753968119621277,-0.23551197350025177,0.031491171568632126,-0.1380186229944229,-0.12808027863502502,0.10517589002847672,-0.10363736003637314,0.040189772844314575,-0.2018374800682068,0.2226184755563736,-0.23180139064788818,0.1085873693227768,-0.09262803196907043,-0.18446414172649384,0.09790749102830887,-0.0072772870771586895,0.25396111607551575,-0.12260624766349792},{0.2116750329732895,-0.003180659841746092,0.03858417645096779,0.22874271869659424,-0.2389775812625885,-0.08244685083627701,0.20966994762420654,-0.05747970938682556,0.1114639937877655,-0.17846566438674927,0.00016534818860236555,-0.09032861143350601,-0.15477870404720306,-0.16687096655368805,0.27110692858695984,0.3104413151741028,-0.06453492492437363,-0.33259117603302,0.15970993041992188,-0.12141154706478119,-0.11599346995353699,0.20095868408679962,0.26058825850486755,0.059584811329841614,-0.04609197378158569,-0.09517214447259903,-0.010507678613066673,0.2612950801849365,0.23747092485427856,0.13956308364868164,0.08647460490465164,-0.24703072011470795},{0.32880154252052307,-0.14919601380825043,-0.0004102011735085398,0.10055683553218842,-0.12901543080806732,-0.3193155527114868,-0.20567472279071808,-0.292429655790329,-0.19607380032539368,0.030278919264674187,-0.05579347908496857,-0.008727445267140865,-0.1664842963218689,-0.05512553080916405,-0.21527372300624847,-0.22082574665546417,0.1662122905254364,-0.014400229789316654,-0.31171146035194397,0.15565939247608185,-0.06084471568465233,-0.21567296981811523,0.1776736080646515,-0.1566287875175476,-0.136419415473938,-0.2264782339334488,-0.10124608874320984,0.15058860182762146,0.10012286901473999,0.25991290807724,-0.22686491906642914,0.20961004495620728},{0.1530158817768097,0.10169074684381485,0.26820600032806396,-0.18462610244750977,0.23089419305324554,-0.22450433671474457,-0.24006828665733337,0.06151927635073662,0.2658107280731201,0.10107175260782242,-0.09369722753763199,0.10111362487077713,0.056267742067575455,0.3546224534511566,0.11696381121873856,-0.11033900827169418,-0.183588907122612,0.13923832774162292,0.016411244869232178,0.003697931533679366,-0.03891654312610626,0.18361973762512207,0.1617710441350937,0.14044171571731567,-0.17800606787204742,-0.2361670434474945,-0.2523060739040375,-0.35906609892845154,0.0730912983417511,-0.11080338060855865,0.2392677366733551,0.16216057538986206},{0.2726796269416809,-0.28455349802970886,0.1153608113527298,-0.36358436942100525,-0.3489042818546295,0.24347206950187683,0.3680741786956787,0.1323661059141159,-0.09754471480846405,-0.01137565914541483,0.23579548299312592,-0.12757666409015656,0.14412151277065277,0.34341511130332947,-0.031870704144239426,0.18233291804790497,0.3639577329158783,-0.18517948687076569,-0.030364537611603737,-0.27836424112319946,0.14895589649677277,0.20089931786060333,0.2347497045993805,0.1084916815161705,0.10626974701881409,0.11479216068983078,0.11490718275308609,0.2563747465610504,-0.1932549625635147,-0.24753709137439728,0.24170471727848053,-0.06372139602899551},{0.04281538724899292,-0.09378199279308319,0.26086434721946716,0.21242617070674896,-0.16981101036071777,-0.2818527817726135,-0.0642012506723404,0.275253564119339,-0.17387019097805023,-0.23254309594631195,0.05408720299601555,0.09898555278778076,0.12867559492588043,-0.2777325212955475,0.12212368845939636,-0.1849118173122406,-0.159375861287117,0.17982232570648193,-0.24342547357082367,0.3205871284008026,-0.31521841883659363,-0.2858468294143677,-0.27575409412384033,0.30029645562171936,0.12337402999401093,0.10444322228431702,0.24712730944156647,0.17610611021518707,-0.16831639409065247,-0.2735770046710968,-0.14602115750312805,0.17304377257823944},{0.27994662523269653,-0.017562922090291977,-0.05649910122156143,0.15897145867347717,-0.018035104498267174,0.2035544365644455,-0.049692537635564804,0.22621633112430573,0.00036936637479811907,0.06529302895069122,0.17691275477409363,0.06547269970178604,-0.12207002192735672,-0.3460172712802887,0.10756108909845352,0.13200946152210236,0.08492983877658844,-0.12551762163639069,-0.08687924593687057,-0.029984822496771812,0.11067544668912888,-0.27985095977783203,0.2196529656648636,0.07720918953418732,-0.01531162392348051,0.12455261498689651,-0.26680251955986023,-0.24284975230693817,-0.05514414608478546,-0.021601036190986633,0.13401632010936737,0.17247584462165833},{-0.12668828666210175,0.10219912976026535,-0.09067630022764206,0.15545298159122467,-0.1079975813627243,0.27138927578926086,0.12376192957162857,-0.009057199582457542,0.27266910672187805,-0.3098088204860687,-0.1483263373374939,0.1538543850183487,-0.16556160151958466,0.045539308339357376,-0.2979643940925598,-0.0315868966281414,0.10644667595624924,0.16645170748233795,0.08914552628993988,-0.13429389894008636,-0.21940873563289642,0.19971111416816711,0.19188334047794342,0.1824861466884613,-0.23856663703918457,0.35545098781585693,-0.10332638770341873,-0.019450901076197624,-0.09588661044836044,0.14001108705997467,0.22439812123775482,0.2719605565071106},{-0.17151856422424316,0.3040672540664673,-0.06657432019710541,0.012706514447927475,-0.1716490536928177,-0.1434294879436493,0.13464345037937164,-0.30448195338249207,-0.04261138662695885,-0.23719516396522522,-0.2191362828016281,-0.03343921899795532,0.16578225791454315,-0.2817222476005554,-0.11547663807868958,-0.26820939779281616,-0.201969712972641,-0.06872022897005081,0.30166012048721313,-0.3099312484264374,0.07984081655740738,-0.18583045899868011,0.0829259529709816,0.2974875569343567,-0.18494942784309387,0.18463759124279022,0.21356044709682465,-0.06937886774539948,-0.020192719995975494,0.3063560128211975,-0.13273045420646667,-0.2368267923593521},{-0.04891931638121605,0.1548961102962494,0.23614753782749176,-0.2800699770450592,0.2668185532093048,0.022636814042925835,-0.11578325927257538,-0.018412858247756958,0.15167051553726196,-0.28998932242393494,-0.08245688676834106,0.010232626460492611,0.16591505706310272,0.056832145899534225,0.031229963526129723,-0.11126535385847092,0.24620072543621063,-0.23346751928329468,0.3283192217350006,0.08576374500989914,-0.1632179319858551,0.23707444965839386,-0.1319710612297058,-0.18337352573871613,0.28090694546699524,-0.13494223356246948,0.028454873710870743,-0.17070969939231873,0.037724535912275314,-0.13069979846477509,0.2551284730434418,0.22125622630119324},{0.06983859837055206,-0.13913393020629883,-0.17056529223918915,0.0678439512848854,0.03470291569828987,0.2966899573802948,-0.09992780536413193,-0.24935273826122284,0.26547741889953613,0.026877135038375854,0.04808618128299713,0.08694390207529068,-0.17530690133571625,0.07146415114402771,-0.1931566447019577,-0.27070316672325134,0.014054421335458755,-0.058530084788799286,0.20910131931304932,0.36818310618400574,-0.20143811404705048,0.0822831392288208,-0.12003163993358612,-0.011866920627653599,0.12006260454654694,-0.2929799258708954,-0.17250511050224304,-0.2087087333202362,-0.029466571286320686,-0.17409572005271912,0.18362665176391602,-0.2980460822582245},{-0.08402557671070099,0.27326852083206177,0.1632600575685501,-0.21342705190181732,-0.08517352491617203,-0.16295278072357178,0.1832217574119568,-0.01829528622329235,0.2176695019006729,-0.007001405116170645,0.16986167430877686,0.1408495008945465,-0.0412745326757431,0.044681698083877563,-0.1283641755580902,0.15340673923492432,-0.16344618797302246,-0.3474307954311371,-0.2376803457736969,0.1139141321182251,0.13465328514575958,-0.19706210494041443,-0.3038829565048218,-0.21763566136360168,-0.13342995941638947,0.04558567702770233,0.32919955253601074,-0.014464767649769783,-0.07174132764339447,0.13439786434173584,-0.14908304810523987,0.09961668401956558},{-0.19588780403137207,-0.18396836519241333,-0.2127709686756134,0.00028517318423837423,-0.21242403984069824,-0.0920124500989914,-0.026126114651560783,-0.008554226718842983,-0.295823872089386,-0.20746217668056488,0.16934221982955933,0.1311371773481369,-0.30243390798568726,0.22578434646129608,-0.06442070007324219,0.16084930300712585,0.09846249967813492,0.036286018788814545,0.03318987041711807,0.14597062766551971,0.2220662236213684,0.27742213010787964,0.13575585186481476,0.2698178291320801,0.12498922646045685,-0.2213665097951889,-0.18974469602108002,0.24977384507656097,-0.0033186303917318583,-0.1720130294561386,-0.16022497415542603,-0.09590177237987518},{-0.29421889781951904,-0.2148970067501068,-0.3350929021835327,0.045555856078863144,-0.11407191306352615,-0.05617290362715721,-0.08022825419902802,0.13771465420722961,-0.08517683297395706,0.07567671686410904,-0.18359023332595825,-0.003233698895201087,0.14262543618679047,-0.10667687654495239,0.031061938032507896,0.18032091856002808,-0.0888407975435257,-0.10650426149368286,0.16579250991344452,0.035830527544021606,0.21916720271110535,-0.047626104205846786,-0.21765244007110596,0.07033313065767288,0.18150773644447327,-0.2518734037876129,0.17904223501682281,0.04706775024533272,0.07251919060945511,-0.14591020345687866,0.21089862287044525,-0.06445543467998505},{0.26537516713142395,0.01878719963133335,0.03880838677287102,0.20425310730934143,-0.3378717005252838,-0.030919384211301804,0.06216500699520111,0.1621278077363968,-0.07550205290317535,-0.13302311301231384,0.2877543568611145,-0.09490666538476944,0.08557098358869553,-0.05570506304502487,-0.10553988814353943,0.28554508090019226,-0.07912353426218033,-0.13341329991817474,0.10597114264965057,-0.28261280059814453,-0.06024628505110741,-0.25100743770599365,-0.16895484924316406,0.23020754754543304,-0.08727405965328217,-0.04415307566523552,0.1262873113155365,0.062391769140958786,-0.14039038121700287,-0.07156814634799957,-0.02811381407082081,-0.08481673151254654},{0.2989598512649536,-0.06565088778734207,0.060685500502586365,0.05804691091179848,-0.02753623016178608,-0.07635751366615295,0.19234715402126312,-0.22658808529376984,0.24891795217990875,0.2848358750343323,0.04286384955048561,0.14237168431282043,0.2061498612165451,0.30660751461982727,-0.2897603511810303,-0.35022619366645813,-0.235952690243721,0.07277798652648926,-0.16920843720436096,-0.3595971465110779,-0.15323282778263092,0.2240806370973587,0.06562990695238113,0.14598515629768372,-0.15717357397079468,-0.11643651127815247,-0.1230906993150711,-0.22931551933288574,0.24352605640888214,0.18771950900554657,-0.32839882373809814,-0.11159797757863998},{-0.10746899992227554,0.17003829777240753,0.2786749601364136,-0.020509757101535797,-0.02116895094513893,0.0880993977189064,-0.021027520298957825,-0.3240143656730652,0.1630697101354599,0.23988193273544312,0.1784382164478302,0.22543582320213318,-0.2608233094215393,0.16781778633594513,-0.2499208152294159,0.3088468313217163,0.15478403866291046,-0.26242852210998535,0.2598581314086914,0.05217023938894272,-0.33580610156059265,0.2789613604545593,-0.22223499417304993,0.1396399587392807,0.16473379731178284,0.262745201587677,0.054173748940229416,0.14243340492248535,-0.15492697060108185,0.24055667221546173,-0.05021190643310547,0.10762050747871399},{-0.13331612944602966,-0.10866749286651611,0.03331609442830086,0.17773085832595825,0.020573783665895462,0.237894669175148,-0.24752601981163025,-0.11097296327352524,-0.17986033856868744,-0.08375708013772964,-0.11081865429878235,-0.1999695897102356,-0.01496883761137724,-0.20556433498859406,0.09594539552927017,-0.20933489501476288,0.24884898960590363,-0.010682391934096813,-0.2768712043762207,-0.30099061131477356,0.14303967356681824,0.1319267600774765,-0.14038680493831635,0.34085357189178467,-0.23907488584518433,0.03405657038092613,0.09290365874767303,-0.11087363213300705,0.14685125648975372,-0.19267898797988892,0.2742496728897095,0.11933187395334244},{0.3026892840862274,0.052293095737695694,0.04841511696577072,0.23012502491474152,-0.242842435836792,0.1489093005657196,-0.0980270504951477,0.1315755844116211,0.11641324311494827,0.00834247563034296,0.1059318482875824,-0.2975926101207733,-0.2614661157131195,0.06383952498435974,0.07450442016124725,-0.08092818409204483,0.265251487493515,0.13702954351902008,-0.1917802095413208,-0.21247981488704681,0.3393416404724121,0.19176331162452698,0.222906231880188,0.08261889219284058,-0.007164363283663988,0.06443554162979126,-0.04772032052278519,-0.16396848857402802,0.22067154943943024,0.0024818945676088333,-0.1732102781534195,0.10612477362155914},{-0.01429192628711462,0.03736279532313347,-0.020894233137369156,-0.2477613091468811,-0.09348048269748688,-0.23341761529445648,-0.2093159258365631,-0.14157399535179138,-0.044005386531353,-0.02714983932673931,-0.22757579386234283,0.03236201032996178,-0.23498903214931488,-0.15887287259101868,0.01113740261644125,0.09851660579442978,0.2564595937728882,-0.1817837357521057,-0.3225683271884918,0.24175573885440826,-0.1705164760351181,0.23965749144554138,0.04718529060482979,-0.04670197516679764,-0.040115829557180405,0.16915163397789001,-0.07737190276384354,-0.2511623799800873,0.22541698813438416,0.2454630434513092,-0.12906304001808167,0.17485129833221436},{-0.24355986714363098,-0.02121736668050289,0.03630370274186134,-0.023124296218156815,0.09148061275482178,0.11716320365667343,-0.2000872939825058,0.09114041179418564,-0.1476127952337265,-0.14579448103904724,0.07232926040887833,-0.1332949548959732,-0.17748597264289856,0.26784610748291016,0.014835776761174202,0.03793919086456299,0.1951112002134323,-0.2602241635322571,-0.1663106083869934,0.335705041885376,0.02711626887321472,0.2792864143848419,-0.07348563522100449,0.0139117781072855,-0.16670680046081543,-0.17390121519565582,-0.0012303258990868926,0.29103884100914,-0.010720302350819111,0.004653154406696558,0.29922792315483093,0.29276543855667114}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.13049359619617462,0.12610989809036255,0.23972249031066895,0.00721045583486557},{0.057051438838243484,-0.034703273326158524,0.046152371913194656,0.11658846586942673},{-0.13226185739040375,0.16746161878108978,0.07936906814575195,0.13663150370121002},{0.30404356122016907,0.04410334303975105,0.06157303228974342,0.35786721110343933},{-0.08735847473144531,0.046202003955841064,0.2169749140739441,0.0017944745486602187},{-0.12501706182956696,0.18108247220516205,0.16094304621219635,-0.04211299493908882},{-0.1853027641773224,0.01025625690817833,0.003674573265016079,-0.10355459898710251},{-0.3114265203475952,-0.09734876453876495,0.28313106298446655,-0.26700490713119507},{0.2678139805793762,-0.17739976942539215,-0.23514734208583832,-0.31088584661483765},{0.037853870540857315,0.21748259663581848,0.2807644009590149,-0.3392215967178345},{-0.1071774885058403,-0.12288825958967209,-0.1720448136329651,0.16684137284755707},{0.22135582566261292,-0.15306119620800018,0.04396872967481613,0.13939975202083588},{0.2592620849609375,0.27252864837646484,-0.0680973157286644,0.07593267410993576},{-0.008966134861111641,0.04141677916049957,-0.2461237907409668,0.025642355903983116},{0.11523827910423279,0.27068182826042175,0.23819424211978912,0.28216591477394104},{0.13283465802669525,0.06504882127046585,0.211411252617836,0.21243765950202942},{-0.16751620173454285,-0.09622997045516968,-0.14463363587856293,-0.13492316007614136},{-0.14163586497306824,0.09540768712759018,-0.10004058480262756,-0.11574815213680267},{-0.14883273839950562,0.14342112839221954,0.152147576212883,0.2308187484741211},{-0.016224700957536697,0.3103650212287903,-0.14637906849384308,0.053418904542922974},{-0.20216824114322662,-0.2865673303604126,-0.13777083158493042,-0.022988351061940193},{0.22968299686908722,0.32927390933036804,0.02961544878780842,-0.1848984807729721},{0.0029491076711565256,0.13665232062339783,0.13542604446411133,0.12199683487415314},{-0.07445632666349411,0.3291340470314026,-0.047286711633205414,-0.10364086180925369},{0.007722205948084593,-0.004077929072082043,-0.007713594939559698,-0.014239130541682243},{0.2377776801586151,-0.3141034245491028,-0.049796029925346375,0.05139802768826485},{-0.0032850364223122597,-0.2663363814353943,-0.1594502478837967,-0.23366622626781464},{0.07945488393306732,-0.05223497003316879,0.17583616077899933,0.06344226002693176},{-0.0031813629902899265,-0.028791654855012894,0.03911637142300606,0.016782954335212708},{-0.2895900011062622,0.3113826811313629,0.21595968306064606,-0.08128414303064346},{0.2718782424926758,-0.1413870006799698,0.14584973454475403,9.26653083297424e-05},{0.04858440160751343,-0.2852851152420044,0.285084992647171,-0.22320805490016937}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.033840619027614594,0.005061646923422813,0.043115127831697464,-0.05563993379473686,-0.023542415350675583,-0.16055530309677124,0.044991184026002884,0.04662412777543068,0.008259291760623455,-0.10888312011957169,0.16289976239204407,0.08193577080965042,-0.001317523536272347,-0.009165025316178799,0.07221708446741104,0.016777947545051575};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.05730568245053291,0.03506359085440636,0.03028225153684616,0.027026480063796043,0.04367205500602722,0.014035077765583992,0.038344305008649826,0.0062569137662649155,0.01443471759557724,0.008758905343711376,-0.04058569669723511,-0.011600183323025703,0.012117992155253887,-0.029556045308709145,-0.05199437588453293,0.016448605805635452};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06891314685344696,0.05472328141331673,0.0196082703769207,0.07316320389509201,0.03628726676106453,-0.02082175202667713,-0.03825126215815544,-0.012040790170431137,-0.023944130167365074,-0.010897183790802956,-0.04572506994009018,0.05379771813750267,0.06901237368583679,-0.0680275708436966,0.07057669013738632,0.06547993421554565,-0.05707376450300217,-0.06019992008805275,-0.0038385808002203703,0.01284562237560749,-0.04265061020851135,0.005612692330032587,0.057599540799856186,0.026236118748784065,-0.008348760195076466,0.0010826665675267577,-0.03550773486495018,0.054926495999097824,0.015155619010329247,-0.004531431011855602,0.020967010408639908,0.027304140850901604};
static const float action_parameterization_distribution_linear_bias[4] = {0.05245020613074303,0.009208159521222115,0.04950908198952675,0.041924912482500076};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.03427233546972275,0.2775501608848572,-0.08256030827760696,0.14397366344928741,0.20601527392864227,0.18494457006454468,0.2365933358669281,0.010192588903009892},{-0.17064033448696136,-0.08397945761680603,-0.2122938632965088,-0.28597334027290344,-0.30637919902801514,-0.15102343261241913,-0.22852817177772522,-0.12244139611721039},{-0.26067960262298584,0.018494848161935806,0.24150653183460236,0.22248850762844086,0.20562858879566193,-0.023269757628440857,0.14009906351566315,-0.04775591567158699},{-0.02583794854581356,0.0808849111199379,-0.19732803106307983,-0.012680068612098694,-0.024239620193839073,-0.07785449177026749,0.1497315913438797,-0.12019901722669601},{-0.2890399098396301,-0.11375325918197632,-0.25997984409332275,-0.16897980868816376,-0.06279323995113373,0.1985267549753189,0.126778706908226,0.0007584017585031688},{-0.3531399071216583,0.029002301394939423,0.3124685287475586,0.2601061761379242,0.1696051061153412,-0.05112866684794426,-0.11239321529865265,-0.11028057336807251},{-0.17310798168182373,0.09080608189105988,0.30078086256980896,-0.1694817990064621,-0.11900012195110321,-0.3355729281902313,-0.05041735991835594,-0.14983944594860077},{-0.4555211663246155,-0.3254004418849945,0.5010583400726318,-0.011760388500988483,-0.27539128065109253,0.16877838969230652,0.20309853553771973,-0.18897342681884766},{-0.2733704447746277,0.2751677632331848,-0.10128504782915115,0.444261372089386,0.023518040776252747,-0.42208677530288696,0.1220465674996376,0.12188902497291565},{-0.23704922199249268,-0.32009953260421753,-0.11872938275337219,-0.1674056053161621,-0.4777545630931854,0.03522315248847008,0.019660379737615585,0.14099961519241333},{0.19339245557785034,0.3273613154888153,0.2553550601005554,-0.0277529489248991,0.25373566150665283,0.027916809543967247,-0.21012617647647858,0.25373417139053345},{0.21259544789791107,-0.019918642938137054,0.2941090762615204,0.2724475860595703,-0.16541334986686707,0.2391311079263687,-0.007086731027811766,-0.2109256386756897},{0.12061265110969543,-0.25793027877807617,0.2511521875858307,0.006898239254951477,-0.12457626312971115,-0.06299393624067307,-0.13564404845237732,-0.19435901939868927},{-0.21779151260852814,-0.07287482172250748,0.32821911573410034,0.39136895537376404,0.030892595648765564,-0.034207217395305634,-0.21268530189990997,0.06612172722816467},{-0.05506226792931557,-0.13404878973960876,0.1215018555521965,-0.19928796589374542,-0.2516196370124817,-0.1567998230457306,0.16451579332351685,-0.057495299726724625},{-0.03141997754573822,-0.01742904633283615,-0.007476060185581446,-0.33266767859458923,-0.02933310531079769,0.04393216222524643,-0.07009285688400269,0.35962560772895813},{0.006874248385429382,-0.19689282774925232,-0.1615190953016281,0.03206280246376991,-0.1964758038520813,-0.11913467943668365,-0.12875433266162872,0.0386359877884388},{-0.15232887864112854,-0.18910133838653564,0.08726617693901062,-0.03319556638598442,0.10942216217517853,-0.18855905532836914,0.39066046476364136,0.08574699610471725},{0.0608460009098053,0.16499356925487518,-0.25599080324172974,0.09724980592727661,0.06363368034362793,0.11103004217147827,-0.1873382180929184,0.26165249943733215},{0.18516112864017487,-0.06745754182338715,-0.3625575304031372,0.05596630275249481,-0.17389345169067383,-0.1262451857328415,-0.254364550113678,-0.021373581141233444},{0.014748054556548595,-0.2063453495502472,0.007339344825595617,-0.12166488915681839,0.14533564448356628,-0.10810411721467972,-0.06279346346855164,0.4312598407268524},{-0.03922601044178009,0.07544804364442825,-0.3277095556259155,0.22918400168418884,0.21784456074237823,0.24137121438980103,0.062002845108509064,-0.27187126874923706},{-0.4253367483615875,-0.13348300755023956,0.07999574393033981,-0.07607118785381317,0.1709689497947693,-0.3564735949039459,0.14138677716255188,-0.2549034059047699},{-0.07366950064897537,0.08459564298391342,-0.12297333776950836,-0.4333757758140564,0.24704444408416748,0.04375167191028595,-0.3534422516822815,0.12100569158792496},{-0.08926043659448624,-0.19648870825767517,-0.15279102325439453,0.10936995595693588,0.1780221313238144,0.2884940505027771,0.2580913305282593,-0.09104958176612854},{-0.084879569709301,0.0515248104929924,-0.36061760783195496,-0.23528385162353516,0.1610894501209259,-0.029871394857764244,-0.06539996713399887,0.026326201856136322},{0.3258778154850006,0.3304869532585144,-0.24872292578220367,0.2625027596950531,0.11002667993307114,0.2675398588180542,-0.3143596351146698,-0.1961616575717926},{0.43714526295661926,0.24081361293792725,0.09941347688436508,0.09061646461486816,0.22414594888687134,0.035724155604839325,0.22027680277824402,0.3421771228313446},{-0.11113491654396057,0.30916106700897217,0.13641272485256195,0.03674397990107536,0.2557350695133209,-0.028900330886244774,-0.4258957505226135,-0.26709985733032227},{-0.15229050815105438,-0.2651468515396118,-0.06124512478709221,-0.1745259314775467,-0.23643401265144348,-0.16039849817752838,0.18546327948570251,0.008822293020784855},{0.3982568383216858,-0.2863580286502838,0.2073989361524582,-0.26105016469955444,0.147866889834404,0.2971513867378235,0.03840392082929611,-0.15011031925678253},{0.14060862362384796,0.4392465651035309,0.42822760343551636,-0.19518595933914185,-0.20668724179267883,0.1722274273633957,0.1920444518327713,0.03731159493327141}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.0633363202214241,0.3549668490886688,-0.14650696516036987,0.23832674324512482,-0.35830116271972656,0.21638348698616028,0.401433527469635,0.022868743166327477},{-0.3656806945800781,-0.4480932950973511,-0.3019896149635315,-0.35305875539779663,-0.3787965178489685,0.38185980916023254,0.4685251712799072,-0.4388476312160492},{0.04254404082894325,-0.12223831564188004,0.09398867934942245,0.008865186013281345,-0.0725652277469635,0.3766504228115082,-0.3053678870201111,-0.26350128650665283},{0.32517534494400024,0.020293494686484337,0.06793184578418732,-0.008375972509384155,0.48767703771591187,0.37415727972984314,0.354730486869812,0.3645857870578766},{0.10737764090299606,0.1873878687620163,-0.1268204152584076,-0.056018322706222534,0.11921973526477814,-0.2940819561481476,-0.3408498466014862,0.4250892698764801},{0.40980178117752075,0.08703567832708359,0.053404223173856735,-0.3050388991832733,-0.2949985861778259,-0.46561887860298157,-0.11011629551649094,0.435152143239975},{-0.30189839005470276,-0.2603296637535095,-3.292067412985489e-05,-0.1758127063512802,0.0633389875292778,0.33492690324783325,-0.45204412937164307,0.5442730188369751},{0.07656306028366089,0.022780712693929672,0.022625882178544998,-0.10545793920755386,0.2747337818145752,-0.4473192095756531,0.3556542992591858,-0.47324058413505554}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.01918741688132286,0.02981935255229473,0.11942023783922195,-0.04196067526936531,-0.06237749382853508,-0.049162607640028,0.13340267539024353,-0.04142243042588234};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.03734222427010536,-0.01971048302948475,0.0455172099173069,-0.10106004029512405,0.02390112727880478,0.008029079996049404,-0.017042705789208412,-0.06207195296883583};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

