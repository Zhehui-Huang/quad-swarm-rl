#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.28958529233932495,0.006164036225527525,-0.09875919669866562,0.3111770451068878,0.28881576657295227,-0.23075661063194275,-0.3047265410423279,0.11190725117921829,0.29850339889526367,-0.3288779854774475,0.5354313850402832,-0.06387393921613693,0.27300775051116943,0.16524796187877655,-0.4046781361103058,0.04679694026708603},{-0.24423114955425262,-0.26851487159729004,-0.29912707209587097,-0.23166891932487488,0.08643752336502075,0.3469972312450409,0.10528169572353363,0.11014764755964279,0.23509694635868073,0.17051444947719574,-0.13153858482837677,-0.05810189247131348,-0.12128349393606186,0.051315534859895706,0.33265209197998047,-0.31096914410591125},{0.1333569437265396,0.23192955553531647,0.2050955444574356,0.3028920292854309,-0.09130775928497314,-0.18560150265693665,0.3925263583660126,-0.04398566484451294,0.0232821274548769,-0.07356621325016022,-0.08736495673656464,-0.003788185305893421,0.04882385954260826,0.38387712836265564,-0.27040451765060425,-0.11838832497596741},{0.15192125737667084,-0.17592808604240417,-0.10785935074090958,-0.13401928544044495,0.059174083173274994,0.09131574630737305,0.08638424426317215,-0.19250746071338654,-0.15003572404384613,0.12349126487970352,0.4594045579433441,-0.2403932809829712,-0.1986924707889557,-0.14028725028038025,0.1944086104631424,0.10195440798997879},{-0.30376943945884705,-0.0030029809568077326,0.1147470772266388,-0.2357044368982315,0.2672325372695923,0.3447555601596832,0.14050768315792084,-0.2044985443353653,-0.1490917056798935,0.139212504029274,-0.12375611066818237,-0.39802220463752747,-0.06418266147375107,-0.1677570641040802,0.28347060084342957,-0.043586522340774536},{0.05280788987874985,-0.06635752320289612,-0.022912343963980675,-0.06130765378475189,0.12119363248348236,-0.15743248164653778,0.42312201857566833,-0.31954869627952576,-0.14118380844593048,-0.1751660257577896,0.3034364879131317,0.06600277870893478,0.24639835953712463,0.02593863569200039,0.27944788336753845,0.24946026504039764},{-0.2515716254711151,0.16982418298721313,-0.11331188678741455,0.03087335266172886,-0.243916317820549,-0.09593211114406586,-0.17784129083156586,-0.024529729038476944,0.19127553701400757,0.32270774245262146,-0.2956039607524872,-0.12161890417337418,0.23006737232208252,0.07396743446588516,-0.21610203385353088,0.32535678148269653},{-0.13222868740558624,0.01804523356258869,-0.10157360136508942,-0.17159602046012878,0.3619275987148285,-0.27718934416770935,-0.27646395564079285,-0.41246476769447327,-0.15990762412548065,-0.2472025454044342,0.3591987192630768,-0.006357100326567888,0.1770855337381363,0.18760165572166443,-0.16645202040672302,0.41196173429489136},{0.22083213925361633,0.0918787494301796,0.03336899355053902,0.05275812745094299,-0.3823336660861969,-0.45829036831855774,0.31857937574386597,-0.33999866247177124,-0.190992534160614,0.19493427872657776,0.16149823367595673,-0.3147487938404083,-0.17791828513145447,0.1060405969619751,0.16759677231311798,-0.008503550663590431},{0.4290616512298584,-0.5613151788711548,-0.145115926861763,-0.04076467081904411,0.18172785639762878,-0.24734270572662354,-0.24440670013427734,-0.21441170573234558,-0.14486438035964966,-0.010058893822133541,-0.04596959799528122,-0.19134560227394104,0.3984489440917969,-0.1250283122062683,-0.4965856075286865,-0.15142454206943512},{0.19946666061878204,0.17861001193523407,-0.33289194107055664,0.11769693344831467,-0.02593669481575489,-0.27117112278938293,-0.16473029553890228,0.11615815758705139,-0.16342732310295105,0.15183334052562714,0.14314399659633636,0.2684062421321869,-0.1420287787914276,0.2779175639152527,-0.10129323601722717,-0.19728738069534302},{-0.43864476680755615,0.2575812041759491,0.25263258814811707,-0.28489062190055847,-0.3560749292373657,0.26528725028038025,0.04695935174822807,0.2979282736778259,0.177740678191185,0.21592307090759277,0.3065005838871002,-0.07302731275558472,0.06646711379289627,-0.0560571663081646,-0.0919831395149231,-0.14362278580665588},{0.13215430080890656,-0.2600589394569397,-0.19977232813835144,0.2658827006816864,-0.18632784485816956,-0.2647937536239624,-0.16143305599689484,0.3054983913898468,0.29090213775634766,-0.1704438179731369,-0.16660964488983154,0.0982653871178627,0.31870999932289124,0.13216635584831238,-0.18062706291675568,0.3376792073249817},{0.3138365149497986,0.18732932209968567,-0.17898429930210114,-0.09402290731668472,0.11558596789836884,-0.09353019297122955,-0.10566309839487076,0.2990223169326782,-0.2577441930770874,-0.20576754212379456,-0.15202631056308746,0.012827327474951744,-0.23329482972621918,-0.13379469513893127,-0.25628453493118286,-0.05755864456295967},{0.1537298858165741,0.36817362904548645,0.4016696810722351,-0.40856683254241943,-0.3849012553691864,0.050401680171489716,0.06951498985290527,-0.10639508813619614,0.36427026987075806,0.34744980931282043,-0.1931934505701065,0.10314395278692245,-0.034999094903469086,-0.3312166929244995,-0.006060177460312843,-0.126351460814476},{-0.18034586310386658,-0.19804328680038452,-0.13786064088344574,0.3931535482406616,-0.23419272899627686,-0.13888409733772278,-0.24201051890850067,-0.27416250109672546,-0.569364070892334,-0.201898992061615,0.3802880644798279,0.29495176672935486,-0.6271529793739319,-0.3580982983112335,-0.6385140419006348,-0.14401869475841522},{-0.5458274483680725,0.1759335696697235,-0.470036119222641,-0.08678430318832397,-0.4216468930244446,0.22431519627571106,0.4718915522098541,0.07308485358953476,0.4548814594745636,-0.461742103099823,0.2136615514755249,-0.35968318581581116,-0.16630320250988007,-0.004713912028819323,-0.1913960725069046,-0.1877060830593109},{0.3039632737636566,-0.6023905277252197,0.2855823338031769,0.3343021869659424,-0.13691842555999756,0.48109695315361023,0.30976447463035583,0.2779926061630249,-0.12212356179952621,-0.326587051153183,-0.10557515174150467,-0.17650224268436432,-0.05945626646280289,-0.5073185563087463,0.17308850586414337,-0.08993750065565109}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.07387065142393112,0.3108205199241638,0.24474884569644928,-0.11765924096107483,-0.2265247255563736,0.051659200340509415,-0.015194723382592201,0.31625351309776306,-0.10085248202085495,0.3364631235599518,0.4801914095878601,-0.4041997492313385,0.02043934352695942,0.03778518736362457,0.032060518860816956,-0.14665855467319489},{-0.48366278409957886,0.17616033554077148,-0.2491455078125,0.2879273295402527,0.27204033732414246,-0.1559828817844391,-0.3312196135520935,-0.19613690674304962,0.360247939825058,0.2405410259962082,-0.07127775996923447,0.27777770161628723,-0.4371778070926666,0.20425070822238922,-0.24940423667430878,0.4924887418746948},{-0.3134802281856537,0.11564291268587112,-0.37750402092933655,0.19370576739311218,-0.4731517732143402,-0.2862897217273712,0.09089843928813934,0.14824555814266205,-0.28211867809295654,0.42415541410446167,0.268492728471756,-0.19747570157051086,0.19053764641284943,-0.29672202467918396,-0.17988066375255585,-0.09559253603219986},{0.34949663281440735,-0.25390973687171936,0.12887726724147797,0.41872522234916687,-0.42308560013771057,-0.30305927991867065,0.29815566539764404,0.057750169187784195,0.2934604585170746,-0.0632803663611412,0.3545318841934204,0.08508694171905518,-0.2094077169895172,-0.024660374969244003,0.018605850636959076,-0.463299423456192},{-0.4027397930622101,-0.0465608686208725,0.1769879311323166,-0.2904762029647827,0.163486510515213,0.45923641324043274,-0.28144219517707825,0.29243704676628113,-0.2225397676229477,0.23592376708984375,-0.03340091556310654,-0.001971025951206684,-0.23867250978946686,-0.02376154623925686,-0.2756538987159729,-0.14260156452655792},{0.07168550044298172,-0.31029364466667175,0.022412490099668503,-0.3422107994556427,0.22787198424339294,0.04280034452676773,-0.16426600515842438,-0.06522639095783234,-0.13281331956386566,0.4079531729221344,0.23022790253162384,-0.017704635858535767,-0.2828458547592163,0.06990576535463333,0.018977506086230278,-0.30437496304512024},{0.28650137782096863,-0.15795336663722992,0.35837826132774353,-0.27902093529701233,-0.40329819917678833,-0.08266139030456543,-0.3542834222316742,0.34056875109672546,-0.0903320237994194,-0.2671707272529602,-0.2182508111000061,-0.020913703367114067,-0.03644109144806862,-0.08432938158512115,0.5014796257019043,-0.34881559014320374},{-0.30751320719718933,0.36184531450271606,-0.05977727472782135,0.1836816519498825,-0.040699463337659836,-0.19835534691810608,-0.22766852378845215,0.06849640607833862,0.02867378294467926,0.5343672633171082,0.11933638900518417,-0.10253763943910599,0.050629351288080215,-0.24892467260360718,0.12291085720062256,0.16042163968086243},{0.0852586179971695,0.2542352080345154,-0.16427752375602722,-0.36450451612472534,0.35325732827186584,-0.1746779978275299,0.11038404703140259,-0.3199821710586548,0.1696535348892212,0.09406349807977676,0.08010006695985794,0.15884017944335938,0.01754968799650669,-0.4437710642814636,-0.018178099766373634,0.22438980638980865},{-0.2668038308620453,0.08056746423244476,-0.31463003158569336,-0.3572056293487549,0.23448126018047333,-0.43127068877220154,-0.1540057361125946,0.29653123021125793,-0.1772940754890442,0.14538583159446716,-0.0338042713701725,-0.10143836587667465,-0.37089306116104126,0.09751447290182114,-0.2666206657886505,-0.2897355854511261},{-0.13739722967147827,-0.14350704848766327,0.014784089289605618,-0.2476576864719391,-0.31713107228279114,-0.03187188506126404,0.1571943610906601,-0.43684589862823486,0.01813172735273838,-0.11809493601322174,0.2771843373775482,-0.05970010533928871,0.31156376004219055,0.1749362051486969,0.22953179478645325,0.23354332149028778},{-0.0731915831565857,-0.03400912135839462,-0.4180767834186554,0.3419798016548157,0.10714881122112274,0.12776511907577515,0.2693576514720917,0.18747758865356445,-0.4634653925895691,0.18029971420764923,-0.31053081154823303,-0.23215670883655548,-0.357875257730484,0.4120488166809082,-0.36699178814888,0.06371790915727615},{-0.20621459186077118,-0.5115402340888977,-0.1315981149673462,0.18174675107002258,-0.23933880031108856,-0.021035222336649895,-0.0886053740978241,0.40543559193611145,0.4832465350627899,0.14262717962265015,-0.01701492816209793,-0.1924324631690979,0.16362516582012177,-0.4026910960674286,0.11193376034498215,-0.2148970365524292},{-0.3266732096672058,-0.4572359621524811,-0.20072193443775177,-0.15805236995220184,-0.46260806918144226,0.5442820191383362,-0.16480974853038788,0.21338605880737305,-0.10673689842224121,-0.24689973890781403,-0.3731202185153961,0.46771934628486633,-0.21459895372390747,-0.057880889624357224,-0.273332417011261,0.38723254203796387},{-0.3985174894332886,0.35056260228157043,-0.2302115559577942,0.13141153752803802,-0.3993780016899109,0.18864794075489044,-0.08624327182769775,-0.27037298679351807,0.1235092431306839,0.2646120488643646,-0.2804911434650421,0.05876723676919937,0.2273372858762741,-0.38808736205101013,-0.3461720049381256,-0.15242089331150055},{-0.12692849338054657,-0.34904658794403076,-0.45697706937789917,0.24586494266986847,0.08343251794576645,0.0666072815656662,-0.2550947070121765,0.21032066643238068,-0.34814685583114624,-0.27092236280441284,-0.30114805698394775,0.22321073710918427,-0.18316614627838135,0.1403914988040924,0.08225394785404205,0.28179651498794556}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10375863313674927,-0.05399821326136589,0.08656400442123413,-0.13920612633228302,-0.13378199934959412,0.09482691437005997,0.17049728333950043,-0.23515240848064423,-0.10936066508293152,0.29521268606185913,0.0943630263209343,0.16673538088798523,0.11468993872404099,0.18383833765983582,-0.1891736388206482,0.14691689610481262,0.11118704080581665,-0.3655569553375244,-0.2775329053401947,-0.10022711753845215,-0.1568518429994583,0.1296592801809311,-0.2443191409111023,0.28219324350357056,-0.07125973701477051,0.005878983065485954,0.16853424906730652,0.19562935829162598,-0.2595224678516388,-0.21700236201286316,0.24924351274967194,0.29951363801956177},{0.2511340081691742,-0.04766331985592842,0.15723207592964172,-0.09889227151870728,-0.11502842605113983,0.26871541142463684,-0.01797640323638916,-0.06404802203178406,-0.05284951627254486,0.0055888062343001366,-0.15005432069301605,0.02109876461327076,0.4079819321632385,0.16228671371936798,0.15501056611537933,0.10500406473875046,-0.26250916719436646,-0.3636426329612732,0.11046995967626572,0.022189978510141373,0.04321250692009926,0.31058910489082336,0.23841242492198944,-0.23888131976127625,0.057546596974134445,0.28263092041015625,-0.30934587121009827,0.19261938333511353,0.15125827491283417,-0.22404995560646057,-0.037728048861026764,-0.0025723574217408895},{-0.116050124168396,-0.0214871596544981,0.20985770225524902,-0.1846451759338379,-0.24614867568016052,-0.0027124967891722918,-0.2064010351896286,0.20466510951519012,0.19142097234725952,-0.03425885736942291,-0.1503487080335617,0.06812746822834015,0.29858407378196716,-0.1963738203048706,0.0829264298081398,-0.023047296330332756,-0.3562568724155426,0.2278836965560913,-0.31498441100120544,-0.05192107707262039,0.0027335581835359335,-0.1349828541278839,-0.08220052719116211,-0.13729555904865265,0.037682339549064636,0.37552574276924133,-0.026448605582118034,0.09903190284967422,0.2619338929653168,-0.34304094314575195,-0.1572721153497696,-0.01802234537899494},{0.17151296138763428,-0.20481465756893158,0.06770484149456024,-0.3981334865093231,0.17899683117866516,-0.07690463960170746,-0.024939628317952156,0.2750961482524872,0.040675755590200424,0.22517219185829163,0.078093521296978,-0.16540582478046417,-0.22254520654678345,-0.09297726303339005,0.28964704275131226,-0.2581096887588501,0.07928139716386795,-0.09294440597295761,-0.14071083068847656,0.10197480022907257,-0.13899391889572144,0.09968659281730652,-0.19624271988868713,0.29430970549583435,-0.32985225319862366,0.04460922256112099,-0.09136287122964859,-0.23371876776218414,0.0204453244805336,0.07057943195104599,0.22915777564048767,-0.1011650338768959},{0.220949187874794,0.014949015341699123,0.043835826218128204,0.28329285979270935,-0.2828458547592163,-0.07638175040483475,0.1514330357313156,-0.09425521641969681,0.08418870717287064,-0.21618865430355072,0.012307546101510525,-0.04954208433628082,-0.1156257763504982,-0.10899969190359116,0.299228310585022,0.32822293043136597,-0.11643341928720474,-0.341789186000824,0.18532134592533112,-0.08484598249197006,-0.13740107417106628,0.21394304931163788,0.2767238914966583,0.04454731196165085,-0.03180230036377907,-0.10684194415807724,-0.04029395058751106,0.26811671257019043,0.252135306596756,0.10300263017416,0.06962963193655014,-0.30075177550315857},{0.3027868866920471,-0.17576541006565094,0.06882070749998093,0.08253652602434158,-0.15483833849430084,-0.29580754041671753,-0.18545792996883392,-0.2873285412788391,-0.258222371339798,-0.007197302766144276,0.009607539512217045,-0.04279559105634689,-0.1644655168056488,-0.02470468543469906,-0.21850334107875824,-0.24392101168632507,0.18750980496406555,0.03688506409525871,-0.2713601291179657,0.22222135961055756,-0.024480396881699562,-0.24254058301448822,0.20392738282680511,-0.1473725289106369,-0.14632607996463776,-0.26998642086982727,-0.10556433349847794,0.10888712853193283,0.09548737853765488,0.27317118644714355,-0.30252140760421753,0.15336887538433075},{0.22286328673362732,0.04037736356258392,0.25628209114074707,-0.1982460916042328,0.26137498021125793,-0.1397138088941574,-0.25483232736587524,0.035733822733163834,0.2913278639316559,0.21426914632320404,-0.18361368775367737,0.06271274387836456,0.07370952516794205,0.31970924139022827,0.13922350108623505,-0.10688260942697525,-0.19345898926258087,0.1468520313501358,-0.014388618059456348,0.005199755076318979,-0.11986879259347916,0.2665170729160309,0.1885073333978653,0.20657990872859955,-0.2994987964630127,-0.2743377983570099,-0.2781798839569092,-0.3861379325389862,0.009013602510094643,-0.07222452014684677,0.26303189992904663,0.16753487288951874},{0.34322211146354675,-0.37137338519096375,0.13589167594909668,-0.41858163475990295,-0.24770671129226685,0.3587301969528198,0.4137113690376282,0.19512797892093658,-0.09041620045900345,0.08265072107315063,0.15470166504383087,-0.1788925975561142,0.12120363861322403,0.2986309826374054,-0.019778313115239143,0.1973733752965927,0.41703882813453674,-0.18797916173934937,-0.05533420667052269,-0.29970720410346985,0.13340744376182556,0.261570006608963,0.27948665618896484,0.1895923912525177,0.05185813084244728,0.06768162548542023,0.10389652848243713,0.2342303842306137,-0.21235956251621246,-0.193233922123909,0.25593045353889465,0.017229583114385605},{-0.08183404058218002,-0.018165698274970055,0.22737213969230652,0.24843217432498932,-0.23494663834571838,-0.41292500495910645,-0.0521935373544693,0.2115485817193985,-0.2046426236629486,-0.36674565076828003,0.18041636049747467,0.14168167114257812,0.07991591095924377,-0.26710206270217896,0.08592411875724792,-0.18899567425251007,-0.1497381180524826,0.15515466034412384,-0.2408641278743744,0.31028294563293457,-0.2109495848417282,-0.4485163986682892,-0.33216017484664917,0.19594505429267883,0.16142798960208893,0.15843863785266876,0.2878991365432739,0.21128176152706146,-0.1619916707277298,-0.33391985297203064,-0.19337265193462372,0.1345084309577942},{0.38105282187461853,-0.016869476065039635,0.00021003499568905681,0.11939942091703415,0.11594707518815994,0.2994835674762726,0.031765855848789215,0.38905781507492065,-0.07362117618322372,0.1284358948469162,0.13200479745864868,0.02847934700548649,-0.25899118185043335,-0.4796074628829956,0.13659243285655975,0.1865408569574356,0.12660343945026398,-0.15402622520923615,-0.03638605773448944,-0.13494865596294403,0.16082362830638885,-0.3511788547039032,0.3000008761882782,0.02191508747637272,-0.1139136403799057,0.13149578869342804,-0.3037409782409668,-0.16189725697040558,0.07981749624013901,0.04813487082719803,0.1656547635793686,0.3282281756401062},{-0.10580963641405106,0.09144412726163864,-0.1537913978099823,0.162453293800354,-0.13318747282028198,0.26113954186439514,0.09109773486852646,-0.03589845448732376,0.3350082337856293,-0.27086666226387024,-0.16801536083221436,0.17668651044368744,-0.1749299019575119,0.012172732502222061,-0.3180425763130188,-0.030904585495591164,0.11043056845664978,0.13798217475414276,0.009827652014791965,-0.18853119015693665,-0.23011921346187592,0.19202932715415955,0.17237360775470734,0.17449110746383667,-0.282731294631958,0.40110132098197937,-0.06761761754751205,-0.020608287304639816,-0.11584445089101791,0.1028895378112793,0.2554543912410736,0.3092857599258423},{-0.3124464452266693,0.3475496470928192,-0.01926693506538868,0.02504868432879448,-0.2546028196811676,-0.2628529369831085,0.17269527912139893,-0.3431515097618103,-0.12163591384887695,-0.4059063792228699,-0.07635185867547989,-0.038987766951322556,0.16436681151390076,-0.1980096399784088,-0.1474740207195282,-0.3148585259914398,-0.18382368981838226,-0.01856997422873974,0.38307368755340576,-0.23379068076610565,0.17757464945316315,-0.29490187764167786,0.04532664269208908,0.2615237832069397,-0.09632344543933868,0.1676671802997589,0.23255978524684906,-0.07868756353855133,-0.030878577381372452,0.2960417866706848,-0.2587507367134094,-0.35295507311820984},{-0.001080651069059968,0.24131201207637787,0.17554433643817902,-0.25248953700065613,0.2712285816669464,0.0026792027056217194,-0.17465288937091827,-0.015403655357658863,0.18502481281757355,-0.2397567182779312,-0.11164307594299316,0.06992616504430771,0.16845013201236725,-0.031385038048028946,0.06820042431354523,-0.04711373150348663,0.1899309903383255,-0.32801640033721924,0.28483596444129944,0.019807152450084686,-0.19899365305900574,0.23530583083629608,-0.1373569816350937,-0.2681293189525604,0.23743006587028503,-0.0446053184568882,0.04064472019672394,-0.09228169918060303,0.10653147101402283,-0.1728527694940567,0.36626821756362915,0.30600136518478394},{0.04104912653565407,-0.26022037863731384,-0.2097017616033554,0.05854475498199463,-0.04880316182971001,0.28990602493286133,-0.14609161019325256,-0.3774096965789795,0.37812018394470215,0.06630770862102509,0.023238662630319595,0.04978373646736145,-0.05414541810750961,0.24821333587169647,-0.23803885281085968,-0.3710443079471588,0.016681186854839325,0.05549608916044235,0.14505720138549805,0.4832577705383301,-0.30493924021720886,0.22885927557945251,-0.16824141144752502,0.14086726307868958,0.17532531917095184,-0.36165186762809753,-0.16041775047779083,-0.37241047620773315,-0.21642665565013885,-0.17516016960144043,0.13543838262557983,-0.44059255719184875},{-0.15037988126277924,0.3956632912158966,-0.017252227291464806,-0.13688616454601288,-0.2207580953836441,-0.32760217785835266,0.059377703815698624,-0.16758693754673004,0.37260887026786804,-0.0736912414431572,0.21470262110233307,0.30057740211486816,0.009182021953165531,0.09727591276168823,-0.1763559877872467,0.1604676991701126,-0.22402238845825195,-0.4479484260082245,-0.3937820494174957,0.08311192691326141,0.13341854512691498,-0.21417279541492462,-0.4272524118423462,-0.30889585614204407,-0.06765160709619522,0.21597787737846375,0.4357524514198303,0.027680477127432823,-0.12023649364709854,-0.049666691571474075,-0.03310302272439003,0.10769978910684586},{-0.27615225315093994,-0.18729865550994873,-0.1892409771680832,0.050656598061323166,-0.28356680274009705,-0.16507692635059357,-0.07144376635551453,-0.15329350531101227,-0.3224290907382965,-0.2917817234992981,0.2431940883398056,0.14452578127384186,-0.290505975484848,0.30829644203186035,-0.07540278881788254,0.13184252381324768,0.09640536457300186,0.05866190046072006,0.06379963457584381,0.19321997463703156,0.2271236628293991,0.23279783129692078,0.11683982610702515,0.27060893177986145,0.12856976687908173,-0.2412003129720688,-0.1768835186958313,0.21677856147289276,-0.08088253438472748,-0.19073882699012756,-0.2254628688097,-0.24212931096553802},{-0.2637554705142975,-0.18483050167560577,-0.3584737479686737,0.11517554521560669,-0.08445719629526138,-0.06055403873324394,-0.11863214522600174,0.128521129488945,-0.06936168670654297,0.07935319095849991,-0.23936782777309418,0.03278152272105217,0.17488843202590942,-0.10869824886322021,0.05813780799508095,0.23346267640590668,-0.13646385073661804,-0.16489119827747345,0.17614643275737762,0.04567040130496025,0.18849946558475494,-0.013147505931556225,-0.19955295324325562,0.03729197382926941,0.20768381655216217,-0.24820640683174133,0.1410941779613495,0.08522260934114456,0.09920142590999603,-0.16237366199493408,0.2540070414543152,-0.04400206357240677},{0.24101240932941437,-0.020426269620656967,0.00578749505802989,0.17103834450244904,-0.3271775543689728,-0.023674139752984047,0.10416776686906815,0.18447721004486084,-0.05831337720155716,-0.14887399971485138,0.3054841458797455,-0.12128005921840668,0.047614458948373795,-0.03437678888440132,-0.15899008512496948,0.2448451817035675,-0.024864019826054573,-0.10984443128108978,0.09500184655189514,-0.2958618700504303,-0.014186992309987545,-0.2615225911140442,-0.2140987664461136,0.24201135337352753,-0.05852136388421059,-0.05720013752579689,0.1585155725479126,0.029461760073900223,-0.1778966635465622,-0.06994802504777908,-0.05247852951288223,-0.06360368430614471},{0.3068258464336395,-0.06415954232215881,0.09095325320959091,0.044368159025907516,-0.028347549960017204,-0.09689236432313919,0.18659254908561707,-0.23847447335720062,0.2535173296928406,0.29555797576904297,0.026807546615600586,0.14196664094924927,0.24517717957496643,0.3409995436668396,-0.2839356064796448,-0.3341031074523926,-0.25676393508911133,0.0717323049902916,-0.15488287806510925,-0.28020596504211426,-0.1692887544631958,0.2640798091888428,0.06468915194272995,0.1444961279630661,-0.1404401957988739,-0.12627838551998138,-0.14462971687316895,-0.23599368333816528,0.25260892510414124,0.1827552765607834,-0.31352871656417847,-0.13799402117729187},{-0.1205289363861084,0.1597519963979721,0.2563241720199585,-0.04598177224397659,-0.05016258358955383,0.04866643249988556,-0.03334422409534454,-0.33241742849349976,0.21249455213546753,0.2367442548274994,0.1679724156856537,0.24286526441574097,-0.21581992506980896,0.2133282721042633,-0.2860298752784729,0.2971416711807251,0.16356360912322998,-0.2671041488647461,0.22245053946971893,0.09559255838394165,-0.3350965082645416,0.3250143527984619,-0.2853604257106781,0.1401769518852234,0.2522484362125397,0.28092801570892334,0.08590307086706161,0.13622330129146576,-0.18441610038280487,0.2020360827445984,-0.038265928626060486,0.11077532172203064},{-0.11126194149255753,-0.10567894577980042,0.004328656010329723,0.18550647795200348,0.026124142110347748,0.21309615671634674,-0.282904714345932,-0.09416590631008148,-0.13306695222854614,-0.07525655627250671,-0.16707417368888855,-0.17175394296646118,0.03039410524070263,-0.1958812177181244,0.0961332842707634,-0.1959981769323349,0.23894956707954407,-0.03885267302393913,-0.31917962431907654,-0.2858060300350189,0.1222037598490715,0.17363587021827698,-0.179331973195076,0.30247604846954346,-0.25367414951324463,0.06463490426540375,0.10971180349588394,-0.08453010022640228,0.16427911818027496,-0.2251197099685669,0.3204224407672882,0.15855605900287628},{0.33474668860435486,0.04106948524713516,0.11597082018852234,0.19376610219478607,-0.20921814441680908,0.18646226823329926,-0.06786949932575226,0.18557095527648926,0.07848847657442093,0.058266498148441315,0.08941555768251419,-0.34448906779289246,-0.2704053223133087,0.010967420414090157,0.11222037672996521,-0.06633702665567398,0.26741063594818115,0.15536567568778992,-0.16346071660518646,-0.22087092697620392,0.3239436149597168,0.1868969053030014,0.27462461590766907,0.09156467765569687,-0.04529658704996109,0.031804706901311874,-0.08178272843360901,-0.15613864362239838,0.2927614748477936,0.05688638985157013,-0.18924227356910706,0.11874806135892868},{-0.011961698532104492,0.01242322288453579,-0.05975889787077904,-0.2379692941904068,-0.07973553240299225,-0.2137739062309265,-0.22212691605091095,-0.13708099722862244,-0.003398529952391982,-0.007077447138726711,-0.2782899737358093,0.019048167392611504,-0.22178047895431519,-0.1532052755355835,0.0037331245839595795,0.10079538077116013,0.2691132426261902,-0.1813306212425232,-0.3364960849285126,0.25228336453437805,-0.19172461330890656,0.2873763144016266,0.025587324053049088,-0.028548365458846092,0.029777226969599724,0.15554453432559967,-0.07963243871927261,-0.2593716084957123,0.22133572399616241,0.24755413830280304,-0.12291815131902695,0.19192498922348022},{-0.25464338064193726,-0.039391204714775085,0.03791872411966324,-0.04081710800528526,0.0902828797698021,0.1260276883840561,-0.17317458987236023,0.11977482587099075,-0.16797709465026855,-0.170607328414917,0.10944077372550964,-0.1414938122034073,-0.20742017030715942,0.23672224581241608,0.0005729079130105674,0.00888790562748909,0.21277262270450592,-0.2357778549194336,-0.16692562401294708,0.2781779170036316,0.04770831763744354,0.22406592965126038,-0.05294681340456009,0.011064495891332626,-0.2777862548828125,-0.1809859722852707,0.025782795622944832,0.2852703928947449,-0.004942047875374556,0.013560067862272263,0.2689618170261383,0.2978159487247467}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.06740269064903259,0.2504849433898926,0.4769028425216675,-0.08299809694290161},{0.13793237507343292,-0.16447104513645172,0.06136467680335045,0.26235106587409973},{-0.16996721923351288,0.18855254352092743,0.16426114737987518,0.13782085478305817},{0.3084059953689575,0.007556312717497349,0.04912896826863289,0.49883508682250977},{-0.12517863512039185,0.11251644045114517,0.41215965151786804,-0.08716512471437454},{-0.10617203265428543,0.2736126482486725,0.2993605136871338,-0.1708354949951172},{-0.32731014490127563,-0.019097262993454933,0.0019072190625593066,-0.13635742664337158},{-0.42522647976875305,-0.1640295386314392,0.4656100869178772,-0.3444986045360565},{0.41719257831573486,-0.1629059910774231,-0.30561405420303345,-0.4478454887866974},{0.08127041161060333,0.3528745472431183,0.41528409719467163,-0.5324540734291077},{-0.2207595854997635,-0.1969672292470932,-0.27727073431015015,0.19647902250289917},{0.45159944891929626,-0.2463059276342392,-0.05835726484656334,0.23763392865657806},{0.3542201519012451,0.2863321304321289,-0.05733344331383705,0.13742627203464508},{0.03526122123003006,0.13439121842384338,-0.3550078868865967,-0.021058324724435806},{0.10348273813724518,0.33131805062294006,0.46450039744377136,0.34797486662864685},{0.20713134109973907,0.018196968361735344,0.33253222703933716,0.26144787669181824},{-0.2876315712928772,-0.09313160181045532,-0.09585784375667572,-0.3246666193008423},{-0.2769644856452942,0.16105517745018005,-0.17857415974140167,-0.10565979778766632},{-0.25194039940834045,0.25018110871315,0.18900765478610992,0.3710826337337494},{-0.04392172023653984,0.37345588207244873,-0.23922012746334076,0.08668707311153412},{-0.34306296706199646,-0.40799376368522644,-0.10187092423439026,0.06579594314098358},{0.4142509996891022,0.548249363899231,0.05579187721014023,-0.3800550401210785},{-0.09256282448768616,0.2347259223461151,0.28301694989204407,0.18155410885810852},{-0.13090075552463531,0.4166103005409241,-0.0862782672047615,-0.17578867077827454},{0.06769620627164841,-0.047437816858291626,-0.1401839405298233,0.05132340267300606},{0.3339301645755768,-0.5264692306518555,-0.0035565451253205538,0.04827108606696129},{0.024184178560972214,-0.4316513240337372,-0.2661289572715759,-0.21555788815021515},{0.12373659759759903,-0.1978495568037033,0.19329342246055603,0.2445874959230423},{0.005723234266042709,-0.06096642464399338,0.16266320645809174,0.07158038020133972},{-0.4260755479335785,0.38047605752944946,0.2590971291065216,-0.06617456674575806},{0.39360305666923523,-0.1526888757944107,0.2576632499694824,-0.13431234657764435},{0.09865505993366241,-0.47797733545303345,0.49894165992736816,-0.37325066328048706}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.06281925737857819,-0.03951294720172882,0.04838321730494499,-0.03952733427286148,-0.029325883835554123,-0.12981915473937988,-0.12307915091514587,0.05763982608914375,0.048968203365802765,-0.017098676413297653,0.08507455140352249,0.06219276040792465,-0.08603587001562119,-0.13116641342639923,0.07252545654773712,-0.08494081348180771};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.0647311732172966,0.07141721248626709,0.0267769955098629,0.015602593310177326,0.07707829028367996,-0.02169272117316723,0.095757856965065,-0.02151612937450409,-0.03220858797430992,0.028385216370224953,-0.017884744331240654,-0.0501004196703434,0.07908620685338974,-0.04175543412566185,-0.03947111964225769,-0.03543800860643387};
static const float actor_encoder_feed_forward_0_bias[32] = {0.0804780051112175,0.07023029774427414,0.02325785718858242,0.07616370171308517,0.05500063672661781,-0.0024700264912098646,-0.04774894937872887,-0.020458724349737167,-0.02714221365749836,0.018628545105457306,-0.0683162733912468,0.042805660516023636,0.06664393097162247,-0.07460486143827438,0.0955798402428627,0.08994722366333008,-0.07613500952720642,-0.07195886224508286,0.025188542902469635,0.0036281398497521877,-0.05969332531094551,0.020917927846312523,0.08531024307012558,0.0022206068970263004,-0.03369436040520668,0.007268898189067841,-0.06691618263721466,0.058247536420822144,0.05142214149236679,0.014593821950256824,0.03895341977477074,0.03967469558119774};
static const float action_parameterization_distribution_linear_bias[4] = {0.04685891792178154,0.0210692398250103,0.06552866101264954,0.048684749752283096};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.0011468890588730574,0.25415128469467163,-0.13837632536888123,0.19200396537780762,0.23603734374046326,0.11734551936388016,0.27800342440605164,-0.021371742710471153},{-0.22068919241428375,-0.06735894083976746,-0.28588226437568665,-0.2466157227754593,-0.29761844873428345,-0.18103182315826416,-0.13595059514045715,-0.1947910636663437},{-0.29106593132019043,0.01179315336048603,0.23257453739643097,0.21515315771102905,0.25897789001464844,-0.017232006415724754,0.24039773643016815,-0.12150545418262482},{-0.01873873546719551,0.07528901100158691,-0.1879989355802536,-0.023738641291856766,-0.004179798532277346,-0.05016506835818291,0.24182763695716858,-0.19688163697719574},{-0.3461904227733612,-0.13663984835147858,-0.2303914576768875,-0.14985796809196472,-0.02445441670715809,0.17834217846393585,0.14834406971931458,-0.05534357950091362},{-0.31711289286613464,-0.014574226923286915,0.38056737184524536,0.2246864289045334,0.2061242014169693,-0.10906664282083511,-0.1518741399049759,-0.1488191932439804},{-0.22224991023540497,0.051094960421323776,0.39883410930633545,-0.22382162511348724,-0.08045840263366699,-0.40735527873039246,-0.11058387905359268,-0.1648823767900467},{-0.31808730959892273,-0.35733762383461,0.4794344902038574,-0.10375574976205826,-0.19100482761859894,0.21537263691425323,0.155100479722023,-0.25389590859413147},{-0.31034180521965027,0.2618144154548645,-0.18402431905269623,0.36009877920150757,0.08292440325021744,-0.3553575277328491,0.08294931054115295,0.05513953045010567},{-0.3050137460231781,-0.3236598074436188,-0.16895325481891632,-0.21197950839996338,-0.5360685586929321,0.09630943089723587,-0.007416354957967997,0.10154708474874496},{0.17435215413570404,0.33798161149024963,0.21008141338825226,-0.03256257623434067,0.16020317375659943,0.10824047029018402,-0.2093600183725357,0.1623617708683014},{0.2019227147102356,0.031197546049952507,0.2802003026008606,0.23000992834568024,-0.3124639689922333,0.2877137362957001,0.0034583311062306166,-0.2699245512485504},{0.11639390885829926,-0.29729992151260376,0.2580088973045349,-0.056820157915353775,-0.3330788016319275,-0.0734308585524559,-0.16906894743442535,-0.14936310052871704},{-0.22611843049526215,-0.1767827421426773,0.30212703347206116,0.34211811423301697,-0.2386692464351654,-0.07366276532411575,-0.29260480403900146,0.17968255281448364},{0.01327984593808651,-0.16463793814182281,0.058839067816734314,-0.2423434853553772,-0.3803337812423706,-0.14843863248825073,0.2190605103969574,0.011441829614341259},{0.1437704861164093,-0.028516240417957306,-0.07318218052387238,-0.3316034972667694,-0.06363439559936523,0.06437437981367111,-0.007110105827450752,0.3924965262413025},{-0.009545651264488697,-0.22043946385383606,-0.21530449390411377,0.031186142936348915,-0.14185117185115814,-0.11750427633523941,-0.13499687612056732,0.08013930916786194},{-0.17176461219787598,-0.27069514989852905,0.03781603276729584,-0.003184056840837002,0.17736415565013885,-0.2021484076976776,0.36658403277397156,0.12186110019683838},{0.052955541759729385,0.12021132558584213,-0.24799196422100067,0.09698337316513062,0.11405137926340103,0.17162278294563293,-0.2070804387331009,0.2847783863544464},{0.19452215731143951,-0.03781786933541298,-0.3688264787197113,0.06562819331884384,-0.0478312224149704,-0.06297402083873749,-0.3093266189098358,-0.04467674717307091},{0.09356219321489334,-0.13949541747570038,0.04985834285616875,-0.13231325149536133,0.293300062417984,-0.0011634862748906016,-0.07892701774835587,0.42079463601112366},{0.04667121171951294,0.14267617464065552,-0.27040842175483704,0.21122965216636658,0.30213692784309387,0.3037281334400177,0.132486030459404,-0.3064844310283661},{-0.3703424632549286,-0.10997989773750305,0.13372913002967834,-0.09390266239643097,0.1950778067111969,-0.3231075406074524,0.15452979505062103,-0.24033330380916595},{-0.11100397258996964,0.07559572905302048,-0.07776032388210297,-0.3975342810153961,0.22940613329410553,-0.023932067677378654,-0.3815968632698059,0.21616949141025543},{-0.18833982944488525,-0.16655413806438446,-0.008109875954687595,0.09531132876873016,-0.04501534625887871,0.15975421667099,0.2891327142715454,-0.05240267887711525},{-0.19601650536060333,0.07597977668046951,-0.3458133041858673,-0.2815702557563782,0.1281253844499588,-0.0009140816982835531,-0.09486138075590134,0.11221382766962051},{0.33848902583122253,0.38640016317367554,-0.26115161180496216,0.1716402918100357,0.1599021553993225,0.3423796594142914,-0.29468679428100586,-0.11527461558580399},{0.3996005356311798,0.2528478503227234,0.08227422088384628,0.06247030943632126,0.2247249186038971,0.13889209926128387,0.23750236630439758,0.3924042880535126},{-0.10852701216936111,0.3971661925315857,0.17074273526668549,-0.007510027848184109,0.20676186680793762,0.037712473422288895,-0.36791181564331055,-0.295703649520874},{-0.14318671822547913,-0.2205183207988739,0.06779883801937103,-0.22696664929389954,-0.3058907985687256,-0.1968364119529724,0.27983132004737854,-0.056475844234228134},{0.41864213347435,-0.2679002285003662,0.30421316623687744,-0.2760101556777954,0.0710991770029068,0.24955539405345917,0.16069617867469788,-0.21079036593437195},{0.25128620862960815,0.39703112840652466,0.3761902451515198,-0.24003306031227112,-0.18109743297100067,0.08923657238483429,0.24081550538539886,0.05535772070288658}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.020761968567967415,0.39610692858695984,-0.17245936393737793,0.25068846344947815,-0.39259570837020874,0.2641766667366028,0.425992876291275,0.06416323781013489},{-0.44464701414108276,-0.49708235263824463,-0.37924256920814514,-0.45194366574287415,-0.44620561599731445,0.3965838551521301,0.4457877278327942,-0.41392871737480164},{-0.008642231114208698,-0.1515294313430786,0.10512610524892807,0.05776454880833626,-0.07425045967102051,0.443791925907135,-0.3633415997028351,-0.3643247187137604},{0.5084882378578186,0.018514025956392288,0.08304879069328308,-0.024410665035247803,0.5544049143791199,0.39433738589286804,0.33177649974823,0.41015660762786865},{0.07586780190467834,0.2707931697368622,-0.14695435762405396,-0.10950154066085815,0.07953507453203201,-0.38686370849609375,-0.3728315234184265,0.44804689288139343},{0.3832412660121918,0.06713283061981201,0.04704340547323227,-0.3888789713382721,-0.43222200870513916,-0.4881288707256317,-0.10287569463253021,0.5310952067375183},{-0.492251992225647,-0.35048162937164307,-0.04014435410499573,-0.24521714448928833,0.0014082957059144974,0.46077996492385864,-0.5298833847045898,0.5995213985443115},{0.24026693403720856,0.0836336761713028,0.008629387244582176,-0.020133476704359055,0.42020395398139954,-0.5592674016952515,0.4395362436771393,-0.39977553486824036}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.061796460300683975,0.007074584718793631,0.04245958477258682,-0.0307056475430727,-0.012876586988568306,0.03244301676750183,0.011792612262070179,0.018140234053134918};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.017150767147541046,-0.04226350411772728,0.024389086291193962,-0.07663700729608536,-0.0037450415547937155,-0.03179449960589409,-0.02638687752187252,-0.07205809652805328};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

