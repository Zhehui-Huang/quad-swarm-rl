#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2616085708141327,-0.18320856988430023,0.3245101273059845,0.24276641011238098,-0.3774830996990204,0.1934528648853302,-0.020571695640683174,-0.21218805015087128,0.09804868698120117,0.3918009400367737,0.12096613645553589,0.06505022197961807,0.15559281408786774,-0.20204202830791473,0.3306455910205841,-0.10739912837743759},{-0.3500387370586395,-0.2944728136062622,0.2971688508987427,0.2048172950744629,-0.23019392788410187,0.07361102849245071,-0.3965389132499695,-0.002630606759339571,-0.15664590895175934,-0.13627412915229797,0.12288905680179596,-0.17818990349769592,0.2512668967247009,-0.41559234261512756,-0.19585020840168,0.09516580402851105},{0.14122630655765533,-0.2215261459350586,-0.28136998414993286,0.09246347844600677,0.10870801657438278,0.15613505244255066,-0.07119013369083405,0.025938520208001137,-0.12407063692808151,-0.20306527614593506,-0.17501112818717957,0.4216078519821167,0.012385047972202301,-0.15969708561897278,-0.42412132024765015,0.23744283616542816},{0.13160087168216705,0.19291356205940247,0.3158342242240906,-0.03672068566083908,-0.3226047456264496,-0.03831156715750694,0.1927436739206314,0.13312973082065582,0.4710642993450165,-0.3883001208305359,0.040011726319789886,0.17673823237419128,-0.35110315680503845,-0.017666295170783997,0.33497190475463867,-0.40229201316833496},{-0.036560703068971634,0.06999852508306503,0.21301265060901642,-0.1205805242061615,0.24685746431350708,0.29619571566581726,0.29001104831695557,-0.07728857547044754,-0.018606791272759438,0.25769034028053284,0.3439580202102661,-0.18682792782783508,-0.13553737103939056,-0.3019690215587616,0.4020145833492279,0.16018664836883545},{0.02294616959989071,-0.19384874403476715,-0.14347505569458008,-0.22210651636123657,0.13918788731098175,0.002160934265702963,0.02266545407474041,-0.1407015025615692,0.2316819578409195,-0.2662333846092224,-0.3036383092403412,0.18772973120212555,0.43953558802604675,0.0054128761403262615,0.00054981280118227,0.09886270016431808},{-0.05625615641474724,-0.009124611504375935,0.09659025818109512,-0.20923477411270142,0.20759443938732147,0.03319062665104866,0.0799175277352333,0.33242267370224,0.33340170979499817,-0.04291488602757454,-0.3547615706920624,0.17582647502422333,-0.11023743450641632,0.20511943101882935,-0.1613486111164093,-0.23218056559562683},{0.011898154392838478,0.007015857379883528,0.22108891606330872,0.25526919960975647,-0.3978123664855957,0.0022068368270993233,0.34260717034339905,0.3337389826774597,-0.06197638064622879,0.23766756057739258,-0.48470911383628845,-0.3079010248184204,0.21683824062347412,0.30628350377082825,0.2426699995994568,0.1084059327840805},{0.2581922709941864,-0.219615638256073,0.31701868772506714,-0.07706121355295181,0.26639339327812195,0.0689401924610138,-0.14854981005191803,-0.1906042993068695,0.09772315621376038,-0.30919915437698364,0.05329318717122078,-0.3024120032787323,-0.17670243978500366,0.36206793785095215,0.1566145271062851,-0.09424395859241486},{0.03140003979206085,-0.3691934645175934,-0.44106394052505493,-0.04042297229170799,-0.32610437273979187,0.16435770690441132,0.3598637878894806,0.2505583167076111,0.41087156534194946,0.3725701868534088,-0.035533007234334946,-0.30016201734542847,0.10441803932189941,0.28625380992889404,-0.06542893499135971,-0.30810821056365967},{0.08531235158443451,0.2670575976371765,0.45016735792160034,-0.35129526257514954,-0.3231431245803833,0.21189527213573456,0.15441033244132996,0.41076526045799255,-0.3261941075325012,-0.05082733556628227,-0.06765486299991608,0.1693519502878189,-0.29970884323120117,-0.17980314791202545,0.34737852215766907,-0.3349846601486206},{0.1313936710357666,-0.13441433012485504,-0.04718826711177826,0.14122968912124634,0.3190310001373291,0.2617899477481842,0.41916826367378235,0.0076306480914354324,-0.010979537852108479,0.05673041194677353,0.2722873091697693,-0.08238999545574188,-0.07650575786828995,-0.21573449671268463,0.23554861545562744,0.30102574825286865},{-0.146969735622406,0.39885514974594116,0.15337567031383514,-0.33370471000671387,0.037886641919612885,0.1305449903011322,0.2739754915237427,-0.026041628792881966,0.09245515614748001,0.016903523355722427,-0.08047021180391312,0.1691036969423294,0.25482887029647827,0.31117063760757446,0.10896915942430496,-0.22344157099723816},{-0.23043160140514374,-0.22161991894245148,-0.22810982167720795,-0.03721766546368599,-0.16579166054725647,0.10866939276456833,-0.3447742462158203,0.09900736063718796,-0.07829258590936661,-0.039119042456150055,-0.2866998016834259,-0.08049248903989792,-0.3258507251739502,0.12565436959266663,0.2254735231399536,0.08725175261497498},{-0.1168462261557579,-0.3951207399368286,-0.25225362181663513,0.343274861574173,0.03867504745721817,-0.33616238832473755,0.2765127420425415,-0.0708564966917038,-0.01641263999044895,0.2684939503669739,0.0530325211584568,0.20713208615779877,0.19232052564620972,-0.03257271274924278,-0.18494011461734772,0.1886833757162094},{0.5324614644050598,-0.10309012979269028,-0.26338282227516174,-0.41528692841529846,-0.6186157464981079,0.3559417128562927,0.398105651140213,-0.3371483087539673,0.1937573403120041,0.11102671921253204,-0.31675127148628235,0.07415074855089188,-0.5441771149635315,0.5185665488243103,-0.2903362512588501,0.04037178307771683},{-0.35780876874923706,-0.4013864994049072,0.41962090134620667,0.3489590585231781,-0.3085133135318756,0.33738601207733154,-0.1437617689371109,-0.2972600758075714,0.24706868827342987,-0.47613897919654846,-0.3622084856033325,-0.6352735757827759,-0.2045709639787674,-0.5247723460197449,-0.004962662234902382,-0.19305676221847534},{-0.37240931391716003,0.3241523206233978,-0.48387610912323,-0.022970497608184814,0.057470910251140594,0.33158183097839355,-0.2749539911746979,-0.3870702087879181,0.21610960364341736,0.2574613094329834,0.4205828011035919,-0.08662550896406174,-0.22797168791294098,0.303138792514801,0.16778811812400818,-0.5106852650642395}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.14778278768062592,-0.08876848965883255,-0.1674870401620865,-0.4028976261615753,0.4415546953678131,0.28565290570259094,0.08592454344034195,0.10170561075210571,-0.28891798853874207,-0.09697294235229492,-0.10870546102523804,-0.01781656965613365,0.24135416746139526,0.5337392091751099,0.15168045461177826,0.07122096419334412},{-0.18491040170192719,-0.28359147906303406,-0.0438368059694767,0.13450250029563904,0.2848680019378662,-0.29457440972328186,0.15981997549533844,0.06866651028394699,-0.09615389257669449,0.2521820664405823,-0.16438055038452148,0.3369060754776001,-0.36386993527412415,0.2234540730714798,-0.3680061995983124,-0.271747350692749},{0.1165766716003418,0.2701164782047272,-0.44691261649131775,-0.546880841255188,0.13066625595092773,0.47364509105682373,-0.11858604103326797,0.11405827105045319,-0.22565488517284393,-0.24765324592590332,-0.028653046116232872,0.3214769959449768,-0.36541080474853516,-0.3196044862270355,0.19053718447685242,-0.0881865993142128},{0.2025907039642334,-0.01632368192076683,0.07451123744249344,0.19181770086288452,-0.518044114112854,0.05041065067052841,0.025736963376402855,-0.272508442401886,0.3845079839229584,0.38951510190963745,-0.08152514696121216,-0.14654605090618134,-0.39347168803215027,-0.38076353073120117,0.20449233055114746,0.24113060534000397},{-0.1891767531633377,0.035210102796554565,0.06371558457612991,0.2657589316368103,-0.21859364211559296,0.016275882720947266,-0.060558587312698364,0.16670770943164825,0.23698560893535614,-0.35155001282691956,0.03207066282629967,0.40708327293395996,0.13292823731899261,-0.41046178340911865,-0.08830336481332779,-0.12580716609954834},{0.249540314078331,0.21919143199920654,-0.031308192759752274,0.17418192327022552,-0.3751925528049469,-0.4431864321231842,0.27534905076026917,0.31535711884498596,0.110417939722538,0.5005777478218079,0.23607824742794037,-0.28836265206336975,0.011789081618189812,-0.14729730784893036,-0.07417425513267517,0.31165027618408203},{-0.014283816330134869,0.16843253374099731,0.33291494846343994,-0.38849571347236633,-0.1698625087738037,0.07810316979885101,-0.30784347653388977,-0.07503598183393478,0.0862753838300705,0.11085715144872665,-0.16909728944301605,-0.2747136652469635,-0.3077223002910614,0.0709056481719017,0.227707639336586,0.05543162673711777},{-0.19652454555034637,-0.19853374361991882,-0.4231919050216675,0.281730592250824,-0.296606183052063,-0.31195613741874695,-0.21956032514572144,-0.3587563633918762,0.018611928448081017,-0.24795007705688477,-0.1342979371547699,0.1876714527606964,-0.22918057441711426,0.40787386894226074,-0.13144312798976898,-0.4049042761325836},{-0.2545352578163147,0.2907845377922058,0.003461341140791774,-0.01150949764996767,0.32087185978889465,-0.19520878791809082,0.40035656094551086,0.10864496976137161,0.29873061180114746,0.3893444538116455,0.31028929352760315,0.2961578071117401,0.2284497320652008,-0.05230966582894325,0.3228012025356293,0.13702800869941711},{0.13575328886508942,-0.2599210739135742,-0.0545789897441864,-0.1464259922504425,0.30369141697883606,-0.04995828866958618,-0.2736690640449524,-0.22789065539836884,0.07792394608259201,-0.46526429057121277,-0.21911410987377167,0.22249510884284973,0.12379016727209091,0.1681695282459259,-0.3297621011734009,0.258516788482666},{-0.20681656897068024,-0.4028381407260895,0.5014275312423706,0.28327786922454834,0.244314044713974,0.13632383942604065,0.1413990557193756,-0.17044015228748322,0.16058199107646942,-0.28494808077812195,0.0084866713732481,0.3718607425689697,0.3870127499103546,0.1364651769399643,-0.26323261857032776,-0.002297468250617385},{0.035478875041007996,-0.1886121928691864,0.32180917263031006,0.07125134021043777,-0.12148112803697586,-0.19612452387809753,0.44638529419898987,0.25945600867271423,-0.24816668033599854,-0.3788517415523529,-0.13278843462467194,-0.2868523597717285,-0.012421813793480396,-0.3099403977394104,-0.3830359876155853,-0.002412039553746581},{-0.07691013067960739,-0.33376917243003845,0.31537553668022156,-0.19125664234161377,0.3026585280895233,-0.32575443387031555,-0.4003986716270447,0.14779914915561676,0.13868865370750427,-0.05602383613586426,-0.31281328201293945,0.10063253343105316,0.055715106427669525,-0.3459891378879547,-0.4010778069496155,-0.01892770826816559},{0.31017357110977173,-0.3670753836631775,0.4948759078979492,0.1302279382944107,0.098601795732975,0.2916232645511627,-0.09014464914798737,-0.23646824061870575,-0.5574235916137695,0.08499403297901154,0.0049103014171123505,-0.44619542360305786,0.03331012278795242,0.2929594814777374,0.3230714201927185,0.06875964999198914},{-0.21707412600517273,0.15492329001426697,0.0994604229927063,-0.31859222054481506,-0.1835993528366089,0.1313173770904541,0.2273353636264801,-0.19814813137054443,0.19999413192272186,-0.3920309245586395,-0.016108451411128044,0.07193835824728012,-0.07013396918773651,0.09647996723651886,-0.03317733108997345,0.0012224256061017513},{-0.187376007437706,0.3488031029701233,-0.32581713795661926,0.3148816227912903,0.18807393312454224,-0.3933168947696686,-0.10326483100652695,-0.06393611431121826,-0.41618093848228455,0.284639835357666,-0.40167149901390076,0.3013916015625,-0.04882512241601944,-0.15757036209106445,-0.29638057947158813,-0.5219784379005432}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1893356442451477,0.017578981816768646,-0.09318046271800995,-0.022154761478304863,-0.10969378799200058,-0.020091937854886055,0.3093061149120331,0.010553643107414246,-0.10055617988109589,-0.1309998333454132,0.08266130089759827,-0.34464845061302185,-0.22462794184684753,0.23240572214126587,0.18728990852832794,0.2807803452014923,-0.285611093044281,-0.3171069025993347,-0.2654933035373688,0.036995649337768555,-0.02283947914838791,-0.36733683943748474,-0.21993927657604218,-0.2792356312274933,-0.2965412437915802,0.2531299591064453,-0.2852964997291565,-0.04804682731628418,-0.014861908741295338,-0.03833622485399246,0.1563033014535904,-0.16249234974384308},{0.20038916170597076,0.25165465474128723,0.0673653706908226,-0.08833100646734238,0.12552405893802643,-0.05937272310256958,0.3365703225135803,0.09419147670269012,-0.23542581498622894,-0.13404369354248047,-0.05604345723986626,-0.3261447250843048,-0.22299493849277496,0.2100973129272461,-0.20807397365570068,-0.30081063508987427,-0.032593339681625366,0.19420132040977478,-0.37158119678497314,-0.3332723379135132,-0.03392135724425316,0.3077729046344757,0.16480539739131927,-0.11290356516838074,0.15219391882419586,-0.24626187980175018,0.010771358385682106,0.1491888165473938,0.22873802483081818,-0.17842994630336761,-0.03938093036413193,0.2156783938407898},{0.26950371265411377,0.08234652131795883,-0.050175271928310394,0.21980859339237213,-0.2642078399658203,-0.1910984218120575,-0.3569982647895813,0.16976536810398102,-0.12397356331348419,0.3713890016078949,-0.23946982622146606,-0.1154341921210289,0.1528400480747223,-0.4435672163963318,-0.08725741505622864,0.05653318017721176,-0.17088879644870758,-0.21124418079853058,0.32421886920928955,-0.03329235687851906,0.3122207522392273,0.1763039529323578,-0.2535211741924286,-0.022282110527157784,-0.26785120368003845,-0.10253368318080902,0.1937887966632843,-0.13821525871753693,-0.02470525912940502,-0.09906216710805893,-0.10296372324228287,-0.029688237234950066},{0.36551132798194885,0.09233184158802032,0.08357711881399155,-0.1303960680961609,-0.30501657724380493,-0.09272370487451553,-0.19069966673851013,0.2798476219177246,0.24931465089321136,-0.22383250296115875,-0.07908773422241211,0.3333662748336792,0.07896511256694794,-0.18081024289131165,-0.19798368215560913,0.3062814176082611,-0.3386496305465698,0.19568221271038055,0.017794225364923477,0.10791926085948944,-0.02253114804625511,-0.11830306798219681,0.29796767234802246,0.1619713306427002,0.18386943638324738,-0.35689932107925415,0.3618852198123932,-0.2435133457183838,-0.02500651404261589,0.05893450975418091,-0.29133111238479614,0.18712782859802246},{-0.03318863734602928,-0.07474898546934128,-0.07363706082105637,0.0522928424179554,0.18738986551761627,-0.20344896614551544,-0.3725796639919281,-0.029794862493872643,-0.1179124191403389,-0.17132697999477386,0.12880416214466095,0.23766957223415375,-0.03900879994034767,-0.08267160505056381,-0.09513728320598602,0.19678276777267456,-0.08121661096811295,-0.04121176525950432,-0.34019315242767334,-0.08276902139186859,-0.14572148025035858,-0.3937099277973175,0.16263863444328308,0.23407845199108124,-0.07156188040971756,0.2981347143650055,-0.18538901209831238,0.17319831252098083,0.30859965085983276,0.3513627350330353,-0.04519212990999222,0.31210821866989136},{-0.27201664447784424,-0.06558872759342194,-0.20037657022476196,-0.03364510461688042,-0.18259687721729279,0.24351580440998077,0.20816023647785187,0.019120171666145325,0.29404890537261963,0.16971848905086517,0.33957746624946594,-0.24265457689762115,-0.20489363372325897,0.22458527982234955,0.3051951229572296,-0.37668144702911377,-0.11960362643003464,-0.23970328271389008,0.21659736335277557,0.0769718661904335,0.09190348535776138,0.14115531742572784,0.03816913068294525,-0.04782215878367424,-0.3733172118663788,0.36328595876693726,-0.20844179391860962,0.17813873291015625,0.385597825050354,0.20590826869010925,0.06372174620628357,0.08603247255086899},{0.17661508917808533,-0.11431368440389633,-0.15120798349380493,-0.3164028823375702,-0.03894178941845894,0.21143169701099396,0.25803908705711365,0.14631809294223785,0.09764349460601807,0.35591286420822144,-0.016667434945702553,0.00988405104726553,-0.4140067398548126,-0.17246341705322266,-0.14666502177715302,0.06573446840047836,-0.3117658197879791,-0.24431270360946655,0.17871937155723572,-0.09440860152244568,-0.0874071791768074,-0.16449293494224548,-0.19901271164417267,-0.26089122891426086,0.16969023644924164,-0.24428676068782806,-0.10066381841897964,-0.234686017036438,0.35224100947380066,0.111210897564888,-0.1943550705909729,-0.26890650391578674},{0.06465418636798859,0.1735057681798935,0.05666198208928108,-0.1513061225414276,0.1657954305410385,-0.2960953712463379,-0.030783874914050102,-0.1549181044101715,-0.0023927045986056328,-0.2710827887058258,-0.35444432497024536,-0.12398353964090347,-0.11117193102836609,0.06872629374265671,-0.17192673683166504,0.4398721158504486,0.018146855756640434,-0.11967350542545319,0.09535394608974457,0.3471165895462036,-0.20563894510269165,-0.17862240970134735,0.28758761286735535,0.10070526599884033,0.019394630566239357,-0.34733960032463074,-0.3469040095806122,-0.20952975749969482,-0.39735856652259827,-0.29188019037246704,0.09749839454889297,-0.41262108087539673},{0.017979897558689117,0.5388163328170776,-0.4346908926963806,-0.38674697279930115,-0.3316742777824402,0.22001861035823822,0.046605195850133896,0.16564616560935974,-0.07057496905326843,-0.31577691435813904,-0.058670125901699066,0.31058159470558167,-0.45841994881629944,-0.25297287106513977,0.27182823419570923,-0.22542504966259003,0.24840904772281647,0.17966391146183014,0.41947296261787415,0.028799310326576233,0.13721121847629547,0.2732589840888977,0.4154060482978821,-0.21544626355171204,0.4535859525203705,-0.22724702954292297,0.3211820423603058,0.47111478447914124,-0.14474917948246002,0.11061403155326843,0.07284235209226608,0.10691986232995987},{-0.2885776162147522,0.08796554803848267,-0.45016640424728394,-0.23812216520309448,0.11864093691110611,-0.2858184576034546,0.19044439494609833,-0.06200752407312393,0.21521277725696564,0.1692151129245758,-0.3463689386844635,-0.431352436542511,-0.47747573256492615,-0.11936277151107788,-0.31651440262794495,0.1441890448331833,-0.08179274946451187,-0.27006539702415466,0.09280435740947723,0.08223699778318405,0.07752016186714172,-0.002175389789044857,0.4309867322444916,-0.13512861728668213,0.3776930868625641,0.20446643233299255,-0.2755869925022125,0.008953338488936424,-0.008004016242921352,-0.08113360404968262,-0.29067718982696533,0.09649759531021118},{0.09384956955909729,0.02053598128259182,0.11626314371824265,-0.300141841173172,-0.2943134605884552,-0.24111633002758026,-0.24603943526744843,-0.030915670096874237,-0.18558412790298462,0.3937114179134369,0.12791220843791962,-0.2900451421737671,-0.3771542012691498,-0.06830020248889923,-0.23396533727645874,-0.11666502803564072,0.20552431046962738,-0.1450989991426468,0.25343042612075806,-0.19167384505271912,-0.1894071102142334,0.043097302317619324,0.22261662781238556,0.1966315060853958,0.21685385704040527,-0.14561323821544647,-0.03623645752668381,-0.06527974456548691,-0.05169631913304329,-0.029786285012960434,-0.08342882245779037,0.15255364775657654},{-0.19810457527637482,-0.035990264266729355,0.23596754670143127,0.26600930094718933,0.2699987590312958,0.01934664323925972,0.08132502436637878,-0.19180993735790253,-0.1264648139476776,-0.24244628846645355,0.3078271746635437,-0.22059571743011475,-0.2068677842617035,-0.18393227458000183,0.292608380317688,0.03368440642952919,0.00992356427013874,0.04875149205327034,0.3745686411857605,0.09274034202098846,-0.22284956276416779,0.27995651960372925,0.10690276324748993,-0.07115790247917175,0.24373625218868256,-0.14653347432613373,-0.11265789717435837,0.24696695804595947,0.18725360929965973,-0.009743227623403072,-0.2334737628698349,-0.2873592972755432},{0.2956356406211853,-0.258433073759079,-0.02370116114616394,-0.29721444845199585,0.04595835134387016,-0.17844919860363007,0.09190813452005386,0.11297894269227982,0.2917785942554474,0.1223621740937233,0.12410060316324234,0.2550569772720337,-0.3446218967437744,-0.3416549265384674,-0.06077619642019272,-0.23726040124893188,-0.22814607620239258,-0.29863232374191284,0.2884533703327179,-0.21114486455917358,0.37656497955322266,-0.10169342905282974,-0.019588278606534004,0.1886700689792633,0.13717947900295258,-0.12469066679477692,0.11825010925531387,0.025296855717897415,0.1574704796075821,-0.0385320670902729,-0.3018972873687744,-0.04272144287824631},{0.2199944406747818,-0.15857413411140442,-0.031336233019828796,0.4379722774028778,-0.06954791396856308,-0.2956539988517761,-0.031246822327375412,0.0353398360311985,0.29542168974876404,0.3970381021499634,0.03666182979941368,-0.17287874221801758,0.12215906381607056,0.24319009482860565,-0.150420680642128,0.045973680913448334,0.16359415650367737,-0.2766540050506592,-0.012427354231476784,-0.36116263270378113,0.3695130944252014,0.050086017698049545,-0.13275320827960968,0.24494685232639313,0.1595333367586136,0.17172330617904663,0.019288038834929466,-0.0481080561876297,0.07697117328643799,-0.1777857542037964,-0.10136308521032333,0.4057765603065491},{-0.022994408383965492,-0.269589900970459,-0.13083001971244812,0.127371147274971,-0.2526286542415619,-0.014087475836277008,0.07524102181196213,-0.30555087327957153,-0.13154032826423645,-0.0049059148877859116,0.1707676351070404,0.09014096111059189,0.06236957758665085,0.25495120882987976,-0.07387036830186844,-0.10804881155490875,-0.2332351952791214,0.2765723466873169,-0.1623869389295578,-0.31489360332489014,-0.1842499077320099,-0.07342647761106491,0.1962571144104004,0.010383115150034428,-0.05060311406850815,-0.01904667541384697,-0.24904575943946838,0.2296728491783142,0.08931434154510498,-0.22940702736377716,0.19473597407341003,0.19622473418712616},{0.11821045726537704,-0.1780816614627838,-0.15241043269634247,-0.17930199205875397,-0.1362009048461914,0.12624551355838776,0.038994818925857544,0.2455994188785553,-0.12873218953609467,0.07712478190660477,0.254659503698349,0.09058745950460434,-0.0803341493010521,-0.16812291741371155,0.031556885689496994,0.171869695186615,-0.47281646728515625,-0.2815590500831604,-0.06497295200824738,0.030408859252929688,0.12975363433361053,0.24889352917671204,0.32549840211868286,0.11883637309074402,0.058312639594078064,0.23718586564064026,0.02201618067920208,-0.07361747324466705,0.2121804803609848,-0.1709682196378708,-0.3281320333480835,0.37632063031196594},{0.16949030756950378,-0.028651099652051926,-0.26806607842445374,0.19095256924629211,0.09996561706066132,-0.050985291600227356,0.2655375599861145,0.09248880296945572,0.14747057855129242,-0.19061291217803955,0.21810473501682281,-0.1940774768590927,-0.3924615979194641,0.2571588158607483,0.060043178498744965,0.021776389330625534,0.04505745321512222,-0.07546015083789825,-0.16022314131259918,0.033829569816589355,-0.04157951846718788,0.16531305015087128,0.06540212035179138,-0.1427009552717209,-0.003617024514824152,-0.22302865982055664,0.011485069058835506,0.37149372696876526,0.27053073048591614,-0.144554004073143,0.19465087354183197,0.21665950119495392},{-0.0320671908557415,-0.0643354207277298,-0.05365103483200073,-0.056300535798072815,-0.22029045224189758,-0.035996176302433014,0.21370089054107666,0.2000851184129715,0.17125459015369415,-0.016577277332544327,0.20468786358833313,0.014894872903823853,0.23077014088630676,0.18106389045715332,0.15047289431095123,-0.07788790762424469,0.14468081295490265,0.19031378626823425,0.23413585126399994,0.0927850753068924,0.18156425654888153,0.23083707690238953,0.03764522075653076,0.17167647182941437,-0.0018661759095266461,-0.10749097168445587,-0.14045628905296326,-0.2523496448993683,0.1483408510684967,-0.22583748400211334,0.05001179501414299,-0.05566048622131348},{-0.3623621165752411,0.08270176500082016,-0.31017762422561646,-0.3042241930961609,-0.002397889969870448,0.08048924058675766,0.11459285020828247,-0.17216867208480835,-6.867134652566165e-05,0.2989504933357239,0.09214858710765839,-0.21350057423114777,0.03913651406764984,-0.14106589555740356,-0.2772587239742279,-0.08005338162183762,-0.16446635127067566,0.12755024433135986,-0.03128910809755325,-0.11173462867736816,-0.32092124223709106,0.17778989672660828,0.11921889334917068,-0.0073675126768648624,-0.07489635795354843,0.32860785722732544,0.025118239223957062,-0.13692621886730194,-0.14974641799926758,0.03229806199669838,-0.13552096486091614,-0.22632499039173126},{0.016368810087442398,-0.23173396289348602,-0.2256171852350235,-0.016708416864275932,-0.33397501707077026,-0.1706416755914688,0.16390343010425568,-0.29438045620918274,-0.18447457253932953,0.1835937350988388,0.13419769704341888,0.11689837276935577,0.14513695240020752,-0.09892787039279938,0.29411646723747253,-0.3029932379722595,0.07698187977075577,0.228718563914299,0.04512414708733559,0.2501758635044098,0.051560577005147934,-0.14140425622463226,-0.30261942744255066,0.2226732224225998,-0.14947541058063507,-0.17441758513450623,0.07852225005626678,0.0020546603482216597,-0.12409553676843643,-0.29690369963645935,-0.03502881899476051,-0.15503326058387756},{0.20105047523975372,0.2013886570930481,-0.07599799335002899,0.17758792638778687,-0.2944906949996948,0.2021327167749405,-0.07644563168287277,-0.15650533139705658,-0.22355437278747559,0.19862864911556244,-0.2248767614364624,-0.14612334966659546,-0.047634512186050415,-0.1820150911808014,-0.32765230536460876,-0.17541459202766418,-0.08660858124494553,-0.276910662651062,-0.20067904889583588,0.26304951310157776,0.10093554109334946,0.13269411027431488,-0.31826192140579224,0.2888893783092499,0.15012872219085693,0.26928654313087463,-0.26676586270332336,-0.024551400914788246,0.10201934725046158,-0.23965874314308167,0.14929068088531494,0.11939547210931778},{-0.003222649684175849,-0.3039902150630951,0.0013401353498920798,-0.3100787401199341,-0.04938540607690811,0.24899744987487793,0.19713161885738373,0.030855543911457062,-0.03595317527651787,0.017924705520272255,-0.2416466325521469,0.1291159689426422,0.14516331255435944,0.10653472691774368,0.11088953912258148,0.040677666664123535,-0.07852336019277573,0.13462747633457184,-0.12419211119413376,0.17966881394386292,0.20714378356933594,0.24287328124046326,-0.07547830045223236,-0.21449050307273865,0.1412900984287262,0.11741174757480621,0.24986986815929413,0.12474840879440308,-0.03328327462077141,0.14774180948734283,0.020578637719154358,-0.13053034245967865},{0.03873873129487038,-0.1811363250017166,0.24120165407657623,-0.020919358357787132,0.27843526005744934,-0.041997119784355164,-0.12146589905023575,-0.14670896530151367,0.13577811419963837,-0.05768318846821785,0.06871522963047028,0.013255572877824306,-0.2551595866680145,-0.0016218728851526976,-0.10681980848312378,-0.22872141003608704,-0.062330253422260284,-0.04486403614282608,0.22318895161151886,0.27689966559410095,0.02754135988652706,0.056419480592012405,0.19230125844478607,0.33528193831443787,-0.14194506406784058,-0.1051640585064888,0.22563773393630981,-0.09529139846563339,-0.22885511815547943,-0.24405217170715332,0.2857291102409363,-0.005377530120313168},{0.1997625082731247,-0.03172941505908966,0.05152258276939392,0.1375325620174408,-0.04029170051217079,0.07494332641363144,-0.2765352725982666,0.29790839552879333,-0.10656373202800751,-0.062141794711351395,0.1130596473813057,-0.2582551836967468,0.004735701251775026,-0.0462518148124218,-0.08305530250072479,0.28380876779556274,-0.06230969727039337,-0.19582869112491608,0.05411195755004883,-0.031624455004930496,-0.16582490503787994,0.21009817719459534,0.2319352626800537,0.20850902795791626,-0.2831283211708069,0.12831155955791473,-0.04789867252111435,0.08670378476381302,-0.272210955619812,0.2915652096271515,-0.012458656914532185,0.05378519743680954}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.250051349401474,-0.10182371735572815,0.20030996203422546,-0.24310143291950226},{0.21451641619205475,-0.35906168818473816,0.3235781192779541,0.3326595723628998},{-0.3644093871116638,0.09344562143087387,0.10786794871091843,-0.02657635696232319},{0.24980305135250092,0.594992995262146,0.38251426815986633,0.026115618646144867},{-0.30235734581947327,0.1334061175584793,-0.3555234968662262,0.0910135880112648},{-0.06071224436163902,-0.10799501091241837,0.12797866761684418,0.5679212212562561},{-0.08856023848056793,-0.11333498358726501,-0.47410520911216736,0.03388357162475586},{-0.1664104014635086,-0.30160319805145264,0.26432421803474426,-0.09660454094409943},{-0.08880770206451416,0.1477648764848709,-0.12331341207027435,-0.21901410818099976},{0.3064543604850769,0.09127984195947647,-0.10671708732843399,-0.2829842269420624},{0.18646104633808136,-0.09409572184085846,0.33265095949172974,0.2883220911026001},{-0.11179213970899582,-0.015654336661100388,0.5359802842140198,-0.11774788051843643},{-0.4648415744304657,0.3045875132083893,-0.0023071991745382547,-0.14467915892601013},{-0.20721417665481567,0.12699101865291595,-0.33246633410453796,0.11184415221214294},{0.14313684403896332,0.017087318003177643,0.3061783015727997,0.1462695598602295},{-0.1755114495754242,-0.3570307195186615,-0.15634094178676605,-0.16770313680171967},{-0.4376027286052704,0.035682085901498795,-0.12865345180034637,0.38306376338005066},{-0.3520362377166748,-0.16288360953330994,-0.23239432275295258,0.297031432390213},{-0.09447057545185089,-0.1996704787015915,0.491504043340683,0.05824809521436691},{-0.25358474254608154,-0.2302364557981491,0.05310449376702309,-0.20020553469657898},{0.20454953610897064,0.17084860801696777,0.2079814374446869,-0.2895861566066742},{-0.03299695625901222,-0.3687838017940521,-0.11992722004652023,0.42898455262184143},{0.48769545555114746,-0.3283239006996155,0.11323333531618118,0.1048036441206932},{-0.36615222692489624,-0.08530151098966599,-0.30824992060661316,-0.41027745604515076},{-0.15083104372024536,-0.3256489634513855,-0.12284449487924576,-0.10072752088308334},{0.22269386053085327,0.22606024146080017,-0.10891320556402206,0.10365043580532074},{0.13004323840141296,-0.24024789035320282,0.3872181475162506,0.08198712766170502},{-0.05933763086795807,-0.20180398225784302,-0.06406806409358978,0.3873837888240814},{0.19502712786197662,0.08185455203056335,0.06590556353330612,0.03406931832432747},{-0.1753106713294983,0.11477912217378616,0.31549111008644104,0.04890822246670723},{-0.2828276455402374,-0.08339066803455353,0.07112709432840347,0.32619038224220276},{0.3585700988769531,0.24749277532100677,0.27092280983924866,-0.062351785600185394}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09710706025362015,-0.13456527888774872,0.09251845628023148,0.09985136240720749,0.08696162700653076,-0.20288686454296112,0.09657043218612671,0.031303711235523224,-0.08425945788621902,-0.033086273819208145,-0.005683454684913158,-0.05497940257191658,-0.010267728939652443,0.10030779987573624,0.11970914155244827,-0.030036646872758865};
static const float actor_encoder_self_encoder_2_bias[16] = {0.021781399846076965,0.05232687294483185,0.05259803682565689,-0.055075228214263916,-0.044311076402664185,0.08787264674901962,-0.06991671770811081,-0.10404711961746216,0.03876776993274689,-0.02696593478322029,-0.02394663356244564,0.01538669504225254,-0.016523532569408417,-0.07941454648971558,0.052676837891340256,-0.08971665054559708};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.049456994980573654,-0.0024594543501734734,-0.06862623989582062,0.06872263550758362,0.0010514629539102316,0.019603928551077843,-0.0637664869427681,-0.05624604970216751,-0.011405304074287415,-0.02565295249223709,0.02815888077020645,0.023436786606907845,-0.008144097402691841,-0.020374158397316933,0.043319400399923325,-0.0926067903637886,-0.002889198251068592,-0.03121929056942463,0.02350669912993908,-0.07275236397981644,0.01897626370191574,-0.014985596761107445,0.017991624772548676,-0.07922803610563278,-0.08364207297563553,0.06770329177379608,0.03280717134475708,-0.010104038752615452,0.06027648225426674,0.020026862621307373,-0.009606150910258293,0.05894303694367409};
static const float action_parameterization_distribution_linear_bias[4] = {0.03388829156756401,0.06624087691307068,0.013226882554590702,0.04564623162150383};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.33888643980026245,-0.2449299693107605,-0.1385689228773117,0.2051079124212265,-0.14707434177398682,0.05795029550790787,-0.2701488435268402,-0.012720750644803047},{0.11286962032318115,0.15791866183280945,0.33138757944107056,0.34561872482299805,-0.12842325866222382,-0.3370961546897888,0.32090291380882263,0.2746877670288086},{0.03535526990890503,0.19611966609954834,0.06191467121243477,-0.06529594212770462,0.32726773619651794,0.20937450230121613,-0.02924700453877449,0.17912715673446655},{0.10007043927907944,-0.30459100008010864,0.2806580066680908,-0.2403847724199295,-0.2559182643890381,0.06437795609235764,0.2519608736038208,0.21775591373443604},{-0.23798073828220367,-0.022118473425507545,-0.06241022050380707,-0.36069175601005554,0.12086211889982224,0.07140829414129257,0.30498960614204407,0.26159361004829407},{-0.0586390420794487,0.26283854246139526,-0.03507660701870918,-0.295467734336853,0.2780211269855499,0.053545281291007996,0.04803267866373062,-0.19313573837280273},{0.025641584768891335,0.28842848539352417,0.17201249301433563,-0.19793252646923065,0.35828253626823425,-0.21055635809898376,0.16762009263038635,0.10054860264062881},{0.08784154802560806,-0.23602746427059174,-0.016377585008740425,-0.2504883408546448,0.27839866280555725,-0.12798984348773956,-0.15439870953559875,-0.2980484068393707},{-0.20218609273433685,0.29564711451530457,0.022834382951259613,-0.0730224996805191,0.01693846844136715,0.2788965404033661,0.40065792202949524,0.37550088763237},{0.05110740661621094,-0.02442452311515808,-0.27995166182518005,0.27487924695014954,0.29197749495506287,0.19765210151672363,0.25970178842544556,-0.24851860105991364},{-0.12559881806373596,-0.29591211676597595,0.3439393639564514,0.14471736550331116,0.0028795122634619474,-0.3438388407230377,-0.07208263874053955,-0.3229840397834778},{0.2932015061378479,0.09337141364812851,0.37852030992507935,0.3468850255012512,-0.1441754847764969,0.24590308964252472,0.12102200090885162,-0.36661460995674133},{-0.32753220200538635,0.1719505935907364,-0.35220867395401,0.377684623003006,-0.01521015539765358,0.33566218614578247,-0.00709333922713995,0.25295209884643555},{0.021168697625398636,0.21587912738323212,-0.1275266408920288,-0.16594652831554413,0.05695081502199173,0.048484452068805695,0.304355651140213,0.011679104529321194},{0.22530245780944824,-0.2865169048309326,-0.3122989237308502,-0.19204206764698029,0.2059464305639267,-0.24749727547168732,0.17059928178787231,-0.04940958321094513},{-0.37650176882743835,-0.35187476873397827,-0.2075049877166748,0.018817445263266563,0.08350598812103271,0.13130450248718262,0.25921618938446045,0.006826130673289299},{-0.15456819534301758,-0.2809997797012329,0.2109636813402176,-0.32475826144218445,0.10888539999723434,0.012977255508303642,-0.4098461866378784,-0.19006071984767914},{0.07078985124826431,0.21301011741161346,0.10245806723833084,0.17342771589756012,-0.04419078677892685,0.34194883704185486,0.29616859555244446,-0.15422703325748444},{0.03269386291503906,-0.34608954191207886,-0.12526515126228333,-0.06758151948451996,-0.09269549697637558,-0.3550555109977722,0.08387915790081024,-0.24291668832302094},{-0.0722295343875885,-0.027781499549746513,0.039855558425188065,-0.2946140170097351,0.08533255010843277,0.11178500205278397,0.16296124458312988,-0.05071942135691643},{0.07854956388473511,-0.09455354511737823,0.027160601690411568,-0.222957044839859,0.02528000995516777,-0.05512420833110809,0.09715563803911209,-0.15532848238945007},{-0.32032835483551025,0.15911033749580383,0.13430199027061462,-0.27080175280570984,-0.42067891359329224,-0.0297906082123518,0.2601122558116913,0.05891751870512962},{0.2713407576084137,0.05871576815843582,-0.400015264749527,0.03886841610074043,-0.023060709238052368,0.2218426913022995,0.3021622598171234,0.35315772891044617},{-0.01850851997733116,-0.20655176043510437,-0.0038929723668843508,0.19886945188045502,-0.28193771839141846,-0.03204994276165962,-0.11503993719816208,-0.28240683674812317},{0.1829492747783661,-0.041137952357530594,-0.4031332731246948,0.3367249667644501,-0.23723159730434418,-0.2363395392894745,-0.3520999550819397,0.188289612531662},{-0.012351359240710735,0.3023400902748108,-0.26784712076187134,-0.07754217833280563,0.15542730689048767,-0.16712653636932373,0.35631805658340454,-0.275367796421051},{-0.12296906858682632,0.05024775117635727,-0.1549549698829651,-0.1822042614221573,0.08838333934545517,-0.13140642642974854,-0.06746324896812439,-0.12866275012493134},{0.06592342257499695,-0.2068386822938919,-0.033935703337192535,-0.12756307423114777,0.06885744631290436,0.055250901728868484,-0.19099310040473938,0.0911640003323555},{0.26593470573425293,0.034151140600442886,-0.36399224400520325,-0.24795125424861908,-0.2032594084739685,0.13351769745349884,0.2278304547071457,0.080736443400383},{0.3079383969306946,-0.3523457646369934,0.0236945953220129,-0.08203434199094772,0.13928742706775665,-0.12539777159690857,0.18958480656147003,0.33413776755332947},{-0.3054644763469696,-0.24028359353542328,0.04091489687561989,-0.3475986123085022,0.3089417517185211,-0.2638949751853943,0.01337125152349472,0.08907265216112137},{0.15397141873836517,0.08521636575460434,-0.1340152621269226,0.2416340708732605,0.0217237938195467,-0.04434695094823837,-0.012616323307156563,0.006880409549921751}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2466745674610138,0.4357137680053711,-0.5436543226242065,-0.5183385014533997,-0.2043452262878418,-0.031659647822380066,-0.40906378626823425,0.5564270615577698},{-0.05264603719115257,0.5133518576622009,-0.27184680104255676,0.6050626039505005,-0.030940137803554535,0.018857881426811218,-0.3060554265975952,0.02656899392604828},{-0.3823278546333313,-0.21093234419822693,-0.12568864226341248,-0.11581360548734665,0.4575602114200592,0.2405472993850708,-0.06470566987991333,0.43672630190849304},{-0.4941064417362213,-0.5215091109275818,0.33218878507614136,0.3360578715801239,-0.4912090003490448,-0.21781514585018158,0.44021719694137573,0.22912417352199554},{-0.3143722712993622,-0.23166310787200928,-0.32065650820732117,-0.24986843764781952,0.33242377638816833,-0.24213814735412598,0.5215086340904236,-0.40071576833724976},{0.010883758775889874,0.21984653174877167,0.2218053638935089,-0.5475541949272156,0.5025107860565186,-0.26685431599617004,-0.49153217673301697,-0.39323192834854126},{-0.35202404856681824,0.17116619646549225,0.08718865364789963,-0.503508985042572,-0.03553569316864014,-0.5300061106681824,0.49593421816825867,0.032503556460142136},{-0.3969423174858093,-0.20271576941013336,-0.14026904106140137,-0.32889094948768616,-0.35495510697364807,0.15471000969409943,0.5757417678833008,-0.3079055845737457}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.007684074807912111,-0.11235572397708893,-0.1292216181755066,0.01247280091047287,0.10051921010017395,0.028157278895378113,0.072733573615551,0.07363956421613693};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.04877866059541702,-0.05589776113629341,-0.038385942578315735,-0.10394488275051117,-0.09194687008857727,-0.0797286182641983,-0.01982215791940689,-0.14112116396427155};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

