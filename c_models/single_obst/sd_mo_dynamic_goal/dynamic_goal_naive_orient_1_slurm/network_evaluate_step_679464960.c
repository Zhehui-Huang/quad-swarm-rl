#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2618856430053711,0.020847586914896965,-0.14198848605155945,0.2825947105884552,0.29279205203056335,-0.21073473989963531,-0.22186249494552612,0.11542791873216629,0.2656344771385193,-0.3094283640384674,0.6077361106872559,-0.011393350549042225,0.29523566365242004,0.10741519182920456,-0.43126070499420166,0.0517265647649765},{-0.23852896690368652,-0.2916466295719147,-0.3061657249927521,-0.1850849986076355,0.06923796236515045,0.2557179927825928,0.06496947258710861,0.058081600815057755,0.23405443131923676,0.18700997531414032,-0.1644376665353775,-0.08485563099384308,-0.17613309621810913,0.07559013366699219,0.31812071800231934,-0.3047140836715698},{0.12803171575069427,0.20144078135490417,0.18744733929634094,0.3424924910068512,-0.10301530361175537,-0.23777173459529877,0.4823397994041443,-0.051498934626579285,-0.01354696974158287,-0.12628157436847687,-0.02951028384268284,-0.0168816726654768,0.05534330755472183,0.465806782245636,-0.26935335993766785,-0.04307608678936958},{0.10854470729827881,-0.14708667993545532,-0.14537228643894196,-0.11329808086156845,0.04658075422048569,0.09665632247924805,0.07352899760007858,-0.20369963347911835,-0.16166390478610992,0.16967464983463287,0.5136415958404541,-0.2088254988193512,-0.16188906133174896,-0.15004877746105194,0.17154166102409363,0.12464319169521332},{-0.3345578908920288,0.05031304433941841,0.12634219229221344,-0.2229021042585373,0.25784438848495483,0.2873057723045349,0.15977567434310913,-0.1994686722755432,-0.1253037303686142,0.16324222087860107,-0.16072484850883484,-0.36960306763648987,-0.02636175975203514,-0.14111921191215515,0.3129286766052246,-0.045797593891620636},{-0.017553770914673805,-0.02178620919585228,-0.022963974624872208,-0.00988490879535675,0.11627952009439468,-0.07505783438682556,0.39447328448295593,-0.34714311361312866,-0.13671369850635529,-0.1365268975496292,0.2876088619232178,0.0287675391882658,0.21364936232566833,0.09193051606416702,0.2581084966659546,0.29410699009895325},{-0.17660456895828247,0.16683290898799896,-0.03846295550465584,0.10071559995412827,-0.2133333683013916,-0.10631904006004333,-0.164032980799675,-0.023684505373239517,0.14803780615329742,0.3538501560688019,-0.20033548772335052,-0.08895793557167053,0.21310760080814362,0.06523986905813217,-0.18294738233089447,0.2929776906967163},{-0.11017590761184692,-0.003482612781226635,-0.16271069645881653,-0.21313463151454926,0.36525046825408936,-0.3001033365726471,-0.30145472288131714,-0.4301358759403229,-0.06822828948497772,-0.25150471925735474,0.39521223306655884,-0.018795689567923546,0.20906348526477814,0.14256198704242706,-0.179198756814003,0.42911016941070557},{0.2410077154636383,0.06447529047727585,-0.019277971237897873,0.10884541273117065,-0.395694762468338,-0.4181572198867798,0.34594228863716125,-0.2919777035713196,-0.13193750381469727,0.23630376160144806,0.18545684218406677,-0.301088809967041,-0.15221136808395386,0.03407968208193779,0.1963403970003128,-0.023648831993341446},{0.4537299573421478,-0.5086963176727295,-0.08523213118314743,-0.007190135307610035,0.24512669444084167,-0.10704760253429413,-0.2506885826587677,-0.12374170869588852,-0.18854455649852753,0.019549377262592316,-0.017068838700652122,-0.21050696074962616,0.36023327708244324,-0.08332738280296326,-0.531911313533783,-0.14422523975372314},{0.2802506983280182,0.17366889119148254,-0.33237379789352417,0.08705013245344162,0.0030162606853991747,-0.17905214428901672,-0.12578493356704712,0.1430872678756714,-0.1404000222682953,0.14447590708732605,0.1918071210384369,0.22188153862953186,-0.10551027953624725,0.23071980476379395,-0.033618293702602386,-0.26394200325012207},{-0.4495178163051605,0.2854055166244507,0.22957652807235718,-0.28878381848335266,-0.2682328224182129,0.32236242294311523,0.053087640553712845,0.3297851085662842,0.21803776919841766,0.12698081135749817,0.22167956829071045,-0.11237773299217224,0.16644667088985443,-0.07112690061330795,-0.08932328224182129,-0.15024058520793915},{0.0820392519235611,-0.2393956333398819,-0.21923819184303284,0.1733444333076477,-0.2252994179725647,-0.26107558608055115,-0.12708109617233276,0.22399072349071503,0.30408862233161926,-0.1577741652727127,-0.06580810993909836,0.0314810685813427,0.2646692097187042,0.14802877604961395,-0.18337498605251312,0.29843980073928833},{0.2647422254085541,0.19613195955753326,-0.13949759304523468,-0.11701422184705734,0.07183360308408737,-0.09326718002557755,-0.12203195691108704,0.2838849723339081,-0.22634711861610413,-0.168908953666687,-0.13749518990516663,0.03898003697395325,-0.22288618981838226,-0.10147243738174438,-0.2306206375360489,-0.023648710921406746},{0.18521836400032043,0.3930940628051758,0.38723549246788025,-0.36735621094703674,-0.37873512506484985,0.12730009853839874,0.02405708096921444,-0.15530574321746826,0.3912297189235687,0.3962060511112213,-0.16214872896671295,0.09904102981090546,-0.07729358226060867,-0.317496120929718,0.05792659893631935,-0.1164577528834343},{-0.2012001872062683,-0.1637541651725769,-0.12390418350696564,0.42211559414863586,-0.22946448624134064,-0.18780606985092163,-0.2238997370004654,-0.29303252696990967,-0.5161116719245911,-0.24210111796855927,0.330276757478714,0.2816876471042633,-0.58899986743927,-0.34086868166923523,-0.6242877840995789,-0.15693612396717072},{-0.4518393576145172,0.176384836435318,-0.34109070897102356,-0.1545211374759674,-0.45435631275177,0.180938258767128,0.5005714297294617,0.08855094760656357,0.41001254320144653,-0.47312647104263306,0.2350173145532608,-0.35209065675735474,-0.2185380905866623,0.038535505533218384,-0.19088609516620636,-0.21931308507919312},{0.35975849628448486,-0.5918421745300293,0.2983117699623108,0.23187324404716492,-0.07895881682634354,0.4852815270423889,0.24592481553554535,0.2939486503601074,-0.058956582099199295,-0.2457052767276764,-0.12465415894985199,-0.14182858169078827,-0.11006427556276321,-0.5447937846183777,0.2552872896194458,-0.09077589958906174}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.0380563959479332,0.3065652549266815,0.21642057597637177,-0.1437365561723709,-0.17323501408100128,0.046944666653871536,-0.011697893962264061,0.2479567527770996,-0.09008672088384628,0.3149774670600891,0.4681376516819,-0.3822983503341675,0.039085447788238525,0.04978872090578079,-0.00649067061021924,-0.10175775736570358},{-0.3923836648464203,0.19011418521404266,-0.16513782739639282,0.32758039236068726,0.26792198419570923,-0.12019385397434235,-0.3155061602592468,-0.15249377489089966,0.361568808555603,0.26320019364356995,-0.07080744206905365,0.23201024532318115,-0.4013955295085907,0.1772220879793167,-0.2104581594467163,0.4390050768852234},{-0.2703517973423004,0.11256565153598785,-0.2712407112121582,0.16148576140403748,-0.4575490951538086,-0.20372334122657776,0.02755516767501831,0.13385704159736633,-0.17712871730327606,0.36967888474464417,0.21986664831638336,-0.12273085117340088,0.14248335361480713,-0.25681883096694946,-0.1006353572010994,-0.042842041701078415},{0.2675095200538635,-0.2131294161081314,0.0957677885890007,0.3955777883529663,-0.4159042239189148,-0.30272790789604187,0.2723456919193268,0.03865344822406769,0.29186704754829407,-0.08640191704034805,0.33400219678878784,0.08522845804691315,-0.2025986611843109,0.022611986845731735,-0.007970991544425488,-0.41678574681282043},{-0.40323886275291443,-0.07314279675483704,0.14649280905723572,-0.2661325931549072,0.14876332879066467,0.36882513761520386,-0.30427271127700806,0.2786336839199066,-0.20865067839622498,0.19747941195964813,-0.0031587386038154364,0.04445283114910126,-0.273464173078537,-0.016269732266664505,-0.2748563289642334,-0.11309961974620819},{0.06331679224967957,-0.3025921881198883,-0.009162249974906445,-0.3371069133281708,0.2157067358493805,0.031418804079294205,-0.1422739326953888,-0.06263639777898788,-0.14786171913146973,0.3784859776496887,0.1873243898153305,0.008460995741188526,-0.29943332076072693,0.0870983675122261,0.01217018160969019,-0.2981276214122772},{0.26840656995773315,-0.21706847846508026,0.33527514338493347,-0.20680056512355804,-0.42404043674468994,0.012042427435517311,-0.3570728302001953,0.3407040238380432,-0.09847047179937363,-0.2490561157464981,-0.2650375962257385,-0.013765626586973667,-0.08008167147636414,-0.08406785875558853,0.5021311044692993,-0.3858666718006134},{-0.33988696336746216,0.35250547528266907,-0.09924273192882538,0.19156818091869354,-0.10578469187021255,-0.22563815116882324,-0.23525813221931458,0.08875761181116104,-0.03439740836620331,0.47744685411453247,0.1160736009478569,-0.12493587285280228,0.061817098408937454,-0.22919344902038574,0.08513621985912323,0.15474022924900055},{0.11563479155302048,0.27197784185409546,-0.20134377479553223,-0.3057726323604584,0.317385733127594,-0.19833305478096008,0.18304283916950226,-0.27749916911125183,0.03687511011958122,0.029133334755897522,0.11105362325906754,0.0982578918337822,0.02512213960289955,-0.3738276958465576,-0.06818240135908127,0.206815704703331},{-0.20347680151462555,0.02044754847884178,-0.27684926986694336,-0.3258168399333954,0.21664448082447052,-0.3821306526660919,-0.10065436363220215,0.30164965987205505,-0.17690259218215942,0.1370091736316681,-0.048835210502147675,-0.11084651201963425,-0.37358126044273376,0.1152399331331253,-0.22883036732673645,-0.32912445068359375},{-0.14029139280319214,-0.16295118629932404,0.003947696648538113,-0.24507005512714386,-0.3163321018218994,-0.0034123368095606565,0.13300971686840057,-0.3342667818069458,0.044769737869501114,-0.08186979591846466,0.28449761867523193,-0.06287040561437607,0.25061899423599243,0.16338416934013367,0.2245694100856781,0.2594781517982483},{-0.11248879134654999,-0.0172202680259943,-0.34319359064102173,0.3089834153652191,0.0879516527056694,0.15592637658119202,0.20255497097969055,0.1628444492816925,-0.42084142565727234,0.19545042514801025,-0.3254368007183075,-0.22952422499656677,-0.33311548829078674,0.3520445227622986,-0.3272993266582489,0.09038910269737244},{-0.1998067945241928,-0.4603474736213684,-0.09630727767944336,0.15195177495479584,-0.2239515483379364,-0.03597625344991684,-0.10147576779127121,0.38704097270965576,0.4583812355995178,0.13448448479175568,0.007223772816359997,-0.17956753075122833,0.1585628241300583,-0.39624738693237305,0.08710643649101257,-0.16894978284835815},{-0.2580299973487854,-0.4578321874141693,-0.12869234383106232,-0.14003710448741913,-0.49368342757225037,0.4926316440105438,-0.14990921318531036,0.19537954032421112,-0.13689789175987244,-0.24246574938297272,-0.3059491813182831,0.4009695053100586,-0.13846923410892487,-0.05393311381340027,-0.21188248693943024,0.32810178399086},{-0.31277695298194885,0.3497447967529297,-0.22895868122577667,0.13316215574741364,-0.35780754685401917,0.14813533425331116,-0.0037121439818292856,-0.3288755416870117,0.11406752467155457,0.21187178790569305,-0.2523336112499237,0.06267458200454712,0.23990194499492645,-0.31807446479797363,-0.3375028073787689,-0.18042752146720886},{-0.11748240143060684,-0.2694711983203888,-0.4261436462402344,0.2389451116323471,0.14082904160022736,0.05350760743021965,-0.2307203859090805,0.1748586893081665,-0.34425145387649536,-0.24110765755176544,-0.29619377851486206,0.1965254694223404,-0.19068588316440582,0.13697262108325958,0.03974417224526405,0.2904573678970337}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10330944508314133,-0.04654904454946518,0.19143514335155487,-0.13541088998317719,-0.07483801245689392,0.10989830642938614,0.22579509019851685,-0.18752184510231018,-0.2249184548854828,0.2731482982635498,0.13972754776477814,0.11361630260944366,0.07370179891586304,0.17053009569644928,-0.14908982813358307,0.1701105386018753,0.1292857527732849,-0.33575400710105896,-0.1541406810283661,-0.07661020755767822,-0.12996099889278412,0.07259518653154373,-0.18450826406478882,0.2701437771320343,-0.10540059208869934,-0.06550814211368561,0.10909157991409302,0.20715530216693878,-0.20985856652259827,-0.1252308040857315,0.1752498894929886,0.26824188232421875},{0.22371266782283783,-0.06331771612167358,0.13061442971229553,-0.11681091785430908,-0.13199584186077118,0.23805473744869232,-0.009450789541006088,-0.06999349594116211,-0.044832345098257065,0.012515892274677753,-0.13480393588542938,0.014333114959299564,0.39460206031799316,0.18066899478435516,0.12486933171749115,0.06806732714176178,-0.23437371850013733,-0.3553106486797333,0.07269421219825745,0.039903800934553146,0.06489674001932144,0.2910953462123871,0.20889493823051453,-0.24501430988311768,0.042184703052043915,0.2626139223575592,-0.28043535351753235,0.1853266954421997,0.10300701856613159,-0.23410676419734955,-0.04926125705242157,-0.01631323993206024},{-0.09641437977552414,-0.05484767630696297,0.2866838574409485,-0.2296552062034607,-0.16256600618362427,0.05421608313918114,-0.125497505068779,0.258364200592041,0.10579211264848709,-0.0018901212606579065,-0.165133997797966,-0.020144188776612282,0.23550023138523102,-0.2240501195192337,0.09944621473550797,-0.02954768016934395,-0.30913588404655457,0.27162858843803406,-0.23227129876613617,-0.047377195209264755,0.012480017729103565,-0.14458900690078735,-0.042453669011592865,-0.10104867070913315,-0.028629383072257042,0.27886003255844116,-0.06950212270021439,0.1007893830537796,0.25986477732658386,-0.23817329108715057,-0.20948804914951324,-0.0418107733130455},{0.14278191328048706,-0.12328266352415085,0.06264015287160873,-0.3367633521556854,0.12344890832901001,-0.15419097244739532,-0.07120707631111145,0.278759628534317,0.021157648414373398,0.13362254202365875,0.1490638107061386,-0.09182421863079071,-0.20348574221134186,-0.09693153947591782,0.29846838116645813,-0.23553811013698578,0.031541451811790466,-0.13445085287094116,-0.13113564252853394,0.0829794630408287,-0.10209549963474274,0.04185771197080612,-0.21024584770202637,0.2258656620979309,-0.26365798711776733,0.10029439628124237,-0.08496763557195663,-0.18152326345443726,0.08296111971139908,0.0007359112496487796,0.2490188479423523,-0.10961601138114929},{0.20918074250221252,0.00674138218164444,0.03946094959974289,0.24192455410957336,-0.24744851887226105,-0.07925025373697281,0.21079394221305847,-0.050779689103364944,0.10676799714565277,-0.1882440149784088,0.0056650335900485516,-0.08890174329280853,-0.15341618657112122,-0.15895803272724152,0.27190101146698,0.3065398335456848,-0.06551111489534378,-0.3398903012275696,0.16938138008117676,-0.11317369341850281,-0.11574731767177582,0.20584958791732788,0.27047011256217957,0.052073054015636444,-0.059638652950525284,-0.09712618589401245,-0.017179343849420547,0.26320400834083557,0.25388646125793457,0.13444963097572327,0.07309197634458542,-0.25577226281166077},{0.32314610481262207,-0.139848992228508,0.01337200216948986,0.10333879292011261,-0.13746587932109833,-0.32964465022087097,-0.2153889238834381,-0.3069838285446167,-0.20710919797420502,0.02349049225449562,-0.04527442529797554,-0.008429326117038727,-0.1578119546175003,-0.06142139434814453,-0.21313486993312836,-0.21745866537094116,0.1688816398382187,-0.01842423900961876,-0.301730751991272,0.1433020383119583,-0.051031917333602905,-0.22632752358913422,0.1804652065038681,-0.17805270850658417,-0.1371147632598877,-0.22389982640743256,-0.09713522344827652,0.1578517109155655,0.11275878548622131,0.2578395903110504,-0.22362805902957916,0.1949569284915924},{0.15850262343883514,0.08099495619535446,0.25601768493652344,-0.17899112403392792,0.22526246309280396,-0.21608777344226837,-0.2433008849620819,0.05240830406546593,0.28288254141807556,0.11602078378200531,-0.10413655638694763,0.09961897879838943,0.059080157428979874,0.3664953410625458,0.11683879047632217,-0.1149827316403389,-0.1851520538330078,0.1462951898574829,0.00710332952439785,0.022627592086791992,-0.05920260399580002,0.21682573854923248,0.15922915935516357,0.16305632889270782,-0.20486630499362946,-0.246975839138031,-0.2547008991241455,-0.3746674656867981,0.0405108816921711,-0.11129460483789444,0.22887538373470306,0.1616317331790924},{0.2840988337993622,-0.30321329832077026,0.11725538969039917,-0.3627830147743225,-0.3437543511390686,0.24700884521007538,0.3668297231197357,0.1356215626001358,-0.09948013722896576,-0.00317348912358284,0.22819784283638,-0.12698766589164734,0.14320747554302216,0.32556888461112976,-0.02954007498919964,0.18005791306495667,0.3712875247001648,-0.18616034090518951,-0.046014875173568726,-0.30293989181518555,0.1524980366230011,0.2044707089662552,0.23517467081546783,0.11293968558311462,0.11265943944454193,0.11583524942398071,0.12619584798812866,0.26423099637031555,-0.20370981097221375,-0.24588648974895477,0.24800795316696167,-0.04956723004579544},{0.019853299483656883,-0.08354077488183975,0.2726556658744812,0.21494893729686737,-0.16803912818431854,-0.28711068630218506,-0.05235406756401062,0.2792523503303528,-0.19286151230335236,-0.2619011700153351,0.08116208761930466,0.08998469263315201,0.12106107175350189,-0.2733525335788727,0.12799958884716034,-0.18584635853767395,-0.1587076187133789,0.1872130036354065,-0.22850196063518524,0.3413860499858856,-0.2986714839935303,-0.31376004219055176,-0.2759193778038025,0.3041137456893921,0.11095622181892395,0.0964173972606659,0.24176862835884094,0.16603907942771912,-0.16691552102565765,-0.26087746024131775,-0.17135834693908691,0.157206729054451},{0.2948300242424011,-0.022558169439435005,-0.04533081129193306,0.16564755141735077,0.0028262832202017307,0.22995655238628387,-0.03352461755275726,0.25628307461738586,-0.008958685211837292,0.07520969957113266,0.17031367123126984,0.06102467700839043,-0.15348000824451447,-0.36423566937446594,0.10740917176008224,0.13331633806228638,0.09498880058526993,-0.13274052739143372,-0.07660757005214691,-0.039307400584220886,0.1171095073223114,-0.29207876324653625,0.24665066599845886,0.06655577570199966,-0.020763758569955826,0.1285097599029541,-0.2868691682815552,-0.23013071715831757,-0.032117679715156555,-0.008745643310248852,0.13170042634010315,0.19679966568946838},{-0.12633799016475677,0.09577450901269913,-0.09904495626688004,0.16057176887989044,-0.11762741953134537,0.2747267186641693,0.1274108737707138,-0.011518167331814766,0.2792245149612427,-0.3097756505012512,-0.13983552157878876,0.15526269376277924,-0.1762201488018036,0.04834139347076416,-0.30202120542526245,-0.036129072308540344,0.11068868637084961,0.1671110838651657,0.08043405413627625,-0.13149528205394745,-0.21904975175857544,0.20134519040584564,0.19225206971168518,0.18876393139362335,-0.2623310685157776,0.3576487600803375,-0.10217002779245377,-0.024625275284051895,-0.11115103214979172,0.13542957603931427,0.20989756286144257,0.27626141905784607},{-0.19357812404632568,0.31102269887924194,-0.0642196536064148,0.006056028418242931,-0.18708108365535736,-0.1674269735813141,0.12960544228553772,-0.3182387948036194,-0.04060754179954529,-0.25604259967803955,-0.2124910205602646,-0.036202628165483475,0.18869663774967194,-0.25946879386901855,-0.1244230791926384,-0.27536192536354065,-0.19852879643440247,-0.0639592632651329,0.29935523867607117,-0.2976808249950409,0.08717847615480423,-0.19205714762210846,0.06175326928496361,0.29646530747413635,-0.1625698208808899,0.18326783180236816,0.22664238512516022,-0.08265968412160873,-0.020757552236318588,0.3035363554954529,-0.1345079094171524,-0.26272907853126526},{-0.045695021748542786,0.17696388065814972,0.21773821115493774,-0.27554988861083984,0.2660474479198456,0.011828921735286713,-0.12760205566883087,-0.027570350095629692,0.15939496457576752,-0.2855236828327179,-0.07390091568231583,0.024294251576066017,0.15449047088623047,0.045123472809791565,0.040068723261356354,-0.09457728266716003,0.23698747158050537,-0.24384672939777374,0.3281669318675995,0.09246956557035446,-0.16768088936805725,0.23925964534282684,-0.1326468288898468,-0.1957566738128662,0.26978886127471924,-0.11732561141252518,0.030047178268432617,-0.16345790028572083,0.04694148525595665,-0.141748309135437,0.26592588424682617,0.22994489967823029},{0.057584550231695175,-0.16146419942378998,-0.18301977217197418,0.06199762225151062,0.00635362695902586,0.28173625469207764,-0.10728546231985092,-0.2793755829334259,0.2898821532726288,0.019432397559285164,0.0510735958814621,0.08533662557601929,-0.14789007604122162,0.11783275008201599,-0.20923565328121185,-0.28911858797073364,0.011033793911337852,-0.039126936346292496,0.19333210587501526,0.38499346375465393,-0.21223488450050354,0.09760145097970963,-0.1318437159061432,0.01114258635789156,0.13197170197963715,-0.30164051055908203,-0.16184771060943604,-0.2311968356370926,-0.07956738770008087,-0.19252914190292358,0.1677539050579071,-0.32986214756965637},{-0.09613961726427078,0.30611318349838257,0.14282488822937012,-0.2090093344449997,-0.09737716615200043,-0.18722814321517944,0.17937439680099487,-0.04138626530766487,0.21937954425811768,-0.03332798555493355,0.2008036971092224,0.1633111834526062,-0.04499754309654236,0.04706405848264694,-0.12881216406822205,0.16078956425189972,-0.17614413797855377,-0.3585209250450134,-0.23774632811546326,0.11673478037118912,0.14653074741363525,-0.215378075838089,-0.32036954164505005,-0.23051483929157257,-0.16068562865257263,0.07329151779413223,0.34013089537620544,-0.011300686746835709,-0.07562287151813507,0.11105266213417053,-0.14327630400657654,0.09797968715429306},{-0.2128535360097885,-0.17816485464572906,-0.19633032381534576,0.011785176582634449,-0.2210375964641571,-0.11317115277051926,-0.038974225521087646,-0.029042722657322884,-0.3018571436405182,-0.23663339018821716,0.19233262538909912,0.14168493449687958,-0.3029128909111023,0.23458905518054962,-0.058385446667671204,0.15874458849430084,0.09715073555707932,0.024322865530848503,0.045300573110580444,0.13724027574062347,0.23253440856933594,0.2563929259777069,0.13634264469146729,0.2633499503135681,0.09967603534460068,-0.220358207821846,-0.18725892901420593,0.24842369556427002,-0.014991550706326962,-0.18068088591098785,-0.16665683686733246,-0.12322603166103363},{-0.2898281514644623,-0.22399742901325226,-0.3361557424068451,0.04695677012205124,-0.10130283981561661,-0.05871167778968811,-0.07973269373178482,0.14983175694942474,-0.08877675980329514,0.08578269183635712,-0.1959751546382904,-0.006455543451011181,0.14091642200946808,-0.11568597704172134,0.03188437595963478,0.18334843218326569,-0.08912065625190735,-0.11090999841690063,0.1709926873445511,0.02903369627892971,0.2177228331565857,-0.04559667035937309,-0.22518117725849152,0.06406385451555252,0.18777665495872498,-0.2557530403137207,0.17792139947414398,0.05001535639166832,0.07849830389022827,-0.12893599271774292,0.21009668707847595,-0.05721936747431755},{0.26052483916282654,0.012215730734169483,0.033105429261922836,0.19895240664482117,-0.34465235471725464,-0.04903542250394821,0.054660845547914505,0.15237486362457275,-0.06694623827934265,-0.14221954345703125,0.29275500774383545,-0.08553934842348099,0.08103092759847641,-0.047463588416576385,-0.10938955843448639,0.2873890995979309,-0.07844822108745575,-0.13982853293418884,0.10352800041437149,-0.2939333915710449,-0.055997882038354874,-0.25580254197120667,-0.18996647000312805,0.2261458784341812,-0.06943333148956299,-0.03911623731255531,0.13265232741832733,0.0593571700155735,-0.15640297532081604,-0.07881350815296173,-0.026258541271090508,-0.07957595586776733},{0.29611867666244507,-0.06989515572786331,0.06518315523862839,0.04867604002356529,-0.022494236007332802,-0.07387351989746094,0.2013431340456009,-0.22163252532482147,0.25150302052497864,0.294331431388855,0.039290349930524826,0.13202999532222748,0.21426217257976532,0.31259921193122864,-0.29564526677131653,-0.3625839054584503,-0.22879710793495178,0.08152502775192261,-0.16888149082660675,-0.3401626646518707,-0.1485482007265091,0.2343922257423401,0.05585488677024841,0.14855322241783142,-0.15398260951042175,-0.12284010648727417,-0.12282957881689072,-0.23816345632076263,0.25153887271881104,0.1976841539144516,-0.3342619240283966,-0.1281505525112152},{-0.09893526136875153,0.1679031103849411,0.2861531674861908,-0.022363973781466484,-0.0207841694355011,0.08769048005342484,-0.026857025921344757,-0.33032476902008057,0.1722504198551178,0.2484208345413208,0.16762113571166992,0.22624920308589935,-0.23938916623592377,0.16886122524738312,-0.241389200091362,0.3108986020088196,0.151792973279953,-0.2655518352985382,0.261106014251709,0.06574226170778275,-0.3455227017402649,0.29786890745162964,-0.23220428824424744,0.15286315977573395,0.1856813132762909,0.26016610860824585,0.04491279274225235,0.1408369392156601,-0.16196085512638092,0.24593281745910645,-0.04749000445008278,0.10031330585479736},{-0.12644802033901215,-0.09838904440402985,0.030606703832745552,0.18938660621643066,0.02948199212551117,0.2335682511329651,-0.2581258714199066,-0.10676881670951843,-0.17730765044689178,-0.08435176312923431,-0.11963289231061935,-0.1934126317501068,0.00043806160101667047,-0.215076744556427,0.10601925849914551,-0.19887080788612366,0.23831042647361755,-0.024402519688010216,-0.27902358770370483,-0.30160295963287354,0.13748371601104736,0.13858574628829956,-0.1482226699590683,0.3264008164405823,-0.27049720287323,0.036822766065597534,0.09260045737028122,-0.09678439050912857,0.16640372574329376,-0.191556915640831,0.28485146164894104,0.12034332752227783},{0.3045004606246948,0.05843926593661308,0.0495733842253685,0.2257070243358612,-0.24000993371009827,0.1627826988697052,-0.0905412882566452,0.14602933824062347,0.11443666368722916,0.0201247651129961,0.10195723921060562,-0.3048993647098541,-0.26143544912338257,0.05185142531991005,0.07322598993778229,-0.08496350795030594,0.27147963643074036,0.143000990152359,-0.19117163121700287,-0.21714098751544952,0.3440149426460266,0.19318924844264984,0.23305560648441315,0.0803317278623581,0.002959343371912837,0.0676264688372612,-0.05089171230792999,-0.16479109227657318,0.25143423676490784,0.008969174697995186,-0.17574542760849,0.11004123091697693},{-0.015854863449931145,0.02041110210120678,-0.030411381274461746,-0.25742605328559875,-0.09468545019626617,-0.23146118223667145,-0.21257424354553223,-0.13889174163341522,-0.03469091281294823,-0.018405649811029434,-0.24324819445610046,0.022720597684383392,-0.23655907809734344,-0.1645278036594391,0.01174409780651331,0.09562718123197556,0.2630957067012787,-0.17514094710350037,-0.3264033794403076,0.24863174557685852,-0.1757996380329132,0.25219133496284485,0.036527715623378754,-0.0344429612159729,-0.001138151390478015,0.16701647639274597,-0.07661280781030655,-0.2606438994407654,0.22112977504730225,0.2559061348438263,-0.13239705562591553,0.18212850391864777},{-0.2425880879163742,-0.02829582802951336,0.039736855775117874,-0.033808641135692596,0.09276571124792099,0.12828122079372406,-0.18988953530788422,0.10142193734645844,-0.1575261652469635,-0.14064782857894897,0.06841345876455307,-0.13962803781032562,-0.18540546298027039,0.26990920305252075,0.010406015440821648,0.03943104296922684,0.19497215747833252,-0.2542170584201813,-0.16569842398166656,0.31601986289024353,0.023991327732801437,0.27435827255249023,-0.06344971805810928,0.022586148232221603,-0.22615830600261688,-0.18736569583415985,0.0016034133732318878,0.2915598154067993,-0.016171414405107498,0.006083196960389614,0.29919135570526123,0.2969565689563751}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.14019262790679932,0.13078008592128754,0.2782197594642639,-0.00378229352645576},{0.07948459684848785,-0.04645569995045662,0.04831062629818916,0.14673271775245667},{-0.1432192623615265,0.1844204217195511,0.09975896030664444,0.14298729598522186},{0.31476664543151855,0.03853145241737366,0.05791732296347618,0.3908274173736572},{-0.0976499691605568,0.06632582098245621,0.25745609402656555,-0.023287218064069748},{-0.12584608793258667,0.20360296964645386,0.18867449462413788,-0.05549497529864311},{-0.2246658056974411,0.00339458673261106,-0.0007845945656299591,-0.1091095358133316},{-0.3413453698158264,-0.11725716292858124,0.3143085241317749,-0.2825900614261627},{0.2970767021179199,-0.1774812936782837,-0.2604399025440216,-0.34365183115005493},{0.04687541723251343,0.24799448251724243,0.3149401545524597,-0.3847825527191162},{-0.12432626634836197,-0.14209671318531036,-0.18361537158489227,0.18846748769283295},{0.2548612058162689,-0.1565946787595749,0.028912387788295746,0.16504432260990143},{0.27637577056884766,0.2786388397216797,-0.06855463981628418,0.08593740314245224},{0.0014936683000996709,0.05781105160713196,-0.27293094992637634,0.020350215956568718},{0.11527303606271744,0.27365466952323914,0.2939033806324005,0.297993928194046},{0.1427050083875656,0.06426693499088287,0.24283689260482788,0.22914083302021027},{-0.18984100222587585,-0.09707428514957428,-0.1391514539718628,-0.16752488911151886},{-0.16462479531764984,0.10512997210025787,-0.12794587016105652,-0.12230156362056732},{-0.15100446343421936,0.16326096653938293,0.14905104041099548,0.2566864788532257},{-0.029633808881044388,0.32427194714546204,-0.16464422643184662,0.05613379552960396},{-0.22271370887756348,-0.3371700048446655,-0.1348557323217392,-0.0103658027946949},{0.2648814618587494,0.37149542570114136,0.033986400812864304,-0.218221053481102},{-0.0006950869574211538,0.14893586933612823,0.1549489051103592,0.1367267519235611},{-0.08739344030618668,0.35592541098594666,-0.0521194152534008,-0.1192050501704216},{0.02420146018266678,-0.015031752176582813,-0.05057084187865257,-0.01958850771188736},{0.2524467706680298,-0.34910327196121216,-0.0397595539689064,0.052090417593717575},{-0.005536277778446674,-0.29161956906318665,-0.17448334395885468,-0.23218058049678802},{0.09143154323101044,-0.07296133041381836,0.2060404121875763,0.10783222317695618},{-0.0047299303114414215,-0.05137825012207031,0.06254929304122925,0.015483483672142029},{-0.3082578480243683,0.33252719044685364,0.22330935299396515,-0.08812439441680908},{0.29204660654067993,-0.14337225258350372,0.16105638444423676,-0.014814985916018486},{0.04799396172165871,-0.30145516991615295,0.3337169885635376,-0.24694938957691193}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.03643038868904114,-0.008178411982953548,0.019385525956749916,-0.04504236578941345,-0.035500332713127136,-0.15547016263008118,0.024579713121056557,0.04131936654448509,0.005108423996716738,-0.10186485946178436,0.13926944136619568,0.0732695534825325,-0.010785052552819252,-0.018797578290104866,0.08180209249258041,-0.011597433127462864};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.07012657821178436,0.038189638406038284,0.03857358545064926,0.024410586804151535,0.042323093861341476,0.021580137312412262,0.05011143907904625,-0.004497203975915909,0.004602931905537844,0.0003946206416003406,-0.04906143993139267,-0.02034814842045307,0.02905869297683239,-0.02729533053934574,-0.042441289871931076,-0.0011608334025368094};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06946460902690887,0.05658799037337303,0.014013558626174927,0.06688529253005981,0.041925039142370224,-0.02466147392988205,-0.04178020730614662,-0.011770453304052353,-0.024003833532333374,-0.004404169041663408,-0.04505087062716484,0.05312921106815338,0.05917372182011604,-0.061138592660427094,0.07105562835931778,0.06710612028837204,-0.06320230662822723,-0.05699154734611511,-0.0016030373517423868,0.015204841271042824,-0.03943302854895592,0.007846723310649395,0.0557294525206089,0.016676440834999084,-0.015643330290913582,0.0012750152964144945,-0.03653937578201294,0.05353548005223274,0.027570348232984543,-0.0033420617692172527,0.018148817121982574,0.02611878328025341};
static const float action_parameterization_distribution_linear_bias[4] = {0.049402665346860886,0.008323797956109047,0.0491960272192955,0.04103671386837959};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.05291154235601425,0.25842857360839844,-0.12147964537143707,0.145358607172966,0.2692835032939911,0.1916816532611847,0.2556969225406647,0.009004596620798111},{-0.1644027829170227,-0.09846735745668411,-0.23486629128456116,-0.27602526545524597,-0.277696818113327,-0.14461208879947662,-0.1989031583070755,-0.14114384353160858},{-0.26959338784217834,0.017984304577112198,0.2421341985464096,0.21225672960281372,0.2293398082256317,-0.0006905175978317857,0.18862274289131165,-0.07484737038612366},{-0.04460766166448593,0.07319216430187225,-0.17183832824230194,0.003675295738503337,-0.02383427508175373,-0.08142503350973129,0.1738184094429016,-0.11573202908039093},{-0.30116429924964905,-0.1375177949666977,-0.230575829744339,-0.15388482809066772,-0.07134990394115448,0.18589526414871216,0.13798938691616058,-0.0012019098503515124},{-0.3547237515449524,0.011367890052497387,0.32657450437545776,0.25450509786605835,0.1492423117160797,-0.05372866615653038,-0.11317020654678345,-0.11140238493680954},{-0.23394429683685303,0.0587986595928669,0.3093196451663971,-0.1874253898859024,-0.11999810487031937,-0.3323759436607361,-0.08015747368335724,-0.14133614301681519},{-0.48087114095687866,-0.3756487965583801,0.49870216846466064,-0.047265488654375076,-0.267355740070343,0.18275122344493866,0.18497782945632935,-0.18722808361053467},{-0.30638736486434937,0.2579771876335144,-0.11606915295124054,0.4269721806049347,0.08605018258094788,-0.40276768803596497,0.0849124863743782,0.12503540515899658},{-0.26449593901634216,-0.3183068633079529,-0.14500433206558228,-0.14261801540851593,-0.4461895227432251,0.03701472654938698,-0.0015861459542065859,0.13891460001468658},{0.17365621030330658,0.33019715547561646,0.19970473647117615,0.02197485789656639,0.26318421959877014,0.019261786714196205,-0.2467947155237198,0.24070721864700317},{0.21755996346473694,0.007229466922581196,0.24499301612377167,0.27089357376098633,-0.16448397934436798,0.2497738003730774,-0.008842219598591328,-0.22559115290641785},{0.10028044134378433,-0.24150632321834564,0.22051995992660522,-0.014210718683898449,-0.15380476415157318,-0.05132678523659706,-0.13820721209049225,-0.2067931890487671},{-0.22738169133663177,-0.067078597843647,0.3259254992008209,0.3839772045612335,-0.031582385301589966,-0.03720058873295784,-0.2274715155363083,0.049848392605781555},{-0.058836929500103,-0.13884826004505157,0.09304766356945038,-0.19129225611686707,-0.32520419359207153,-0.15247710049152374,0.18517501652240753,-0.0717744380235672},{-0.005706474184989929,-0.016584651544690132,-0.026085631921887398,-0.3172287940979004,-0.10016756504774094,0.055806949734687805,-0.04695354774594307,0.34469079971313477},{-0.04372762143611908,-0.18763762712478638,-0.18216629326343536,0.05047319829463959,-0.19333797693252563,-0.11567847430706024,-0.09457038342952728,0.03351075202226639},{-0.17209801077842712,-0.22535774111747742,0.05969613045454025,-0.01680351234972477,0.10859178006649017,-0.17429392039775848,0.37799498438835144,0.10864871740341187},{0.04751324653625488,0.13759130239486694,-0.2987464666366577,0.10184144228696823,0.08880152553319931,0.1194002777338028,-0.19369466602802277,0.27381154894828796},{0.1749853789806366,-0.0833200141787529,-0.4073709547519684,0.06402658671140671,-0.11641287058591843,-0.10793987661600113,-0.2620733976364136,-0.029942059889435768},{0.03915359824895859,-0.2012183517217636,-0.01443013921380043,-0.14424645900726318,0.21032479405403137,-0.09837877750396729,-0.061097148805856705,0.42455196380615234},{-0.03243149816989899,0.06344641000032425,-0.36053386330604553,0.2030276507139206,0.22469402849674225,0.22785866260528564,0.07706356793642044,-0.28750061988830566},{-0.41888880729675293,-0.1354530155658722,0.040989749133586884,-0.09789152443408966,0.14156469702720642,-0.3930944800376892,0.13016974925994873,-0.26902490854263306},{-0.08009474724531174,0.09289037436246872,-0.13145089149475098,-0.48725536465644836,0.2591163218021393,0.017643120139837265,-0.38150784373283386,0.12198532372713089},{-0.14080268144607544,-0.17509861290454865,-0.1514398455619812,0.07156947255134583,0.11812882125377655,0.33115431666374207,0.27368777990341187,-0.07280419021844864},{-0.15439724922180176,0.06426513940095901,-0.36096885800361633,-0.25852149724960327,0.13841968774795532,0.03363736346364021,-0.05925259366631508,0.060789912939071655},{0.2845347821712494,0.3768773674964905,-0.22792333364486694,0.2479465752840042,0.07610466331243515,0.2998068034648895,-0.2856391370296478,-0.17979127168655396},{0.3797304332256317,0.2422834187746048,0.11796976625919342,0.09822133928537369,0.2021452933549881,0.05581681430339813,0.22612011432647705,0.36492741107940674},{-0.10834646970033646,0.3389989733695984,0.14542609453201294,0.05674619972705841,0.2491675168275833,-0.005988646298646927,-0.40169399976730347,-0.27593350410461426},{-0.183099165558815,-0.26688331365585327,-0.022922635078430176,-0.16394665837287903,-0.2634066343307495,-0.16973693668842316,0.2253478467464447,0.006177091039717197},{0.409639835357666,-0.2937028706073761,0.23133715987205505,-0.2325020134449005,0.1229228600859642,0.26293542981147766,0.09096745401620865,-0.15945304930210114},{0.21124202013015747,0.40380293130874634,0.41066646575927734,-0.1898905336856842,-0.19414936006069183,0.12932109832763672,0.20858143270015717,0.038454532623291016}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.03466818109154701,0.37706124782562256,-0.15738657116889954,0.24706503748893738,-0.3641771972179413,0.21879011392593384,0.4381503164768219,0.030965667217969894},{-0.40672510862350464,-0.4501793086528778,-0.3203503489494324,-0.3712558150291443,-0.40188828110694885,0.37821653485298157,0.4632641077041626,-0.41041114926338196},{0.02096732147037983,-0.14118441939353943,0.10831037908792496,0.019007636234164238,-0.07383710145950317,0.39587894082069397,-0.30239689350128174,-0.2942662835121155},{0.36926761269569397,-0.00463577127084136,0.07239459455013275,-0.01501766312867403,0.5162617564201355,0.3814157545566559,0.40042391419410706,0.40509167313575745},{0.09190931916236877,0.22155676782131195,-0.1317649483680725,-0.039079632610082626,0.11732380837202072,-0.32753071188926697,-0.3661501705646515,0.4329710006713867},{0.407869428396225,0.09808339923620224,0.044276610016822815,-0.3305104076862335,-0.33765724301338196,-0.449150413274765,-0.11831292510032654,0.4677290618419647},{-0.32627126574516296,-0.2678452730178833,-0.004260411486029625,-0.19238783419132233,0.07089845836162567,0.32495319843292236,-0.4778388440608978,0.5837118625640869},{0.12869729101657867,0.038405369967222214,0.015424740500748158,-0.0829680934548378,0.3174673914909363,-0.47988465428352356,0.3767901062965393,-0.48944270610809326}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.04399055615067482,0.017635999247431755,0.12159013748168945,-0.05027994513511658,-0.0431041419506073,-0.044039081782102585,0.10465453565120697,-0.031723156571388245};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.046936847269535065,-0.025716835632920265,0.052238829433918,-0.1085696592926979,0.001077653025276959,0.0030102154705673456,-0.016161365434527397,-0.058813534677028656};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

