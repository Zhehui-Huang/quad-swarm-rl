#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2736535668373108,-0.18481594324111938,0.3338043987751007,0.23487284779548645,-0.37398746609687805,0.18426287174224854,-0.01502983644604683,-0.20567627251148224,0.09011491388082504,0.3977569341659546,0.11879710108041763,0.06250324845314026,0.16007426381111145,-0.20202283561229706,0.3371807336807251,-0.1023203507065773},{-0.3591773808002472,-0.30147531628608704,0.29591262340545654,0.20603971183300018,-0.24074555933475494,0.06731242686510086,-0.3900115489959717,-0.01036438811570406,-0.15787671506404877,-0.1433812975883484,0.12349362671375275,-0.18531903624534607,0.23745152354240417,-0.4010814428329468,-0.20300646126270294,0.08901316672563553},{0.14976373314857483,-0.23196756839752197,-0.2686842679977417,0.0937042385339737,0.10602913051843643,0.15011996030807495,-0.05979108065366745,0.026739684864878654,-0.12839464843273163,-0.20457398891448975,-0.18201729655265808,0.4195954501628876,0.0024401037953794003,-0.16114212572574615,-0.415980726480484,0.2380426973104477},{0.13110870122909546,0.18771125376224518,0.3259773254394531,-0.02941039949655533,-0.31919530034065247,-0.03628115355968475,0.19054444134235382,0.13762831687927246,0.4835631847381592,-0.3906935155391693,0.03771143779158592,0.1749032586812973,-0.3490368723869324,-0.032277315855026245,0.3398244380950928,-0.4030141234397888},{-0.04821547120809555,0.054724279791116714,0.23599497973918915,-0.11011464893817902,0.24254398047924042,0.29095378518104553,0.30149441957473755,-0.07159436494112015,-0.02555880881845951,0.2502880394458771,0.33924514055252075,-0.19525618851184845,-0.14059917628765106,-0.30422765016555786,0.4142443835735321,0.15446467697620392},{0.015079663135111332,-0.1831013560295105,-0.152253195643425,-0.23014917969703674,0.13854001462459564,0.01151962298899889,0.00675854692235589,-0.14279517531394958,0.22422561049461365,-0.25414177775382996,-0.29663628339767456,0.18912221491336823,0.43059489130973816,-0.0029096121434122324,-0.01832166314125061,0.1067034900188446},{-0.05019521340727806,-0.009809671901166439,0.08642604202032089,-0.21690566837787628,0.2151198834180832,0.02946314588189125,0.072099469602108,0.3305578827857971,0.32643067836761475,-0.02575165219604969,-0.3430778980255127,0.18797266483306885,-0.10915257036685944,0.20552416145801544,-0.16441906988620758,-0.2370939999818802},{0.008051032200455666,0.015741504728794098,0.22408805787563324,0.2566487491130829,-0.39579910039901733,-0.008991308510303497,0.3570998013019562,0.33576804399490356,-0.07895611971616745,0.24169009923934937,-0.48906636238098145,-0.3122832477092743,0.22793321311473846,0.30528974533081055,0.23828622698783875,0.12309347093105316},{0.2714930474758148,-0.22267961502075195,0.3183952271938324,-0.07673604786396027,0.25582218170166016,0.08098798990249634,-0.14660079777240753,-0.20758874714374542,0.10397433489561081,-0.31039994955062866,0.05522093176841736,-0.2888734042644501,-0.1750672459602356,0.35880807042121887,0.14936156570911407,-0.1044253557920456},{0.025340300053358078,-0.3887661099433899,-0.4492201507091522,-0.03415491804480553,-0.323501855134964,0.17624284327030182,0.3475981652736664,0.2433425337076187,0.43411824107170105,0.3518332839012146,-0.030562276020646095,-0.2959916591644287,0.09827985614538193,0.27500540018081665,-0.0627373456954956,-0.32554301619529724},{0.08835844695568085,0.2519667446613312,0.4432692229747772,-0.3430353105068207,-0.3205661475658417,0.20691046118736267,0.14730073511600494,0.39530816674232483,-0.3267901539802551,-0.037148840725421906,-0.05601264908909798,0.17267252504825592,-0.29917097091674805,-0.181615948677063,0.34191322326660156,-0.3393993377685547},{0.1389068067073822,-0.14000660181045532,-0.04527617618441582,0.12683957815170288,0.32282620668411255,0.2633730471134186,0.4187771677970886,0.006338919047266245,-0.01098969578742981,0.03981653228402138,0.26897114515304565,-0.0867510512471199,-0.08141098916530609,-0.20487095415592194,0.22555337846279144,0.3005896806716919},{-0.15582618117332458,0.36429134011268616,0.16522341966629028,-0.3135952353477478,0.03805265203118324,0.11879563331604004,0.2841295301914215,-0.0373339019715786,0.09870215505361557,0.020218491554260254,-0.07067722082138062,0.14441393315792084,0.2416851818561554,0.30118393898010254,0.1335618942975998,-0.2211763560771942},{-0.24275387823581696,-0.20396950840950012,-0.20738907158374786,-0.030415019020438194,-0.17019538581371307,0.10589228570461273,-0.33812370896339417,0.09942210465669632,-0.07702891528606415,-0.042780227959156036,-0.29025280475616455,-0.07361585646867752,-0.31424248218536377,0.11129390448331833,0.22729721665382385,0.09827413409948349},{-0.12089387327432632,-0.4024425745010376,-0.25083422660827637,0.3324171006679535,0.046869274228811264,-0.35421743988990784,0.28165873885154724,-0.06551844626665115,-0.02710995264351368,0.30080053210258484,0.0680917426943779,0.2121708244085312,0.19745978713035583,-0.04129527136683464,-0.18288953602313995,0.1938483715057373},{0.5341830849647522,-0.11298710107803345,-0.250176340341568,-0.41823309659957886,-0.626556932926178,0.3348838984966278,0.42447590827941895,-0.3220597803592682,0.17915867269039154,0.11963311582803726,-0.31569594144821167,0.05076275393366814,-0.5618952512741089,0.5381131768226624,-0.282283753156662,0.03262457996606827},{-0.3616679012775421,-0.4075881838798523,0.40153276920318604,0.3573310077190399,-0.31341907382011414,0.3393145799636841,-0.14278100430965424,-0.3049502670764923,0.2455594837665558,-0.465887188911438,-0.35753265023231506,-0.6435073018074036,-0.20826511085033417,-0.517846405506134,-0.007218317594379187,-0.20305031538009644},{-0.3686365485191345,0.3056563138961792,-0.49115416407585144,-0.0036100950092077255,0.04962601885199547,0.33891692757606506,-0.2658689618110657,-0.40772271156311035,0.22697274386882782,0.25360801815986633,0.41344383358955383,-0.08861982822418213,-0.24163462221622467,0.3103717863559723,0.1678081750869751,-0.5125427842140198}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1502806693315506,-0.0879836231470108,-0.17495618760585785,-0.4118296802043915,0.431316077709198,0.2870139479637146,0.07854003459215164,0.10030455142259598,-0.2952837347984314,-0.09891655296087265,-0.11351926624774933,-0.01903730444610119,0.2324788123369217,0.536675751209259,0.15990939736366272,0.06551087647676468},{-0.18601424992084503,-0.27082160115242004,-0.0426490381360054,0.12905824184417725,0.27855080366134644,-0.2850057780742645,0.16611787676811218,0.06041673570871353,-0.08386298269033432,0.2537272572517395,-0.1522485464811325,0.3459326922893524,-0.3650117814540863,0.22312551736831665,-0.3664854168891907,-0.26618924736976624},{0.11936165392398834,0.27113959193229675,-0.43368592858314514,-0.5470349192619324,0.12811313569545746,0.4787003993988037,-0.10351815819740295,0.11089106649160385,-0.22103427350521088,-0.2407885044813156,-0.01386259775608778,0.3165074586868286,-0.35854682326316833,-0.3164308965206146,0.1886845976114273,-0.07200424373149872},{0.1970381885766983,-0.032529231160879135,0.08136533200740814,0.19785919785499573,-0.5169468522071838,0.031845513731241226,0.027022363618016243,-0.2605911195278168,0.37060439586639404,0.38401588797569275,-0.09369190782308578,-0.16172894835472107,-0.38750123977661133,-0.3813914358615875,0.1956837773323059,0.2326807826757431},{-0.1911807656288147,0.031241489574313164,0.06477285921573639,0.2720465660095215,-0.22047390043735504,0.0040704477578401566,-0.052987176924943924,0.17782117426395416,0.23509581387043,-0.3422430455684662,0.03809189423918724,0.40337327122688293,0.1389501839876175,-0.413057416677475,-0.09264706075191498,-0.12138646841049194},{0.267819344997406,0.23460014164447784,-0.03982597216963768,0.15723343193531036,-0.36987996101379395,-0.41476017236709595,0.26090872287750244,0.2941894233226776,0.10923679172992706,0.503770112991333,0.23639705777168274,-0.27919724583625793,0.004018590785562992,-0.14220835268497467,-0.048200637102127075,0.31372401118278503},{-0.021046794950962067,0.16456739604473114,0.33192771673202515,-0.38782721757888794,-0.16862696409225464,0.08357381075620651,-0.3095506429672241,-0.0853089764714241,0.0880623459815979,0.09800585359334946,-0.1660071313381195,-0.27898406982421875,-0.30911871790885925,0.07317773997783661,0.2270202785730362,0.05710982158780098},{-0.20304134488105774,-0.2009020745754242,-0.4217086434364319,0.2801010310649872,-0.30369341373443604,-0.3230481445789337,-0.2135336995124817,-0.35075539350509644,0.018145060166716576,-0.25068625807762146,-0.1328725963830948,0.18316106498241425,-0.2313208132982254,0.4019247889518738,-0.13998515903949738,-0.40500518679618835},{-0.26383906602859497,0.28771722316741943,0.007982256822288036,-0.0036205919459462166,0.30968719720840454,-0.1975262463092804,0.41476693749427795,0.11024639755487442,0.30546385049819946,0.3877820372581482,0.3200953006744385,0.2946430742740631,0.23456697165966034,-0.05125558003783226,0.3127496838569641,0.1453401893377304},{0.14298909902572632,-0.25423598289489746,-0.06223999708890915,-0.15865974128246307,0.31619343161582947,-0.042270150035619736,-0.2954891622066498,-0.23629894852638245,0.07481135427951813,-0.4729546308517456,-0.22788777947425842,0.22875602543354034,0.11249539256095886,0.16880682110786438,-0.31557703018188477,0.24812321364879608},{-0.19325651228427887,-0.3826119303703308,0.4944298267364502,0.27215713262557983,0.23368853330612183,0.13482235372066498,0.14815104007720947,-0.16208724677562714,0.15947256982326508,-0.26794642210006714,0.021850718185305595,0.3784695565700531,0.3823290765285492,0.13456103205680847,-0.25171777606010437,-0.0015737079083919525},{0.02213120460510254,-0.18882545828819275,0.3135524392127991,0.0645698755979538,-0.13028773665428162,-0.19903646409511566,0.44030264019966125,0.26231852173805237,-0.24648475646972656,-0.3914879262447357,-0.13490727543830872,-0.2856583893299103,-0.017843114212155342,-0.31182411313056946,-0.38856083154678345,-0.008268279954791069},{-0.08392426371574402,-0.33835768699645996,0.31613028049468994,-0.17885342240333557,0.2990404963493347,-0.3435796797275543,-0.38741135597229004,0.16625571250915527,0.13670694828033447,-0.052463408559560776,-0.3041430711746216,0.09489801526069641,0.0693138986825943,-0.3432164192199707,-0.4180639982223511,-0.018551796674728394},{0.3084092438220978,-0.3637058734893799,0.49680274724960327,0.13212278485298157,0.10798206925392151,0.2988557815551758,-0.08915815502405167,-0.24070213735103607,-0.5496973991394043,0.09032385051250458,0.007443293929100037,-0.438215434551239,0.030523983761668205,0.2927692234516144,0.3277929723262787,0.07670819014310837},{-0.21593010425567627,0.17142963409423828,0.08984231948852539,-0.32942748069763184,-0.19939535856246948,0.1269817054271698,0.2279035896062851,-0.18799521028995514,0.206097811460495,-0.38356295228004456,-0.005197631195187569,0.08669004589319229,-0.08127689361572266,0.0853196382522583,-0.03500998020172119,0.003298825351521373},{-0.1783486008644104,0.3515350818634033,-0.3412783443927765,0.30379393696784973,0.18583697080612183,-0.39341461658477783,-0.12928640842437744,-0.06226639822125435,-0.4284990429878235,0.2792043387889862,-0.4209992587566376,0.3066989481449127,-0.0664326623082161,-0.16038590669631958,-0.28446730971336365,-0.5441480875015259}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1956792175769806,0.017270345240831375,-0.08628663420677185,-0.0021490873768925667,-0.11371908336877823,-0.017452580854296684,0.2984631061553955,-0.00110841472633183,-0.10332465171813965,-0.13515053689479828,0.09041960537433624,-0.3343457281589508,-0.22133685648441315,0.23171041905879974,0.19786520302295685,0.2604849934577942,-0.2871512472629547,-0.3287174105644226,-0.2635974884033203,0.020766207948327065,-0.014660874381661415,-0.37743234634399414,-0.2179231345653534,-0.29418954253196716,-0.31953179836273193,0.26158565282821655,-0.28370121121406555,-0.054529204964637756,-0.0009827740723267198,-0.02642631344497204,0.15340839326381683,-0.14646953344345093},{0.20170184969902039,0.25386014580726624,0.07346922159194946,-0.08478962630033493,0.11905945092439651,-0.05655132606625557,0.33318892121315,0.0955171063542366,-0.2392384260892868,-0.13497772812843323,-0.04877777397632599,-0.3224727213382721,-0.21578042209148407,0.21321620047092438,-0.20390893518924713,-0.30536794662475586,-0.03182391822338104,0.19215375185012817,-0.3688168525695801,-0.33515465259552,-0.03397664800286293,0.3069339096546173,0.16262902319431305,-0.1187557727098465,0.14349840581417084,-0.24209974706172943,0.01093817688524723,0.14869828522205353,0.2275034338235855,-0.1732293665409088,-0.035906486213207245,0.2215574085712433},{0.2684403657913208,0.08330746740102768,-0.056414421647787094,0.20976391434669495,-0.25957292318344116,-0.19731441140174866,-0.3510001599788666,0.1735808402299881,-0.12196099758148193,0.37550225853919983,-0.24769091606140137,-0.1198672503232956,0.1401199847459793,-0.44782814383506775,-0.09536561369895935,0.06376010924577713,-0.17718003690242767,-0.2088460922241211,0.3182421624660492,-0.0270881038159132,0.3084290623664856,0.18212945759296417,-0.2472698986530304,-0.012426253408193588,-0.25077205896377563,-0.11133220791816711,0.19695734977722168,-0.13737046718597412,-0.027570653706789017,-0.1123625710606575,-0.10667601972818375,-0.03902599588036537},{0.36329543590545654,0.08518758416175842,0.09301839768886566,-0.12963072955608368,-0.29318714141845703,-0.09211394935846329,-0.18841613829135895,0.27626940608024597,0.25596100091934204,-0.2273559272289276,-0.08392203599214554,0.33178505301475525,0.08851100504398346,-0.17445357143878937,-0.20006513595581055,0.30405306816101074,-0.33160412311553955,0.20258218050003052,0.014476547949016094,0.10555534809827805,-0.0256765466183424,-0.12262118607759476,0.2870708703994751,0.1636098474264145,0.17871536314487457,-0.35311397910118103,0.3523440361022949,-0.24397704005241394,-0.02766147255897522,0.06078565493226051,-0.289814293384552,0.18251869082450867},{-0.038211021572351456,-0.07159724831581116,-0.08105449378490448,0.051032476127147675,0.18610234558582306,-0.20034925639629364,-0.36937737464904785,-0.035069070756435394,-0.12076152116060257,-0.1696767359972,0.13022632896900177,0.22950445115566254,-0.04636729881167412,-0.0806037187576294,-0.0959596112370491,0.19818079471588135,-0.07868753373622894,-0.03654301166534424,-0.34448009729385376,-0.08618967980146408,-0.1481197476387024,-0.3870563507080078,0.16758182644844055,0.22956077754497528,-0.0705471783876419,0.2983435392379761,-0.18326251208782196,0.17868860065937042,0.3110978603363037,0.3480958640575409,-0.04611212760210037,0.3107692003250122},{-0.2687469720840454,-0.06149866059422493,-0.206319659948349,-0.031537700444459915,-0.18649697303771973,0.24011412262916565,0.20578470826148987,0.024261383339762688,0.2917507588863373,0.1771639585494995,0.34113842248916626,-0.2394954264163971,-0.2073085755109787,0.22007490694522858,0.3061458170413971,-0.37007007002830505,-0.1273246705532074,-0.24909226596355438,0.217062845826149,0.07871734350919724,0.09845314174890518,0.13959790766239166,0.04727980121970177,-0.048072732985019684,-0.37126079201698303,0.3617324233055115,-0.20679496228694916,0.1721620410680771,0.38917484879493713,0.2041810154914856,0.05786972865462303,0.09189826995134354},{0.16958078742027283,-0.10616680979728699,-0.16288645565509796,-0.3212602138519287,-0.043518684804439545,0.22029493749141693,0.2645059823989868,0.14596252143383026,0.0864495262503624,0.35586220026016235,-0.008025452494621277,0.0009735882049426436,-0.4187708795070648,-0.16815926134586334,-0.14722944796085358,0.06282852590084076,-0.3079167306423187,-0.23901304602622986,0.17974881827831268,-0.10134478658437729,-0.09539651870727539,-0.14839571714401245,-0.1954057812690735,-0.26649412512779236,0.17219989001750946,-0.23948191106319427,-0.10010956972837448,-0.2174256443977356,0.3507392108440399,0.1055528074502945,-0.189599871635437,-0.2696717381477356},{0.0628434345126152,0.17638540267944336,0.05308454856276512,-0.15140849351882935,0.15131834149360657,-0.29774385690689087,-0.03575998544692993,-0.15693993866443634,-0.005455746781080961,-0.26755014061927795,-0.3445723354816437,-0.12029170244932175,-0.1115574911236763,0.06209689751267433,-0.16344080865383148,0.4288432002067566,0.01310355868190527,-0.12625016272068024,0.10075663775205612,0.340289831161499,-0.1997089684009552,-0.17735470831394196,0.28729355335235596,0.09125160425901413,0.014607158489525318,-0.34489426016807556,-0.33912816643714905,-0.20865237712860107,-0.3923274278640747,-0.28988373279571533,0.09459059685468674,-0.40407899022102356},{0.030301937833428383,0.534080982208252,-0.43991532921791077,-0.4000399708747864,-0.3344143331050873,0.2036525458097458,0.05421287193894386,0.17892225086688995,-0.0615251325070858,-0.30244216322898865,-0.07259414345026016,0.3106013834476471,-0.4585098922252655,-0.2634105086326599,0.2611956000328064,-0.20570918917655945,0.23459281027317047,0.1761990636587143,0.4181799292564392,0.049369558691978455,0.13894620537757874,0.2679171562194824,0.41479527950286865,-0.19662711024284363,0.47502201795578003,-0.2351006269454956,0.31995445489883423,0.46248915791511536,-0.15590649843215942,0.09920946508646011,0.06572116166353226,0.0994766429066658},{-0.29113414883613586,0.08698667585849762,-0.4408031702041626,-0.23219530284404755,0.11342966556549072,-0.2828499972820282,0.18703731894493103,-0.06728225201368332,0.21224862337112427,0.16909019649028778,-0.337642639875412,-0.4273802638053894,-0.4676469564437866,-0.11701474338769913,-0.30862128734588623,0.13368186354637146,-0.08082707226276398,-0.2717592418193817,0.09536876529455185,0.07323639839887619,0.07798317074775696,-0.003928111866116524,0.4253649413585663,-0.14677616953849792,0.3632161319255829,0.20985887944698334,-0.27645063400268555,0.009597104042768478,-0.0029566530138254166,-0.0728176161646843,-0.2896469533443451,0.10170550644397736},{0.0895862728357315,0.03423566371202469,0.10174833983182907,-0.2979387044906616,-0.30943095684051514,-0.2412027269601822,-0.2507193386554718,-0.02487543225288391,-0.19987952709197998,0.40465009212493896,0.14297907054424286,-0.28811490535736084,-0.38703417778015137,-0.08177898824214935,-0.22308434545993805,-0.11714483052492142,0.19074532389640808,-0.15979352593421936,0.2598285675048828,-0.20015329122543335,-0.1827383041381836,0.04916080832481384,0.23807498812675476,0.1836860030889511,0.21369488537311554,-0.1397114098072052,-0.027435513213276863,-0.05968138203024864,-0.04176996275782585,-0.03230529651045799,-0.09185975790023804,0.1652311086654663},{-0.2023172676563263,-0.03861444070935249,0.2209688276052475,0.2516480088233948,0.2758226990699768,0.016026688739657402,0.09738479554653168,-0.1933574080467224,-0.12323099374771118,-0.23178040981292725,0.2959546744823456,-0.2388390153646469,-0.21343956887722015,-0.1802705079317093,0.27807101607322693,0.04897189140319824,0.009344309568405151,0.05830621346831322,0.36249324679374695,0.0978182852268219,-0.2297765016555786,0.2875167727470398,0.11042299121618271,-0.06041746959090233,0.2598642110824585,-0.1432008445262909,-0.11976383626461029,0.25135257840156555,0.18122179806232452,-0.028260618448257446,-0.2373177856206894,-0.29703810811042786},{0.28043651580810547,-0.26353803277015686,-0.030256478115916252,-0.3025951385498047,0.057106103748083115,-0.17997264862060547,0.10866504162549973,0.09927952289581299,0.2967846691608429,0.1266259402036667,0.11443286389112473,0.23688845336437225,-0.3513641357421875,-0.3273417353630066,-0.07445850968360901,-0.23192207515239716,-0.2234552800655365,-0.2880805432796478,0.26879870891571045,-0.21448981761932373,0.3649072051048279,-0.09467143565416336,-0.016859035938978195,0.1931859701871872,0.14029087126255035,-0.11825840920209885,0.10797837376594543,0.02907628007233143,0.15429633855819702,-0.05658930167555809,-0.305733859539032,-0.052670564502477646},{0.20463517308235168,-0.14360857009887695,-0.03930051252245903,0.4525628089904785,-0.0724891945719719,-0.2767861485481262,-0.035982195287942886,0.02699337899684906,0.2765190601348877,0.3927536606788635,0.05389273166656494,-0.1791301816701889,0.11006563156843185,0.24649249017238617,-0.13835713267326355,0.03194902092218399,0.16954421997070312,-0.27761176228523254,-0.012514529749751091,-0.3802102506160736,0.36563172936439514,0.060681845992803574,-0.12060984969139099,0.22469474375247955,0.14327922463417053,0.18324829638004303,0.024634284898638725,-0.033667828887701035,0.09018556028604507,-0.17374064028263092,-0.095952108502388,0.4149525761604309},{-0.016113391146063805,-0.2658954858779907,-0.12676271796226501,0.13415582478046417,-0.2638917863368988,-0.017892468720674515,0.06430890411138535,-0.2973274290561676,-0.13481450080871582,9.37572549446486e-05,0.17992332577705383,0.10253699123859406,0.06632883846759796,0.24589432775974274,-0.06353653222322464,-0.10953478515148163,-0.24258966743946075,0.26173725724220276,-0.15442916750907898,-0.3137799799442291,-0.1742728352546692,-0.079644113779068,0.20040424168109894,0.0032946595456451178,-0.05688757449388504,-0.021716006100177765,-0.24295049905776978,0.22139137983322144,0.09374821186065674,-0.22174687683582306,0.1912035495042801,0.20649386942386627},{0.11334767937660217,-0.1727471947669983,-0.15493576228618622,-0.1656210720539093,-0.14400292932987213,0.12785427272319794,0.0327698178589344,0.24005848169326782,-0.13494142889976501,0.07843805104494095,0.26147621870040894,0.09558037668466568,-0.08402568846940994,-0.17359113693237305,0.038201238960027695,0.15914538502693176,-0.4779536724090576,-0.29041367769241333,-0.06302767246961594,0.02143457904458046,0.13354326784610748,0.24594883620738983,0.33199241757392883,0.10834584385156631,0.04771312326192856,0.24310268461704254,0.02750827558338642,-0.07288718223571777,0.22040940821170807,-0.16672690212726593,-0.32972076535224915,0.38785943388938904},{0.16391266882419586,-0.0075418949127197266,-0.27481740713119507,0.19439354538917542,0.08830878138542175,-0.04116138815879822,0.26134252548217773,0.09598371386528015,0.12864363193511963,-0.18917718529701233,0.23350201547145844,-0.19289624691009521,-0.4101662039756775,0.24562300741672516,0.07445807009935379,0.015045026317238808,0.03755210340023041,-0.08340983092784882,-0.152942955493927,0.024439791217446327,-0.04176585003733635,0.1772695630788803,0.08486095815896988,-0.15920567512512207,-0.006445186212658882,-0.22148865461349487,0.022389525547623634,0.38244691491127014,0.28499868512153625,-0.1438758224248886,0.19611956179141998,0.22452494502067566},{-0.03348321467638016,-0.05304750055074692,-0.0564899742603302,-0.050533343106508255,-0.22824037075042725,-0.028185585513710976,0.2121288776397705,0.20361419022083282,0.15952500700950623,-0.017883671447634697,0.21432934701442719,0.0135918278247118,0.22786493599414825,0.17785634100437164,0.1586763560771942,-0.08109663426876068,0.1449219137430191,0.18886660039424896,0.24126608669757843,0.08883661031723022,0.17919616401195526,0.23699310421943665,0.04449386149644852,0.1605217009782791,-0.005252844654023647,-0.10693743079900742,-0.13115622103214264,-0.2462676614522934,0.15147724747657776,-0.2246587723493576,0.05324472114443779,-0.053107816725969315},{-0.36722531914711,0.08773689717054367,-0.31854212284088135,-0.30096668004989624,-0.01235614251345396,0.06981989741325378,0.1059785708785057,-0.17202159762382507,0.0007089109276421368,0.3100820779800415,0.09488470107316971,-0.21017210185527802,0.02515450306236744,-0.15753324329853058,-0.2705312669277191,-0.08116890490055084,-0.1839732974767685,0.11174482107162476,-0.03003646247088909,-0.11822811514139175,-0.3066008388996124,0.1711283028125763,0.13313159346580505,-0.014009717851877213,-0.0764499381184578,0.32884740829467773,0.03265933319926262,-0.14499743282794952,-0.13405326008796692,0.02685302123427391,-0.15136246383190155,-0.21327070891857147},{0.021617479622364044,-0.22168657183647156,-0.22298835217952728,-0.019788440316915512,-0.34687480330467224,-0.17184792459011078,0.15282276272773743,-0.2840980589389801,-0.19440287351608276,0.18545275926589966,0.14299674332141876,0.1280832439661026,0.1336069405078888,-0.11629253625869751,0.30709895491600037,-0.3015492558479309,0.0652734562754631,0.2174290269613266,0.05142684653401375,0.2536761462688446,0.06085175648331642,-0.14052213728427887,-0.2941476106643677,0.21385963261127472,-0.15062697231769562,-0.17965175211429596,0.09146987646818161,0.0014581785071641207,-0.1184622123837471,-0.2933022081851959,-0.03985964506864548,-0.14595690369606018},{0.20252765715122223,0.18512775003910065,-0.07677007466554642,0.16874545812606812,-0.2764629125595093,0.1870201975107193,-0.06411653757095337,-0.16216911375522614,-0.20479676127433777,0.20554906129837036,-0.24561598896980286,-0.15436041355133057,-0.04300807788968086,-0.17663240432739258,-0.34658148884773254,-0.16345125436782837,-0.08948657661676407,-0.27146580815315247,-0.21450844407081604,0.2679740786552429,0.09908554702997208,0.126046821475029,-0.3280738592147827,0.30749842524528503,0.1615028828382492,0.2690770924091339,-0.27875247597694397,-0.033229537308216095,0.09338381886482239,-0.25743016600608826,0.13800892233848572,0.11162389814853668},{0.004399882163852453,-0.30846697092056274,0.001237233285792172,-0.30744320154190063,-0.05636930838227272,0.24500252306461334,0.19125492870807648,0.033433374017477036,-0.03594844415783882,0.025381075218319893,-0.23878991603851318,0.13720831274986267,0.1442669928073883,0.09942607581615448,0.12025000900030136,0.036377232521772385,-0.08450944721698761,0.12291527539491653,-0.12268306314945221,0.1820315271615982,0.21852576732635498,0.2349451184272766,-0.07291688770055771,-0.2159568816423416,0.13352864980697632,0.11486851423978806,0.25119268894195557,0.11716141551733017,-0.02858852781355381,0.1565096080303192,0.01632007583975792,-0.12173368036746979},{0.04333532601594925,-0.18832935392856598,0.25777995586395264,-0.019725376740098,0.2948954403400421,-0.034476157277822495,-0.11576349288225174,-0.14920970797538757,0.14439767599105835,-0.07558877766132355,0.05990297719836235,0.011382716707885265,-0.2318430095911026,0.019620299339294434,-0.12101815640926361,-0.230142742395401,-0.03786645084619522,-0.023741813376545906,0.22385674715042114,0.28229454159736633,0.012357602827250957,0.055973783135414124,0.16896966099739075,0.34544292092323303,-0.13782855868339539,-0.10504823178052902,0.21308781206607819,-0.09125465154647827,-0.2469533532857895,-0.2351129651069641,0.3041072189807892,-0.02185804955661297},{0.20342108607292175,-0.03080599009990692,0.04598755016922951,0.12736167013645172,-0.04904022440314293,0.0748470202088356,-0.27852416038513184,0.30161648988723755,-0.11150611937046051,-0.05878981575369835,0.12009640783071518,-0.25797873735427856,-0.005717707332223654,-0.05199132114648819,-0.07446793466806412,0.2879183292388916,-0.0664299800992012,-0.19678223133087158,0.056659433990716934,-0.025359543040394783,-0.16413761675357819,0.216472789645195,0.24350665509700775,0.20629392564296722,-0.27870863676071167,0.11780301481485367,-0.04212551563978195,0.09214706718921661,-0.27123868465423584,0.2912561595439911,-0.01453439425677061,0.05357353389263153}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.25540995597839355,-0.10830115526914597,0.18880535662174225,-0.22859391570091248},{0.2105216234922409,-0.36176764965057373,0.3144250214099884,0.3173275589942932},{-0.3825691342353821,0.09958965331315994,0.09641765058040619,-0.01962730661034584},{0.24656268954277039,0.5899426341056824,0.3744867146015167,0.0353020504117012},{-0.3112541139125824,0.14115506410598755,-0.36048051714897156,0.10430928319692612},{-0.06828354299068451,-0.11145292967557907,0.11863605678081512,0.5444213151931763},{-0.07836418598890305,-0.10773424804210663,-0.45747053623199463,0.039617933332920074},{-0.1663036048412323,-0.30156227946281433,0.2597847580909729,-0.08376443386077881},{-0.09482906758785248,0.15824128687381744,-0.12235738337039948,-0.19470523297786713},{0.3215831518173218,0.08697519451379776,-0.10496478527784348,-0.28008192777633667},{0.19991333782672882,-0.10728054493665695,0.337894469499588,0.2959270477294922},{-0.12874771654605865,-0.015646861866116524,0.527570903301239,-0.12534019351005554},{-0.46521198749542236,0.30598053336143494,0.0028550440911203623,-0.1471042037010193},{-0.2054355889558792,0.1387491077184677,-0.3145509958267212,0.12454362958669662},{0.14774027466773987,0.006427442189306021,0.30933037400245667,0.14046844840049744},{-0.17089946568012238,-0.3472646474838257,-0.1517927348613739,-0.15616409480571747},{-0.4393540918827057,0.021901946514844894,-0.12689413130283356,0.37954118847846985},{-0.3558121919631958,-0.1646280437707901,-0.2197716385126114,0.2837235629558563},{-0.09660512953996658,-0.2174225002527237,0.47581809759140015,0.055178627371788025},{-0.26879364252090454,-0.2288290411233902,0.05024946108460426,-0.2089771330356598},{0.19657215476036072,0.17327935993671417,0.19920331239700317,-0.2800596058368683},{-0.026853187009692192,-0.3846958875656128,-0.12458128482103348,0.41371282935142517},{0.4854828715324402,-0.3254159092903137,0.11981290578842163,0.1055874153971672},{-0.3745158314704895,-0.08334139734506607,-0.3125978410243988,-0.40318650007247925},{-0.15056940913200378,-0.3220921456813812,-0.1282380223274231,-0.0999014675617218},{0.22738495469093323,0.2342342585325241,-0.10769402980804443,0.09568926692008972},{0.11860836297273636,-0.23976540565490723,0.38195982575416565,0.07870840281248093},{-0.0523892343044281,-0.21581554412841797,-0.06197502836585045,0.37429285049438477},{0.20815564692020416,0.07581419497728348,0.058000799268484116,0.044450774788856506},{-0.17555682361125946,0.10924804955720901,0.30480319261550903,0.04505855590105057},{-0.30076298117637634,-0.07964485138654709,0.07973464578390121,0.31969690322875977},{0.36015453934669495,0.25276094675064087,0.27234911918640137,-0.04990169405937195}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09751848131418228,-0.14179836213588715,0.0870257019996643,0.1016230508685112,0.08818858116865158,-0.19510813057422638,0.09212110191583633,0.020146368071436882,-0.07622859627008438,-0.040880799293518066,-8.587333286413923e-05,-0.038515813648700714,-0.014445637352764606,0.10328944772481918,0.1154826283454895,-0.03251948952674866};
static const float actor_encoder_self_encoder_2_bias[16] = {0.025976527482271194,0.05719013139605522,0.05329079180955887,-0.05371422693133354,-0.041825197637081146,0.08553927391767502,-0.057342518121004105,-0.10030971467494965,0.035742875188589096,-0.018298901617527008,-0.018497809767723083,0.00819665752351284,-0.009143593721091747,-0.07814713567495346,0.05287281796336174,-0.07973648607730865};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05247393250465393,-0.0036926991306245327,-0.07513875514268875,0.06587251275777817,0.0029180182609707117,0.014533460140228271,-0.058136068284511566,-0.05606536567211151,-0.011091701686382294,-0.019435791298747063,0.024460894986987114,0.020820753648877144,-0.014529891312122345,-0.02208387665450573,0.038518548011779785,-0.08860089629888535,-0.011800740845501423,-0.03689388185739517,0.01576049253344536,-0.07244149595499039,0.020269615575671196,-0.013990013860166073,0.023623166605830193,-0.07429827004671097,-0.0773102417588234,0.06819646805524826,0.030949817970395088,-0.015021943487226963,0.06321150809526443,0.011555084027349949,-0.017038494348526,0.05917775258421898};
static const float action_parameterization_distribution_linear_bias[4] = {0.0401633158326149,0.061430756002664566,0.0062142652459442616,0.03985557705163956};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3303607106208801,-0.23996897041797638,-0.127192422747612,0.20094676315784454,-0.12201374769210815,0.06338884681463242,-0.27775660157203674,-0.004339936655014753},{0.10821022838354111,0.15736016631126404,0.3300269544124603,0.3431463837623596,-0.11756985634565353,-0.31981024146080017,0.31030163168907166,0.26408061385154724},{0.030438201501965523,0.2009236067533493,0.057836901396512985,-0.07979799062013626,0.3257374167442322,0.22880013287067413,-0.05752400681376457,0.17076146602630615},{0.09216897934675217,-0.28853538632392883,0.27727773785591125,-0.2567036747932434,-0.2503274083137512,0.07592873275279999,0.21851174533367157,0.2100253403186798},{-0.23396259546279907,-0.012906254269182682,-0.06785378605127335,-0.3767419457435608,0.11907368153333664,0.07893480360507965,0.2819657623767853,0.2516986131668091},{-0.062104180455207825,0.27513059973716736,-0.04636283591389656,-0.3042573630809784,0.2648060619831085,0.05146187171339989,0.02425534650683403,-0.19259414076805115},{0.019224466755986214,0.29538577795028687,0.16334572434425354,-0.22030845284461975,0.34702643752098083,-0.20776112377643585,0.1464671641588211,0.09916985780000687},{0.07003466039896011,-0.23904116451740265,-0.021294573321938515,-0.25680097937583923,0.27776777744293213,-0.11875871568918228,-0.17315328121185303,-0.3066803514957428},{-0.22014069557189941,0.3014340400695801,0.031806640326976776,-0.0579463429749012,0.01855185069143772,0.28703710436820984,0.39295217394828796,0.3724605441093445},{0.034541357308626175,-0.01862616278231144,-0.2763952314853668,0.29368308186531067,0.29628750681877136,0.20110978186130524,0.26357564330101013,-0.2550211548805237},{-0.13329926133155823,-0.28772589564323425,0.34014400839805603,0.16267523169517517,0.0003851015353575349,-0.3428877294063568,-0.0699576735496521,-0.32157668471336365},{0.2907710671424866,0.08962733298540115,0.3627952039241791,0.3491159677505493,-0.15975946187973022,0.24940046668052673,0.12161263078451157,-0.36582887172698975},{-0.32327747344970703,0.17266640067100525,-0.36684712767601013,0.38659295439720154,-0.02723527140915394,0.34506553411483765,0.00103762187063694,0.2520739734172821},{0.02467932179570198,0.2192111760377884,-0.14227993786334991,-0.16075466573238373,0.041758935898542404,0.05555122718214989,0.3117157518863678,0.012787227518856525},{0.228793665766716,-0.2784651517868042,-0.32213664054870605,-0.20098936557769775,0.18413664400577545,-0.23062428832054138,0.19376057386398315,-0.05069383978843689},{-0.3770836889743805,-0.34842759370803833,-0.2279769778251648,0.01002330519258976,0.04664180800318718,0.1397443264722824,0.2643946409225464,0.011085709556937218},{-0.15868037939071655,-0.2667582631111145,0.19120974838733673,-0.33683890104293823,0.11116580665111542,0.022154802456498146,-0.41334059834480286,-0.18534013628959656},{0.06461048126220703,0.23349127173423767,0.08690447360277176,0.16423456370830536,-0.03202647343277931,0.3498566448688507,0.2977607548236847,-0.15028229355812073},{0.028761181980371475,-0.3286413550376892,-0.13532452285289764,-0.07371307164430618,-0.08378280699253082,-0.3426196873188019,0.08320263773202896,-0.23669938743114471},{-0.06614049524068832,0.001165106543339789,0.03326043486595154,-0.28215259313583374,0.10497087985277176,0.11757572740316391,0.16716723144054413,-0.03886063024401665},{0.06778369843959808,-0.08951371163129807,0.007819647900760174,-0.21830618381500244,0.029152922332286835,-0.02767811343073845,0.08862703293561935,-0.15800602734088898},{-0.3220542371273041,0.1639908403158188,0.12010762840509415,-0.2702347934246063,-0.4114561975002289,-0.012981434352695942,0.2564942538738251,0.0588778518140316},{0.2721865475177765,0.055801257491111755,-0.41064155101776123,0.03576038032770157,-0.014910529367625713,0.24024805426597595,0.306785523891449,0.3538517653942108},{-0.015270168893039227,-0.21752901375293732,-0.021371111273765564,0.1905582696199417,-0.2983146905899048,-0.020968353375792503,-0.11493024230003357,-0.2786504924297333},{0.15870510041713715,-0.052941154688596725,-0.43245023488998413,0.32890281081199646,-0.2725197374820709,-0.20496827363967896,-0.361236035823822,0.1615045964717865},{-0.01721949502825737,0.3100620210170746,-0.27714499831199646,-0.0754411444067955,0.13264644145965576,-0.1575939953327179,0.3520069122314453,-0.28801053762435913},{-0.12078370898962021,0.06254932284355164,-0.14446066319942474,-0.17358776926994324,0.08332508057355881,-0.11929099261760712,-0.06547985225915909,-0.13132014870643616},{0.07066554576158524,-0.19795094430446625,-0.010377485305070877,-0.10826188325881958,0.08163738995790482,0.06486009061336517,-0.18248862028121948,0.09771811962127686},{0.2610493004322052,0.03039291687309742,-0.33642077445983887,-0.23458002507686615,-0.19430020451545715,0.1446179747581482,0.23569901287555695,0.08496557921171188},{0.30055224895477295,-0.355139821767807,0.04420815035700798,-0.06714664399623871,0.14341413974761963,-0.10044565051794052,0.19936062395572662,0.3342437148094177},{-0.31109219789505005,-0.24686402082443237,0.04672129079699516,-0.33778223395347595,0.3054611384868622,-0.2426469624042511,0.017841624096035957,0.08438161015510559},{0.15231455862522125,0.09831775724887848,-0.11219972372055054,0.25298061966896057,0.03703386336565018,-0.025532200932502747,-0.00900295004248619,0.018156839534640312}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.24299564957618713,0.4468606412410736,-0.53251713514328,-0.5330221652984619,-0.20755398273468018,-0.022590622305870056,-0.41235029697418213,0.5650346279144287},{-0.054323162883520126,0.4953511655330658,-0.2800880968570709,0.614464282989502,-0.033116649836301804,0.005043156445026398,-0.32223811745643616,0.027148889377713203},{-0.385011225938797,-0.20819157361984253,-0.12700554728507996,-0.10412310808897018,0.47228845953941345,0.23557069897651672,-0.05676848068833351,0.41970422863960266},{-0.49974438548088074,-0.5324352979660034,0.3323664963245392,0.3364478051662445,-0.4855160713195801,-0.22662819921970367,0.42931702733039856,0.234323188662529},{-0.3154512643814087,-0.21895164251327515,-0.31430450081825256,-0.23259957134723663,0.3347560167312622,-0.2137317657470703,0.5296417474746704,-0.41613104939460754},{-0.008001239970326424,0.20691145956516266,0.20519694685935974,-0.5378051400184631,0.5181664228439331,-0.28994497656822205,-0.48700466752052307,-0.40186798572540283},{-0.3489919900894165,0.1802544742822647,0.0921720564365387,-0.49552059173583984,-0.028536297380924225,-0.522086501121521,0.5120137333869934,0.017546825110912323},{-0.39611902832984924,-0.20643028616905212,-0.14235374331474304,-0.33231136202812195,-0.34218770265579224,0.1426818072795868,0.5635849833488464,-0.3080158531665802}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.0009432376245968044,-0.12283547967672348,-0.13687074184417725,0.007786657195538282,0.09764764457941055,0.031661856919527054,0.0701323002576828,0.06465326994657516};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.05305067077279091,-0.06038734316825867,-0.029047589749097824,-0.10797376930713654,-0.08191598951816559,-0.08445527404546738,-0.02319011092185974,-0.14386481046676636};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

