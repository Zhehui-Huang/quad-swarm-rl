#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.24781113862991333,-0.08855712413787842,0.2779758870601654,0.1789868324995041,-0.3211868405342102,0.2647169232368469,-0.07440918684005737,-0.1446547955274582,0.1313546746969223,0.29998084902763367,0.10418419539928436,0.0598001629114151,0.248781219124794,-0.2807416617870331,0.254075288772583,-0.04566613584756851},{-0.16157275438308716,-0.4029346704483032,0.34398534893989563,0.15186022222042084,-0.30832168459892273,0.14623714983463287,-0.4093286395072937,-0.012661706656217575,-0.09681633114814758,-0.19814497232437134,0.05520350858569145,-0.2461738884449005,-0.0030268689151853323,-0.3066016435623169,-0.24300681054592133,0.08247312158346176},{-0.0009376847883686423,-0.25956448912620544,-0.3378123641014099,0.14895598590373993,0.20263880491256714,0.40888887643814087,0.060962896794080734,-0.045052070170640945,-0.02426234818994999,-0.36162084341049194,-0.37921246886253357,0.6545182466506958,-0.12050392478704453,-0.26396316289901733,-0.3226620554924011,0.21938835084438324},{0.12263410538434982,0.22194039821624756,0.384982705116272,-0.04133152589201927,-0.42214295268058777,-0.012052074074745178,0.27566227316856384,0.044901929795742035,0.31655120849609375,-0.4213946461677551,0.03562147542834282,0.39235007762908936,-0.26122304797172546,0.09402970224618912,0.4376448392868042,-0.45948246121406555},{-0.09809784591197968,-0.06050048768520355,0.34250620007514954,-0.011664263904094696,0.3411785960197449,0.4241063594818115,0.26102185249328613,-0.020663945004343987,0.1277584582567215,0.23107227683067322,0.2967011630535126,-0.3794151246547699,-0.33325299620628357,-0.3942909836769104,0.4707755744457245,0.05394387245178223},{-0.18540248274803162,-0.21877692639827728,-0.22973747551441193,-0.13596561551094055,0.1924617439508438,0.1673535257577896,0.04973481595516205,-0.14672031998634338,0.3760325014591217,-0.29125362634658813,-0.4033152163028717,0.2035004049539566,0.22202230989933014,-0.13511404395103455,-0.059566203504800797,0.06732502579689026},{0.03293885663151741,0.029697034507989883,0.06615179032087326,-0.41797900199890137,0.24162831902503967,0.0316343829035759,0.09461884945631027,0.425749808549881,0.3402854800224304,0.050043195486068726,-0.4234989285469055,0.007334390189498663,-0.11559305340051651,0.14006662368774414,-0.13682831823825836,-0.2558119595050812},{-0.23175713419914246,0.24053452908992767,0.26203158497810364,0.382997989654541,-0.45041200518608093,-0.0784514918923378,0.4212149381637573,0.43377968668937683,-0.16428405046463013,0.4253348410129547,-0.5553946495056152,-0.33651432394981384,0.34761378169059753,0.20575223863124847,0.2601028084754944,0.31123659014701843},{0.324980229139328,-0.23950296640396118,0.6116034388542175,0.11240160465240479,0.0779847651720047,0.08290623873472214,0.17934177815914154,-0.46633827686309814,-0.1409132331609726,-0.46011683344841003,-0.17211368680000305,-0.07348212599754333,-0.14106260240077972,0.5942179560661316,0.46798938512802124,-0.2416492998600006},{0.22447718679904938,-0.5928072929382324,-0.5002492070198059,-0.17840386927127838,-0.22755014896392822,0.2540895640850067,0.249559685587883,0.21503637731075287,0.5424755215644836,0.22881729900836945,0.039022296667099,-0.2936883270740509,-0.06678887456655502,0.3742750585079193,-0.09256908297538757,-0.49981412291526794},{0.20041874051094055,0.31942060589790344,0.43308213353157043,-0.569803774356842,-0.31198906898498535,0.1912313550710678,0.16774405539035797,0.4957418441772461,-0.3180162012577057,0.042664535343647,-0.1307900846004486,0.024947192519903183,-0.2622814476490021,-0.2223314642906189,0.35081449151039124,-0.36679717898368835},{-0.08543428033590317,-0.34619396924972534,0.15156109631061554,0.46119028329849243,0.6759702563285828,0.45630455017089844,0.3413594365119934,0.3078010380268097,0.013319899328052998,0.039651915431022644,0.24064575135707855,-0.33555153012275696,-0.542266309261322,-0.41428714990615845,0.5926457047462463,0.020683791488409042},{-0.2712165415287018,0.45329445600509644,-0.0012328203301876783,-0.6003926992416382,0.09366264939308167,0.00014630805526394397,0.14209574460983276,0.1587381213903427,0.08339925855398178,0.11298510432243347,0.024000871926546097,0.1507069617509842,0.4824041724205017,0.35754016041755676,-0.047843024134635925,-0.13629615306854248},{0.11219030618667603,-0.3569493293762207,-0.20478062331676483,-0.13272956013679504,-0.5404585599899292,-0.0019064329098910093,-0.16418124735355377,-0.25525882840156555,-0.2765648066997528,-0.11447679996490479,-0.4640359580516815,0.00017662084428593516,-0.19281969964504242,0.5579374432563782,0.25268474221229553,-0.017896952107548714},{0.01114550419151783,-0.34029337763786316,-0.29779160022735596,0.22250810265541077,-0.05272473394870758,-0.3058539927005768,0.26850050687789917,-0.07621476799249649,0.06043430045247078,0.2632348835468292,0.07695075869560242,0.14672298729419708,0.24440033733844757,-0.07773460447788239,-0.302583247423172,0.2594239115715027},{0.3484298288822174,-0.005442989058792591,-0.22881479561328888,-0.21656882762908936,-0.3468610644340515,0.22663554549217224,0.37256938219070435,-0.11403114348649979,0.2146473079919815,0.368831068277359,-0.15940316021442413,0.07594659924507141,-0.27133989334106445,0.2936239242553711,-0.11833328008651733,-0.017679309472441673},{-0.271407812833786,-0.21921953558921814,0.19951657950878143,0.17966020107269287,-0.24052804708480835,0.12327080219984055,-0.21702055633068085,-0.16513223946094513,-0.2199264019727707,-0.2762877345085144,-0.08963974565267563,-0.2849934995174408,0.11983166635036469,-0.26613849401474,0.00900579709559679,-0.2193944901227951},{-0.2506137192249298,0.20790548622608185,-0.37451380491256714,-0.2202099710702896,0.009559827856719494,0.3586704432964325,-0.22448144853115082,-0.2438485324382782,0.15571686625480652,0.19854196906089783,0.3529905378818512,-0.09414974600076675,-0.3697769045829773,0.32777971029281616,0.044106751680374146,-0.4133700430393219}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.0661071166396141,-0.023686256259679794,-0.11380089819431305,-0.3399195373058319,0.33745694160461426,0.3127966821193695,0.10050461441278458,0.04544587433338165,-0.12945564091205597,-0.13745318353176117,-0.04694443941116333,0.0899076908826828,0.18236005306243896,0.38375791907310486,0.08694189786911011,0.07373283803462982},{-0.23857481777668,-0.3023033142089844,-0.05137777328491211,0.10160084813833237,0.24972961843013763,-0.3346939980983734,0.0758448988199234,0.0641879290342331,-0.08787908405065536,0.24011242389678955,-0.2570137679576874,0.3120602071285248,-0.3568055033683777,0.2058512568473816,-0.4497072398662567,-0.3552582859992981},{0.10008669644594193,0.21731998026371002,-0.35842928290367126,-0.5040598511695862,0.14350734651088715,0.4972608983516693,-0.09189046174287796,0.06971469521522522,-0.2499813586473465,-0.30892664194107056,0.013415595516562462,0.3500269055366516,-0.31551042199134827,-0.24338194727897644,0.12419106811285019,-0.07654397934675217},{0.18336869776248932,-0.057442642748355865,0.08191728591918945,0.1987563669681549,-0.5159733295440674,-0.0016271276399493217,0.08503056317567825,-0.17824392020702362,0.30089086294174194,0.37823739647865295,-0.17873747646808624,-0.13793013989925385,-0.43919625878334045,-0.4237667918205261,0.1441366970539093,0.17819373309612274},{-0.1613009124994278,0.13930851221084595,-0.02920583449304104,0.23699311912059784,-0.26096054911613464,0.05878649652004242,0.00025237962836399674,0.1302056461572647,0.29582566022872925,-0.3203018307685852,0.18536517024040222,0.33008402585983276,0.1894855946302414,-0.4560803771018982,0.024962659925222397,-0.025974230840802193},{0.25729620456695557,0.2510470747947693,-0.055350665003061295,0.19484537839889526,-0.46657511591911316,-0.41975516080856323,0.220948725938797,0.272754043340683,0.1406356543302536,0.3455420136451721,0.22992968559265137,-0.20423291623592377,-0.03241834416985512,-0.1759292036294937,-0.01808379404246807,0.28263774514198303},{-0.08968383818864822,0.2743394374847412,0.2761729657649994,-0.3681451380252838,-0.25717195868492126,0.03433255851268768,-0.32300814986228943,-0.07234814018011093,0.17338982224464417,0.08142421394586563,-0.14200548827648163,-0.183451309800148,-0.3344514071941376,-0.03430076688528061,0.2224288284778595,0.05222225561738014},{-0.18668177723884583,-0.14363044500350952,-0.49778929352760315,0.28937074542045593,-0.3557785451412201,-0.24998116493225098,-0.24265283346176147,-0.4249453842639923,0.1413225531578064,-0.2920178771018982,0.03150951862335205,0.1482992321252823,-0.1809026449918747,0.42911067605018616,-0.07384740561246872,-0.3692907691001892},{-0.3151082396507263,0.2729036211967468,0.005940886680036783,-0.01575797237455845,0.27521538734436035,-0.253340482711792,0.3377906084060669,0.14606255292892456,0.32484954595565796,0.29717355966567993,0.2602244019508362,0.336757630109787,0.18517565727233887,-0.048561565577983856,0.27799782156944275,0.12107831239700317},{0.04142587259411812,-0.2735415995121002,-0.19758348166942596,-0.09377104789018631,0.28593578934669495,-0.18151375651359558,-0.2934011220932007,-0.1825077086687088,0.09488602727651596,-0.39682379364967346,-0.2902127802371979,0.379815936088562,0.12289602309465408,0.17872354388237,-0.37612786889076233,0.2344837784767151},{-0.09886137396097183,-0.44837215542793274,0.33803698420524597,0.2978164553642273,0.21755312383174896,0.16720211505889893,0.20428800582885742,-0.15353679656982422,0.25342100858688354,-0.31601276993751526,0.19206471741199493,0.4083794057369232,0.4939577877521515,0.09411496669054031,-0.14145609736442566,0.08324143290519714},{0.06551468372344971,3.4850669180741534e-05,0.3781924843788147,-0.00803820788860321,-0.24218431115150452,-0.15689076483249664,0.43852728605270386,0.27931833267211914,-0.2610098421573639,-0.21301567554473877,-0.1015404611825943,-0.29236114025115967,-0.03429359942674637,-0.27954748272895813,-0.4032042920589447,0.04628198221325874},{-0.10831796377897263,-0.3156556189060211,0.3959856927394867,-0.19692419469356537,0.3475314676761627,-0.33242255449295044,-0.4698784053325653,0.10202112048864365,0.08358874917030334,0.07402285933494568,-0.3330174684524536,0.11407577991485596,0.10025408864021301,-0.2674815356731415,-0.43021267652511597,-0.005856269039213657},{0.33346638083457947,-0.34501391649246216,0.4813278913497925,0.06429193913936615,-0.031937625259160995,0.3201492428779602,-0.11008171737194061,-0.24037624895572662,-0.4706606864929199,0.1253313422203064,-0.019139081239700317,-0.38010895252227783,-0.09138531237840652,0.18342585861682892,0.29254886507987976,0.031094448640942574},{-0.11054083704948425,0.23271329700946808,0.12582822144031525,-0.40803420543670654,-0.22570298612117767,0.20362599194049835,0.2971636950969696,-0.23882938921451569,0.1796116828918457,-0.3393685817718506,0.031245684251189232,0.10796427726745605,-0.06291823089122772,0.14719389379024506,-0.013309650123119354,0.08402569591999054},{-0.2558203935623169,0.3663698434829712,-0.4243955910205841,0.36826151609420776,0.1648913323879242,-0.4334842264652252,-0.04665060713887215,-0.08877398818731308,-0.3225032389163971,0.3501371741294861,-0.3695856034755707,0.31574270129203796,-0.05860585719347,-0.24967655539512634,-0.28159385919570923,-0.5284284949302673}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.19267988204956055,0.14113633334636688,-0.07119867950677872,-0.026876969262957573,-0.1377492994070053,0.05330144613981247,0.2771746814250946,0.07812224328517914,-0.22077469527721405,-0.1537405103445053,0.16156312823295593,-0.3181145191192627,-0.25217199325561523,0.22269481420516968,0.24607986211776733,0.3123161494731903,-0.275147944688797,-0.29924002289772034,-0.22139400243759155,0.07494533807039261,-0.06812279671430588,-0.30207228660583496,-0.2023281455039978,-0.3209511339664459,-0.3039453327655792,0.21084052324295044,-0.19845007359981537,0.001957518747076392,0.0004815832362510264,-0.04491490498185158,0.2237381488084793,-0.2219632863998413},{0.2740095555782318,0.20671717822551727,0.15735727548599243,-0.1324053853750229,0.1529308259487152,-0.07075976580381393,0.41497868299484253,0.15165667235851288,-0.19718602299690247,-0.10329693555831909,-0.0887073427438736,-0.30473223328590393,-0.18239803612232208,0.26804327964782715,-0.2232877016067505,-0.19862689077854156,-0.006923468317836523,0.2449435144662857,-0.3635631501674652,-0.23895363509655,-0.07715893536806107,0.2998899221420288,0.07536657899618149,-0.003445806447416544,0.20578297972679138,-0.35849836468696594,-0.027124304324388504,0.13789404928684235,0.17941880226135254,-0.14253073930740356,-0.006968819536268711,0.14966320991516113},{0.11534284800291061,0.021183954551815987,-0.191927969455719,0.14207202196121216,-0.19581326842308044,-0.2158210575580597,-0.20265738666057587,0.03425266221165657,-0.14399944245815277,0.4484546482563019,-0.31350234150886536,-0.30694347620010376,0.09171516448259354,-0.39080360531806946,-0.1911553293466568,0.11320938169956207,-0.1686227023601532,-0.15391720831394196,0.13315525650978088,-0.11246918886899948,0.2716901898384094,0.27457377314567566,-0.23528990149497986,0.023926813155412674,-0.2890475392341614,0.026602160185575485,0.11889178305864334,-0.13301433622837067,-0.011686011217534542,-0.29625722765922546,-0.19731950759887695,-0.07275404036045074},{0.45136141777038574,0.038986485451459885,0.18044830858707428,-0.13933686912059784,-0.28084734082221985,-0.06032736599445343,-0.20212113857269287,0.30204811692237854,0.27009397745132446,-0.3387831747531891,-0.08196856826543808,0.36018696427345276,0.11281488090753555,-0.09679874032735825,-0.2254277914762497,0.2708720266819,-0.29705914855003357,0.2239311784505844,0.07034220546483994,0.13025560975074768,-0.05087460204958916,-0.15753638744354248,0.2869803309440613,0.16383951902389526,0.2105521410703659,-0.4128568768501282,0.28814542293548584,-0.23241490125656128,-0.07610952109098434,0.1647186130285263,-0.2006714642047882,0.18397589027881622},{-0.05771802365779877,-0.1041613221168518,-0.11428951472043991,0.1669495850801468,0.19432736933231354,-0.2307840883731842,-0.4503474831581116,-0.09764363616704941,-0.06867653131484985,-0.25016137957572937,0.09700798243284225,0.26377928256988525,-0.014261983335018158,-0.15437868237495422,-0.11177846044301987,0.11185713857412338,-0.08807200193405151,-0.1073901355266571,-0.32063010334968567,-0.18559999763965607,-0.07666516304016113,-0.45421209931373596,0.15533757209777832,0.17021025717258453,-0.12154152244329453,0.36355772614479065,-0.19709420204162598,0.12190134078264236,0.3732624053955078,0.39114734530448914,-0.11723155528306961,0.43360981345176697},{-0.36925819516181946,0.03198651969432831,-0.31017860770225525,-0.08352150768041611,-0.24115759134292603,0.2731076776981354,0.24726462364196777,0.01463259756565094,0.19764284789562225,0.29920458793640137,0.3635515868663788,-0.29577019810676575,-0.3203408420085907,0.17957141995429993,0.37058746814727783,-0.32493236660957336,-0.16067220270633698,-0.2606748640537262,0.18564631044864655,0.10424946993589401,0.07468144595623016,0.22482047975063324,0.11107204854488373,-0.09923059493303299,-0.42502352595329285,0.425295889377594,-0.1304965615272522,0.23912039399147034,0.3909923732280731,0.10885974764823914,0.04733649268746376,-0.0014564357697963715},{0.16054585576057434,-0.12825869023799896,-0.15646861493587494,-0.35522010922431946,-0.06055626645684242,0.22436115145683289,0.337503582239151,0.17065145075321198,0.046051278710365295,0.42291781306266785,-0.006056297104805708,-0.04481607303023338,-0.4523311257362366,-0.15948131680488586,-0.1448884904384613,0.15698356926441193,-0.3222751021385193,-0.23545311391353607,0.18594054877758026,-0.07233485579490662,-0.1268814504146576,-0.12624087929725647,-0.20623353123664856,-0.22358213365077972,0.12905685603618622,-0.2360410988330841,-0.08611440658569336,-0.2296302616596222,0.3099621832370758,0.05462665483355522,-0.2020614594221115,-0.31187915802001953},{0.02801433578133583,0.17198917269706726,0.049787841737270355,-0.06093911454081535,0.12813116610050201,-0.336660236120224,-0.08370658755302429,-0.16752208769321442,-0.03352797403931618,-0.20795054733753204,-0.3291984796524048,-0.08363097161054611,-0.11063602566719055,0.019743768498301506,-0.14208024740219116,0.4180532991886139,-0.03664613515138626,-0.16571320593357086,0.08917278796434402,0.34124326705932617,-0.13151904940605164,-0.22319722175598145,0.2746333181858063,0.11236968636512756,-0.03270932286977768,-0.33614253997802734,-0.323934942483902,-0.3092776834964752,-0.34807536005973816,-0.2978300154209137,0.033319275826215744,-0.339682400226593},{0.12185261398553848,0.4077405035495758,-0.26524168252944946,-0.38820645213127136,-0.2474670559167862,0.14973367750644684,0.07587454468011856,0.14504878222942352,0.03936746343970299,-0.31375613808631897,-0.1200563833117485,0.3376665711402893,-0.29466843605041504,-0.17383381724357605,0.23015764355659485,-0.2399091273546219,0.2904636263847351,0.19387304782867432,0.41050055623054504,0.05619679391384125,0.13738715648651123,0.1575850397348404,0.30569887161254883,-0.1274784654378891,0.4251004159450531,-0.2828243672847748,0.18609052896499634,0.39568042755126953,-0.30860644578933716,0.20832125842571259,0.0719449445605278,0.1129297986626625},{-0.1756894588470459,0.08514660596847534,-0.2735637426376343,-0.14164593815803528,0.17612037062644958,-0.22002889215946198,0.10049426555633545,-0.02248462848365307,0.197372704744339,-0.006864819675683975,-0.3233487606048584,-0.31463757157325745,-0.3258032202720642,-0.07062531262636185,-0.28278130292892456,0.10550849139690399,0.024007810279726982,-0.23663564026355743,0.20826967060565948,0.11078844964504242,0.04985244199633598,-0.058658942580223083,0.282748818397522,-0.1628616452217102,0.30948856472969055,0.10976311564445496,-0.29224076867103577,-0.030985336750745773,-0.02228117734193802,0.10759855806827545,-0.185186505317688,0.08502168953418732},{0.10168871283531189,0.10566890239715576,0.16221903264522552,-0.3072713017463684,-0.40767449140548706,-0.2070915549993515,-0.2750653028488159,0.055010829120874405,-0.33670946955680847,0.4814530313014984,0.22495940327644348,-0.2216005027294159,-0.456594854593277,-0.10802679508924484,-0.12763628363609314,-0.09151896834373474,0.1570054441690445,-0.1827065795660019,0.3182457685470581,-0.13481353223323822,-0.18148605525493622,0.047442302107810974,0.27176323533058167,0.19654220342636108,0.16611644625663757,-0.17319455742835999,0.07170537859201431,-0.05764002352952957,-0.038419079035520554,0.00220667221583426,-0.017268532887101173,0.11903751641511917},{-0.1500684916973114,-0.09116774797439575,0.247825488448143,0.26726052165031433,0.2783373296260834,0.005916982423514128,0.060931749641895294,-0.18990395963191986,-0.06786014139652252,-0.30685853958129883,0.2888423502445221,-0.19713690876960754,-0.17915011942386627,-0.19701896607875824,0.27248457074165344,4.313691533752717e-05,0.026828346773982048,0.046180158853530884,0.40991875529289246,0.07785280048847198,-0.20715241134166718,0.24695609509944916,0.1100439801812172,-0.0752125084400177,0.26561078429222107,-0.14051784574985504,-0.14110250771045685,0.24334409832954407,0.14076891541481018,0.04466281086206436,-0.24474726617336273,-0.23553447425365448},{0.35965636372566223,-0.22914299368858337,0.02211836911737919,-0.2699976861476898,-0.0786752849817276,-0.17384988069534302,0.02445942908525467,0.20049256086349487,0.18510644137859344,0.06998001039028168,0.21878118813037872,0.35022497177124023,-0.4300764203071594,-0.4526500701904297,0.013298531994223595,-0.251177042722702,-0.30422767996788025,-0.3805314600467682,0.40380561351776123,-0.19488085806369781,0.4129631519317627,-0.15875156223773956,0.08224952220916748,0.1619023084640503,0.15137438476085663,-0.1678484082221985,0.1828334778547287,0.004126790910959244,0.14102143049240112,0.06449316442012787,-0.29173222184181213,0.06850816309452057},{0.2514948844909668,-0.047515638172626495,-0.016883257776498795,0.3875262439250946,-0.09776792675256729,-0.19791992008686066,-0.048318661749362946,0.14844651520252228,0.20437826216220856,0.26775074005126953,0.11519473046064377,-0.10663866251707077,0.06093686446547508,0.20203466713428497,-0.11686044186353683,0.10131879895925522,0.21905408799648285,-0.24423618614673615,0.1012457013130188,-0.3612961769104004,0.2926899492740631,0.13327418267726898,-0.09826921671628952,0.20356382429599762,0.24044394493103027,0.0938986986875534,0.13636857271194458,0.05911639332771301,0.09597048908472061,-0.14366091787815094,-0.0038357211742550135,0.38477808237075806},{0.01720329187810421,-0.17398904263973236,-0.0714455172419548,0.0863511711359024,-0.3013358414173126,0.04822224751114845,0.07481197267770767,-0.21313734352588654,-0.2276766002178192,-0.0015057554701343179,0.22831770777702332,0.15280337631702423,0.02716565504670143,0.23990724980831146,-0.0028095135930925608,-0.040244199335575104,-0.2220659703016281,0.29145824909210205,-0.09301872551441193,-0.23845872282981873,-0.23414665460586548,-0.032936789095401764,0.1936998963356018,0.012162993662059307,-0.04969692602753639,-0.09969280660152435,-0.15623462200164795,0.27234745025634766,0.09046436846256256,-0.1942300945520401,0.28297021985054016,0.11983714252710342},{0.16855064034461975,-0.1845843344926834,-0.01892918534576893,-0.2047862857580185,-0.04434740170836449,0.16783909499645233,0.07132591307163239,0.28942084312438965,-0.15939876437187195,0.0068996562622487545,0.2619454860687256,0.10228241980075836,0.03023933619260788,-0.10324632376432419,0.007901874370872974,0.21861833333969116,-0.3753625154495239,-0.2090061604976654,-0.03329627588391304,0.06441876292228699,0.03574676439166069,0.27748239040374756,0.20480404794216156,0.1587611734867096,0.0461067333817482,0.18192647397518158,2.653303454280831e-05,-0.046691250056028366,0.12167137861251831,-0.1404961198568344,-0.25638145208358765,0.30049195885658264},{0.11334724724292755,0.006397578399628401,-0.36667773127555847,0.2020949423313141,0.08773709088563919,-0.011099961586296558,0.2901630997657776,0.034604139626026154,0.13000062108039856,-0.1553618609905243,0.21090173721313477,-0.2506278157234192,-0.4177481234073639,0.26736170053482056,0.09314091503620148,-0.006779846735298634,0.0400833860039711,-0.10897471755743027,-0.18017138540744781,-0.018298353999853134,-0.029606685042381287,0.20400360226631165,0.059913113713264465,-0.20691758394241333,-0.1308564841747284,-0.14996743202209473,0.035280000418424606,0.35700690746307373,0.2674112319946289,-0.16398651897907257,0.19458501040935516,0.22357584536075592},{-0.07795185595750809,-0.01788441278040409,-0.08664856851100922,-0.07590701431035995,-0.23053593933582306,-0.017174243927001953,0.23681411147117615,0.1694835126399994,0.15230409801006317,-0.004777026362717152,0.19552229344844818,-0.02374940924346447,0.2187487930059433,0.2221105992794037,0.16814957559108734,-0.0905257910490036,0.14096377789974213,0.2019326090812683,0.2100917100906372,0.032182477414608,0.1618356704711914,0.2844628095626831,0.06780825555324554,0.1527499556541443,-0.025204163044691086,-0.05900169536471367,-0.14649677276611328,-0.22216978669166565,0.13529865443706512,-0.27313604950904846,0.056710220873355865,-0.0700819343328476},{-0.3748975694179535,0.026738552376627922,-0.38892707228660583,-0.30509111285209656,0.03573564067482948,-0.010311232879757881,0.1377355009317398,-0.21669825911521912,0.06727579236030579,0.37651699781417847,0.02464321255683899,-0.264591783285141,0.039081405848264694,-0.1863081008195877,-0.3161138892173767,-0.01735922507941723,-0.1890554577112198,0.10012518614530563,-0.1153656467795372,-0.048967838287353516,-0.2822701930999756,0.1543600857257843,0.10796524584293365,0.0403372086584568,-0.11297161132097244,0.3843955099582672,0.04727160185575485,-0.20675064623355865,-0.16811339557170868,-0.0022438722662627697,-0.22312259674072266,-0.2447793036699295},{0.0014162217266857624,-0.2593965530395508,-0.269966185092926,-0.04708091914653778,-0.30740228295326233,-0.15126070380210876,0.18018381297588348,-0.27875155210494995,-0.22127275168895721,0.17100155353546143,0.1767074316740036,0.09294050931930542,0.12286607176065445,-0.13543586432933807,0.2702820599079132,-0.2496434450149536,0.10691094398498535,0.26660796999931335,0.04006655886769295,0.2878752052783966,0.014546102844178677,-0.11222492158412933,-0.2982572615146637,0.2391536831855774,-0.1089450940489769,-0.1606738418340683,0.11057818681001663,0.0406130850315094,-0.1287539303302765,-0.3241863548755646,-0.03928119316697121,-0.19193366169929504},{0.22090306878089905,0.12430963665246964,-0.09249116480350494,0.23617255687713623,-0.28993040323257446,0.05901557207107544,-0.10986022651195526,-0.2178453654050827,-0.10006048530340195,0.26865044236183167,-0.33670753240585327,-0.13404783606529236,0.009438193403184414,-0.24611710011959076,-0.3743912875652313,-0.2123323678970337,-0.16590657830238342,-0.36864638328552246,-0.2713205814361572,0.2504795789718628,0.20642884075641632,0.04817580431699753,-0.3502480685710907,0.3357964754104614,0.12049679458141327,0.3032369017601013,-0.30660611391067505,-0.15536530315876007,0.12699051201343536,-0.22875487804412842,0.05574912577867508,0.18488413095474243},{-0.054860007017850876,-0.3050447404384613,-0.03463549166917801,-0.3102489411830902,-0.04051223769783974,0.29682210087776184,0.21199144423007965,0.026233244687318802,-0.09698896110057831,0.005932941101491451,-0.18269678950309753,0.09309244155883789,0.11296875774860382,0.08559403568506241,0.10376537591218948,0.05430193245410919,-0.05695830285549164,0.15999503433704376,-0.12963560223579407,0.16043783724308014,0.18129749596118927,0.2692457139492035,-0.05993451178073883,-0.23411867022514343,0.1666795313358307,0.1635231375694275,0.2601604759693146,0.1715909242630005,0.012538290582597256,0.10344288498163223,0.014085795730352402,-0.11491908878087997},{0.0375138558447361,-0.23264433443546295,0.2953905761241913,0.010993718169629574,0.3076375126838684,-0.07114999741315842,-0.12019092589616776,-0.16772755980491638,0.1648673713207245,-0.04980229213833809,0.028605040162801743,0.026218488812446594,-0.2268228977918625,0.07316473126411438,-0.14009632170200348,-0.2505229413509369,-0.05470435693860054,-0.03472646325826645,0.1899518519639969,0.2624356150627136,0.032145433127880096,0.020546965301036835,0.13598133623600006,0.3640039563179016,-0.13027425110340118,-0.10107903182506561,0.1394873708486557,-0.11713182926177979,-0.20043163001537323,-0.2448035329580307,0.28384488821029663,-0.015869617462158203},{0.20763476192951202,-0.09071974456310272,0.0654534101486206,0.10726214945316315,-0.019089533016085625,0.05794985219836235,-0.24084292352199554,0.3217000663280487,-0.10518814623355865,-0.0496373176574707,0.11109350621700287,-0.2903490662574768,0.043169524520635605,-0.052176181226968765,-0.12274044752120972,0.35321274399757385,-0.0623241625726223,-0.17958368360996246,0.03611843287944794,0.020874004811048508,-0.18980129063129425,0.1852007359266281,0.19993871450424194,0.24859146773815155,-0.24990074336528778,0.10849420726299286,-0.06926096230745316,0.08567126095294952,-0.29543066024780273,0.2700885236263275,-0.048447057604789734,0.03635472059249878}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.28984537720680237,-0.15360499918460846,0.1785127967596054,-0.21664682030677795},{0.22241221368312836,-0.28029122948646545,0.2877195179462433,0.2590433359146118},{-0.4201689660549164,0.021498067304491997,0.2156262993812561,-0.04439469054341316},{0.3000415861606598,0.5557202100753784,0.3552420735359192,0.012704544700682163},{-0.3700045347213745,0.23266823589801788,-0.3068491518497467,0.1174003854393959},{0.0025850727688521147,-0.16068561375141144,0.060369040817022324,0.4895658493041992},{-0.09743300080299377,-0.21674491465091705,-0.49512773752212524,0.08848351985216141},{-0.12272850424051285,-0.4032514989376068,0.2154259830713272,-0.049584727734327316},{-0.15981455147266388,0.2226123809814453,-0.07584667950868607,-0.14909134805202484},{0.39974725246429443,-0.026164067909121513,-0.20351667702198029,-0.27744168043136597},{0.2714028060436249,-0.24932807683944702,0.37272393703460693,0.3563636541366577},{-0.14187327027320862,-0.009872050024569035,0.5607397556304932,-0.13134148716926575},{-0.40815630555152893,0.30442190170288086,-0.054742634296417236,-0.1025555208325386},{-0.20994213223457336,0.02377934940159321,-0.2973543405532837,0.14603590965270996},{0.19613854587078094,-0.08219270408153534,0.25744983553886414,0.18295788764953613},{-0.1494869589805603,-0.29897862672805786,-0.14699600636959076,-0.11579534411430359},{-0.44730526208877563,0.06940782070159912,-0.06691058725118637,0.39892908930778503},{-0.39516744017601013,-0.15840089321136475,-0.2559049427509308,0.2888926863670349},{-0.10345838963985443,-0.22016777098178864,0.4974537789821625,0.06853585690259933},{-0.19813862442970276,-0.20128145813941956,-0.025740547105669975,-0.20668375492095947},{0.20388491451740265,0.1577402949333191,0.1732306182384491,-0.252471387386322},{-0.015022574923932552,-0.3620281517505646,-0.23757490515708923,0.42485830187797546},{0.31538480520248413,-0.22660242021083832,0.24776668846607208,0.07517905533313751},{-0.3571200966835022,-0.07685210555791855,-0.2720066010951996,-0.4175332486629486},{-0.33029720187187195,-0.2379496991634369,0.0794469341635704,-0.124805748462677},{0.32442507147789,0.28835517168045044,-0.14699865877628326,0.11935945600271225},{0.1581946313381195,-0.21938802301883698,0.3003414273262024,0.10313913971185684},{-0.06840598583221436,-0.19726242125034332,0.008819790557026863,0.42288631200790405},{0.2008935958147049,0.08079691976308823,0.047400426119565964,0.0342220701277256},{-0.22361402213573456,0.11613928526639938,0.36648139357566833,0.009496528655290604},{-0.2114638388156891,-0.1580943763256073,0.05770489573478699,0.30626580119132996},{0.25449609756469727,0.2542341947555542,0.3628116250038147,-0.0667981281876564}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.012388248927891254,-0.012968317605555058,0.0029375043231993914,0.0575522817671299,0.03180140256881714,-0.06754684448242188,-0.02111230604350567,0.07505502551794052,-0.08787061274051666,-0.04405757039785385,0.0038393044378608465,-0.02513694018125534,-0.042805008590221405,0.061126988381147385,-0.015688160434365273,-0.04174857959151268};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0033264325466006994,-0.009884187951683998,-0.015766652300953865,0.007826806046068668,-0.047576915472745895,0.03385176509618759,-0.029599882662296295,-0.01820007897913456,0.03487315773963928,-0.0536779947578907,0.014298253692686558,-0.01200842298567295,-0.011049002408981323,-0.035356104373931885,0.022605234757065773,-0.03785794973373413};
static const float actor_encoder_feed_forward_0_bias[32] = {0.016505254432559013,0.03587064519524574,-0.008206655271351337,0.0018599816830828786,-0.017623450607061386,0.022631021216511726,-0.03438243642449379,-0.005024679005146027,0.0006635191384702921,-0.032207462936639786,-0.001545931096188724,0.03341003134846687,0.02542281150817871,0.008043528534471989,0.03607812523841858,-0.05386727675795555,0.011556264013051987,-0.005819317884743214,0.025954412296414375,-0.027401061728596687,-0.013000515289604664,0.012823792174458504,-0.0068969265557825565,-0.03657892346382141,-0.03495502844452858,0.0030949704814702272,0.017948850989341736,0.02493475377559662,-0.024585234001278877,0.03720104321837425,0.039410002529621124,-0.0034784451127052307};
static const float action_parameterization_distribution_linear_bias[4] = {-0.00896681472659111,0.01697278581559658,0.015455187298357487,0.02586551383137703};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.36048978567123413,-0.3328976035118103,-0.18957918882369995,0.15896674990653992,-0.2850683331489563,0.0872330442070961,-0.3122546672821045,0.012656633742153645},{0.20650538802146912,0.16457948088645935,0.37668171525001526,0.35551774501800537,-0.17006665468215942,-0.38445186614990234,0.33471110463142395,0.41777434945106506},{0.08021791279315948,0.2217385321855545,0.10916081815958023,-0.052985500544309616,0.31819865107536316,0.18737448751926422,0.024177616462111473,0.28631162643432617},{0.10432363301515579,-0.32076704502105713,0.3353251516819,-0.18495385348796844,-0.23505790531635284,0.09010627865791321,0.34424474835395813,0.283902108669281},{-0.2818967401981354,-0.0620562881231308,-0.05313640460371971,-0.31472232937812805,0.14624787867069244,0.1290358603000641,0.36737334728240967,0.29800617694854736},{-0.08687601238489151,0.22904449701309204,-0.01770506426692009,-0.25599947571754456,0.34840720891952515,0.12495806068181992,0.12994544208049774,-0.1505628377199173},{-0.008752712048590183,0.21745821833610535,0.12437275052070618,-0.20087485015392303,0.43793898820877075,-0.11938685923814774,0.1888062059879303,0.12200146168470383},{0.08116642385721207,-0.34495243430137634,-0.0777667760848999,-0.2827093303203583,0.2656424343585968,-0.014109151437878609,-0.13128215074539185,-0.2990531325340271},{-0.25821730494499207,0.21844977140426636,-0.07753141224384308,-0.15038707852363586,-0.08024192601442337,0.4129692614078522,0.39004796743392944,0.26534536480903625},{0.00033544530742801726,-0.10454439371824265,-0.32410377264022827,0.22523057460784912,0.23406288027763367,0.30352717638015747,0.3652530312538147,-0.3332534730434418},{-0.16101405024528503,-0.35751229524612427,0.328120619058609,0.139033704996109,-0.020320404320955276,-0.26750922203063965,0.07775140553712845,-0.3384184241294861},{0.23428791761398315,0.060454003512859344,0.3662140369415283,0.3684907853603363,-0.14868542551994324,0.3186257779598236,0.26570582389831543,-0.33925700187683105},{-0.39354604482650757,0.15840254724025726,-0.38433679938316345,0.4033806324005127,-0.04953373596072197,0.41670727729797363,0.09175524115562439,0.2685750722885132},{-0.05030641704797745,0.20887473225593567,-0.15752117335796356,-0.13055403530597687,-0.0017971750348806381,0.10645432025194168,0.3886958956718445,0.03543112799525261},{0.13859723508358002,-0.3000330924987793,-0.35383906960487366,-0.1686922311782837,0.13808570802211761,-0.21496367454528809,0.2117210328578949,-0.04316304996609688},{-0.43838369846343994,-0.30894210934638977,-0.23787346482276917,0.020813874900341034,0.0070617650635540485,0.1711696833372116,0.3131994307041168,-0.005132228601723909},{-0.14875063300132751,-0.28285151720046997,0.2594512403011322,-0.3354490101337433,0.03818324953317642,-0.007631602231413126,-0.3433649241924286,-0.2010255604982376},{0.06359633803367615,0.21682651340961456,0.16998757421970367,0.1906953752040863,-0.08209960162639618,0.3279011845588684,0.361987829208374,-0.15326349437236786},{0.059440936893224716,-0.3448837995529175,-0.05867884308099747,-0.0814838856458664,-0.13639876246452332,-0.34202101826667786,0.12841753661632538,-0.2723775804042816},{-0.040712516754865646,-0.01063532568514347,0.13738156855106354,-0.33342599868774414,0.055318884551525116,0.12099585682153702,0.16544027626514435,-0.09903871268033981},{0.08155706524848938,-0.11965162307024002,0.0937003344297409,-0.28905317187309265,0.0010308120399713516,0.005294309463351965,0.07007651776075363,-0.22745706140995026},{-0.33389854431152344,0.17472310364246368,0.17914420366287231,-0.2634415626525879,-0.46286824345588684,0.026974761858582497,0.2465214729309082,0.02469143457710743},{0.2664090096950531,0.08995717763900757,-0.3559630811214447,0.10951387882232666,-0.034629810601472855,0.25507062673568726,0.35591113567352295,0.3202436864376068},{-0.028568100184202194,-0.16381563246250153,0.06154603511095047,0.3013981580734253,-0.27146726846694946,-0.020996736362576485,-0.03996973857283592,-0.2960423529148102},{0.20748156309127808,0.07782885432243347,-0.4011646807193756,0.3351462781429291,-0.271626740694046,-0.33093398809432983,-0.2776009142398834,0.21305084228515625},{0.04313626140356064,0.3628341853618622,-0.27752843499183655,-0.06915511190891266,0.09180951863527298,-0.24290001392364502,0.38882631063461304,-0.25941264629364014},{-0.07301709800958633,0.0763377994298935,-0.15886043012142181,-0.1695665866136551,0.024542031809687614,-0.18159793317317963,-0.03925633803009987,-0.11932323127985},{0.14739058911800385,-0.18052400648593903,-0.04836765304207802,-0.11138741672039032,0.010787558741867542,0.01063526887446642,-0.14260652661323547,0.1182132288813591},{0.3625100255012512,0.04053579270839691,-0.38532495498657227,-0.20075330138206482,-0.2388455718755722,0.10937147587537766,0.2866327464580536,0.11286802589893341},{0.4011889100074768,-0.32217615842819214,-0.013057021424174309,-0.04548580199480057,0.13277488946914673,-0.1207837462425232,0.26406827569007874,0.3765518069267273},{-0.27922096848487854,-0.20086652040481567,0.04581848904490471,-0.28735649585723877,0.33177879452705383,-0.22619502246379852,0.11440972238779068,0.0815398097038269},{0.10737612843513489,-0.02992483228445053,-0.1565995216369629,0.267181396484375,0.05257411301136017,0.06906913965940475,0.02500874176621437,-0.03288758918642998}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23605836927890778,0.44344228506088257,-0.6128312349319458,-0.5091745853424072,-0.32318902015686035,0.0496966652572155,-0.4605094790458679,0.5358178615570068},{-0.022210588678717613,0.5379937291145325,-0.208010733127594,0.5815905332565308,-0.007045010570436716,0.08499308675527573,-0.2362849861383438,0.07113071531057358},{-0.4600602984428406,-0.20785854756832123,-0.1574288010597229,-0.17339764535427094,0.5456697940826416,0.22271761298179626,0.0356132872402668,0.4911632537841797},{-0.4694841504096985,-0.483874648809433,0.3727874159812927,0.3477337658405304,-0.5276733636856079,-0.17857837677001953,0.5167709589004517,0.26437991857528687},{-0.33403661847114563,-0.28224578499794006,-0.3429271876811981,-0.24932777881622314,0.33642926812171936,-0.27479392290115356,0.5455183982849121,-0.4289920926094055},{-0.04091818258166313,0.20490241050720215,0.33588308095932007,-0.6198399662971497,0.521804690361023,-0.32353872060775757,-0.4654192328453064,-0.33797627687454224},{-0.42481955885887146,0.18929243087768555,0.07957811653614044,-0.42619380354881287,-0.040337346494197845,-0.5688709020614624,0.4953065812587738,0.011264976114034653},{-0.4389660954475403,-0.26095154881477356,-0.228122279047966,-0.3486730754375458,-0.3476163446903229,0.16806206107139587,0.6002333164215088,-0.34204596281051636}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03651507943868637,-0.03179614990949631,-0.010190796107053757,-0.0007667765021324158,-0.032037608325481415,-0.005241116508841515,0.0057875788770616055,0.043316833674907684};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.001672539277933538,-0.01656951569020748,-0.006480667740106583,-0.003977473825216293,-0.04179532825946808,0.007699331734329462,-0.04472002014517784,-0.014060537330806255};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

