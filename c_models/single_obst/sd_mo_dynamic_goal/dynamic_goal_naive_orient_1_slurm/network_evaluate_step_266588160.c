#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.29286932945251465,0.030531596392393112,-0.1113443449139595,0.30553537607192993,0.2892453968524933,-0.1907707005739212,-0.2568959593772888,0.1083560511469841,0.2919676601886749,-0.3121374845504761,0.557292103767395,-0.043298687785863876,0.28538981080055237,0.1427464783191681,-0.3990948796272278,0.03848080337047577},{-0.23277759552001953,-0.26727908849716187,-0.2845892906188965,-0.20163075625896454,0.09295003861188889,0.3150196969509125,0.07270876318216324,0.11185628175735474,0.22861389815807343,0.1784631907939911,-0.15339747071266174,-0.06151607632637024,-0.13701152801513672,0.0660238042473793,0.3321864604949951,-0.29277971386909485},{0.13794194161891937,0.21696321666240692,0.20490363240242004,0.32160839438438416,-0.09347720444202423,-0.20309489965438843,0.4206000566482544,-0.031243683770298958,0.007405129726976156,-0.09104220569133759,-0.0772756040096283,-0.007714139297604561,0.07077202945947647,0.4173307418823242,-0.2613380551338196,-0.09548455476760864},{0.1442018300294876,-0.15281175076961517,-0.13004988431930542,-0.15241874754428864,0.05503705143928528,0.08048543334007263,0.06847207248210907,-0.19758307933807373,-0.12802572548389435,0.15325024724006653,0.5020099878311157,-0.2502424120903015,-0.18990503251552582,-0.15596817433834076,0.20334705710411072,0.09359949082136154},{-0.3044089376926422,0.008853125385940075,0.12860484421253204,-0.22400353848934174,0.2684296667575836,0.3410373330116272,0.1388164460659027,-0.19954326748847961,-0.1406916081905365,0.13796167075634003,-0.13932467997074127,-0.3902248740196228,-0.04334120824933052,-0.16787071526050568,0.289482057094574,-0.040770865976810455},{0.02283562533557415,-0.03635891154408455,-0.0027844079304486513,-0.04782246798276901,0.12338133156299591,-0.15242546796798706,0.41418811678886414,-0.3218507766723633,-0.1299959421157837,-0.15727292001247406,0.2928427755832672,0.053244203329086304,0.24519117176532745,0.04655586928129196,0.2842028737068176,0.26982221007347107},{-0.24186450242996216,0.1855798065662384,-0.12340226024389267,0.03297789767384529,-0.23620565235614777,-0.11445000022649765,-0.16521939635276794,-0.03609403595328331,0.1757451891899109,0.36031290888786316,-0.2897312641143799,-0.11206718534231186,0.2341647744178772,0.09019415080547333,-0.20355075597763062,0.3385978043079376},{-0.12103687971830368,0.01045980304479599,-0.12607471644878387,-0.18279573321342468,0.37193650007247925,-0.2670276463031769,-0.27520987391471863,-0.41932612657546997,-0.11453325301408768,-0.21297000348567963,0.3493379056453705,-0.02986840531229973,0.18374045193195343,0.18729592859745026,-0.19446809589862823,0.3803875148296356},{0.23234786093235016,0.07496260851621628,0.018028242513537407,0.0660947635769844,-0.3868650496006012,-0.4497487545013428,0.33085209131240845,-0.33044692873954773,-0.18035198748111725,0.19764047861099243,0.16408491134643555,-0.30191826820373535,-0.16475100815296173,0.036350712180137634,0.15247192978858948,-0.022044532001018524},{0.42524221539497375,-0.5612826347351074,-0.12535744905471802,-0.029393907636404037,0.1806003600358963,-0.2032652497291565,-0.26317673921585083,-0.1801513135433197,-0.15872739255428314,-0.05313046649098396,-0.012423904612660408,-0.19534149765968323,0.3657470643520355,-0.13600072264671326,-0.5027859807014465,-0.1628030687570572},{0.199786975979805,0.19987812638282776,-0.350462943315506,0.10333391278982162,-0.021181782707571983,-0.26934248208999634,-0.15097486972808838,0.10724072903394699,-0.1429748833179474,0.16930150985717773,0.14286883175373077,0.2555101811885834,-0.12114071846008301,0.24764150381088257,-0.08514492213726044,-0.20909340679645538},{-0.40460580587387085,0.25329136848449707,0.25459393858909607,-0.26906752586364746,-0.3164023160934448,0.3058168888092041,0.04460121691226959,0.31886833906173706,0.18906737864017487,0.16468800604343414,0.271987646818161,-0.09056980907917023,0.13966546952724457,-0.05862586945295334,-0.0851871520280838,-0.14977598190307617},{0.11955180764198303,-0.26330941915512085,-0.19169491529464722,0.23060645163059235,-0.1989469975233078,-0.2690276503562927,-0.1453767865896225,0.2771730124950409,0.3229573369026184,-0.14782460033893585,-0.12334969639778137,0.06507433950901031,0.29688945412635803,0.1395432949066162,-0.18330906331539154,0.3187098205089569},{0.28936174511909485,0.19328509271144867,-0.1570049375295639,-0.09816902875900269,0.09075944125652313,-0.06856931746006012,-0.09438081085681915,0.32757434248924255,-0.23674805462360382,-0.18964411318302155,-0.1605387181043625,0.01100949477404356,-0.2281762808561325,-0.13358698785305023,-0.23780977725982666,-0.04858464002609253},{0.16292819380760193,0.3551771640777588,0.41527968645095825,-0.3854001760482788,-0.3895120918750763,0.06018070504069328,0.05583028122782707,-0.11762747913599014,0.36818572878837585,0.3719024062156677,-0.206149160861969,0.1050926223397255,-0.033297307789325714,-0.33667856454849243,0.01672663912177086,-0.12310890108346939},{-0.16973941028118134,-0.20151683688163757,-0.12613138556480408,0.4093688726425171,-0.23185141384601593,-0.14224117994308472,-0.24264384806156158,-0.26163095235824585,-0.5679219365119934,-0.22046710550785065,0.3445749878883362,0.28820616006851196,-0.6080969572067261,-0.3230852782726288,-0.6257279515266418,-0.13341262936592102},{-0.5396225452423096,0.1822938770055771,-0.4362550973892212,-0.10177604854106903,-0.46421587467193604,0.1895923912525177,0.4659019112586975,0.0628068745136261,0.4354003369808197,-0.47245293855667114,0.18191835284233093,-0.36155951023101807,-0.1717585176229477,0.029851015657186508,-0.18200275301933289,-0.20325537025928497},{0.321975976228714,-0.6105256676673889,0.30457502603530884,0.3011396825313568,-0.10238725692033768,0.46722084283828735,0.31076717376708984,0.29006123542785645,-0.07194295525550842,-0.2759630084037781,-0.15061254799365997,-0.17984531819820404,-0.02941589616239071,-0.5188589096069336,0.20631705224514008,-0.11848465353250504}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06470216065645218,0.33151310682296753,0.24750661849975586,-0.16713938117027283,-0.193351611495018,0.04859177768230438,-0.024405356496572495,0.2654467225074768,-0.07463064044713974,0.3145725131034851,0.487900972366333,-0.385304719209671,0.036577507853507996,0.044262487441301346,0.0325256809592247,-0.12872958183288574},{-0.4637605547904968,0.17901533842086792,-0.23145759105682373,0.3014097213745117,0.2817137539386749,-0.17247110605239868,-0.3246258795261383,-0.18996098637580872,0.37244102358818054,0.23965881764888763,-0.06524839997291565,0.265296071767807,-0.4237194359302521,0.1992139220237732,-0.23216085135936737,0.4746819734573364},{-0.2892973721027374,0.09287391602993011,-0.365683913230896,0.20539669692516327,-0.4910489022731781,-0.268716037273407,0.08150573819875717,0.17022018134593964,-0.2582526206970215,0.41272255778312683,0.2722642719745636,-0.19062606990337372,0.18300814926624298,-0.2853732705116272,-0.15557418763637543,-0.09754485636949539},{0.3484577536582947,-0.23798388242721558,0.11651548743247986,0.40044188499450684,-0.40860798954963684,-0.2886589765548706,0.2966330647468567,0.04713555425405502,0.28930145502090454,-0.08083800226449966,0.34683308005332947,0.09436499327421188,-0.2179802656173706,0.0016841765027493238,0.01089862547814846,-0.45696911215782166},{-0.4010085165500641,-0.05110828951001167,0.1680377721786499,-0.28570303320884705,0.1634405255317688,0.44294601678848267,-0.2845865786075592,0.28471335768699646,-0.23496870696544647,0.2263241410255432,-0.024707095697522163,0.0048514194786548615,-0.2501566708087921,-0.01753254607319832,-0.2921379804611206,-0.13835199177265167},{0.056712158024311066,-0.3355192244052887,0.013910372741520405,-0.31954142451286316,0.2036428451538086,0.0480046346783638,-0.164031982421875,-0.04544726759195328,-0.14609864354133606,0.41454967856407166,0.21643716096878052,-0.014757242053747177,-0.30065590143203735,0.0634184256196022,0.015860339626669884,-0.301330029964447},{0.2841416299343109,-0.16490590572357178,0.34966975450515747,-0.24276041984558105,-0.41947120428085327,-0.06070121005177498,-0.3421938419342041,0.3590061068534851,-0.09081125259399414,-0.2578553259372711,-0.2414553463459015,-0.025137610733509064,-0.0359460674226284,-0.08672873675823212,0.4959123432636261,-0.3527847230434418},{-0.31679636240005493,0.3588252067565918,-0.06492138653993607,0.18066589534282684,-0.048068877309560776,-0.2109324187040329,-0.23757188022136688,0.0767834261059761,0.012154044583439827,0.5338119864463806,0.131981760263443,-0.11621427536010742,0.04931770637631416,-0.2584794759750366,0.12116308510303497,0.14519377052783966},{0.08617822825908661,0.27375248074531555,-0.17274245619773865,-0.3478878140449524,0.3586074113845825,-0.1809866726398468,0.1341397762298584,-0.3218415379524231,0.14358291029930115,0.07853927463293076,0.07861936837434769,0.1425875425338745,0.020221736282110214,-0.42285215854644775,-0.03562299162149429,0.22037389874458313},{-0.2480309158563614,0.06880057603120804,-0.3079708218574524,-0.3477644920349121,0.22632621228694916,-0.42751145362854004,-0.13937953114509583,0.30941030383110046,-0.17443716526031494,0.13524025678634644,-0.0349683053791523,-0.10863792896270752,-0.36557498574256897,0.11665715277194977,-0.2558317482471466,-0.28367963433265686},{-0.1427152305841446,-0.14679542183876038,0.007254098542034626,-0.24924945831298828,-0.32149043679237366,-0.021947238594293594,0.1560543030500412,-0.4207054078578949,0.031214524060487747,-0.1008615791797638,0.27957969903945923,-0.05467669293284416,0.29636523127555847,0.16350097954273224,0.22892580926418304,0.22510017454624176},{-0.08435665816068649,-0.02483271434903145,-0.41069093346595764,0.3291628062725067,0.10229235887527466,0.1478745937347412,0.2513415515422821,0.178035169839859,-0.45597267150878906,0.1896333247423172,-0.32422468066215515,-0.22319935262203217,-0.3585783839225769,0.38488683104515076,-0.36438459157943726,0.06758411228656769},{-0.22274452447891235,-0.4890044033527374,-0.14470739662647247,0.17456698417663574,-0.23135359585285187,-0.014255303889513016,-0.08747868239879608,0.38898715376853943,0.47158583998680115,0.15129995346069336,-0.019215848296880722,-0.1898026317358017,0.15821611881256104,-0.4049960970878601,0.09725263714790344,-0.21458810567855835},{-0.29049402475357056,-0.4557092487812042,-0.17986515164375305,-0.16166426241397858,-0.47302868962287903,0.5291984677314758,-0.1656944900751114,0.20996099710464478,-0.10046835988759995,-0.25226300954818726,-0.34092310070991516,0.45641112327575684,-0.18098536133766174,-0.04329922795295715,-0.2451474368572235,0.3776952922344208},{-0.38332176208496094,0.35622701048851013,-0.2280694842338562,0.13111591339111328,-0.39926958084106445,0.1773255318403244,-0.06950348615646362,-0.27756816148757935,0.1229512095451355,0.2434644103050232,-0.28110870718955994,0.05911095440387726,0.23720955848693848,-0.3597463369369507,-0.3408794701099396,-0.1345655769109726},{-0.13688445091247559,-0.2962900996208191,-0.455640584230423,0.2114899605512619,0.12213630229234695,0.058201730251312256,-0.2521144449710846,0.17701394855976105,-0.34800249338150024,-0.25659623742103577,-0.3057306110858917,0.2201339453458786,-0.1724238097667694,0.12859368324279785,0.06816994398832321,0.2769809663295746}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10032869875431061,-0.06663679331541061,0.11423571407794952,-0.1547437459230423,-0.11685772240161896,0.10336585342884064,0.19129236042499542,-0.21607936918735504,-0.14569233357906342,0.29257845878601074,0.10517113655805588,0.13873761892318726,0.10856244713068008,0.17711468040943146,-0.1738051325082779,0.14059047400951385,0.12518355250358582,-0.3443136215209961,-0.23711489140987396,-0.08591962605714798,-0.15045441687107086,0.11832231283187866,-0.22333049774169922,0.2888610363006592,-0.08723955601453781,-0.01850258931517601,0.14572206139564514,0.18772809207439423,-0.2570137083530426,-0.18753406405448914,0.22071312367916107,0.29034388065338135},{0.23852314054965973,-0.04733705520629883,0.1482396125793457,-0.09987946599721909,-0.1190682053565979,0.2628341615200043,-0.0202815942466259,-0.06084056571125984,-0.04184109345078468,0.0003334124630782753,-0.14468851685523987,0.0244276225566864,0.41195255517959595,0.1640426218509674,0.14256049692630768,0.1001259833574295,-0.26601073145866394,-0.3691691756248474,0.09568558633327484,0.03380066156387329,0.04810637980699539,0.3071680963039398,0.22628094255924225,-0.23651109635829926,0.05431593954563141,0.2814905345439911,-0.30336618423461914,0.19086627662181854,0.1360088586807251,-0.23256410658359528,-0.02832036279141903,0.005906021688133478},{-0.10890411585569382,-0.038083307445049286,0.2265247404575348,-0.20661522448062897,-0.2248857021331787,0.013656209222972393,-0.18121019005775452,0.2196655422449112,0.1697358787059784,-0.026075614616274834,-0.15417936444282532,0.04050188884139061,0.2784011662006378,-0.2039303034543991,0.08201657980680466,-0.03230936825275421,-0.33831986784935,0.2448349893093109,-0.29342371225357056,-0.052730344235897064,0.007106991484761238,-0.13821549713611603,-0.07498063147068024,-0.11995440721511841,0.011160125955939293,0.35483288764953613,-0.04038142040371895,0.087007537484169,0.25802239775657654,-0.31451356410980225,-0.1708248108625412,-0.01583840884268284},{0.16358503699302673,-0.16524332761764526,0.0691731795668602,-0.36386826634407043,0.15754325687885284,-0.0954255759716034,-0.046694204211235046,0.2710280120372772,0.023360462859272957,0.19853496551513672,0.10420484840869904,-0.1374930739402771,-0.2103368192911148,-0.09479033946990967,0.30593201518058777,-0.24372074007987976,0.052779801189899445,-0.10867529362440109,-0.1284146010875702,0.09435670077800751,-0.1281118094921112,0.07950553297996521,-0.20036694407463074,0.264819473028183,-0.30791839957237244,0.06266424804925919,-0.09056137502193451,-0.20958438515663147,0.040811821818351746,0.05198705196380615,0.23499628901481628,-0.10816916823387146},{0.22005781531333923,0.018469832837581635,0.05227937176823616,0.2754596173763275,-0.26843559741973877,-0.0818549320101738,0.18134717643260956,-0.07244807481765747,0.08534463495016098,-0.20361162722110748,0.009273010306060314,-0.06693381816148758,-0.13111692667007446,-0.1381366103887558,0.29686468839645386,0.32909995317459106,-0.10634795576334,-0.33870741724967957,0.18921959400177002,-0.10363716632127762,-0.12576919794082642,0.2082555741071701,0.28175240755081177,0.03954145312309265,-0.05051463842391968,-0.10806989669799805,-0.033119142055511475,0.2703860104084015,0.25328823924064636,0.11451872438192368,0.06894820183515549,-0.29180312156677246},{0.3118182122707367,-0.17073750495910645,0.05950870364904404,0.08967119455337524,-0.15765126049518585,-0.30066052079200745,-0.1977517306804657,-0.30090007185935974,-0.24734969437122345,0.0041893841698765755,-0.009471502155065536,-0.033859141170978546,-0.15783140063285828,-0.027314968407154083,-0.2218131273984909,-0.23664934933185577,0.1844736635684967,0.024448005482554436,-0.2791775166988373,0.2056208848953247,-0.03929419443011284,-0.22985760867595673,0.19727228581905365,-0.1566539853811264,-0.14548246562480927,-0.2542148530483246,-0.10326986759901047,0.11327698081731796,0.09772632271051407,0.2692822217941284,-0.2887757122516632,0.1573418527841568},{0.20038682222366333,0.04819332808256149,0.2529008090496063,-0.19674533605575562,0.23922252655029297,-0.16400548815727234,-0.2484871745109558,0.03033951297402382,0.28585606813430786,0.18814516067504883,-0.1528596729040146,0.06854144483804703,0.0703924149274826,0.34046047925949097,0.1324344128370285,-0.12291239947080612,-0.19116273522377014,0.15981025993824005,-0.00320826331153512,0.014730041846632957,-0.09583532065153122,0.24955657124519348,0.1747463345527649,0.20126427710056305,-0.2677103281021118,-0.27244850993156433,-0.267275333404541,-0.3887600004673004,-0.0015476095722988248,-0.0795612782239914,0.23857280611991882,0.15650562942028046},{0.33591365814208984,-0.3380853235721588,0.13529126346111298,-0.3868463933467865,-0.2710726261138916,0.34050843119621277,0.3841289281845093,0.1754949688911438,-0.10530298948287964,0.059616535902023315,0.17133298516273499,-0.15524108707904816,0.14236491918563843,0.3079777956008911,-0.013133615255355835,0.20971183478832245,0.39044639468193054,-0.20290687680244446,-0.0410822331905365,-0.2916705310344696,0.12823069095611572,0.24841450154781342,0.27779507637023926,0.15999256074428558,0.06917190551757812,0.08652056008577347,0.09936297684907913,0.25912991166114807,-0.20222963392734528,-0.209559366106987,0.26516488194465637,0.0020392637234181166},{-0.05589994415640831,-0.03016134724020958,0.24246276915073395,0.2475062906742096,-0.22030536830425262,-0.37895631790161133,-0.062080174684524536,0.21755480766296387,-0.2019980251789093,-0.3402819037437439,0.15221214294433594,0.13636241853237152,0.09923212975263596,-0.26018741726875305,0.10585438460111618,-0.18324995040893555,-0.16593056917190552,0.16347074508666992,-0.23190085589885712,0.3282335698604584,-0.2454511970281601,-0.4088582992553711,-0.314997136592865,0.2285727560520172,0.1458563357591629,0.13813364505767822,0.2712256908416748,0.19089509546756744,-0.16829177737236023,-0.31802818179130554,-0.1855751872062683,0.12148279696702957},{0.34113311767578125,-0.016503648832440376,-0.025488218292593956,0.126399964094162,0.08768757432699203,0.27466925978660583,0.034577108919620514,0.37528693675994873,-0.05104415863752365,0.1122230738401413,0.15247809886932373,0.03373679891228676,-0.26022934913635254,-0.44847163558006287,0.10873354971408844,0.16169245541095734,0.13033966720104218,-0.1489378809928894,-0.05265546590089798,-0.13779690861701965,0.17396411299705505,-0.3530239462852478,0.27864402532577515,0.021482141688466072,-0.08644059300422668,0.14003412425518036,-0.2800852954387665,-0.16838526725769043,0.06242482364177704,0.032462745904922485,0.1663067638874054,0.3169698715209961},{-0.12495528161525726,0.08710668236017227,-0.15318971872329712,0.16064974665641785,-0.1410813182592392,0.2556825578212738,0.11415941268205643,-0.03190615028142929,0.3266497850418091,-0.28135624527931213,-0.1469113826751709,0.16602975130081177,-0.19098934531211853,0.03427087888121605,-0.32482507824897766,-0.0500212199985981,0.11837485432624817,0.15962260961532593,0.024269916117191315,-0.1883089244365692,-0.20992805063724518,0.18234102427959442,0.1716713011264801,0.18779949843883514,-0.2692190110683441,0.3904476761817932,-0.0637679323554039,-0.02984645962715149,-0.12747587263584137,0.11087588220834732,0.2298487424850464,0.3040359914302826},{-0.2708890438079834,0.33144327998161316,-0.031790848821401596,0.012046381831169128,-0.2331569939851761,-0.23784688115119934,0.15359869599342346,-0.34029707312583923,-0.08630804717540741,-0.3596327006816864,-0.12689737975597382,-0.032823193818330765,0.17776206135749817,-0.21733549237251282,-0.14686429500579834,-0.30239853262901306,-0.18544180691242218,-0.03344150260090828,0.3495023846626282,-0.2447548806667328,0.1380086988210678,-0.2481558471918106,0.04123799130320549,0.26516833901405334,-0.1178148090839386,0.17302505671977997,0.23512691259384155,-0.08966891467571259,-0.029923735186457634,0.28821131587028503,-0.21167883276939392,-0.338152676820755},{-0.01286437176167965,0.2208739072084427,0.1853981465101242,-0.2568216323852539,0.2736966907978058,0.01108479592949152,-0.15867576003074646,-0.02242073230445385,0.17482233047485352,-0.25560712814331055,-0.09818683564662933,0.05585966631770134,0.15411217510700226,-0.007885968312621117,0.06649526208639145,-0.057512424886226654,0.19973863661289215,-0.3038291335105896,0.3004182279109955,0.030625559389591217,-0.1867567002773285,0.22898349165916443,-0.1281902939081192,-0.2364896833896637,0.24077053368091583,-0.06641031056642532,0.033901143819093704,-0.10775306820869446,0.09344558417797089,-0.1581619679927826,0.3272708058357239,0.2944088280200958},{0.0449896976351738,-0.23060010373592377,-0.2014223337173462,0.06790726631879807,-0.04287450388073921,0.2787485420703888,-0.13693997263908386,-0.3605384826660156,0.3600062131881714,0.052114903926849365,0.035557784140110016,0.05865471437573433,-0.0731482058763504,0.20630092918872833,-0.22619318962097168,-0.3505799174308777,0.013953535817563534,0.03565489128232002,0.15277016162872314,0.45645618438720703,-0.2762855589389801,0.19221153855323792,-0.16634014248847961,0.10960835963487625,0.17171284556388855,-0.3469116687774658,-0.1580873727798462,-0.3401886522769928,-0.19033360481262207,-0.17823173105716705,0.13686248660087585,-0.4163954555988312},{-0.129488006234169,0.37333616614341736,0.03244173154234886,-0.1560225635766983,-0.1763732135295868,-0.28263264894485474,0.09774073958396912,-0.12149353325366974,0.3131961524486542,-0.06251726299524307,0.21433107554912567,0.25480008125305176,-0.012832202017307281,0.06961163133382797,-0.14306114614009857,0.16323572397232056,-0.20894557237625122,-0.42184683680534363,-0.3378889858722687,0.07822732627391815,0.1408938467502594,-0.2273770421743393,-0.37976208329200745,-0.2832848131656647,-0.11300776898860931,0.17631645500659943,0.3991771340370178,0.019988592714071274,-0.09424041956663132,0.003505379194393754,-0.07126915454864502,0.11294013261795044},{-0.25820058584213257,-0.1656479686498642,-0.19858214259147644,0.0572526752948761,-0.2731192111968994,-0.15655335783958435,-0.08078457415103912,-0.12485790997743607,-0.3064313232898712,-0.27161863446235657,0.2250719666481018,0.16397549211978912,-0.2885725796222687,0.2761244773864746,-0.06870816648006439,0.15361380577087402,0.08396219462156296,0.032331034541130066,0.04567837715148926,0.15799002349376678,0.22564880549907684,0.23752087354660034,0.11573856323957443,0.2485586404800415,0.11937946826219559,-0.21456798911094666,-0.16486810147762299,0.23379725217819214,-0.05854453891515732,-0.20239563286304474,-0.19038528203964233,-0.20632492005825043},{-0.27284860610961914,-0.20513243973255157,-0.34315213561058044,0.09197955578565598,-0.09243310242891312,-0.06124213710427284,-0.10306711494922638,0.12678590416908264,-0.0811360627412796,0.0754808858036995,-0.22525498270988464,0.011991661973297596,0.16078315675258636,-0.09734377264976501,0.04958857595920563,0.20804469287395477,-0.11896057426929474,-0.1345299482345581,0.18799042701721191,0.06572920829057693,0.19188494980335236,-0.016011064872145653,-0.20508162677288055,0.050878576934337616,0.20007187128067017,-0.2684042453765869,0.1421540230512619,0.06099684536457062,0.0861707329750061,-0.14630691707134247,0.23706580698490143,-0.06534484028816223},{0.2565252482891083,-0.007556172553449869,0.015172572806477547,0.18653324246406555,-0.32629701495170593,-0.02458571456372738,0.08664818853139877,0.17788027226924896,-0.0669148787856102,-0.14264856278896332,0.2903192937374115,-0.10728519409894943,0.05416962131857872,-0.04295409843325615,-0.1321166604757309,0.26705947518348694,-0.04770134016871452,-0.12869513034820557,0.10480917990207672,-0.30202701687812805,-0.03592468425631523,-0.25074106454849243,-0.20012806355953217,0.228102445602417,-0.06437751650810242,-0.05174633488059044,0.1425485759973526,0.04773120954632759,-0.16088692843914032,-0.07485884428024292,-0.030339909717440605,-0.06272875517606735},{0.3016098439693451,-0.07401709258556366,0.09242719411849976,0.04900539293885231,-0.0347575917840004,-0.10114000737667084,0.1888660192489624,-0.24843205511569977,0.266890287399292,0.28811103105545044,0.030048564076423645,0.13514865934848785,0.24607905745506287,0.35790589451789856,-0.2912135124206543,-0.35285279154777527,-0.24829766154289246,0.08703098446130753,-0.1576084941625595,-0.2711538076400757,-0.17792250216007233,0.2642229497432709,0.06756047904491425,0.15624162554740906,-0.14005231857299805,-0.14133960008621216,-0.14592836797237396,-0.2478025108575821,0.23821699619293213,0.18747103214263916,-0.3342345356941223,-0.15191173553466797},{-0.11203762143850327,0.15237072110176086,0.2657301723957062,-0.031232362613081932,-0.0458315946161747,0.05357883870601654,-0.03393375128507614,-0.33715781569480896,0.21897965669631958,0.2410382181406021,0.15677931904792786,0.23621167242527008,-0.21601800620555878,0.21431972086429596,-0.27315548062324524,0.29696139693260193,0.1618383675813675,-0.26283615827560425,0.22806420922279358,0.09323225915431976,-0.3565254211425781,0.3330773711204529,-0.2659739851951599,0.1461179405450821,0.23955748975276947,0.2698492705821991,0.07067959010601044,0.13382238149642944,-0.18108230829238892,0.2115452140569687,-0.04346384108066559,0.10386773943901062},{-0.1293720155954361,-0.11323128640651703,-0.004604716785252094,0.18171106278896332,0.013252364471554756,0.2033480554819107,-0.2753361761569977,-0.1100972592830658,-0.11640997976064682,-0.08054150640964508,-0.14948584139347076,-0.1769247055053711,0.021016903221607208,-0.18423005938529968,0.07857098430395126,-0.21639665961265564,0.2503841519355774,-0.027858946472406387,-0.3297947347164154,-0.284458726644516,0.12827304005622864,0.1700780838727951,-0.18804490566253662,0.3005795478820801,-0.2454378455877304,0.06043881177902222,0.12119711190462112,-0.09625837206840515,0.15340158343315125,-0.2277962565422058,0.30676859617233276,0.1446833461523056},{0.31261491775512695,0.03737680986523628,0.0947161465883255,0.20391631126403809,-0.2316308468580246,0.1703636646270752,-0.079417385160923,0.1611924171447754,0.10294760018587112,0.03975457698106766,0.0973467007279396,-0.33471837639808655,-0.2536780536174774,0.03791360557079315,0.08936045318841934,-0.07813515514135361,0.270544171333313,0.16078662872314453,-0.17982320487499237,-0.20631730556488037,0.3224831223487854,0.19026674330234528,0.25310367345809937,0.10122037678956985,-0.021547529846429825,0.036632273346185684,-0.06672190874814987,-0.17259344458580017,0.2658657133579254,0.0409717820584774,-0.1963881105184555,0.10683412104845047},{-0.011049113236367702,0.012748944573104382,-0.04758588224649429,-0.24232682585716248,-0.0851624459028244,-0.21575136482715607,-0.22321276366710663,-0.1426496058702469,-0.018095703795552254,-0.009363889694213867,-0.27418252825737,0.016851674765348434,-0.22122900187969208,-0.16181249916553497,0.00880570150911808,0.10020061582326889,0.265240877866745,-0.17707887291908264,-0.3236671984195709,0.2700308561325073,-0.1945672482252121,0.2851667106151581,0.029426509514451027,-0.031252987682819366,0.024268096312880516,0.15648995339870453,-0.08355152606964111,-0.2654494345188141,0.22410377860069275,0.25256243348121643,-0.11593747138977051,0.17970311641693115},{-0.24560974538326263,-0.033785756677389145,0.046776238828897476,-0.04057621210813522,0.1056644544005394,0.13819149136543274,-0.17591336369514465,0.12593935430049896,-0.17533650994300842,-0.15588964521884918,0.09610453248023987,-0.1440512090921402,-0.2015659511089325,0.23867729306221008,0.01639929786324501,0.03094383142888546,0.2013634443283081,-0.24577927589416504,-0.15743966400623322,0.2846672832965851,0.04309100657701492,0.2346462458372116,-0.05294544994831085,0.02246350608766079,-0.27964678406715393,-0.1880357265472412,0.01143252570182085,0.29006338119506836,-0.004576851148158312,0.021087631583213806,0.2746802866458893,0.3078716993331909}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.09037695825099945,0.22104471921920776,0.4228677451610565,-0.05142776668071747},{0.11490955948829651,-0.1329648345708847,0.06584034860134125,0.22866715490818024},{-0.1575545221567154,0.19841547310352325,0.14171062409877777,0.13813279569149017},{0.3162611424922943,0.006495444104075432,0.036276087164878845,0.4571954011917114},{-0.13493941724300385,0.09391482919454575,0.3707491159439087,-0.06363338977098465},{-0.11353258043527603,0.246611550450325,0.2582702040672302,-0.14331889152526855},{-0.3003537058830261,-0.015719471499323845,0.016773894429206848,-0.11913413554430008},{-0.4135679304599762,-0.159873366355896,0.4265281856060028,-0.318617045879364},{0.3730512857437134,-0.16169655323028564,-0.30440670251846313,-0.4208645224571228},{0.06329867243766785,0.33704641461372375,0.37610381841659546,-0.49029356241226196},{-0.17824600636959076,-0.18576569855213165,-0.22551359236240387,0.19796878099441528},{0.3903068006038666,-0.22330094873905182,-0.021346349269151688,0.2177627831697464},{0.3271207809448242,0.29281163215637207,-0.06380392611026764,0.12311521172523499},{0.03207816183567047,0.12097488343715668,-0.3288300037384033,-0.00377479987218976},{0.09886232018470764,0.3045348525047302,0.4261706471443176,0.3481748700141907},{0.1807740181684494,0.028538120910525322,0.33144980669021606,0.25761768221855164},{-0.25458747148513794,-0.09259410947561264,-0.1159806028008461,-0.2919696867465973},{-0.2386941909790039,0.14048409461975098,-0.18673793971538544,-0.11362913250923157},{-0.218109130859375,0.21899603307247162,0.18961326777935028,0.3478280007839203},{-0.039734408259391785,0.36096706986427307,-0.20435404777526855,0.09105006605386734},{-0.3064832091331482,-0.40214803814888,-0.11767273396253586,0.040005993098020554},{0.3828294277191162,0.5140511989593506,0.030962331220507622,-0.3358621895313263},{-0.06501155346632004,0.20049428939819336,0.23988330364227295,0.17372234165668488},{-0.10933484882116318,0.3967597782611847,-0.08776133507490158,-0.1636771559715271},{0.06180379539728165,-0.031581830233335495,-0.10869721323251724,0.03520492836833},{0.30909812450408936,-0.4872532784938812,-0.016835886985063553,0.03782886266708374},{0.011440993286669254,-0.38024377822875977,-0.22937634587287903,-0.22084736824035645},{0.12524816393852234,-0.16259773075580597,0.22774948179721832,0.20799143612384796},{0.0005595427937805653,-0.05261407420039177,0.11207662522792816,0.04918179288506508},{-0.39207983016967773,0.3714231252670288,0.25007036328315735,-0.07216712832450867},{0.3517804741859436,-0.15658451616764069,0.22765639424324036,-0.09894135594367981},{0.06696833670139313,-0.4354453980922699,0.4460049271583557,-0.3531043827533722}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.05529187619686127,-0.03236360475420952,0.029761523008346558,-0.037990450859069824,-0.03470487892627716,-0.14134080708026886,-0.06733052432537079,0.05791570991277695,0.037459783256053925,-0.0419175885617733,0.0972638949751854,0.06549116224050522,-0.05545327439904213,-0.10428865998983383,0.08189024776220322,-0.06378145515918732};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.06717418134212494,0.05375630781054497,0.02606063522398472,0.020078293979167938,0.07139308005571365,-0.0033293948508799076,0.07772699743509293,-0.014664609916508198,-0.01371140219271183,0.013208933174610138,-0.022740988060832024,-0.039895132184028625,0.07443244755268097,-0.03060656413435936,-0.032443851232528687,-0.0326395109295845};
static const float actor_encoder_feed_forward_0_bias[32] = {0.07524317502975464,0.06917431950569153,0.020619535818696022,0.06830062717199326,0.04853379353880882,-0.012190724723041058,-0.04321637004613876,-0.019951825961470604,-0.03003101795911789,0.005264338105916977,-0.05055613815784454,0.05050104111433029,0.06003038212656975,-0.06599869579076767,0.08039199560880661,0.07740312814712524,-0.07358808070421219,-0.06682988256216049,0.02240055799484253,0.013674921356141567,-0.04110634699463844,0.007689368911087513,0.06478043645620346,-0.0010468442924320698,-0.028073236346244812,0.005283385515213013,-0.051414620131254196,0.056037403643131256,0.0432586595416069,0.008681724779307842,0.03640652447938919,0.039720647037029266};
static const float action_parameterization_distribution_linear_bias[4] = {0.04147590696811676,0.010129549540579319,0.05506594479084015,0.05165093392133713};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.03497773036360741,0.26273012161254883,-0.1298263520002365,0.17950469255447388,0.23447100818157196,0.15092222392559052,0.29124772548675537,-0.0044015757739543915},{-0.17676861584186554,-0.07002877444028854,-0.26257795095443726,-0.25029000639915466,-0.31034034490585327,-0.15941904485225677,-0.1326053887605667,-0.1758074164390564},{-0.25368258357048035,0.008476571179926395,0.24756766855716705,0.21816502511501312,0.23612113296985626,0.0011179092107340693,0.21204370260238647,-0.08407753705978394},{0.02167881838977337,0.08040221035480499,-0.16073660552501678,-0.026192398741841316,-0.031139206141233444,-0.03739038482308388,0.23446451127529144,-0.1746671199798584},{-0.25967171788215637,-0.14398124814033508,-0.2416462004184723,-0.14814729988574982,-0.058834634721279144,0.18245042860507965,0.132375106215477,-0.025358986109495163},{-0.2544945180416107,-0.001126861316151917,0.3637472093105316,0.244975283741951,0.18109741806983948,-0.11097149550914764,-0.14060594141483307,-0.1194850280880928},{-0.17422491312026978,0.062382593750953674,0.38107267022132874,-0.22705094516277313,-0.1039944663643837,-0.4061952829360962,-0.10880766063928604,-0.14963610470294952},{-0.34346920251846313,-0.3600287139415741,0.5239003896713257,-0.09273773431777954,-0.24880948662757874,0.17260129749774933,0.1465788334608078,-0.2277359515428543},{-0.31714150309562683,0.26068657636642456,-0.1963491439819336,0.4051763415336609,0.0619097538292408,-0.38951829075813293,0.09222583472728729,0.10000895708799362},{-0.30502355098724365,-0.3129572570323944,-0.16975060105323792,-0.18805952370166779,-0.5164397358894348,0.07798656076192856,0.005120346788316965,0.12362843006849289},{0.16786420345306396,0.33324915170669556,0.18422402441501617,-0.0026033029425889254,0.1613544225692749,0.0687398910522461,-0.22674492001533508,0.20572835206985474},{0.21699905395507812,0.023344526067376137,0.2532361149787903,0.25496694445610046,-0.2586120665073395,0.27150246500968933,0.006031174212694168,-0.2386087328195572},{0.1294049173593521,-0.27822476625442505,0.2390710413455963,-0.03815370053052902,-0.2510099709033966,-0.07024907320737839,-0.16061563789844513,-0.1387677788734436},{-0.19033443927764893,-0.1442270129919052,0.3087076246738434,0.3752273619174957,-0.1387079656124115,-0.06799744814634323,-0.2670181095600128,0.1722320318222046},{0.03183428570628166,-0.1508537381887436,0.0765010192990303,-0.20176486670970917,-0.32645976543426514,-0.15371762216091156,0.23875248432159424,0.0007449671975336969},{0.14963458478450775,-0.04979516938328743,-0.06203842535614967,-0.28510138392448425,-0.06560224294662476,0.05228562280535698,-0.016393227502703667,0.4070456922054291},{-0.03720726817846298,-0.21000425517559052,-0.18894584476947784,0.029196450486779213,-0.14780855178833008,-0.14548729360103607,-0.10967546701431274,0.0657891184091568},{-0.20368775725364685,-0.27687975764274597,0.05974435806274414,-0.005916752852499485,0.17604289948940277,-0.23629891872406006,0.3655603528022766,0.12114764750003815},{0.03843679279088974,0.11449886858463287,-0.24250635504722595,0.061432577669620514,0.16043008863925934,0.14580149948596954,-0.20653535425662994,0.28625211119651794},{0.15919145941734314,-0.05792710557579994,-0.3738875985145569,0.031768713146448135,-0.016932150349020958,-0.08838372677564621,-0.29600974917411804,-0.019756460562348366},{0.04595698416233063,-0.14651785790920258,0.02610027976334095,-0.13229046761989594,0.29000619053840637,-0.052814848721027374,-0.0633443295955658,0.428121417760849},{-0.0022062622010707855,0.1258385330438614,-0.2994823157787323,0.20821259915828705,0.2983708083629608,0.2718544006347656,0.13665223121643066,-0.2859959602355957},{-0.39884135127067566,-0.08908407390117645,0.10051818937063217,-0.08696850389242172,0.2020443081855774,-0.3472738265991211,0.17113186419010162,-0.25403711199760437},{-0.1280451864004135,0.11345720291137695,-0.10351695120334625,-0.42877423763275146,0.26500487327575684,-0.003345017321407795,-0.3601526916027069,0.19068005681037903},{-0.16759027540683746,-0.16372650861740112,-0.03546304255723953,0.07015378028154373,0.026503942906856537,0.22116513550281525,0.28735727071762085,-0.06512624025344849},{-0.17887744307518005,0.07545379549264908,-0.3106369376182556,-0.2837062478065491,0.13999460637569427,-0.005426320247352123,-0.08120135962963104,0.07017617672681808},{0.32591041922569275,0.3817692995071411,-0.22074879705905914,0.20451569557189941,0.12851864099502563,0.29561978578567505,-0.29237306118011475,-0.16259118914604187},{0.4137123227119446,0.24949873983860016,0.12391999363899231,0.07949899137020111,0.2258138358592987,0.060439907014369965,0.2293277531862259,0.3611014783382416},{-0.10958987474441528,0.38640695810317993,0.19668470323085785,0.027354253455996513,0.2288943976163864,-0.018314693123102188,-0.3970234990119934,-0.3017492890357971},{-0.15875336527824402,-0.23065024614334106,0.0745750442147255,-0.17986421287059784,-0.2677692174911499,-0.2237672209739685,0.24705909192562103,-0.023634428158402443},{0.4308033287525177,-0.2746119201183319,0.31863054633140564,-0.25036999583244324,0.10754197090864182,0.23676136136054993,0.11377272754907608,-0.1629517525434494},{0.2699337899684906,0.3908490538597107,0.39462560415267944,-0.22304366528987885,-0.15078526735305786,0.09300551563501358,0.20678892731666565,0.09244680404663086}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.019522128626704216,0.38558346033096313,-0.17658556997776031,0.26125481724739075,-0.38625091314315796,0.2535725235939026,0.4505266547203064,0.06728468090295792},{-0.42487266659736633,-0.4823015034198761,-0.3763057589530945,-0.4371301829814911,-0.4363734722137451,0.389848917722702,0.4507806599140167,-0.3973531424999237},{-0.02250763773918152,-0.15264245867729187,0.11570093035697937,0.042026419192552567,-0.07847267389297485,0.43904393911361694,-0.33886924386024475,-0.35054320096969604},{0.4704436659812927,0.015805043280124664,0.08910692483186722,-0.01733049750328064,0.540378987789154,0.37266871333122253,0.3402273654937744,0.42047786712646484},{0.09989990293979645,0.2435118407011032,-0.15887701511383057,-0.09851564466953278,0.11973833292722702,-0.3580799996852875,-0.36934635043144226,0.4619836211204529},{0.38895943760871887,0.0852808728814125,0.03521190211176872,-0.3720659017562866,-0.4389820992946625,-0.47842684388160706,-0.10532212257385254,0.5209053754806519},{-0.4356001019477844,-0.3397687077522278,-0.03586770221590996,-0.21609137952327728,0.02497793361544609,0.40106382966041565,-0.5321279764175415,0.5998734831809998},{0.23153261840343475,0.056384216994047165,0.02164604887366295,-0.014837141148746014,0.4034842848777771,-0.5294090509414673,0.4420504868030548,-0.4222963750362396}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.060931503772735596,0.038966547697782516,0.08314565569162369,-0.02836119569838047,-0.020608985796570778,-0.0036583233159035444,0.0686025395989418,-0.03141281381249428};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.0214398093521595,-0.038791071623563766,0.024634812027215958,-0.10212695598602295,-0.008923976682126522,-0.002393378410488367,-0.02990422397851944,-0.06378176063299179};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

