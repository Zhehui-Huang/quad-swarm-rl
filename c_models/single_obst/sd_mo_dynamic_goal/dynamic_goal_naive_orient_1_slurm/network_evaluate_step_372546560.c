#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.28699395060539246,-0.08593452721834183,0.2622101902961731,0.14253191649913788,-0.30431661009788513,0.2694298028945923,-0.053045108914375305,-0.1468246579170227,0.13104157149791718,0.3069553077220917,0.12455742806196213,0.041486356407403946,0.2615031599998474,-0.24694909155368805,0.2818163335323334,-0.06885810196399689},{-0.15946997702121735,-0.36756840348243713,0.3263903856277466,0.12603119015693665,-0.25496774911880493,0.1703966110944748,-0.4075898230075836,-0.040435101836919785,-0.092486172914505,-0.18239067494869232,0.037792500108480453,-0.22528193891048431,0.00989096611738205,-0.34461426734924316,-0.2611951529979706,0.10000988841056824},{-0.07783078402280807,-0.2425975203514099,-0.4102465808391571,0.15649986267089844,0.22389571368694305,0.531390905380249,0.058010827749967575,-0.05844259634613991,0.059686124324798584,-0.5064956545829773,-0.38688164949417114,0.7415679097175598,-0.19447222352027893,-0.2844400703907013,-0.36139675974845886,0.24455364048480988},{0.13427245616912842,0.26151007413864136,0.3871714174747467,-0.01964542642235756,-0.42149367928504944,-0.014719199389219284,0.2771628499031067,0.06535457819700241,0.30937260389328003,-0.3590790629386902,0.009825527667999268,0.3981361985206604,-0.24302038550376892,0.03318113088607788,0.4879337251186371,-0.46914467215538025},{-0.07299840450286865,-0.03254900872707367,0.3272801637649536,-0.024821501225233078,0.34234803915023804,0.4440922737121582,0.23318849503993988,-0.0081210071220994,0.1370188295841217,0.22173412144184113,0.2758336663246155,-0.35347649455070496,-0.25377997756004333,-0.44561880826950073,0.42482122778892517,0.0866706371307373},{-0.19767041504383087,-0.2015431523323059,-0.17564792931079865,-0.10714385658502579,0.18289192020893097,0.15493591129779816,0.04986335709691048,-0.12368911504745483,0.3590000569820404,-0.27843084931373596,-0.42137348651885986,0.2037031501531601,0.16525337100028992,-0.14664247632026672,-0.07401823997497559,0.056346721947193146},{0.04989495873451233,0.02645828388631344,0.05299315229058266,-0.4761354923248291,0.21524755656719208,-0.04141101613640785,0.06544946879148483,0.3838651776313782,0.33281412720680237,0.06721416860818863,-0.4419839680194855,-0.02174624428153038,-0.02598375640809536,0.15519846975803375,-0.1848946213722229,-0.25405991077423096},{-0.2869742512702942,0.398836225271225,0.3616293668746948,0.4141329228878021,-0.4970685541629791,-0.07299982756376266,0.5322780013084412,0.5309937000274658,-0.22757835686206818,0.38272780179977417,-0.6995788216590881,-0.3719522953033447,0.43444588780403137,0.126618891954422,0.2891319990158081,0.43505001068115234},{0.3588593900203705,-0.29461202025413513,0.6317422389984131,0.11848236620426178,0.022577689960598946,0.09702208638191223,0.1719050407409668,-0.605614960193634,-0.16426120698451996,-0.461027055978775,-0.15694138407707214,-0.004899590741842985,-0.12680232524871826,0.6617066860198975,0.4522956907749176,-0.3150983154773712},{0.24521861970424652,-0.6261995434761047,-0.6163867712020874,-0.2768745720386505,-0.22243288159370422,0.2596598267555237,0.1855236440896988,0.18986938893795013,0.6087039113044739,0.23667782545089722,0.19758319854736328,-0.2892078757286072,-0.12724947929382324,0.3945107161998749,-0.1709306687116623,-0.5573139786720276},{0.179207444190979,0.3237568736076355,0.39085817337036133,-0.6506621837615967,-0.31247004866600037,0.12655073404312134,0.1348646581172943,0.4543251693248749,-0.3390052318572998,0.07030589878559113,-0.12040024250745773,0.009106260724365711,-0.18005019426345825,-0.22044715285301208,0.2530237138271332,-0.3712298274040222},{-0.024070648476481438,-0.411772757768631,0.14842331409454346,0.5572213530540466,0.7431975603103638,0.4623092710971832,0.3463619649410248,0.38579297065734863,0.048965927213430405,-0.004442278295755386,0.2550877034664154,-0.4143696129322052,-0.5445467829704285,-0.4361538887023926,0.684689462184906,-0.03065391071140766},{-0.3116520345211029,0.4415785074234009,-0.03866516053676605,-0.6124600172042847,0.14783233404159546,0.022465337067842484,0.19325697422027588,0.19240814447402954,0.06196185201406479,0.09001798927783966,0.006877260748296976,0.1953243613243103,0.4379032254219055,0.36295223236083984,-0.06313452124595642,-0.09851272404193878},{0.04113778844475746,-0.3894367218017578,-0.24776402115821838,-0.15556131303310394,-0.4272768497467041,-5.391631930251606e-05,-0.24077346920967102,-0.22837981581687927,-0.18570296466350555,-0.04365305230021477,-0.4200800359249115,-0.031435299664735794,-0.2288476824760437,0.43892648816108704,0.197633758187294,-0.02264387533068657},{0.04753328114748001,-0.3113570809364319,-0.2376691699028015,0.1859404444694519,-0.0649278312921524,-0.4591258466243744,0.26592567563056946,-0.05060693994164467,0.014729228802025318,0.37250539660453796,0.10734277963638306,0.04224857687950134,0.29431724548339844,-0.0568094402551651,-0.3592595160007477,0.23733800649642944},{0.37980782985687256,0.008594727143645287,-0.22119538486003876,-0.2047969102859497,-0.3310680687427521,0.18419505655765533,0.339341402053833,-0.07979878783226013,0.20018115639686584,0.36311572790145874,-0.15515021979808807,0.08625323325395584,-0.2052830457687378,0.23678936064243317,-0.09555628895759583,-0.016706818714737892},{-0.2069302648305893,-0.18835921585559845,0.23079121112823486,0.12452612817287445,-0.21212045848369598,0.10202224552631378,-0.2123919427394867,-0.10717480629682541,-0.2350846827030182,-0.2593451738357544,-0.06460592895746231,-0.2574702203273773,0.11209200322628021,-0.2131921648979187,0.037557534873485565,-0.1970275491476059},{-0.27565938234329224,0.24175280332565308,-0.3534996807575226,-0.24874970316886902,0.04495321959257126,0.3346455693244934,-0.24665075540542603,-0.22650989890098572,0.1756093055009842,0.19029180705547333,0.32784542441368103,-0.11325833201408386,-0.3285370171070099,0.32364025712013245,0.015570740215480328,-0.4112761616706848}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06275177747011185,-0.02880733087658882,-0.09873228520154953,-0.3396013081073761,0.3194325268268585,0.2952694594860077,0.10072658210992813,0.05227280408143997,-0.11365997791290283,-0.14001303911209106,-0.02147763967514038,0.07186485081911087,0.1997428685426712,0.36895352602005005,0.08666504174470901,0.08382425457239151},{-0.173589825630188,-0.3034850060939789,-0.051936808973550797,0.06253672391176224,0.2221628576517105,-0.31983113288879395,0.04425881803035736,0.041073866188526154,-0.07114243507385254,0.2544223666191101,-0.24591714143753052,0.32376208901405334,-0.3835069239139557,0.1904640942811966,-0.36968231201171875,-0.351568341255188},{0.06691748648881912,0.21511207520961761,-0.3667822480201721,-0.5221304893493652,0.17711091041564941,0.4768887162208557,-0.08455945551395416,0.06846167147159576,-0.2600013315677643,-0.29294782876968384,-0.009270573034882545,0.3279416859149933,-0.3044314384460449,-0.19401204586029053,0.09844847768545151,-0.0707925334572792},{0.1744047850370407,-0.053421515971422195,0.08376044780015945,0.19976192712783813,-0.5079172849655151,-0.003875374561175704,0.09269784390926361,-0.17537520825862885,0.29462119936943054,0.37693217396736145,-0.1798657923936844,-0.13611966371536255,-0.4376908242702484,-0.4210743010044098,0.1612667441368103,0.16971950232982635},{-0.11987192928791046,0.12970826029777527,0.009526418522000313,0.25484681129455566,-0.2319989949464798,0.06324155628681183,-0.006073428317904472,0.1591888964176178,0.2635548710823059,-0.2703993618488312,0.19290442764759064,0.2695808410644531,0.19923710823059082,-0.4528643786907196,0.019051454961299896,-0.009931989945471287},{0.23501881957054138,0.26231321692466736,-0.04427078366279602,0.18220004439353943,-0.4792883098125458,-0.41586995124816895,0.26345354318618774,0.2867026925086975,0.1233164593577385,0.3562960624694824,0.2462213784456253,-0.2151210606098175,-0.010079172439873219,-0.1329781413078308,-0.05937740206718445,0.31322503089904785},{-0.10089468210935593,0.27141931653022766,0.2852530777454376,-0.376624196767807,-0.2530499994754791,0.005965991411358118,-0.3422941565513611,-0.0544615276157856,0.16645541787147522,0.085579052567482,-0.14521685242652893,-0.20920614898204803,-0.32791340351104736,-0.020772896707057953,0.20040008425712585,0.03442690894007683},{-0.16099180281162262,-0.14355918765068054,-0.47973331809043884,0.30519962310791016,-0.34554192423820496,-0.25606971979141235,-0.23757922649383545,-0.4100973308086395,0.1461118906736374,-0.25221410393714905,0.04984470456838608,0.09073524922132492,-0.16766835749149323,0.42685773968696594,-0.07179808616638184,-0.3308965265750885},{-0.3260933756828308,0.270760715007782,-0.000788687146268785,-0.024775056168437004,0.2684503495693207,-0.2809324860572815,0.32073068618774414,0.14508257806301117,0.3345351219177246,0.29723843932151794,0.26522883772850037,0.31385117769241333,0.18425852060317993,-0.04412325471639633,0.2768985629081726,0.1133856400847435},{0.05668561905622482,-0.26649001240730286,-0.18262191116809845,-0.11139444261789322,0.27243927121162415,-0.18471384048461914,-0.3017977178096771,-0.16876967251300812,0.07859692722558975,-0.3782954216003418,-0.2860175371170044,0.3592990040779114,0.11908097565174103,0.16216906905174255,-0.3855748176574707,0.23670780658721924},{-0.0657641664147377,-0.44816192984580994,0.3390997350215912,0.2968326508998871,0.22293531894683838,0.15314611792564392,0.19609344005584717,-0.14256219565868378,0.24132981896400452,-0.2741750180721283,0.20145903527736664,0.37075915932655334,0.4993668794631958,0.10020049661397934,-0.12064902484416962,0.10232114791870117},{0.06379318982362747,-0.012946190312504768,0.39636164903640747,-0.009157940745353699,-0.25021451711654663,-0.17501473426818848,0.43032997846603394,0.2832907438278198,-0.2563409209251404,-0.20947448909282684,-0.0832674503326416,-0.32712283730506897,-0.02903163805603981,-0.2982923686504364,-0.3828870356082916,0.048941031098365784},{-0.1058606207370758,-0.32179680466651917,0.4051799178123474,-0.22504495084285736,0.35757073760032654,-0.2975327968597412,-0.4782440960407257,0.07752501219511032,0.08368048816919327,0.06179220229387283,-0.34756192564964294,0.13684308528900146,0.0806320458650589,-0.3013242781162262,-0.3746252954006195,-0.024620668962597847},{0.3704603612422943,-0.33240368962287903,0.46593034267425537,0.08276935666799545,-0.08878086507320404,0.3230017423629761,-0.10274618119001389,-0.23741105198860168,-0.42603248357772827,0.12441305071115494,0.013752738013863564,-0.3594697415828705,-0.10633702576160431,0.12576079368591309,0.31869202852249146,0.041805341839790344},{-0.0945013090968132,0.23486869037151337,0.11505509912967682,-0.45542851090431213,-0.23002883791923523,0.19283117353916168,0.2831202745437622,-0.2546055018901825,0.21200397610664368,-0.32948970794677734,0.03900259733200073,0.10717722028493881,-0.0645003467798233,0.1761859804391861,0.02645706944167614,0.0903446227312088},{-0.18634603917598724,0.4082021117210388,-0.42176327109336853,0.37497976422309875,0.12322434037923813,-0.4123794138431549,-0.02770138718187809,-0.07596991956233978,-0.3176427483558655,0.38957297801971436,-0.3403114080429077,0.2992698550224304,-0.07543555647134781,-0.3380964398384094,-0.23662316799163818,-0.49768027663230896}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.17375248670578003,0.12867297232151031,-0.031766850501298904,-0.048613715916872025,-0.12317831069231033,0.04346080496907234,0.28003957867622375,0.10803095251321793,-0.20245492458343506,-0.16650553047657013,0.16202835738658905,-0.2937460243701935,-0.2429475337266922,0.23133741319179535,0.22617538273334503,0.33468326926231384,-0.26282018423080444,-0.285073846578598,-0.19487562775611877,0.12297665327787399,-0.0765465497970581,-0.30236175656318665,-0.2177000194787979,-0.29674476385116577,-0.26019078493118286,0.17289294302463531,-0.19350233674049377,-0.010024605318903923,-0.03181618079543114,-0.02798495814204216,0.23445601761341095,-0.22588017582893372},{0.29237592220306396,0.15568962693214417,0.16907747089862823,-0.11257313191890717,0.14569059014320374,-0.14106956124305725,0.38830482959747314,0.13493049144744873,-0.13925424218177795,-0.07922179251909256,-0.12422768026590347,-0.27616533637046814,-0.16146907210350037,0.2501857876777649,-0.26127058267593384,-0.21294154226779938,-0.04506248980760574,0.20220458507537842,-0.37731054425239563,-0.2218702733516693,-0.02310076542198658,0.22236035764217377,0.04140537977218628,0.029483933001756668,0.2265603095293045,-0.36170080304145813,-0.05512949079275131,0.06273363530635834,0.18065856397151947,-0.12565870583057404,-0.06433051824569702,0.1982668936252594},{0.1389087587594986,0.03932647034525871,-0.17060476541519165,0.14772769808769226,-0.1709475815296173,-0.16587717831134796,-0.2065819948911667,0.031221982091665268,-0.16350872814655304,0.38741958141326904,-0.29781195521354675,-0.3035557270050049,0.11115320026874542,-0.39193084836006165,-0.15693333745002747,0.0953022837638855,-0.11856747418642044,-0.14191597700119019,0.1554936319589615,-0.13853304088115692,0.23456744849681854,0.29566067457199097,-0.23700366914272308,0.009518340229988098,-0.28785306215286255,0.007835074327886105,0.13507622480392456,-0.08138944208621979,-0.02344122715294361,-0.2644566297531128,-0.13939350843429565,-0.08034167438745499},{0.43947112560272217,0.048469725996255875,0.16992002725601196,-0.1543826162815094,-0.2898126244544983,-0.060835566371679306,-0.1829887181520462,0.3104708790779114,0.2500322461128235,-0.3106554448604584,-0.0779966488480568,0.33316949009895325,0.10303963720798492,-0.07926375418901443,-0.22824740409851074,0.2877211272716522,-0.31292828917503357,0.2387048304080963,0.06558380275964737,0.14080917835235596,-0.062436264008283615,-0.14607641100883484,0.2961823344230652,0.16223599016666412,0.20061704516410828,-0.40229639410972595,0.2784792184829712,-0.229485884308815,-0.06743573397397995,0.12863633036613464,-0.20408189296722412,0.1551462709903717},{-0.07112009078264236,-0.08772078901529312,-0.12029697000980377,0.14903812110424042,0.21580226719379425,-0.1714090257883072,-0.4229520857334137,-0.0989673063158989,-0.09783784300088882,-0.2854083776473999,0.11332693696022034,0.2347225695848465,-0.021616004407405853,-0.11679922044277191,-0.10023180395364761,0.12165603786706924,-0.039805203676223755,-0.06400471925735474,-0.3257957696914673,-0.19592039287090302,-0.14636316895484924,-0.38410449028015137,0.14403052628040314,0.15129932761192322,-0.12193495780229568,0.373877614736557,-0.1892782598733902,0.18268729746341705,0.3466581106185913,0.37707874178886414,-0.06178836151957512,0.3983880281448364},{-0.3219108283519745,0.025743387639522552,-0.2597256600856781,-0.07573598623275757,-0.21834726631641388,0.25614070892333984,0.2249867022037506,0.029506517574191093,0.2406601458787918,0.2625296413898468,0.34744560718536377,-0.2548949122428894,-0.2874559164047241,0.18789277970790863,0.34946271777153015,-0.31167876720428467,-0.13927698135375977,-0.2534644305706024,0.21075904369354248,0.11404923349618912,0.09131942689418793,0.20405490696430206,0.0954885333776474,-0.08040087670087814,-0.3780270516872406,0.38860276341438293,-0.1379961371421814,0.22347281873226166,0.3637467324733734,0.16018415987491608,0.052824508398771286,0.006396245211362839},{0.21239516139030457,-0.1369529366493225,-0.13993032276630402,-0.3519333004951477,-0.06625308096408844,0.22243477404117584,0.32743582129478455,0.18959350883960724,0.06617031991481781,0.39016202092170715,-0.0004941616207361221,-0.028358224779367447,-0.45922330021858215,-0.1769304722547531,-0.15115924179553986,0.16487441956996918,-0.3110930025577545,-0.23820610344409943,0.2027900516986847,-0.08019597083330154,-0.12706610560417175,-0.1430463343858719,-0.21286451816558838,-0.21072517335414886,0.15789827704429626,-0.2643912434577942,-0.07244466245174408,-0.22434964776039124,0.3031855821609497,0.08658012747764587,-0.1801423728466034,-0.30594879388809204},{0.007121872156858444,0.16072022914886475,0.05301620066165924,-0.006608827039599419,0.11788811534643173,-0.33838900923728943,-0.13121183216571808,-0.19012333452701569,-0.020229212939739227,-0.22249403595924377,-0.3087735176086426,-0.052582889795303345,-0.11720064282417297,-0.020842239260673523,-0.12302963435649872,0.357882022857666,-0.03743104636669159,-0.19207964837551117,0.108401820063591,0.324195921421051,-0.09840565919876099,-0.2538679540157318,0.27219438552856445,0.08609935641288757,-0.051245130598545074,-0.3170779347419739,-0.3039705455303192,-0.3252656161785126,-0.328078955411911,-0.2611154019832611,0.02081288956105709,-0.29211756587028503},{0.11081791669130325,0.340096652507782,-0.26300889253616333,-0.3425701856613159,-0.23791098594665527,0.08777462691068649,0.05688176676630974,0.09325665980577469,0.11949239671230316,-0.29325711727142334,-0.1805311143398285,0.34073376655578613,-0.2552386522293091,-0.18812336027622223,0.19477578997612,-0.2727421224117279,0.2721541225910187,0.16880759596824646,0.3687523305416107,0.03372768312692642,0.19620798528194427,0.08373793214559555,0.27394333481788635,-0.09897077083587646,0.3956749141216278,-0.2490861415863037,0.14072218537330627,0.3357633948326111,-0.2983171343803406,0.22515511512756348,0.01494638342410326,0.15064756572246552},{-0.18703784048557281,0.11509902775287628,-0.2559909522533417,-0.16411688923835754,0.1842179000377655,-0.16499508917331696,0.11370208114385605,0.002243906958028674,0.1505761444568634,-0.031344298273324966,-0.27826884388923645,-0.3144747018814087,-0.3381607234477997,-0.05019454285502434,-0.26096487045288086,0.11072450131177902,0.06106125935912132,-0.20334722101688385,0.24496768414974213,0.12023504078388214,0.0020435103215277195,-0.011671909131109715,0.28652530908584595,-0.1915978640317917,0.3194163143634796,0.09984482824802399,-0.2687253952026367,0.01737373135983944,-0.03263437747955322,0.10689226537942886,-0.12785115838050842,0.07399845868349075},{0.1146094873547554,0.06052442640066147,0.18924890458583832,-0.2912788391113281,-0.3827260434627533,-0.24873845279216766,-0.287418395280838,0.04273431748151779,-0.2635796368122101,0.47586363554000854,0.1843123733997345,-0.2119738906621933,-0.4196476340293884,-0.10665679723024368,-0.17087219655513763,-0.08711519092321396,0.1600603461265564,-0.1935526728630066,0.30931180715560913,-0.13190500438213348,-0.15001781284809113,-0.005766019225120544,0.2276654839515686,0.21991389989852905,0.1825731247663498,-0.1697288304567337,0.041218556463718414,-0.10402721166610718,-0.047038931399583817,0.025899158790707588,-0.041986674070358276,0.14389415085315704},{-0.16135135293006897,-0.11680608242750168,0.2158253788948059,0.2872757613658905,0.270171582698822,-0.029855968430638313,0.06475400924682617,-0.22038593888282776,-0.03556611388921738,-0.2756885290145874,0.25702965259552,-0.2200392484664917,-0.1839989423751831,-0.19739288091659546,0.2502496838569641,-0.006620606407523155,-0.0006979739991948009,0.03508402407169342,0.3657110929489136,0.05016391724348068,-0.18288113176822662,0.22598585486412048,0.10804161429405212,-0.06426034867763519,0.24202004075050354,-0.10603780299425125,-0.16624632477760315,0.21653297543525696,0.15863458812236786,0.023072710260748863,-0.28678587079048157,-0.23218117654323578},{0.33990710973739624,-0.26457691192626953,0.020446576178073883,-0.2781431972980499,-0.07204169034957886,-0.19044874608516693,0.050011444836854935,0.183041512966156,0.21282628178596497,0.07851442694664001,0.18752865493297577,0.3169569969177246,-0.42234840989112854,-0.4322516918182373,-0.01317659206688404,-0.23468594253063202,-0.3058284819126129,-0.3708651661872864,0.36442995071411133,-0.17715756595134735,0.39357295632362366,-0.16607457399368286,0.049145352095365524,0.18596898019313812,0.1404789537191391,-0.1385239064693451,0.15608882904052734,-0.012617056258022785,0.12426374852657318,0.03427498787641525,-0.30713510513305664,0.05378791317343712},{0.27191081643104553,-0.03882886841893196,-0.0149324219673872,0.3656384348869324,-0.10013606399297714,-0.1873430758714676,-0.03567568585276604,0.16547659039497375,0.19031493365764618,0.262932687997818,0.12037627398967743,-0.11110739409923553,0.05687812343239784,0.2007043957710266,-0.10856185108423233,0.11944886296987534,0.22477976977825165,-0.24948936700820923,0.10614529252052307,-0.3585398495197296,0.2702149748802185,0.145173579454422,-0.09946861118078232,0.20704105496406555,0.2505737543106079,0.07929114252328873,0.14927451312541962,0.07362992316484451,0.0891999825835228,-0.14602237939834595,0.013027701526880264,0.3803883194923401},{0.06482819467782974,-0.20360398292541504,-0.012831034138798714,0.07864221185445786,-0.28434693813323975,0.005083250813186169,0.06269969791173935,-0.1955391764640808,-0.17606931924819946,-0.011714915744960308,0.19388794898986816,0.1936461627483368,0.07488519698381424,0.24475446343421936,-0.03476707264780998,-0.016662128269672394,-0.2202008068561554,0.27542901039123535,-0.07295205444097519,-0.2013053447008133,-0.21097500622272491,-0.08624785393476486,0.15514105558395386,0.05001918226480484,0.003324350109323859,-0.14281940460205078,-0.1789100617170334,0.22624145448207855,0.059289272874593735,-0.1552879363298416,0.26968440413475037,0.14530113339424133},{0.17144928872585297,-0.2252296805381775,0.010264700278639793,-0.20151114463806152,-0.018680673092603683,0.15580077469348907,0.07341891527175903,0.27920275926589966,-0.11119723320007324,-0.0177508145570755,0.2405957728624344,0.1118910014629364,0.05447907745838165,-0.1001853421330452,-0.016092846170067787,0.21306444704532623,-0.34992074966430664,-0.2020757645368576,-0.037102021276950836,0.07442767918109894,0.03073885291814804,0.2580116093158722,0.1677624136209488,0.1822149157524109,0.060415927320718765,0.1777450442314148,-0.012333782389760017,-0.06021443381905556,0.10088769346475601,-0.11550218611955643,-0.25216177105903625,0.31585079431533813},{0.13556024432182312,0.025561440736055374,-0.392591267824173,0.1036302000284195,0.05672088637948036,-0.01023796945810318,0.3665834665298462,0.10161762684583664,0.07204220443964005,-0.11715678870677948,0.21558627486228943,-0.29087594151496887,-0.4520210027694702,0.27713558077812195,0.08374200761318207,0.07670684158802032,0.004975182004272938,-0.07362251728773117,-0.1764453947544098,0.05253954976797104,-0.07427627593278885,0.26768210530281067,0.09023381769657135,-0.17306968569755554,-0.08984404057264328,-0.20703351497650146,0.05787988752126694,0.37172579765319824,0.22965890169143677,-0.23337839543819427,0.20497490465641022,0.14345189929008484},{-0.07883909344673157,0.000490164034999907,-0.08651511371135712,-0.08417999744415283,-0.23701083660125732,-0.019740261137485504,0.23859235644340515,0.18148012459278107,0.1307450830936432,0.005786564201116562,0.19271241128444672,-0.019814500585198402,0.21607644855976105,0.21650926768779755,0.170942485332489,-0.0835086852312088,0.13232770562171936,0.19609658420085907,0.21228955686092377,0.04188025742769241,0.16318035125732422,0.3000018298625946,0.08337707817554474,0.16300581395626068,-0.029882177710533142,-0.07067248970270157,-0.13279691338539124,-0.22342553734779358,0.13019798696041107,-0.2832077443599701,0.04705408588051796,-0.0819271057844162},{-0.3529151976108551,0.02244909480214119,-0.36910343170166016,-0.33730676770210266,0.03336375579237938,-0.021667996421456337,0.15473446249961853,-0.1797509789466858,0.07157519459724426,0.3856092393398285,0.002783963456749916,-0.2576669454574585,0.049425169825553894,-0.18795844912528992,-0.3327898681163788,0.026400625705718994,-0.19224625825881958,0.11968296021223068,-0.11145409196615219,-0.00036463700234889984,-0.29090192914009094,0.15757238864898682,0.1025637537240982,0.06286048144102097,-0.09344929456710815,0.35566261410713196,0.03738025203347206,-0.21929751336574554,-0.2000095397233963,-0.014459647238254547,-0.23379215598106384,-0.27563172578811646},{-0.007044729311019182,-0.2592748701572418,-0.2883427143096924,-0.05248625576496124,-0.32179415225982666,-0.15031477808952332,0.18582509458065033,-0.28547149896621704,-0.2293446958065033,0.17891180515289307,0.18925805389881134,0.08034588396549225,0.1122090145945549,-0.1406703144311905,0.2777610719203949,-0.26682737469673157,0.09250270575284958,0.26911190152168274,0.041323255747556686,0.2838803827762604,0.014204224571585655,-0.11513116955757141,-0.28798943758010864,0.2279408723115921,-0.11316728591918945,-0.1556748002767563,0.11154484003782272,0.04034528136253357,-0.11460590362548828,-0.3383927345275879,-0.037101346999406815,-0.19204707443714142},{0.22520437836647034,0.07708553969860077,-0.06809107214212418,0.2265617400407791,-0.24006018042564392,0.06850279867649078,-0.08723077923059464,-0.22758758068084717,-0.0573979988694191,0.24241574108600616,-0.3725852370262146,-0.15087683498859406,0.06241984665393829,-0.20185793936252594,-0.40938711166381836,-0.189500629901886,-0.12370316684246063,-0.33789047598838806,-0.29298335313796997,0.2349233329296112,0.18189913034439087,0.05585314705967903,-0.40434694290161133,0.34572622179985046,0.13660694658756256,0.3210289180278778,-0.3498416841030121,-0.1497359573841095,0.09756913036108017,-0.21603204309940338,0.07905343174934387,0.17510925233364105},{-0.05133331939578056,-0.2953279912471771,-0.044294197112321854,-0.30948224663734436,-0.06605207175016403,0.2998638451099396,0.20395515859127045,0.029766730964183807,-0.1128624677658081,0.005228963680565357,-0.1570020467042923,0.09579556435346603,0.09844446927309036,0.07054325193166733,0.12154201418161392,0.035205308347940445,-0.07454708963632584,0.15428219735622406,-0.11225499212741852,0.15563224256038666,0.1880348175764084,0.26153531670570374,-0.03946077823638916,-0.24926060438156128,0.170057013630867,0.1593603938817978,0.27684804797172546,0.17365717887878418,0.028505031019449234,0.10495575517416,0.022179942578077316,-0.10458263754844666},{-0.0004212450294289738,-0.21750761568546295,0.26378875970840454,0.04491033777594566,0.3081563711166382,-0.03685469925403595,-0.1327737420797348,-0.19087818264961243,0.15891346335411072,-0.05441520735621452,0.06374245882034302,0.018722085282206535,-0.26882362365722656,0.06477842479944229,-0.11190175265073776,-0.2622781991958618,-0.037314482033252716,-0.04561075568199158,0.18190698325634003,0.21225452423095703,0.0298629030585289,0.03467564284801483,0.14625053107738495,0.3199194669723511,-0.16056887805461884,-0.05768883600831032,0.1551472693681717,-0.08584839105606079,-0.16741825640201569,-0.23956407606601715,0.2952331304550171,0.014244787395000458},{0.1989690214395523,-0.07357180118560791,0.04599348083138466,0.12254723161458969,-0.04544970765709877,0.05921274796128273,-0.2543576657772064,0.3103612959384918,-0.12482252717018127,-0.04226963222026825,0.13223543763160706,-0.2931137681007385,0.0342411994934082,-0.061964523047208786,-0.10529342293739319,0.3175116777420044,-0.08346404880285263,-0.1868389993906021,0.04422248899936676,0.006661528721451759,-0.17962893843650818,0.17609243094921112,0.2248171716928482,0.2313614785671234,-0.2647673189640045,0.11189371347427368,-0.05757573992013931,0.0810224860906601,-0.2665765881538391,0.2598502039909363,-0.0486663319170475,0.04503296688199043}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.2603786587715149,-0.13103874027729034,0.14753788709640503,-0.2116250842809677},{0.20827223360538483,-0.2542732059955597,0.27589064836502075,0.2382645308971405},{-0.34403207898139954,0.0686480849981308,0.195072203874588,-0.05119206756353378},{0.2906375825405121,0.5019657611846924,0.3180609345436096,0.05037805810570717},{-0.3190184533596039,0.19208167493343353,-0.2907923758029938,0.1462600827217102},{-0.005103390663862228,-0.13538429141044617,0.07572388648986816,0.395693838596344},{-0.1047271341085434,-0.23308514058589935,-0.44194909930229187,-0.005798882804811001},{-0.11815427988767624,-0.3959685266017914,0.20521347224712372,-0.06664122641086578},{-0.13744021952152252,0.17785373330116272,-0.08164144307374954,-0.12436438351869583},{0.3198295533657074,-0.030374644324183464,-0.1596037596464157,-0.23918545246124268},{0.2525021433830261,-0.2541062831878662,0.3249105215072632,0.26140764355659485},{-0.09170890599489212,0.022522566840052605,0.485950231552124,-0.12211459875106812},{-0.34869328141212463,0.2759309411048889,-0.045961786061525345,-0.07207661867141724},{-0.20094354450702667,-0.012975209392607212,-0.2595251500606537,0.09578824043273926},{0.2029562145471573,-0.07146468758583069,0.23954567313194275,0.1274627298116684},{-0.1377580612897873,-0.3076874315738678,-0.12028495222330093,-0.08219335228204727},{-0.3347308039665222,0.05690309777855873,-0.07236392796039581,0.3582603633403778},{-0.3253280520439148,-0.14987093210220337,-0.24888159334659576,0.2324323207139969},{-0.0762522742152214,-0.1649167537689209,0.45523229241371155,0.0700041726231575},{-0.16585223376750946,-0.17696848511695862,-0.027785979211330414,-0.18305952847003937},{0.1676330715417862,0.14651009440422058,0.14867796003818512,-0.18165521323680878},{-0.0026531743351370096,-0.3213815689086914,-0.2077023833990097,0.33160632848739624},{0.308738112449646,-0.18533287942409515,0.22381803393363953,0.0429336354136467},{-0.3133906126022339,-0.038419052958488464,-0.282102108001709,-0.33837202191352844},{-0.2858080267906189,-0.184674471616745,0.03814568370580673,-0.15577472746372223},{0.2431340366601944,0.24115818738937378,-0.1274830847978592,0.17032139003276825},{0.18449828028678894,-0.22076290845870972,0.2705049514770508,0.08768261224031448},{-0.050684619694948196,-0.18146799504756927,0.004719881806522608,0.3497788608074188},{0.11606740951538086,0.03839399665594101,0.018895383924245834,0.025635162368416786},{-0.19379305839538574,0.11077771335840225,0.3245091140270233,0.01368965208530426},{-0.19643419981002808,-0.15768654644489288,0.07206997275352478,0.2598865330219269},{0.21685700118541718,0.23975186049938202,0.3107512593269348,-0.052753522992134094}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.011363761499524117,-0.012164914049208164,-0.006275426130741835,0.045060962438583374,0.05758386850357056,-0.062469255179166794,-0.022750776261091232,0.07331955432891846,-0.09597715735435486,-0.013026668690145016,0.007320689968764782,-0.004558314103633165,-0.02478090301156044,0.0642533153295517,-0.00682067172601819,-0.04470161721110344};
static const float actor_encoder_self_encoder_2_bias[16] = {0.007056474685668945,-0.008929232135415077,-0.011536980047821999,0.0019629187881946564,-0.05323740839958191,0.023312557488679886,-0.031255822628736496,-0.009686299599707127,0.031242219731211662,-0.04251895844936371,0.007418339140713215,-0.025185633450746536,-0.013366593047976494,-0.022022705525159836,-0.0020367621909826994,-0.022307198494672775};
static const float actor_encoder_feed_forward_0_bias[32] = {0.008648073300719261,0.04643445089459419,-0.010045959614217281,0.0035297402646392584,-0.011261729523539543,0.02615150809288025,-0.03020256571471691,-0.0015289192087948322,-0.004193335771560669,-0.025485895574092865,-0.008620006963610649,0.03204599395394325,0.021129487082362175,0.012668763287365437,0.03417156636714935,-0.034537173807621,0.017528202384710312,-0.007941233925521374,0.016783813014626503,-0.02976810559630394,-0.016983212903141975,0.028436329215765,-0.0053514097817242146,-0.03160800784826279,-0.043931588530540466,0.006678842008113861,0.02085907757282257,0.029018566012382507,-0.028311394155025482,0.030691273510456085,0.03215968236327171,-0.01008139830082655};
static const float action_parameterization_distribution_linear_bias[4] = {-0.006867618765681982,0.007908155210316181,0.00537455128505826,0.028302883729338646};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.392726331949234,-0.3678206205368042,-0.1447521150112152,0.22222991287708282,-0.22527433931827545,0.08781179040670395,-0.33664512634277344,0.04895725101232529},{0.2007463276386261,0.11985476315021515,0.4067062437534332,0.39064720273017883,-0.13528111577033997,-0.35476863384246826,0.31958580017089844,0.4111165404319763},{0.0699642226099968,0.1912161111831665,0.12233605235815048,-0.0324275977909565,0.3281562030315399,0.21464675664901733,-0.0010234869550913572,0.2598441541194916},{0.11063656955957413,-0.345973938703537,0.3488319516181946,-0.15073569118976593,-0.2308695912361145,0.10178089886903763,0.32797372341156006,0.26900365948677063},{-0.25894808769226074,-0.06819314509630203,-0.03770889714360237,-0.27088844776153564,0.14472562074661255,0.12668833136558533,0.3492221534252167,0.29560714960098267},{-0.0691097304224968,0.21160370111465454,0.001842186669819057,-0.20798605680465698,0.3465343713760376,0.12493927776813507,0.10878602415323257,-0.1540459394454956},{-0.0014733239077031612,0.18399377167224884,0.15169645845890045,-0.15309368073940277,0.44186869263648987,-0.10990912467241287,0.1684814840555191,0.11837713420391083},{0.05767756327986717,-0.4138970375061035,-0.037525467574596405,-0.2317463904619217,0.2866731584072113,0.026203332468867302,-0.15771804749965668,-0.31414568424224854},{-0.26271289587020874,0.19743001461029053,-0.025781478732824326,-0.09185204654932022,-0.023659927770495415,0.43162086606025696,0.3634983003139496,0.28926989436149597},{-0.006447096820920706,-0.12143551558256149,-0.27885106205940247,0.2742981016635895,0.27656036615371704,0.3186165690422058,0.3469546437263489,-0.31779035925865173},{-0.1700228601694107,-0.36622127890586853,0.36069896817207336,0.17539836466312408,0.006912808399647474,-0.25419557094573975,0.021435970440506935,-0.3322417438030243},{0.22819283604621887,0.05192118510603905,0.4026179611682892,0.39776042103767395,-0.12291769683361053,0.33592426776885986,0.21036748588085175,-0.33608898520469666},{-0.3987977206707001,0.15026897192001343,-0.35109949111938477,0.43791964650154114,-0.02662084624171257,0.4391985237598419,0.03901558741927147,0.2656501233577728},{-0.07118219137191772,0.1886812299489975,-0.13265468180179596,-0.11055503040552139,0.009440213441848755,0.15312153100967407,0.31980347633361816,0.01285360474139452},{0.11575697362422943,-0.31392988562583923,-0.3533553183078766,-0.1613936722278595,0.12383714318275452,-0.16656967997550964,0.13273046910762787,-0.08388348668813705},{-0.46429115533828735,-0.3111873269081116,-0.2608082890510559,0.01041320338845253,-0.03748156130313873,0.21540552377700806,0.2279311716556549,-0.0674176961183548},{-0.1748090535402298,-0.28331947326660156,0.24931038916110992,-0.3391515612602234,0.008029364049434662,0.029076257720589638,-0.4126945734024048,-0.2542370855808258},{0.05760335549712181,0.23228131234645844,0.16048534214496613,0.20144779980182648,-0.10416953265666962,0.3385818600654602,0.2933213412761688,-0.18250438570976257},{0.05691782757639885,-0.33105018734931946,-0.062049780040979385,-0.05876956507563591,-0.14649826288223267,-0.33472996950149536,0.051002826541662216,-0.28979626297950745},{-0.03452148288488388,0.01698342338204384,0.12065180391073227,-0.30633416771888733,0.04235388711094856,0.11591844260692596,0.08300209045410156,-0.11489365249872208},{0.09209460765123367,-0.08687315136194229,0.07673511654138565,-0.26423606276512146,-0.009197109378874302,-0.0038775200955569744,-0.0224212147295475,-0.2388574182987213},{-0.3210974335670471,0.21149298548698425,0.14881661534309387,-0.24671851098537445,-0.47930043935775757,0.013257216662168503,0.13577474653720856,0.004693186841905117},{0.2806437313556671,0.13519343733787537,-0.40483033657073975,0.1221054196357727,-0.06446047127246857,0.23357319831848145,0.23802228271961212,0.2954019606113434},{-0.002296770690008998,-0.0981462299823761,-0.0018585838843137026,0.3096722364425659,-0.3141842186450958,-0.0561337023973465,-0.1540306806564331,-0.31619128584861755},{0.2134963572025299,0.10240335017442703,-0.42566147446632385,0.34955599904060364,-0.29598405957221985,-0.3447684645652771,-0.3338140547275543,0.18519291281700134},{0.04580758139491081,0.3810826539993286,-0.29910585284233093,-0.052500169724226,0.07565298676490784,-0.25341975688934326,0.3209523856639862,-0.2813817262649536},{-0.0685463398694992,0.08699642866849899,-0.15712235867977142,-0.1441514492034912,0.022358430549502373,-0.18886251747608185,-0.09697804600000381,-0.1309337615966797},{0.14789724349975586,-0.15780510008335114,-0.058820366859436035,-0.09771578758955002,-0.004217107780277729,0.0026580526027828455,-0.20218777656555176,0.09812027215957642},{0.36463335156440735,0.06583452224731445,-0.39970147609710693,-0.18562395870685577,-0.2604405879974365,0.10140284895896912,0.22817234694957733,0.08945044875144958},{0.4082062542438507,-0.2930028438568115,-0.03106633946299553,-0.029062114655971527,0.10989367216825485,-0.1292835772037506,0.2085827887058258,0.35516661405563354},{-0.2456207424402237,-0.1637711226940155,0.030906807631254196,-0.25052204728126526,0.321795791387558,-0.25189274549484253,0.05386708676815033,0.0899035781621933},{0.17689864337444305,0.017733391374349594,-0.15677952766418457,0.3303510546684265,0.07174472510814667,0.01808430813252926,-0.029680166393518448,0.01864815503358841}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2433939278125763,0.40527793765068054,-0.6190934777259827,-0.5877400636672974,-0.2894120514392853,0.04853265359997749,-0.42648330330848694,0.5637990236282349},{-0.027682965621352196,0.5327504277229309,-0.2159729301929474,0.5338655114173889,-0.01103894878178835,0.0509071908891201,-0.2335595190525055,0.009156129322946072},{-0.4656399190425873,-0.21291545033454895,-0.16758958995342255,-0.2297271341085434,0.5347834825515747,0.18211528658866882,0.02743319422006607,0.4333919584751129},{-0.490889310836792,-0.4963299632072449,0.3226665258407593,0.3469533324241638,-0.5166323184967041,-0.20706120133399963,0.535139799118042,0.19159947335720062},{-0.3286632001399994,-0.32830679416656494,-0.31946566700935364,-0.3359256386756897,0.33976995944976807,-0.3028845489025116,0.5330238938331604,-0.4794829487800598},{-0.07800120860338211,0.17363998293876648,0.3165190815925598,-0.562921941280365,0.5406618714332581,-0.3295159339904785,-0.43470001220703125,-0.32153576612472534},{-0.4191465377807617,0.17576400935649872,0.07916272431612015,-0.3684689700603485,-0.030858824029564857,-0.5447706580162048,0.49136313796043396,0.06364453583955765},{-0.3998506963253021,-0.3115540146827698,-0.22720050811767578,-0.43429702520370483,-0.3254893124103546,0.12532658874988556,0.5360049605369568,-0.29842880368232727}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.03525284677743912,-0.012975301593542099,-0.009647199884057045,0.014809781685471535,-0.040933758020401,-0.014316197484731674,-0.08914951980113983,0.025945819914340973};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.0060150399804115295,-0.029312077909708023,-0.0060997349210083485,0.0570448637008667,-0.03323367238044739,0.032448943704366684,-0.05095728859305382,0.03947218507528305};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

