#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.2995513677597046,-0.0303554218262434,-0.08441640436649323,0.3360815942287445,0.2657800316810608,-0.24777400493621826,-0.3479991555213928,0.09206521511077881,0.2920595407485962,-0.31893330812454224,0.4983138144016266,-0.05220714956521988,0.26918700337409973,0.16096645593643188,-0.41194427013397217,0.04973948001861572},{-0.261595219373703,-0.25941550731658936,-0.27580350637435913,-0.21821370720863342,0.11856132000684738,0.3251340687274933,0.09966938197612762,0.09936298429965973,0.1940976232290268,0.1801341027021408,-0.12505018711090088,-0.007178240921348333,-0.11951735615730286,0.0737394168972969,0.32625746726989746,-0.2771885097026825},{0.1294124722480774,0.2554573118686676,0.20838867127895355,0.3070758283138275,-0.09431666880846024,-0.18943867087364197,0.3967181444168091,-0.05610949173569679,0.021167494356632233,-0.05559127777814865,-0.08514052629470825,-0.0032460782676935196,0.04560508951544762,0.38387301564216614,-0.28123459219932556,-0.12709909677505493},{0.1424495130777359,-0.18037909269332886,-0.1189793273806572,-0.14557063579559326,0.06588160991668701,0.07391461730003357,0.08205355703830719,-0.21826915442943573,-0.18552623689174652,0.10951102524995804,0.4660421311855316,-0.234527587890625,-0.2065870314836502,-0.1029459610581398,0.1767030507326126,0.1307659149169922},{-0.33702731132507324,-0.02600627765059471,0.12095686048269272,-0.21815107762813568,0.26965585350990295,0.3273965120315552,0.14525015652179718,-0.2289678305387497,-0.18435007333755493,0.13894641399383545,-0.10340345650911331,-0.385684609413147,-0.049718957394361496,-0.17056065797805786,0.27842745184898376,-0.0181085504591465},{0.045469485223293304,-0.06411650776863098,-0.01432980876415968,-0.08861459791660309,0.12230519205331802,-0.160127654671669,0.4183369576931,-0.3161412179470062,-0.15974895656108856,-0.1723148673772812,0.33168062567710876,0.09643552452325821,0.2663061022758484,0.03991556540131569,0.30541616678237915,0.2658863663673401},{-0.2567967474460602,0.17120729386806488,-0.0895499736070633,0.047699980437755585,-0.24118919670581818,-0.09990199655294418,-0.15034012496471405,-0.018331801518797874,0.15922969579696655,0.3164476156234741,-0.3169455826282501,-0.10348934680223465,0.23538823425769806,0.09777715802192688,-0.2068626880645752,0.3518470823764801},{-0.09925977140665054,-0.04346168041229248,-0.0810384601354599,-0.11565403640270233,0.34799468517303467,-0.21890603005886078,-0.24221129715442657,-0.3796628713607788,-0.1597869098186493,-0.2549438178539276,0.35751450061798096,-0.019994527101516724,0.2080812156200409,0.14817853271961212,-0.15951964259147644,0.3588452637195587},{0.2500179708003998,0.09712865203619003,0.07197567075490952,0.03602644056081772,-0.3632761538028717,-0.4360949397087097,0.28800657391548157,-0.33614662289619446,-0.17552310228347778,0.2014247328042984,0.12876656651496887,-0.3355778753757477,-0.1889205425977707,0.1256764531135559,0.19919991493225098,-0.028540654107928276},{0.40373751521110535,-0.5339593887329102,-0.16773608326911926,-0.08706281334161758,0.19388315081596375,-0.29524168372154236,-0.2792503535747528,-0.25436529517173767,-0.1678926944732666,0.016333119943737984,-0.05654603987932205,-0.16777564585208893,0.38072049617767334,-0.08270510286092758,-0.465380996465683,-0.09354046732187271},{0.1945616602897644,0.18192999064922333,-0.2853895127773285,0.134279265999794,-0.018458034843206406,-0.2681947946548462,-0.15950049459934235,0.12018248438835144,-0.20640429854393005,0.15323466062545776,0.11331789195537567,0.2984689176082611,-0.14331422746181488,0.3099179267883301,-0.09355263411998749,-0.16494542360305786},{-0.45271632075309753,0.24401171505451202,0.24034783244132996,-0.2907409071922302,-0.4224250614643097,0.26603564620018005,-0.019304146990180016,0.27248331904411316,0.1685996800661087,0.21880388259887695,0.3170698583126068,-0.03417535498738289,0.034566301852464676,-0.09966990351676941,-0.13082915544509888,-0.15086665749549866},{0.1389768272638321,-0.27382487058639526,-0.20755788683891296,0.2796553373336792,-0.19416595995426178,-0.2906608581542969,-0.1737992763519287,0.2962108850479126,0.24491684138774872,-0.1779228001832962,-0.17504248023033142,0.1402173787355423,0.3288845121860504,0.1451742947101593,-0.1778116673231125,0.38833263516426086},{0.30408743023872375,0.18628616631031036,-0.1930909901857376,-0.08503805100917816,0.14476998150348663,-0.1595458686351776,-0.08819802105426788,0.27360305190086365,-0.2652170956134796,-0.21024395525455475,-0.1282198280096054,0.005330394022166729,-0.27367350459098816,-0.11829077452421188,-0.2846265137195587,-0.04636851325631142},{0.15014775097370148,0.37456604838371277,0.41418448090553284,-0.4245385527610779,-0.36203131079673767,0.07105352729558945,0.08465584367513657,-0.060919396579265594,0.3454315662384033,0.31534403562545776,-0.20617133378982544,0.11636653542518616,-0.014063742943108082,-0.30354052782058716,0.031171344220638275,-0.09845957159996033},{-0.2031223177909851,-0.2081577032804489,-0.14126752316951752,0.39194002747535706,-0.23123984038829803,-0.1550029069185257,-0.24998518824577332,-0.28881704807281494,-0.6013442873954773,-0.20904408395290375,0.39549732208251953,0.3175656497478485,-0.6036926507949829,-0.34709978103637695,-0.6297793984413147,-0.1165020614862442},{-0.5220139622688293,0.16722506284713745,-0.4284960627555847,-0.06755364686250687,-0.405006468296051,0.24666418135166168,0.48535633087158203,0.11921652406454086,0.4529293477535248,-0.43140196800231934,0.16174961626529694,-0.33997979760169983,-0.14781904220581055,-0.021547026932239532,-0.16022928059101105,-0.19808878004550934},{0.259573370218277,-0.5769475102424622,0.2847970128059387,0.32260867953300476,-0.119123674929142,0.5041453242301941,0.3061430752277374,0.26608040928840637,-0.12324714660644531,-0.3201354146003723,-0.12134405970573425,-0.15936534106731415,-0.0663430467247963,-0.46363314986228943,0.17871758341789246,-0.06215110048651695}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.06065921485424042,0.29666224122047424,0.2555164396762848,-0.12288516759872437,-0.25376132130622864,0.08239065110683441,-0.03764362633228302,0.32992690801620483,-0.09852930903434753,0.3178424537181854,0.4665505886077881,-0.38782015442848206,-0.004532130900770426,0.0317133404314518,0.029331615194678307,-0.13464097678661346},{-0.47299912571907043,0.20184950530529022,-0.2373991161584854,0.28001725673675537,0.27854689955711365,-0.20664677023887634,-0.32834306359291077,-0.2061464637517929,0.35598334670066833,0.2601926922798157,-0.04586690291762352,0.26219889521598816,-0.41024479269981384,0.19516485929489136,-0.24856826663017273,0.4735940396785736},{-0.31677597761154175,0.13683080673217773,-0.36341461539268494,0.1602228283882141,-0.4464922845363617,-0.3159871995449066,0.07573360204696655,0.11200527846813202,-0.2687053978443146,0.42483097314834595,0.28750690817832947,-0.18918178975582123,0.2003789246082306,-0.29960688948631287,-0.16854557394981384,-0.08986455947160721},{0.3626271188259125,-0.2595136761665344,0.12993517518043518,0.41969048976898193,-0.43636593222618103,-0.3038870394229889,0.2899170517921448,0.0628892183303833,0.29958412051200867,-0.08492479473352432,0.3539595603942871,0.10160121321678162,-0.22531165182590485,-0.026164758950471878,0.019072484225034714,-0.45389989018440247},{-0.4009634256362915,-0.06400061398744583,0.17344023287296295,-0.2812804877758026,0.15246444940567017,0.4853579103946686,-0.2673380970954895,0.30416810512542725,-0.2278844118118286,0.21973280608654022,-0.041120272129774094,-0.00045950431376695633,-0.2493990808725357,-0.014170913957059383,-0.2776283919811249,-0.1343774050474167},{0.07077628374099731,-0.31113529205322266,0.004920654464513063,-0.3418562710285187,0.24610622227191925,0.047374237328767776,-0.15218786895275116,-0.08291386812925339,-0.1279086172580719,0.3983648121356964,0.22766287624835968,-0.011214411817491055,-0.2868857979774475,0.09834946691989899,0.0213619414716959,-0.28994590044021606},{0.2798407971858978,-0.1409769058227539,0.35544708371162415,-0.28579047322273254,-0.38315537571907043,-0.09906287491321564,-0.3639966547489166,0.3311290442943573,-0.08451864868402481,-0.25158897042274475,-0.2157915234565735,-0.018017489463090897,-0.03066371940076351,-0.10574395209550858,0.4964370131492615,-0.35302844643592834},{-0.29020100831985474,0.38197633624076843,-0.06764964759349823,0.19355013966560364,-0.030977439135313034,-0.2131483107805252,-0.1981639713048935,0.06696489453315735,0.01826205663383007,0.5120357275009155,0.11532316356897354,-0.10374200344085693,0.04652034491300583,-0.2033376842737198,0.12034965306520462,0.18356363475322723},{0.0861993059515953,0.26607444882392883,-0.1741468459367752,-0.36228883266448975,0.35246333479881287,-0.20251955091953278,0.1067463755607605,-0.3141801059246063,0.17858350276947021,0.127897709608078,0.08009887486696243,0.14815016090869904,0.04036630690097809,-0.4646804928779602,-0.013490822166204453,0.1970457136631012},{-0.28893548250198364,0.06154654547572136,-0.31170204281806946,-0.37502777576446533,0.22703608870506287,-0.40780091285705566,-0.1817556619644165,0.2846897542476654,-0.17159725725650787,0.14557626843452454,-0.035914208739995956,-0.09005577117204666,-0.3834492564201355,0.09899646043777466,-0.2600165009498596,-0.28465691208839417},{-0.12993142008781433,-0.14211450517177582,0.0053270417265594006,-0.2499988079071045,-0.31321051716804504,-0.05119401589035988,0.1746285855770111,-0.43377986550331116,0.003277383279055357,-0.11547423899173737,0.28073444962501526,-0.0760301873087883,0.3269847333431244,0.18767467141151428,0.2276306003332138,0.22528347373008728},{-0.06761953234672546,-0.03424974903464317,-0.4099408984184265,0.3286140263080597,0.10586626082658768,0.1024966835975647,0.24827183783054352,0.17414440214633942,-0.442909836769104,0.18191517889499664,-0.31259092688560486,-0.22042931616306305,-0.352678120136261,0.4045961797237396,-0.3475804328918457,0.07555526494979858},{-0.21351808309555054,-0.5013765692710876,-0.1501854658126831,0.19128024578094482,-0.228633314371109,-0.039137404412031174,-0.08548232167959213,0.41317301988601685,0.4794464111328125,0.16276946663856506,-0.02651728317141533,-0.20607709884643555,0.17663268744945526,-0.41510123014450073,0.1080278754234314,-0.2340824455022812},{-0.31521493196487427,-0.43179312348365784,-0.2024146318435669,-0.1586645245552063,-0.448265016078949,0.5255177617073059,-0.15364187955856323,0.2113497406244278,-0.11717314273118973,-0.2406403124332428,-0.357549250125885,0.4485405385494232,-0.19210442900657654,-0.06590671092271805,-0.27988746762275696,0.371039479970932},{-0.4227481782436371,0.3340192437171936,-0.2363264262676239,0.1175205260515213,-0.39317840337753296,0.22247250378131866,-0.12365872412919998,-0.2789175808429718,0.14493560791015625,0.2864477038383484,-0.29217150807380676,0.07488337904214859,0.21901509165763855,-0.4166204333305359,-0.3373727798461914,-0.1553366631269455},{-0.13068044185638428,-0.3817504942417145,-0.4579410254955292,0.25073373317718506,0.06373085081577301,0.07941544055938721,-0.27592846751213074,0.22026245296001434,-0.3401305079460144,-0.26471954584121704,-0.31172043085098267,0.23590369522571564,-0.19203650951385498,0.123414546251297,0.09501679986715317,0.2727593183517456}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.10944667458534241,-0.07220272719860077,0.09054318815469742,-0.15595071017742157,-0.13419175148010254,0.09679324179887772,0.17703461647033691,-0.24170951545238495,-0.11161435395479202,0.2950311303138733,0.09785144031047821,0.15225796401500702,0.11416348814964294,0.1983066350221634,-0.19146418571472168,0.12927645444869995,0.1215844452381134,-0.34830814599990845,-0.27744370698928833,-0.089047372341156,-0.1668013334274292,0.1323293298482895,-0.24397805333137512,0.3076004087924957,-0.07888146489858627,-0.009262895211577415,0.1573815941810608,0.17659428715705872,-0.27847281098365784,-0.21624250710010529,0.23202365636825562,0.2889660894870758},{0.23492154479026794,-0.05194426700472832,0.15707825124263763,-0.08889486640691757,-0.13259916007518768,0.2546224296092987,-0.019863082095980644,-0.08119948208332062,-0.052364252507686615,-0.016578173264861107,-0.12776634097099304,0.016731413081288338,0.41049930453300476,0.18560363352298737,0.15424974262714386,0.09704679995775223,-0.2628217041492462,-0.3540000021457672,0.11568071693181992,0.043620556592941284,0.048516564071178436,0.3057788908481598,0.22487525641918182,-0.23993025720119476,0.07846768945455551,0.2767162322998047,-0.30177491903305054,0.18376582860946655,0.13982748985290527,-0.2297343909740448,-0.0461951419711113,-0.02163691259920597},{-0.12163754552602768,-0.04923573508858681,0.21330656111240387,-0.2019629329442978,-0.25361186265945435,-0.0012007358018308878,-0.20340614020824432,0.1901990920305252,0.19876983761787415,-0.03206274285912514,-0.14434048533439636,0.04537127539515495,0.3143157660961151,-0.16712404787540436,0.08089395612478256,-0.05517345666885376,-0.34402361512184143,0.2578941285610199,-0.31400901079177856,-0.013927309773862362,-0.016838787123560905,-0.11244146525859833,-0.08186357468366623,-0.10249294340610504,0.04205506294965744,0.34998416900634766,-0.038033466786146164,0.06256021559238434,0.23079335689544678,-0.33768877387046814,-0.17792542278766632,-0.04646031931042671},{0.16266688704490662,-0.19811496138572693,0.0635060966014862,-0.3967571258544922,0.17230655252933502,-0.08032740652561188,-0.03200975060462952,0.26007550954818726,0.0442202053964138,0.21844469010829926,0.07560160756111145,-0.15566383302211761,-0.21719945967197418,-0.09436295181512833,0.2889595627784729,-0.24551387131214142,0.06713298708200455,-0.09907512366771698,-0.1480543315410614,0.08855750411748886,-0.13767942786216736,0.09388470649719238,-0.1984633058309555,0.29658612608909607,-0.32928067445755005,0.05057947710156441,-0.09208440035581589,-0.23005178570747375,0.017378732562065125,0.056446462869644165,0.23174342513084412,-0.10172313451766968},{0.2163337767124176,0.002536228857934475,0.03273529186844826,0.27049875259399414,-0.2971326410770416,-0.09331730008125305,0.16035901010036469,-0.0963953360915184,0.09834213554859161,-0.22386234998703003,0.022433822974562645,-0.05011289194226265,-0.1159902811050415,-0.08413957804441452,0.2832256853580475,0.3048444092273712,-0.1041637733578682,-0.3363347351551056,0.17195981740951538,-0.07488561421632767,-0.13165833055973053,0.2095651924610138,0.25951871275901794,0.04816940426826477,-0.028934789821505547,-0.10606969147920609,-0.01925099454820156,0.2572573125362396,0.2369215041399002,0.0901418924331665,0.06781283020973206,-0.3036755621433258},{0.3073199689388275,-0.18379704654216766,0.08271770924329758,0.061070702970027924,-0.1530066579580307,-0.29029786586761475,-0.16395635902881622,-0.270474374294281,-0.26740115880966187,-0.006105465814471245,0.018060436472296715,-0.06067698821425438,-0.17049092054367065,-0.030592018738389015,-0.22352728247642517,-0.2612138092517853,0.2029561549425125,0.05350209027528763,-0.26521021127700806,0.23143497109413147,-0.01257367990911007,-0.24510668218135834,0.21472308039665222,-0.136509507894516,-0.1558060348033905,-0.284123033285141,-0.10981954634189606,0.09819568693637848,0.09329378604888916,0.28496572375297546,-0.3206365704536438,0.15071681141853333},{0.2163519412279129,0.026839129626750946,0.24866709113121033,-0.2069217711687088,0.2497481405735016,-0.1412249654531479,-0.2573791742324829,0.026797397062182426,0.2969474792480469,0.21368107199668884,-0.18314802646636963,0.06284452229738235,0.07595237344503403,0.3333307206630707,0.12677142024040222,-0.11331745982170105,-0.188802570104599,0.14914943277835846,-0.019076477736234665,0.0031119966879487038,-0.12706702947616577,0.2701755464076996,0.17990919947624207,0.2144778072834015,-0.3004404604434967,-0.2785321772098541,-0.27468571066856384,-0.39910581707954407,-0.006927259732037783,-0.08185349404811859,0.2627004086971283,0.15629731118679047},{0.32809293270111084,-0.37463057041168213,0.14594583213329315,-0.43112510442733765,-0.2532937824726105,0.35842642188072205,0.433614581823349,0.19263222813606262,-0.1004939153790474,0.07288358360528946,0.17091083526611328,-0.19184228777885437,0.11154978722333908,0.3052925765514374,-0.02857782691717148,0.18966977298259735,0.42155948281288147,-0.17118379473686218,-0.05238846689462662,-0.29081711173057556,0.1568109393119812,0.24861519038677216,0.2808275520801544,0.1971035599708557,0.05833778902888298,0.05851438269019127,0.10127720236778259,0.22585339844226837,-0.22173994779586792,-0.18652604520320892,0.23145951330661774,0.01169757079333067},{-0.04698986932635307,-0.004070698283612728,0.2302093207836151,0.2559698224067688,-0.2037670612335205,-0.3895072937011719,-0.06512317061424255,0.22378963232040405,-0.21009008586406708,-0.34221842885017395,0.14975184202194214,0.15208595991134644,0.08486226946115494,-0.2977938652038574,0.1119607537984848,-0.15781168639659882,-0.1724979430437088,0.1289810985326767,-0.2377246916294098,0.2752162516117096,-0.22517640888690948,-0.43951287865638733,-0.31073009967803955,0.1867954432964325,0.13956613838672638,0.16341929137706757,0.27515700459480286,0.23691874742507935,-0.1315305531024933,-0.33098694682121277,-0.1668495237827301,0.16554908454418182},{0.37276509404182434,-0.008295966312289238,0.0033519312273710966,0.14105461537837982,0.0948110893368721,0.2804756760597229,0.023985739797353745,0.36204034090042114,-0.07687674462795258,0.1087798923254013,0.1469496786594391,0.042749978601932526,-0.23371808230876923,-0.44928085803985596,0.13503983616828918,0.18968404829502106,0.10800721496343613,-0.15320232510566711,-0.030212735757231712,-0.1063942164182663,0.16459575295448303,-0.35624074935913086,0.2956736981868744,0.028207095339894295,-0.09325777739286423,0.12959347665309906,-0.29804956912994385,-0.15942400693893433,0.06818046420812607,0.04109799116849899,0.1499847024679184,0.30737024545669556},{-0.11864397674798965,0.06599117070436478,-0.16173198819160461,0.16463813185691833,-0.1541057825088501,0.2514168322086334,0.08259187638759613,-0.06321455538272858,0.34953007102012634,-0.27214163541793823,-0.16313476860523224,0.17212806642055511,-0.14568358659744263,0.050364188849925995,-0.3295861780643463,-0.049377165734767914,0.11415164917707443,0.15437714755535126,0.0064453487284481525,-0.15964540839195251,-0.2547021508216858,0.21452800929546356,0.15989144146442413,0.2058468759059906,-0.26958343386650085,0.38606223464012146,-0.06611524522304535,-0.05582504719495773,-0.15001550316810608,0.09873628616333008,0.23901718854904175,0.27590203285217285},{-0.28204330801963806,0.36813482642173767,-0.02310735173523426,0.02924034558236599,-0.22057487070560455,-0.24580739438533783,0.15799513459205627,-0.32624614238739014,-0.11559376865625381,-0.3863956034183502,-0.10703570395708084,-0.026310255751013756,0.16460615396499634,-0.2385045737028122,-0.1247788816690445,-0.2914547622203827,-0.20013108849525452,-0.04844020679593086,0.3751242458820343,-0.27097979187965393,0.1656869500875473,-0.29198530316352844,0.0587562620639801,0.23929278552532196,-0.11807078868150711,0.18350350856781006,0.22912174463272095,-0.04692810773849487,0.003816355485469103,0.29211464524269104,-0.227100670337677,-0.31288352608680725},{0.008647190406918526,0.24149875342845917,0.17453259229660034,-0.25249719619750977,0.2707015573978424,0.009795119985938072,-0.1809249222278595,-0.008122761733829975,0.18295256793498993,-0.23115792870521545,-0.11694978922605515,0.07223141193389893,0.17085802555084229,-0.039831798523664474,0.07030820101499557,-0.044946640729904175,0.1917557418346405,-0.3333791494369507,0.28928500413894653,0.015428564511239529,-0.2059766948223114,0.246008962392807,-0.1302870661020279,-0.2693919241428375,0.234076589345932,-0.04245935007929802,0.031863126903772354,-0.09403327852487564,0.11177729070186615,-0.16739214956760406,0.37731024622917175,0.3058159649372101},{0.022921882569789886,-0.2873148024082184,-0.22138014435768127,0.05134294927120209,-0.06726069748401642,0.2815491855144501,-0.1484505832195282,-0.3938628137111664,0.399476557970047,0.0642319917678833,0.027030693367123604,0.03999892994761467,-0.04553644731640816,0.27898332476615906,-0.2504856288433075,-0.3938382565975189,0.032214000821113586,0.0745348334312439,0.1335545927286148,0.5081050992012024,-0.32450273633003235,0.2483137995004654,-0.18729476630687714,0.16372211277484894,0.18456877768039703,-0.3711809813976288,-0.15345649421215057,-0.40624454617500305,-0.2485223412513733,-0.18306565284729004,0.12990207970142365,-0.4659826159477234},{-0.14003361761569977,0.3858274221420288,-0.015737606212496758,-0.14066438376903534,-0.21353890001773834,-0.3170434534549713,0.051334161311388016,-0.17180339992046356,0.37645259499549866,-0.057149093598127365,0.19952352344989777,0.29774153232574463,0.020191548392176628,0.10039030015468597,-0.16707946360111237,0.1612311154603958,-0.223946675658226,-0.44419121742248535,-0.38945573568344116,0.08749809861183167,0.10612639784812927,-0.196133092045784,-0.414065957069397,-0.2870633006095886,-0.07732626050710678,0.2077026218175888,0.41343313455581665,0.017811890691518784,-0.12665987014770508,-0.040599673986434937,-0.03400413691997528,0.10425900667905807},{-0.2437247633934021,-0.1777675896883011,-0.20563335716724396,0.06582856923341751,-0.27011576294898987,-0.1516994833946228,-0.10325659066438675,-0.1573476642370224,-0.3019416928291321,-0.2631100118160248,0.19787952303886414,0.1722775101661682,-0.2645137906074524,0.29023584723472595,-0.055517565459012985,0.17058564722537994,0.06968753784894943,0.018680941313505173,0.050457753241062164,0.16483566164970398,0.1938004493713379,0.2617371380329132,0.11964722722768784,0.2619079649448395,0.11619966477155685,-0.22799663245677948,-0.17832247912883759,0.23386013507843018,-0.06036915257573128,-0.20510707795619965,-0.1762850284576416,-0.21698258817195892},{-0.261478066444397,-0.1878485381603241,-0.3393583595752716,0.11760124564170837,-0.08097381889820099,-0.05672036111354828,-0.11482710391283035,0.11904671788215637,-0.08281157910823822,0.0834648609161377,-0.24021922051906586,0.02320910058915615,0.17721186578273773,-0.09327537566423416,0.06820692121982574,0.23901714384555817,-0.1448344588279724,-0.1553610861301422,0.1952679604291916,0.06841795891523361,0.1844700574874878,-0.007923411205410957,-0.19192016124725342,0.04807775467634201,0.20702286064624786,-0.2672592103481293,0.12281859666109085,0.08647256344556808,0.09017889201641083,-0.14524757862091064,0.24535800516605377,-0.05779184401035309},{0.23704665899276733,-0.04277806356549263,0.0186917781829834,0.14677093923091888,-0.3259785771369934,-0.020277848467230797,0.12711551785469055,0.18919676542282104,-0.0662425085902214,-0.14170175790786743,0.31300103664398193,-0.14578792452812195,0.03992856293916702,-0.012520893476903439,-0.1639065444469452,0.23100176453590393,-0.0069115436635911465,-0.08085872232913971,0.10575278103351593,-0.27245205640792847,-0.009216856211423874,-0.2591266930103302,-0.20965760946273804,0.2651095688343048,-0.06019953638315201,-0.08315328508615494,0.14519740641117096,0.014281120151281357,-0.2001095414161682,-0.05253304913640022,-0.07109986245632172,-0.07631076127290726},{0.3171111047267914,-0.05858525261282921,0.11328446865081787,0.045766375958919525,-0.019579872488975525,-0.08578082174062729,0.19768482446670532,-0.2309633046388626,0.23511849343776703,0.2913097143173218,0.03378532826900482,0.13347357511520386,0.23513442277908325,0.34191322326660156,-0.2732248306274414,-0.3276428282260895,-0.26600366830825806,0.07598298043012619,-0.12999503314495087,-0.2692292034626007,-0.16249941289424896,0.2533723711967468,0.07329777628183365,0.14158356189727783,-0.14441050589084625,-0.1320449262857437,-0.14853323996067047,-0.22292450070381165,0.2611532211303711,0.19984260201454163,-0.3269703984260559,-0.13970312476158142},{-0.13071705400943756,0.15883739292621613,0.2647450566291809,-0.05724075064063072,-0.06173913925886154,0.037469930946826935,-0.019477611407637596,-0.3336883783340454,0.20578855276107788,0.21978779137134552,0.19064126908779144,0.23508693277835846,-0.22535809874534607,0.23771286010742188,-0.2923559844493866,0.28663644194602966,0.16914129257202148,-0.24984803795814514,0.2351871281862259,0.12189093232154846,-0.31980058550834656,0.31059229373931885,-0.28694817423820496,0.14289161562919617,0.26874369382858276,0.2719126045703888,0.08771565556526184,0.1371440589427948,-0.19749970734119415,0.20605333149433136,-0.0635373517870903,0.09822753816843033},{-0.11685630679130554,-0.10195651650428772,0.016303768381476402,0.1787625253200531,0.0270213820040226,0.21789181232452393,-0.26828813552856445,-0.08664021641016006,-0.1474747657775879,-0.08497915416955948,-0.15443016588687897,-0.17873692512512207,0.010097261518239975,-0.1963399350643158,0.09687522053718567,-0.1971631646156311,0.24316748976707458,-0.03410910442471504,-0.30751800537109375,-0.2817917466163635,0.14063547551631927,0.14897747337818146,-0.1807476133108139,0.29630815982818604,-0.2583039104938507,0.06227273494005203,0.11414232105016708,-0.07570952922105789,0.16691277921199799,-0.21388967335224152,0.3134421706199646,0.1599680483341217},{0.3329770267009735,0.051471829414367676,0.11445991694927216,0.20531441271305084,-0.21438373625278473,0.17879490554332733,-0.0732453241944313,0.18753021955490112,0.07609120011329651,0.04359555244445801,0.09855372458696365,-0.3395072817802429,-0.27045348286628723,0.009367842227220535,0.11367742717266083,-0.06940994411706924,0.264383465051651,0.15123966336250305,-0.1599833071231842,-0.22240234911441803,0.3298948109149933,0.17964743077754974,0.2832481563091278,0.08405230194330215,-0.04042677953839302,0.04159827530384064,-0.07977542281150818,-0.1519528031349182,0.2997305393218994,0.047192350029945374,-0.1956419199705124,0.11455820500850677},{-0.023264674469828606,0.02651290036737919,-0.06283337622880936,-0.22879765927791595,-0.09508781880140305,-0.2362319976091385,-0.23529104888439178,-0.16020755469799042,-0.003914287313818932,-0.023452945053577423,-0.27024850249290466,0.0306994691491127,-0.21655651926994324,-0.13847243785858154,0.004228962119668722,0.10464724898338318,0.2598986029624939,-0.18533489108085632,-0.3373035490512848,0.2619698643684387,-0.1850152164697647,0.2850971519947052,0.020061273127794266,-0.039895616471767426,0.04952378198504448,0.15582776069641113,-0.08379153162240982,-0.24868382513523102,0.21686653792858124,0.2364812195301056,-0.123444102704525,0.18165183067321777},{-0.2753213047981262,-0.028335852548480034,0.026603983715176582,-0.026979265734553337,0.07493315637111664,0.11576242744922638,-0.18473930656909943,0.11105819046497345,-0.1631208211183548,-0.18352149426937103,0.11745069175958633,-0.1269267350435257,-0.20004616677761078,0.2310175895690918,-0.0022635345812886953,0.01500775944441557,0.20739224553108215,-0.24698415398597717,-0.1719483882188797,0.26982012391090393,0.04689330235123634,0.22051145136356354,-0.05434909090399742,0.006704654078930616,-0.271125465631485,-0.16495129466056824,0.027143660932779312,0.2863050699234009,-0.004750021733343601,-0.004536484833806753,0.27621105313301086,0.2925969958305359}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{0.03508659824728966,0.25229647755622864,0.4520375430583954,-0.07466134428977966},{0.15573570132255554,-0.173984095454216,0.07092493772506714,0.2625313103199005},{-0.1955125778913498,0.18235459923744202,0.15870511531829834,0.14197681844234467},{0.30774644017219543,-0.00032443314557895064,0.05667562037706375,0.5017098784446716},{-0.11921398341655731,0.0920085608959198,0.41960570216178894,-0.08525335788726807},{-0.12370798736810684,0.2864634692668915,0.2546185851097107,-0.1649092584848404},{-0.35278838872909546,-0.023174099624156952,0.015522840432822704,-0.14587895572185516},{-0.4290110468864441,-0.16838769614696503,0.4657655954360962,-0.3317185640335083},{0.41778311133384705,-0.14596769213676453,-0.3420436978340149,-0.45715364813804626},{0.05220625549554825,0.35636451840400696,0.3876158893108368,-0.521856427192688},{-0.2295617163181305,-0.20327848196029663,-0.2646171450614929,0.19036871194839478},{0.4804689884185791,-0.2211480587720871,-0.0618567168712616,0.22776836156845093},{0.33977946639060974,0.30282148718833923,-0.04917221516370773,0.13220715522766113},{0.03260859102010727,0.14073660969734192,-0.3700145184993744,-0.023216411471366882},{0.12038557231426239,0.31888431310653687,0.4698558449745178,0.3569526672363281},{0.20842356979846954,0.024926921352744102,0.31105145812034607,0.2703990042209625},{-0.3030221164226532,-0.1164277121424675,-0.10582835972309113,-0.31006816029548645},{-0.27119600772857666,0.16174912452697754,-0.15948067605495453,-0.11932216584682465},{-0.24904264509677887,0.24690993130207062,0.1996079981327057,0.3655206561088562},{-0.013993341475725174,0.37962818145751953,-0.2409730851650238,0.08359725028276443},{-0.3453024923801422,-0.4317949414253235,-0.07214022427797318,0.07842129468917847},{0.4167995750904083,0.5495681762695312,0.010423763655126095,-0.3686417043209076},{-0.08811947703361511,0.22507043182849884,0.2722918689250946,0.18655860424041748},{-0.13339181244373322,0.42220714688301086,-0.08431679755449295,-0.18259285390377045},{0.07578805088996887,-0.04313657060265541,-0.13527248799800873,0.05031358078122139},{0.3337428867816925,-0.5280861854553223,-0.025231366977095604,0.06009869650006294},{0.012828784063458443,-0.4362506866455078,-0.23368677496910095,-0.22130978107452393},{0.12203428149223328,-0.20514939725399017,0.20735137164592743,0.2424531877040863},{0.00378052587620914,-0.07725056260824203,0.1642608940601349,0.09210149943828583},{-0.4344182312488556,0.36599868535995483,0.2637406289577484,-0.053156714886426926},{0.3926447629928589,-0.14984692633152008,0.23394827544689178,-0.137406125664711},{0.08796922117471695,-0.47870564460754395,0.4806866943836212,-0.3515142798423767}};
static const float actor_encoder_self_encoder_0_bias[16] = {0.06754795461893082,-0.027643363922834396,0.050785958766937256,-0.0323745533823967,-0.03319063410162926,-0.12559586763381958,-0.10789403319358826,0.05214308202266693,0.055315032601356506,-0.005092962179332972,0.08515720069408417,0.04267985001206398,-0.07917612791061401,-0.12604500353336334,0.058739420026540756,-0.08827025443315506};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.061337314546108246,0.06797920167446136,0.03134038299322128,0.008925474248826504,0.06857668608427048,-0.024687068536877632,0.09351471811532974,-0.026737941429018974,-0.02548164501786232,0.007392409257590771,-0.005385034717619419,-0.041759856045246124,0.07316747307777405,-0.027488093823194504,-0.032899193465709686,-0.026056375354528427};
static const float actor_encoder_feed_forward_0_bias[32] = {0.06732010096311569,0.06232277303934097,0.010799771174788475,0.0658017247915268,0.039108455181121826,-0.006874306593090296,-0.053510166704654694,-0.032919708639383316,-0.013914265669882298,0.012227696366608143,-0.06025642529129982,0.04094882681965828,0.0632007047533989,-0.0541377067565918,0.07850632071495056,0.07313217967748642,-0.07122498750686646,-0.06236983463168144,0.016902556642889977,0.009463834576308727,-0.059508226811885834,0.02757965214550495,0.06926247477531433,-0.003625330748036504,-0.019074050709605217,0.006797309964895248,-0.05519019812345505,0.04654628783464432,0.03458211198449135,0.00667099142447114,0.04100654274225235,0.02548789791762829};
static const float action_parameterization_distribution_linear_bias[4] = {0.051330067217350006,0.02376733347773552,0.04640548303723335,0.04219571501016617};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{-0.0722915455698967,0.21522808074951172,-0.1699405163526535,0.21250562369823456,0.19820889830589294,0.07137240469455719,0.30338922142982483,-0.01715775579214096},{-0.2875198423862457,-0.07779375463724136,-0.31847652792930603,-0.21940942108631134,-0.31950074434280396,-0.23596766591072083,-0.08706096559762955,-0.2238749861717224},{-0.3230964243412018,0.007574307266622782,0.20094643533229828,0.22475385665893555,0.2600369453430176,-0.03739359602332115,0.2871905565261841,-0.13945452868938446},{-0.03374008461833,0.06618945300579071,-0.21160848438739777,-0.008958455175161362,0.004064843058586121,-0.07164222747087479,0.2816565930843353,-0.22005224227905273},{-0.34251701831817627,-0.15585386753082275,-0.2566041052341461,-0.14358273148536682,-0.013266094960272312,0.16654019057750702,0.16640622913837433,-0.06509188562631607},{-0.32510074973106384,-0.0414653904736042,0.35605400800704956,0.2302110195159912,0.19331006705760956,-0.12083809077739716,-0.141603484749794,-0.15295247733592987},{-0.2169605791568756,0.021137399598956108,0.3861764967441559,-0.2294655442237854,-0.08912566304206848,-0.42552000284194946,-0.08645325899124146,-0.1489480584859848},{-0.26222196221351624,-0.3823729455471039,0.457219660282135,-0.12709210813045502,-0.17406529188156128,0.22383403778076172,0.1796495020389557,-0.26456958055496216},{-0.2969856560230255,0.2592673897743225,-0.21071696281433105,0.3255144953727722,0.12573446333408356,-0.32023170590400696,0.06685923039913177,0.07087591290473938},{-0.30145302414894104,-0.33227699995040894,-0.17412662506103516,-0.22853820025920868,-0.514741063117981,0.11353392899036407,-0.004046878311783075,0.11150024831295013},{0.18264152109622955,0.3413476049900055,0.21938972175121307,-0.037901200354099274,0.1781618595123291,0.11492093652486801,-0.2040620893239975,0.1767554134130478},{0.2078760266304016,0.043045029044151306,0.3044910132884979,0.248501718044281,-0.3192293047904968,0.2765478193759918,0.010861382819712162,-0.2713874876499176},{0.11245348304510117,-0.31024396419525146,0.28606024384498596,-0.03318946063518524,-0.3594556450843811,-0.10272080451250076,-0.1936883181333542,-0.13751307129859924},{-0.20207242667675018,-0.21090301871299744,0.32699835300445557,0.34136614203453064,-0.23936527967453003,-0.06627866625785828,-0.337245911359787,0.20087462663650513},{0.05434263125061989,-0.15579259395599365,0.08653876930475235,-0.2437726855278015,-0.34225043654441833,-0.13210371136665344,0.19604744017124176,0.019948700442910194},{0.17780530452728271,0.003152969991788268,-0.05162344127893448,-0.29169586300849915,-0.03780144080519676,0.05435609444975853,0.011965899728238583,0.3932875096797943},{0.00678533548489213,-0.21827390789985657,-0.20679433643817902,0.10007402300834656,-0.1807139813899994,-0.12164050340652466,-0.1440027505159378,0.09711664915084839},{-0.14827466011047363,-0.2713553011417389,0.03795069828629494,0.05838291347026825,0.14291492104530334,-0.1982603669166565,0.3488459289073944,0.13453027606010437},{0.05723707377910614,0.11734589189291,-0.26211169362068176,0.13331784307956696,0.11790941655635834,0.18674151599407196,-0.23729833960533142,0.3253406584262848},{0.18662796914577484,-0.03440117463469505,-0.3845105767250061,0.09032300859689713,-0.05151538550853729,-0.043690167367458344,-0.3267122507095337,-0.027950523421168327},{0.08873853832483292,-0.11899220943450928,0.030042286962270737,-0.11084983497858047,0.31138941645622253,0.02741004340350628,-0.08305072039365768,0.41738736629486084},{0.03692905977368355,0.16634881496429443,-0.26737871766090393,0.23757611215114594,0.3109550178050995,0.32141366600990295,0.1616065502166748,-0.3179571330547333},{-0.3977842628955841,-0.09032285958528519,0.15995435416698456,-0.07260732352733612,0.19886411726474762,-0.3178924024105072,0.19137898087501526,-0.2669547498226166},{-0.15748417377471924,0.0720532163977623,-0.05007464811205864,-0.37226393818855286,0.2317013293504715,-0.033085912466049194,-0.35904932022094727,0.2034495621919632},{-0.2151201218366623,-0.1566571444272995,0.015678277239203453,0.10558613389730453,-0.06940031796693802,0.12079904228448868,0.2886877954006195,-0.08279145509004593},{-0.21068193018436432,0.07890162616968155,-0.3656695783138275,-0.2723410129547119,0.14513352513313293,-0.005986581556499004,-0.09821964055299759,0.09109725803136826},{0.3244570195674896,0.3859383165836334,-0.296527236700058,0.18178586661815643,0.1936587691307068,0.3549250662326813,-0.3034473955631256,-0.14166750013828278},{0.37325724959373474,0.25731152296066284,0.0574837364256382,0.06928418576717377,0.2348441630601883,0.146012082695961,0.22655972838401794,0.37324532866477966},{-0.126225084066391,0.38307732343673706,0.1487518548965454,-0.0019313935190439224,0.19354689121246338,0.03159693628549576,-0.37049925327301025,-0.31018051505088806},{-0.17353354394435883,-0.22921723127365112,0.06868528574705124,-0.24155327677726746,-0.33619943261146545,-0.1868523806333542,0.2766774892807007,-0.06874676048755646},{0.37641802430152893,-0.2829541862010956,0.28830114006996155,-0.27282464504241943,0.03673234581947327,0.247427299618721,0.15865902602672577,-0.21305733919143677},{0.22058403491973877,0.37590521574020386,0.3362044095993042,-0.2517355680465698,-0.1994669884443283,0.11282142996788025,0.20534507930278778,0.07787656784057617}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{0.04112933576107025,0.3998878598213196,-0.16744524240493774,0.25855302810668945,-0.4142722487449646,0.25052833557128906,0.42401209473609924,0.03809129074215889},{-0.4322874844074249,-0.5146322846412659,-0.38563287258148193,-0.45485982298851013,-0.4323728680610657,0.37387973070144653,0.45631372928619385,-0.41594573855400085},{-0.006303774658590555,-0.15274211764335632,0.11287486553192139,0.07641420513391495,-0.08360567688941956,0.44548094272613525,-0.3723319470882416,-0.38885292410850525},{0.5354967713356018,0.0342472642660141,0.07951489835977554,-0.01917244680225849,0.5481463074684143,0.40065497159957886,0.330200731754303,0.38578322529792786},{0.08188249915838242,0.25711512565612793,-0.13622665405273438,-0.10704165697097778,0.0814785435795784,-0.40701019763946533,-0.3576020896434784,0.46307817101478577},{0.39294952154159546,0.04751003161072731,0.056780241429805756,-0.3977287709712982,-0.43166571855545044,-0.513563871383667,-0.10915926098823547,0.5324397087097168},{-0.48218730092048645,-0.358869731426239,-0.06516202539205551,-0.259820818901062,-0.004773047752678394,0.47149720788002014,-0.5302119255065918,0.5724467635154724},{0.2789447605609894,0.09705125540494919,-0.003228874411433935,-0.01225601602345705,0.404980331659317,-0.6024083495140076,0.42675796151161194,-0.4081580340862274}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {-0.05626695603132248,0.00490619195625186,0.036235496401786804,0.013058009557425976,-0.03376307338476181,-0.017602859064936638,-0.0008661595056764781,0.024542544037103653};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.024865685030817986,-0.05251898616552353,0.02589605562388897,-0.05086814984679222,0.02274126000702381,-0.01962117664515972,-0.000288481533061713,-0.06739939749240875};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

