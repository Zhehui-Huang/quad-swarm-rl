#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.27350732684135437,-0.18817026913166046,0.3117687404155731,0.24245288968086243,-0.3873082995414734,0.21605715155601501,-0.024259792640805244,-0.23692326247692108,0.10144028812646866,0.3808039128780365,0.12136764079332352,0.07419262081384659,0.15650348365306854,-0.19069896638393402,0.3155060112476349,-0.1103285625576973},{-0.3215654790401459,-0.29547107219696045,0.2882695198059082,0.1965278685092926,-0.23190884292125702,0.0816669836640358,-0.3866584599018097,-0.018552739173173904,-0.14785230159759521,-0.14587658643722534,0.12805123627185822,-0.19101326167583466,0.2388828843832016,-0.39471474289894104,-0.2096155434846878,0.08531451225280762},{0.12914980947971344,-0.2298770397901535,-0.28506195545196533,0.1000252366065979,0.11374161392450333,0.1559995710849762,-0.06108686700463295,0.024174615740776062,-0.127464160323143,-0.2022620141506195,-0.17441394925117493,0.41836977005004883,0.011884432286024094,-0.1702188104391098,-0.41383302211761475,0.22968880832195282},{0.11778265237808228,0.20069192349910736,0.3102915585041046,-0.037684909999370575,-0.3108219504356384,-0.0451832115650177,0.18513624370098114,0.13054977357387543,0.4651983678340912,-0.3885781466960907,0.05155773088335991,0.19599726796150208,-0.3404560685157776,-0.0046661291271448135,0.33402010798454285,-0.4056297838687897},{-0.03419668227434158,0.07278954237699509,0.21301983296871185,-0.13551582396030426,0.24396251142024994,0.29544389247894287,0.2845580279827118,-0.07508455961942673,-0.008341224864125252,0.24626976251602173,0.33552634716033936,-0.19893984496593475,-0.1440269649028778,-0.2989918887615204,0.3960108160972595,0.15203368663787842},{0.014789589680731297,-0.21800346672534943,-0.14452815055847168,-0.2133347988128662,0.1305178701877594,0.009653442539274693,0.04097185656428337,-0.14850172400474548,0.25023478269577026,-0.29060932993888855,-0.3081154525279999,0.2008819729089737,0.4510031044483185,0.017525101080536842,-0.008158789947628975,0.06989322602748871},{-0.04787840694189072,-0.019368138164281845,0.10166575759649277,-0.2207043617963791,0.19877082109451294,0.03283022716641426,0.10421743988990784,0.34508806467056274,0.33206087350845337,-0.043445173650979996,-0.3514072597026825,0.1676827222108841,-0.11532504111528397,0.2237384170293808,-0.15717576444149017,-0.239054337143898},{0.0025427420623600483,-0.003488137386739254,0.20778273046016693,0.26374906301498413,-0.38276106119155884,-0.012540580704808235,0.3354595899581909,0.34636184573173523,-0.07171119749546051,0.254832923412323,-0.4556213915348053,-0.28871700167655945,0.2364288866519928,0.32435914874076843,0.2482612580060959,0.08054931461811066},{0.2607581615447998,-0.2135562151670456,0.3167980909347534,-0.07818284630775452,0.27120524644851685,0.04983827471733093,-0.14560630917549133,-0.16935469210147858,0.08337721973657608,-0.2940899133682251,0.05801289156079292,-0.3143046200275421,-0.1712760180234909,0.36638143658638,0.1690031737089157,-0.09056223183870316},{0.04020797088742256,-0.3688911497592926,-0.41536861658096313,-0.04880508407950401,-0.34552720189094543,0.15649262070655823,0.37354668974876404,0.26128366589546204,0.39645275473594666,0.36546608805656433,-0.06210697814822197,-0.3317411541938782,0.07864577323198318,0.28816092014312744,-0.05645119026303291,-0.28353890776634216},{0.09233877062797546,0.2595895230770111,0.4590902030467987,-0.3464631736278534,-0.3307195007801056,0.21161793172359467,0.17778931558132172,0.4155491888523102,-0.32374513149261475,-0.05113610625267029,-0.06814437359571457,0.16201844811439514,-0.3014836609363556,-0.1683667004108429,0.3469897508621216,-0.3429798185825348},{0.11360885202884674,-0.10105825215578079,-0.05430778115987778,0.12339577823877335,0.30514734983444214,0.28739994764328003,0.3813552260398865,0.004157744813710451,-0.01652006059885025,0.04524865373969078,0.2590327262878418,-0.05892452225089073,-0.08578363060951233,-0.2136053740978241,0.20830298960208893,0.3324243128299713},{-0.14519019424915314,0.4147489368915558,0.153559610247612,-0.343408465385437,0.05197718366980553,0.11988122016191483,0.264847993850708,-0.02228410728275776,0.08641137927770615,0.014038445428013802,-0.07504579424858093,0.18928314745426178,0.27952709794044495,0.31162554025650024,0.10427073389291763,-0.2245606631040573},{-0.2110527604818344,-0.2392740100622177,-0.23761598765850067,-0.026651721447706223,-0.15471678972244263,0.09049124270677567,-0.3289627432823181,0.10396530479192734,-0.07986850291490555,-0.022172149270772934,-0.2676592767238617,-0.09301592409610748,-0.3360898792743683,0.13230396807193756,0.24117301404476166,0.07208892703056335},{-0.1106148511171341,-0.393899142742157,-0.23726771771907806,0.33116090297698975,0.022269565612077713,-0.3303445279598236,0.30316007137298584,-0.05729842185974121,-0.01781696453690529,0.2512858211994171,0.045700039714574814,0.20581746101379395,0.20628622174263,-0.018792202696204185,-0.2048322558403015,0.19402271509170532},{0.5310450792312622,-0.08679600805044174,-0.2521733343601227,-0.428445965051651,-0.6271190643310547,0.37207186222076416,0.40037399530410767,-0.339327871799469,0.19719861447811127,0.09854947030544281,-0.3472369611263275,0.07973205298185349,-0.5415584444999695,0.5116217732429504,-0.300131618976593,0.060296300798654556},{-0.3558375835418701,-0.4068806767463684,0.4300832450389862,0.3487679958343506,-0.3151223659515381,0.32558926939964294,-0.13007791340351105,-0.2825380563735962,0.23415304720401764,-0.466011106967926,-0.3677106201648712,-0.6298405528068542,-0.1853095442056656,-0.527237057685852,-0.0005736917955800891,-0.19436532258987427},{-0.3766859769821167,0.2897716462612152,-0.47733065485954285,-0.009954091161489487,0.0730259120464325,0.32268235087394714,-0.24218393862247467,-0.36173129081726074,0.21497878432273865,0.2655481994152069,0.4292030930519104,-0.08404643088579178,-0.22308985888957977,0.3048064708709717,0.18064576387405396,-0.5221976637840271}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.1478283405303955,-0.07751557230949402,-0.1720471829175949,-0.39618393778800964,0.44364503026008606,0.265344500541687,0.09268328547477722,0.1215486228466034,-0.29876911640167236,-0.08399304002523422,-0.10758329927921295,-0.021362390369176865,0.24020402133464813,0.5346387624740601,0.130873441696167,0.06832972913980484},{-0.19720834493637085,-0.2917312681674957,-0.0432315468788147,0.1493377387523651,0.2806297540664673,-0.3109607696533203,0.16636061668395996,0.07632862776517868,-0.0881965383887291,0.24322111904621124,-0.16155853867530823,0.3304829001426697,-0.3613816797733307,0.20837050676345825,-0.38724708557128906,-0.27425509691238403},{0.11914494633674622,0.2479429543018341,-0.42191001772880554,-0.5293123722076416,0.15649519860744476,0.4656732678413391,-0.10956220328807831,0.10864100605249405,-0.23641936480998993,-0.2505827844142914,-0.02118234522640705,0.2944065034389496,-0.34297946095466614,-0.30286240577697754,0.17840264737606049,-0.07277245819568634},{0.20118007063865662,-0.02106795832514763,0.07961242645978928,0.19099931418895721,-0.5065612196922302,0.05374535173177719,0.032543573528528214,-0.2705714702606201,0.38935500383377075,0.3923792541027069,-0.0879342332482338,-0.14995166659355164,-0.39185020327568054,-0.3787326216697693,0.19792397320270538,0.2440330982208252},{-0.19955027103424072,0.03513924777507782,0.0625123456120491,0.2780671715736389,-0.21583044528961182,0.021057238802313805,-0.05376414582133293,0.16232693195343018,0.24261054396629333,-0.3569534420967102,0.037268415093421936,0.42026662826538086,0.13665859401226044,-0.4200095534324646,-0.08329610526561737,-0.11949381232261658},{0.25529220700263977,0.22984535992145538,-0.0425204299390316,0.17324399948120117,-0.37957802414894104,-0.46094152331352234,0.2806011736392975,0.3343905806541443,0.10429562628269196,0.5107330083847046,0.2357448935508728,-0.28843632340431213,0.012155255302786827,-0.15042126178741455,-0.08682780712842941,0.3077537715435028},{-0.01274197082966566,0.18882933259010315,0.31927192211151123,-0.3828929662704468,-0.1843053698539734,0.05473395437002182,-0.2990451455116272,-0.04704635590314865,0.078178770840168,0.12224854528903961,-0.15889938175678253,-0.26896634697914124,-0.31308311223983765,0.060247644782066345,0.21426963806152344,0.04481757804751396},{-0.1924542337656021,-0.1974078118801117,-0.42652249336242676,0.2752801775932312,-0.30208277702331543,-0.2948649227619171,-0.2276318520307541,-0.37417593598365784,0.020601613447070122,-0.2598835825920105,-0.13378483057022095,0.19667941331863403,-0.23393742740154266,0.4075905382633209,-0.11808106303215027,-0.4093339443206787},{-0.24167856574058533,0.29988011717796326,-0.0062705883756279945,-0.025705641135573387,0.3176136314868927,-0.19752833247184753,0.3793526291847229,0.10618866980075836,0.29189011454582214,0.3860536813735962,0.30425798892974854,0.2892198860645294,0.21556460857391357,-0.056057143956422806,0.32297566533088684,0.12726035714149475},{0.14403875172138214,-0.24662891030311584,-0.06929221749305725,-0.15094587206840515,0.2944422662258148,-0.06489800661802292,-0.2608015835285187,-0.20215311646461487,0.06631749123334885,-0.44251707196235657,-0.22128510475158691,0.23059450089931488,0.12026984989643097,0.17707742750644684,-0.32691001892089844,0.2512952387332916},{-0.21799549460411072,-0.39882996678352356,0.4904468357563019,0.2994137108325958,0.23856127262115479,0.10973235219717026,0.16675134003162384,-0.141413152217865,0.15984024107456207,-0.26945024728775024,0.017773108556866646,0.3726571500301361,0.39348554611206055,0.12968869507312775,-0.2817816734313965,-0.002311576623469591},{0.04309174045920372,-0.18481041491031647,0.32768338918685913,0.07544950395822525,-0.12842580676078796,-0.19823502004146576,0.4462335407733917,0.2621607780456543,-0.25351276993751526,-0.37696993350982666,-0.12965822219848633,-0.2951302230358124,-0.009607757441699505,-0.3092820644378662,-0.3896634578704834,-0.0014266198268160224},{-0.07930927723646164,-0.33956629037857056,0.3298167586326599,-0.17556250095367432,0.31283971667289734,-0.33032748103141785,-0.3858659565448761,0.15111318230628967,0.13190995156764984,-0.05039507895708084,-0.30489420890808105,0.08327712118625641,0.07270924746990204,-0.3412310481071472,-0.40698176622390747,-0.01108340360224247},{0.291644811630249,-0.37485823035240173,0.4913310110569,0.12366705387830734,0.07884398102760315,0.29823145270347595,-0.12193722277879715,-0.2526925504207611,-0.5464425086975098,0.055623799562454224,-0.019588951021432877,-0.4315786063671112,0.013680476695299149,0.2838912904262543,0.32603147625923157,0.0513988696038723},{-0.2137075513601303,0.1428920030593872,0.11373578757047653,-0.30658861994743347,-0.1664189249277115,0.1305646300315857,0.23939941823482513,-0.20699083805084229,0.2005666196346283,-0.38832908868789673,-0.006010681390762329,0.05803648754954338,-0.05408626049757004,0.10600189119577408,-0.03452529013156891,0.02103806473314762},{-0.1985338181257248,0.35577523708343506,-0.3345871865749359,0.33025386929512024,0.1909099668264389,-0.413574755191803,-0.08091095834970474,-0.036817580461502075,-0.4232606589794159,0.3033170998096466,-0.39068424701690674,0.31113675236701965,-0.0388435497879982,-0.15454375743865967,-0.3060377836227417,-0.5195068120956421}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.19583436846733093,0.02188408374786377,-0.08579470217227936,-0.012455730699002743,-0.10361769795417786,-0.012502930127084255,0.3071485161781311,0.005164158996194601,-0.10108590126037598,-0.14050178229808807,0.08527889847755432,-0.35148611664772034,-0.2136332094669342,0.2385537475347519,0.18727728724479675,0.2707599401473999,-0.2822791337966919,-0.3169102668762207,-0.26408541202545166,0.02663438953459263,-0.025216080248355865,-0.3634225130081177,-0.2319706529378891,-0.2898005247116089,-0.3118833899497986,0.25816622376441956,-0.2894100546836853,-0.041315607726573944,-0.013433300890028477,-0.03745044395327568,0.1637866050004959,-0.16144603490829468},{0.19406606256961823,0.24520030617713928,0.06345953792333603,-0.08909986168146133,0.1269674003124237,-0.07080100476741791,0.3468332290649414,0.08969317376613617,-0.22773213684558868,-0.12947949767112732,-0.057949524372816086,-0.3362722098827362,-0.22812338173389435,0.21071970462799072,-0.2089880257844925,-0.2933928370475769,-0.04313160106539726,0.18839503824710846,-0.3795587122440338,-0.33331266045570374,-0.026612503454089165,0.30049145221710205,0.1665036827325821,-0.10440095514059067,0.1519913673400879,-0.23572185635566711,-0.00034826924093067646,0.14412540197372437,0.2273876965045929,-0.19136789441108704,-0.05684439465403557,0.22025074064731598},{0.27630099654197693,0.0857638567686081,-0.0390821248292923,0.20506387948989868,-0.25598829984664917,-0.18506167829036713,-0.3477231562137604,0.18083499372005463,-0.1259908527135849,0.36370232701301575,-0.24258318543434143,-0.11565327644348145,0.15547354519367218,-0.43820858001708984,-0.10122893005609512,0.06697840243577957,-0.16107603907585144,-0.19975218176841736,0.32975637912750244,-0.01952376589179039,0.2964078485965729,0.1864987164735794,-0.2534709572792053,-0.015932597219944,-0.2518065869808197,-0.1186557188630104,0.19465968012809753,-0.1333196759223938,-0.03798592463135719,-0.10189744085073471,-0.09222342818975449,-0.0479997843503952},{0.366549551486969,0.09607155621051788,0.08197171986103058,-0.13370847702026367,-0.30259618163108826,-0.07468517869710922,-0.18964742124080658,0.28065842390060425,0.2404979169368744,-0.2374173253774643,-0.07233987748622894,0.3361107110977173,0.06604927778244019,-0.1798260509967804,-0.19419825077056885,0.3004109561443329,-0.3284853398799896,0.21111923456192017,0.019636813551187515,0.1036355048418045,-0.03477245941758156,-0.10473709553480148,0.3064457178115845,0.15679198503494263,0.1851961314678192,-0.36217787861824036,0.36913251876831055,-0.232761949300766,-0.025857295840978622,0.06550218164920807,-0.273483008146286,0.1810634434223175},{-0.025167979300022125,-0.08379475772380829,-0.07779253274202347,0.03983774036169052,0.19030608236789703,-0.22177143394947052,-0.36187395453453064,-0.026201624423265457,-0.10956026613712311,-0.16284452378749847,0.11289512366056442,0.23098134994506836,-0.031248096376657486,-0.07463344186544418,-0.11230997741222382,0.2108364850282669,-0.0830925852060318,-0.04004521667957306,-0.3487841784954071,-0.06753417104482651,-0.14668914675712585,-0.39625677466392517,0.1576511710882187,0.2495562881231308,-0.05151093751192093,0.2894505560398102,-0.19353677332401276,0.16466672718524933,0.2957804501056671,0.34092915058135986,-0.05205848440527916,0.2995453178882599},{-0.28041547536849976,-0.060827482491731644,-0.2083614021539688,-0.017966696992516518,-0.19454891979694366,0.2495201826095581,0.19658906757831573,0.013543255627155304,0.2869829833507538,0.17603114247322083,0.3517296612262726,-0.23834802210330963,-0.20239035785198212,0.21297098696231842,0.31846752762794495,-0.3858075439929962,-0.1268894225358963,-0.2499808967113495,0.22395719587802887,0.06747071444988251,0.10686749964952469,0.14047051966190338,0.04261929541826248,-0.0625845193862915,-0.39001649618148804,0.3777817487716675,-0.20697085559368134,0.18281680345535278,0.39697349071502686,0.21445484459400177,0.060314878821372986,0.10263411700725555},{0.1750594973564148,-0.10358414053916931,-0.14912499487400055,-0.3181179165840149,-0.041612569242715836,0.21491378545761108,0.2561558783054352,0.15339429676532745,0.09175427258014679,0.3532502055168152,-0.010011938400566578,0.017139844596385956,-0.4136423170566559,-0.16688910126686096,-0.13945728540420532,0.07127661257982254,-0.3098107576370239,-0.24844634532928467,0.18007490038871765,-0.09000413119792938,-0.08607093244791031,-0.1620764136314392,-0.19654950499534607,-0.26698189973831177,0.16741260886192322,-0.24046120047569275,-0.09655667841434479,-0.2275175005197525,0.3500266373157501,0.1137755885720253,-0.19072911143302917,-0.2689342796802521},{0.07622716575860977,0.17761555314064026,0.06994523853063583,-0.16243252158164978,0.16637185215950012,-0.3065671920776367,-0.027884427458047867,-0.13883495330810547,0.00157079822383821,-0.27506518363952637,-0.3626483976840973,-0.12166714668273926,-0.11079089343547821,0.07386485487222672,-0.17609329521656036,0.4527858793735504,0.015041238628327847,-0.11904239654541016,0.09605493396520615,0.3642996847629547,-0.20633648335933685,-0.18454471230506897,0.28636908531188965,0.11148694902658463,0.03087419830262661,-0.36236605048179626,-0.3470313847064972,-0.21922047436237335,-0.41030269861221313,-0.293500691652298,0.09476426243782043,-0.42097145318984985},{0.005213657394051552,0.5433036088943481,-0.451444149017334,-0.38705044984817505,-0.3326197862625122,0.21572791039943695,0.04829277843236923,0.15385125577449799,-0.06996641308069229,-0.3056187033653259,-0.05358629301190376,0.3105675280094147,-0.47338351607322693,-0.2592725455760956,0.28175222873687744,-0.2303423136472702,0.23430703580379486,0.17039816081523895,0.412921279668808,0.01692313887178898,0.14439740777015686,0.268180251121521,0.43061375617980957,-0.21633633971214294,0.44493821263313293,-0.2109871804714203,0.32441189885139465,0.4655994176864624,-0.1350712776184082,0.1033337339758873,0.05602395907044411,0.11956166476011276},{-0.28776735067367554,0.09565664827823639,-0.44037604331970215,-0.24837617576122284,0.12848670780658722,-0.27549517154693604,0.19538822770118713,-0.0557766892015934,0.21076606214046478,0.14752021431922913,-0.3423013687133789,-0.4336094558238983,-0.47070884704589844,-0.10734371840953827,-0.3140257000923157,0.14611901342868805,-0.06942038238048553,-0.2564064562320709,0.09573084861040115,0.08831474930047989,0.06465834379196167,0.007985766045749187,0.4225804805755615,-0.13541047275066376,0.38076767325401306,0.19884516298770905,-0.276908278465271,0.018839528784155846,-0.0211629681289196,-0.0779864564538002,-0.275882750749588,0.08404730260372162},{0.08008536696434021,0.032106056809425354,0.11920169740915298,-0.28213587403297424,-0.29619595408439636,-0.22033396363258362,-0.2584938108921051,-0.03974594920873642,-0.19882221519947052,0.3822183609008789,0.14865617454051971,-0.28359168767929077,-0.3802054226398468,-0.06439542770385742,-0.20965059101581573,-0.13847783207893372,0.21133339405059814,-0.14598339796066284,0.2587667405605316,-0.20762984454631805,-0.18757551908493042,0.047456540167331696,0.22520646452903748,0.17668581008911133,0.1904405951499939,-0.12720288336277008,-0.033789802342653275,-0.05238392576575279,-0.043764859437942505,-0.013141774572432041,-0.07026312500238419,0.16548126935958862},{-0.18917828798294067,-0.04166717082262039,0.22410979866981506,0.25540071725845337,0.2642053961753845,0.00378994713537395,0.08468308299779892,-0.18796813488006592,-0.12182914465665817,-0.2298845499753952,0.29900869727134705,-0.21680596470832825,-0.21520961821079254,-0.1910247951745987,0.2889450788497925,0.04783143475651741,5.051874541095458e-05,0.045667704194784164,0.3686346113681793,0.10414887219667435,-0.2146673947572708,0.27496132254600525,0.11676736921072006,-0.05715235322713852,0.2626700699329376,-0.1512290984392166,-0.11061706393957138,0.23667670786380768,0.18090902268886566,-0.015047123655676842,-0.24765902757644653,-0.29007941484451294},{0.29392412304878235,-0.27236422896385193,-0.025815708562731743,-0.3108026087284088,0.06227906793355942,-0.18311558663845062,0.11645656079053879,0.10749668627977371,0.30159813165664673,0.11881659924983978,0.11152422428131104,0.2367894947528839,-0.34321650862693787,-0.32508260011672974,-0.08330930024385452,-0.23045125603675842,-0.22039343416690826,-0.2845446765422821,0.27305278182029724,-0.20712141692638397,0.36245158314704895,-0.0931880995631218,-0.022404054179787636,0.20419150590896606,0.15302973985671997,-0.12470189481973648,0.10233289003372192,0.026554344221949577,0.13818494975566864,-0.051009729504585266,-0.29973936080932617,-0.06269149482250214},{0.2171696573495865,-0.15386071801185608,-0.030591383576393127,0.4279995560646057,-0.06175507977604866,-0.28470301628112793,-0.023071490228176117,0.035979315638542175,0.2878496050834656,0.3889823257923126,0.03800731524825096,-0.1796085238456726,0.13016022741794586,0.25631535053253174,-0.15998686850070953,0.05525226518511772,0.1844608038663864,-0.26405808329582214,-0.013819616287946701,-0.35765212774276733,0.35416534543037415,0.0672055333852768,-0.1421189159154892,0.2429581731557846,0.16880908608436584,0.17208512127399445,0.015005556866526604,-0.03059105947613716,0.06650068610906601,-0.18035262823104858,-0.08446116745471954,0.3891264498233795},{-0.0346066914498806,-0.26455071568489075,-0.1242322251200676,0.14214979112148285,-0.25035977363586426,0.002479556715115905,0.0658087283372879,-0.31348976492881775,-0.13797225058078766,-0.014996896497905254,0.18449193239212036,0.09115659445524216,0.06978869438171387,0.2570013701915741,-0.05962717533111572,-0.12514077126979828,-0.226915180683136,0.27736696600914,-0.15523359179496765,-0.3281072676181793,-0.18297797441482544,-0.07029437273740768,0.19263432919979095,-0.006041904911398888,-0.07338012009859085,-0.004383058752864599,-0.2521840035915375,0.24105805158615112,0.09510035067796707,-0.21643689274787903,0.20540902018547058,0.20632024109363556},{0.10756614804267883,-0.18028420209884644,-0.15112049877643585,-0.18462012708187103,-0.11781168729066849,0.12054713070392609,0.052908241748809814,0.2360299527645111,-0.11961409449577332,0.07542365044355392,0.24585416913032532,0.07407155632972717,-0.06631128489971161,-0.14977087080478668,0.01950988546013832,0.17466451227664948,-0.4726249575614929,-0.2805801033973694,-0.07612983137369156,0.027812695130705833,0.1225523054599762,0.2517836391925812,0.3107931315898895,0.12353387475013733,0.05445988476276398,0.24711298942565918,0.008399954997003078,-0.07150813937187195,0.2021387219429016,-0.18535800278186798,-0.33068013191223145,0.36698707938194275},{0.1665843427181244,-0.02378305047750473,-0.27407512068748474,0.21220164000988007,0.08405297994613647,-0.04996458813548088,0.25317472219467163,0.08696687966585159,0.14235544204711914,-0.18377184867858887,0.22954951226711273,-0.1841130554676056,-0.39712968468666077,0.24533110857009888,0.0675862729549408,0.0036214699503034353,0.035693034529685974,-0.09416513890028,-0.15125669538974762,0.02340518683195114,-0.029084647074341774,0.15698949992656708,0.06820505857467651,-0.15383261442184448,-0.019064011052250862,-0.21652241051197052,0.018934670835733414,0.3567606508731842,0.2838418483734131,-0.1348486989736557,0.18898214399814606,0.2341771274805069},{-0.035912878811359406,-0.067428819835186,-0.05469557270407677,-0.05436109006404877,-0.2160124033689499,-0.03588901087641716,0.22052371501922607,0.19889794290065765,0.1704998016357422,-0.01906062662601471,0.2064162790775299,0.009947841987013817,0.2312345653772354,0.18576069176197052,0.14680135250091553,-0.07787270098924637,0.14386536180973053,0.19094784557819366,0.23414134979248047,0.0910281091928482,0.18203523755073547,0.23588408529758453,0.03764559328556061,0.16907937824726105,-0.0005996919935569167,-0.1040719673037529,-0.14510959386825562,-0.24664241075515747,0.14517661929130554,-0.2301817238330841,0.05107661336660385,-0.05593061074614525},{-0.3486795127391815,0.08251725137233734,-0.310024619102478,-0.2924816310405731,-0.02035127766430378,0.07172491401433945,0.09832711517810822,-0.16684655845165253,0.005230715963989496,0.31002432107925415,0.0944506824016571,-0.19871874153614044,0.03407811000943184,-0.15726682543754578,-0.2682049870491028,-0.08750873059034348,-0.17604254186153412,0.11074627190828323,-0.025637784972786903,-0.10908650606870651,-0.3052944242954254,0.1589023321866989,0.12549848854541779,-0.007119632326066494,-0.08409859985113144,0.32384753227233887,0.03623282164335251,-0.16023625433444977,-0.14261621236801147,0.04615991190075874,-0.14602692425251007,-0.2138063907623291},{0.022569093853235245,-0.22575250267982483,-0.23431669175624847,-0.028587449342012405,-0.3410181403160095,-0.17463138699531555,0.16467660665512085,-0.28279444575309753,-0.19227896630764008,0.18585321307182312,0.13437841832637787,0.11870021373033524,0.13316786289215088,-0.11730378121137619,0.289899080991745,-0.2873452603816986,0.07017282396554947,0.22564302384853363,0.04879665747284889,0.25739261507987976,0.04859497770667076,-0.137287899851799,-0.2930980622768402,0.2323787957429886,-0.1314500868320465,-0.18598313629627228,0.09176357835531235,0.0021350509487092495,-0.13331851363182068,-0.2992459237575531,-0.04043067991733551,-0.16225621104240417},{0.21395693719387054,0.1811358630657196,-0.0658368244767189,0.18560226261615753,-0.29739123582839966,0.17798304557800293,-0.08243335038423538,-0.1551731377840042,-0.20452506840229034,0.21629293262958527,-0.23758919537067413,-0.13874918222427368,-0.04023735970258713,-0.18595537543296814,-0.33181682229042053,-0.1784903109073639,-0.09843958169221878,-0.2889145314693451,-0.20544643700122833,0.2722185254096985,0.12097901850938797,0.10923925787210464,-0.32114526629447937,0.30181559920310974,0.15241199731826782,0.26677531003952026,-0.2734098732471466,-0.0521746389567852,0.10288111120462418,-0.23550167679786682,0.13596662878990173,0.13049456477165222},{-0.009948167949914932,-0.29604923725128174,-0.015947120264172554,-0.3178141713142395,-0.053126152604818344,0.2418728768825531,0.2053423523902893,0.030492782592773438,-0.04353846237063408,0.026646895334124565,-0.24430175125598907,0.12127536535263062,0.13382601737976074,0.09851022809743881,0.10363937169313431,0.04631452262401581,-0.08969016373157501,0.12748906016349792,-0.12656588852405548,0.17604486644268036,0.20835191011428833,0.24819719791412354,-0.0667588859796524,-0.21189472079277039,0.14761215448379517,0.1205819770693779,0.25213441252708435,0.12730583548545837,-0.030718710273504257,0.13169260323047638,0.009472829289734364,-0.12890635430812836},{0.027693649753928185,-0.18236704170703888,0.2506987154483795,-0.026169460266828537,0.2964056134223938,-0.025490090250968933,-0.11456386744976044,-0.15458080172538757,0.13561968505382538,-0.0716337189078331,0.07064438611268997,0.005183989182114601,-0.24478782713413239,0.021127136424183846,-0.10263129323720932,-0.23070232570171356,-0.04242021590471268,-0.025812754407525063,0.2171446979045868,0.27448976039886475,0.009662139229476452,0.06774688512086868,0.18182547390460968,0.3288998007774353,-0.14590328931808472,-0.09857919067144394,0.21896624565124512,-0.07694227248430252,-0.2313704639673233,-0.24581871926784515,0.302762508392334,-0.015474635176360607},{0.20428921282291412,-0.0325159914791584,0.0411197692155838,0.11728516221046448,-0.034611210227012634,0.062459032982587814,-0.2636980414390564,0.3050910532474518,-0.10494197905063629,-0.055607639253139496,0.09884854406118393,-0.2706473171710968,0.002443392528221011,-0.04754267632961273,-0.10203830897808075,0.30328673124313354,-0.06819017231464386,-0.19216036796569824,0.04707364737987518,-0.019847048446536064,-0.1719951182603836,0.21426303684711456,0.23127001523971558,0.22114932537078857,-0.2652232348918915,0.1184205412864685,-0.05390062928199768,0.08792698383331299,-0.28383317589759827,0.2734775245189667,-0.02069683186709881,0.03842107951641083}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.2647009491920471,-0.11743347346782684,0.18005695939064026,-0.23790985345840454},{0.21860858798027039,-0.3512808680534363,0.3284531533718109,0.32391369342803955},{-0.37677836418151855,0.08956987410783768,0.09549974650144577,-0.01999509520828724},{0.24280937016010284,0.5950866937637329,0.3852389454841614,0.01827225647866726},{-0.313730925321579,0.13327263295650482,-0.3625379204750061,0.08989249914884567},{-0.03975445032119751,-0.09467746317386627,0.13640202581882477,0.5547477006912231},{-0.07252542674541473,-0.10417034476995468,-0.4681026041507721,0.033528879284858704},{-0.16416366398334503,-0.31466829776763916,0.24859513342380524,-0.08799199759960175},{-0.09849116206169128,0.15035732090473175,-0.12426626682281494,-0.19347895681858063},{0.3024749755859375,0.09138349443674088,-0.09722808003425598,-0.2762126922607422},{0.20131807029247284,-0.08952377736568451,0.33834680914878845,0.29845693707466125},{-0.10853909701108932,-0.026156995445489883,0.5291727781295776,-0.11436119675636292},{-0.468990296125412,0.2932038903236389,-0.007282815873622894,-0.15362705290317535},{-0.20452238619327545,0.13653206825256348,-0.32614225149154663,0.12549781799316406},{0.16167192161083221,0.008357393555343151,0.3061111271381378,0.14379779994487762},{-0.18988564610481262,-0.36913591623306274,-0.16599570214748383,-0.1686110943555832},{-0.43186140060424805,0.03202894702553749,-0.12489952147006989,0.3812939524650574},{-0.33952367305755615,-0.16836516559123993,-0.22699975967407227,0.2967299222946167},{-0.09559899568557739,-0.2091965228319168,0.4935116469860077,0.07405737042427063},{-0.2573237717151642,-0.24297884106636047,0.048121239989995956,-0.21698537468910217},{0.19904252886772156,0.1638534665107727,0.19089891016483307,-0.27837246656417847},{-0.012476509436964989,-0.3667210340499878,-0.1235973909497261,0.41606903076171875},{0.4912361204624176,-0.3228985071182251,0.11218922585248947,0.11992955207824707},{-0.38796988129615784,-0.09463131427764893,-0.32434597611427307,-0.41568318009376526},{-0.1467437744140625,-0.3290987014770508,-0.12850062549114227,-0.10245760530233383},{0.22321940958499908,0.23692378401756287,-0.11100506782531738,0.08843626827001572},{0.13969671726226807,-0.2564314007759094,0.3825032413005829,0.09504587203264236},{-0.03539908677339554,-0.19998836517333984,-0.06598739326000214,0.3761844038963318},{0.20619653165340424,0.0945935845375061,0.07339301705360413,0.03048870712518692},{-0.16579100489616394,0.10733240842819214,0.312188059091568,0.0374811515212059},{-0.27774038910865784,-0.06222657114267349,0.08124735206365585,0.339059978723526},{0.3600320816040039,0.26541560888290405,0.26927629113197327,-0.043950021266937256}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.0952824056148529,-0.1430976241827011,0.08412609994411469,0.09629937261343002,0.08782943338155746,-0.20765800774097443,0.10629328340291977,0.02407672442495823,-0.08504790812730789,-0.028180483728647232,0.0013438023161143064,-0.06644033640623093,-0.018013237044215202,0.10572659969329834,0.13464054465293884,-0.04488951712846756};
static const float actor_encoder_self_encoder_2_bias[16] = {0.021734310314059258,0.0480131097137928,0.06386306881904602,-0.050018832087516785,-0.03880031779408455,0.09593126177787781,-0.06440474092960358,-0.11134406179189682,0.042649343609809875,-0.03238614648580551,-0.016174210235476494,0.014970331452786922,-0.009915524162352085,-0.07796389609575272,0.05561722069978714,-0.0827045887708664};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04914630949497223,0.0032796969171613455,-0.06681481003761292,0.07866434752941132,-0.009538616053760052,0.021868612617254257,-0.07224525511264801,-0.05615683272480965,-0.01430895458906889,-0.023261060938239098,0.03657502308487892,0.03089425340294838,-0.016535554081201553,-0.0344654843211174,0.048982035368680954,-0.09700098633766174,-0.010396404191851616,-0.041709091514348984,0.03090015985071659,-0.07944090664386749,0.030265623703598976,-0.019591476768255234,0.026862893253564835,-0.08489266782999039,-0.09272404760122299,0.06938522309064865,0.036748819053173065,-0.012783640064299107,0.07062986493110657,0.024921251460909843,-0.015916697680950165,0.07092151045799255};
static const float action_parameterization_distribution_linear_bias[4] = {0.0409732311964035,0.06804247200489044,0.023336278274655342,0.0442335307598114};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.34468725323677063,-0.25764796137809753,-0.16123567521572113,0.19415557384490967,-0.16469411551952362,0.07003189623355865,-0.260981947183609,-0.026247907429933548},{0.14363177120685577,0.17098481953144073,0.3226350247859955,0.34645137190818787,-0.12703131139278412,-0.349457710981369,0.32939982414245605,0.30223193764686584},{0.06066201254725456,0.21288886666297913,0.07306834310293198,-0.05803380161523819,0.33201637864112854,0.20170502364635468,-0.02198091894388199,0.21331489086151123},{0.11129435151815414,-0.27596208453178406,0.30797919631004333,-0.20734070241451263,-0.2514134645462036,0.07095836102962494,0.27618443965911865,0.2368381768465042},{-0.23801523447036743,-0.006906229071319103,-0.04997381195425987,-0.3271486461162567,0.12019644677639008,0.0929766371846199,0.3136664628982544,0.2723366916179657},{-0.05690016224980354,0.2707841098308563,-0.025384193286299706,-0.2745382487773895,0.2868354618549347,0.08214923739433289,0.055109817534685135,-0.1789894849061966},{0.029920747503638268,0.29941022396087646,0.17643892765045166,-0.18993419408798218,0.3949902355670929,-0.18861305713653564,0.16772478818893433,0.1140160784125328},{0.0971025675535202,-0.23392942547798157,-0.023117175325751305,-0.25360432267189026,0.2783757150173187,-0.09542981535196304,-0.17174743115901947,-0.29297178983688354},{-0.19862693548202515,0.3117176592350006,-0.013764132745563984,-0.0719330832362175,-0.002106830244883895,0.2903023362159729,0.3718242943286896,0.3554767370223999},{0.05408918112516403,-0.011033818125724792,-0.3048333525657654,0.26963678002357483,0.284021258354187,0.22389812767505646,0.25456443428993225,-0.27288365364074707},{-0.13329273462295532,-0.28278830647468567,0.33270448446273804,0.15667548775672913,0.013500084169209003,-0.31057608127593994,-0.06950429081916809,-0.33321163058280945},{0.2843833863735199,0.1105993241071701,0.3804367184638977,0.349047988653183,-0.127400204539299,0.2734236717224121,0.11771652102470398,-0.371798038482666},{-0.3340405225753784,0.17765450477600098,-0.3534213602542877,0.3677099347114563,-0.01941557228565216,0.36617565155029297,-0.024594159796833992,0.23621994256973267},{0.0254207793623209,0.21729721128940582,-0.12362626940011978,-0.18000061810016632,0.05032680556178093,0.06231370195746422,0.2841648757457733,0.0017851974116638303},{0.218819722533226,-0.28313544392585754,-0.29475200176239014,-0.18335770070552826,0.2024226039648056,-0.24865344166755676,0.14703120291233063,-0.04940160736441612},{-0.3763459622859955,-0.34055888652801514,-0.17302897572517395,0.039055150002241135,0.09366201609373093,0.1337045580148697,0.25912371277809143,0.007661706767976284},{-0.16786663234233856,-0.2978948950767517,0.22406664490699768,-0.3236309289932251,0.08655504882335663,0.02116759493947029,-0.4003230929374695,-0.18106794357299805},{0.041645292192697525,0.19513759016990662,0.1160798966884613,0.1752455234527588,-0.050774138420820236,0.3609911799430847,0.3236595094203949,-0.15040777623653412},{0.001533747767098248,-0.370123028755188,-0.11586713045835495,-0.07425041496753693,-0.09694132208824158,-0.3231591582298279,0.11162129044532776,-0.257640540599823},{-0.09696667641401291,-0.0326852984726429,0.04963001608848572,-0.31628653407096863,0.08227980136871338,0.14533483982086182,0.17856226861476898,-0.056955933570861816},{0.0638962835073471,-0.09346149861812592,0.034832704812288284,-0.2607048451900482,0.025958627462387085,-0.02542329765856266,0.09898950159549713,-0.16661499440670013},{-0.31862834095954895,0.155668705701828,0.1316325068473816,-0.2894349992275238,-0.4244725704193115,0.0047172848135232925,0.27218857407569885,0.046110644936561584},{0.27981239557266235,0.06242114305496216,-0.3992842435836792,0.030200505629181862,-0.021966271102428436,0.2446797639131546,0.31269845366477966,0.3412753939628601},{-0.005405360367149115,-0.198715940117836,0.011589261703193188,0.1970238983631134,-0.2783222794532776,-0.01141331810504198,-0.10036153346300125,-0.2912333309650421},{0.19404752552509308,-0.012156442739069462,-0.4265962839126587,0.30269578099250793,-0.25573912262916565,-0.22927869856357574,-0.37076959013938904,0.18089401721954346},{0.0011756272288039327,0.3271329402923584,-0.28336837887763977,-0.09062398970127106,0.1335744559764862,-0.15939271450042725,0.33357396721839905,-0.28404319286346436},{-0.11233461648225784,0.06545428186655045,-0.16231243312358856,-0.20065927505493164,0.06584644317626953,-0.12862737476825714,-0.09273061901330948,-0.14634963870048523},{0.06855053454637527,-0.18870967626571655,-0.03972850739955902,-0.14288952946662903,0.051020991057157516,0.0570727102458477,-0.20282529294490814,0.07061750441789627},{0.27110669016838074,0.038879234343767166,-0.3665149509906769,-0.26643067598342896,-0.21877743303775787,0.12928055226802826,0.20875443518161774,0.06467538326978683},{0.31753668189048767,-0.3424530625343323,0.026101605966687202,-0.0945916473865509,0.12338069081306458,-0.1437777876853943,0.1651899665594101,0.3219199478626251},{-0.3096555173397064,-0.24234268069267273,0.05053626745939255,-0.35369208455085754,0.30063968896865845,-0.2789657413959503,-0.007961590774357319,0.07068842649459839},{0.147858664393425,0.06719466298818588,-0.13303452730178833,0.22540701925754547,0.020287055522203445,-0.049576982855796814,-0.03667602315545082,-0.008884777314960957}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.2232488989830017,0.44000449776649475,-0.5435328483581543,-0.5336261987686157,-0.21660862863063812,0.0026021739467978477,-0.41865620017051697,0.5527151823043823},{-0.057772859930992126,0.5305727124214172,-0.27644509077072144,0.5971691608428955,-0.03975967317819595,0.040523190051317215,-0.2857001721858978,0.048589594662189484},{-0.40738198161125183,-0.20933584868907928,-0.12428200244903564,-0.10776172578334808,0.46731558442115784,0.23756951093673706,-0.04370221495628357,0.4360736906528473},{-0.4929540753364563,-0.5109466314315796,0.33633092045783997,0.3263724744319916,-0.5026184320449829,-0.20593146979808807,0.445967435836792,0.2515956461429596},{-0.3123248815536499,-0.21306626498699188,-0.32200390100479126,-0.25936830043792725,0.3110026717185974,-0.21509979665279388,0.5373429656028748,-0.41542428731918335},{-0.0021377040538936853,0.21489617228507996,0.2236482799053192,-0.5548888444900513,0.5052698850631714,-0.2866896390914917,-0.484121710062027,-0.38649067282676697},{-0.3652275502681732,0.17046883702278137,0.07906398922204971,-0.48978880047798157,-0.041832324117422104,-0.5418090224266052,0.4946107268333435,0.01879141293466091},{-0.38433122634887695,-0.21084381639957428,-0.16114690899848938,-0.3398117125034332,-0.3736049234867096,0.1690216213464737,0.5670817494392395,-0.3059982359409332}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.00632864935323596,-0.1105135828256607,-0.12554241716861725,-0.0018675841856747866,0.10399150848388672,0.022213183343410492,0.06458181887865067,0.06648984551429749};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.04951947554945946,-0.06493303179740906,-0.04129162058234215,-0.1051892340183258,-0.0848776176571846,-0.08472307026386261,-0.03313073515892029,-0.12589071691036224};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

