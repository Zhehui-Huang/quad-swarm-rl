#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3303205370903015,-0.20133039355278015,0.3270799517631531,0.16846096515655518,-0.3724301755428314,0.14189061522483826,-0.002926773624494672,-0.22512730956077576,0.07409286499023438,0.4583187401294708,0.10368111729621887,0.024510188028216362,0.1612749546766281,-0.16736732423305511,0.34249168634414673,-0.10909495502710342},{-0.36733102798461914,-0.28164851665496826,0.2801814377307892,0.18135234713554382,-0.22688645124435425,-0.010857302695512772,-0.3670528829097748,0.0682765543460846,-0.20142455399036407,-0.12033149600028992,0.15164874494075775,-0.15660737454891205,0.20927029848098755,-0.39243975281715393,-0.2001207172870636,0.09329629689455032},{0.15189112722873688,-0.2498517632484436,-0.25042667984962463,0.05979934707283974,0.1288181096315384,0.15913112461566925,-0.07062279433012009,0.0049466462805867195,-0.11902578175067902,-0.1855303943157196,-0.19935856759548187,0.40115803480148315,-0.018873844295740128,-0.1719837635755539,-0.3904447555541992,0.22940951585769653},{0.15187880396842957,0.1571347415447235,0.3344101309776306,-0.07247088104486465,-0.3329274654388428,-0.028761504217982292,0.1561560034751892,0.1340985745191574,0.4804706573486328,-0.39391839504241943,0.01238501537591219,0.17086754739284515,-0.30201292037963867,-0.04586661607027054,0.3447762131690979,-0.38973596692085266},{-0.03905417025089264,0.09896327555179596,0.2306898534297943,-0.11863341927528381,0.231238454580307,0.252287358045578,0.23705293238162994,-0.06608844548463821,-0.04831921309232712,0.22411437332630157,0.30715280771255493,-0.16065575182437897,-0.1037849485874176,-0.32264289259910583,0.38927003741264343,0.148835688829422},{-0.007943169213831425,-0.22588273882865906,-0.12919321656227112,-0.236785888671875,0.10667336732149124,0.03734013810753822,-0.053805746138095856,-0.16103030741214752,0.18643559515476227,-0.21505798399448395,-0.29464977979660034,0.18884670734405518,0.4067554175853729,-0.0030753794126212597,-0.032119639217853546,0.1358715444803238},{-0.08548269420862198,-0.02125459536910057,0.07896885275840759,-0.23945924639701843,0.2031036615371704,0.0416097417473793,0.06504166126251221,0.3250778019428253,0.28932204842567444,0.011347834020853043,-0.32834392786026,0.21690335869789124,-0.08842404931783676,0.215175598859787,-0.1662522256374359,-0.19636870920658112},{-0.02225586771965027,-0.010457689873874187,0.27250292897224426,0.18030999600887299,-0.38144543766975403,0.01734057627618313,0.2920582890510559,0.30466991662979126,-0.07173074781894684,0.1763881891965866,-0.49278414249420166,-0.3066997528076172,0.22317542135715485,0.304922491312027,0.21687883138656616,0.2008969932794571},{0.327065110206604,-0.24755756556987762,0.3521910011768341,-0.024757932871580124,0.19163662195205688,0.11560948193073273,-0.17290295660495758,-0.23488181829452515,0.14732980728149414,-0.31028127670288086,0.03406072407960892,-0.31394848227500916,-0.18926893174648285,0.3041987121105194,0.16872715950012207,-0.09995420277118683},{0.06608376652002335,-0.31993651390075684,-0.507605254650116,-0.03352492302656174,-0.310552716255188,0.214870885014534,0.38605132699012756,0.19302988052368164,0.45434993505477905,0.36348971724510193,0.02785823680460453,-0.27481892704963684,0.1114366203546524,0.28794047236442566,-0.0866234228014946,-0.3891838788986206},{0.02190711349248886,0.2156638205051422,0.4037342667579651,-0.2980349063873291,-0.2917746603488922,0.2297821342945099,0.1470094472169876,0.3583642244338989,-0.30194389820098877,-0.040659479796886444,-0.020087655633687973,0.16246002912521362,-0.308668315410614,-0.19685344398021698,0.36384719610214233,-0.35130682587623596},{0.13678303360939026,-0.14271503686904907,-0.010992225259542465,0.17693287134170532,0.33987948298454285,0.30954453349113464,0.46859005093574524,-0.02559891901910305,0.020580604672431946,-0.029721800237894058,0.26330670714378357,-0.14897741377353668,-0.06456936150789261,-0.24231192469596863,0.25355833768844604,0.26276686787605286},{-0.14444977045059204,0.27012863755226135,0.1340745985507965,-0.2903534173965454,0.07609378546476364,0.14375106990337372,0.31401899456977844,-0.05384563282132149,0.12356696277856827,-0.02118706703186035,-0.09913244098424911,0.13252034783363342,0.16413678228855133,0.2896946370601654,0.13955442607402802,-0.26860982179641724},{-0.2559269368648529,-0.22227689623832703,-0.21066448092460632,-0.01600074954330921,-0.19205771386623383,0.08923660218715668,-0.35539427399635315,0.08476153016090393,-0.03408530727028847,-0.05982963740825653,-0.27672278881073,-0.061164021492004395,-0.36095312237739563,0.10922642797231674,0.24937769770622253,0.11332090944051743},{-0.1813877373933792,-0.41567906737327576,-0.2200256586074829,0.37529125809669495,0.07105601578950882,-0.34529104828834534,0.30403250455856323,-0.10859838128089905,-0.001960424706339836,0.30648165941238403,0.1010931134223938,0.1733722984790802,0.18631379306316376,-0.014157411642372608,-0.15475618839263916,0.19615373015403748},{0.5022865533828735,-0.042074091732501984,-0.24863982200622559,-0.3900337815284729,-0.5704841017723083,0.2820037603378296,0.4383413791656494,-0.2836723327636719,0.15086287260055542,0.09506513178348541,-0.2909882664680481,0.06905311346054077,-0.5174419283866882,0.5217809081077576,-0.276077002286911,0.021903520449995995},{-0.38985714316368103,-0.375509649515152,0.4117719233036041,0.3758772015571594,-0.34498679637908936,0.3354993760585785,-0.09231371432542801,-0.3244270384311676,0.26943454146385193,-0.44336026906967163,-0.33043593168258667,-0.6819105744361877,-0.27079662680625916,-0.4531209170818329,-0.010842498391866684,-0.2070251852273941},{-0.4242554306983948,0.23446811735630035,-0.509135901927948,-0.03855472058057785,0.017403537407517433,0.35961416363716125,-0.36863037943840027,-0.42239856719970703,0.23990793526172638,0.22777915000915527,0.41698795557022095,-0.060609783977270126,-0.21851199865341187,0.30375880002975464,0.16683852672576904,-0.49371907114982605}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.11087603867053986,-0.11061616986989975,-0.1852710247039795,-0.4191308319568634,0.4038856327533722,0.2750908434391022,0.05399471893906593,0.09267861396074295,-0.2678259611129761,-0.10821884125471115,-0.10881901532411575,0.004809739533811808,0.21878929436206818,0.4890279173851013,0.15279194712638855,0.07204797863960266},{-0.1844569891691208,-0.266452431678772,-0.014731853269040585,0.14072902500629425,0.30994972586631775,-0.25310561060905457,0.14832311868667603,0.04603055119514465,-0.0755193904042244,0.25608009099960327,-0.14213114976882935,0.36360985040664673,-0.36721619963645935,0.22518138587474823,-0.3501046299934387,-0.2606121003627777},{0.15199540555477142,0.23861509561538696,-0.39584267139434814,-0.5772851705551147,0.16027714312076569,0.4625500738620758,-0.08704671263694763,0.11957119405269623,-0.27266231179237366,-0.22432781755924225,-0.02062924951314926,0.2734244763851166,-0.3197908103466034,-0.28466588258743286,0.15580467879772186,-0.05508549511432648},{0.20273973047733307,-0.05017263442277908,0.07685305923223495,0.16596706211566925,-0.4928998351097107,0.030878456309437752,0.028584809973835945,-0.2798924446105957,0.33670109510421753,0.3549371063709259,-0.12581504881381989,-0.20551371574401855,-0.3964708745479584,-0.3571496903896332,0.21121183037757874,0.22197765111923218},{-0.1714334338903427,0.056568797677755356,0.051995836198329926,0.2909078001976013,-0.24479202926158905,0.005377647466957569,-0.033643778413534164,0.21071602404117584,0.2343890517950058,-0.2826665937900543,0.04165015369653702,0.40782031416893005,0.146284282207489,-0.40771403908729553,-0.07664152979850769,-0.11593402177095413},{0.24907734990119934,0.21967501938343048,-0.020798347890377045,0.17260286211967468,-0.36143770813941956,-0.3950025737285614,0.2586556673049927,0.28291231393814087,0.10768599063158035,0.49478697776794434,0.2682490944862366,-0.26538196206092834,0.03528009355068207,-0.1529906988143921,-0.04327889159321785,0.3430321216583252},{-0.02214803919196129,0.15802794694900513,0.3692058324813843,-0.35995492339134216,-0.15542028844356537,0.05861920118331909,-0.30315065383911133,-0.04872409999370575,0.08787887543439865,0.1162298396229744,-0.13413909077644348,-0.2814921736717224,-0.27751848101615906,0.06225098669528961,0.20521441102027893,0.08229080587625504},{-0.1873587965965271,-0.16084077954292297,-0.40242454409599304,0.2818925976753235,-0.2790969908237457,-0.32569003105163574,-0.1908596158027649,-0.3392687141895294,0.024913227185606956,-0.203380286693573,-0.12485899031162262,0.1776849329471588,-0.23331308364868164,0.41696077585220337,-0.11877322196960449,-0.3987025320529938},{-0.24197596311569214,0.2768653333187103,0.016946589574217796,-0.03252677619457245,0.31239989399909973,-0.2300395667552948,0.403120219707489,0.1327037811279297,0.26263347268104553,0.38234177231788635,0.293948233127594,0.28112873435020447,0.259013295173645,-0.03609205409884453,0.2995758652687073,0.13283392786979675},{0.12626785039901733,-0.30770784616470337,-0.00892028957605362,-0.1208806186914444,0.3237164616584778,-0.051262252032756805,-0.28691723942756653,-0.233866885304451,0.053586430847644806,-0.4576570689678192,-0.1836758255958557,0.2062941938638687,0.14713257551193237,0.1827692985534668,-0.3331301510334015,0.28244179487228394},{-0.1674911230802536,-0.35855987668037415,0.463744193315506,0.23588216304779053,0.21670874953269958,0.16428792476654053,0.10813606530427933,-0.15959560871124268,0.144835963845253,-0.22160111367702484,0.012545476667582989,0.4332674741744995,0.33895593881607056,0.12163757532835007,-0.2006395161151886,-0.007862308993935585},{0.026546655222773552,-0.16658060252666473,0.29607489705085754,0.023820316419005394,-0.12501128017902374,-0.22359338402748108,0.45792150497436523,0.29188603162765503,-0.26995745301246643,-0.3901054859161377,-0.12115240097045898,-0.3139251172542572,-0.0005306942039169371,-0.3214261829853058,-0.36340031027793884,-0.003945215605199337},{-0.03203968703746796,-0.31344667077064514,0.31130290031433105,-0.21128904819488525,0.2870769202709198,-0.320788711309433,-0.3673133850097656,0.1806057244539261,0.10446272045373917,-0.02749418094754219,-0.2877715229988098,0.09656286984682083,0.06734058260917664,-0.311130553483963,-0.3837946057319641,-0.01637336239218712},{0.31069955229759216,-0.29258963465690613,0.4572732448577881,0.14831478893756866,0.03372349962592125,0.28942957520484924,-0.06683751195669174,-0.20836137235164642,-0.5229194164276123,0.11027570813894272,0.018509959802031517,-0.38336804509162903,0.01406913623213768,0.23824246227741241,0.32907354831695557,0.05051625519990921},{-0.23399141430854797,0.16346615552902222,0.10627413541078568,-0.3220193088054657,-0.23253872990608215,0.05783534795045853,0.25455692410469055,-0.13241346180438995,0.16942894458770752,-0.3637709617614746,0.009010180830955505,0.07409106940031052,-0.033140379935503006,0.05707572400569916,-0.07798226922750473,2.211211267422186e-06},{-0.19588318467140198,0.3163166046142578,-0.3423439860343933,0.32747581601142883,0.16599464416503906,-0.3621448278427124,-0.1505296677350998,-0.08244433254003525,-0.4003107249736786,0.2835603654384613,-0.40137413144111633,0.3138357400894165,-0.07647290080785751,-0.16656535863876343,-0.27812138199806213,-0.535266101360321}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.16783060133457184,0.016496503725647926,-0.07395555824041367,-0.03004712052643299,-0.11423050612211227,0.009542662650346756,0.2947552502155304,0.03245961666107178,-0.11985604465007782,-0.1831056773662567,0.11202181875705719,-0.3095722794532776,-0.21755541861057281,0.22596408426761627,0.20525172352790833,0.2787480056285858,-0.2679940164089203,-0.31467700004577637,-0.22525623440742493,0.04270997643470764,-0.030438212677836418,-0.35707223415374756,-0.2291146218776703,-0.2784564197063446,-0.30770596861839294,0.22728830575942993,-0.24637629091739655,-0.050853174179792404,-0.01249414961785078,-0.0073244282975792885,0.1964457631111145,-0.15675115585327148},{0.2489261031150818,0.2298460602760315,0.12108881771564484,-0.08048024773597717,0.10439525544643402,-0.08163586258888245,0.29424357414245605,0.11213291436433792,-0.2025047093629837,-0.14513273537158966,-0.05132821947336197,-0.2781638503074646,-0.1769726574420929,0.2021215856075287,-0.20104648172855377,-0.32907363772392273,-0.045629438012838364,0.15247781574726105,-0.3438746929168701,-0.3027213513851166,0.0028760633431375027,0.2594383656978607,0.13641546666622162,-0.11157846450805664,0.14192058145999908,-0.26967746019363403,0.022284163162112236,0.09879603236913681,0.20960690081119537,-0.13350629806518555,-0.030355514958500862,0.24525725841522217},{0.23470687866210938,0.06594086438417435,-0.062311895191669464,0.13426490128040314,-0.18200349807739258,-0.18887384235858917,-0.25184914469718933,0.13726362586021423,-0.11157187074422836,0.38165411353111267,-0.30205485224723816,-0.19120514392852783,0.14357641339302063,-0.38523122668266296,-0.16066515445709229,0.12828339636325836,-0.14324061572551727,-0.14129199087619781,0.2614005506038666,-0.03386356309056282,0.23009882867336273,0.23974847793579102,-0.2578144669532776,0.037747930735349655,-0.1886674016714096,-0.1040894091129303,0.13534048199653625,-0.09233411401510239,-0.06563977152109146,-0.17135779559612274,-0.08902700245380402,-0.11475612223148346},{0.3369741141796112,0.08482896536588669,0.09234721213579178,-0.1344730108976364,-0.26460835337638855,-0.06614964455366135,-0.1562284231185913,0.2596656382083893,0.23899860680103302,-0.2267858237028122,-0.08254369348287582,0.2989487051963806,0.10022187232971191,-0.13235701620578766,-0.22351610660552979,0.3068726360797882,-0.30534374713897705,0.23386456072330475,0.0028127958066761494,0.057331301271915436,-0.05581120029091835,-0.10141193866729736,0.277932733297348,0.15662430226802826,0.17129507660865784,-0.32472771406173706,0.33591553568840027,-0.19338130950927734,-0.019082844257354736,0.03430933132767677,-0.28787198662757874,0.1685192734003067},{-0.022780055180191994,-0.05720518156886101,-0.06795961409807205,0.06263881176710129,0.19590087234973907,-0.1836441457271576,-0.37573790550231934,-0.012867836281657219,-0.12813307344913483,-0.19236528873443604,0.1394299417734146,0.2317315936088562,-0.05303078889846802,-0.08637367933988571,-0.08139660954475403,0.21420301496982574,-0.05350383371114731,-0.0030047374311834574,-0.3300807476043701,-0.052083373069763184,-0.1693308800458908,-0.36516132950782776,0.16235965490341187,0.23302531242370605,-0.07346660643815994,0.28112325072288513,-0.17924758791923523,0.216683030128479,0.29461756348609924,0.3706569969654083,-0.01417748723179102,0.2983841001987457},{-0.23393657803535461,-0.1041668951511383,-0.16062097251415253,-0.05878034234046936,-0.14800845086574554,0.23300321400165558,0.22336383163928986,0.024370575323700905,0.3147715926170349,0.14461156725883484,0.2867773175239563,-0.22753123939037323,-0.1728971302509308,0.24921013414859772,0.27699047327041626,-0.35088562965393066,-0.10902339220046997,-0.23355446755886078,0.2154957801103592,0.11847570538520813,0.08256638795137405,0.13298699259757996,0.009962639771401882,-0.02047053351998329,-0.36381107568740845,0.3212951421737671,-0.2109937071800232,0.1508624106645584,0.3523610830307007,0.21434541046619415,0.07639593631029129,0.059852682054042816},{0.17933543026447296,-0.133502796292305,-0.13321754336357117,-0.3393007218837738,-0.0060104005970060825,0.221754252910614,0.2762157917022705,0.13018235564231873,0.10160576552152634,0.3236278295516968,-0.004354793578386307,0.0020931577309966087,-0.4008053243160248,-0.13490431010723114,-0.1478731483221054,0.05143514648079872,-0.28799232840538025,-0.2183738797903061,0.17234455049037933,-0.09127417951822281,-0.11855977773666382,-0.14324235916137695,-0.2246898114681244,-0.25439128279685974,0.1922243982553482,-0.26997917890548706,-0.11835233867168427,-0.21594008803367615,0.3344115912914276,0.11703122407197952,-0.17895710468292236,-0.28138113021850586},{0.05470403656363487,0.17665104568004608,0.0440777987241745,-0.12920305132865906,0.15451587736606598,-0.30770421028137207,-0.048830777406692505,-0.17918308079242706,0.007595192175358534,-0.2662564516067505,-0.31836065649986267,-0.11533680558204651,-0.11820130795240402,0.061994340270757675,-0.14078012108802795,0.4005984961986542,-0.004122082609683275,-0.14929038286209106,0.10287352651357651,0.3241763412952423,-0.18833984434604645,-0.19032299518585205,0.2935817539691925,0.07787808030843735,-0.0008478469680994749,-0.3291715681552887,-0.3400249183177948,-0.22404985129833221,-0.384660929441452,-0.2772689163684845,0.08673687279224396,-0.3828522861003876},{0.04080399498343468,0.44709348678588867,-0.39731743931770325,-0.36809635162353516,-0.32386818528175354,0.13164758682250977,0.05825930833816528,0.14229916036128998,0.03904156759381294,-0.23951955139636993,-0.1514255851507187,0.3096497356891632,-0.3932173252105713,-0.23660226166248322,0.2211952954530716,-0.22633056342601776,0.21763521432876587,0.1237114816904068,0.3558034598827362,0.06328236311674118,0.20367716252803802,0.17116627097129822,0.3697161078453064,-0.15665794909000397,0.459000825881958,-0.20947924256324768,0.24804168939590454,0.37795698642730713,-0.18035930395126343,0.11444588750600815,0.03246099501848221,0.10891988128423691},{-0.2602919638156891,0.09593423455953598,-0.3917379081249237,-0.18559762835502625,0.11741752922534943,-0.2458324134349823,0.13402017951011658,-0.042607516050338745,0.19954176247119904,0.10148676484823227,-0.2740418314933777,-0.3735591769218445,-0.43804144859313965,-0.1128307580947876,-0.2610185444355011,0.09872817248106003,-0.04598934203386307,-0.26569822430610657,0.1530560851097107,0.054568883031606674,0.08995052427053452,-0.021243171766400337,0.3994833827018738,-0.1972816437482834,0.3271084725856781,0.19697517156600952,-0.24571329355239868,0.03390432149171829,0.013273661024868488,0.007119649555534124,-0.23162278532981873,0.1367284506559372},{0.09454212337732315,0.0051415227353572845,0.14474374055862427,-0.2958584129810333,-0.2785000205039978,-0.23006382584571838,-0.2489551305770874,-0.049415234476327896,-0.19156797230243683,0.3599195182323456,0.14241234958171844,-0.2778540849685669,-0.36375465989112854,-0.04482445493340492,-0.21425530314445496,-0.14634034037590027,0.22091569006443024,-0.15401922166347504,0.2683321237564087,-0.20597092807292938,-0.19572529196739197,0.041532889008522034,0.20587991178035736,0.17301017045974731,0.20816338062286377,-0.15750449895858765,-0.03752310201525688,-0.060459982603788376,-0.04999133571982384,-0.005527311470359564,-0.07249879837036133,0.1636423021554947},{-0.21059831976890564,-0.04248626530170441,0.23057565093040466,0.29975372552871704,0.264952152967453,0.008085080422461033,0.07754930853843689,-0.20782695710659027,-0.10523620247840881,-0.20148861408233643,0.28598275780677795,-0.24404017627239227,-0.20575423538684845,-0.18689566850662231,0.2838439345359802,0.01825050823390484,0.0020730681717395782,0.041112858802080154,0.3423411250114441,0.09051676839590073,-0.20252108573913574,0.25951650738716125,0.11038105934858322,-0.08012846857309341,0.22371108829975128,-0.1203269511461258,-0.1345260739326477,0.250122606754303,0.19759875535964966,-0.019319195300340652,-0.2569625973701477,-0.2777027487754822},{0.24896571040153503,-0.2559937536716461,-0.005436783190816641,-0.34173691272735596,0.11767271906137466,-0.09814153611660004,0.15265679359436035,0.08031757175922394,0.26421043276786804,0.08615903556346893,0.12363378703594208,0.20733530819416046,-0.35124126076698303,-0.25994575023651123,-0.08859901130199432,-0.21967516839504242,-0.1550762802362442,-0.2213403284549713,0.2639351189136505,-0.23025310039520264,0.28388455510139465,-0.020300686359405518,-0.015651937574148178,0.18926970660686493,0.13200658559799194,-0.104231096804142,0.11477115750312805,0.12543243169784546,0.13217823207378387,-0.06429830938577652,-0.23451881110668182,-0.0869203582406044},{0.23084807395935059,-0.07552339881658554,-0.03716619312763214,0.435369610786438,-0.1025647222995758,-0.21525287628173828,-0.06634078919887543,0.09037785232067108,0.193777397274971,0.3234596848487854,0.10915175080299377,-0.15028297901153564,0.0673634260892868,0.20603403449058533,-0.09938452392816544,0.06021967902779579,0.1961824893951416,-0.2346518635749817,0.04540460556745529,-0.35161665081977844,0.3333030939102173,0.12222657352685928,-0.08534477651119232,0.19120316207408905,0.17014974355697632,0.11360721290111542,0.083086296916008,0.0369742214679718,0.08841696381568909,-0.14579366147518158,-0.05322052165865898,0.416766494512558},{0.01897541806101799,-0.27388307452201843,-0.08827140182256699,0.11069692671298981,-0.24454084038734436,-0.007159519474953413,0.06711988151073456,-0.28312405943870544,-0.14189723134040833,-0.04638632759451866,0.1743485927581787,0.1297106146812439,0.08815263956785202,0.2658465504646301,-0.06577705591917038,-0.09592276066541672,-0.2225496917963028,0.2762092053890228,-0.12454711645841599,-0.29033809900283813,-0.18834620714187622,-0.07591180503368378,0.18166464567184448,0.0011123683070763946,-0.047269489616155624,-0.062208905816078186,-0.22502945363521576,0.2204991728067398,0.0681888610124588,-0.19310955703258514,0.22570331394672394,0.19409061968326569},{0.12581166625022888,-0.21472543478012085,-0.11957084387540817,-0.1746853142976761,-0.12663759291172028,0.13104170560836792,0.0333835631608963,0.22832469642162323,-0.10404498875141144,0.057539891451597214,0.2528872489929199,0.10650869458913803,-0.06731535494327545,-0.1524873971939087,0.04026447609066963,0.14945657551288605,-0.4574199914932251,-0.2926967144012451,-0.06913943588733673,0.042114369571208954,0.13641193509101868,0.22991353273391724,0.30921903252601624,0.132420152425766,0.04544911906123161,0.22671474516391754,0.01669326424598694,-0.09504355490207672,0.1998075395822525,-0.13738776743412018,-0.29368889331817627,0.3861944079399109},{0.1881914585828781,-0.0028716924134641886,-0.25315797328948975,0.1623157113790512,0.10133697092533112,-0.030188487842679024,0.2729245126247406,0.11294805258512497,0.10967473685741425,-0.22648991644382477,0.21882836520671844,-0.18646404147148132,-0.37683695554733276,0.24580208957195282,0.057944901287555695,0.06957326084375381,0.08033043891191483,-0.03254128247499466,-0.13143423199653625,0.04961215332150459,-0.0850239247083664,0.21478740870952606,0.05314337834715843,-0.1515338122844696,0.03982185944914818,-0.2719244360923767,0.030733341351151466,0.43154942989349365,0.24009837210178375,-0.14188741147518158,0.22719763219356537,0.18679873645305634},{-0.029657552018761635,-0.02390272356569767,-0.08425436913967133,-0.03039904683828354,-0.25142255425453186,-0.04179380089044571,0.17637766897678375,0.2055319845676422,0.13457176089286804,-0.014117144048213959,0.24111202359199524,0.03187171742320061,0.20602673292160034,0.1461055427789688,0.17761702835559845,-0.07722118496894836,0.1217561587691307,0.16766157746315002,0.2645876705646515,0.08598532527685165,0.19646526873111725,0.23355215787887573,0.06930315494537354,0.13372237980365753,-0.0018347788136452436,-0.10930744558572769,-0.08359939604997635,-0.2556617558002472,0.17818601429462433,-0.22030968964099884,0.036359891295433044,-0.019189883023500443},{-0.34322458505630493,0.10373817384243011,-0.3125169575214386,-0.3447820842266083,-0.014930699951946735,0.0655321329832077,0.1336037516593933,-0.12940919399261475,-0.002498147776350379,0.31318676471710205,0.06392604857683182,-0.23067975044250488,0.03346944600343704,-0.16610462963581085,-0.3157549798488617,-0.024980681017041206,-0.1804022341966629,0.14124628901481628,-0.03564070165157318,-0.07908152043819427,-0.3271201550960541,0.19606411457061768,0.13129834830760956,0.023481661453843117,-0.02021140605211258,0.2957087755203247,0.01672942005097866,-0.11763068288564682,-0.17404666543006897,-0.002861600834876299,-0.15666352212429047,-0.25784531235694885},{-0.008148133754730225,-0.2173488289117813,-0.2410481572151184,-0.025623220950365067,-0.35798460245132446,-0.17345744371414185,0.16270646452903748,-0.299273282289505,-0.20226703584194183,0.2098323404788971,0.14618006348609924,0.11585704237222672,0.1283646672964096,-0.12457044422626495,0.3140542805194855,-0.32086044549942017,0.05613625794649124,0.21416762471199036,0.04738669842481613,0.23848210275173187,0.058203473687171936,-0.1265685111284256,-0.2810475528240204,0.19925934076309204,-0.18347081542015076,-0.14975525438785553,0.0959753692150116,0.018859393894672394,-0.11251650750637054,-0.30627280473709106,-0.0594792477786541,-0.13490675389766693},{0.2263508290052414,0.19001606106758118,-0.08659184724092484,0.15216223895549774,-0.2822151482105255,0.17469105124473572,-0.05552900955080986,-0.1352926790714264,-0.19892618060112,0.21271349489688873,-0.25770485401153564,-0.1634753793478012,-0.055866289883852005,-0.18363413214683533,-0.3761344254016876,-0.13242149353027344,-0.09124094247817993,-0.2685300409793854,-0.23172533512115479,0.2939472794532776,0.08999426662921906,0.1316208690404892,-0.3219877779483795,0.33633363246917725,0.19901074469089508,0.25548213720321655,-0.2783339321613312,-0.020909300073981285,0.07124961167573929,-0.27253586053848267,0.12184620648622513,0.0906132310628891},{0.017676128074526787,-0.3374677896499634,0.03024451993405819,-0.2903591990470886,-0.05799025669693947,0.2544916868209839,0.1788109391927719,0.025400185957551003,-0.028077082708477974,-0.0010962627129629254,-0.22325484454631805,0.164709210395813,0.1752769500017166,0.10791769623756409,0.14471767842769623,0.01751348376274109,-0.06618300825357437,0.12969611585140228,-0.09916883707046509,0.18317513167858124,0.21584798395633698,0.2292974293231964,-0.09535805881023407,-0.23460513353347778,0.11119438707828522,0.09750284999608994,0.25577211380004883,0.12392012774944305,-0.037353161722421646,0.19871628284454346,0.040377117693424225,-0.11479701846837997},{0.03037146106362343,-0.19236032664775848,0.24537228047847748,-0.007801529485732317,0.2966028153896332,-0.038362160325050354,-0.1085233986377716,-0.1641024947166443,0.15326207876205444,-0.06492837518453598,0.06251407414674759,0.0020818065386265516,-0.26061952114105225,0.030476704239845276,-0.10810775309801102,-0.2485997974872589,-0.049783799797296524,-0.045981042087078094,0.20891709625720978,0.25812673568725586,0.02885100059211254,0.036332182586193085,0.17544645071029663,0.3535759150981903,-0.1566857546567917,-0.08373523503541946,0.1988014280796051,-0.12161140143871307,-0.22144107520580292,-0.2402421236038208,0.3012889623641968,-0.011162261478602886},{0.19300542771816254,-0.05259987711906433,0.043779417872428894,0.14638960361480713,-0.04399574175477028,0.07222321629524231,-0.28312182426452637,0.2780550420284271,-0.09960222244262695,-0.05380064621567726,0.12329374998807907,-0.26403114199638367,-0.0031377302948385477,-0.03561912849545479,-0.07575631886720657,0.2631895840167999,-0.0788860097527504,-0.2004394382238388,0.050458874553442,-0.030032509937882423,-0.16219493746757507,0.21302631497383118,0.24026279151439667,0.1933571696281433,-0.2978816628456116,0.1237391009926796,-0.0520450621843338,0.09698079526424408,-0.2734498083591461,0.2940630316734314,-0.020780356600880623,0.06181630864739418}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.23310735821723938,-0.10660730302333832,0.13050539791584015,-0.16374896466732025},{0.2134249210357666,-0.3342939019203186,0.284620463848114,0.26095205545425415},{-0.304232656955719,0.10770163685083389,0.07681854814291,-0.015513600781559944},{0.2688882648944855,0.5044832229614258,0.3679295778274536,0.04689357429742813},{-0.28122615814208984,0.15457762777805328,-0.3236195743083954,0.09084339439868927},{-0.07189351320266724,-0.07963386923074722,0.08354011178016663,0.43204501271247864},{-0.10806448757648468,-0.10244878381490707,-0.3796185255050659,0.013378888368606567},{-0.1721392571926117,-0.2630835473537445,0.22172336280345917,-0.060518741607666016},{-0.08856476843357086,0.11391288042068481,-0.09278519451618195,-0.11850257962942123},{0.2693195641040802,0.027064526453614235,-0.12190758436918259,-0.22086003422737122},{0.1686377376317978,-0.1178349032998085,0.3133995532989502,0.2764883041381836},{-0.07279714941978455,0.022912967950105667,0.4379536211490631,-0.11195235699415207},{-0.3804227411746979,0.23807357251644135,-0.00704169599339366,-0.13408248126506805},{-0.19986478984355927,0.11606806516647339,-0.23191094398498535,0.10438119620084763},{0.16865742206573486,0.03727994114160538,0.2899467349052429,0.10685902833938599},{-0.15974061191082,-0.34645411372184753,-0.13388095796108246,-0.105940081179142},{-0.3408283293247223,0.03307785466313362,-0.08576355129480362,0.32307669520378113},{-0.28727754950523376,-0.135174959897995,-0.20918859541416168,0.22069452702999115},{-0.0670875683426857,-0.13892261683940887,0.39266249537467957,0.059334758669137955},{-0.202449232339859,-0.17172011733055115,0.02250836230814457,-0.2131982147693634},{0.16728706657886505,0.1404048055410385,0.17894527316093445,-0.21460530161857605},{-0.048757072538137436,-0.32728710770606995,-0.12206508964300156,0.3254195749759674},{0.43099233508110046,-0.24176371097564697,0.14772778749465942,0.0826941430568695},{-0.32889536023139954,-0.11304832249879837,-0.31259989738464355,-0.3588133156299591},{-0.16215214133262634,-0.24675965309143066,-0.09153011441230774,-0.08886878937482834},{0.17061318457126617,0.15509691834449768,-0.06648184359073639,0.08620590716600418},{0.12316082417964935,-0.20193329453468323,0.30761075019836426,0.08327486366033554},{-0.09354232251644135,-0.16145849227905273,-0.03516580909490585,0.32965990900993347},{0.1221204325556755,0.03940213844180107,0.07620333880186081,0.04834374412894249},{-0.18198652565479279,0.12803204357624054,0.27703189849853516,0.031772181391716},{-0.268132746219635,-0.09294641017913818,0.08383993059396744,0.23818859457969666},{0.28126177191734314,0.22072455286979675,0.29682493209838867,-0.030681556090712547}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.09126944094896317,-0.10953657329082489,0.06695868819952011,0.0863499566912651,0.10019584000110626,-0.15398436784744263,0.08494074642658234,0.011250817216932774,-0.06815438717603683,-0.07681620121002197,0.0060550314374268055,0.029927149415016174,-0.017603883519768715,0.08284574747085571,0.09974003583192825,-0.030155589804053307};
static const float actor_encoder_self_encoder_2_bias[16] = {0.0001131276148953475,0.06155272573232651,0.04500797763466835,-0.02679332159459591,-0.035810038447380066,0.06547483056783676,-0.047812916338443756,-0.08075528591871262,0.0372358039021492,-0.012028275988996029,-0.03103230521082878,-0.025827286764979362,-0.009426426142454147,-0.07140013575553894,0.03453485667705536,-0.07857105135917664};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.05514600872993469,-0.009041590616106987,-0.06665557622909546,0.04067159444093704,0.008422068320214748,0.01581280305981636,-0.04879504442214966,-0.05311165750026703,-0.009423756040632725,-0.01744924671947956,0.008783040568232536,0.031773630529642105,0.01420907024294138,-0.03330812230706215,0.031164564192295074,-0.07407420873641968,-0.008646863512694836,-0.033941421657800674,0.01909816451370716,-0.06699846684932709,0.021738454699516296,-0.015128963626921177,0.021967735141515732,-0.05984136834740639,-0.06548137962818146,0.06974848359823227,0.034054234623909,-0.035833559930324554,0.06585826724767685,0.011035679839551449,-0.016395676881074905,0.053922779858112335};
static const float action_parameterization_distribution_linear_bias[4] = {0.03499123826622963,0.06051230803132057,0.0007460135384462774,0.033184248954057693};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.334195613861084,-0.2047116607427597,-0.05343126133084297,0.18171179294586182,-0.06572899967432022,0.0884256586432457,-0.226115882396698,-0.02797188051044941},{0.05645723640918732,0.09380532056093216,0.33122825622558594,0.34258484840393066,-0.1103217601776123,-0.23518352210521698,0.34209027886390686,0.15102079510688782},{0.007275037467479706,0.1812174767255783,0.05663369223475456,-0.0623982697725296,0.3184109032154083,0.2595651149749756,-0.020044539123773575,0.10578703135251999},{0.08925651013851166,-0.27188757061958313,0.29394441843032837,-0.24266670644283295,-0.2877521812915802,0.04610927402973175,0.23764951527118683,0.1892693042755127},{-0.21871894598007202,-0.01998980902135372,-0.03979451209306717,-0.3002401292324066,0.05167224630713463,0.04627722129225731,0.28119462728500366,0.2502562403678894},{-0.062378767877817154,0.305601567029953,-0.0653277337551117,-0.24857905507087708,0.17442673444747925,0.016165154054760933,0.04767971858382225,-0.19958080351352692},{0.0003222356899641454,0.3300653398036957,0.15707017481327057,-0.15765662491321564,0.2875923812389374,-0.2405206710100174,0.2079319953918457,0.0817587748169899},{0.0434880368411541,-0.17121762037277222,0.040698349475860596,-0.10546591132879257,0.34590819478034973,-0.12706078588962555,-0.049122292548418045,-0.2929609417915344},{-0.16820280253887177,0.30776381492614746,0.11769895255565643,-0.02803819626569748,0.010787395760416985,0.22618214786052704,0.4424455165863037,0.3872881531715393},{0.059255581349134445,-0.05452508106827736,-0.27958786487579346,0.36417901515960693,0.2596645653247833,0.18020978569984436,0.22037504613399506,-0.2677031457424164},{-0.10989218950271606,-0.32889148592948914,0.3416316509246826,0.22404146194458008,-0.023223888128995895,-0.37270382046699524,-0.10278049856424332,-0.32762566208839417},{0.31579825282096863,0.05654459819197655,0.38118085265159607,0.4377889633178711,-0.17101599276065826,0.217598095536232,0.1437397450208664,-0.3887355625629425},{-0.30475229024887085,0.1592763364315033,-0.31740859150886536,0.42118558287620544,-0.04211967810988426,0.2810073792934418,0.02475566789507866,0.23482127487659454},{-0.02032347023487091,0.20193906128406525,-0.07032819092273712,-0.1624494045972824,0.038619186729192734,0.061931803822517395,0.3292939364910126,-0.024208422750234604},{0.12579509615898132,-0.29671764373779297,-0.2579968571662903,-0.1683674454689026,0.2268858253955841,-0.17631888389587402,0.2482924610376358,-0.10630275309085846},{-0.4128526747226715,-0.33885565400123596,-0.2246776968240738,0.042255159467458725,0.0677308440208435,0.14652806520462036,0.29346340894699097,-0.006998538970947266},{-0.19635817408561707,-0.2501092851161957,0.17579862475395203,-0.31574031710624695,0.1144738495349884,0.0659680888056755,-0.39988669753074646,-0.24408625066280365},{0.05352132394909859,0.24197839200496674,0.06881827116012573,0.16156762838363647,-0.04142605885863304,0.31842127442359924,0.2895522713661194,-0.1575612723827362},{0.020311253145337105,-0.325349360704422,-0.15915755927562714,-0.036980558186769485,-0.036327533423900604,-0.34016185998916626,0.09368112683296204,-0.22574980556964874},{-0.08973728120326996,-0.03786538541316986,0.013821583241224289,-0.2829178273677826,0.13619975745677948,0.1093827337026596,0.13250160217285156,-0.02878897450864315},{0.05008445307612419,-0.08983761072158813,0.004479510709643364,-0.16574299335479736,0.06575679779052734,-0.025185057893395424,0.08991764485836029,-0.1647462248802185},{-0.3197194039821625,0.15234433114528656,0.12392764538526535,-0.2465192973613739,-0.35847020149230957,-0.01433238759636879,0.20273131132125854,0.033126428723335266},{0.2788489758968353,0.04073798656463623,-0.43331217765808105,0.0256765466183424,-0.002436122391372919,0.21501117944717407,0.2620759904384613,0.31665366888046265},{0.014306166209280491,-0.21762266755104065,-0.07472758740186691,0.15119226276874542,-0.26745325326919556,-0.08496546000242233,-0.1985211819410324,-0.2713547646999359},{0.10299505293369293,-0.0931706428527832,-0.4170309901237488,0.3418284058570862,-0.33451011776924133,-0.13502787053585052,-0.46126094460487366,0.08196999877691269},{-0.02193056233227253,0.3038659691810608,-0.2164628654718399,-0.09673604369163513,0.10056908428668976,-0.16362372040748596,0.2670564651489258,-0.3025795519351959},{-0.09448584169149399,0.09916597604751587,-0.09590847045183182,-0.26892969012260437,0.038570813834667206,-0.15171590447425842,-0.14390161633491516,-0.10467741638422012},{0.07908802479505539,-0.1563529670238495,0.038140762597322464,-0.15926431119441986,0.09189081192016602,0.06059984117746353,-0.21162176132202148,0.10254085808992386},{0.20789697766304016,0.009663150645792484,-0.3041815459728241,-0.23051105439662933,-0.18464595079421997,0.15584424138069153,0.2114483118057251,0.050003234297037125},{0.31188055872917175,-0.3539165258407593,0.0023727803491055965,-0.07187318056821823,0.10421339422464371,-0.11236753314733505,0.17216195166110992,0.2687721252441406},{-0.27890458703041077,-0.20485103130340576,0.04761555418372154,-0.3689347207546234,0.25692033767700195,-0.3292986750602722,-0.02711505815386772,0.07893393188714981},{0.2412092536687851,0.19050505757331848,-0.03295091912150383,0.2420305609703064,0.058167893439531326,-0.13573142886161804,-0.03528117388486862,0.12446244806051254}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.23082901537418365,0.4206598699092865,-0.4970267713069916,-0.5312601923942566,-0.19968584179878235,-0.0830562487244606,-0.39670076966285706,0.5435041785240173},{-0.03847691789269447,0.4676782488822937,-0.2596832513809204,0.5978929400444031,-0.04488697648048401,-0.038109105080366135,-0.34413525462150574,0.030836056917905807},{-0.3571813404560089,-0.1661127507686615,-0.11753775179386139,-0.0890226736664772,0.4497281014919281,0.23336461186408997,-0.045241579413414,0.43063944578170776},{-0.5012778639793396,-0.534182071685791,0.33852246403694153,0.3194236159324646,-0.4738551080226898,-0.22704462707042694,0.4125354290008545,0.22438456118106842},{-0.3138326108455658,-0.2636614143848419,-0.29845547676086426,-0.20046596229076385,0.3377750515937805,-0.23300093412399292,0.49065738916397095,-0.4019000828266144},{-0.03803794085979462,0.24608246982097626,0.14770358800888062,-0.547065794467926,0.568803071975708,-0.2534584105014801,-0.4875160753726959,-0.3757585883140564},{-0.3115531802177429,0.1376531571149826,0.0845365971326828,-0.5009123086929321,0.0247305016964674,-0.5099674463272095,0.48196449875831604,0.053187545388936996},{-0.3641063868999481,-0.14674653112888336,-0.12508387863636017,-0.34103503823280334,-0.3712129294872284,0.13563400506973267,0.5863301157951355,-0.2892026901245117}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.00893528200685978,-0.12598758935928345,-0.11918086558580399,0.00854013953357935,0.1655660718679428,0.047446344047784805,0.1289723664522171,0.05953865498304367};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {0.01397682074457407,-0.026916861534118652,-0.0178231131285429,-0.10361260175704956,-0.06575442105531693,-0.07667367160320282,0.019060468301177025,-0.17248331010341644};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

