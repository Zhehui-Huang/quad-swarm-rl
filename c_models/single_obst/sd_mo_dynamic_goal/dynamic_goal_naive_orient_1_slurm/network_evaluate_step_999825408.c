#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.39268702268600464,-0.1997946798801422,0.38522472977638245,0.1409129798412323,-0.42778635025024414,0.1182040274143219,0.012844739481806755,-0.20777006447315216,0.1013103649020195,0.45642659068107605,0.07917200773954391,-0.013410352170467377,0.15683072805404663,-0.1183658093214035,0.4334920048713684,-0.12809357047080994},{-0.36959847807884216,-0.18015989661216736,0.27447429299354553,0.14336775243282318,-0.2786359190940857,-0.018449896946549416,-0.38598451018333435,0.058921098709106445,-0.15918630361557007,-0.11705929785966873,0.12063474208116531,-0.14408628642559052,0.1601347029209137,-0.30712422728538513,-0.24281376600265503,0.09587801247835159},{0.1449911743402481,-0.21948397159576416,-0.2328864485025406,0.017932606860995293,0.11925459653139114,0.16330130398273468,-0.07277999818325043,-0.007582708261907101,-0.06384077668190002,-0.2085168957710266,-0.20965132117271423,0.40685218572616577,0.018795665353536606,-0.15848250687122345,-0.3266957402229309,0.21669131517410278},{0.19284002482891083,0.1823425590991974,0.28347423672676086,-0.06352846324443817,-0.36534956097602844,0.009153446182608604,0.1373319923877716,0.09055322408676147,0.5219961404800415,-0.3805709183216095,0.011709093116223812,0.11798188835382462,-0.26503828167915344,-0.07411076873540878,0.2994281053543091,-0.35435590147972107},{-0.08621077984571457,0.17431758344173431,0.2218719720840454,-0.09828842431306839,0.2189430445432663,0.25617313385009766,0.23254834115505219,-0.044360414147377014,-0.0751662403345108,0.23438267409801483,0.28961262106895447,-0.10506344586610794,-0.07424519956111908,-0.37454384565353394,0.3202759623527527,0.12900686264038086},{-0.07746144384145737,-0.19091098010540009,-0.1785978525876999,-0.2882094979286194,0.11923226714134216,0.054028041660785675,-0.0464470311999321,-0.15482087433338165,0.22708584368228912,-0.25259697437286377,-0.32897090911865234,0.2137172520160675,0.38404640555381775,-0.034469496458768845,-0.12129417061805725,0.21655786037445068},{-0.12336502224206924,0.11014071106910706,0.050303149968385696,-0.23981793224811554,0.26661044359207153,0.0322473868727684,0.0652017742395401,0.3891899585723877,0.24838535487651825,-0.03529316186904907,-0.40344375371932983,0.28116336464881897,-0.04337664321064949,0.16333730518817902,-0.19115348160266876,-0.12760497629642487},{0.05586707592010498,-0.10758419334888458,0.20447809994220734,0.20184651017189026,-0.32663866877555847,-0.020536242052912712,0.26937082409858704,0.3231264352798462,-0.007311593275517225,0.1780809909105301,-0.42415720224380493,-0.27167055010795593,0.23338349163532257,0.23831909894943237,0.22291967272758484,0.15362820029258728},{0.34447619318962097,-0.17633645236492157,0.3734546899795532,-0.03118198551237583,0.11165136098861694,0.1196059063076973,-0.23635023832321167,-0.2307010143995285,0.20954743027687073,-0.27461910247802734,0.00484419334679842,-0.2760773301124573,-0.1852538287639618,0.30566632747650146,0.15946084260940552,-0.08617156744003296},{0.045801207423210144,-0.12608934938907623,-0.42524901032447815,-0.07617347687482834,-0.330676794052124,0.2149253487586975,0.3962445557117462,0.17696785926818848,0.3931224048137665,0.3970847725868225,0.010278699919581413,-0.30658838152885437,0.07508964091539383,0.2876396179199219,-0.09858522564172745,-0.39857396483421326},{0.0001420977059751749,0.2629530727863312,0.3409869074821472,-0.26978379487991333,-0.28576481342315674,0.19933141767978668,0.20049256086349487,0.34149429202079773,-0.30252233147621155,-0.030744964256882668,-0.03328632935881615,0.19056788086891174,-0.27207306027412415,-0.1900997906923294,0.32928887009620667,-0.38817915320396423},{0.002615679055452347,-0.17806550860404968,0.012101193889975548,0.1966288983821869,0.3467009663581848,0.33947792649269104,0.41758978366851807,-0.030341267585754395,0.009034241549670696,-0.06665914505720139,0.2909683883190155,-0.17807480692863464,0.031204819679260254,-0.22708557546138763,0.3074939250946045,0.30344775319099426},{-0.08153395354747772,0.25381019711494446,0.10578231513500214,-0.34197479486465454,0.09210235625505447,0.10186322778463364,0.34480881690979004,-0.05878555029630661,0.0963183343410492,0.023580297827720642,-0.08500053733587265,0.17957906424999237,0.13562071323394775,0.2592182159423828,0.147763192653656,-0.2978363335132599},{-0.22428785264492035,-0.244468092918396,-0.23615509271621704,0.0026306668296456337,-0.16572178900241852,0.06920517235994339,-0.26860541105270386,0.044604577124118805,-0.006188139319419861,-0.04221485182642937,-0.2751678228378296,-0.019572198390960693,-0.3677302598953247,0.07679155468940735,0.20874711871147156,0.08343648165464401},{-0.26572108268737793,-0.3062715232372284,-0.27520430088043213,0.3259465992450714,0.13341164588928223,-0.3679116368293762,0.2751305401325226,-0.13299819827079773,0.09631834179162979,0.2994898557662964,0.09107699245214462,0.20137931406497955,0.1908353567123413,-0.0038548982702195644,-0.23122011125087738,0.2775730490684509},{0.4078992009162903,-0.07705211639404297,-0.2473415583372116,-0.3750933110713959,-0.5913904309272766,0.2883334457874298,0.44733184576034546,-0.2669464945793152,0.15208448469638824,0.07380617409944534,-0.3107586205005646,0.11488382518291473,-0.496179461479187,0.581069827079773,-0.28873756527900696,0.009733251295983791},{-0.33934181928634644,-0.3651719093322754,0.4076384902000427,0.31906503438949585,-0.2533830404281616,0.24239778518676758,-0.07991946488618851,-0.24439048767089844,0.28026583790779114,-0.4148657023906708,-0.3037067949771881,-0.6567834615707397,-0.3309023380279541,-0.44738152623176575,0.07899710536003113,-0.23474089801311493},{-0.3560139834880829,0.2707365155220032,-0.5479612350463867,-0.05035187304019928,0.0036833430640399456,0.3398393988609314,-0.39740657806396484,-0.409471333026886,0.22954481840133667,0.14719273149967194,0.385257363319397,-0.022264055907726288,-0.23314698040485382,0.2495177537202835,0.12913013994693756,-0.46325749158859253}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.04174349084496498,-0.10121267288923264,-0.20698927342891693,-0.41525691747665405,0.34790006279945374,0.2784276008605957,0.045518659055233,0.06726819276809692,-0.1793392449617386,-0.11414085328578949,-0.05769771710038185,0.05915820598602295,0.19402723014354706,0.4230126738548279,0.06573284417390823,0.1048753559589386},{-0.12362530082464218,-0.22722673416137695,-0.05673517659306526,0.14609278738498688,0.31031715869903564,-0.21846170723438263,0.12376866489648819,0.045338328927755356,-0.052204929292201996,0.25775235891342163,-0.14988858997821808,0.34151744842529297,-0.344287246465683,0.18703293800354004,-0.3164932429790497,-0.24531708657741547},{0.11028136312961578,0.17265722155570984,-0.3139500916004181,-0.61241215467453,0.16950111091136932,0.428841233253479,-0.08543658256530762,0.10403125733137131,-0.2381017953157425,-0.23412224650382996,-0.01726888306438923,0.27351468801498413,-0.24172745645046234,-0.21746119856834412,0.1105295866727829,-0.018477823585271835},{0.13940560817718506,-0.027274226769804955,0.062109820544719696,0.14991328120231628,-0.48764947056770325,-0.0002900845429394394,0.06487073004245758,-0.2695111334323883,0.308864563703537,0.3234628438949585,-0.10745193064212799,-0.2031097114086151,-0.4217480719089508,-0.32562246918678284,0.17864581942558289,0.2379562258720398},{-0.0402076281607151,0.08880700916051865,0.022708194330334663,0.34106943011283875,-0.23795215785503387,0.007736678700894117,-0.04038974642753601,0.21897953748703003,0.21890395879745483,-0.2884000539779663,0.011782289482653141,0.3679884076118469,0.10237232595682144,-0.4373105764389038,-0.05034850165247917,-0.1432623267173767},{0.14361955225467682,0.11296292394399643,-0.009456003084778786,0.15990950167179108,-0.34275639057159424,-0.39885175228118896,0.16407138109207153,0.2708981931209564,0.13735659420490265,0.411243736743927,0.1962006539106369,-0.25282424688339233,0.01608993299305439,-0.15922482311725616,-0.09228988736867905,0.29332712292671204},{-0.023431353271007538,0.13740751147270203,0.3171314001083374,-0.34813737869262695,-0.14858579635620117,0.08198563009500504,-0.2962612509727478,-0.06075626611709595,0.13825452327728271,0.07016836106777191,-0.10473864525556564,-0.2909606993198395,-0.21551913022994995,-0.016061073169112206,0.14051614701747894,0.07555989921092987},{-0.12555620074272156,-0.1633375883102417,-0.36009812355041504,0.2961367666721344,-0.23359885811805725,-0.3042248785495758,-0.15337027609348297,-0.32963865995407104,0.032746534794569016,-0.13057804107666016,-0.1204805076122284,0.13020029664039612,-0.17189843952655792,0.40381908416748047,-0.08142407983541489,-0.370152086019516},{-0.15487848222255707,0.27308177947998047,-0.029752487316727638,-0.033762574195861816,0.30452674627304077,-0.20245817303657532,0.3663201332092285,0.11237432062625885,0.22164171934127808,0.3559308648109436,0.16783586144447327,0.3106825053691864,0.20554709434509277,-0.0409185029566288,0.24641163647174835,0.10728171467781067},{0.09026899188756943,-0.2783193290233612,-0.02548137865960598,-0.1453479379415512,0.30876782536506653,-0.044900014996528625,-0.30112382769584656,-0.23054005205631256,0.04859704151749611,-0.44696149230003357,-0.13399040699005127,0.20107117295265198,0.12121660262346268,0.1555192917585373,-0.3045790493488312,0.2982853353023529},{-0.09192872792482376,-0.30930444598197937,0.44774681329727173,0.2438526749610901,0.2149476706981659,0.13699744641780853,0.0706544890999794,-0.1441703736782074,0.1045704260468483,-0.19095611572265625,0.0026020139921456575,0.4049910306930542,0.2342592030763626,0.14825251698493958,-0.18065349757671356,-0.019897595047950745},{0.0033548297360539436,-0.11335313320159912,0.2585199475288391,-0.0018875965615734458,-0.1520618498325348,-0.22469478845596313,0.46538761258125305,0.3155668079853058,-0.26405927538871765,-0.34377428889274597,-0.09062481671571732,-0.3408922553062439,0.04502451419830322,-0.3691991865634918,-0.34969502687454224,-0.005573628935962915},{-0.060511134564876556,-0.3008307218551636,0.3086194396018982,-0.20803330838680267,0.29886147379875183,-0.30817317962646484,-0.32462450861930847,0.16981534659862518,0.07589734345674515,-0.061537206172943115,-0.25071391463279724,0.0758935809135437,0.06366762518882751,-0.22759021818637848,-0.33195194602012634,0.019833095371723175},{0.29605910181999207,-0.2644682824611664,0.39872869849205017,0.1530476212501526,0.03651078790426254,0.30128321051597595,-0.08825667202472687,-0.2159663289785385,-0.5024509429931641,0.11332164704799652,0.04865598678588867,-0.3582783639431,-0.014205463230609894,0.18817800283432007,0.35268235206604004,0.04042191803455353},{-0.2261483371257782,0.13763126730918884,0.11202560365200043,-0.2926371991634369,-0.1774994432926178,0.018957529217004776,0.21045911312103271,-0.10675535351037979,0.17086699604988098,-0.33913496136665344,-0.029327914118766785,0.03823022171854973,-0.0014609561767429113,0.038752298802137375,-0.11870779097080231,0.034814924001693726},{-0.2284533530473709,0.3007909059524536,-0.2805357575416565,0.35078224539756775,0.12115214020013809,-0.3748225271701813,-0.08130676299333572,-0.09236665815114975,-0.35790276527404785,0.2674008309841156,-0.29874372482299805,0.3109636902809143,-0.0791432186961174,-0.20136338472366333,-0.2645276188850403,-0.5388928651809692}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.11740622669458389,0.00582450395449996,-0.04203801229596138,-0.04844795539975166,-0.1197323128581047,0.02393217571079731,0.2724071443080902,0.07273495942354202,-0.13364194333553314,-0.21228082478046417,0.13420219719409943,-0.266941100358963,-0.1662544459104538,0.21225430071353912,0.2322760820388794,0.29109475016593933,-0.22609387338161469,-0.3252951204776764,-0.1693916618824005,0.06617733836174011,-0.0405985452234745,-0.3484538793563843,-0.24344509840011597,-0.2660449743270874,-0.29704999923706055,0.18008191883563995,-0.21253147721290588,-0.025522805750370026,-0.023738406598567963,0.03022826462984085,0.24595433473587036,-0.17263266444206238},{0.28856801986694336,0.2179385870695114,0.15961939096450806,-0.06362928450107574,0.10008136183023453,-0.09740934520959854,0.26919952034950256,0.14488880336284637,-0.18504294753074646,-0.1779230535030365,-0.04784476384520531,-0.227148175239563,-0.16603565216064453,0.16630026698112488,-0.20116251707077026,-0.31752434372901917,-0.05764630436897278,0.13227467238903046,-0.2730734646320343,-0.27313944697380066,0.022653255611658096,0.22309072315692902,0.10012654215097427,-0.11540883779525757,0.15056848526000977,-0.2823435068130493,0.04176803305745125,0.06608649343252182,0.2288181036710739,-0.09809524565935135,-0.030639398843050003,0.2798353135585785},{0.2254553586244583,0.08398609608411789,-0.034865546971559525,0.10330282151699066,-0.14939258992671967,-0.13381633162498474,-0.21327225863933563,0.12537233531475067,-0.1265288144350052,0.3444271981716156,-0.29641082882881165,-0.22517846524715424,0.16979967057704926,-0.3165901005268097,-0.17662829160690308,0.12431585788726807,-0.07216090708971024,-0.08588774502277374,0.22023624181747437,-0.02708950825035572,0.1769533008337021,0.2891967296600342,-0.26787683367729187,0.0641467347741127,-0.16741210222244263,-0.09936343133449554,0.11215027421712875,-0.03422488272190094,-0.08261208236217499,-0.16458681225776672,-0.036094941198825836,-0.15807749330997467},{0.3180769085884094,0.043998729437589645,0.09462174773216248,-0.13416312634944916,-0.24468892812728882,-0.08385544270277023,-0.11673171818256378,0.2048557698726654,0.23674139380455017,-0.1933203488588333,-0.13399077951908112,0.24384234845638275,0.12894408404827118,-0.08448988944292068,-0.2452937811613083,0.3279949724674225,-0.30493465065956116,0.2756864130496979,-0.05772324278950691,0.04424865543842316,-0.07419882714748383,-0.09596560895442963,0.2666577696800232,0.17045958340168,0.16208931803703308,-0.31296175718307495,0.2827397882938385,-0.1908857524394989,-0.04550260305404663,-0.003583116689696908,-0.3152477741241455,0.13658499717712402},{-0.027369879186153412,-0.02040090039372444,-0.0821186900138855,0.04289683327078819,0.2006133794784546,-0.13308709859848022,-0.37809276580810547,0.01767929270863533,-0.14844374358654022,-0.21800124645233154,0.16959524154663086,0.2181389331817627,-0.09714939445257187,-0.08787890523672104,-0.07178810983896255,0.21720409393310547,-0.028072157874703407,0.01540735736489296,-0.3279882073402405,-0.040647923946380615,-0.19781075417995453,-0.31634750962257385,0.16821615397930145,0.2234744429588318,-0.055433034896850586,0.26885801553726196,-0.16046471893787384,0.2603710889816284,0.27752944827079773,0.3529786467552185,0.026821734383702278,0.28174859285354614},{-0.19241240620613098,-0.11835937947034836,-0.11827058345079422,-0.09934373199939728,-0.10586290061473846,0.21783675253391266,0.2207968831062317,0.05705854669213295,0.32751327753067017,0.12173240631818771,0.277527391910553,-0.21609850227832794,-0.14047007262706757,0.24813121557235718,0.23824293911457062,-0.3311612606048584,-0.06926379352807999,-0.2311449944972992,0.2314034253358841,0.18172623217105865,0.06047096475958824,0.1334308236837387,-0.016480039805173874,0.0023568570613861084,-0.32595112919807434,0.2827223539352417,-0.204342320561409,0.15364594757556915,0.2937255799770355,0.22298114001750946,0.11017995327711105,0.04090513661503792},{0.15600594878196716,-0.13162027299404144,-0.13466115295886993,-0.3248354196548462,0.009445414878427982,0.2334393858909607,0.27382612228393555,0.11724147945642471,0.10501348972320557,0.2892039120197296,-0.00022055530280340463,0.013152590952813625,-0.4446776807308197,-0.12296541035175323,-0.13522793352603912,0.017527269199490547,-0.273567795753479,-0.21972686052322388,0.17807388305664062,-0.09232515841722488,-0.11885909736156464,-0.14959996938705444,-0.22274069488048553,-0.2615823447704315,0.17361105978488922,-0.2511154115200043,-0.12354516237974167,-0.21732980012893677,0.3343908488750458,0.12592807412147522,-0.18399938941001892,-0.2672605514526367},{0.06346472352743149,0.20100851356983185,0.05500296875834465,-0.10461920499801636,0.13170446455478668,-0.27359870076179504,-0.06594957411289215,-0.14303681254386902,0.005195560399442911,-0.30897536873817444,-0.2843763530254364,-0.0726606622338295,-0.13820700347423553,0.04106627777218819,-0.09950805455446243,0.3784749507904053,0.00500088557600975,-0.1524685174226761,0.14650405943393707,0.3152713179588318,-0.167754128575325,-0.20269142091274261,0.28453537821769714,0.0662272721529007,-0.013102572411298752,-0.32913336157798767,-0.3095701038837433,-0.22322477400302887,-0.3440859019756317,-0.2418779581785202,0.10654402524232864,-0.3578200936317444},{0.045606859028339386,0.3579922318458557,-0.33431071043014526,-0.355781614780426,-0.24250124394893646,0.04097552224993706,0.09622234851121902,0.0915442481637001,0.1577945202589035,-0.21654339134693146,-0.24271386861801147,0.27210214734077454,-0.2905210256576538,-0.14111466705799103,0.16382509469985962,-0.22714582085609436,0.214044451713562,0.11457575857639313,0.27006790041923523,0.07179269194602966,0.21924114227294922,0.08118218928575516,0.28647327423095703,-0.10565632581710815,0.4642227590084076,-0.1762346476316452,0.15832963585853577,0.29010242223739624,-0.20096606016159058,0.12095140665769577,-0.003402294823899865,0.08790392428636551},{-0.18036173284053802,0.09824825823307037,-0.29917046427726746,-0.16142788529396057,0.11938179284334183,-0.1757930964231491,0.07883754372596741,0.016262970864772797,0.1510377675294876,-0.00040473611443303525,-0.23335543274879456,-0.3016364574432373,-0.38254833221435547,-0.12326644361019135,-0.22083234786987305,0.07280174642801285,0.006593519356101751,-0.24347595870494843,0.251784086227417,0.0805889442563057,0.07242442667484283,-0.015541729517281055,0.34435316920280457,-0.23723766207695007,0.3158319294452667,0.13356183469295502,-0.21168209612369537,0.07687218487262726,0.02459302544593811,0.08684676140546799,-0.15262407064437866,0.1457800418138504},{0.06517858058214188,-0.058663710951805115,0.19972440600395203,-0.25106343626976013,-0.2213108092546463,-0.2262984961271286,-0.2597828209400177,-0.10502578318119049,-0.15114375948905945,0.3032929003238678,0.10713311284780502,-0.26741790771484375,-0.3327186703681946,0.006237175781279802,-0.20703470706939697,-0.22607682645320892,0.26571419835090637,-0.15298432111740112,0.26969605684280396,-0.21847711503505707,-0.1870613396167755,-0.014003666117787361,0.1461450457572937,0.16503988206386566,0.14828191697597504,-0.1297280490398407,-0.07581427693367004,-0.0877465009689331,-0.06514759361743927,0.03490602597594261,-0.07944119721651077,0.17535443603992462},{-0.2183973640203476,-0.043557308614254,0.24850815534591675,0.34761956334114075,0.2681518793106079,-0.01195145770907402,0.050681572407484055,-0.218833327293396,-0.08519043028354645,-0.1886647343635559,0.276109516620636,-0.24671490490436554,-0.20679204165935516,-0.20379699766635895,0.28167062997817993,0.0026004426181316376,-0.02372930943965912,0.019577499479055405,0.323893666267395,0.07466097176074982,-0.1661665290594101,0.20843791961669922,0.10449501872062683,-0.11510052531957626,0.19170530140399933,-0.09596998989582062,-0.1444350928068161,0.20764532685279846,0.20641057193279266,-0.024202855303883553,-0.2712612748146057,-0.24327577650547028},{0.21595999598503113,-0.2198900282382965,-0.0003397056716494262,-0.334407776594162,0.1325506716966629,-0.03026234544813633,0.170916348695755,0.07605341821908951,0.23767173290252686,0.03893318027257919,0.1537649780511856,0.1836981177330017,-0.37562254071235657,-0.21767154335975647,-0.048081912100315094,-0.23224113881587982,-0.10475113242864609,-0.19899477064609528,0.250529944896698,-0.23386389017105103,0.24400751292705536,0.019712859764695168,-0.013347451575100422,0.17657124996185303,0.11045954376459122,-0.06123412400484085,0.1274706870317459,0.16270671784877777,0.12957824766635895,-0.07112216204404831,-0.18477538228034973,-0.10124765336513519},{0.22109568119049072,-0.04077199473977089,-0.057988788932561874,0.4094204604625702,-0.0994471088051796,-0.18256476521492004,-0.07344277203083038,0.10770068317651749,0.15908077359199524,0.28561389446258545,0.12661270797252655,-0.1540341079235077,0.011928725987672806,0.204458549618721,-0.09711543470621109,0.05881786718964577,0.20964255928993225,-0.22657185792922974,0.05823139473795891,-0.3156382739543915,0.30668702721595764,0.1635371297597885,-0.060199618339538574,0.18775944411754608,0.19377300143241882,0.07511047273874283,0.09742943942546844,0.07004640251398087,0.04901907965540886,-0.1591688096523285,-0.02944713644683361,0.3914135694503784},{0.036750081926584244,-0.27832990884780884,-0.07977647334337234,0.11442580074071884,-0.24773113429546356,-0.005084959790110588,0.05225240811705589,-0.2651456892490387,-0.17249999940395355,-0.07238984107971191,0.1898711621761322,0.159611776471138,0.08471547067165375,0.26283010840415955,-0.054571207612752914,-0.11023734509944916,-0.21818293631076813,0.25948283076286316,-0.08527129888534546,-0.2615196108818054,-0.19071343541145325,-0.07736774533987045,0.17118506133556366,-0.012549364939332008,-0.04913521185517311,-0.09156522154808044,-0.19588807225227356,0.22308951616287231,0.05728292837738991,-0.16651180386543274,0.225765660405159,0.19957873225212097},{0.14521966874599457,-0.22375206649303436,-0.06526845693588257,-0.18283705413341522,-0.08571211248636246,0.16721446812152863,0.031278371810913086,0.24363261461257935,-0.07859604805707932,-0.016283007338643074,0.2703305780887604,0.12768468260765076,-0.024682771414518356,-0.10970042645931244,0.0599575899541378,0.1348833590745926,-0.38567066192626953,-0.2919979989528656,-0.04340493306517601,0.052111271768808365,0.11064859479665756,0.22631439566612244,0.2601885497570038,0.1522720754146576,0.04763247072696686,0.2254754602909088,0.02050882950425148,-0.07039397954940796,0.1918303519487381,-0.09252423048019409,-0.2268870621919632,0.3658655881881714},{0.21680700778961182,-0.03794456273317337,-0.2349468171596527,0.15053676068782806,0.07956652343273163,-0.07796872407197952,0.2746444642543793,0.12285694479942322,0.12146423757076263,-0.20125730335712433,0.19531752169132233,-0.1690133959054947,-0.3392183780670166,0.2427843064069748,0.06339967250823975,0.05993819236755371,0.053231071680784225,-0.05163946375250816,-0.14208939671516418,0.09579121321439743,-0.06873810291290283,0.16165849566459656,0.047539856284856796,-0.11824212968349457,0.04940780624747276,-0.3413705825805664,0.02984529733657837,0.37788864970207214,0.1860361099243164,-0.13075578212738037,0.19941571354866028,0.16452383995056152},{-0.10589803010225296,-0.035207364708185196,-0.11148969829082489,-0.03508047014474869,-0.2383805811405182,-0.03864597529172897,0.20666445791721344,0.13105005025863647,0.14161095023155212,0.02838636003434658,0.2466418594121933,-0.002085665473714471,0.20018324255943298,0.1715775430202484,0.18415340781211853,-0.12757714092731476,0.10884907841682434,0.15560993552207947,0.22699186205863953,0.04197419062256813,0.1872386634349823,0.2315230518579483,0.06274273991584778,0.129875048995018,-0.05111488699913025,-0.07962290942668915,-0.10441220551729202,-0.2697025239467621,0.17025545239448547,-0.24181883037090302,-0.02264213375747204,-0.02022635191679001},{-0.2568832337856293,0.10942573845386505,-0.2560111880302429,-0.3342303931713104,-0.03789316862821579,0.07135102897882462,0.09498465806245804,-0.06888139247894287,-0.018838532269001007,0.2722513675689697,0.060544539242982864,-0.18443943560123444,0.12556955218315125,-0.20668958127498627,-0.3037969470024109,-0.030283911153674126,-0.17825336754322052,0.15106959640979767,-0.0014683486660942435,-0.02763938345015049,-0.3022829294204712,0.15637443959712982,0.11179254949092865,0.02267492190003395,-0.0018457319820299745,0.22436124086380005,0.04115847870707512,-0.13570889830589294,-0.17771774530410767,0.051703840494155884,-0.09692700952291489,-0.23097285628318787},{0.004152411594986916,-0.2057000696659088,-0.21404503285884857,-0.018412290140986443,-0.3556509017944336,-0.12865105271339417,0.15335088968276978,-0.2920019328594208,-0.1993788629770279,0.18024809658527374,0.15308870375156403,0.12502241134643555,0.1394522339105606,-0.11715518683195114,0.31716951727867126,-0.31875771284103394,0.09460524469614029,0.2415136694908142,0.06246018409729004,0.23771238327026367,0.04295186698436737,-0.09825819730758667,-0.2776419222354889,0.17951342463493347,-0.18621468544006348,-0.17897574603557587,0.10654246807098389,0.05287229269742966,-0.11162248253822327,-0.29390203952789307,-0.006744618993252516,-0.14555831253528595},{0.23657403886318207,0.21091975271701813,-0.06838355213403702,0.17958003282546997,-0.2887289226055145,0.18629881739616394,-0.06491430103778839,-0.12799400091171265,-0.18987047672271729,0.1781342774629593,-0.25357189774513245,-0.15820470452308655,-0.02876262739300728,-0.19958922266960144,-0.3585895597934723,-0.11501146107912064,-0.07343892753124237,-0.26647523045539856,-0.23389998078346252,0.25640392303466797,0.09091439098119736,0.12569136917591095,-0.3334629237651825,0.31966572999954224,0.18567410111427307,0.24848437309265137,-0.28084611892700195,-0.007967064157128334,0.07057749480009079,-0.25205156207084656,0.1446651816368103,0.09765414893627167},{-0.019224241375923157,-0.31427252292633057,0.009436237625777721,-0.24582791328430176,-0.10266800224781036,0.27629444003105164,0.1375039666891098,0.010053258389234543,-0.05408205837011337,0.0019196447683498263,-0.18446102738380432,0.19852517545223236,0.13618256151676178,0.08630593121051788,0.190200075507164,-0.04262016713619232,-0.08606654405593872,0.08674225956201553,-0.07649894803762436,0.15586672723293304,0.2447781264781952,0.21698057651519775,-0.04441811144351959,-0.2792838215827942,0.05236339941620827,0.11439597606658936,0.29267454147338867,0.11882573366165161,-0.00951958354562521,0.20942552387714386,0.026800310239195824,-0.09372086822986603},{0.01630154252052307,-0.16794103384017944,0.21931403875350952,0.007982868701219559,0.2953505218029022,-0.03958497568964958,-0.11321765184402466,-0.15733079612255096,0.1282978057861328,-0.06362209469079971,0.07631915807723999,-0.002460335846990347,-0.3165048062801361,0.013024422340095043,-0.09850172698497772,-0.22404882311820984,-0.05606447905302048,-0.05428842827677727,0.21549110114574432,0.2350129336118698,0.03869375213980675,0.04641800373792648,0.1845342069864273,0.33988404273986816,-0.1444023847579956,-0.029873745515942574,0.20420505106449127,-0.10951641201972961,-0.1906285583972931,-0.2504996955394745,0.28730738162994385,0.001184628577902913},{0.17051289975643158,-0.09132137149572372,0.017375189810991287,0.1469869464635849,-0.02279265969991684,0.051737576723098755,-0.26658132672309875,0.23591339588165283,-0.045642465353012085,-0.023648889735341072,0.09145655483007431,-0.28556016087532043,-0.02109150029718876,-0.009387495927512646,-0.10898786038160324,0.2576903998851776,-0.08842629194259644,-0.20696021616458893,0.014817745424807072,-0.03725796937942505,-0.1725636124610901,0.2009306401014328,0.2224215865135193,0.20939725637435913,-0.29965686798095703,0.13123103976249695,-0.07012820988893509,0.07758235186338425,-0.27897679805755615,0.2522587478160858,-0.04821385443210602,0.04716558754444122}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.1455177217721939,-0.07404860854148865,0.04490014910697937,-0.10015836358070374},{0.17118604481220245,-0.2903091013431549,0.22483180463314056,0.19545815885066986},{-0.1612812876701355,0.07976429164409637,0.02395974099636078,-0.005729495547711849},{0.2770084738731384,0.4107792377471924,0.2932896316051483,0.03765474632382393},{-0.22377540171146393,0.10232146084308624,-0.2523099482059479,0.07016566395759583},{-0.023051856085658073,-0.028644787147641182,0.04642528295516968,0.26531982421875},{-0.11016999185085297,-0.07462074607610703,-0.25629857182502747,-0.024349475279450417},{-0.11933007836341858,-0.19874897599220276,0.09465013444423676,-0.06883188337087631},{-0.019100800156593323,0.050898440182209015,-0.05440589413046837,-0.08011242002248764},{0.15837056934833527,0.0032248380593955517,-0.07154343277215958,-0.09772118180990219},{0.12180298566818237,-0.09951183199882507,0.2594122886657715,0.22208274900913239},{0.01632624678313732,-0.009036804549396038,0.23121163249015808,-0.06089022755622864},{-0.28914791345596313,0.1808277815580368,-0.02032596617937088,-0.11534368991851807},{-0.13391609489917755,0.07653121650218964,-0.17253170907497406,0.0608602799475193},{0.15771889686584473,0.04799537733197212,0.21030598878860474,0.07296288013458252},{-0.11271648108959198,-0.34522971510887146,-0.11419655382633209,-0.08273421227931976},{-0.18191960453987122,0.0493156723678112,-0.08750101178884506,0.212858647108078},{-0.20515219867229462,-0.11780296266078949,-0.19418367743492126,0.15770019590854645},{-0.059737950563430786,-0.02908155508339405,0.2712499499320984,0.07140471786260605},{-0.13678406178951263,-0.12165895104408264,0.012295662425458431,-0.14605221152305603},{0.12497453391551971,0.08257054537534714,0.08210813999176025,-0.09981639683246613},{-0.029372327029705048,-0.17322924733161926,-0.06766589730978012,0.1960838884115219},{0.31871646642684937,-0.15015341341495514,0.12308716028928757,0.01551789976656437},{-0.28548312187194824,-0.1233346089720726,-0.2983414828777313,-0.2797117829322815},{-0.12183237075805664,-0.11994069069623947,-0.04881218075752258,-0.09669385850429535},{0.09730080515146255,0.07340960949659348,-0.020534053444862366,0.09609570354223251},{0.13736885786056519,-0.16203388571739197,0.19266082346439362,0.053159199655056},{-0.08320124447345734,-0.12438501417636871,-0.006464000791311264,0.2030734419822693},{0.05884186178445816,0.028307566419243813,0.03699544072151184,0.04248649999499321},{-0.12078208476305008,0.1004820242524147,0.17141857743263245,-0.004612822085618973},{-0.15834084153175354,-0.1238705962896347,0.05973724275827408,0.1388012170791626},{0.1805211901664734,0.18551257252693176,0.21466180682182312,-0.03207771107554436}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11614224314689636,-0.09405384212732315,0.026442987844347954,0.08431490510702133,0.11665613949298859,-0.09026723355054855,0.07540038973093033,-0.02941490150988102,-0.05501385033130646,-0.10013988614082336,-0.010521749965846539,0.06776633858680725,-0.023968536406755447,0.04935001581907272,0.09273231774568558,-0.044874195009469986};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.047366995364427567,0.06382203102111816,0.014539279043674469,-0.01225558202713728,-0.018448390066623688,0.06616175919771194,-0.058481037616729736,-0.07749691605567932,0.057093653827905655,0.007896648719906807,-0.015382155776023865,-0.041331470012664795,0.021579816937446594,-0.08135326951742172,0.004478800110518932,-0.06568875908851624};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.04536515101790428,0.00516896229237318,-0.047663867473602295,0.03377024829387665,0.002423349767923355,0.017312275245785713,-0.05413417890667915,-0.04192616045475006,-0.02591191977262497,-0.012399865314364433,0.02128794603049755,0.041670359671115875,0.03926679864525795,-0.042900387197732925,0.032286860048770905,-0.09388847649097443,-0.004682864062488079,-0.03390609100461006,0.0348467119038105,-0.04824316129088402,0.028237145394086838,-0.002201992552727461,0.0403597317636013,-0.0720512792468071,-0.06129319965839386,0.06696625798940659,0.04795905947685242,-0.027275098487734795,0.08259033411741257,0.03582223504781723,-0.0017243933398276567,0.06489954143762589};
static const float action_parameterization_distribution_linear_bias[4] = {0.038396574556827545,0.07554549723863602,0.015538531355559826,0.041603174060583115};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.3071522116661072,-0.12836703658103943,-0.01161187794059515,0.15500594675540924,0.03037969022989273,0.02436259761452675,-0.19144129753112793,0.027186481282114983},{0.023306937888264656,0.11872480064630508,0.26336175203323364,0.3114657402038574,-0.13185536861419678,-0.21210512518882751,0.31611010432243347,0.0901881530880928},{0.004995065275579691,0.22810602188110352,-0.001109392731450498,-0.029721511527895927,0.27660760283470154,0.24729759991168976,-0.09984586387872696,0.034665342420339584},{0.12470988929271698,-0.2068321704864502,0.3100278675556183,-0.24515727162361145,-0.3219279646873474,0.012293190695345402,0.16910940408706665,0.16631653904914856},{-0.21037182211875916,0.018828388303518295,0.021123986691236496,-0.3508569598197937,0.03902290761470795,0.05407075211405754,0.21196629106998444,0.25744885206222534},{-0.053102388978004456,0.2669420540332794,-0.057962995022535324,-0.27866873145103455,0.11213135719299316,-0.020200880244374275,-0.002153557725250721,-0.20309028029441833},{-0.020691266283392906,0.30932506918907166,0.2037263661623001,-0.19449445605278015,0.20124293863773346,-0.29654011130332947,0.2494853138923645,0.07768416404724121},{0.006749550811946392,-0.20784401893615723,0.13200941681861877,-0.12675099074840546,0.31389832496643066,-0.13432654738426208,0.042890701442956924,-0.3017113208770752},{-0.1581432968378067,0.2735322117805481,0.18577174842357635,-0.008682344108819962,0.022085214033722878,0.2092006951570511,0.3648643493652344,0.35473957657814026},{0.06918667256832123,-0.069400854408741,-0.22313246130943298,0.36937832832336426,0.2507706582546234,0.1426948457956314,0.1682574450969696,-0.2645229697227478},{-0.11614326387643814,-0.30962371826171875,0.356733500957489,0.2473987340927124,-0.03159760683774948,-0.3523319661617279,-0.11307809501886368,-0.2936963438987732},{0.337695837020874,0.05753462389111519,0.35247310996055603,0.49959322810173035,-0.14076432585716248,0.1704632043838501,0.11529646813869476,-0.31330978870391846},{-0.28435519337654114,0.16956599056720734,-0.3460274636745453,0.3989000618457794,-0.04146865755319595,0.2009444534778595,0.0243979562073946,0.2407466173171997},{-0.029338112100958824,0.18507987260818481,-0.12594592571258545,-0.18748974800109863,0.023790763691067696,0.06116832047700882,0.3128693997859955,-0.06447441875934601},{0.14472471177577972,-0.30022647976875305,-0.26450854539871216,-0.18945109844207764,0.18875470757484436,-0.158774271607399,0.1835698038339615,-0.1696837693452835},{-0.33830076456069946,-0.30764901638031006,-0.21553738415241241,-0.04094019904732704,0.02260938473045826,0.14438295364379883,0.17764365673065186,-0.03138342127203941},{-0.24586807191371918,-0.2747499346733093,0.15660357475280762,-0.17597898840904236,0.018560873344540596,0.09782171249389648,-0.40358972549438477,-0.22339318692684174},{0.015271654352545738,0.26480481028556824,0.06716055423021317,0.2506721019744873,-0.152091383934021,0.33813074231147766,0.28197070956230164,-0.1493595838546753},{-0.01704186201095581,-0.2806900143623352,-0.10275319963693619,0.001239021890796721,-0.10798180103302002,-0.3541261851787567,0.07893045246601105,-0.20601896941661835},{-0.11848051100969315,0.018405301496386528,0.07612849771976471,-0.26395729184150696,0.1226699948310852,0.021438870579004288,0.09376442432403564,0.020462973043322563},{0.03247762843966484,-0.05846596881747246,0.08190388977527618,-0.11994797736406326,0.08263825625181198,-0.0378495454788208,0.10476323962211609,-0.1768457293510437},{-0.28509482741355896,0.22839951515197754,0.20664502680301666,-0.2796202003955841,-0.3462308645248413,-0.03493569791316986,0.21365851163864136,0.012915796600282192},{0.28063490986824036,0.05880368873476982,-0.4037967920303345,-0.03446537256240845,-0.10128092765808105,0.21295645833015442,0.20234383642673492,0.24990762770175934},{0.010524535551667213,-0.22445230185985565,-0.04639822244644165,0.1105252057313919,-0.3690270185470581,-0.09532825648784637,-0.30936533212661743,-0.3357168436050415},{0.13128869235515594,-0.1336306631565094,-0.34427160024642944,0.35129666328430176,-0.3232269883155823,-0.0801745057106018,-0.4543069303035736,0.06977900117635727},{0.0032208298798650503,0.3026933968067169,-0.12794794142246246,-0.06279414892196655,0.10139269381761551,-0.13496655225753784,0.22713349759578705,-0.3029595911502838},{-0.08898305892944336,0.12581457197666168,-0.048759184777736664,-0.24604295194149017,0.04424118250608444,-0.137771874666214,-0.18856464326381683,-0.0899348184466362},{0.08093760907649994,-0.15536968410015106,0.03601760044693947,-0.10119275003671646,0.08419795334339142,0.07814162969589233,-0.29318705201148987,0.1415652483701706},{0.19174562394618988,0.03681912645697594,-0.2833799421787262,-0.13853374123573303,-0.17013485729694366,0.16828113794326782,0.1611766368150711,0.06648226827383041},{0.2693966031074524,-0.3950900733470917,0.01390361599624157,-0.06334701180458069,0.07494282722473145,-0.12184470146894455,0.1164848655462265,0.23220393061637878},{-0.3278657793998718,-0.26384100317955017,0.03103695809841156,-0.3692361116409302,0.2511381208896637,-0.410445898771286,-0.0752570778131485,0.06587562710046768},{0.29253074526786804,0.19384990632534027,-0.013238784857094288,0.17167551815509796,0.09967519342899323,-0.25402769446372986,-0.08320974558591843,0.14947618544101715}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.18980327248573303,0.36797723174095154,-0.42447611689567566,-0.4856237769126892,-0.15791352093219757,-0.1175743043422699,-0.32626473903656006,0.46442243456840515},{0.01743132993578911,0.35261300206184387,-0.22407987713813782,0.4397766888141632,-0.037096261978149414,-0.0784260481595993,-0.3113086521625519,-0.06599724292755127},{-0.2731111943721771,-0.2074270397424698,-0.1473238468170166,-0.1680324822664261,0.3885342478752136,0.20039094984531403,-0.10896849632263184,0.353101909160614},{-0.45068544149398804,-0.41583406925201416,0.2814379930496216,0.17610955238342285,-0.48237404227256775,-0.18716232478618622,0.3957487642765045,0.20886191725730896},{-0.25774919986724854,-0.19729432463645935,-0.2816355526447296,-0.17818643152713776,0.31392088532447815,-0.21386639773845673,0.391119122505188,-0.31556567549705505},{-0.05403825268149376,0.28349077701568604,0.08088674396276474,-0.5762172937393188,0.5094836354255676,-0.21471862494945526,-0.495986670255661,-0.3335854113101959},{-0.24901559948921204,0.09893084317445755,0.04982167109847069,-0.396694153547287,0.05217740684747696,-0.4472402036190033,0.37025344371795654,0.08482342958450317},{-0.26741907000541687,-0.12584950029850006,-0.10628797858953476,-0.34277886152267456,-0.354977548122406,0.06765130162239075,0.5418947339057922,-0.31619375944137573}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.04769809916615486,-0.07423979043960571,-0.09053856134414673,0.04315028712153435,0.13730616867542267,0.016983704641461372,0.06849368661642075,0.015689603984355927};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.009615341201424599,0.018163243308663368,-0.021891934797167778,-0.06659471243619919,-0.06464924663305283,-0.021435845643281937,0.022547729313373566,-0.14936403930187225};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

