#include "network_evaluate_tof.h"


#define EPS 0.000001 // 1e-6
#define OBST_DIM 32

static float obstacle_embeds[8];
static float output_embeds[24];

float base;
float exponent;
static const int self_structure [4][2] = {{18, 16},{16, 16},{24, 32},{32, 4}};
static const int obst_structure [2][2] = {{32, 8},{8, 8}};
static float output_0[16];
static float output_1[16];
static float obst_output_0[8];
static float obst_output_1[8];
static float output_2[32];
static float output_3[4];
static const float actor_encoder_self_encoder_0_weight[18][16] = {{0.3750937283039093,-0.23679134249687195,0.361752986907959,0.16657885909080505,-0.4190077483654022,0.11326995491981506,0.01225140132009983,-0.21779601275920868,0.10984518378973007,0.47017496824264526,0.1028657779097557,-0.006127255968749523,0.15376172959804535,-0.14813928306102753,0.4080554246902466,-0.13012783229351044},{-0.3731563091278076,-0.19960251450538635,0.29493623971939087,0.1377958357334137,-0.25329428911209106,-0.021536748856306076,-0.37784814834594727,0.05649302527308464,-0.17878735065460205,-0.09976648539304733,0.11616428941488266,-0.14284659922122955,0.19920377433300018,-0.3493310511112213,-0.25714126229286194,0.09141985327005386},{0.1764419972896576,-0.2504887282848358,-0.24055859446525574,0.027035392820835114,0.11278369277715683,0.15171445906162262,-0.08738905191421509,-0.006813559215515852,-0.08815183490514755,-0.19460603594779968,-0.20275142788887024,0.4049714505672455,0.0005419139633886516,-0.15775492787361145,-0.3533579111099243,0.22370943427085876},{0.18617501854896545,0.2352530062198639,0.3184012770652771,-0.11240114271640778,-0.33264318108558655,-0.002383665181696415,0.11337414383888245,0.11517785489559174,0.5085834264755249,-0.3700099289417267,0.03459181636571884,0.12213006615638733,-0.2732573449611664,-0.09447085857391357,0.31852132081985474,-0.3715442419052124},{-0.05096371844410896,0.15788514912128448,0.21821041405200958,-0.09981312602758408,0.22593623399734497,0.2549644112586975,0.22134968638420105,-0.04441070184111595,-0.07483502477407455,0.23304645717144012,0.3084287941455841,-0.10060525685548782,-0.0980352982878685,-0.35014820098876953,0.3399208188056946,0.12269075214862823},{-0.051202546805143356,-0.17206858098506927,-0.15053661167621613,-0.269341379404068,0.11490465700626373,0.05007482320070267,-0.041805200278759,-0.16161476075649261,0.2381914258003235,-0.22181223332881927,-0.31571531295776367,0.19023211300373077,0.36890971660614014,-0.04268082603812218,-0.0820385292172432,0.18626894056797028},{-0.09378331154584885,0.08912179619073868,0.05726410821080208,-0.2296493798494339,0.2473118156194687,0.02080088108778,0.05965804308652878,0.39637646079063416,0.2673312723636627,-0.007152554113417864,-0.35362377762794495,0.28079673647880554,-0.040689997375011444,0.17148448526859283,-0.1732650101184845,-0.17996902763843536},{0.023241983726620674,-0.04166164994239807,0.23101834952831268,0.21107427775859833,-0.3499835431575775,0.022759804502129555,0.2793780267238617,0.3420848548412323,-0.04004621505737305,0.18287503719329834,-0.4556328356266022,-0.28057733178138733,0.25937533378601074,0.24773064255714417,0.2230624556541443,0.14922669529914856},{0.3505074679851532,-0.18774960935115814,0.35835132002830505,-0.04186033830046654,0.10651210695505142,0.11903883516788483,-0.23851501941680908,-0.2506716847419739,0.1970525085926056,-0.2668847143650055,0.01638120412826538,-0.27946391701698303,-0.19933567941188812,0.3124520480632782,0.14671394228935242,-0.0986250787973404},{0.05051714926958084,-0.1956479251384735,-0.44971156120300293,-0.06995756179094315,-0.3224620223045349,0.18876847624778748,0.4074019193649292,0.16243180632591248,0.4383145570755005,0.41606757044792175,0.0065019805915653706,-0.2950131893157959,0.10342411696910858,0.30824196338653564,-0.11542785912752151,-0.3798229992389679},{0.044382885098457336,0.27178555727005005,0.35171598196029663,-0.2581627070903778,-0.2845400869846344,0.21586328744888306,0.21963584423065186,0.3337499797344208,-0.28730127215385437,-0.03409707546234131,-0.03407645225524902,0.16785219311714172,-0.2852165400981903,-0.18058541417121887,0.316457599401474,-0.36777690052986145},{0.012352634221315384,-0.1656210720539093,0.011076209135353565,0.17644396424293518,0.3472158908843994,0.32848748564720154,0.40671050548553467,-0.030930662527680397,0.022778348997235298,-0.06322238594293594,0.3032661974430084,-0.17492172122001648,0.02486073598265648,-0.2591288983821869,0.2923990786075592,0.29519596695899963},{-0.09730323404073715,0.25513896346092224,0.09387161582708359,-0.3381928503513336,0.1007591187953949,0.10441206395626068,0.35448384284973145,-0.03146817535161972,0.0948961153626442,5.0893722800537944e-05,-0.09002042561769485,0.16046792268753052,0.14288917183876038,0.2800407111644745,0.13656103610992432,-0.3013279438018799},{-0.22246482968330383,-0.25450167059898376,-0.251312792301178,0.0014590434730052948,-0.18068698048591614,0.08960601687431335,-0.2903203070163727,0.07440990209579468,-0.01103937067091465,-0.05200259014964104,-0.28063613176345825,-0.04921659827232361,-0.3665385842323303,0.08067173510789871,0.20688538253307343,0.09224625676870346},{-0.23121176660060883,-0.3094621002674103,-0.25968095660209656,0.3394831418991089,0.12350249290466309,-0.3638758659362793,0.27352023124694824,-0.12770041823387146,0.07872731983661652,0.28485381603240967,0.09315658360719681,0.20558050274848938,0.18130502104759216,-0.03325500339269638,-0.22386693954467773,0.22105908393859863},{0.43170982599258423,-0.03427135571837425,-0.25947025418281555,-0.3670521378517151,-0.5941459536552429,0.2925525903701782,0.4673396348953247,-0.274819016456604,0.14619626104831696,0.07167595624923706,-0.2831447124481201,0.08409126847982407,-0.4812292754650116,0.5539145469665527,-0.2781805098056793,-0.004391227848827839},{-0.3853094279766083,-0.35567453503608704,0.38935574889183044,0.3423694968223572,-0.2842765152454376,0.26064759492874146,-0.08815395832061768,-0.24694706499576569,0.27602440118789673,-0.4247049391269684,-0.31687259674072266,-0.6664799451828003,-0.2827643156051636,-0.41522836685180664,0.06604454666376114,-0.19791334867477417},{-0.34245967864990234,0.2804911732673645,-0.5453003644943237,-0.02772935852408409,-0.006973222829401493,0.37597811222076416,-0.36331886053085327,-0.40582597255706787,0.22858655452728271,0.18340715765953064,0.3842689096927643,-0.04316126927733421,-0.24234946072101593,0.24994410574436188,0.18109799921512604,-0.5026036500930786}};
static const float actor_encoder_self_encoder_2_weight[16][16] = {{0.0780952125787735,-0.10362441092729568,-0.20021522045135498,-0.4139029085636139,0.3579484820365906,0.2884896993637085,0.07408733665943146,0.0715455561876297,-0.21655794978141785,-0.11149293929338455,-0.07749631255865097,0.06781458109617233,0.22200757265090942,0.4381300210952759,0.08886423707008362,0.09379331022500992},{-0.17710448801517487,-0.23324869573116302,-0.042213719338178635,0.14328724145889282,0.3072783350944519,-0.228399395942688,0.13066893815994263,0.04845454916357994,-0.05537165328860283,0.25243663787841797,-0.12230583280324936,0.33237752318382263,-0.346573144197464,0.2007014900445938,-0.33741238713264465,-0.26292410492897034},{0.12380366027355194,0.19121305644512177,-0.3189413547515869,-0.6081745028495789,0.18284007906913757,0.4285154938697815,-0.08892939239740372,0.11151988059282303,-0.24733084440231323,-0.24233809113502502,-0.01820368319749832,0.28384077548980713,-0.2654941976070404,-0.2394740879535675,0.090570829808712,-0.031926099210977554},{0.20697633922100067,-0.03409281745553017,0.04800788313150406,0.14244456589221954,-0.5004863142967224,0.012946142815053463,0.059379298239946365,-0.26422539353370667,0.31840622425079346,0.35434234142303467,-0.12272366136312485,-0.1936665177345276,-0.40659579634666443,-0.35245174169540405,0.19594024121761322,0.23917153477668762},{-0.11738672107458115,0.08130001276731491,0.03872562572360039,0.33328568935394287,-0.25767993927001953,0.008796969428658485,-0.025712277740240097,0.22219297289848328,0.22116799652576447,-0.28058111667633057,0.02507551945745945,0.3648132085800171,0.11656247824430466,-0.43008992075920105,-0.075093574821949,-0.13697341084480286},{0.18098823726177216,0.13161055743694305,-0.006307048257440329,0.17951694130897522,-0.3447752296924591,-0.41342461109161377,0.19706378877162933,0.27074217796325684,0.13411445915699005,0.40869614481925964,0.21087528765201569,-0.2573438286781311,0.021857205778360367,-0.17845997214317322,-0.08750747889280319,0.2969765067100525},{-0.05569170042872429,0.1391337662935257,0.366059273481369,-0.343117356300354,-0.1427951157093048,0.06110679358243942,-0.2868351638317108,-0.05776720866560936,0.13051073253154755,0.0799102708697319,-0.11271413415670395,-0.2868804335594177,-0.22420300543308258,0.015642069280147552,0.14708566665649414,0.08430160582065582},{-0.159579336643219,-0.15870100259780884,-0.36689871549606323,0.2908403277397156,-0.22861963510513306,-0.3114880919456482,-0.18139690160751343,-0.33001908659935,0.04343787953257561,-0.15954868495464325,-0.1326262503862381,0.1581929624080658,-0.21396958827972412,0.43193086981773376,-0.08947327733039856,-0.3766387403011322},{-0.18946029245853424,0.27470916509628296,-0.009911568835377693,-0.029734987765550613,0.3156452775001526,-0.21201804280281067,0.4027499258518219,0.12222694605588913,0.2286110818386078,0.38396188616752625,0.23120085895061493,0.3152906596660614,0.247109517455101,-0.038868751376867294,0.24853068590164185,0.1256326138973236},{0.11265109479427338,-0.27852335572242737,-0.01463503111153841,-0.1231892928481102,0.31987953186035156,-0.0531020313501358,-0.2978977859020233,-0.23323994874954224,0.06659044325351715,-0.44925829768180847,-0.14732295274734497,0.19455981254577637,0.14045672118663788,0.16314859688282013,-0.29825296998023987,0.3003270626068115},{-0.10865569114685059,-0.3370935618877411,0.4362977147102356,0.2388165295124054,0.23567163944244385,0.15536560118198395,0.07946667820215225,-0.1531340777873993,0.11589394509792328,-0.19205926358699799,0.01914498582482338,0.4008256793022156,0.2589477002620697,0.13232049345970154,-0.2033781260251999,-0.014435590244829655},{0.0014137012185528874,-0.1272575855255127,0.2744346857070923,0.0044620749540627,-0.14307397603988647,-0.22514265775680542,0.45989951491355896,0.3031008541584015,-0.2719994783401489,-0.3719041347503662,-0.10865892469882965,-0.3370864987373352,0.03101525641977787,-0.3432580530643463,-0.34961897134780884,-0.002139216987416148},{-0.06488122791051865,-0.3106532394886017,0.31903842091560364,-0.21809029579162598,0.3174847960472107,-0.31426894664764404,-0.33597037196159363,0.16788163781166077,0.07461797446012497,-0.050607841461896896,-0.26953551173210144,0.058161236345767975,0.08732203394174576,-0.2468653917312622,-0.34541749954223633,0.021708058193325996},{0.2938498556613922,-0.2878054678440094,0.44024354219436646,0.1629917174577713,0.02843598835170269,0.30750831961631775,-0.0727410838007927,-0.20706471800804138,-0.5012703537940979,0.11719297617673874,0.033815477043390274,-0.3696974217891693,0.003582595381885767,0.2132054716348648,0.3403390944004059,0.04038272425532341},{-0.23764896392822266,0.1483549326658249,0.12334831058979034,-0.30587080121040344,-0.1980004459619522,0.03567313030362129,0.22071810066699982,-0.12075836211442947,0.169709712266922,-0.3502548635005951,-0.0019343305611982942,0.06651822477579117,-0.007791230455040932,0.0597536601126194,-0.11132128536701202,0.026426615193486214},{-0.21445168554782867,0.2943805158138275,-0.2999951243400574,0.3543122410774231,0.1318170130252838,-0.3644804358482361,-0.08552907407283783,-0.10062697529792786,-0.36591002345085144,0.276719331741333,-0.33095163106918335,0.3112030327320099,-0.07464960962533951,-0.18717344105243683,-0.2712908387184143,-0.522208034992218}};
static const float actor_encoder_feed_forward_0_weight[24][32] = {{-0.1373138278722763,0.009142822585999966,-0.056235164403915405,-0.04323803633451462,-0.11861826479434967,0.027419257909059525,0.2796919345855713,0.06306063383817673,-0.132981538772583,-0.22356197237968445,0.12918803095817566,-0.2728898823261261,-0.18095912039279938,0.21859417855739594,0.22911477088928223,0.287874311208725,-0.2380877435207367,-0.3202429711818695,-0.17301654815673828,0.05800668150186539,-0.037883248180150986,-0.3511168658733368,-0.24337011575698853,-0.2702183425426483,-0.30529773235321045,0.20195870101451874,-0.21325181424617767,-0.02735191211104393,-0.010977044701576233,0.021960942074656487,0.23755303025245667,-0.16707096993923187},{0.2852914333343506,0.2200339436531067,0.15402396023273468,-0.06258370727300644,0.10133306682109833,-0.100379079580307,0.268322229385376,0.139659583568573,-0.1901732087135315,-0.1664021909236908,-0.048692237585783005,-0.23758088052272797,-0.16268540918827057,0.16971604526042938,-0.1986575722694397,-0.3135450780391693,-0.05981475114822388,0.1337241530418396,-0.2841806411743164,-0.27293625473976135,0.02219233475625515,0.2276216745376587,0.10789685696363449,-0.12351366877555847,0.1562507450580597,-0.28640949726104736,0.04317294806241989,0.07237248122692108,0.22392185032367706,-0.10372421890497208,-0.03254519775509834,0.27063876390457153},{0.23548518121242523,0.08201122283935547,-0.03585047274827957,0.10317378491163254,-0.15722870826721191,-0.1508767306804657,-0.2252599596977234,0.1373337209224701,-0.12182100862264633,0.355808824300766,-0.3008076250553131,-0.21001893281936646,0.16641084849834442,-0.3439033031463623,-0.17649267613887787,0.12799687683582306,-0.09301408380270004,-0.10739561170339584,0.23083637654781342,-0.023953769356012344,0.19369719922542572,0.2769160270690918,-0.2626892924308777,0.06002754345536232,-0.1675969362258911,-0.10809604078531265,0.12554514408111572,-0.052247628569602966,-0.0835215300321579,-0.16439995169639587,-0.04605967551469803,-0.14627313613891602},{0.3197115957736969,0.05895811691880226,0.08974015712738037,-0.1377258598804474,-0.2637118399143219,-0.08667466789484024,-0.12532474100589752,0.2120407670736313,0.24207264184951782,-0.19762009382247925,-0.12333406507968903,0.25697848200798035,0.12273585051298141,-0.09761476516723633,-0.23768708109855652,0.3159293830394745,-0.3156673014163971,0.2679159939289093,-0.04665004834532738,0.04030688852071762,-0.06212536618113518,-0.10739339143037796,0.2809063494205475,0.1716718226671219,0.15913280844688416,-0.307634174823761,0.29448655247688293,-0.20469383895397186,-0.0357629768550396,0.005862066987901926,-0.3177618682384491,0.14929607510566711},{-0.026794742792844772,-0.03191474825143814,-0.08330543339252472,0.041044000536203384,0.20150995254516602,-0.15108732879161835,-0.3741096258163452,0.01575925387442112,-0.1413598656654358,-0.19950179755687714,0.1624167114496231,0.22541667520999908,-0.10203289985656738,-0.0924057736992836,-0.07814718782901764,0.2232401967048645,-0.03625116124749184,0.003336465684697032,-0.3316645920276642,-0.03677602484822273,-0.19201767444610596,-0.32711243629455566,0.16966789960861206,0.23419515788555145,-0.05820009484887123,0.27201786637306213,-0.16586773097515106,0.2490735650062561,0.2808050215244293,0.3517608642578125,0.01024598814547062,0.29063066840171814},{-0.21011561155319214,-0.10996200889348984,-0.1132614016532898,-0.07992681115865707,-0.10319230705499649,0.22439241409301758,0.22469480335712433,0.05017423257231712,0.3323590159416199,0.11412915587425232,0.2857772409915924,-0.21565786004066467,-0.1410820484161377,0.244475319981575,0.24762587249279022,-0.33887919783592224,-0.07709784060716629,-0.2368956059217453,0.2382183074951172,0.16546349227428436,0.0634942576289177,0.13265465199947357,-0.01869111880660057,-0.0048943073488771915,-0.33617302775382996,0.30537286400794983,-0.19917091727256775,0.16291800141334534,0.32272619009017944,0.23578955233097076,0.10208816826343536,0.043265774846076965},{0.1628400981426239,-0.1354769915342331,-0.13601891696453094,-0.33174148201942444,0.011748491786420345,0.23598694801330566,0.2751414179801941,0.11788762360811234,0.10380800813436508,0.29405438899993896,0.0002983009326271713,-0.0005668960511684418,-0.4373616874217987,-0.12012137472629547,-0.14091600477695465,0.03437040001153946,-0.2688051760196686,-0.21927765011787415,0.1743670105934143,-0.09697024524211884,-0.11559156328439713,-0.14035457372665405,-0.22138424217700958,-0.26400843262672424,0.179597869515419,-0.26280462741851807,-0.12269788235425949,-0.20656642317771912,0.33863580226898193,0.12356074899435043,-0.17761491239070892,-0.2779371738433838},{0.07808138430118561,0.1831454336643219,0.05604512244462967,-0.12098273634910583,0.14679212868213654,-0.2833612561225891,-0.06274237483739853,-0.14242292940616608,0.00449203047901392,-0.29714423418045044,-0.3006821572780609,-0.0839632898569107,-0.12522219121456146,0.05303095281124115,-0.1165556013584137,0.39593425393104553,0.011862069368362427,-0.14818623661994934,0.13731253147125244,0.32981744408607483,-0.17367146909236908,-0.19540780782699585,0.276591956615448,0.07010235637426376,-0.00043019524309784174,-0.3515596091747284,-0.3182632029056549,-0.2214290201663971,-0.361882746219635,-0.25026312470436096,0.11467836052179337,-0.3660019338130951},{0.03150736168026924,0.3795334994792938,-0.36847633123397827,-0.3633003830909729,-0.2677658796310425,0.06306951493024826,0.08483051508665085,0.0903482586145401,0.1254556030035019,-0.2100840061903,-0.22922977805137634,0.27102476358413696,-0.33615002036094666,-0.16755451261997223,0.17254558205604553,-0.22692471742630005,0.21340832114219666,0.11145011335611343,0.27002668380737305,0.05809955671429634,0.2157742828130722,0.10685961693525314,0.31692013144493103,-0.12344129383563995,0.4584284722805023,-0.16731396317481995,0.1775899976491928,0.3075280785560608,-0.19538402557373047,0.10347573459148407,-0.007737609092146158,0.09132584929466248},{-0.19097203016281128,0.10379024595022202,-0.32210293412208557,-0.1689787060022354,0.10564135015010834,-0.19419671595096588,0.08821216970682144,0.011891777627170086,0.1601869761943817,0.018485303968191147,-0.24232766032218933,-0.3115956783294678,-0.4030705988407135,-0.12432993948459625,-0.22296732664108276,0.08526600897312164,-0.015089036896824837,-0.2554709315299988,0.24042916297912598,0.08029984682798386,0.083401620388031,-0.027434926480054855,0.37079501152038574,-0.23036043345928192,0.3254602253437042,0.14534638822078705,-0.20996540784835815,0.0643262267112732,0.027091560885310173,0.07348533719778061,-0.17065145075321198,0.14571727812290192},{0.07582905888557434,-0.04180600866675377,0.18973632156848907,-0.2706540822982788,-0.22907915711402893,-0.22461837530136108,-0.24981069564819336,-0.09652122855186462,-0.1547021120786667,0.3062775433063507,0.11104784160852432,-0.2828579246997833,-0.33276087045669556,-0.0013243664288893342,-0.2199648916721344,-0.19661609828472137,0.2670603096485138,-0.152322456240654,0.2621665894985199,-0.21456500887870789,-0.18934331834316254,0.0025773122906684875,0.15731975436210632,0.1717638224363327,0.17067138850688934,-0.136933371424675,-0.0725611075758934,-0.07383033633232117,-0.060772839933633804,0.02694476768374443,-0.07108646631240845,0.16419675946235657},{-0.21561826765537262,-0.03579259663820267,0.2458844929933548,0.3316378891468048,0.25988829135894775,-0.008999728597700596,0.052793845534324646,-0.20799113810062408,-0.09171357750892639,-0.18689699470996857,0.2869809865951538,-0.24377304315567017,-0.21758553385734558,-0.20620867609977722,0.2806926965713501,0.008778197690844536,-0.01830011047422886,0.022839222103357315,0.32510650157928467,0.08720851689577103,-0.1801484376192093,0.2231636494398117,0.10973495244979858,-0.10505907237529755,0.19996389746665955,-0.09926427900791168,-0.14221426844596863,0.2187725156545639,0.20292209088802338,-0.01860523596405983,-0.26826733350753784,-0.25003063678741455},{0.2266014963388443,-0.2371903955936432,-0.007790529169142246,-0.3512219190597534,0.14121966063976288,-0.04683167487382889,0.17407044768333435,0.0785723552107811,0.2418535053730011,0.05410505458712578,0.14449259638786316,0.18440189957618713,-0.37399527430534363,-0.22253800928592682,-0.06461107730865479,-0.21282964944839478,-0.11792341619729996,-0.19985829293727875,0.24602635204792023,-0.23166082799434662,0.2536681890487671,0.021412424743175507,-0.011675630696117878,0.17836757004261017,0.12459156662225723,-0.0759972482919693,0.12445604056119919,0.16408129036426544,0.1368747055530548,-0.0773632749915123,-0.19641432166099548,-0.10064417868852615},{0.2240442931652069,-0.03854997083544731,-0.04750622436404228,0.4197259247303009,-0.10178825259208679,-0.18334059417247772,-0.07178275287151337,0.10526331514120102,0.16661714017391205,0.2877740263938904,0.13517461717128754,-0.149724081158638,0.01758711412549019,0.19636313617229462,-0.09518074244260788,0.05873633176088333,0.2096564769744873,-0.2362934947013855,0.059314608573913574,-0.3294949531555176,0.3155699670314789,0.15688955783843994,-0.05865533649921417,0.18601717054843903,0.1847088485956192,0.08316034823656082,0.09612692147493362,0.06899888068437576,0.0646248310804367,-0.15117692947387695,-0.03592678904533386,0.3993810713291168},{0.03516993671655655,-0.2718654274940491,-0.08052490651607513,0.11612086743116379,-0.24334774911403656,-0.011937583796679974,0.062076374888420105,-0.266796737909317,-0.1580016165971756,-0.06474559754133224,0.1850961297750473,0.14906451106071472,0.08950798213481903,0.26223859190940857,-0.05552474409341812,-0.09663662314414978,-0.22879748046398163,0.2602333128452301,-0.08911189436912537,-0.2675502598285675,-0.18440693616867065,-0.08083679527044296,0.17938512563705444,-0.007646774407476187,-0.03703857213258743,-0.077451691031456,-0.19903017580509186,0.22648654878139496,0.06743878126144409,-0.17078129947185516,0.21951451897621155,0.19445200264453888},{0.135504350066185,-0.23370034992694855,-0.08586590737104416,-0.1874707043170929,-0.08810271322727203,0.1615496575832367,0.03310871869325638,0.2368641346693039,-0.08542323112487793,-0.006989731453359127,0.25715285539627075,0.11840398609638214,-0.04538765177130699,-0.11638176441192627,0.04821108281612396,0.14671847224235535,-0.3993000090122223,-0.29158949851989746,-0.05640778690576553,0.05058012530207634,0.1160346120595932,0.23216025531291962,0.2667388319969177,0.14444275200366974,0.0479256846010685,0.22904552519321442,0.01815892569720745,-0.07066701352596283,0.19429457187652588,-0.11234885454177856,-0.24516373872756958,0.3645915389060974},{0.20670229196548462,-0.0364176444709301,-0.2309044450521469,0.1575542837381363,0.08918426930904388,-0.05145765468478203,0.27217352390289307,0.11735507845878601,0.11824934184551239,-0.2180166095495224,0.20519770681858063,-0.1721147745847702,-0.33031779527664185,0.2504904270172119,0.06587933003902435,0.056441180408000946,0.07267212122678757,-0.040852367877960205,-0.13572998344898224,0.07788243144750595,-0.07403570413589478,0.18140658736228943,0.03931416943669319,-0.12973591685295105,0.046169131994247437,-0.32312309741973877,0.02772972732782364,0.40392962098121643,0.2027900665998459,-0.12881897389888763,0.21855288743972778,0.17118144035339355},{-0.09649867564439774,-0.038888413459062576,-0.11196529120206833,-0.0458165667951107,-0.24036695063114166,-0.03874238207936287,0.21271120011806488,0.14947599172592163,0.1436360627412796,0.022743575274944305,0.23800118267536163,-0.006806951016187668,0.21065852046012878,0.1696680784225464,0.17405329644680023,-0.09608182311058044,0.11980424076318741,0.16105441749095917,0.22387541830539703,0.05336347594857216,0.1754886507987976,0.24946512281894684,0.05943673849105835,0.13514550030231476,-0.021342184394598007,-0.08923374116420746,-0.10669960081577301,-0.24852271378040314,0.168148010969162,-0.24993473291397095,-0.0064465925097465515,-0.02709137089550495},{-0.2810104191303253,0.10725029557943344,-0.2582283616065979,-0.34338638186454773,-0.023340601474046707,0.07393086701631546,0.10769197344779968,-0.08572069555521011,-0.011102758347988129,0.2800479233264923,0.06592965126037598,-0.19657744467258453,0.10389269888401031,-0.19182202219963074,-0.3045787215232849,-0.036837752908468246,-0.17343485355377197,0.1612870693206787,-0.00857350043952465,-0.04466467723250389,-0.31030043959617615,0.1681249588727951,0.11111000925302505,0.027376094833016396,-0.010386662557721138,0.2569473683834076,0.02995767816901207,-0.12953653931617737,-0.17865870893001556,0.03880079835653305,-0.11170662194490433,-0.23905324935913086},{0.008483958430588245,-0.2155068814754486,-0.21420985460281372,-0.016774151474237442,-0.3618881404399872,-0.14814342558383942,0.15522773563861847,-0.2938123345375061,-0.19883409142494202,0.18898628652095795,0.150070458650589,0.12744030356407166,0.1468336135149002,-0.12247169762849808,0.31943362951278687,-0.3213074505329132,0.08098487555980682,0.24146252870559692,0.062075503170490265,0.24443213641643524,0.049543458968400955,-0.11238092929124832,-0.28373798727989197,0.18568852543830872,-0.18428924679756165,-0.17871089279651642,0.10241404175758362,0.03896621987223625,-0.11970008909702301,-0.28787216544151306,-0.021676691249012947,-0.13810542225837708},{0.24076609313488007,0.20757944881916046,-0.07532449066638947,0.17243468761444092,-0.2920083999633789,0.1757165640592575,-0.06668300926685333,-0.12507237493991852,-0.18889884650707245,0.19267010688781738,-0.26107311248779297,-0.16019009053707123,-0.03940143063664436,-0.1958240121603012,-0.3669777810573578,-0.11269479990005493,-0.08051694184541702,-0.2702433466911316,-0.2380632907152176,0.2797234356403351,0.09475858509540558,0.1248045489192009,-0.3318224549293518,0.33419355750083923,0.19539421796798706,0.24740608036518097,-0.2831633388996124,-0.025017941370606422,0.0654488354921341,-0.2566666603088379,0.13423983752727509,0.09571261703968048},{-0.0010209273314103484,-0.3287942111492157,0.020339900627732277,-0.24959701299667358,-0.08437284827232361,0.2726668119430542,0.14410603046417236,0.012640556320548058,-0.04103214666247368,-0.005824458785355091,-0.19865582883358002,0.1917347013950348,0.16101260483264923,0.09895604848861694,0.17770074307918549,-0.025091340765357018,-0.07417409867048264,0.10034172236919403,-0.07515575736761093,0.15936675667762756,0.23873847723007202,0.21678732335567474,-0.06767629832029343,-0.2701435983181,0.06703014671802521,0.09365576505661011,0.2794066369533539,0.12381007522344589,-0.019361406564712524,0.2158210128545761,0.03672712296247482,-0.09835220873355865},{0.025409260764718056,-0.17351284623146057,0.23207151889801025,0.006827648729085922,0.2972704768180847,-0.033699776977300644,-0.11239407956600189,-0.15700869262218475,0.13148866593837738,-0.07081985473632812,0.07295054942369461,0.0011894186027348042,-0.306540846824646,0.019019480794668198,-0.10435085743665695,-0.23732787370681763,-0.05230039730668068,-0.055398810654878616,0.21443887054920197,0.2445131093263626,0.03810211271047592,0.03775501251220703,0.1818273365497589,0.3423885405063629,-0.1535937786102295,-0.045128535479307175,0.20678815245628357,-0.11650243401527405,-0.1963770091533661,-0.24274779856204987,0.2977316677570343,-0.002803814597427845},{0.18012115359306335,-0.07771508395671844,0.018375616520643234,0.1465730220079422,-0.026234392076730728,0.053562480956315994,-0.26648014783859253,0.25056910514831543,-0.060433752834796906,-0.021671485155820847,0.1037113144993782,-0.28426873683929443,-0.025347398594021797,-0.010514569468796253,-0.09912238270044327,0.2648315131664276,-0.09184446185827255,-0.20132867991924286,0.03134850785136223,-0.028536580502986908,-0.17471130192279816,0.20785555243492126,0.2322368621826172,0.20683838427066803,-0.29574698209762573,0.12951965630054474,-0.06740730255842209,0.08303948491811752,-0.28400132060050964,0.26021143794059753,-0.040948085486888885,0.0506499819457531}};
static const float action_parameterization_distribution_linear_weight[32][4] = {{-0.17131002247333527,-0.0827588215470314,0.06487216055393219,-0.12098219245672226},{0.1899019330739975,-0.30137738585472107,0.24264054000377655,0.21370746195316315},{-0.2030528336763382,0.08724498748779297,0.039852552115917206,-0.011124162934720516},{0.276884526014328,0.4327872097492218,0.32757368683815,0.033003441989421844},{-0.2457379549741745,0.11269417405128479,-0.27059406042099,0.07786580175161362},{-0.03769848495721817,-0.02926580049097538,0.05276251584291458,0.32066160440444946},{-0.11184928566217422,-0.0783608928322792,-0.29113325476646423,-0.0006112023838795722},{-0.12474425137042999,-0.21891172230243683,0.12451640516519547,-0.05728892236948013},{-0.03146389499306679,0.08089178055524826,-0.06806094944477081,-0.07607178390026093},{0.1810627281665802,0.01440318115055561,-0.08015148341655731,-0.12795142829418182},{0.13310843706130981,-0.10560087859630585,0.2781994640827179,0.2381339967250824},{0.019167285412549973,0.002312090713530779,0.2736814022064209,-0.08102231472730637},{-0.3141145706176758,0.194903165102005,-0.019656648859381676,-0.12581783533096313},{-0.1554318368434906,0.08424676209688187,-0.19223178923130035,0.07543444633483887},{0.1617465615272522,0.04393184557557106,0.2338273674249649,0.08470965176820755},{-0.12148262560367584,-0.3494492173194885,-0.12028156965970993,-0.0872519239783287},{-0.23215723037719727,0.048811621963977814,-0.09181295335292816,0.25468286871910095},{-0.22364450991153717,-0.11762098222970963,-0.2058931589126587,0.17031091451644897},{-0.06402353942394257,-0.05814622342586517,0.2970197796821594,0.07611167430877686},{-0.16902698576450348,-0.12811781466007233,0.016214489936828613,-0.17067717015743256},{0.1470870077610016,0.09496959298849106,0.11067856848239899,-0.13321533799171448},{-0.042666222900152206,-0.2097204178571701,-0.08758144080638885,0.2364867627620697},{0.3573189377784729,-0.1835179179906845,0.1313159465789795,0.028970366343855858},{-0.30552682280540466,-0.1211559846997261,-0.3089696168899536,-0.30750083923339844},{-0.13075336813926697,-0.1479383260011673,-0.0696459710597992,-0.09284792840480804},{0.11871588230133057,0.09294542670249939,-0.02882462739944458,0.0932096391916275},{0.14583005011081696,-0.1585668921470642,0.2271132618188858,0.06986482441425323},{-0.08733098208904266,-0.13564154505729675,-0.010520976036787033,0.235062837600708},{0.07360735535621643,0.018775051459670067,0.05532459542155266,0.04705331474542618},{-0.13285356760025024,0.11083707958459854,0.20213334262371063,0.0040036654099822044},{-0.20392726361751556,-0.10828663408756256,0.07256484776735306,0.16976195573806763},{0.2224782556295395,0.19549614191055298,0.2366916835308075,-0.040289610624313354}};
static const float actor_encoder_self_encoder_0_bias[16] = {-0.11290505528450012,-0.09860660880804062,0.04296531900763512,0.09129995852708817,0.10723892599344254,-0.0902034118771553,0.08372161537408829,-0.017557548359036446,-0.06676261872053146,-0.10153579711914062,-0.00460464833304286,0.06296839565038681,-0.014635132625699043,0.05790497362613678,0.09871425479650497,-0.03873533383011818};
static const float actor_encoder_self_encoder_2_bias[16] = {-0.04209186136722565,0.06377056241035461,0.049445949494838715,-0.023792659863829613,-0.030178043991327286,0.05351320654153824,-0.05866507813334465,-0.07661795616149902,0.0535256527364254,0.001924352371133864,-0.02814297378063202,-0.033992454409599304,0.017458196729421616,-0.07684242725372314,0.011580797843635082,-0.06754732131958008};
static const float actor_encoder_feed_forward_0_bias[32] = {-0.045224957168102264,0.005367215722799301,-0.0538749136030674,0.03244404494762421,0.003941627219319344,0.010964115150272846,-0.05498452112078667,-0.04042692109942436,-0.020313339307904243,-0.013689598999917507,0.015508112497627735,0.041127242147922516,0.04273255169391632,-0.049773987382650375,0.0318496935069561,-0.08269362896680832,-0.010212665423750877,-0.033563774079084396,0.0266998503357172,-0.054249390959739685,0.025331592187285423,-0.004438977222889662,0.03351781517267227,-0.06919814646244049,-0.05460641160607338,0.05723486840724945,0.05006716772913933,-0.029720064252614975,0.07806196808815002,0.028548041358590126,-0.007806968875229359,0.0578138530254364};
static const float action_parameterization_distribution_linear_bias[4] = {0.036976851522922516,0.06259667128324509,0.011441641487181187,0.032045844942331314};
static const float actor_encoder_obstacle_encoder_0_weight[32][8] = {{0.32512447237968445,-0.1550906002521515,0.019090957939624786,0.16637501120567322,0.01618077978491783,0.011119664646685123,-0.19301731884479523,0.03889031708240509},{0.03117317520081997,0.09360658377408981,0.3362328112125397,0.336363285779953,-0.09116386622190475,-0.2295330911874771,0.3129485845565796,0.11026269942522049},{-0.0017797157634049654,0.1978011280298233,0.03531141206622124,-0.03285389766097069,0.3139001727104187,0.25219041109085083,-0.09783350676298141,0.05162132531404495},{0.09440173953771591,-0.2457261085510254,0.28855380415916443,-0.21338559687137604,-0.294493705034256,0.03227642551064491,0.19099071621894836,0.16265267133712769},{-0.21117109060287476,0.022994806990027428,0.017767438665032387,-0.2980654537677765,0.08420571684837341,0.027969561517238617,0.2557865381240845,0.2704147398471832},{-0.05904712527990341,0.300417423248291,-0.05131085216999054,-0.2500106990337372,0.1555749773979187,-8.887492003850639e-05,0.028425073251128197,-0.19240565598011017},{-0.00887818168848753,0.3237292766571045,0.1656612604856491,-0.18545396625995636,0.21644867956638336,-0.2648044228553772,0.2520639896392822,0.05884191393852234},{0.004098654258996248,-0.2040846198797226,0.07842805236577988,-0.08545305579900742,0.300586074590683,-0.12770767509937286,0.017257209867239,-0.2976472079753876},{-0.17270860075950623,0.28534868359565735,0.16504710912704468,0.016848715022206306,0.0157356895506382,0.20433863997459412,0.42016348242759705,0.33939969539642334},{0.042110174894332886,-0.05425046384334564,-0.23761005699634552,0.38932693004608154,0.25892046093940735,0.1480022817850113,0.18715044856071472,-0.2774602174758911},{-0.12234131246805191,-0.3125559389591217,0.3572027087211609,0.24450689554214478,-0.0321691669523716,-0.38074085116386414,-0.11582069098949432,-0.2837640941143036},{0.31241375207901,0.058684512972831726,0.3645353615283966,0.4770658612251282,-0.15485355257987976,0.18995998799800873,0.11452004313468933,-0.331404447555542},{-0.2998843193054199,0.1622283160686493,-0.3387385308742523,0.3928336799144745,-0.042956747114658356,0.24508558213710785,0.008279986679553986,0.2459632158279419},{-0.01149530429393053,0.19859947264194489,-0.09537283331155777,-0.19252200424671173,0.03692696616053581,0.07591238617897034,0.3120023310184479,-0.03523993492126465},{0.16366754472255707,-0.2953172028064728,-0.2786157429218292,-0.21372675895690918,0.21594728529453278,-0.17210863530635834,0.21898984909057617,-0.14453302323818207},{-0.35291174054145813,-0.3783930242061615,-0.2901001572608948,-0.05631225183606148,0.012317979708313942,0.12198131531476974,0.18457256257534027,-0.018006736412644386},{-0.23097065091133118,-0.25224947929382324,0.14266285300254822,-0.2410210520029068,0.05854243040084839,0.059824392199516296,-0.4101777672767639,-0.27510103583335876},{0.005836210213601589,0.2512684464454651,0.056043244898319244,0.21094021201133728,-0.11441043019294739,0.3241558074951172,0.26310691237449646,-0.18577653169631958},{-0.02111842855811119,-0.28158676624298096,-0.0949450358748436,0.010063291527330875,-0.06573741137981415,-0.3450768291950226,0.10400118678808212,-0.22287391126155853},{-0.12419748306274414,0.012164403684437275,0.09925132244825363,-0.24547144770622253,0.12361463159322739,0.04010358452796936,0.10385787487030029,-0.010689525865018368},{0.016479521989822388,-0.061565496027469635,0.09104438126087189,-0.11685929447412491,0.03569449484348297,-0.03997466340661049,0.08677220344543457,-0.18967550992965698},{-0.2941257953643799,0.22091060876846313,0.2033134549856186,-0.2867058515548706,-0.3809593915939331,-0.04325122758746147,0.19189609587192535,0.019541524350643158},{0.29196709394454956,0.07988425344228745,-0.3806328773498535,-0.012127607129514217,-0.08580708503723145,0.21114195883274078,0.17985965311527252,0.25955113768577576},{0.004767546895891428,-0.21021273732185364,-0.061546534299850464,0.11215611547231674,-0.35128018260002136,-0.08360768854618073,-0.3133714199066162,-0.33556708693504333},{0.1367940604686737,-0.0871582180261612,-0.360769122838974,0.3596978187561035,-0.31981876492500305,-0.12177984416484833,-0.46143391728401184,0.0895327553153038},{-0.00851924903690815,0.30177366733551025,-0.17406655848026276,-0.053896714001894,0.09194288402795792,-0.15466363728046417,0.24902738630771637,-0.3010963499546051},{-0.11262421309947968,0.09695117920637131,-0.07335297018289566,-0.2327345609664917,0.03242546692490578,-0.13688568770885468,-0.15944436192512512,-0.0966072753071785},{0.084628164768219,-0.16725985705852509,0.035686567425727844,-0.12692886590957642,0.06409808248281479,0.08633222430944443,-0.2757185101509094,0.1258266717195511},{0.20520131289958954,0.01999221369624138,-0.2911878824234009,-0.17271819710731506,-0.18906405568122864,0.17105881869792938,0.17496412992477417,0.0649319663643837},{0.290556401014328,-0.3816193640232086,0.026545042172074318,-0.0650985985994339,0.08509305119514465,-0.09418812394142151,0.11762338876724243,0.23296712338924408},{-0.28225040435791016,-0.22907529771327972,0.05187619850039482,-0.37246596813201904,0.2567640244960785,-0.36698290705680847,-0.07936590164899826,0.08773738890886307},{0.2867845892906189,0.19841544330120087,0.02231430448591709,0.19548803567886353,0.08096689730882645,-0.20552748441696167,-0.07426857203245163,0.14259497821331024}};
static const float actor_encoder_obstacle_encoder_2_weight[8][8] = {{-0.19442620873451233,0.4095599353313446,-0.4477402865886688,-0.5097617506980896,-0.17217883467674255,-0.11319321393966675,-0.3665385842323303,0.4835473895072937},{-0.007944620214402676,0.3860916197299957,-0.23107203841209412,0.5135206580162048,-0.019239481538534164,-0.06533379852771759,-0.33273112773895264,-0.03113158978521824},{-0.31439974904060364,-0.23321829736232758,-0.15669487416744232,-0.14253228902816772,0.4065678119659424,0.17247994244098663,-0.08517424017190933,0.3912336528301239},{-0.46478965878486633,-0.4564434587955475,0.31022176146507263,0.21455419063568115,-0.493549644947052,-0.2051803469657898,0.4179096519947052,0.20243383944034576},{-0.25298523902893066,-0.2323285937309265,-0.2878600060939789,-0.201677143573761,0.3350578546524048,-0.21490944921970367,0.4440701901912689,-0.3409050405025482},{-0.05295901000499725,0.2728973627090454,0.12315337359905243,-0.569067120552063,0.5182674527168274,-0.23613864183425903,-0.4923246204853058,-0.3566083014011383},{-0.2672945261001587,0.09242721647024155,0.05674705281853676,-0.4381684362888336,0.04495716467499733,-0.48306646943092346,0.41900378465652466,0.07892102748155594},{-0.30316361784935,-0.16440139710903168,-0.13384294509887695,-0.35579824447631836,-0.36567994952201843,0.09868919849395752,0.5426271557807922,-0.31222015619277954}};
static const float actor_encoder_obstacle_encoder_0_bias[8] = {0.046188171952962875,-0.08779462426900864,-0.11347939074039459,0.028093982487916946,0.1389504075050354,0.032811567187309265,0.11210497468709946,0.031604111194610596};
static const float actor_encoder_obstacle_encoder_2_bias[8] = {-0.018302707001566887,0.005338181275874376,-0.016663778573274612,-0.08440816402435303,-0.06508789211511612,-0.04440924897789955,0.025358915328979492,-0.1623007357120514};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_encoder_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_encoder_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
        
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < self_structure[1][0]; j++) {
                output_1[i] += output_0[j] * actor_encoder_self_encoder_2_weight[j][i];
            }
            output_1[i] += actor_encoder_self_encoder_2_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
            
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_embeds[i] = output_1[i];
        }
        for (int i = 0; i < obst_structure[1][1]; i++) {
            output_embeds[i + self_structure[1][1]] = obstacle_embeds[i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_2[i] += actor_encoder_feed_forward_0_bias[i];
            output_2[i] = tanhf(output_2[i]);
        }
    
        for (int i = 0; i < self_structure[3][1]; i++) {
            output_3[i] = 0;
            for (int j = 0; j < self_structure[3][0]; j++) {
                output_3[i] += output_2[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_3[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_3[0];
        control_n->thrust_1 = output_3[1];
        control_n->thrust_2 = output_3[2];
        control_n->thrust_3 = output_3[3];	
    }

void obstacleEmbedder(volatile float obstacle_inputs[OBST_DIM]) {
            //reset embeddings accumulator to zero
            memset(obstacle_embeds, 0, sizeof(obstacle_embeds));

        
            for (int i = 0; i < obst_structure[0][1]; i++) {
                obst_output_0[i] = 0;
                for (int j = 0; j < obst_structure[0][0]; j++) {
                    obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_encoder_0_weight[j][i];
                }
                obst_output_0[i] += actor_encoder_obstacle_encoder_0_bias[i];
                obst_output_0[i] = tanhf(obst_output_0[i]);
            }
        
            for (int i = 0; i < obst_structure[1][1]; i++) {
                obst_output_1[i] = 0;
                for (int j = 0; j < obst_structure[1][0]; j++) {
                    obst_output_1[i] += obst_output_0[j] * actor_encoder_obstacle_encoder_2_weight[j][i];
                }
                obst_output_1[i] += actor_encoder_obstacle_encoder_2_bias[i];
                obstacle_embeds[i] = tanhf(obst_output_1[i]);
            }
            }

